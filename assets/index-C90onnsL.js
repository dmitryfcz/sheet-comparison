var Td=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var wd=Td((exports,module)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$3(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react$1={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function C(U){return U===null||typeof U!="object"?null:(U=f&&U[f]||U["@@iterator"],typeof U=="function"?U:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,v={};function _(U,te,V){this.props=U,this.context=te,this.refs=v,this.updater=V||m}_.prototype.isReactComponent={},_.prototype.setState=function(U,te){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,te,"setState")},_.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function T(){}T.prototype=_.prototype;function R(U,te,V){this.props=U,this.context=te,this.refs=v,this.updater=V||m}var O=R.prototype=new T;O.constructor=R,E(O,_.prototype),O.isPureReactComponent=!0;var N=Array.isArray,G=Object.prototype.hasOwnProperty,D={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function z(U,te,V){var ue,Ne={},Ge=null,Ue=null;if(te!=null)for(ue in te.ref!==void 0&&(Ue=te.ref),te.key!==void 0&&(Ge=""+te.key),te)G.call(te,ue)&&!k.hasOwnProperty(ue)&&(Ne[ue]=te[ue]);var Ie=arguments.length-2;if(Ie===1)Ne.children=V;else if(1<Ie){for(var Ke=Array(Ie),le=0;le<Ie;le++)Ke[le]=arguments[le+2];Ne.children=Ke}if(U&&U.defaultProps)for(ue in Ie=U.defaultProps,Ie)Ne[ue]===void 0&&(Ne[ue]=Ie[ue]);return{$$typeof:r,type:U,key:Ge,ref:Ue,props:Ne,_owner:D.current}}function ne(U,te){return{$$typeof:r,type:U.type,key:te,ref:U.ref,props:U.props,_owner:U._owner}}function Z(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function ve(U){var te={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(V){return te[V]})}var xe=/\/+/g;function de(U,te){return typeof U=="object"&&U!==null&&U.key!=null?ve(""+U.key):te.toString(36)}function Se(U,te,V,ue,Ne){var Ge=typeof U;(Ge==="undefined"||Ge==="boolean")&&(U=null);var Ue=!1;if(U===null)Ue=!0;else switch(Ge){case"string":case"number":Ue=!0;break;case"object":switch(U.$$typeof){case r:case e:Ue=!0}}if(Ue)return Ue=U,Ne=Ne(Ue),U=ue===""?"."+de(Ue,0):ue,N(Ne)?(V="",U!=null&&(V=U.replace(xe,"$&/")+"/"),Se(Ne,te,V,"",function(le){return le})):Ne!=null&&(Z(Ne)&&(Ne=ne(Ne,V+(!Ne.key||Ue&&Ue.key===Ne.key?"":(""+Ne.key).replace(xe,"$&/")+"/")+U)),te.push(Ne)),1;if(Ue=0,ue=ue===""?".":ue+":",N(U))for(var Ie=0;Ie<U.length;Ie++){Ge=U[Ie];var Ke=ue+de(Ge,Ie);Ue+=Se(Ge,te,V,Ke,Ne)}else if(Ke=C(U),typeof Ke=="function")for(U=Ke.call(U),Ie=0;!(Ge=U.next()).done;)Ge=Ge.value,Ke=ue+de(Ge,Ie++),Ue+=Se(Ge,te,V,Ke,Ne);else if(Ge==="object")throw te=String(U),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.");return Ue}function Me(U,te,V){if(U==null)return U;var ue=[],Ne=0;return Se(U,ue,"","",function(Ge){return te.call(V,Ge,Ne++)}),ue}function Pe(U){if(U._status===-1){var te=U._result;te=te(),te.then(function(V){(U._status===0||U._status===-1)&&(U._status=1,U._result=V)},function(V){(U._status===0||U._status===-1)&&(U._status=2,U._result=V)}),U._status===-1&&(U._status=0,U._result=te)}if(U._status===1)return U._result.default;throw U._result}var _e={current:null},Oe={transition:null},st={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:Oe,ReactCurrentOwner:D};function rt(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:Me,forEach:function(U,te,V){Me(U,function(){te.apply(this,arguments)},V)},count:function(U){var te=0;return Me(U,function(){te++}),te},toArray:function(U){return Me(U,function(te){return te})||[]},only:function(U){if(!Z(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},react_production_min.Component=_,react_production_min.Fragment=t,react_production_min.Profiler=s,react_production_min.PureComponent=R,react_production_min.StrictMode=n,react_production_min.Suspense=u,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=st,react_production_min.act=rt,react_production_min.cloneElement=function(U,te,V){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var ue=E({},U.props),Ne=U.key,Ge=U.ref,Ue=U._owner;if(te!=null){if(te.ref!==void 0&&(Ge=te.ref,Ue=D.current),te.key!==void 0&&(Ne=""+te.key),U.type&&U.type.defaultProps)var Ie=U.type.defaultProps;for(Ke in te)G.call(te,Ke)&&!k.hasOwnProperty(Ke)&&(ue[Ke]=te[Ke]===void 0&&Ie!==void 0?Ie[Ke]:te[Ke])}var Ke=arguments.length-2;if(Ke===1)ue.children=V;else if(1<Ke){Ie=Array(Ke);for(var le=0;le<Ke;le++)Ie[le]=arguments[le+2];ue.children=Ie}return{$$typeof:r,type:U.type,key:Ne,ref:Ge,props:ue,_owner:Ue}},react_production_min.createContext=function(U){return U={$$typeof:a,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:o,_context:U},U.Consumer=U},react_production_min.createElement=z,react_production_min.createFactory=function(U){var te=z.bind(null,U);return te.type=U,te},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(U){return{$$typeof:l,render:U}},react_production_min.isValidElement=Z,react_production_min.lazy=function(U){return{$$typeof:d,_payload:{_status:-1,_result:U},_init:Pe}},react_production_min.memo=function(U,te){return{$$typeof:c,type:U,compare:te===void 0?null:te}},react_production_min.startTransition=function(U){var te=Oe.transition;Oe.transition={};try{U()}finally{Oe.transition=te}},react_production_min.unstable_act=rt,react_production_min.useCallback=function(U,te){return _e.current.useCallback(U,te)},react_production_min.useContext=function(U){return _e.current.useContext(U)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(U){return _e.current.useDeferredValue(U)},react_production_min.useEffect=function(U,te){return _e.current.useEffect(U,te)},react_production_min.useId=function(){return _e.current.useId()},react_production_min.useImperativeHandle=function(U,te,V){return _e.current.useImperativeHandle(U,te,V)},react_production_min.useInsertionEffect=function(U,te){return _e.current.useInsertionEffect(U,te)},react_production_min.useLayoutEffect=function(U,te){return _e.current.useLayoutEffect(U,te)},react_production_min.useMemo=function(U,te){return _e.current.useMemo(U,te)},react_production_min.useReducer=function(U,te,V){return _e.current.useReducer(U,te,V)},react_production_min.useRef=function(U){return _e.current.useRef(U)},react_production_min.useState=function(U){return _e.current.useState(U)},react_production_min.useSyncExternalStore=function(U,te,V){return _e.current.useSyncExternalStore(U,te,V)},react_production_min.useTransition=function(){return _e.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react$1.exports=requireReact_production_min()),react$1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(l,u,c){var d,f={},C=null,m=null;c!==void 0&&(C=""+c),u.key!==void 0&&(C=""+u.key),u.ref!==void 0&&(m=u.ref);for(d in u)n.call(u,d)&&!o.hasOwnProperty(d)&&(f[d]=u[d]);if(l&&l.defaultProps)for(d in u=l.defaultProps,u)f[d]===void 0&&(f[d]=u[d]);return{$$typeof:e,type:l,key:C,ref:m,props:f,_owner:s.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=a,reactJsxRuntime_production_min.jsxs=a,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs$3(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(r){function e(Oe,st){var rt=Oe.length;Oe.push(st);e:for(;0<rt;){var U=rt-1>>>1,te=Oe[U];if(0<s(te,st))Oe[U]=st,Oe[rt]=te,rt=U;else break e}}function t(Oe){return Oe.length===0?null:Oe[0]}function n(Oe){if(Oe.length===0)return null;var st=Oe[0],rt=Oe.pop();if(rt!==st){Oe[0]=rt;e:for(var U=0,te=Oe.length,V=te>>>1;U<V;){var ue=2*(U+1)-1,Ne=Oe[ue],Ge=ue+1,Ue=Oe[Ge];if(0>s(Ne,rt))Ge<te&&0>s(Ue,Ne)?(Oe[U]=Ue,Oe[Ge]=rt,U=Ge):(Oe[U]=Ne,Oe[ue]=rt,U=ue);else if(Ge<te&&0>s(Ue,rt))Oe[U]=Ue,Oe[Ge]=rt,U=Ge;else break e}}return st}function s(Oe,st){var rt=Oe.sortIndex-st.sortIndex;return rt!==0?rt:Oe.id-st.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();r.unstable_now=function(){return a.now()-l}}var u=[],c=[],d=1,f=null,C=3,m=!1,E=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(Oe){for(var st=t(c);st!==null;){if(st.callback===null)n(c);else if(st.startTime<=Oe)n(c),st.sortIndex=st.expirationTime,e(u,st);else break;st=t(c)}}function N(Oe){if(v=!1,O(Oe),!E)if(t(u)!==null)E=!0,Pe(G);else{var st=t(c);st!==null&&_e(N,st.startTime-Oe)}}function G(Oe,st){E=!1,v&&(v=!1,T(z),z=-1),m=!0;var rt=C;try{for(O(st),f=t(u);f!==null&&(!(f.expirationTime>st)||Oe&&!ve());){var U=f.callback;if(typeof U=="function"){f.callback=null,C=f.priorityLevel;var te=U(f.expirationTime<=st);st=r.unstable_now(),typeof te=="function"?f.callback=te:f===t(u)&&n(u),O(st)}else n(u);f=t(u)}if(f!==null)var V=!0;else{var ue=t(c);ue!==null&&_e(N,ue.startTime-st),V=!1}return V}finally{f=null,C=rt,m=!1}}var D=!1,k=null,z=-1,ne=5,Z=-1;function ve(){return!(r.unstable_now()-Z<ne)}function xe(){if(k!==null){var Oe=r.unstable_now();Z=Oe;var st=!0;try{st=k(!0,Oe)}finally{st?de():(D=!1,k=null)}}else D=!1}var de;if(typeof R=="function")de=function(){R(xe)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Me=Se.port2;Se.port1.onmessage=xe,de=function(){Me.postMessage(null)}}else de=function(){_(xe,0)};function Pe(Oe){k=Oe,D||(D=!0,de())}function _e(Oe,st){z=_(function(){Oe(r.unstable_now())},st)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Oe){Oe.callback=null},r.unstable_continueExecution=function(){E||m||(E=!0,Pe(G))},r.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<Oe?Math.floor(1e3/Oe):5},r.unstable_getCurrentPriorityLevel=function(){return C},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(Oe){switch(C){case 1:case 2:case 3:var st=3;break;default:st=C}var rt=C;C=st;try{return Oe()}finally{C=rt}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Oe,st){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var rt=C;C=Oe;try{return st()}finally{C=rt}},r.unstable_scheduleCallback=function(Oe,st,rt){var U=r.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?U+rt:U):rt=U,Oe){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=rt+te,Oe={id:d++,callback:st,priorityLevel:Oe,startTime:rt,expirationTime:te,sortIndex:-1},rt>U?(Oe.sortIndex=rt,e(c,Oe),t(u)===null&&Oe===t(c)&&(v?(T(z),z=-1):v=!0,_e(N,rt-U))):(Oe.sortIndex=te,e(u,Oe),E||m||(E=!0,Pe(G))),Oe},r.unstable_shouldYield=ve,r.unstable_wrapCallback=function(Oe){var st=C;return function(){var rt=C;C=st;try{return Oe.apply(this,arguments)}finally{C=rt}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var r=requireReact(),e=requireScheduler();function t(h){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+h,w=1;w<arguments.length;w++)g+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(h,g){a(h,g),a(h+"Capture",g)}function a(h,g){for(s[h]=g,h=0;h<g.length;h++)n.add(g[h])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function C(h){return u.call(f,h)?!0:u.call(d,h)?!1:c.test(h)?f[h]=!0:(d[h]=!0,!1)}function m(h,g,w,I){if(w!==null&&w.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return I?!1:w!==null?!w.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function E(h,g,w,I){if(g===null||typeof g>"u"||m(h,g,w,I))return!0;if(I)return!1;if(w!==null)switch(w.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function v(h,g,w,I,W,J,Ee){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=I,this.attributeNamespace=W,this.mustUseProperty=w,this.propertyName=h,this.type=g,this.sanitizeURL=J,this.removeEmptyString=Ee}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){_[h]=new v(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var g=h[0];_[g]=new v(g,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){_[h]=new v(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){_[h]=new v(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){_[h]=new v(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){_[h]=new v(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){_[h]=new v(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){_[h]=new v(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){_[h]=new v(h,5,!1,h.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function R(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var g=h.replace(T,R);_[g]=new v(g,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var g=h.replace(T,R);_[g]=new v(g,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var g=h.replace(T,R);_[g]=new v(g,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){_[h]=new v(h,1,!1,h.toLowerCase(),null,!1,!1)}),_.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){_[h]=new v(h,1,!1,h.toLowerCase(),null,!0,!0)});function O(h,g,w,I){var W=_.hasOwnProperty(g)?_[g]:null;(W!==null?W.type!==0:I||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(E(g,w,W,I)&&(w=null),I||W===null?C(g)&&(w===null?h.removeAttribute(g):h.setAttribute(g,""+w)):W.mustUseProperty?h[W.propertyName]=w===null?W.type===3?!1:"":w:(g=W.attributeName,I=W.attributeNamespace,w===null?h.removeAttribute(g):(W=W.type,w=W===3||W===4&&w===!0?"":""+w,I?h.setAttributeNS(I,g,w):h.setAttribute(g,w))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),D=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),ve=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),Me=Symbol.for("react.memo"),Pe=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),Oe=Symbol.iterator;function st(h){return h===null||typeof h!="object"?null:(h=Oe&&h[Oe]||h["@@iterator"],typeof h=="function"?h:null)}var rt=Object.assign,U;function te(h){if(U===void 0)try{throw Error()}catch(w){var g=w.stack.trim().match(/\n( *(at )?)/);U=g&&g[1]||""}return`
`+U+h}var V=!1;function ue(h,g){if(!h||V)return"";V=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(dt){var I=dt}Reflect.construct(h,[],g)}else{try{g.call()}catch(dt){I=dt}h.call(g.prototype)}else{try{throw Error()}catch(dt){I=dt}h()}}catch(dt){if(dt&&I&&typeof dt.stack=="string"){for(var W=dt.stack.split(`
`),J=I.stack.split(`
`),Ee=W.length-1,Be=J.length-1;1<=Ee&&0<=Be&&W[Ee]!==J[Be];)Be--;for(;1<=Ee&&0<=Be;Ee--,Be--)if(W[Ee]!==J[Be]){if(Ee!==1||Be!==1)do if(Ee--,Be--,0>Be||W[Ee]!==J[Be]){var Je=`
`+W[Ee].replace(" at new "," at ");return h.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",h.displayName)),Je}while(1<=Ee&&0<=Be);break}}}finally{V=!1,Error.prepareStackTrace=w}return(h=h?h.displayName||h.name:"")?te(h):""}function Ne(h){switch(h.tag){case 5:return te(h.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return h=ue(h.type,!1),h;case 11:return h=ue(h.type.render,!1),h;case 1:return h=ue(h.type,!0),h;default:return""}}function Ge(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case k:return"Fragment";case D:return"Portal";case ne:return"Profiler";case z:return"StrictMode";case de:return"Suspense";case Se:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case ve:return(h.displayName||"Context")+".Consumer";case Z:return(h._context.displayName||"Context")+".Provider";case xe:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case Me:return g=h.displayName||null,g!==null?g:Ge(h.type)||"Memo";case Pe:g=h._payload,h=h._init;try{return Ge(h(g))}catch{}}return null}function Ue(h){var g=h.type;switch(h.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=g.render,h=h.displayName||h.name||"",g.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ge(g);case 8:return g===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function Ie(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Ke(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function le(h){var g=Ke(h)?"checked":"value",w=Object.getOwnPropertyDescriptor(h.constructor.prototype,g),I=""+h[g];if(!h.hasOwnProperty(g)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var W=w.get,J=w.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return W.call(this)},set:function(Ee){I=""+Ee,J.call(this,Ee)}}),Object.defineProperty(h,g,{enumerable:w.enumerable}),{getValue:function(){return I},setValue:function(Ee){I=""+Ee},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function ge(h){h._valueTracker||(h._valueTracker=le(h))}function we(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var w=g.getValue(),I="";return h&&(I=Ke(h)?h.checked?"true":"false":h.value),h=I,h!==w?(g.setValue(h),!0):!1}function qe(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function $e(h,g){var w=g.checked;return rt({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??h._wrapperState.initialChecked})}function ze(h,g){var w=g.defaultValue==null?"":g.defaultValue,I=g.checked!=null?g.checked:g.defaultChecked;w=Ie(g.value!=null?g.value:w),h._wrapperState={initialChecked:I,initialValue:w,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function it(h,g){g=g.checked,g!=null&&O(h,"checked",g,!1)}function Ve(h,g){it(h,g);var w=Ie(g.value),I=g.type;if(w!=null)I==="number"?(w===0&&h.value===""||h.value!=w)&&(h.value=""+w):h.value!==""+w&&(h.value=""+w);else if(I==="submit"||I==="reset"){h.removeAttribute("value");return}g.hasOwnProperty("value")?nt(h,g.type,w):g.hasOwnProperty("defaultValue")&&nt(h,g.type,Ie(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(h.defaultChecked=!!g.defaultChecked)}function Qe(h,g,w){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var I=g.type;if(!(I!=="submit"&&I!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+h._wrapperState.initialValue,w||g===h.value||(h.value=g),h.defaultValue=g}w=h.name,w!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,w!==""&&(h.name=w)}function nt(h,g,w){(g!=="number"||qe(h.ownerDocument)!==h)&&(w==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+w&&(h.defaultValue=""+w))}var Ze=Array.isArray;function at(h,g,w,I){if(h=h.options,g){g={};for(var W=0;W<w.length;W++)g["$"+w[W]]=!0;for(w=0;w<h.length;w++)W=g.hasOwnProperty("$"+h[w].value),h[w].selected!==W&&(h[w].selected=W),W&&I&&(h[w].defaultSelected=!0)}else{for(w=""+Ie(w),g=null,W=0;W<h.length;W++){if(h[W].value===w){h[W].selected=!0,I&&(h[W].defaultSelected=!0);return}g!==null||h[W].disabled||(g=h[W])}g!==null&&(g.selected=!0)}}function St(h,g){if(g.dangerouslySetInnerHTML!=null)throw Error(t(91));return rt({},g,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function bt(h,g){var w=g.value;if(w==null){if(w=g.children,g=g.defaultValue,w!=null){if(g!=null)throw Error(t(92));if(Ze(w)){if(1<w.length)throw Error(t(93));w=w[0]}g=w}g==null&&(g=""),w=g}h._wrapperState={initialValue:Ie(w)}}function q(h,g){var w=Ie(g.value),I=Ie(g.defaultValue);w!=null&&(w=""+w,w!==h.value&&(h.value=w),g.defaultValue==null&&h.defaultValue!==w&&(h.defaultValue=w)),I!=null&&(h.defaultValue=""+I)}function X(h){var g=h.textContent;g===h._wrapperState.initialValue&&g!==""&&g!==null&&(h.value=g)}function F(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function b(h,g){return h==null||h==="http://www.w3.org/1999/xhtml"?F(g):h==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var ce,Fe=function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,w,I,W){MSApp.execUnsafeLocalFunction(function(){return h(g,w,I,W)})}:h}(function(h,g){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=g;else{for(ce=ce||document.createElement("div"),ce.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=ce.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;g.firstChild;)h.appendChild(g.firstChild)}});function Le(h,g){if(g){var w=h.firstChild;if(w&&w===h.lastChild&&w.nodeType===3){w.nodeValue=g;return}}h.textContent=g}var ae={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},re=["Webkit","ms","Moz","O"];Object.keys(ae).forEach(function(h){re.forEach(function(g){g=g+h.charAt(0).toUpperCase()+h.substring(1),ae[g]=ae[h]})});function me(h,g,w){return g==null||typeof g=="boolean"||g===""?"":w||typeof g!="number"||g===0||ae.hasOwnProperty(h)&&ae[h]?(""+g).trim():g+"px"}function he(h,g){h=h.style;for(var w in g)if(g.hasOwnProperty(w)){var I=w.indexOf("--")===0,W=me(w,g[w],I);w==="float"&&(w="cssFloat"),I?h.setProperty(w,W):h[w]=W}}var Ae=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function je(h,g){if(g){if(Ae[h]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(t(137,h));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(t(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(t(61))}if(g.style!=null&&typeof g.style!="object")throw Error(t(62))}}function ke(h,g){if(h.indexOf("-")===-1)return typeof g.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var et=null;function pt(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var A=null,K=null,L=null;function j(h){if(h=ms(h)){if(typeof A!="function")throw Error(t(280));var g=h.stateNode;g&&(g=Ys(g),A(h.stateNode,h.type,g))}}function Y(h){K?L?L.push(h):L=[h]:K=h}function oe(){if(K){var h=K,g=L;if(L=K=null,j(h),g)for(h=0;h<g.length;h++)j(g[h])}}function Te(h,g){return h(g)}function ee(){}var ye=!1;function H(h,g,w){if(ye)return h(g,w);ye=!0;try{return Te(h,g,w)}finally{ye=!1,(K!==null||L!==null)&&(ee(),oe())}}function Q(h,g){var w=h.stateNode;if(w===null)return null;var I=Ys(w);if(I===null)return null;w=I[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(I=!I.disabled)||(h=h.type,I=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!I;break e;default:h=!1}if(h)return null;if(w&&typeof w!="function")throw Error(t(231,g,typeof w));return w}var pe=!1;if(l)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){pe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch{pe=!1}function Ce(h,g,w,I,W,J,Ee,Be,Je){var dt=Array.prototype.slice.call(arguments,3);try{g.apply(w,dt)}catch(Tt){this.onError(Tt)}}var We=!1,ot=null,mt=!1,Ye=null,Et={onError:function(h){We=!0,ot=h}};function vt(h,g,w,I,W,J,Ee,Be,Je){We=!1,ot=null,Ce.apply(Et,arguments)}function xt(h,g,w,I,W,J,Ee,Be,Je){if(vt.apply(this,arguments),We){if(We){var dt=ot;We=!1,ot=null}else throw Error(t(198));mt||(mt=!0,Ye=dt)}}function He(h){var g=h,w=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,g.flags&4098&&(w=g.return),h=g.return;while(h)}return g.tag===3?w:null}function ft(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function yt(h){if(He(h)!==h)throw Error(t(188))}function It(h){var g=h.alternate;if(!g){if(g=He(h),g===null)throw Error(t(188));return g!==h?null:h}for(var w=h,I=g;;){var W=w.return;if(W===null)break;var J=W.alternate;if(J===null){if(I=W.return,I!==null){w=I;continue}break}if(W.child===J.child){for(J=W.child;J;){if(J===w)return yt(W),h;if(J===I)return yt(W),g;J=J.sibling}throw Error(t(188))}if(w.return!==I.return)w=W,I=J;else{for(var Ee=!1,Be=W.child;Be;){if(Be===w){Ee=!0,w=W,I=J;break}if(Be===I){Ee=!0,I=W,w=J;break}Be=Be.sibling}if(!Ee){for(Be=J.child;Be;){if(Be===w){Ee=!0,w=J,I=W;break}if(Be===I){Ee=!0,I=J,w=W;break}Be=Be.sibling}if(!Ee)throw Error(t(189))}}if(w.alternate!==I)throw Error(t(190))}if(w.tag!==3)throw Error(t(188));return w.stateNode.current===w?h:g}function gt(h){return h=It(h),h!==null?De(h):null}function De(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var g=De(h);if(g!==null)return g;h=h.sibling}return null}var ht=e.unstable_scheduleCallback,Rt=e.unstable_cancelCallback,Pt=e.unstable_shouldYield,Vt=e.unstable_requestPaint,Nt=e.unstable_now,ur=e.unstable_getCurrentPriorityLevel,pr=e.unstable_ImmediatePriority,cr=e.unstable_UserBlockingPriority,Qt=e.unstable_NormalPriority,di=e.unstable_LowPriority,Gn=e.unstable_IdlePriority,hi=null,Ur=null;function fi(h){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(hi,h,void 0,(h.current.flags&128)===128)}catch{}}var Cr=Math.clz32?Math.clz32:rn,pi=Math.log,fn=Math.LN2;function rn(h){return h>>>=0,h===0?32:31-(pi(h)/fn|0)|0}var jn=64,pn=4194304;function nn(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Tn(h,g){var w=h.pendingLanes;if(w===0)return 0;var I=0,W=h.suspendedLanes,J=h.pingedLanes,Ee=w&268435455;if(Ee!==0){var Be=Ee&~W;Be!==0?I=nn(Be):(J&=Ee,J!==0&&(I=nn(J)))}else Ee=w&~W,Ee!==0?I=nn(Ee):J!==0&&(I=nn(J));if(I===0)return 0;if(g!==0&&g!==I&&!(g&W)&&(W=I&-I,J=g&-g,W>=J||W===16&&(J&4194240)!==0))return g;if(I&4&&(I|=w&16),g=h.entangledLanes,g!==0)for(h=h.entanglements,g&=I;0<g;)w=31-Cr(g),W=1<<w,I|=h[w],g&=~W;return I}function mi(h,g){switch(h){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ki(h,g){for(var w=h.suspendedLanes,I=h.pingedLanes,W=h.expirationTimes,J=h.pendingLanes;0<J;){var Ee=31-Cr(J),Be=1<<Ee,Je=W[Ee];Je===-1?(!(Be&w)||Be&I)&&(W[Ee]=mi(Be,g)):Je<=g&&(h.expiredLanes|=Be),J&=~Be}}function gi(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function Xi(){var h=jn;return jn<<=1,!(jn&4194240)&&(jn=64),h}function yi(h){for(var g=[],w=0;31>w;w++)g.push(h);return g}function wn(h,g,w){h.pendingLanes|=g,g!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,g=31-Cr(g),h[g]=w}function Lo(h,g){var w=h.pendingLanes&~g;h.pendingLanes=g,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=g,h.mutableReadLanes&=g,h.entangledLanes&=g,g=h.entanglements;var I=h.eventTimes;for(h=h.expirationTimes;0<w;){var W=31-Cr(w),J=1<<W;g[W]=0,I[W]=-1,h[W]=-1,w&=~J}}function Ei(h,g){var w=h.entangledLanes|=g;for(h=h.entanglements;w;){var I=31-Cr(w),W=1<<I;W&g|h[I]&g&&(h[I]|=g),w&=~W}}var Wt=0;function Os(h){return h&=-h,1<h?4<h?h&268435455?16:536870912:4:1}var Ms,Wn,dr,Ci,vi,zn=!1,Kt=[],Vr=null,Lr=null,Kr=null,Dr=new Map,qt=new Map,$r=[],Ps="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xs(h,g){switch(h){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":Kr=null;break;case"pointerover":case"pointerout":Dr.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":qt.delete(g.pointerId)}}function qn(h,g,w,I,W,J){return h===null||h.nativeEvent!==J?(h={blockedOn:g,domEventName:w,eventSystemFlags:I,nativeEvent:J,targetContainers:[W]},g!==null&&(g=ms(g),g!==null&&Wn(g)),h):(h.eventSystemFlags|=I,g=h.targetContainers,W!==null&&g.indexOf(W)===-1&&g.push(W),h)}function Do(h,g,w,I,W){switch(g){case"focusin":return Vr=qn(Vr,h,g,w,I,W),!0;case"dragenter":return Lr=qn(Lr,h,g,w,I,W),!0;case"mouseover":return Kr=qn(Kr,h,g,w,I,W),!0;case"pointerover":var J=W.pointerId;return Dr.set(J,qn(Dr.get(J)||null,h,g,w,I,W)),!0;case"gotpointercapture":return J=W.pointerId,qt.set(J,qn(qt.get(J)||null,h,g,w,I,W)),!0}return!1}function Fs(h){var g=Zn(h.target);if(g!==null){var w=He(g);if(w!==null){if(g=w.tag,g===13){if(g=ft(w),g!==null){h.blockedOn=g,vi(h.priority,function(){dr(w)});return}}else if(g===3&&w.stateNode.current.memoizedState.isDehydrated){h.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Si(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var w=Qi(h.domEventName,h.eventSystemFlags,g[0],h.nativeEvent);if(w===null){w=h.nativeEvent;var I=new w.constructor(w.type,w);et=I,w.target.dispatchEvent(I),et=null}else return g=ms(w),g!==null&&Wn(g),h.blockedOn=w,!1;g.shift()}return!0}function Ls(h,g,w){Si(h)&&w.delete(g)}function $o(){zn=!1,Vr!==null&&Si(Vr)&&(Vr=null),Lr!==null&&Si(Lr)&&(Lr=null),Kr!==null&&Si(Kr)&&(Kr=null),Dr.forEach(Ls),qt.forEach(Ls)}function Yn(h,g){h.blockedOn===g&&(h.blockedOn=null,zn||(zn=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$o)))}function Kn(h){function g(W){return Yn(W,h)}if(0<Kt.length){Yn(Kt[0],h);for(var w=1;w<Kt.length;w++){var I=Kt[w];I.blockedOn===h&&(I.blockedOn=null)}}for(Vr!==null&&Yn(Vr,h),Lr!==null&&Yn(Lr,h),Kr!==null&&Yn(Kr,h),Dr.forEach(g),qt.forEach(g),w=0;w<$r.length;w++)I=$r[w],I.blockedOn===h&&(I.blockedOn=null);for(;0<$r.length&&(w=$r[0],w.blockedOn===null);)Fs(w),w.blockedOn===null&&$r.shift()}var Rn=N.ReactCurrentBatchConfig,_i=!0;function ko(h,g,w,I){var W=Wt,J=Rn.transition;Rn.transition=null;try{Wt=1,Ji(h,g,w,I)}finally{Wt=W,Rn.transition=J}}function Ho(h,g,w,I){var W=Wt,J=Rn.transition;Rn.transition=null;try{Wt=4,Ji(h,g,w,I)}finally{Wt=W,Rn.transition=J}}function Ji(h,g,w,I){if(_i){var W=Qi(h,g,w,I);if(W===null)ga(h,g,I,Ti,w),xs(h,I);else if(Do(W,h,g,w,I))I.stopPropagation();else if(xs(h,I),g&4&&-1<Ps.indexOf(h)){for(;W!==null;){var J=ms(W);if(J!==null&&Ms(J),J=Qi(h,g,w,I),J===null&&ga(h,g,I,Ti,w),J===W)break;W=J}W!==null&&I.stopPropagation()}else ga(h,g,I,null,w)}}var Ti=null;function Qi(h,g,w,I){if(Ti=null,h=pt(I),h=Zn(h),h!==null)if(g=He(h),g===null)h=null;else if(w=g.tag,w===13){if(h=ft(g),h!==null)return h;h=null}else if(w===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null);return Ti=h,null}function Ds(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ur()){case pr:return 1;case cr:return 4;case Qt:case di:return 16;case Gn:return 536870912;default:return 16}default:return 16}}var sn=null,Zi=null,wi=null;function $s(){if(wi)return wi;var h,g=Zi,w=g.length,I,W="value"in sn?sn.value:sn.textContent,J=W.length;for(h=0;h<w&&g[h]===W[h];h++);var Ee=w-h;for(I=1;I<=Ee&&g[w-I]===W[J-I];I++);return wi=W.slice(h,1<I?1-I:void 0)}function Ri(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function bi(){return!0}function ks(){return!1}function Ar(h){function g(w,I,W,J,Ee){this._reactName=w,this._targetInst=W,this.type=I,this.nativeEvent=J,this.target=Ee,this.currentTarget=null;for(var Be in h)h.hasOwnProperty(Be)&&(w=h[Be],this[Be]=w?w(J):J[Be]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?bi:ks,this.isPropagationStopped=ks,this}return rt(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=bi)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=bi)},persist:function(){},isPersistent:bi}),g}var bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},es=Ar(bn),Xn=rt({},bn,{view:0,detail:0}),Bo=Ar(Xn),ts,rs,Jn,Ai=rt({},Xn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:is,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==Jn&&(Jn&&h.type==="mousemove"?(ts=h.screenX-Jn.screenX,rs=h.screenY-Jn.screenY):rs=ts=0,Jn=h),ts)},movementY:function(h){return"movementY"in h?h.movementY:rs}}),Hs=Ar(Ai),Uo=rt({},Ai,{dataTransfer:0}),Vo=Ar(Uo),Go=rt({},Xn,{relatedTarget:0}),ns=Ar(Go),jo=rt({},bn,{animationName:0,elapsedTime:0,pseudoElement:0}),Wo=Ar(jo),zo=rt({},bn,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),qo=Ar(zo),Yo=rt({},bn,{data:0}),Bs=Ar(Yo),Ko={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qo(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=Jo[h])?!!g[h]:!1}function is(){return Qo}var Zo=rt({},Xn,{key:function(h){if(h.key){var g=Ko[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=Ri(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?Xo[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:is,charCode:function(h){return h.type==="keypress"?Ri(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?Ri(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),ea=Ar(Zo),ta=rt({},Ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Us=Ar(ta),ra=rt({},Xn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:is}),na=Ar(ra),ia=rt({},bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),sa=Ar(ia),oa=rt({},Ai,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),aa=Ar(oa),la=[9,13,27,32],Qn=l&&"CompositionEvent"in window,mr=null;l&&"documentMode"in document&&(mr=document.documentMode);var ss=l&&"TextEvent"in window&&!mr,Ni=l&&(!Qn||mr&&8<mr&&11>=mr),on=" ",ls=!1;function Ii(h,g){switch(h){case"keyup":return la.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function An(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Nn=!1;function p(h,g){switch(h){case"compositionend":return An(g);case"keypress":return g.which!==32?null:(ls=!0,on);case"textInput":return h=g.data,h===on&&ls?null:h;default:return null}}function S(h,g){if(Nn)return h==="compositionend"||!Qn&&Ii(h,g)?(h=$s(),wi=Zi=sn=null,Nn=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Ni&&g.locale!=="ko"?null:g.data;default:return null}}var P={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function B(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!P[h.type]:g==="textarea"}function se(h,g,w,I){Y(I),g=Ws(g,"onChange"),0<g.length&&(w=new es("onChange","change",null,w,I),h.push({event:w,listeners:g}))}var fe=null,be=null;function Xe(h){Gl(h,0)}function ut(h){var g=Fi(h);if(we(g))return h}function Ct(h,g){if(h==="change")return g}var Ot=!1;if(l){var kt;if(l){var Ft="oninput"in document;if(!Ft){var Gt=document.createElement("div");Gt.setAttribute("oninput","return;"),Ft=typeof Gt.oninput=="function"}kt=Ft}else kt=!1;Ot=kt&&(!document.documentMode||9<document.documentMode)}function zt(){fe&&(fe.detachEvent("onpropertychange",Yt),be=fe=null)}function Yt(h){if(h.propertyName==="value"&&ut(be)){var g=[];se(g,be,h,pt(h)),H(Xe,g)}}function _r(h,g,w){h==="focusin"?(zt(),fe=g,be=w,fe.attachEvent("onpropertychange",Yt)):h==="focusout"&&zt()}function rr(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return ut(be)}function an(h,g){if(h==="click")return ut(g)}function Ic(h,g){if(h==="input"||h==="change")return ut(g)}function Oc(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var Xr=typeof Object.is=="function"?Object.is:Oc;function us(h,g){if(Xr(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var w=Object.keys(h),I=Object.keys(g);if(w.length!==I.length)return!1;for(I=0;I<w.length;I++){var W=w[I];if(!u.call(g,W)||!Xr(h[W],g[W]))return!1}return!0}function Ol(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Ml(h,g){var w=Ol(h);h=0;for(var I;w;){if(w.nodeType===3){if(I=h+w.textContent.length,h<=g&&I>=g)return{node:w,offset:g-h};h=I}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=Ol(w)}}function Pl(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?Pl(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function xl(){for(var h=window,g=qe();g instanceof h.HTMLIFrameElement;){try{var w=typeof g.contentWindow.location.href=="string"}catch{w=!1}if(w)h=g.contentWindow;else break;g=qe(h.document)}return g}function ua(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}function Mc(h){var g=xl(),w=h.focusedElem,I=h.selectionRange;if(g!==w&&w&&w.ownerDocument&&Pl(w.ownerDocument.documentElement,w)){if(I!==null&&ua(w)){if(g=I.start,h=I.end,h===void 0&&(h=g),"selectionStart"in w)w.selectionStart=g,w.selectionEnd=Math.min(h,w.value.length);else if(h=(g=w.ownerDocument||document)&&g.defaultView||window,h.getSelection){h=h.getSelection();var W=w.textContent.length,J=Math.min(I.start,W);I=I.end===void 0?J:Math.min(I.end,W),!h.extend&&J>I&&(W=I,I=J,J=W),W=Ml(w,J);var Ee=Ml(w,I);W&&Ee&&(h.rangeCount!==1||h.anchorNode!==W.node||h.anchorOffset!==W.offset||h.focusNode!==Ee.node||h.focusOffset!==Ee.offset)&&(g=g.createRange(),g.setStart(W.node,W.offset),h.removeAllRanges(),J>I?(h.addRange(g),h.extend(Ee.node,Ee.offset)):(g.setEnd(Ee.node,Ee.offset),h.addRange(g)))}}for(g=[],h=w;h=h.parentNode;)h.nodeType===1&&g.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<g.length;w++)h=g[w],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var Pc=l&&"documentMode"in document&&11>=document.documentMode,Oi=null,ca=null,cs=null,da=!1;function Fl(h,g,w){var I=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;da||Oi==null||Oi!==qe(I)||(I=Oi,"selectionStart"in I&&ua(I)?I={start:I.selectionStart,end:I.selectionEnd}:(I=(I.ownerDocument&&I.ownerDocument.defaultView||window).getSelection(),I={anchorNode:I.anchorNode,anchorOffset:I.anchorOffset,focusNode:I.focusNode,focusOffset:I.focusOffset}),cs&&us(cs,I)||(cs=I,I=Ws(ca,"onSelect"),0<I.length&&(g=new es("onSelect","select",null,g,w),h.push({event:g,listeners:I}),g.target=Oi)))}function Vs(h,g){var w={};return w[h.toLowerCase()]=g.toLowerCase(),w["Webkit"+h]="webkit"+g,w["Moz"+h]="moz"+g,w}var Mi={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionend:Vs("Transition","TransitionEnd")},ha={},Ll={};l&&(Ll=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Gs(h){if(ha[h])return ha[h];if(!Mi[h])return h;var g=Mi[h],w;for(w in g)if(g.hasOwnProperty(w)&&w in Ll)return ha[h]=g[w];return h}var Dl=Gs("animationend"),$l=Gs("animationiteration"),kl=Gs("animationstart"),Hl=Gs("transitionend"),Bl=new Map,Ul="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(h,g){Bl.set(h,g),o(g,[h])}for(var fa=0;fa<Ul.length;fa++){var pa=Ul[fa],xc=pa.toLowerCase(),Fc=pa[0].toUpperCase()+pa.slice(1);In(xc,"on"+Fc)}In(Dl,"onAnimationEnd"),In($l,"onAnimationIteration"),In(kl,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Hl,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lc=new Set("cancel close invalid load scroll toggle".split(" ").concat(ds));function Vl(h,g,w){var I=h.type||"unknown-event";h.currentTarget=w,xt(I,g,void 0,h),h.currentTarget=null}function Gl(h,g){g=(g&4)!==0;for(var w=0;w<h.length;w++){var I=h[w],W=I.event;I=I.listeners;e:{var J=void 0;if(g)for(var Ee=I.length-1;0<=Ee;Ee--){var Be=I[Ee],Je=Be.instance,dt=Be.currentTarget;if(Be=Be.listener,Je!==J&&W.isPropagationStopped())break e;Vl(W,Be,dt),J=Je}else for(Ee=0;Ee<I.length;Ee++){if(Be=I[Ee],Je=Be.instance,dt=Be.currentTarget,Be=Be.listener,Je!==J&&W.isPropagationStopped())break e;Vl(W,Be,dt),J=Je}}}if(mt)throw h=Ye,mt=!1,Ye=null,h}function er(h,g){var w=g[_a];w===void 0&&(w=g[_a]=new Set);var I=h+"__bubble";w.has(I)||(jl(g,h,2,!1),w.add(I))}function ma(h,g,w){var I=0;g&&(I|=4),jl(w,h,I,g)}var js="_reactListening"+Math.random().toString(36).slice(2);function hs(h){if(!h[js]){h[js]=!0,n.forEach(function(w){w!=="selectionchange"&&(Lc.has(w)||ma(w,!1,h),ma(w,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[js]||(g[js]=!0,ma("selectionchange",!1,g))}}function jl(h,g,w,I){switch(Ds(g)){case 1:var W=ko;break;case 4:W=Ho;break;default:W=Ji}w=W.bind(null,g,w,h),W=void 0,!pe||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(W=!0),I?W!==void 0?h.addEventListener(g,w,{capture:!0,passive:W}):h.addEventListener(g,w,!0):W!==void 0?h.addEventListener(g,w,{passive:W}):h.addEventListener(g,w,!1)}function ga(h,g,w,I,W){var J=I;if(!(g&1)&&!(g&2)&&I!==null)e:for(;;){if(I===null)return;var Ee=I.tag;if(Ee===3||Ee===4){var Be=I.stateNode.containerInfo;if(Be===W||Be.nodeType===8&&Be.parentNode===W)break;if(Ee===4)for(Ee=I.return;Ee!==null;){var Je=Ee.tag;if((Je===3||Je===4)&&(Je=Ee.stateNode.containerInfo,Je===W||Je.nodeType===8&&Je.parentNode===W))return;Ee=Ee.return}for(;Be!==null;){if(Ee=Zn(Be),Ee===null)return;if(Je=Ee.tag,Je===5||Je===6){I=J=Ee;continue e}Be=Be.parentNode}}I=I.return}H(function(){var dt=J,Tt=pt(w),wt=[];e:{var _t=Bl.get(h);if(_t!==void 0){var Mt=es,Dt=h;switch(h){case"keypress":if(Ri(w)===0)break e;case"keydown":case"keyup":Mt=ea;break;case"focusin":Dt="focus",Mt=ns;break;case"focusout":Dt="blur",Mt=ns;break;case"beforeblur":case"afterblur":Mt=ns;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Mt=Hs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Mt=Vo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Mt=na;break;case Dl:case $l:case kl:Mt=Wo;break;case Hl:Mt=sa;break;case"scroll":Mt=Bo;break;case"wheel":Mt=aa;break;case"copy":case"cut":case"paste":Mt=qo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Mt=Us}var $t=(g&4)!==0,ar=!$t&&h==="scroll",lt=$t?_t!==null?_t+"Capture":null:_t;$t=[];for(var tt=dt,ct;tt!==null;){ct=tt;var At=ct.stateNode;if(ct.tag===5&&At!==null&&(ct=At,lt!==null&&(At=Q(tt,lt),At!=null&&$t.push(fs(tt,At,ct)))),ar)break;tt=tt.return}0<$t.length&&(_t=new Mt(_t,Dt,null,w,Tt),wt.push({event:_t,listeners:$t}))}}if(!(g&7)){e:{if(_t=h==="mouseover"||h==="pointerover",Mt=h==="mouseout"||h==="pointerout",_t&&w!==et&&(Dt=w.relatedTarget||w.fromElement)&&(Zn(Dt)||Dt[mn]))break e;if((Mt||_t)&&(_t=Tt.window===Tt?Tt:(_t=Tt.ownerDocument)?_t.defaultView||_t.parentWindow:window,Mt?(Dt=w.relatedTarget||w.toElement,Mt=dt,Dt=Dt?Zn(Dt):null,Dt!==null&&(ar=He(Dt),Dt!==ar||Dt.tag!==5&&Dt.tag!==6)&&(Dt=null)):(Mt=null,Dt=dt),Mt!==Dt)){if($t=Hs,At="onMouseLeave",lt="onMouseEnter",tt="mouse",(h==="pointerout"||h==="pointerover")&&($t=Us,At="onPointerLeave",lt="onPointerEnter",tt="pointer"),ar=Mt==null?_t:Fi(Mt),ct=Dt==null?_t:Fi(Dt),_t=new $t(At,tt+"leave",Mt,w,Tt),_t.target=ar,_t.relatedTarget=ct,At=null,Zn(Tt)===dt&&($t=new $t(lt,tt+"enter",Dt,w,Tt),$t.target=ct,$t.relatedTarget=ar,At=$t),ar=At,Mt&&Dt)t:{for($t=Mt,lt=Dt,tt=0,ct=$t;ct;ct=Pi(ct))tt++;for(ct=0,At=lt;At;At=Pi(At))ct++;for(;0<tt-ct;)$t=Pi($t),tt--;for(;0<ct-tt;)lt=Pi(lt),ct--;for(;tt--;){if($t===lt||lt!==null&&$t===lt.alternate)break t;$t=Pi($t),lt=Pi(lt)}$t=null}else $t=null;Mt!==null&&Wl(wt,_t,Mt,$t,!1),Dt!==null&&ar!==null&&Wl(wt,ar,Dt,$t,!0)}}e:{if(_t=dt?Fi(dt):window,Mt=_t.nodeName&&_t.nodeName.toLowerCase(),Mt==="select"||Mt==="input"&&_t.type==="file")var Ht=Ct;else if(B(_t))if(Ot)Ht=Ic;else{Ht=rr;var Bt=_r}else(Mt=_t.nodeName)&&Mt.toLowerCase()==="input"&&(_t.type==="checkbox"||_t.type==="radio")&&(Ht=an);if(Ht&&(Ht=Ht(h,dt))){se(wt,Ht,w,Tt);break e}Bt&&Bt(h,_t,dt),h==="focusout"&&(Bt=_t._wrapperState)&&Bt.controlled&&_t.type==="number"&&nt(_t,"number",_t.value)}switch(Bt=dt?Fi(dt):window,h){case"focusin":(B(Bt)||Bt.contentEditable==="true")&&(Oi=Bt,ca=dt,cs=null);break;case"focusout":cs=ca=Oi=null;break;case"mousedown":da=!0;break;case"contextmenu":case"mouseup":case"dragend":da=!1,Fl(wt,w,Tt);break;case"selectionchange":if(Pc)break;case"keydown":case"keyup":Fl(wt,w,Tt)}var Ut;if(Qn)e:{switch(h){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else Nn?Ii(h,w)&&(jt="onCompositionEnd"):h==="keydown"&&w.keyCode===229&&(jt="onCompositionStart");jt&&(Ni&&w.locale!=="ko"&&(Nn||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&Nn&&(Ut=$s()):(sn=Tt,Zi="value"in sn?sn.value:sn.textContent,Nn=!0)),Bt=Ws(dt,jt),0<Bt.length&&(jt=new Bs(jt,h,null,w,Tt),wt.push({event:jt,listeners:Bt}),Ut?jt.data=Ut:(Ut=An(w),Ut!==null&&(jt.data=Ut)))),(Ut=ss?p(h,w):S(h,w))&&(dt=Ws(dt,"onBeforeInput"),0<dt.length&&(Tt=new Bs("onBeforeInput","beforeinput",null,w,Tt),wt.push({event:Tt,listeners:dt}),Tt.data=Ut))}Gl(wt,g)})}function fs(h,g,w){return{instance:h,listener:g,currentTarget:w}}function Ws(h,g){for(var w=g+"Capture",I=[];h!==null;){var W=h,J=W.stateNode;W.tag===5&&J!==null&&(W=J,J=Q(h,w),J!=null&&I.unshift(fs(h,J,W)),J=Q(h,g),J!=null&&I.push(fs(h,J,W))),h=h.return}return I}function Pi(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function Wl(h,g,w,I,W){for(var J=g._reactName,Ee=[];w!==null&&w!==I;){var Be=w,Je=Be.alternate,dt=Be.stateNode;if(Je!==null&&Je===I)break;Be.tag===5&&dt!==null&&(Be=dt,W?(Je=Q(w,J),Je!=null&&Ee.unshift(fs(w,Je,Be))):W||(Je=Q(w,J),Je!=null&&Ee.push(fs(w,Je,Be)))),w=w.return}Ee.length!==0&&h.push({event:g,listeners:Ee})}var Dc=/\r\n?/g,$c=/\u0000|\uFFFD/g;function zl(h){return(typeof h=="string"?h:""+h).replace(Dc,`
`).replace($c,"")}function zs(h,g,w){if(g=zl(g),zl(h)!==g&&w)throw Error(t(425))}function qs(){}var ya=null,Ea=null;function Ca(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var va=typeof setTimeout=="function"?setTimeout:void 0,kc=typeof clearTimeout=="function"?clearTimeout:void 0,ql=typeof Promise=="function"?Promise:void 0,Hc=typeof queueMicrotask=="function"?queueMicrotask:typeof ql<"u"?function(h){return ql.resolve(null).then(h).catch(Bc)}:va;function Bc(h){setTimeout(function(){throw h})}function Sa(h,g){var w=g,I=0;do{var W=w.nextSibling;if(h.removeChild(w),W&&W.nodeType===8)if(w=W.data,w==="/$"){if(I===0){h.removeChild(W),Kn(g);return}I--}else w!=="$"&&w!=="$?"&&w!=="$!"||I++;w=W}while(w);Kn(g)}function On(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return h}function Yl(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var w=h.data;if(w==="$"||w==="$!"||w==="$?"){if(g===0)return h;g--}else w==="/$"&&g++}h=h.previousSibling}return null}var xi=Math.random().toString(36).slice(2),un="__reactFiber$"+xi,ps="__reactProps$"+xi,mn="__reactContainer$"+xi,_a="__reactEvents$"+xi,Uc="__reactListeners$"+xi,Vc="__reactHandles$"+xi;function Zn(h){var g=h[un];if(g)return g;for(var w=h.parentNode;w;){if(g=w[mn]||w[un]){if(w=g.alternate,g.child!==null||w!==null&&w.child!==null)for(h=Yl(h);h!==null;){if(w=h[un])return w;h=Yl(h)}return g}h=w,w=h.parentNode}return null}function ms(h){return h=h[un]||h[mn],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function Fi(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(t(33))}function Ys(h){return h[ps]||null}var Ta=[],Li=-1;function Mn(h){return{current:h}}function tr(h){0>Li||(h.current=Ta[Li],Ta[Li]=null,Li--)}function Zt(h,g){Li++,Ta[Li]=h.current,h.current=g}var Pn={},Tr=Mn(Pn),Or=Mn(!1),ei=Pn;function Di(h,g){var w=h.type.contextTypes;if(!w)return Pn;var I=h.stateNode;if(I&&I.__reactInternalMemoizedUnmaskedChildContext===g)return I.__reactInternalMemoizedMaskedChildContext;var W={},J;for(J in w)W[J]=g[J];return I&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=g,h.__reactInternalMemoizedMaskedChildContext=W),W}function Mr(h){return h=h.childContextTypes,h!=null}function Ks(){tr(Or),tr(Tr)}function Kl(h,g,w){if(Tr.current!==Pn)throw Error(t(168));Zt(Tr,g),Zt(Or,w)}function Xl(h,g,w){var I=h.stateNode;if(g=g.childContextTypes,typeof I.getChildContext!="function")return w;I=I.getChildContext();for(var W in I)if(!(W in g))throw Error(t(108,Ue(h)||"Unknown",W));return rt({},w,I)}function Xs(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||Pn,ei=Tr.current,Zt(Tr,h),Zt(Or,Or.current),!0}function Jl(h,g,w){var I=h.stateNode;if(!I)throw Error(t(169));w?(h=Xl(h,g,ei),I.__reactInternalMemoizedMergedChildContext=h,tr(Or),tr(Tr),Zt(Tr,h)):tr(Or),Zt(Or,w)}var gn=null,Js=!1,wa=!1;function Ql(h){gn===null?gn=[h]:gn.push(h)}function Gc(h){Js=!0,Ql(h)}function xn(){if(!wa&&gn!==null){wa=!0;var h=0,g=Wt;try{var w=gn;for(Wt=1;h<w.length;h++){var I=w[h];do I=I(!0);while(I!==null)}gn=null,Js=!1}catch(W){throw gn!==null&&(gn=gn.slice(h+1)),ht(pr,xn),W}finally{Wt=g,wa=!1}}return null}var $i=[],ki=0,Qs=null,Zs=0,Gr=[],jr=0,ti=null,yn=1,En="";function ri(h,g){$i[ki++]=Zs,$i[ki++]=Qs,Qs=h,Zs=g}function Zl(h,g,w){Gr[jr++]=yn,Gr[jr++]=En,Gr[jr++]=ti,ti=h;var I=yn;h=En;var W=32-Cr(I)-1;I&=~(1<<W),w+=1;var J=32-Cr(g)+W;if(30<J){var Ee=W-W%5;J=(I&(1<<Ee)-1).toString(32),I>>=Ee,W-=Ee,yn=1<<32-Cr(g)+W|w<<W|I,En=J+h}else yn=1<<J|w<<W|I,En=h}function Ra(h){h.return!==null&&(ri(h,1),Zl(h,1,0))}function ba(h){for(;h===Qs;)Qs=$i[--ki],$i[ki]=null,Zs=$i[--ki],$i[ki]=null;for(;h===ti;)ti=Gr[--jr],Gr[jr]=null,En=Gr[--jr],Gr[jr]=null,yn=Gr[--jr],Gr[jr]=null}var kr=null,Hr=null,nr=!1,Jr=null;function eu(h,g){var w=Yr(5,null,null,0);w.elementType="DELETED",w.stateNode=g,w.return=h,g=h.deletions,g===null?(h.deletions=[w],h.flags|=16):g.push(w)}function tu(h,g){switch(h.tag){case 5:var w=h.type;return g=g.nodeType!==1||w.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(h.stateNode=g,kr=h,Hr=On(g.firstChild),!0):!1;case 6:return g=h.pendingProps===""||g.nodeType!==3?null:g,g!==null?(h.stateNode=g,kr=h,Hr=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(w=ti!==null?{id:yn,overflow:En}:null,h.memoizedState={dehydrated:g,treeContext:w,retryLane:1073741824},w=Yr(18,null,null,0),w.stateNode=g,w.return=h,h.child=w,kr=h,Hr=null,!0):!1;default:return!1}}function Aa(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Na(h){if(nr){var g=Hr;if(g){var w=g;if(!tu(h,g)){if(Aa(h))throw Error(t(418));g=On(w.nextSibling);var I=kr;g&&tu(h,g)?eu(I,w):(h.flags=h.flags&-4097|2,nr=!1,kr=h)}}else{if(Aa(h))throw Error(t(418));h.flags=h.flags&-4097|2,nr=!1,kr=h}}}function ru(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;kr=h}function eo(h){if(h!==kr)return!1;if(!nr)return ru(h),nr=!0,!1;var g;if((g=h.tag!==3)&&!(g=h.tag!==5)&&(g=h.type,g=g!=="head"&&g!=="body"&&!Ca(h.type,h.memoizedProps)),g&&(g=Hr)){if(Aa(h))throw nu(),Error(t(418));for(;g;)eu(h,g),g=On(g.nextSibling)}if(ru(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(t(317));e:{for(h=h.nextSibling,g=0;h;){if(h.nodeType===8){var w=h.data;if(w==="/$"){if(g===0){Hr=On(h.nextSibling);break e}g--}else w!=="$"&&w!=="$!"&&w!=="$?"||g++}h=h.nextSibling}Hr=null}}else Hr=kr?On(h.stateNode.nextSibling):null;return!0}function nu(){for(var h=Hr;h;)h=On(h.nextSibling)}function Hi(){Hr=kr=null,nr=!1}function Ia(h){Jr===null?Jr=[h]:Jr.push(h)}var jc=N.ReactCurrentBatchConfig;function gs(h,g,w){if(h=w.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(t(309));var I=w.stateNode}if(!I)throw Error(t(147,h));var W=I,J=""+h;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===J?g.ref:(g=function(Ee){var Be=W.refs;Ee===null?delete Be[J]:Be[J]=Ee},g._stringRef=J,g)}if(typeof h!="string")throw Error(t(284));if(!w._owner)throw Error(t(290,h))}return h}function ro(h,g){throw h=Object.prototype.toString.call(g),Error(t(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h))}function iu(h){var g=h._init;return g(h._payload)}function su(h){function g(lt,tt){if(h){var ct=lt.deletions;ct===null?(lt.deletions=[tt],lt.flags|=16):ct.push(tt)}}function w(lt,tt){if(!h)return null;for(;tt!==null;)g(lt,tt),tt=tt.sibling;return null}function I(lt,tt){for(lt=new Map;tt!==null;)tt.key!==null?lt.set(tt.key,tt):lt.set(tt.index,tt),tt=tt.sibling;return lt}function W(lt,tt){return lt=Un(lt,tt),lt.index=0,lt.sibling=null,lt}function J(lt,tt,ct){return lt.index=ct,h?(ct=lt.alternate,ct!==null?(ct=ct.index,ct<tt?(lt.flags|=2,tt):ct):(lt.flags|=2,tt)):(lt.flags|=1048576,tt)}function Ee(lt){return h&&lt.alternate===null&&(lt.flags|=2),lt}function Be(lt,tt,ct,At){return tt===null||tt.tag!==6?(tt=vl(ct,lt.mode,At),tt.return=lt,tt):(tt=W(tt,ct),tt.return=lt,tt)}function Je(lt,tt,ct,At){var Ht=ct.type;return Ht===k?Tt(lt,tt,ct.props.children,At,ct.key):tt!==null&&(tt.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===Pe&&iu(Ht)===tt.type)?(At=W(tt,ct.props),At.ref=gs(lt,tt,ct),At.return=lt,At):(At=Ao(ct.type,ct.key,ct.props,null,lt.mode,At),At.ref=gs(lt,tt,ct),At.return=lt,At)}function dt(lt,tt,ct,At){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==ct.containerInfo||tt.stateNode.implementation!==ct.implementation?(tt=Sl(ct,lt.mode,At),tt.return=lt,tt):(tt=W(tt,ct.children||[]),tt.return=lt,tt)}function Tt(lt,tt,ct,At,Ht){return tt===null||tt.tag!==7?(tt=ci(ct,lt.mode,At,Ht),tt.return=lt,tt):(tt=W(tt,ct),tt.return=lt,tt)}function wt(lt,tt,ct){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return tt=vl(""+tt,lt.mode,ct),tt.return=lt,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case G:return ct=Ao(tt.type,tt.key,tt.props,null,lt.mode,ct),ct.ref=gs(lt,null,tt),ct.return=lt,ct;case D:return tt=Sl(tt,lt.mode,ct),tt.return=lt,tt;case Pe:var At=tt._init;return wt(lt,At(tt._payload),ct)}if(Ze(tt)||st(tt))return tt=ci(tt,lt.mode,ct,null),tt.return=lt,tt;ro(lt,tt)}return null}function _t(lt,tt,ct,At){var Ht=tt!==null?tt.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number")return Ht!==null?null:Be(lt,tt,""+ct,At);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case G:return ct.key===Ht?Je(lt,tt,ct,At):null;case D:return ct.key===Ht?dt(lt,tt,ct,At):null;case Pe:return Ht=ct._init,_t(lt,tt,Ht(ct._payload),At)}if(Ze(ct)||st(ct))return Ht!==null?null:Tt(lt,tt,ct,At,null);ro(lt,ct)}return null}function Mt(lt,tt,ct,At,Ht){if(typeof At=="string"&&At!==""||typeof At=="number")return lt=lt.get(ct)||null,Be(tt,lt,""+At,Ht);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case G:return lt=lt.get(At.key===null?ct:At.key)||null,Je(tt,lt,At,Ht);case D:return lt=lt.get(At.key===null?ct:At.key)||null,dt(tt,lt,At,Ht);case Pe:var Bt=At._init;return Mt(lt,tt,ct,Bt(At._payload),Ht)}if(Ze(At)||st(At))return lt=lt.get(ct)||null,Tt(tt,lt,At,Ht,null);ro(tt,At)}return null}function Dt(lt,tt,ct,At){for(var Ht=null,Bt=null,Ut=tt,jt=tt=0,Er=null;Ut!==null&&jt<ct.length;jt++){Ut.index>jt?(Er=Ut,Ut=null):Er=Ut.sibling;var Jt=_t(lt,Ut,ct[jt],At);if(Jt===null){Ut===null&&(Ut=Er);break}h&&Ut&&Jt.alternate===null&&g(lt,Ut),tt=J(Jt,tt,jt),Bt===null?Ht=Jt:Bt.sibling=Jt,Bt=Jt,Ut=Er}if(jt===ct.length)return w(lt,Ut),nr&&ri(lt,jt),Ht;if(Ut===null){for(;jt<ct.length;jt++)Ut=wt(lt,ct[jt],At),Ut!==null&&(tt=J(Ut,tt,jt),Bt===null?Ht=Ut:Bt.sibling=Ut,Bt=Ut);return nr&&ri(lt,jt),Ht}for(Ut=I(lt,Ut);jt<ct.length;jt++)Er=Mt(Ut,lt,jt,ct[jt],At),Er!==null&&(h&&Er.alternate!==null&&Ut.delete(Er.key===null?jt:Er.key),tt=J(Er,tt,jt),Bt===null?Ht=Er:Bt.sibling=Er,Bt=Er);return h&&Ut.forEach(function(Vn){return g(lt,Vn)}),nr&&ri(lt,jt),Ht}function $t(lt,tt,ct,At){var Ht=st(ct);if(typeof Ht!="function")throw Error(t(150));if(ct=Ht.call(ct),ct==null)throw Error(t(151));for(var Bt=Ht=null,Ut=tt,jt=tt=0,Er=null,Jt=ct.next();Ut!==null&&!Jt.done;jt++,Jt=ct.next()){Ut.index>jt?(Er=Ut,Ut=null):Er=Ut.sibling;var Vn=_t(lt,Ut,Jt.value,At);if(Vn===null){Ut===null&&(Ut=Er);break}h&&Ut&&Vn.alternate===null&&g(lt,Ut),tt=J(Vn,tt,jt),Bt===null?Ht=Vn:Bt.sibling=Vn,Bt=Vn,Ut=Er}if(Jt.done)return w(lt,Ut),nr&&ri(lt,jt),Ht;if(Ut===null){for(;!Jt.done;jt++,Jt=ct.next())Jt=wt(lt,Jt.value,At),Jt!==null&&(tt=J(Jt,tt,jt),Bt===null?Ht=Jt:Bt.sibling=Jt,Bt=Jt);return nr&&ri(lt,jt),Ht}for(Ut=I(lt,Ut);!Jt.done;jt++,Jt=ct.next())Jt=Mt(Ut,lt,jt,Jt.value,At),Jt!==null&&(h&&Jt.alternate!==null&&Ut.delete(Jt.key===null?jt:Jt.key),tt=J(Jt,tt,jt),Bt===null?Ht=Jt:Bt.sibling=Jt,Bt=Jt);return h&&Ut.forEach(function(_d){return g(lt,_d)}),nr&&ri(lt,jt),Ht}function ar(lt,tt,ct,At){if(typeof ct=="object"&&ct!==null&&ct.type===k&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case G:e:{for(var Ht=ct.key,Bt=tt;Bt!==null;){if(Bt.key===Ht){if(Ht=ct.type,Ht===k){if(Bt.tag===7){w(lt,Bt.sibling),tt=W(Bt,ct.props.children),tt.return=lt,lt=tt;break e}}else if(Bt.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===Pe&&iu(Ht)===Bt.type){w(lt,Bt.sibling),tt=W(Bt,ct.props),tt.ref=gs(lt,Bt,ct),tt.return=lt,lt=tt;break e}w(lt,Bt);break}else g(lt,Bt);Bt=Bt.sibling}ct.type===k?(tt=ci(ct.props.children,lt.mode,At,ct.key),tt.return=lt,lt=tt):(At=Ao(ct.type,ct.key,ct.props,null,lt.mode,At),At.ref=gs(lt,tt,ct),At.return=lt,lt=At)}return Ee(lt);case D:e:{for(Bt=ct.key;tt!==null;){if(tt.key===Bt)if(tt.tag===4&&tt.stateNode.containerInfo===ct.containerInfo&&tt.stateNode.implementation===ct.implementation){w(lt,tt.sibling),tt=W(tt,ct.children||[]),tt.return=lt,lt=tt;break e}else{w(lt,tt);break}else g(lt,tt);tt=tt.sibling}tt=Sl(ct,lt.mode,At),tt.return=lt,lt=tt}return Ee(lt);case Pe:return Bt=ct._init,ar(lt,tt,Bt(ct._payload),At)}if(Ze(ct))return Dt(lt,tt,ct,At);if(st(ct))return $t(lt,tt,ct,At);ro(lt,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"?(ct=""+ct,tt!==null&&tt.tag===6?(w(lt,tt.sibling),tt=W(tt,ct),tt.return=lt,lt=tt):(w(lt,tt),tt=vl(ct,lt.mode,At),tt.return=lt,lt=tt),Ee(lt)):w(lt,tt)}return ar}var Bi=su(!0),ou=su(!1),no=Mn(null),io=null,Ui=null,Oa=null;function Ma(){Oa=Ui=io=null}function Pa(h){var g=no.current;tr(no),h._currentValue=g}function xa(h,g,w){for(;h!==null;){var I=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,I!==null&&(I.childLanes|=g)):I!==null&&(I.childLanes&g)!==g&&(I.childLanes|=g),h===w)break;h=h.return}}function Vi(h,g){io=h,Oa=Ui=null,h=h.dependencies,h!==null&&h.firstContext!==null&&(h.lanes&g&&(Pr=!0),h.firstContext=null)}function Wr(h){var g=h._currentValue;if(Oa!==h)if(h={context:h,memoizedValue:g,next:null},Ui===null){if(io===null)throw Error(t(308));Ui=h,io.dependencies={lanes:0,firstContext:h}}else Ui=Ui.next=h;return g}var ni=null;function Fa(h){ni===null?ni=[h]:ni.push(h)}function au(h,g,w,I){var W=g.interleaved;return W===null?(w.next=w,Fa(g)):(w.next=W.next,W.next=w),g.interleaved=w,Cn(h,I)}function Cn(h,g){h.lanes|=g;var w=h.alternate;for(w!==null&&(w.lanes|=g),w=h,h=h.return;h!==null;)h.childLanes|=g,w=h.alternate,w!==null&&(w.childLanes|=g),w=h,h=h.return;return w.tag===3?w.stateNode:null}var Fn=!1;function La(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lu(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function vn(h,g){return{eventTime:h,lane:g,tag:0,payload:null,callback:null,next:null}}function Ln(h,g,w){var I=h.updateQueue;if(I===null)return null;if(I=I.shared,Xt&2){var W=I.pending;return W===null?g.next=g:(g.next=W.next,W.next=g),I.pending=g,Cn(h,w)}return W=I.interleaved,W===null?(g.next=g,Fa(I)):(g.next=W.next,W.next=g),I.interleaved=g,Cn(h,w)}function so(h,g,w){if(g=g.updateQueue,g!==null&&(g=g.shared,(w&4194240)!==0)){var I=g.lanes;I&=h.pendingLanes,w|=I,g.lanes=w,Ei(h,w)}}function uu(h,g){var w=h.updateQueue,I=h.alternate;if(I!==null&&(I=I.updateQueue,w===I)){var W=null,J=null;if(w=w.firstBaseUpdate,w!==null){do{var Ee={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};J===null?W=J=Ee:J=J.next=Ee,w=w.next}while(w!==null);J===null?W=J=g:J=J.next=g}else W=J=g;w={baseState:I.baseState,firstBaseUpdate:W,lastBaseUpdate:J,shared:I.shared,effects:I.effects},h.updateQueue=w;return}h=w.lastBaseUpdate,h===null?w.firstBaseUpdate=g:h.next=g,w.lastBaseUpdate=g}function oo(h,g,w,I){var W=h.updateQueue;Fn=!1;var J=W.firstBaseUpdate,Ee=W.lastBaseUpdate,Be=W.shared.pending;if(Be!==null){W.shared.pending=null;var Je=Be,dt=Je.next;Je.next=null,Ee===null?J=dt:Ee.next=dt,Ee=Je;var Tt=h.alternate;Tt!==null&&(Tt=Tt.updateQueue,Be=Tt.lastBaseUpdate,Be!==Ee&&(Be===null?Tt.firstBaseUpdate=dt:Be.next=dt,Tt.lastBaseUpdate=Je))}if(J!==null){var wt=W.baseState;Ee=0,Tt=dt=Je=null,Be=J;do{var _t=Be.lane,Mt=Be.eventTime;if((I&_t)===_t){Tt!==null&&(Tt=Tt.next={eventTime:Mt,lane:0,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null});e:{var Dt=h,$t=Be;switch(_t=g,Mt=w,$t.tag){case 1:if(Dt=$t.payload,typeof Dt=="function"){wt=Dt.call(Mt,wt,_t);break e}wt=Dt;break e;case 3:Dt.flags=Dt.flags&-65537|128;case 0:if(Dt=$t.payload,_t=typeof Dt=="function"?Dt.call(Mt,wt,_t):Dt,_t==null)break e;wt=rt({},wt,_t);break e;case 2:Fn=!0}}Be.callback!==null&&Be.lane!==0&&(h.flags|=64,_t=W.effects,_t===null?W.effects=[Be]:_t.push(Be))}else Mt={eventTime:Mt,lane:_t,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},Tt===null?(dt=Tt=Mt,Je=wt):Tt=Tt.next=Mt,Ee|=_t;if(Be=Be.next,Be===null){if(Be=W.shared.pending,Be===null)break;_t=Be,Be=_t.next,_t.next=null,W.lastBaseUpdate=_t,W.shared.pending=null}}while(!0);if(Tt===null&&(Je=wt),W.baseState=Je,W.firstBaseUpdate=dt,W.lastBaseUpdate=Tt,g=W.shared.interleaved,g!==null){W=g;do Ee|=W.lane,W=W.next;while(W!==g)}else J===null&&(W.shared.lanes=0);oi|=Ee,h.lanes=Ee,h.memoizedState=wt}}function cu(h,g,w){if(h=g.effects,g.effects=null,h!==null)for(g=0;g<h.length;g++){var I=h[g],W=I.callback;if(W!==null){if(I.callback=null,I=w,typeof W!="function")throw Error(t(191,W));W.call(I)}}}var ys={},cn=Mn(ys),Es=Mn(ys),Cs=Mn(ys);function ii(h){if(h===ys)throw Error(t(174));return h}function Da(h,g){switch(Zt(Cs,g),Zt(Es,h),Zt(cn,ys),h=g.nodeType,h){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:b(null,"");break;default:h=h===8?g.parentNode:g,g=h.namespaceURI||null,h=h.tagName,g=b(g,h)}tr(cn),Zt(cn,g)}function Gi(){tr(cn),tr(Es),tr(Cs)}function du(h){ii(Cs.current);var g=ii(cn.current),w=b(g,h.type);g!==w&&(Zt(Es,h),Zt(cn,w))}function $a(h){Es.current===h&&(tr(cn),tr(Es))}var ir=Mn(0);function ao(h){for(var g=h;g!==null;){if(g.tag===13){var w=g.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var ka=[];function Ha(){for(var h=0;h<ka.length;h++)ka[h]._workInProgressVersionPrimary=null;ka.length=0}var lo=N.ReactCurrentDispatcher,Ba=N.ReactCurrentBatchConfig,si=0,sr=null,hr=null,gr=null,uo=!1,vs=!1,Ss=0,Wc=0;function wr(){throw Error(t(321))}function Ua(h,g){if(g===null)return!1;for(var w=0;w<g.length&&w<h.length;w++)if(!Xr(h[w],g[w]))return!1;return!0}function Va(h,g,w,I,W,J){if(si=J,sr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,lo.current=h===null||h.memoizedState===null?Kc:Xc,h=w(I,W),vs){J=0;do{if(vs=!1,Ss=0,25<=J)throw Error(t(301));J+=1,gr=hr=null,g.updateQueue=null,lo.current=Jc,h=w(I,W)}while(vs)}if(lo.current=fo,g=hr!==null&&hr.next!==null,si=0,gr=hr=sr=null,uo=!1,g)throw Error(t(300));return h}function Ga(){var h=Ss!==0;return Ss=0,h}function dn(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?sr.memoizedState=gr=h:gr=gr.next=h,gr}function zr(){if(hr===null){var h=sr.alternate;h=h!==null?h.memoizedState:null}else h=hr.next;var g=gr===null?sr.memoizedState:gr.next;if(g!==null)gr=g,hr=h;else{if(h===null)throw Error(t(310));hr=h,h={memoizedState:hr.memoizedState,baseState:hr.baseState,baseQueue:hr.baseQueue,queue:hr.queue,next:null},gr===null?sr.memoizedState=gr=h:gr=gr.next=h}return gr}function _s(h,g){return typeof g=="function"?g(h):g}function ja(h){var g=zr(),w=g.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=h;var I=hr,W=I.baseQueue,J=w.pending;if(J!==null){if(W!==null){var Ee=W.next;W.next=J.next,J.next=Ee}I.baseQueue=W=J,w.pending=null}if(W!==null){J=W.next,I=I.baseState;var Be=Ee=null,Je=null,dt=J;do{var Tt=dt.lane;if((si&Tt)===Tt)Je!==null&&(Je=Je.next={lane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),I=dt.hasEagerState?dt.eagerState:h(I,dt.action);else{var wt={lane:Tt,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null};Je===null?(Be=Je=wt,Ee=I):Je=Je.next=wt,sr.lanes|=Tt,oi|=Tt}dt=dt.next}while(dt!==null&&dt!==J);Je===null?Ee=I:Je.next=Be,Xr(I,g.memoizedState)||(Pr=!0),g.memoizedState=I,g.baseState=Ee,g.baseQueue=Je,w.lastRenderedState=I}if(h=w.interleaved,h!==null){W=h;do J=W.lane,sr.lanes|=J,oi|=J,W=W.next;while(W!==h)}else W===null&&(w.lanes=0);return[g.memoizedState,w.dispatch]}function Wa(h){var g=zr(),w=g.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=h;var I=w.dispatch,W=w.pending,J=g.memoizedState;if(W!==null){w.pending=null;var Ee=W=W.next;do J=h(J,Ee.action),Ee=Ee.next;while(Ee!==W);Xr(J,g.memoizedState)||(Pr=!0),g.memoizedState=J,g.baseQueue===null&&(g.baseState=J),w.lastRenderedState=J}return[J,I]}function hu(){}function fu(h,g){var w=sr,I=zr(),W=g(),J=!Xr(I.memoizedState,W);if(J&&(I.memoizedState=W,Pr=!0),I=I.queue,za(gu.bind(null,w,I,h),[h]),I.getSnapshot!==g||J||gr!==null&&gr.memoizedState.tag&1){if(w.flags|=2048,Ts(9,mu.bind(null,w,I,W,g),void 0,null),yr===null)throw Error(t(349));si&30||pu(w,g,W)}return W}function pu(h,g,w){h.flags|=16384,h={getSnapshot:g,value:w},g=sr.updateQueue,g===null?(g={lastEffect:null,stores:null},sr.updateQueue=g,g.stores=[h]):(w=g.stores,w===null?g.stores=[h]:w.push(h))}function mu(h,g,w,I){g.value=w,g.getSnapshot=I,yu(g)&&Eu(h)}function gu(h,g,w){return w(function(){yu(g)&&Eu(h)})}function yu(h){var g=h.getSnapshot;h=h.value;try{var w=g();return!Xr(h,w)}catch{return!0}}function Eu(h){var g=Cn(h,1);g!==null&&tn(g,h,1,-1)}function Cu(h){var g=dn();return typeof h=="function"&&(h=h()),g.memoizedState=g.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:h},g.queue=h,h=h.dispatch=Yc.bind(null,sr,h),[g.memoizedState,h]}function Ts(h,g,w,I){return h={tag:h,create:g,destroy:w,deps:I,next:null},g=sr.updateQueue,g===null?(g={lastEffect:null,stores:null},sr.updateQueue=g,g.lastEffect=h.next=h):(w=g.lastEffect,w===null?g.lastEffect=h.next=h:(I=w.next,w.next=h,h.next=I,g.lastEffect=h)),h}function vu(){return zr().memoizedState}function co(h,g,w,I){var W=dn();sr.flags|=h,W.memoizedState=Ts(1|g,w,void 0,I===void 0?null:I)}function ho(h,g,w,I){var W=zr();I=I===void 0?null:I;var J=void 0;if(hr!==null){var Ee=hr.memoizedState;if(J=Ee.destroy,I!==null&&Ua(I,Ee.deps)){W.memoizedState=Ts(g,w,J,I);return}}sr.flags|=h,W.memoizedState=Ts(1|g,w,J,I)}function Su(h,g){return co(8390656,8,h,g)}function za(h,g){return ho(2048,8,h,g)}function _u(h,g){return ho(4,2,h,g)}function Tu(h,g){return ho(4,4,h,g)}function wu(h,g){if(typeof g=="function")return h=h(),g(h),function(){g(null)};if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function Ru(h,g,w){return w=w!=null?w.concat([h]):null,ho(4,4,wu.bind(null,g,h),w)}function qa(){}function bu(h,g){var w=zr();g=g===void 0?null:g;var I=w.memoizedState;return I!==null&&g!==null&&Ua(g,I[1])?I[0]:(w.memoizedState=[h,g],h)}function Au(h,g){var w=zr();g=g===void 0?null:g;var I=w.memoizedState;return I!==null&&g!==null&&Ua(g,I[1])?I[0]:(h=h(),w.memoizedState=[h,g],h)}function Nu(h,g,w){return si&21?(Xr(w,g)||(w=Xi(),sr.lanes|=w,oi|=w,h.baseState=!0),g):(h.baseState&&(h.baseState=!1,Pr=!0),h.memoizedState=w)}function zc(h,g){var w=Wt;Wt=w!==0&&4>w?w:4,h(!0);var I=Ba.transition;Ba.transition={};try{h(!1),g()}finally{Wt=w,Ba.transition=I}}function Iu(){return zr().memoizedState}function qc(h,g,w){var I=Hn(h);if(w={lane:I,action:w,hasEagerState:!1,eagerState:null,next:null},Ou(h))Mu(g,w);else if(w=au(h,g,w,I),w!==null){var W=Ir();tn(w,h,I,W),Pu(w,g,I)}}function Yc(h,g,w){var I=Hn(h),W={lane:I,action:w,hasEagerState:!1,eagerState:null,next:null};if(Ou(h))Mu(g,W);else{var J=h.alternate;if(h.lanes===0&&(J===null||J.lanes===0)&&(J=g.lastRenderedReducer,J!==null))try{var Ee=g.lastRenderedState,Be=J(Ee,w);if(W.hasEagerState=!0,W.eagerState=Be,Xr(Be,Ee)){var Je=g.interleaved;Je===null?(W.next=W,Fa(g)):(W.next=Je.next,Je.next=W),g.interleaved=W;return}}catch{}finally{}w=au(h,g,W,I),w!==null&&(W=Ir(),tn(w,h,I,W),Pu(w,g,I))}}function Ou(h){var g=h.alternate;return h===sr||g!==null&&g===sr}function Mu(h,g){vs=uo=!0;var w=h.pending;w===null?g.next=g:(g.next=w.next,w.next=g),h.pending=g}function Pu(h,g,w){if(w&4194240){var I=g.lanes;I&=h.pendingLanes,w|=I,g.lanes=w,Ei(h,w)}}var fo={readContext:Wr,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useInsertionEffect:wr,useLayoutEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useMutableSource:wr,useSyncExternalStore:wr,useId:wr,unstable_isNewReconciler:!1},Kc={readContext:Wr,useCallback:function(h,g){return dn().memoizedState=[h,g===void 0?null:g],h},useContext:Wr,useEffect:Su,useImperativeHandle:function(h,g,w){return w=w!=null?w.concat([h]):null,co(4194308,4,wu.bind(null,g,h),w)},useLayoutEffect:function(h,g){return co(4194308,4,h,g)},useInsertionEffect:function(h,g){return co(4,2,h,g)},useMemo:function(h,g){var w=dn();return g=g===void 0?null:g,h=h(),w.memoizedState=[h,g],h},useReducer:function(h,g,w){var I=dn();return g=w!==void 0?w(g):g,I.memoizedState=I.baseState=g,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:g},I.queue=h,h=h.dispatch=qc.bind(null,sr,h),[I.memoizedState,h]},useRef:function(h){var g=dn();return h={current:h},g.memoizedState=h},useState:Cu,useDebugValue:qa,useDeferredValue:function(h){return dn().memoizedState=h},useTransition:function(){var h=Cu(!1),g=h[0];return h=zc.bind(null,h[1]),dn().memoizedState=h,[g,h]},useMutableSource:function(){},useSyncExternalStore:function(h,g,w){var I=sr,W=dn();if(nr){if(w===void 0)throw Error(t(407));w=w()}else{if(w=g(),yr===null)throw Error(t(349));si&30||pu(I,g,w)}W.memoizedState=w;var J={value:w,getSnapshot:g};return W.queue=J,Su(gu.bind(null,I,J,h),[h]),I.flags|=2048,Ts(9,mu.bind(null,I,J,w,g),void 0,null),w},useId:function(){var h=dn(),g=yr.identifierPrefix;if(nr){var w=En,I=yn;w=(I&~(1<<32-Cr(I)-1)).toString(32)+w,g=":"+g+"R"+w,w=Ss++,0<w&&(g+="H"+w.toString(32)),g+=":"}else w=Wc++,g=":"+g+"r"+w.toString(32)+":";return h.memoizedState=g},unstable_isNewReconciler:!1},Xc={readContext:Wr,useCallback:bu,useContext:Wr,useEffect:za,useImperativeHandle:Ru,useInsertionEffect:_u,useLayoutEffect:Tu,useMemo:Au,useReducer:ja,useRef:vu,useState:function(){return ja(_s)},useDebugValue:qa,useDeferredValue:function(h){var g=zr();return Nu(g,hr.memoizedState,h)},useTransition:function(){var h=ja(_s)[0],g=zr().memoizedState;return[h,g]},useMutableSource:hu,useSyncExternalStore:fu,useId:Iu,unstable_isNewReconciler:!1},Jc={readContext:Wr,useCallback:bu,useContext:Wr,useEffect:za,useImperativeHandle:Ru,useInsertionEffect:_u,useLayoutEffect:Tu,useMemo:Au,useReducer:Wa,useRef:vu,useState:function(){return Wa(_s)},useDebugValue:qa,useDeferredValue:function(h){var g=zr();return hr===null?g.memoizedState=h:Nu(g,hr.memoizedState,h)},useTransition:function(){var h=Wa(_s)[0],g=zr().memoizedState;return[h,g]},useMutableSource:hu,useSyncExternalStore:fu,useId:Iu,unstable_isNewReconciler:!1};function Qr(h,g){if(h&&h.defaultProps){g=rt({},g),h=h.defaultProps;for(var w in h)g[w]===void 0&&(g[w]=h[w]);return g}return g}function Ya(h,g,w,I){g=h.memoizedState,w=w(I,g),w=w==null?g:rt({},g,w),h.memoizedState=w,h.lanes===0&&(h.updateQueue.baseState=w)}var po={isMounted:function(h){return(h=h._reactInternals)?He(h)===h:!1},enqueueSetState:function(h,g,w){h=h._reactInternals;var I=Ir(),W=Hn(h),J=vn(I,W);J.payload=g,w!=null&&(J.callback=w),g=Ln(h,J,W),g!==null&&(tn(g,h,W,I),so(g,h,W))},enqueueReplaceState:function(h,g,w){h=h._reactInternals;var I=Ir(),W=Hn(h),J=vn(I,W);J.tag=1,J.payload=g,w!=null&&(J.callback=w),g=Ln(h,J,W),g!==null&&(tn(g,h,W,I),so(g,h,W))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var w=Ir(),I=Hn(h),W=vn(w,I);W.tag=2,g!=null&&(W.callback=g),g=Ln(h,W,I),g!==null&&(tn(g,h,I,w),so(g,h,I))}};function xu(h,g,w,I,W,J,Ee){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(I,J,Ee):g.prototype&&g.prototype.isPureReactComponent?!us(w,I)||!us(W,J):!0}function Fu(h,g,w){var I=!1,W=Pn,J=g.contextType;return typeof J=="object"&&J!==null?J=Wr(J):(W=Mr(g)?ei:Tr.current,I=g.contextTypes,J=(I=I!=null)?Di(h,W):Pn),g=new g(w,J),h.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=po,h.stateNode=g,g._reactInternals=h,I&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=W,h.__reactInternalMemoizedMaskedChildContext=J),g}function Lu(h,g,w,I){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(w,I),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(w,I),g.state!==h&&po.enqueueReplaceState(g,g.state,null)}function Ka(h,g,w,I){var W=h.stateNode;W.props=w,W.state=h.memoizedState,W.refs={},La(h);var J=g.contextType;typeof J=="object"&&J!==null?W.context=Wr(J):(J=Mr(g)?ei:Tr.current,W.context=Di(h,J)),W.state=h.memoizedState,J=g.getDerivedStateFromProps,typeof J=="function"&&(Ya(h,g,J,w),W.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(g=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),g!==W.state&&po.enqueueReplaceState(W,W.state,null),oo(h,w,W,I),W.state=h.memoizedState),typeof W.componentDidMount=="function"&&(h.flags|=4194308)}function ji(h,g){try{var w="",I=g;do w+=Ne(I),I=I.return;while(I);var W=w}catch(J){W=`
Error generating stack: `+J.message+`
`+J.stack}return{value:h,source:g,stack:W,digest:null}}function Xa(h,g,w){return{value:h,source:null,stack:w??null,digest:g??null}}function Ja(h,g){try{console.error(g.value)}catch(w){setTimeout(function(){throw w})}}var Qc=typeof WeakMap=="function"?WeakMap:Map;function Du(h,g,w){w=vn(-1,w),w.tag=3,w.payload={element:null};var I=g.value;return w.callback=function(){So||(So=!0,hl=I),Ja(h,g)},w}function $u(h,g,w){w=vn(-1,w),w.tag=3;var I=h.type.getDerivedStateFromError;if(typeof I=="function"){var W=g.value;w.payload=function(){return I(W)},w.callback=function(){Ja(h,g)}}var J=h.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(w.callback=function(){Ja(h,g),typeof I!="function"&&($n===null?$n=new Set([this]):$n.add(this));var Ee=g.stack;this.componentDidCatch(g.value,{componentStack:Ee!==null?Ee:""})}),w}function ku(h,g,w){var I=h.pingCache;if(I===null){I=h.pingCache=new Qc;var W=new Set;I.set(g,W)}else W=I.get(g),W===void 0&&(W=new Set,I.set(g,W));W.has(w)||(W.add(w),h=hd.bind(null,h,g,w),g.then(h,h))}function Hu(h){do{var g;if((g=h.tag===13)&&(g=h.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return h;h=h.return}while(h!==null);return null}function Bu(h,g,w,I,W){return h.mode&1?(h.flags|=65536,h.lanes=W,h):(h===g?h.flags|=65536:(h.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(g=vn(-1,1),g.tag=2,Ln(w,g,1))),w.lanes|=1),h)}var Zc=N.ReactCurrentOwner,Pr=!1;function Nr(h,g,w,I){g.child=h===null?ou(g,null,w,I):Bi(g,h.child,w,I)}function Uu(h,g,w,I,W){w=w.render;var J=g.ref;return Vi(g,W),I=Va(h,g,w,I,J,W),w=Ga(),h!==null&&!Pr?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~W,Sn(h,g,W)):(nr&&w&&Ra(g),g.flags|=1,Nr(h,g,I,W),g.child)}function Vu(h,g,w,I,W){if(h===null){var J=w.type;return typeof J=="function"&&!Cl(J)&&J.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(g.tag=15,g.type=J,Gu(h,g,J,I,W)):(h=Ao(w.type,null,I,g,g.mode,W),h.ref=g.ref,h.return=g,g.child=h)}if(J=h.child,!(h.lanes&W)){var Ee=J.memoizedProps;if(w=w.compare,w=w!==null?w:us,w(Ee,I)&&h.ref===g.ref)return Sn(h,g,W)}return g.flags|=1,h=Un(J,I),h.ref=g.ref,h.return=g,g.child=h}function Gu(h,g,w,I,W){if(h!==null){var J=h.memoizedProps;if(us(J,I)&&h.ref===g.ref)if(Pr=!1,g.pendingProps=I=J,(h.lanes&W)!==0)h.flags&131072&&(Pr=!0);else return g.lanes=h.lanes,Sn(h,g,W)}return Qa(h,g,w,I,W)}function ju(h,g,w){var I=g.pendingProps,W=I.children,J=h!==null?h.memoizedState:null;if(I.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(zi,Br),Br|=w;else{if(!(w&1073741824))return h=J!==null?J.baseLanes|w:w,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:h,cachePool:null,transitions:null},g.updateQueue=null,Zt(zi,Br),Br|=h,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},I=J!==null?J.baseLanes:w,Zt(zi,Br),Br|=I}else J!==null?(I=J.baseLanes|w,g.memoizedState=null):I=w,Zt(zi,Br),Br|=I;return Nr(h,g,W,w),g.child}function Wu(h,g){var w=g.ref;(h===null&&w!==null||h!==null&&h.ref!==w)&&(g.flags|=512,g.flags|=2097152)}function Qa(h,g,w,I,W){var J=Mr(w)?ei:Tr.current;return J=Di(g,J),Vi(g,W),w=Va(h,g,w,I,J,W),I=Ga(),h!==null&&!Pr?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~W,Sn(h,g,W)):(nr&&I&&Ra(g),g.flags|=1,Nr(h,g,w,W),g.child)}function zu(h,g,w,I,W){if(Mr(w)){var J=!0;Xs(g)}else J=!1;if(Vi(g,W),g.stateNode===null)go(h,g),Fu(g,w,I),Ka(g,w,I,W),I=!0;else if(h===null){var Ee=g.stateNode,Be=g.memoizedProps;Ee.props=Be;var Je=Ee.context,dt=w.contextType;typeof dt=="object"&&dt!==null?dt=Wr(dt):(dt=Mr(w)?ei:Tr.current,dt=Di(g,dt));var Tt=w.getDerivedStateFromProps,wt=typeof Tt=="function"||typeof Ee.getSnapshotBeforeUpdate=="function";wt||typeof Ee.UNSAFE_componentWillReceiveProps!="function"&&typeof Ee.componentWillReceiveProps!="function"||(Be!==I||Je!==dt)&&Lu(g,Ee,I,dt),Fn=!1;var _t=g.memoizedState;Ee.state=_t,oo(g,I,Ee,W),Je=g.memoizedState,Be!==I||_t!==Je||Or.current||Fn?(typeof Tt=="function"&&(Ya(g,w,Tt,I),Je=g.memoizedState),(Be=Fn||xu(g,w,Be,I,_t,Je,dt))?(wt||typeof Ee.UNSAFE_componentWillMount!="function"&&typeof Ee.componentWillMount!="function"||(typeof Ee.componentWillMount=="function"&&Ee.componentWillMount(),typeof Ee.UNSAFE_componentWillMount=="function"&&Ee.UNSAFE_componentWillMount()),typeof Ee.componentDidMount=="function"&&(g.flags|=4194308)):(typeof Ee.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=I,g.memoizedState=Je),Ee.props=I,Ee.state=Je,Ee.context=dt,I=Be):(typeof Ee.componentDidMount=="function"&&(g.flags|=4194308),I=!1)}else{Ee=g.stateNode,lu(h,g),Be=g.memoizedProps,dt=g.type===g.elementType?Be:Qr(g.type,Be),Ee.props=dt,wt=g.pendingProps,_t=Ee.context,Je=w.contextType,typeof Je=="object"&&Je!==null?Je=Wr(Je):(Je=Mr(w)?ei:Tr.current,Je=Di(g,Je));var Mt=w.getDerivedStateFromProps;(Tt=typeof Mt=="function"||typeof Ee.getSnapshotBeforeUpdate=="function")||typeof Ee.UNSAFE_componentWillReceiveProps!="function"&&typeof Ee.componentWillReceiveProps!="function"||(Be!==wt||_t!==Je)&&Lu(g,Ee,I,Je),Fn=!1,_t=g.memoizedState,Ee.state=_t,oo(g,I,Ee,W);var Dt=g.memoizedState;Be!==wt||_t!==Dt||Or.current||Fn?(typeof Mt=="function"&&(Ya(g,w,Mt,I),Dt=g.memoizedState),(dt=Fn||xu(g,w,dt,I,_t,Dt,Je)||!1)?(Tt||typeof Ee.UNSAFE_componentWillUpdate!="function"&&typeof Ee.componentWillUpdate!="function"||(typeof Ee.componentWillUpdate=="function"&&Ee.componentWillUpdate(I,Dt,Je),typeof Ee.UNSAFE_componentWillUpdate=="function"&&Ee.UNSAFE_componentWillUpdate(I,Dt,Je)),typeof Ee.componentDidUpdate=="function"&&(g.flags|=4),typeof Ee.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof Ee.componentDidUpdate!="function"||Be===h.memoizedProps&&_t===h.memoizedState||(g.flags|=4),typeof Ee.getSnapshotBeforeUpdate!="function"||Be===h.memoizedProps&&_t===h.memoizedState||(g.flags|=1024),g.memoizedProps=I,g.memoizedState=Dt),Ee.props=I,Ee.state=Dt,Ee.context=Je,I=dt):(typeof Ee.componentDidUpdate!="function"||Be===h.memoizedProps&&_t===h.memoizedState||(g.flags|=4),typeof Ee.getSnapshotBeforeUpdate!="function"||Be===h.memoizedProps&&_t===h.memoizedState||(g.flags|=1024),I=!1)}return Za(h,g,w,I,J,W)}function Za(h,g,w,I,W,J){Wu(h,g);var Ee=(g.flags&128)!==0;if(!I&&!Ee)return W&&Jl(g,w,!1),Sn(h,g,J);I=g.stateNode,Zc.current=g;var Be=Ee&&typeof w.getDerivedStateFromError!="function"?null:I.render();return g.flags|=1,h!==null&&Ee?(g.child=Bi(g,h.child,null,J),g.child=Bi(g,null,Be,J)):Nr(h,g,Be,J),g.memoizedState=I.state,W&&Jl(g,w,!0),g.child}function qu(h){var g=h.stateNode;g.pendingContext?Kl(h,g.pendingContext,g.pendingContext!==g.context):g.context&&Kl(h,g.context,!1),Da(h,g.containerInfo)}function Yu(h,g,w,I,W){return Hi(),Ia(W),g.flags|=256,Nr(h,g,w,I),g.child}var el={dehydrated:null,treeContext:null,retryLane:0};function tl(h){return{baseLanes:h,cachePool:null,transitions:null}}function Ku(h,g,w){var I=g.pendingProps,W=ir.current,J=!1,Ee=(g.flags&128)!==0,Be;if((Be=Ee)||(Be=h!==null&&h.memoizedState===null?!1:(W&2)!==0),Be?(J=!0,g.flags&=-129):(h===null||h.memoizedState!==null)&&(W|=1),Zt(ir,W&1),h===null)return Na(g),h=g.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?(g.mode&1?h.data==="$!"?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(Ee=I.children,h=I.fallback,J?(I=g.mode,J=g.child,Ee={mode:"hidden",children:Ee},!(I&1)&&J!==null?(J.childLanes=0,J.pendingProps=Ee):J=No(Ee,I,0,null),h=ci(h,I,w,null),J.return=g,h.return=g,J.sibling=h,g.child=J,g.child.memoizedState=tl(w),g.memoizedState=el,h):rl(g,Ee));if(W=h.memoizedState,W!==null&&(Be=W.dehydrated,Be!==null))return ed(h,g,Ee,I,Be,W,w);if(J){J=I.fallback,Ee=g.mode,W=h.child,Be=W.sibling;var Je={mode:"hidden",children:I.children};return!(Ee&1)&&g.child!==W?(I=g.child,I.childLanes=0,I.pendingProps=Je,g.deletions=null):(I=Un(W,Je),I.subtreeFlags=W.subtreeFlags&14680064),Be!==null?J=Un(Be,J):(J=ci(J,Ee,w,null),J.flags|=2),J.return=g,I.return=g,I.sibling=J,g.child=I,I=J,J=g.child,Ee=h.child.memoizedState,Ee=Ee===null?tl(w):{baseLanes:Ee.baseLanes|w,cachePool:null,transitions:Ee.transitions},J.memoizedState=Ee,J.childLanes=h.childLanes&~w,g.memoizedState=el,I}return J=h.child,h=J.sibling,I=Un(J,{mode:"visible",children:I.children}),!(g.mode&1)&&(I.lanes=w),I.return=g,I.sibling=null,h!==null&&(w=g.deletions,w===null?(g.deletions=[h],g.flags|=16):w.push(h)),g.child=I,g.memoizedState=null,I}function rl(h,g){return g=No({mode:"visible",children:g},h.mode,0,null),g.return=h,h.child=g}function mo(h,g,w,I){return I!==null&&Ia(I),Bi(g,h.child,null,w),h=rl(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function ed(h,g,w,I,W,J,Ee){if(w)return g.flags&256?(g.flags&=-257,I=Xa(Error(t(422))),mo(h,g,Ee,I)):g.memoizedState!==null?(g.child=h.child,g.flags|=128,null):(J=I.fallback,W=g.mode,I=No({mode:"visible",children:I.children},W,0,null),J=ci(J,W,Ee,null),J.flags|=2,I.return=g,J.return=g,I.sibling=J,g.child=I,g.mode&1&&Bi(g,h.child,null,Ee),g.child.memoizedState=tl(Ee),g.memoizedState=el,J);if(!(g.mode&1))return mo(h,g,Ee,null);if(W.data==="$!"){if(I=W.nextSibling&&W.nextSibling.dataset,I)var Be=I.dgst;return I=Be,J=Error(t(419)),I=Xa(J,I,void 0),mo(h,g,Ee,I)}if(Be=(Ee&h.childLanes)!==0,Pr||Be){if(I=yr,I!==null){switch(Ee&-Ee){case 4:W=2;break;case 16:W=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:W=32;break;case 536870912:W=268435456;break;default:W=0}W=W&(I.suspendedLanes|Ee)?0:W,W!==0&&W!==J.retryLane&&(J.retryLane=W,Cn(h,W),tn(I,h,W,-1))}return El(),I=Xa(Error(t(421))),mo(h,g,Ee,I)}return W.data==="$?"?(g.flags|=128,g.child=h.child,g=fd.bind(null,h),W._reactRetry=g,null):(h=J.treeContext,Hr=On(W.nextSibling),kr=g,nr=!0,Jr=null,h!==null&&(Gr[jr++]=yn,Gr[jr++]=En,Gr[jr++]=ti,yn=h.id,En=h.overflow,ti=g),g=rl(g,I.children),g.flags|=4096,g)}function Xu(h,g,w){h.lanes|=g;var I=h.alternate;I!==null&&(I.lanes|=g),xa(h.return,g,w)}function nl(h,g,w,I,W){var J=h.memoizedState;J===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:I,tail:w,tailMode:W}:(J.isBackwards=g,J.rendering=null,J.renderingStartTime=0,J.last=I,J.tail=w,J.tailMode=W)}function Ju(h,g,w){var I=g.pendingProps,W=I.revealOrder,J=I.tail;if(Nr(h,g,I.children,w),I=ir.current,I&2)I=I&1|2,g.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&Xu(h,w,g);else if(h.tag===19)Xu(h,w,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}I&=1}if(Zt(ir,I),!(g.mode&1))g.memoizedState=null;else switch(W){case"forwards":for(w=g.child,W=null;w!==null;)h=w.alternate,h!==null&&ao(h)===null&&(W=w),w=w.sibling;w=W,w===null?(W=g.child,g.child=null):(W=w.sibling,w.sibling=null),nl(g,!1,W,w,J);break;case"backwards":for(w=null,W=g.child,g.child=null;W!==null;){if(h=W.alternate,h!==null&&ao(h)===null){g.child=W;break}h=W.sibling,W.sibling=w,w=W,W=h}nl(g,!0,w,null,J);break;case"together":nl(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function go(h,g){!(g.mode&1)&&h!==null&&(h.alternate=null,g.alternate=null,g.flags|=2)}function Sn(h,g,w){if(h!==null&&(g.dependencies=h.dependencies),oi|=g.lanes,!(w&g.childLanes))return null;if(h!==null&&g.child!==h.child)throw Error(t(153));if(g.child!==null){for(h=g.child,w=Un(h,h.pendingProps),g.child=w,w.return=g;h.sibling!==null;)h=h.sibling,w=w.sibling=Un(h,h.pendingProps),w.return=g;w.sibling=null}return g.child}function td(h,g,w){switch(g.tag){case 3:qu(g),Hi();break;case 5:du(g);break;case 1:Mr(g.type)&&Xs(g);break;case 4:Da(g,g.stateNode.containerInfo);break;case 10:var I=g.type._context,W=g.memoizedProps.value;Zt(no,I._currentValue),I._currentValue=W;break;case 13:if(I=g.memoizedState,I!==null)return I.dehydrated!==null?(Zt(ir,ir.current&1),g.flags|=128,null):w&g.child.childLanes?Ku(h,g,w):(Zt(ir,ir.current&1),h=Sn(h,g,w),h!==null?h.sibling:null);Zt(ir,ir.current&1);break;case 19:if(I=(w&g.childLanes)!==0,h.flags&128){if(I)return Ju(h,g,w);g.flags|=128}if(W=g.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),Zt(ir,ir.current),I)break;return null;case 22:case 23:return g.lanes=0,ju(h,g,w)}return Sn(h,g,w)}var Qu,il,Zu,ec;Qu=function(h,g){for(var w=g.child;w!==null;){if(w.tag===5||w.tag===6)h.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===g)break;for(;w.sibling===null;){if(w.return===null||w.return===g)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},il=function(){},Zu=function(h,g,w,I){var W=h.memoizedProps;if(W!==I){h=g.stateNode,ii(cn.current);var J=null;switch(w){case"input":W=$e(h,W),I=$e(h,I),J=[];break;case"select":W=rt({},W,{value:void 0}),I=rt({},I,{value:void 0}),J=[];break;case"textarea":W=St(h,W),I=St(h,I),J=[];break;default:typeof W.onClick!="function"&&typeof I.onClick=="function"&&(h.onclick=qs)}je(w,I);var Ee;w=null;for(dt in W)if(!I.hasOwnProperty(dt)&&W.hasOwnProperty(dt)&&W[dt]!=null)if(dt==="style"){var Be=W[dt];for(Ee in Be)Be.hasOwnProperty(Ee)&&(w||(w={}),w[Ee]="")}else dt!=="dangerouslySetInnerHTML"&&dt!=="children"&&dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&dt!=="autoFocus"&&(s.hasOwnProperty(dt)?J||(J=[]):(J=J||[]).push(dt,null));for(dt in I){var Je=I[dt];if(Be=W!=null?W[dt]:void 0,I.hasOwnProperty(dt)&&Je!==Be&&(Je!=null||Be!=null))if(dt==="style")if(Be){for(Ee in Be)!Be.hasOwnProperty(Ee)||Je&&Je.hasOwnProperty(Ee)||(w||(w={}),w[Ee]="");for(Ee in Je)Je.hasOwnProperty(Ee)&&Be[Ee]!==Je[Ee]&&(w||(w={}),w[Ee]=Je[Ee])}else w||(J||(J=[]),J.push(dt,w)),w=Je;else dt==="dangerouslySetInnerHTML"?(Je=Je?Je.__html:void 0,Be=Be?Be.__html:void 0,Je!=null&&Be!==Je&&(J=J||[]).push(dt,Je)):dt==="children"?typeof Je!="string"&&typeof Je!="number"||(J=J||[]).push(dt,""+Je):dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&(s.hasOwnProperty(dt)?(Je!=null&&dt==="onScroll"&&er("scroll",h),J||Be===Je||(J=[])):(J=J||[]).push(dt,Je))}w&&(J=J||[]).push("style",w);var dt=J;(g.updateQueue=dt)&&(g.flags|=4)}},ec=function(h,g,w,I){w!==I&&(g.flags|=4)};function ws(h,g){if(!nr)switch(h.tailMode){case"hidden":g=h.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?h.tail=null:w.sibling=null;break;case"collapsed":w=h.tail;for(var I=null;w!==null;)w.alternate!==null&&(I=w),w=w.sibling;I===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:I.sibling=null}}function Rr(h){var g=h.alternate!==null&&h.alternate.child===h.child,w=0,I=0;if(g)for(var W=h.child;W!==null;)w|=W.lanes|W.childLanes,I|=W.subtreeFlags&14680064,I|=W.flags&14680064,W.return=h,W=W.sibling;else for(W=h.child;W!==null;)w|=W.lanes|W.childLanes,I|=W.subtreeFlags,I|=W.flags,W.return=h,W=W.sibling;return h.subtreeFlags|=I,h.childLanes=w,g}function rd(h,g,w){var I=g.pendingProps;switch(ba(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rr(g),null;case 1:return Mr(g.type)&&Ks(),Rr(g),null;case 3:return I=g.stateNode,Gi(),tr(Or),tr(Tr),Ha(),I.pendingContext&&(I.context=I.pendingContext,I.pendingContext=null),(h===null||h.child===null)&&(eo(g)?g.flags|=4:h===null||h.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,Jr!==null&&(ml(Jr),Jr=null))),il(h,g),Rr(g),null;case 5:$a(g);var W=ii(Cs.current);if(w=g.type,h!==null&&g.stateNode!=null)Zu(h,g,w,I,W),h.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!I){if(g.stateNode===null)throw Error(t(166));return Rr(g),null}if(h=ii(cn.current),eo(g)){I=g.stateNode,w=g.type;var J=g.memoizedProps;switch(I[un]=g,I[ps]=J,h=(g.mode&1)!==0,w){case"dialog":er("cancel",I),er("close",I);break;case"iframe":case"object":case"embed":er("load",I);break;case"video":case"audio":for(W=0;W<ds.length;W++)er(ds[W],I);break;case"source":er("error",I);break;case"img":case"image":case"link":er("error",I),er("load",I);break;case"details":er("toggle",I);break;case"input":ze(I,J),er("invalid",I);break;case"select":I._wrapperState={wasMultiple:!!J.multiple},er("invalid",I);break;case"textarea":bt(I,J),er("invalid",I)}je(w,J),W=null;for(var Ee in J)if(J.hasOwnProperty(Ee)){var Be=J[Ee];Ee==="children"?typeof Be=="string"?I.textContent!==Be&&(J.suppressHydrationWarning!==!0&&zs(I.textContent,Be,h),W=["children",Be]):typeof Be=="number"&&I.textContent!==""+Be&&(J.suppressHydrationWarning!==!0&&zs(I.textContent,Be,h),W=["children",""+Be]):s.hasOwnProperty(Ee)&&Be!=null&&Ee==="onScroll"&&er("scroll",I)}switch(w){case"input":ge(I),Qe(I,J,!0);break;case"textarea":ge(I),X(I);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(I.onclick=qs)}I=W,g.updateQueue=I,I!==null&&(g.flags|=4)}else{Ee=W.nodeType===9?W:W.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=F(w)),h==="http://www.w3.org/1999/xhtml"?w==="script"?(h=Ee.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof I.is=="string"?h=Ee.createElement(w,{is:I.is}):(h=Ee.createElement(w),w==="select"&&(Ee=h,I.multiple?Ee.multiple=!0:I.size&&(Ee.size=I.size))):h=Ee.createElementNS(h,w),h[un]=g,h[ps]=I,Qu(h,g,!1,!1),g.stateNode=h;e:{switch(Ee=ke(w,I),w){case"dialog":er("cancel",h),er("close",h),W=I;break;case"iframe":case"object":case"embed":er("load",h),W=I;break;case"video":case"audio":for(W=0;W<ds.length;W++)er(ds[W],h);W=I;break;case"source":er("error",h),W=I;break;case"img":case"image":case"link":er("error",h),er("load",h),W=I;break;case"details":er("toggle",h),W=I;break;case"input":ze(h,I),W=$e(h,I),er("invalid",h);break;case"option":W=I;break;case"select":h._wrapperState={wasMultiple:!!I.multiple},W=rt({},I,{value:void 0}),er("invalid",h);break;case"textarea":bt(h,I),W=St(h,I),er("invalid",h);break;default:W=I}je(w,W),Be=W;for(J in Be)if(Be.hasOwnProperty(J)){var Je=Be[J];J==="style"?he(h,Je):J==="dangerouslySetInnerHTML"?(Je=Je?Je.__html:void 0,Je!=null&&Fe(h,Je)):J==="children"?typeof Je=="string"?(w!=="textarea"||Je!=="")&&Le(h,Je):typeof Je=="number"&&Le(h,""+Je):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(s.hasOwnProperty(J)?Je!=null&&J==="onScroll"&&er("scroll",h):Je!=null&&O(h,J,Je,Ee))}switch(w){case"input":ge(h),Qe(h,I,!1);break;case"textarea":ge(h),X(h);break;case"option":I.value!=null&&h.setAttribute("value",""+Ie(I.value));break;case"select":h.multiple=!!I.multiple,J=I.value,J!=null?at(h,!!I.multiple,J,!1):I.defaultValue!=null&&at(h,!!I.multiple,I.defaultValue,!0);break;default:typeof W.onClick=="function"&&(h.onclick=qs)}switch(w){case"button":case"input":case"select":case"textarea":I=!!I.autoFocus;break e;case"img":I=!0;break e;default:I=!1}}I&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Rr(g),null;case 6:if(h&&g.stateNode!=null)ec(h,g,h.memoizedProps,I);else{if(typeof I!="string"&&g.stateNode===null)throw Error(t(166));if(w=ii(Cs.current),ii(cn.current),eo(g)){if(I=g.stateNode,w=g.memoizedProps,I[un]=g,(J=I.nodeValue!==w)&&(h=kr,h!==null))switch(h.tag){case 3:zs(I.nodeValue,w,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&zs(I.nodeValue,w,(h.mode&1)!==0)}J&&(g.flags|=4)}else I=(w.nodeType===9?w:w.ownerDocument).createTextNode(I),I[un]=g,g.stateNode=I}return Rr(g),null;case 13:if(tr(ir),I=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(nr&&Hr!==null&&g.mode&1&&!(g.flags&128))nu(),Hi(),g.flags|=98560,J=!1;else if(J=eo(g),I!==null&&I.dehydrated!==null){if(h===null){if(!J)throw Error(t(318));if(J=g.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(t(317));J[un]=g}else Hi(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;Rr(g),J=!1}else Jr!==null&&(ml(Jr),Jr=null),J=!0;if(!J)return g.flags&65536?g:null}return g.flags&128?(g.lanes=w,g):(I=I!==null,I!==(h!==null&&h.memoizedState!==null)&&I&&(g.child.flags|=8192,g.mode&1&&(h===null||ir.current&1?fr===0&&(fr=3):El())),g.updateQueue!==null&&(g.flags|=4),Rr(g),null);case 4:return Gi(),il(h,g),h===null&&hs(g.stateNode.containerInfo),Rr(g),null;case 10:return Pa(g.type._context),Rr(g),null;case 17:return Mr(g.type)&&Ks(),Rr(g),null;case 19:if(tr(ir),J=g.memoizedState,J===null)return Rr(g),null;if(I=(g.flags&128)!==0,Ee=J.rendering,Ee===null)if(I)ws(J,!1);else{if(fr!==0||h!==null&&h.flags&128)for(h=g.child;h!==null;){if(Ee=ao(h),Ee!==null){for(g.flags|=128,ws(J,!1),I=Ee.updateQueue,I!==null&&(g.updateQueue=I,g.flags|=4),g.subtreeFlags=0,I=w,w=g.child;w!==null;)J=w,h=I,J.flags&=14680066,Ee=J.alternate,Ee===null?(J.childLanes=0,J.lanes=h,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=Ee.childLanes,J.lanes=Ee.lanes,J.child=Ee.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=Ee.memoizedProps,J.memoizedState=Ee.memoizedState,J.updateQueue=Ee.updateQueue,J.type=Ee.type,h=Ee.dependencies,J.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),w=w.sibling;return Zt(ir,ir.current&1|2),g.child}h=h.sibling}J.tail!==null&&Nt()>qi&&(g.flags|=128,I=!0,ws(J,!1),g.lanes=4194304)}else{if(!I)if(h=ao(Ee),h!==null){if(g.flags|=128,I=!0,w=h.updateQueue,w!==null&&(g.updateQueue=w,g.flags|=4),ws(J,!0),J.tail===null&&J.tailMode==="hidden"&&!Ee.alternate&&!nr)return Rr(g),null}else 2*Nt()-J.renderingStartTime>qi&&w!==1073741824&&(g.flags|=128,I=!0,ws(J,!1),g.lanes=4194304);J.isBackwards?(Ee.sibling=g.child,g.child=Ee):(w=J.last,w!==null?w.sibling=Ee:g.child=Ee,J.last=Ee)}return J.tail!==null?(g=J.tail,J.rendering=g,J.tail=g.sibling,J.renderingStartTime=Nt(),g.sibling=null,w=ir.current,Zt(ir,I?w&1|2:w&1),g):(Rr(g),null);case 22:case 23:return yl(),I=g.memoizedState!==null,h!==null&&h.memoizedState!==null!==I&&(g.flags|=8192),I&&g.mode&1?Br&1073741824&&(Rr(g),g.subtreeFlags&6&&(g.flags|=8192)):Rr(g),null;case 24:return null;case 25:return null}throw Error(t(156,g.tag))}function nd(h,g){switch(ba(g),g.tag){case 1:return Mr(g.type)&&Ks(),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return Gi(),tr(Or),tr(Tr),Ha(),h=g.flags,h&65536&&!(h&128)?(g.flags=h&-65537|128,g):null;case 5:return $a(g),null;case 13:if(tr(ir),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(t(340));Hi()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return tr(ir),null;case 4:return Gi(),null;case 10:return Pa(g.type._context),null;case 22:case 23:return yl(),null;case 24:return null;default:return null}}var yo=!1,br=!1,id=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function Wi(h,g){var w=h.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(I){or(h,g,I)}else w.current=null}function sl(h,g,w){try{w()}catch(I){or(h,g,I)}}var tc=!1;function sd(h,g){if(ya=_i,h=xl(),ua(h)){if("selectionStart"in h)var w={start:h.selectionStart,end:h.selectionEnd};else e:{w=(w=h.ownerDocument)&&w.defaultView||window;var I=w.getSelection&&w.getSelection();if(I&&I.rangeCount!==0){w=I.anchorNode;var W=I.anchorOffset,J=I.focusNode;I=I.focusOffset;try{w.nodeType,J.nodeType}catch{w=null;break e}var Ee=0,Be=-1,Je=-1,dt=0,Tt=0,wt=h,_t=null;t:for(;;){for(var Mt;wt!==w||W!==0&&wt.nodeType!==3||(Be=Ee+W),wt!==J||I!==0&&wt.nodeType!==3||(Je=Ee+I),wt.nodeType===3&&(Ee+=wt.nodeValue.length),(Mt=wt.firstChild)!==null;)_t=wt,wt=Mt;for(;;){if(wt===h)break t;if(_t===w&&++dt===W&&(Be=Ee),_t===J&&++Tt===I&&(Je=Ee),(Mt=wt.nextSibling)!==null)break;wt=_t,_t=wt.parentNode}wt=Mt}w=Be===-1||Je===-1?null:{start:Be,end:Je}}else w=null}w=w||{start:0,end:0}}else w=null;for(Ea={focusedElem:h,selectionRange:w},_i=!1,Lt=g;Lt!==null;)if(g=Lt,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,Lt=h;else for(;Lt!==null;){g=Lt;try{var Dt=g.alternate;if(g.flags&1024)switch(g.tag){case 0:case 11:case 15:break;case 1:if(Dt!==null){var $t=Dt.memoizedProps,ar=Dt.memoizedState,lt=g.stateNode,tt=lt.getSnapshotBeforeUpdate(g.elementType===g.type?$t:Qr(g.type,$t),ar);lt.__reactInternalSnapshotBeforeUpdate=tt}break;case 3:var ct=g.stateNode.containerInfo;ct.nodeType===1?ct.textContent="":ct.nodeType===9&&ct.documentElement&&ct.removeChild(ct.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(At){or(g,g.return,At)}if(h=g.sibling,h!==null){h.return=g.return,Lt=h;break}Lt=g.return}return Dt=tc,tc=!1,Dt}function Rs(h,g,w){var I=g.updateQueue;if(I=I!==null?I.lastEffect:null,I!==null){var W=I=I.next;do{if((W.tag&h)===h){var J=W.destroy;W.destroy=void 0,J!==void 0&&sl(g,w,J)}W=W.next}while(W!==I)}}function Eo(h,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&h)===h){var I=w.create;w.destroy=I()}w=w.next}while(w!==g)}}function ol(h){var g=h.ref;if(g!==null){var w=h.stateNode;switch(h.tag){case 5:h=w;break;default:h=w}typeof g=="function"?g(h):g.current=h}}function rc(h){var g=h.alternate;g!==null&&(h.alternate=null,rc(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&(delete g[un],delete g[ps],delete g[_a],delete g[Uc],delete g[Vc])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function nc(h){return h.tag===5||h.tag===3||h.tag===4}function ic(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||nc(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function al(h,g,w){var I=h.tag;if(I===5||I===6)h=h.stateNode,g?w.nodeType===8?w.parentNode.insertBefore(h,g):w.insertBefore(h,g):(w.nodeType===8?(g=w.parentNode,g.insertBefore(h,w)):(g=w,g.appendChild(h)),w=w._reactRootContainer,w!=null||g.onclick!==null||(g.onclick=qs));else if(I!==4&&(h=h.child,h!==null))for(al(h,g,w),h=h.sibling;h!==null;)al(h,g,w),h=h.sibling}function ll(h,g,w){var I=h.tag;if(I===5||I===6)h=h.stateNode,g?w.insertBefore(h,g):w.appendChild(h);else if(I!==4&&(h=h.child,h!==null))for(ll(h,g,w),h=h.sibling;h!==null;)ll(h,g,w),h=h.sibling}var vr=null,Zr=!1;function Dn(h,g,w){for(w=w.child;w!==null;)sc(h,g,w),w=w.sibling}function sc(h,g,w){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(hi,w)}catch{}switch(w.tag){case 5:br||Wi(w,g);case 6:var I=vr,W=Zr;vr=null,Dn(h,g,w),vr=I,Zr=W,vr!==null&&(Zr?(h=vr,w=w.stateNode,h.nodeType===8?h.parentNode.removeChild(w):h.removeChild(w)):vr.removeChild(w.stateNode));break;case 18:vr!==null&&(Zr?(h=vr,w=w.stateNode,h.nodeType===8?Sa(h.parentNode,w):h.nodeType===1&&Sa(h,w),Kn(h)):Sa(vr,w.stateNode));break;case 4:I=vr,W=Zr,vr=w.stateNode.containerInfo,Zr=!0,Dn(h,g,w),vr=I,Zr=W;break;case 0:case 11:case 14:case 15:if(!br&&(I=w.updateQueue,I!==null&&(I=I.lastEffect,I!==null))){W=I=I.next;do{var J=W,Ee=J.destroy;J=J.tag,Ee!==void 0&&(J&2||J&4)&&sl(w,g,Ee),W=W.next}while(W!==I)}Dn(h,g,w);break;case 1:if(!br&&(Wi(w,g),I=w.stateNode,typeof I.componentWillUnmount=="function"))try{I.props=w.memoizedProps,I.state=w.memoizedState,I.componentWillUnmount()}catch(Be){or(w,g,Be)}Dn(h,g,w);break;case 21:Dn(h,g,w);break;case 22:w.mode&1?(br=(I=br)||w.memoizedState!==null,Dn(h,g,w),br=I):Dn(h,g,w);break;default:Dn(h,g,w)}}function oc(h){var g=h.updateQueue;if(g!==null){h.updateQueue=null;var w=h.stateNode;w===null&&(w=h.stateNode=new id),g.forEach(function(I){var W=pd.bind(null,h,I);w.has(I)||(w.add(I),I.then(W,W))})}}function en(h,g){var w=g.deletions;if(w!==null)for(var I=0;I<w.length;I++){var W=w[I];try{var J=h,Ee=g,Be=Ee;e:for(;Be!==null;){switch(Be.tag){case 5:vr=Be.stateNode,Zr=!1;break e;case 3:vr=Be.stateNode.containerInfo,Zr=!0;break e;case 4:vr=Be.stateNode.containerInfo,Zr=!0;break e}Be=Be.return}if(vr===null)throw Error(t(160));sc(J,Ee,W),vr=null,Zr=!1;var Je=W.alternate;Je!==null&&(Je.return=null),W.return=null}catch(dt){or(W,g,dt)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)ac(g,h),g=g.sibling}function ac(h,g){var w=h.alternate,I=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(en(g,h),hn(h),I&4){try{Rs(3,h,h.return),Eo(3,h)}catch($t){or(h,h.return,$t)}try{Rs(5,h,h.return)}catch($t){or(h,h.return,$t)}}break;case 1:en(g,h),hn(h),I&512&&w!==null&&Wi(w,w.return);break;case 5:if(en(g,h),hn(h),I&512&&w!==null&&Wi(w,w.return),h.flags&32){var W=h.stateNode;try{Le(W,"")}catch($t){or(h,h.return,$t)}}if(I&4&&(W=h.stateNode,W!=null)){var J=h.memoizedProps,Ee=w!==null?w.memoizedProps:J,Be=h.type,Je=h.updateQueue;if(h.updateQueue=null,Je!==null)try{Be==="input"&&J.type==="radio"&&J.name!=null&&it(W,J),ke(Be,Ee);var dt=ke(Be,J);for(Ee=0;Ee<Je.length;Ee+=2){var Tt=Je[Ee],wt=Je[Ee+1];Tt==="style"?he(W,wt):Tt==="dangerouslySetInnerHTML"?Fe(W,wt):Tt==="children"?Le(W,wt):O(W,Tt,wt,dt)}switch(Be){case"input":Ve(W,J);break;case"textarea":q(W,J);break;case"select":var _t=W._wrapperState.wasMultiple;W._wrapperState.wasMultiple=!!J.multiple;var Mt=J.value;Mt!=null?at(W,!!J.multiple,Mt,!1):_t!==!!J.multiple&&(J.defaultValue!=null?at(W,!!J.multiple,J.defaultValue,!0):at(W,!!J.multiple,J.multiple?[]:"",!1))}W[ps]=J}catch($t){or(h,h.return,$t)}}break;case 6:if(en(g,h),hn(h),I&4){if(h.stateNode===null)throw Error(t(162));W=h.stateNode,J=h.memoizedProps;try{W.nodeValue=J}catch($t){or(h,h.return,$t)}}break;case 3:if(en(g,h),hn(h),I&4&&w!==null&&w.memoizedState.isDehydrated)try{Kn(g.containerInfo)}catch($t){or(h,h.return,$t)}break;case 4:en(g,h),hn(h);break;case 13:en(g,h),hn(h),W=h.child,W.flags&8192&&(J=W.memoizedState!==null,W.stateNode.isHidden=J,!J||W.alternate!==null&&W.alternate.memoizedState!==null||(dl=Nt())),I&4&&oc(h);break;case 22:if(Tt=w!==null&&w.memoizedState!==null,h.mode&1?(br=(dt=br)||Tt,en(g,h),br=dt):en(g,h),hn(h),I&8192){if(dt=h.memoizedState!==null,(h.stateNode.isHidden=dt)&&!Tt&&h.mode&1)for(Lt=h,Tt=h.child;Tt!==null;){for(wt=Lt=Tt;Lt!==null;){switch(_t=Lt,Mt=_t.child,_t.tag){case 0:case 11:case 14:case 15:Rs(4,_t,_t.return);break;case 1:Wi(_t,_t.return);var Dt=_t.stateNode;if(typeof Dt.componentWillUnmount=="function"){I=_t,w=_t.return;try{g=I,Dt.props=g.memoizedProps,Dt.state=g.memoizedState,Dt.componentWillUnmount()}catch($t){or(I,w,$t)}}break;case 5:Wi(_t,_t.return);break;case 22:if(_t.memoizedState!==null){cc(wt);continue}}Mt!==null?(Mt.return=_t,Lt=Mt):cc(wt)}Tt=Tt.sibling}e:for(Tt=null,wt=h;;){if(wt.tag===5){if(Tt===null){Tt=wt;try{W=wt.stateNode,dt?(J=W.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(Be=wt.stateNode,Je=wt.memoizedProps.style,Ee=Je!=null&&Je.hasOwnProperty("display")?Je.display:null,Be.style.display=me("display",Ee))}catch($t){or(h,h.return,$t)}}}else if(wt.tag===6){if(Tt===null)try{wt.stateNode.nodeValue=dt?"":wt.memoizedProps}catch($t){or(h,h.return,$t)}}else if((wt.tag!==22&&wt.tag!==23||wt.memoizedState===null||wt===h)&&wt.child!==null){wt.child.return=wt,wt=wt.child;continue}if(wt===h)break e;for(;wt.sibling===null;){if(wt.return===null||wt.return===h)break e;Tt===wt&&(Tt=null),wt=wt.return}Tt===wt&&(Tt=null),wt.sibling.return=wt.return,wt=wt.sibling}}break;case 19:en(g,h),hn(h),I&4&&oc(h);break;case 21:break;default:en(g,h),hn(h)}}function hn(h){var g=h.flags;if(g&2){try{e:{for(var w=h.return;w!==null;){if(nc(w)){var I=w;break e}w=w.return}throw Error(t(160))}switch(I.tag){case 5:var W=I.stateNode;I.flags&32&&(Le(W,""),I.flags&=-33);var J=ic(h);ll(h,J,W);break;case 3:case 4:var Ee=I.stateNode.containerInfo,Be=ic(h);al(h,Be,Ee);break;default:throw Error(t(161))}}catch(Je){or(h,h.return,Je)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function od(h,g,w){Lt=h,lc(h)}function lc(h,g,w){for(var I=(h.mode&1)!==0;Lt!==null;){var W=Lt,J=W.child;if(W.tag===22&&I){var Ee=W.memoizedState!==null||yo;if(!Ee){var Be=W.alternate,Je=Be!==null&&Be.memoizedState!==null||br;Be=yo;var dt=br;if(yo=Ee,(br=Je)&&!dt)for(Lt=W;Lt!==null;)Ee=Lt,Je=Ee.child,Ee.tag===22&&Ee.memoizedState!==null?dc(W):Je!==null?(Je.return=Ee,Lt=Je):dc(W);for(;J!==null;)Lt=J,lc(J),J=J.sibling;Lt=W,yo=Be,br=dt}uc(h)}else W.subtreeFlags&8772&&J!==null?(J.return=W,Lt=J):uc(h)}}function uc(h){for(;Lt!==null;){var g=Lt;if(g.flags&8772){var w=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:br||Eo(5,g);break;case 1:var I=g.stateNode;if(g.flags&4&&!br)if(w===null)I.componentDidMount();else{var W=g.elementType===g.type?w.memoizedProps:Qr(g.type,w.memoizedProps);I.componentDidUpdate(W,w.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var J=g.updateQueue;J!==null&&cu(g,J,I);break;case 3:var Ee=g.updateQueue;if(Ee!==null){if(w=null,g.child!==null)switch(g.child.tag){case 5:w=g.child.stateNode;break;case 1:w=g.child.stateNode}cu(g,Ee,w)}break;case 5:var Be=g.stateNode;if(w===null&&g.flags&4){w=Be;var Je=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Je.autoFocus&&w.focus();break;case"img":Je.src&&(w.src=Je.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var dt=g.alternate;if(dt!==null){var Tt=dt.memoizedState;if(Tt!==null){var wt=Tt.dehydrated;wt!==null&&Kn(wt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}br||g.flags&512&&ol(g)}catch(_t){or(g,g.return,_t)}}if(g===h){Lt=null;break}if(w=g.sibling,w!==null){w.return=g.return,Lt=w;break}Lt=g.return}}function cc(h){for(;Lt!==null;){var g=Lt;if(g===h){Lt=null;break}var w=g.sibling;if(w!==null){w.return=g.return,Lt=w;break}Lt=g.return}}function dc(h){for(;Lt!==null;){var g=Lt;try{switch(g.tag){case 0:case 11:case 15:var w=g.return;try{Eo(4,g)}catch(Je){or(g,w,Je)}break;case 1:var I=g.stateNode;if(typeof I.componentDidMount=="function"){var W=g.return;try{I.componentDidMount()}catch(Je){or(g,W,Je)}}var J=g.return;try{ol(g)}catch(Je){or(g,J,Je)}break;case 5:var Ee=g.return;try{ol(g)}catch(Je){or(g,Ee,Je)}}}catch(Je){or(g,g.return,Je)}if(g===h){Lt=null;break}var Be=g.sibling;if(Be!==null){Be.return=g.return,Lt=Be;break}Lt=g.return}}var ad=Math.ceil,Co=N.ReactCurrentDispatcher,ul=N.ReactCurrentOwner,qr=N.ReactCurrentBatchConfig,Xt=0,yr=null,lr=null,Sr=0,Br=0,zi=Mn(0),fr=0,bs=null,oi=0,vo=0,cl=0,As=null,xr=null,dl=0,qi=1/0,_n=null,So=!1,hl=null,$n=null,_o=!1,kn=null,To=0,Ns=0,fl=null,wo=-1,Ro=0;function Ir(){return Xt&6?Nt():wo!==-1?wo:wo=Nt()}function Hn(h){return h.mode&1?Xt&2&&Sr!==0?Sr&-Sr:jc.transition!==null?(Ro===0&&(Ro=Xi()),Ro):(h=Wt,h!==0||(h=window.event,h=h===void 0?16:Ds(h.type)),h):1}function tn(h,g,w,I){if(50<Ns)throw Ns=0,fl=null,Error(t(185));wn(h,w,I),(!(Xt&2)||h!==yr)&&(h===yr&&(!(Xt&2)&&(vo|=w),fr===4&&Bn(h,Sr)),Fr(h,I),w===1&&Xt===0&&!(g.mode&1)&&(qi=Nt()+500,Js&&xn()))}function Fr(h,g){var w=h.callbackNode;Ki(h,g);var I=Tn(h,h===yr?Sr:0);if(I===0)w!==null&&Rt(w),h.callbackNode=null,h.callbackPriority=0;else if(g=I&-I,h.callbackPriority!==g){if(w!=null&&Rt(w),g===1)h.tag===0?Gc(fc.bind(null,h)):Ql(fc.bind(null,h)),Hc(function(){!(Xt&6)&&xn()}),w=null;else{switch(Os(I)){case 1:w=pr;break;case 4:w=cr;break;case 16:w=Qt;break;case 536870912:w=Gn;break;default:w=Qt}w=Sc(w,hc.bind(null,h))}h.callbackPriority=g,h.callbackNode=w}}function hc(h,g){if(wo=-1,Ro=0,Xt&6)throw Error(t(327));var w=h.callbackNode;if(Yi()&&h.callbackNode!==w)return null;var I=Tn(h,h===yr?Sr:0);if(I===0)return null;if(I&30||I&h.expiredLanes||g)g=bo(h,I);else{g=I;var W=Xt;Xt|=2;var J=mc();(yr!==h||Sr!==g)&&(_n=null,qi=Nt()+500,li(h,g));do try{cd();break}catch(Be){pc(h,Be)}while(!0);Ma(),Co.current=J,Xt=W,lr!==null?g=0:(yr=null,Sr=0,g=fr)}if(g!==0){if(g===2&&(W=gi(h),W!==0&&(I=W,g=pl(h,W))),g===1)throw w=bs,li(h,0),Bn(h,I),Fr(h,Nt()),w;if(g===6)Bn(h,I);else{if(W=h.current.alternate,!(I&30)&&!ld(W)&&(g=bo(h,I),g===2&&(J=gi(h),J!==0&&(I=J,g=pl(h,J))),g===1))throw w=bs,li(h,0),Bn(h,I),Fr(h,Nt()),w;switch(h.finishedWork=W,h.finishedLanes=I,g){case 0:case 1:throw Error(t(345));case 2:ui(h,xr,_n);break;case 3:if(Bn(h,I),(I&130023424)===I&&(g=dl+500-Nt(),10<g)){if(Tn(h,0)!==0)break;if(W=h.suspendedLanes,(W&I)!==I){Ir(),h.pingedLanes|=h.suspendedLanes&W;break}h.timeoutHandle=va(ui.bind(null,h,xr,_n),g);break}ui(h,xr,_n);break;case 4:if(Bn(h,I),(I&4194240)===I)break;for(g=h.eventTimes,W=-1;0<I;){var Ee=31-Cr(I);J=1<<Ee,Ee=g[Ee],Ee>W&&(W=Ee),I&=~J}if(I=W,I=Nt()-I,I=(120>I?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*ad(I/1960))-I,10<I){h.timeoutHandle=va(ui.bind(null,h,xr,_n),I);break}ui(h,xr,_n);break;case 5:ui(h,xr,_n);break;default:throw Error(t(329))}}}return Fr(h,Nt()),h.callbackNode===w?hc.bind(null,h):null}function pl(h,g){var w=As;return h.current.memoizedState.isDehydrated&&(li(h,g).flags|=256),h=bo(h,g),h!==2&&(g=xr,xr=w,g!==null&&ml(g)),h}function ml(h){xr===null?xr=h:xr.push.apply(xr,h)}function ld(h){for(var g=h;;){if(g.flags&16384){var w=g.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var I=0;I<w.length;I++){var W=w[I],J=W.getSnapshot;W=W.value;try{if(!Xr(J(),W))return!1}catch{return!1}}}if(w=g.child,g.subtreeFlags&16384&&w!==null)w.return=g,g=w;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Bn(h,g){for(g&=~cl,g&=~vo,h.suspendedLanes|=g,h.pingedLanes&=~g,h=h.expirationTimes;0<g;){var w=31-Cr(g),I=1<<w;h[w]=-1,g&=~I}}function fc(h){if(Xt&6)throw Error(t(327));Yi();var g=Tn(h,0);if(!(g&1))return Fr(h,Nt()),null;var w=bo(h,g);if(h.tag!==0&&w===2){var I=gi(h);I!==0&&(g=I,w=pl(h,I))}if(w===1)throw w=bs,li(h,0),Bn(h,g),Fr(h,Nt()),w;if(w===6)throw Error(t(345));return h.finishedWork=h.current.alternate,h.finishedLanes=g,ui(h,xr,_n),Fr(h,Nt()),null}function gl(h,g){var w=Xt;Xt|=1;try{return h(g)}finally{Xt=w,Xt===0&&(qi=Nt()+500,Js&&xn())}}function ai(h){kn!==null&&kn.tag===0&&!(Xt&6)&&Yi();var g=Xt;Xt|=1;var w=qr.transition,I=Wt;try{if(qr.transition=null,Wt=1,h)return h()}finally{Wt=I,qr.transition=w,Xt=g,!(Xt&6)&&xn()}}function yl(){Br=zi.current,tr(zi)}function li(h,g){h.finishedWork=null,h.finishedLanes=0;var w=h.timeoutHandle;if(w!==-1&&(h.timeoutHandle=-1,kc(w)),lr!==null)for(w=lr.return;w!==null;){var I=w;switch(ba(I),I.tag){case 1:I=I.type.childContextTypes,I!=null&&Ks();break;case 3:Gi(),tr(Or),tr(Tr),Ha();break;case 5:$a(I);break;case 4:Gi();break;case 13:tr(ir);break;case 19:tr(ir);break;case 10:Pa(I.type._context);break;case 22:case 23:yl()}w=w.return}if(yr=h,lr=h=Un(h.current,null),Sr=Br=g,fr=0,bs=null,cl=vo=oi=0,xr=As=null,ni!==null){for(g=0;g<ni.length;g++)if(w=ni[g],I=w.interleaved,I!==null){w.interleaved=null;var W=I.next,J=w.pending;if(J!==null){var Ee=J.next;J.next=W,I.next=Ee}w.pending=I}ni=null}return h}function pc(h,g){do{var w=lr;try{if(Ma(),lo.current=fo,uo){for(var I=sr.memoizedState;I!==null;){var W=I.queue;W!==null&&(W.pending=null),I=I.next}uo=!1}if(si=0,gr=hr=sr=null,vs=!1,Ss=0,ul.current=null,w===null||w.return===null){fr=1,bs=g,lr=null;break}e:{var J=h,Ee=w.return,Be=w,Je=g;if(g=Sr,Be.flags|=32768,Je!==null&&typeof Je=="object"&&typeof Je.then=="function"){var dt=Je,Tt=Be,wt=Tt.tag;if(!(Tt.mode&1)&&(wt===0||wt===11||wt===15)){var _t=Tt.alternate;_t?(Tt.updateQueue=_t.updateQueue,Tt.memoizedState=_t.memoizedState,Tt.lanes=_t.lanes):(Tt.updateQueue=null,Tt.memoizedState=null)}var Mt=Hu(Ee);if(Mt!==null){Mt.flags&=-257,Bu(Mt,Ee,Be,J,g),Mt.mode&1&&ku(J,dt,g),g=Mt,Je=dt;var Dt=g.updateQueue;if(Dt===null){var $t=new Set;$t.add(Je),g.updateQueue=$t}else Dt.add(Je);break e}else{if(!(g&1)){ku(J,dt,g),El();break e}Je=Error(t(426))}}else if(nr&&Be.mode&1){var ar=Hu(Ee);if(ar!==null){!(ar.flags&65536)&&(ar.flags|=256),Bu(ar,Ee,Be,J,g),Ia(ji(Je,Be));break e}}J=Je=ji(Je,Be),fr!==4&&(fr=2),As===null?As=[J]:As.push(J),J=Ee;do{switch(J.tag){case 3:J.flags|=65536,g&=-g,J.lanes|=g;var lt=Du(J,Je,g);uu(J,lt);break e;case 1:Be=Je;var tt=J.type,ct=J.stateNode;if(!(J.flags&128)&&(typeof tt.getDerivedStateFromError=="function"||ct!==null&&typeof ct.componentDidCatch=="function"&&($n===null||!$n.has(ct)))){J.flags|=65536,g&=-g,J.lanes|=g;var At=$u(J,Be,g);uu(J,At);break e}}J=J.return}while(J!==null)}yc(w)}catch(Ht){g=Ht,lr===w&&w!==null&&(lr=w=w.return);continue}break}while(!0)}function mc(){var h=Co.current;return Co.current=fo,h===null?fo:h}function El(){(fr===0||fr===3||fr===2)&&(fr=4),yr===null||!(oi&268435455)&&!(vo&268435455)||Bn(yr,Sr)}function bo(h,g){var w=Xt;Xt|=2;var I=mc();(yr!==h||Sr!==g)&&(_n=null,li(h,g));do try{ud();break}catch(W){pc(h,W)}while(!0);if(Ma(),Xt=w,Co.current=I,lr!==null)throw Error(t(261));return yr=null,Sr=0,fr}function ud(){for(;lr!==null;)gc(lr)}function cd(){for(;lr!==null&&!Pt();)gc(lr)}function gc(h){var g=vc(h.alternate,h,Br);h.memoizedProps=h.pendingProps,g===null?yc(h):lr=g,ul.current=null}function yc(h){var g=h;do{var w=g.alternate;if(h=g.return,g.flags&32768){if(w=nd(w,g),w!==null){w.flags&=32767,lr=w;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{fr=6,lr=null;return}}else if(w=rd(w,g,Br),w!==null){lr=w;return}if(g=g.sibling,g!==null){lr=g;return}lr=g=h}while(g!==null);fr===0&&(fr=5)}function ui(h,g,w){var I=Wt,W=qr.transition;try{qr.transition=null,Wt=1,dd(h,g,w,I)}finally{qr.transition=W,Wt=I}return null}function dd(h,g,w,I){do Yi();while(kn!==null);if(Xt&6)throw Error(t(327));w=h.finishedWork;var W=h.finishedLanes;if(w===null)return null;if(h.finishedWork=null,h.finishedLanes=0,w===h.current)throw Error(t(177));h.callbackNode=null,h.callbackPriority=0;var J=w.lanes|w.childLanes;if(Lo(h,J),h===yr&&(lr=yr=null,Sr=0),!(w.subtreeFlags&2064)&&!(w.flags&2064)||_o||(_o=!0,Sc(Qt,function(){return Yi(),null})),J=(w.flags&15990)!==0,w.subtreeFlags&15990||J){J=qr.transition,qr.transition=null;var Ee=Wt;Wt=1;var Be=Xt;Xt|=4,ul.current=null,sd(h,w),ac(w,h),Mc(Ea),_i=!!ya,Ea=ya=null,h.current=w,od(w),Vt(),Xt=Be,Wt=Ee,qr.transition=J}else h.current=w;if(_o&&(_o=!1,kn=h,To=W),J=h.pendingLanes,J===0&&($n=null),fi(w.stateNode),Fr(h,Nt()),g!==null)for(I=h.onRecoverableError,w=0;w<g.length;w++)W=g[w],I(W.value,{componentStack:W.stack,digest:W.digest});if(So)throw So=!1,h=hl,hl=null,h;return To&1&&h.tag!==0&&Yi(),J=h.pendingLanes,J&1?h===fl?Ns++:(Ns=0,fl=h):Ns=0,xn(),null}function Yi(){if(kn!==null){var h=Os(To),g=qr.transition,w=Wt;try{if(qr.transition=null,Wt=16>h?16:h,kn===null)var I=!1;else{if(h=kn,kn=null,To=0,Xt&6)throw Error(t(331));var W=Xt;for(Xt|=4,Lt=h.current;Lt!==null;){var J=Lt,Ee=J.child;if(Lt.flags&16){var Be=J.deletions;if(Be!==null){for(var Je=0;Je<Be.length;Je++){var dt=Be[Je];for(Lt=dt;Lt!==null;){var Tt=Lt;switch(Tt.tag){case 0:case 11:case 15:Rs(8,Tt,J)}var wt=Tt.child;if(wt!==null)wt.return=Tt,Lt=wt;else for(;Lt!==null;){Tt=Lt;var _t=Tt.sibling,Mt=Tt.return;if(rc(Tt),Tt===dt){Lt=null;break}if(_t!==null){_t.return=Mt,Lt=_t;break}Lt=Mt}}}var Dt=J.alternate;if(Dt!==null){var $t=Dt.child;if($t!==null){Dt.child=null;do{var ar=$t.sibling;$t.sibling=null,$t=ar}while($t!==null)}}Lt=J}}if(J.subtreeFlags&2064&&Ee!==null)Ee.return=J,Lt=Ee;else e:for(;Lt!==null;){if(J=Lt,J.flags&2048)switch(J.tag){case 0:case 11:case 15:Rs(9,J,J.return)}var lt=J.sibling;if(lt!==null){lt.return=J.return,Lt=lt;break e}Lt=J.return}}var tt=h.current;for(Lt=tt;Lt!==null;){Ee=Lt;var ct=Ee.child;if(Ee.subtreeFlags&2064&&ct!==null)ct.return=Ee,Lt=ct;else e:for(Ee=tt;Lt!==null;){if(Be=Lt,Be.flags&2048)try{switch(Be.tag){case 0:case 11:case 15:Eo(9,Be)}}catch(Ht){or(Be,Be.return,Ht)}if(Be===Ee){Lt=null;break e}var At=Be.sibling;if(At!==null){At.return=Be.return,Lt=At;break e}Lt=Be.return}}if(Xt=W,xn(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(hi,h)}catch{}I=!0}return I}finally{Wt=w,qr.transition=g}}return!1}function Ec(h,g,w){g=ji(w,g),g=Du(h,g,1),h=Ln(h,g,1),g=Ir(),h!==null&&(wn(h,1,g),Fr(h,g))}function or(h,g,w){if(h.tag===3)Ec(h,h,w);else for(;g!==null;){if(g.tag===3){Ec(g,h,w);break}else if(g.tag===1){var I=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof I.componentDidCatch=="function"&&($n===null||!$n.has(I))){h=ji(w,h),h=$u(g,h,1),g=Ln(g,h,1),h=Ir(),g!==null&&(wn(g,1,h),Fr(g,h));break}}g=g.return}}function hd(h,g,w){var I=h.pingCache;I!==null&&I.delete(g),g=Ir(),h.pingedLanes|=h.suspendedLanes&w,yr===h&&(Sr&w)===w&&(fr===4||fr===3&&(Sr&130023424)===Sr&&500>Nt()-dl?li(h,0):cl|=w),Fr(h,g)}function Cc(h,g){g===0&&(h.mode&1?(g=pn,pn<<=1,!(pn&130023424)&&(pn=4194304)):g=1);var w=Ir();h=Cn(h,g),h!==null&&(wn(h,g,w),Fr(h,w))}function fd(h){var g=h.memoizedState,w=0;g!==null&&(w=g.retryLane),Cc(h,w)}function pd(h,g){var w=0;switch(h.tag){case 13:var I=h.stateNode,W=h.memoizedState;W!==null&&(w=W.retryLane);break;case 19:I=h.stateNode;break;default:throw Error(t(314))}I!==null&&I.delete(g),Cc(h,w)}var vc;vc=function(h,g,w){if(h!==null)if(h.memoizedProps!==g.pendingProps||Or.current)Pr=!0;else{if(!(h.lanes&w)&&!(g.flags&128))return Pr=!1,td(h,g,w);Pr=!!(h.flags&131072)}else Pr=!1,nr&&g.flags&1048576&&Zl(g,Zs,g.index);switch(g.lanes=0,g.tag){case 2:var I=g.type;go(h,g),h=g.pendingProps;var W=Di(g,Tr.current);Vi(g,w),W=Va(null,g,I,h,W,w);var J=Ga();return g.flags|=1,typeof W=="object"&&W!==null&&typeof W.render=="function"&&W.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Mr(I)?(J=!0,Xs(g)):J=!1,g.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,La(g),W.updater=po,g.stateNode=W,W._reactInternals=g,Ka(g,I,h,w),g=Za(null,g,I,!0,J,w)):(g.tag=0,nr&&J&&Ra(g),Nr(null,g,W,w),g=g.child),g;case 16:I=g.elementType;e:{switch(go(h,g),h=g.pendingProps,W=I._init,I=W(I._payload),g.type=I,W=g.tag=gd(I),h=Qr(I,h),W){case 0:g=Qa(null,g,I,h,w);break e;case 1:g=zu(null,g,I,h,w);break e;case 11:g=Uu(null,g,I,h,w);break e;case 14:g=Vu(null,g,I,Qr(I.type,h),w);break e}throw Error(t(306,I,""))}return g;case 0:return I=g.type,W=g.pendingProps,W=g.elementType===I?W:Qr(I,W),Qa(h,g,I,W,w);case 1:return I=g.type,W=g.pendingProps,W=g.elementType===I?W:Qr(I,W),zu(h,g,I,W,w);case 3:e:{if(qu(g),h===null)throw Error(t(387));I=g.pendingProps,J=g.memoizedState,W=J.element,lu(h,g),oo(g,I,null,w);var Ee=g.memoizedState;if(I=Ee.element,J.isDehydrated)if(J={element:I,isDehydrated:!1,cache:Ee.cache,pendingSuspenseBoundaries:Ee.pendingSuspenseBoundaries,transitions:Ee.transitions},g.updateQueue.baseState=J,g.memoizedState=J,g.flags&256){W=ji(Error(t(423)),g),g=Yu(h,g,I,w,W);break e}else if(I!==W){W=ji(Error(t(424)),g),g=Yu(h,g,I,w,W);break e}else for(Hr=On(g.stateNode.containerInfo.firstChild),kr=g,nr=!0,Jr=null,w=ou(g,null,I,w),g.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(Hi(),I===W){g=Sn(h,g,w);break e}Nr(h,g,I,w)}g=g.child}return g;case 5:return du(g),h===null&&Na(g),I=g.type,W=g.pendingProps,J=h!==null?h.memoizedProps:null,Ee=W.children,Ca(I,W)?Ee=null:J!==null&&Ca(I,J)&&(g.flags|=32),Wu(h,g),Nr(h,g,Ee,w),g.child;case 6:return h===null&&Na(g),null;case 13:return Ku(h,g,w);case 4:return Da(g,g.stateNode.containerInfo),I=g.pendingProps,h===null?g.child=Bi(g,null,I,w):Nr(h,g,I,w),g.child;case 11:return I=g.type,W=g.pendingProps,W=g.elementType===I?W:Qr(I,W),Uu(h,g,I,W,w);case 7:return Nr(h,g,g.pendingProps,w),g.child;case 8:return Nr(h,g,g.pendingProps.children,w),g.child;case 12:return Nr(h,g,g.pendingProps.children,w),g.child;case 10:e:{if(I=g.type._context,W=g.pendingProps,J=g.memoizedProps,Ee=W.value,Zt(no,I._currentValue),I._currentValue=Ee,J!==null)if(Xr(J.value,Ee)){if(J.children===W.children&&!Or.current){g=Sn(h,g,w);break e}}else for(J=g.child,J!==null&&(J.return=g);J!==null;){var Be=J.dependencies;if(Be!==null){Ee=J.child;for(var Je=Be.firstContext;Je!==null;){if(Je.context===I){if(J.tag===1){Je=vn(-1,w&-w),Je.tag=2;var dt=J.updateQueue;if(dt!==null){dt=dt.shared;var Tt=dt.pending;Tt===null?Je.next=Je:(Je.next=Tt.next,Tt.next=Je),dt.pending=Je}}J.lanes|=w,Je=J.alternate,Je!==null&&(Je.lanes|=w),xa(J.return,w,g),Be.lanes|=w;break}Je=Je.next}}else if(J.tag===10)Ee=J.type===g.type?null:J.child;else if(J.tag===18){if(Ee=J.return,Ee===null)throw Error(t(341));Ee.lanes|=w,Be=Ee.alternate,Be!==null&&(Be.lanes|=w),xa(Ee,w,g),Ee=J.sibling}else Ee=J.child;if(Ee!==null)Ee.return=J;else for(Ee=J;Ee!==null;){if(Ee===g){Ee=null;break}if(J=Ee.sibling,J!==null){J.return=Ee.return,Ee=J;break}Ee=Ee.return}J=Ee}Nr(h,g,W.children,w),g=g.child}return g;case 9:return W=g.type,I=g.pendingProps.children,Vi(g,w),W=Wr(W),I=I(W),g.flags|=1,Nr(h,g,I,w),g.child;case 14:return I=g.type,W=Qr(I,g.pendingProps),W=Qr(I.type,W),Vu(h,g,I,W,w);case 15:return Gu(h,g,g.type,g.pendingProps,w);case 17:return I=g.type,W=g.pendingProps,W=g.elementType===I?W:Qr(I,W),go(h,g),g.tag=1,Mr(I)?(h=!0,Xs(g)):h=!1,Vi(g,w),Fu(g,I,W),Ka(g,I,W,w),Za(null,g,I,!0,h,w);case 19:return Ju(h,g,w);case 22:return ju(h,g,w)}throw Error(t(156,g.tag))};function Sc(h,g){return ht(h,g)}function md(h,g,w,I){this.tag=h,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=I,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(h,g,w,I){return new md(h,g,w,I)}function Cl(h){return h=h.prototype,!(!h||!h.isReactComponent)}function gd(h){if(typeof h=="function")return Cl(h)?1:0;if(h!=null){if(h=h.$$typeof,h===xe)return 11;if(h===Me)return 14}return 2}function Un(h,g){var w=h.alternate;return w===null?(w=Yr(h.tag,g,h.key,h.mode),w.elementType=h.elementType,w.type=h.type,w.stateNode=h.stateNode,w.alternate=h,h.alternate=w):(w.pendingProps=g,w.type=h.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=h.flags&14680064,w.childLanes=h.childLanes,w.lanes=h.lanes,w.child=h.child,w.memoizedProps=h.memoizedProps,w.memoizedState=h.memoizedState,w.updateQueue=h.updateQueue,g=h.dependencies,w.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},w.sibling=h.sibling,w.index=h.index,w.ref=h.ref,w}function Ao(h,g,w,I,W,J){var Ee=2;if(I=h,typeof h=="function")Cl(h)&&(Ee=1);else if(typeof h=="string")Ee=5;else e:switch(h){case k:return ci(w.children,W,J,g);case z:Ee=8,W|=8;break;case ne:return h=Yr(12,w,g,W|2),h.elementType=ne,h.lanes=J,h;case de:return h=Yr(13,w,g,W),h.elementType=de,h.lanes=J,h;case Se:return h=Yr(19,w,g,W),h.elementType=Se,h.lanes=J,h;case _e:return No(w,W,J,g);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case Z:Ee=10;break e;case ve:Ee=9;break e;case xe:Ee=11;break e;case Me:Ee=14;break e;case Pe:Ee=16,I=null;break e}throw Error(t(130,h==null?h:typeof h,""))}return g=Yr(Ee,w,g,W),g.elementType=h,g.type=I,g.lanes=J,g}function ci(h,g,w,I){return h=Yr(7,h,I,g),h.lanes=w,h}function No(h,g,w,I){return h=Yr(22,h,I,g),h.elementType=_e,h.lanes=w,h.stateNode={isHidden:!1},h}function vl(h,g,w){return h=Yr(6,h,null,g),h.lanes=w,h}function Sl(h,g,w){return g=Yr(4,h.children!==null?h.children:[],h.key,g),g.lanes=w,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}function yd(h,g,w,I,W){this.tag=g,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yi(0),this.expirationTimes=yi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yi(0),this.identifierPrefix=I,this.onRecoverableError=W,this.mutableSourceEagerHydrationData=null}function _l(h,g,w,I,W,J,Ee,Be,Je){return h=new yd(h,g,w,Be,Je),g===1?(g=1,J===!0&&(g|=8)):g=0,J=Yr(3,null,null,g),h.current=J,J.stateNode=h,J.memoizedState={element:I,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(J),h}function Ed(h,g,w){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:I==null?null:""+I,children:h,containerInfo:g,implementation:w}}function _c(h){if(!h)return Pn;h=h._reactInternals;e:{if(He(h)!==h||h.tag!==1)throw Error(t(170));var g=h;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Mr(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(t(171))}if(h.tag===1){var w=h.type;if(Mr(w))return Xl(h,w,g)}return g}function Tc(h,g,w,I,W,J,Ee,Be,Je){return h=_l(w,I,!0,h,W,J,Ee,Be,Je),h.context=_c(null),w=h.current,I=Ir(),W=Hn(w),J=vn(I,W),J.callback=g??null,Ln(w,J,W),h.current.lanes=W,wn(h,W,I),Fr(h,I),h}function Io(h,g,w,I){var W=g.current,J=Ir(),Ee=Hn(W);return w=_c(w),g.context===null?g.context=w:g.pendingContext=w,g=vn(J,Ee),g.payload={element:h},I=I===void 0?null:I,I!==null&&(g.callback=I),h=Ln(W,g,Ee),h!==null&&(tn(h,W,Ee,J),so(h,W,Ee)),Ee}function Oo(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return h.child.stateNode;default:return h.child.stateNode}}function wc(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var w=h.retryLane;h.retryLane=w!==0&&w<g?w:g}}function Tl(h,g){wc(h,g),(h=h.alternate)&&wc(h,g)}var Rc=typeof reportError=="function"?reportError:function(h){console.error(h)};function wl(h){this._internalRoot=h}Mo.prototype.render=wl.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(t(409));Io(h,g,null,null)},Mo.prototype.unmount=wl.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;ai(function(){Io(null,h,null,null)}),g[mn]=null}};function Mo(h){this._internalRoot=h}Mo.prototype.unstable_scheduleHydration=function(h){if(h){var g=Ci();h={blockedOn:null,target:h,priority:g};for(var w=0;w<$r.length&&g!==0&&g<$r[w].priority;w++);$r.splice(w,0,h),w===0&&Fs(h)}};function Rl(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function Po(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function bc(){}function Cd(h,g,w,I,W){if(W){if(typeof I=="function"){var J=I;I=function(){var dt=Oo(Ee);J.call(dt)}}var Ee=Tc(g,I,h,0,null,!1,!1,"",bc);return h._reactRootContainer=Ee,h[mn]=Ee.current,hs(h.nodeType===8?h.parentNode:h),ai(),Ee}for(;W=h.lastChild;)h.removeChild(W);if(typeof I=="function"){var Be=I;I=function(){var dt=Oo(Je);Be.call(dt)}}var Je=_l(h,0,!1,null,null,!1,!1,"",bc);return h._reactRootContainer=Je,h[mn]=Je.current,hs(h.nodeType===8?h.parentNode:h),ai(function(){Io(g,Je,w,I)}),Je}function xo(h,g,w,I,W){var J=w._reactRootContainer;if(J){var Ee=J;if(typeof W=="function"){var Be=W;W=function(){var Je=Oo(Ee);Be.call(Je)}}Io(g,Ee,h,W)}else Ee=Cd(w,g,h,W,I);return Oo(Ee)}Ms=function(h){switch(h.tag){case 3:var g=h.stateNode;if(g.current.memoizedState.isDehydrated){var w=nn(g.pendingLanes);w!==0&&(Ei(g,w|1),Fr(g,Nt()),!(Xt&6)&&(qi=Nt()+500,xn()))}break;case 13:ai(function(){var I=Cn(h,1);if(I!==null){var W=Ir();tn(I,h,1,W)}}),Tl(h,1)}},Wn=function(h){if(h.tag===13){var g=Cn(h,134217728);if(g!==null){var w=Ir();tn(g,h,134217728,w)}Tl(h,134217728)}},dr=function(h){if(h.tag===13){var g=Hn(h),w=Cn(h,g);if(w!==null){var I=Ir();tn(w,h,g,I)}Tl(h,g)}},Ci=function(){return Wt},vi=function(h,g){var w=Wt;try{return Wt=h,g()}finally{Wt=w}},A=function(h,g,w){switch(g){case"input":if(Ve(h,w),g=w.name,w.type==="radio"&&g!=null){for(w=h;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<w.length;g++){var I=w[g];if(I!==h&&I.form===h.form){var W=Ys(I);if(!W)throw Error(t(90));we(I),Ve(I,W)}}}break;case"textarea":q(h,w);break;case"select":g=w.value,g!=null&&at(h,!!w.multiple,g,!1)}},Te=gl,ee=ai;var vd={usingClientEntryPoint:!1,Events:[ms,Fi,Ys,Y,oe,gl]},Is={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sd={bundleType:Is.bundleType,version:Is.version,rendererPackageName:Is.rendererPackageName,rendererConfig:Is.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=gt(h),h===null?null:h.stateNode},findFiberByHostInstance:Is.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fo.isDisabled&&Fo.supportsFiber)try{hi=Fo.inject(Sd),Ur=Fo}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vd,reactDom_production_min.createPortal=function(h,g){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rl(g))throw Error(t(200));return Ed(h,g,null,w)},reactDom_production_min.createRoot=function(h,g){if(!Rl(h))throw Error(t(299));var w=!1,I="",W=Rc;return g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onRecoverableError!==void 0&&(W=g.onRecoverableError)),g=_l(h,1,!1,null,null,w,!1,I,W),h[mn]=g.current,hs(h.nodeType===8?h.parentNode:h),new wl(g)},reactDom_production_min.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(t(188)):(h=Object.keys(h).join(","),Error(t(268,h)));return h=gt(g),h=h===null?null:h.stateNode,h},reactDom_production_min.flushSync=function(h){return ai(h)},reactDom_production_min.hydrate=function(h,g,w){if(!Po(g))throw Error(t(200));return xo(null,h,g,!0,w)},reactDom_production_min.hydrateRoot=function(h,g,w){if(!Rl(h))throw Error(t(405));var I=w!=null&&w.hydratedSources||null,W=!1,J="",Ee=Rc;if(w!=null&&(w.unstable_strictMode===!0&&(W=!0),w.identifierPrefix!==void 0&&(J=w.identifierPrefix),w.onRecoverableError!==void 0&&(Ee=w.onRecoverableError)),g=Tc(g,null,h,1,w??null,W,!1,J,Ee),h[mn]=g.current,hs(h),I)for(h=0;h<I.length;h++)w=I[h],W=w._getVersion,W=W(w._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[w,W]:g.mutableSourceEagerHydrationData.push(w,W);return new Mo(g)},reactDom_production_min.render=function(h,g,w){if(!Po(g))throw Error(t(200));return xo(null,h,g,!1,w)},reactDom_production_min.unmountComponentAtNode=function(h){if(!Po(h))throw Error(t(40));return h._reactRootContainer?(ai(function(){xo(null,null,h,!1,function(){h._reactRootContainer=null,h[mn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=gl,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(h,g,w,I){if(!Po(w))throw Error(t(200));if(h==null||h._reactInternals===void 0)throw Error(t(38));return xo(h,g,w,!1,I)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient(),es_error_cause={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var r=function(e){return e&&e.Math===Math&&e};return globalThis_1=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof commonjsGlobal$1=="object"&&commonjsGlobal$1)||r(typeof globalThis_1=="object"&&globalThis_1)||function(){return this}()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(r){try{return!!r()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var r=requireFails();return descriptors=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var r=requireFails();return functionBindNative=!r(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var r=requireFunctionBindNative(),e=Function.prototype.call;return functionCall=r?e.bind(e):function(){return e.apply(e,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var r={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!r.call({1:2},1);return objectPropertyIsEnumerable.f=t?function(s){var o=e(this,s);return!!o&&o.enumerable}:r,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var r=requireFunctionBindNative(),e=Function.prototype,t=e.call,n=r&&e.bind.bind(t,t);return functionUncurryThis=r?n:function(s){return function(){return t.apply(s,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var r=requireFunctionUncurryThis(),e=r({}.toString),t=r("".slice);return classofRaw=function(n){return t(e(n),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var r=requireFunctionUncurryThis(),e=requireFails(),t=requireClassofRaw(),n=Object,s=r("".split);return indexedObject=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return t(o)==="String"?s(o,""):n(o)}:n,indexedObject}var isNullOrUndefined,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined=function(r){return r==null}),isNullOrUndefined}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var r=requireIsNullOrUndefined(),e=TypeError;return requireObjectCoercible=function(t){if(r(t))throw new e("Can't call method on "+t);return t},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var r=requireIndexedObject(),e=requireRequireObjectCoercible();return toIndexedObject=function(t){return r(e(t))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var r=typeof document=="object"&&document.all;return isCallable=typeof r>"u"&&r!==void 0?function(e){return typeof e=="function"||e===r}:function(e){return typeof e=="function"},isCallable}var isObject$3,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject$3;hasRequiredIsObject=1;var r=requireIsCallable();return isObject$3=function(e){return typeof e=="object"?e!==null:r(e)},isObject$3}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var r=requireGlobalThis(),e=requireIsCallable(),t=function(n){return e(n)?n:void 0};return getBuiltIn=function(n,s){return arguments.length<2?t(r[n]):r[n]&&r[n][s]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var r=requireFunctionUncurryThis();return objectIsPrototypeOf=r({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var r=requireGlobalThis(),e=r.navigator,t=e&&e.userAgent;return environmentUserAgent=t?String(t):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var r=requireGlobalThis(),e=requireEnvironmentUserAgent(),t=r.process,n=r.Deno,s=t&&t.versions||n&&n.version,o=s&&s.v8,a,l;return o&&(a=o.split("."),l=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!l&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(l=+a[1]))),environmentV8Version=l,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var r=requireEnvironmentV8Version(),e=requireFails(),t=requireGlobalThis(),n=t.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!e(function(){var s=Symbol("symbol detection");return!n(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&r&&r<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var r=requireSymbolConstructorDetection();return useSymbolAsUid=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol;hasRequiredIsSymbol=1;var r=requireGetBuiltIn(),e=requireIsCallable(),t=requireObjectIsPrototypeOf(),n=requireUseSymbolAsUid(),s=Object;return isSymbol=n?function(o){return typeof o=="symbol"}:function(o){var a=r("Symbol");return e(a)&&t(a.prototype,s(o))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var r=String;return tryToString=function(e){try{return r(e)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var r=requireIsCallable(),e=requireTryToString(),t=TypeError;return aCallable=function(n){if(r(n))return n;throw new t(e(n)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var r=requireACallable(),e=requireIsNullOrUndefined();return getMethod=function(t,n){var s=t[n];return e(s)?void 0:r(s)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var r=requireFunctionCall(),e=requireIsCallable(),t=requireIsObject(),n=TypeError;return ordinaryToPrimitive=function(s,o){var a,l;if(o==="string"&&e(a=s.toString)&&!t(l=r(a,s))||e(a=s.valueOf)&&!t(l=r(a,s))||o!=="string"&&e(a=s.toString)&&!t(l=r(a,s)))return l;throw new n("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var r=requireGlobalThis(),e=Object.defineProperty;return defineGlobalProperty=function(t,n){try{e(r,t,{value:n,configurable:!0,writable:!0})}catch{r[t]=n}return n},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var r=requireIsPure(),e=requireGlobalThis(),t=requireDefineGlobalProperty(),n="__core-js_shared__",s=sharedStore.exports=e[n]||t(n,{});return(s.versions||(s.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var r=requireSharedStore();return shared=function(e,t){return r[e]||(r[e]=t||{})},shared}var toObject$1,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject$1;hasRequiredToObject=1;var r=requireRequireObjectCoercible(),e=Object;return toObject$1=function(t){return e(r(t))},toObject$1}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var r=requireFunctionUncurryThis(),e=requireToObject(),t=r({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(s,o){return t(e(s),o)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var r=requireFunctionUncurryThis(),e=0,t=Math.random(),n=r(1 .toString);return uid=function(s){return"Symbol("+(s===void 0?"":s)+")_"+n(++e+t,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var r=requireGlobalThis(),e=requireShared(),t=requireHasOwnProperty(),n=requireUid(),s=requireSymbolConstructorDetection(),o=requireUseSymbolAsUid(),a=r.Symbol,l=e("wks"),u=o?a.for||a:a&&a.withoutSetter||n;return wellKnownSymbol=function(c){return t(l,c)||(l[c]=s&&t(a,c)?a[c]:u("Symbol."+c)),l[c]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var r=requireFunctionCall(),e=requireIsObject(),t=requireIsSymbol(),n=requireGetMethod(),s=requireOrdinaryToPrimitive(),o=requireWellKnownSymbol(),a=TypeError,l=o("toPrimitive");return toPrimitive=function(u,c){if(!e(u)||t(u))return u;var d=n(u,l),f;if(d){if(c===void 0&&(c="default"),f=r(d,u,c),!e(f)||t(f))return f;throw new a("Can't convert object to primitive value")}return c===void 0&&(c="number"),s(u,c)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var r=requireToPrimitive(),e=requireIsSymbol();return toPropertyKey=function(t){var n=r(t,"string");return e(n)?n:n+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var r=requireGlobalThis(),e=requireIsObject(),t=r.document,n=e(t)&&e(t.createElement);return documentCreateElement=function(s){return n?t.createElement(s):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var r=requireDescriptors(),e=requireFails(),t=requireDocumentCreateElement();return ie8DomDefine=!r&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var r=requireDescriptors(),e=requireFunctionCall(),t=requireObjectPropertyIsEnumerable(),n=requireCreatePropertyDescriptor(),s=requireToIndexedObject(),o=requireToPropertyKey(),a=requireHasOwnProperty(),l=requireIe8DomDefine(),u=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=r?u:function(d,f){if(d=s(d),f=o(f),l)try{return u(d,f)}catch{}if(a(d,f))return n(!e(t.f,d,f),d[f])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var r=requireDescriptors(),e=requireFails();return v8PrototypeDefineBug=r&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var r=requireIsObject(),e=String,t=TypeError;return anObject=function(n){if(r(n))return n;throw new t(e(n)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var r=requireDescriptors(),e=requireIe8DomDefine(),t=requireV8PrototypeDefineBug(),n=requireAnObject(),s=requireToPropertyKey(),o=TypeError,a=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u="enumerable",c="configurable",d="writable";return objectDefineProperty.f=r?t?function(C,m,E){if(n(C),m=s(m),n(E),typeof C=="function"&&m==="prototype"&&"value"in E&&d in E&&!E[d]){var v=l(C,m);v&&v[d]&&(C[m]=E.value,E={configurable:c in E?E[c]:v[c],enumerable:u in E?E[u]:v[u],writable:!1})}return a(C,m,E)}:a:function(C,m,E){if(n(C),m=s(m),n(E),e)try{return a(C,m,E)}catch{}if("get"in E||"set"in E)throw new o("Accessors not supported");return"value"in E&&(C[m]=E.value),C},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var r=requireDescriptors(),e=requireObjectDefineProperty(),t=requireCreatePropertyDescriptor();return createNonEnumerableProperty=r?function(n,s,o){return e.f(n,s,t(1,o))}:function(n,s,o){return n[s]=o,n},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName$1,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName$1;hasRequiredFunctionName=1;var r=requireDescriptors(),e=requireHasOwnProperty(),t=Function.prototype,n=r&&Object.getOwnPropertyDescriptor,s=e(t,"name"),o=s&&(function(){}).name==="something",a=s&&(!r||r&&n(t,"name").configurable);return functionName$1={EXISTS:s,PROPER:o,CONFIGURABLE:a},functionName$1}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var r=requireFunctionUncurryThis(),e=requireIsCallable(),t=requireSharedStore(),n=r(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(s){return n(s)}),inspectSource=t.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var r=requireGlobalThis(),e=requireIsCallable(),t=r.WeakMap;return weakMapBasicDetection=e(t)&&/native code/.test(String(t)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var r=requireShared(),e=requireUid(),t=r("keys");return sharedKey=function(n){return t[n]||(t[n]=e(n))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var r=requireWeakMapBasicDetection(),e=requireGlobalThis(),t=requireIsObject(),n=requireCreateNonEnumerableProperty(),s=requireHasOwnProperty(),o=requireSharedStore(),a=requireSharedKey(),l=requireHiddenKeys(),u="Object already initialized",c=e.TypeError,d=e.WeakMap,f,C,m,E=function(R){return m(R)?C(R):f(R,{})},v=function(R){return function(O){var N;if(!t(O)||(N=C(O)).type!==R)throw new c("Incompatible receiver, "+R+" required");return N}};if(r||o.state){var _=o.state||(o.state=new d);_.get=_.get,_.has=_.has,_.set=_.set,f=function(R,O){if(_.has(R))throw new c(u);return O.facade=R,_.set(R,O),O},C=function(R){return _.get(R)||{}},m=function(R){return _.has(R)}}else{var T=a("state");l[T]=!0,f=function(R,O){if(s(R,T))throw new c(u);return O.facade=R,n(R,T,O),O},C=function(R){return s(R,T)?R[T]:{}},m=function(R){return s(R,T)}}return internalState={set:f,get:C,has:m,enforce:E,getterFor:v},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var r=requireFunctionUncurryThis(),e=requireFails(),t=requireIsCallable(),n=requireHasOwnProperty(),s=requireDescriptors(),o=requireFunctionName().CONFIGURABLE,a=requireInspectSource(),l=requireInternalState(),u=l.enforce,c=l.get,d=String,f=Object.defineProperty,C=r("".slice),m=r("".replace),E=r([].join),v=s&&!e(function(){return f(function(){},"length",{value:8}).length!==8}),_=String(String).split("String"),T=makeBuiltIn.exports=function(R,O,N){C(d(O),0,7)==="Symbol("&&(O="["+m(d(O),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),N&&N.getter&&(O="get "+O),N&&N.setter&&(O="set "+O),(!n(R,"name")||o&&R.name!==O)&&(s?f(R,"name",{value:O,configurable:!0}):R.name=O),v&&N&&n(N,"arity")&&R.length!==N.arity&&f(R,"length",{value:N.arity});try{N&&n(N,"constructor")&&N.constructor?s&&f(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var G=u(R);return n(G,"source")||(G.source=E(_,typeof O=="string"?O:"")),R};return Function.prototype.toString=T(function(){return t(this)&&c(this).source||a(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var r=requireIsCallable(),e=requireObjectDefineProperty(),t=requireMakeBuiltIn(),n=requireDefineGlobalProperty();return defineBuiltIn=function(s,o,a,l){l||(l={});var u=l.enumerable,c=l.name!==void 0?l.name:o;if(r(a)&&t(a,c,l),l.global)u?s[o]=a:n(o,a);else{try{l.unsafe?s[o]&&(u=!0):delete s[o]}catch{}u?s[o]=a:e.f(s,o,{value:a,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return s},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var r=Math.ceil,e=Math.floor;return mathTrunc=Math.trunc||function(n){var s=+n;return(s>0?e:r)(s)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var r=requireMathTrunc();return toIntegerOrInfinity=function(e){var t=+e;return t!==t||t===0?0:r(t)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var r=requireToIntegerOrInfinity(),e=Math.max,t=Math.min;return toAbsoluteIndex=function(n,s){var o=r(n);return o<0?e(o+s,0):t(o,s)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var r=requireToIntegerOrInfinity(),e=Math.min;return toLength=function(t){var n=r(t);return n>0?e(n,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var r=requireToLength();return lengthOfArrayLike=function(e){return r(e.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var r=requireToIndexedObject(),e=requireToAbsoluteIndex(),t=requireLengthOfArrayLike(),n=function(s){return function(o,a,l){var u=r(o),c=t(u);if(c===0)return!s&&-1;var d=e(l,c),f;if(s&&a!==a){for(;c>d;)if(f=u[d++],f!==f)return!0}else for(;c>d;d++)if((s||d in u)&&u[d]===a)return s||d||0;return!s&&-1}};return arrayIncludes={includes:n(!0),indexOf:n(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var r=requireFunctionUncurryThis(),e=requireHasOwnProperty(),t=requireToIndexedObject(),n=requireArrayIncludes().indexOf,s=requireHiddenKeys(),o=r([].push);return objectKeysInternal=function(a,l){var u=t(a),c=0,d=[],f;for(f in u)!e(s,f)&&e(u,f)&&o(d,f);for(;l.length>c;)e(u,f=l[c++])&&(~n(d,f)||o(d,f));return d},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var r=requireObjectKeysInternal(),e=requireEnumBugKeys(),t=e.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(s){return r(s,t)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys$1,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys$1;hasRequiredOwnKeys=1;var r=requireGetBuiltIn(),e=requireFunctionUncurryThis(),t=requireObjectGetOwnPropertyNames(),n=requireObjectGetOwnPropertySymbols(),s=requireAnObject(),o=e([].concat);return ownKeys$1=r("Reflect","ownKeys")||function(l){var u=t.f(s(l)),c=n.f;return c?o(u,c(l)):u},ownKeys$1}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var r=requireHasOwnProperty(),e=requireOwnKeys(),t=requireObjectGetOwnPropertyDescriptor(),n=requireObjectDefineProperty();return copyConstructorProperties=function(s,o,a){for(var l=e(o),u=n.f,c=t.f,d=0;d<l.length;d++){var f=l[d];!r(s,f)&&!(a&&r(a,f))&&u(s,f,c(o,f))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var r=requireFails(),e=requireIsCallable(),t=/#|\.prototype\./,n=function(u,c){var d=o[s(u)];return d===l?!0:d===a?!1:e(c)?r(c):!!c},s=n.normalize=function(u){return String(u).replace(t,".").toLowerCase()},o=n.data={},a=n.NATIVE="N",l=n.POLYFILL="P";return isForced_1=n,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var r=requireGlobalThis(),e=requireObjectGetOwnPropertyDescriptor().f,t=requireCreateNonEnumerableProperty(),n=requireDefineBuiltIn(),s=requireDefineGlobalProperty(),o=requireCopyConstructorProperties(),a=requireIsForced();return _export=function(l,u){var c=l.target,d=l.global,f=l.stat,C,m,E,v,_,T;if(d?m=r:f?m=r[c]||s(c,{}):m=r[c]&&r[c].prototype,m)for(E in u){if(_=u[E],l.dontCallGetSet?(T=e(m,E),v=T&&T.value):v=m[E],C=a(d?E:c+(f?".":"#")+E,l.forced),!C&&v!==void 0){if(typeof _==typeof v)continue;o(_,v)}(l.sham||v&&v.sham)&&t(_,"sham",!0),n(m,E,_,l)}},_export}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var r=requireFunctionBindNative(),e=Function.prototype,t=e.apply,n=e.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(r?n.bind(t):function(){return n.apply(t,arguments)}),functionApply}var functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var r=requireFunctionUncurryThis(),e=requireACallable();return functionUncurryThisAccessor=function(t,n,s){try{return r(e(Object.getOwnPropertyDescriptor(t,n)[s]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var r=requireIsObject();return isPossiblePrototype=function(e){return r(e)||e===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var r=requireIsPossiblePrototype(),e=String,t=TypeError;return aPossiblePrototype=function(n){if(r(n))return n;throw new t("Can't set "+e(n)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var r=requireFunctionUncurryThisAccessor(),e=requireIsObject(),t=requireRequireObjectCoercible(),n=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var s=!1,o={},a;try{a=r(Object.prototype,"__proto__","set"),a(o,[]),s=o instanceof Array}catch{}return function(u,c){return t(u),n(c),e(u)&&(s?a(u,c):u.__proto__=c),u}}():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var r=requireObjectDefineProperty().f;return proxyAccessor=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(s){t[n]=s}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var r=requireIsCallable(),e=requireIsObject(),t=requireObjectSetPrototypeOf();return inheritIfRequired=function(n,s,o){var a,l;return t&&r(a=s.constructor)&&a!==o&&e(l=a.prototype)&&l!==o.prototype&&t(n,l),n},inheritIfRequired}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var r=requireWellKnownSymbol(),e=r("toStringTag"),t={};return t[e]="z",toStringTagSupport=String(t)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var r=requireToStringTagSupport(),e=requireIsCallable(),t=requireClassofRaw(),n=requireWellKnownSymbol(),s=n("toStringTag"),o=Object,a=t(function(){return arguments}())==="Arguments",l=function(u,c){try{return u[c]}catch{}};return classof=r?t:function(u){var c,d,f;return u===void 0?"Undefined":u===null?"Null":typeof(d=l(c=o(u),s))=="string"?d:a?t(c):(f=t(c))==="Object"&&e(c.callee)?"Arguments":f},classof}var toString$1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString$1;hasRequiredToString=1;var r=requireClassof(),e=String;return toString$1=function(t){if(r(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(t)},toString$1}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var r=requireToString();return normalizeStringArgument=function(e,t){return e===void 0?arguments.length<2?"":t:r(e)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var r=requireIsObject(),e=requireCreateNonEnumerableProperty();return installErrorCause=function(t,n){r(n)&&"cause"in n&&e(t,"cause",n.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var r=requireFunctionUncurryThis(),e=Error,t=r("".replace),n=function(a){return String(new e(a).stack)}("zxcasd"),s=/\n\s*at [^:]*:[^\n]*/,o=s.test(n);return errorStackClear=function(a,l){if(o&&typeof a=="string"&&!e.prepareStackTrace)for(;l--;)a=t(a,s,"");return a},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var r=requireFails(),e=requireCreatePropertyDescriptor();return errorStackInstallable=!r(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",e(1,7)),t.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var r=requireCreateNonEnumerableProperty(),e=requireErrorStackClear(),t=requireErrorStackInstallable(),n=Error.captureStackTrace;return errorStackInstall=function(s,o,a,l){t&&(n?n(s,o):r(s,"stack",e(a,l)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var r=requireGetBuiltIn(),e=requireHasOwnProperty(),t=requireCreateNonEnumerableProperty(),n=requireObjectIsPrototypeOf(),s=requireObjectSetPrototypeOf(),o=requireCopyConstructorProperties(),a=requireProxyAccessor(),l=requireInheritIfRequired(),u=requireNormalizeStringArgument(),c=requireInstallErrorCause(),d=requireErrorStackInstall(),f=requireDescriptors(),C=requireIsPure();return wrapErrorConstructorWithCause=function(m,E,v,_){var T="stackTraceLimit",R=_?2:1,O=m.split("."),N=O[O.length-1],G=r.apply(null,O);if(G){var D=G.prototype;if(!C&&e(D,"cause")&&delete D.cause,!v)return G;var k=r("Error"),z=E(function(ne,Z){var ve=u(_?Z:ne,void 0),xe=_?new G(ne):new G;return ve!==void 0&&t(xe,"message",ve),d(xe,z,xe.stack,2),this&&n(D,this)&&l(xe,this,z),arguments.length>R&&c(xe,arguments[R]),xe});if(z.prototype=D,N!=="Error"?s?s(z,k):o(z,k,{name:!0}):f&&T in G&&(a(z,G,T),a(z,G,"prepareStackTrace")),o(z,G),!C)try{D.name!==N&&t(D,"name",N),D.constructor=z}catch{}return z}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var r=require_export(),e=requireGlobalThis(),t=requireFunctionApply(),n=requireWrapErrorConstructorWithCause(),s="WebAssembly",o=e[s],a=new Error("e",{cause:7}).cause!==7,l=function(c,d){var f={};f[c]=n(c,d,a),r({global:!0,constructor:!0,arity:1,forced:a},f)},u=function(c,d){if(o&&o[c]){var f={};f[c]=n(s+"."+c,d,a),r({target:s,stat:!0,constructor:!0,arity:1,forced:a},f)}};return l("Error",function(c){return function(f){return t(c,this,arguments)}}),l("EvalError",function(c){return function(f){return t(c,this,arguments)}}),l("RangeError",function(c){return function(f){return t(c,this,arguments)}}),l("ReferenceError",function(c){return function(f){return t(c,this,arguments)}}),l("SyntaxError",function(c){return function(f){return t(c,this,arguments)}}),l("TypeError",function(c){return function(f){return t(c,this,arguments)}}),l("URIError",function(c){return function(f){return t(c,this,arguments)}}),u("CompileError",function(c){return function(f){return t(c,this,arguments)}}),u("LinkError",function(c){return function(f){return t(c,this,arguments)}}),u("RuntimeError",function(c){return function(f){return t(c,this,arguments)}}),es_error_cause}requireEs_error_cause();var es_array_push={},isArray$3,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray$3;hasRequiredIsArray=1;var r=requireClassofRaw();return isArray$3=Array.isArray||function(t){return r(t)==="Array"},isArray$3}var arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var r=requireDescriptors(),e=requireIsArray(),t=TypeError,n=Object.getOwnPropertyDescriptor,s=r&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return arraySetLength=s?function(o,a){if(e(o)&&!n(o,"length").writable)throw new t("Cannot set read only .length");return o.length=a}:function(o,a){return o.length=a},arraySetLength}var doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var r=TypeError,e=9007199254740991;return doesNotExceedSafeInteger=function(t){if(t>e)throw r("Maximum allowed index exceeded");return t},doesNotExceedSafeInteger}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireArraySetLength(),s=requireDoesNotExceedSafeInteger(),o=requireFails(),a=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),l=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},u=a||!l();return r({target:"Array",proto:!0,arity:1,forced:u},{push:function(d){var f=e(this),C=t(f),m=arguments.length;s(C+m);for(var E=0;E<m;E++)f[C]=arguments[E],C++;return n(f,C),C}}),es_array_push}requireEs_array_push();var esnext_iterator_constructor={},es_iterator_constructor={},anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var r=requireObjectIsPrototypeOf(),e=TypeError;return anInstance=function(t,n){if(r(n,t))return t;throw new e("Incorrect invocation")},anInstance}var correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var r=requireFails();return correctPrototypeGetter=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var r=requireHasOwnProperty(),e=requireIsCallable(),t=requireToObject(),n=requireSharedKey(),s=requireCorrectPrototypeGetter(),o=n("IE_PROTO"),a=Object,l=a.prototype;return objectGetPrototypeOf=s?a.getPrototypeOf:function(u){var c=t(u);if(r(c,o))return c[o];var d=c.constructor;return e(d)&&c instanceof d?d.prototype:c instanceof a?l:null},objectGetPrototypeOf}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var r=requireMakeBuiltIn(),e=requireObjectDefineProperty();return defineBuiltInAccessor=function(t,n,s){return s.get&&r(s.get,n,{getter:!0}),s.set&&r(s.set,n,{setter:!0}),e.f(t,n,s)},defineBuiltInAccessor}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var r=requireDescriptors(),e=requireObjectDefineProperty(),t=requireCreatePropertyDescriptor();return createProperty=function(n,s,o){r?e.f(n,s,t(0,o)):n[s]=o},createProperty}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var r=requireObjectKeysInternal(),e=requireEnumBugKeys();return objectKeys=Object.keys||function(n){return r(n,e)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var r=requireDescriptors(),e=requireV8PrototypeDefineBug(),t=requireObjectDefineProperty(),n=requireAnObject(),s=requireToIndexedObject(),o=requireObjectKeys();return objectDefineProperties.f=r&&!e?Object.defineProperties:function(l,u){n(l);for(var c=s(u),d=o(u),f=d.length,C=0,m;f>C;)t.f(l,m=d[C++],c[m]);return l},objectDefineProperties}var html$2,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html$2;hasRequiredHtml=1;var r=requireGetBuiltIn();return html$2=r("document","documentElement"),html$2}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var r=requireAnObject(),e=requireObjectDefineProperties(),t=requireEnumBugKeys(),n=requireHiddenKeys(),s=requireHtml(),o=requireDocumentCreateElement(),a=requireSharedKey(),l=">",u="<",c="prototype",d="script",f=a("IE_PROTO"),C=function(){},m=function(R){return u+d+l+R+u+"/"+d+l},E=function(R){R.write(m("")),R.close();var O=R.parentWindow.Object;return R=null,O},v=function(){var R=o("iframe"),O="java"+d+":",N;return R.style.display="none",s.appendChild(R),R.src=String(O),N=R.contentWindow.document,N.open(),N.write(m("document.F=Object")),N.close(),N.F},_,T=function(){try{_=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&_?E(_):v():E(_);for(var R=t.length;R--;)delete T[c][t[R]];return T()};return n[f]=!0,objectCreate=Object.create||function(O,N){var G;return O!==null?(C[c]=r(O),G=new C,C[c]=null,G[f]=O):G=T(),N===void 0?G:e.f(G,N)},objectCreate}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var r=requireFails(),e=requireIsCallable(),t=requireIsObject(),n=requireObjectCreate(),s=requireObjectGetPrototypeOf(),o=requireDefineBuiltIn(),a=requireWellKnownSymbol(),l=requireIsPure(),u=a("iterator"),c=!1,d,f,C;[].keys&&(C=[].keys(),"next"in C?(f=s(s(C)),f!==Object.prototype&&(d=f)):c=!0);var m=!t(d)||r(function(){var E={};return d[u].call(E)!==E});return m?d={}:l&&(d=n(d)),e(d[u])||o(d,u,function(){return this}),iteratorsCore={IteratorPrototype:d,BUGGY_SAFARI_ITERATORS:c},iteratorsCore}var hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var r=require_export(),e=requireGlobalThis(),t=requireAnInstance(),n=requireAnObject(),s=requireIsCallable(),o=requireObjectGetPrototypeOf(),a=requireDefineBuiltInAccessor(),l=requireCreateProperty(),u=requireFails(),c=requireHasOwnProperty(),d=requireWellKnownSymbol(),f=requireIteratorsCore().IteratorPrototype,C=requireDescriptors(),m=requireIsPure(),E="constructor",v="Iterator",_=d("toStringTag"),T=TypeError,R=e[v],O=m||!s(R)||R.prototype!==f||!u(function(){R({})}),N=function(){if(t(this,f),o(this)===f)throw new T("Abstract class Iterator not directly constructable")},G=function(D,k){C?a(f,D,{configurable:!0,get:function(){return k},set:function(z){if(n(this),this===f)throw new T("You can't redefine this property");c(this,D)?this[D]=z:l(this,D,z)}}):f[D]=k};return c(f,_)||G(_,v),(O||!c(f,E)||f[E]===Object)&&G(E,N),N.prototype=f,r({global:!0,constructor:!0,forced:O},{Iterator:N}),es_iterator_constructor}var hasRequiredEsnext_iterator_constructor;function requireEsnext_iterator_constructor(){return hasRequiredEsnext_iterator_constructor||(hasRequiredEsnext_iterator_constructor=1,requireEs_iterator_constructor()),esnext_iterator_constructor}requireEsnext_iterator_constructor();var esnext_iterator_filter={},es_iterator_filter={},getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(r){return{iterator:r,next:r.next,done:!1}}),getIteratorDirect}var defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var r=requireDefineBuiltIn();return defineBuiltIns=function(e,t,n){for(var s in t)r(e,s,t[s],n);return e},defineBuiltIns}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(r,e){return{value:r,done:e}}),createIterResultObject}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var r=requireFunctionCall(),e=requireAnObject(),t=requireGetMethod();return iteratorClose=function(n,s,o){var a,l;e(n);try{if(a=t(n,"return"),!a){if(s==="throw")throw o;return o}a=r(a,n)}catch(u){l=!0,a=u}if(s==="throw")throw o;if(l)throw a;return e(a),o},iteratorClose}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var r=requireFunctionCall(),e=requireObjectCreate(),t=requireCreateNonEnumerableProperty(),n=requireDefineBuiltIns(),s=requireWellKnownSymbol(),o=requireInternalState(),a=requireGetMethod(),l=requireIteratorsCore().IteratorPrototype,u=requireCreateIterResultObject(),c=requireIteratorClose(),d=s("toStringTag"),f="IteratorHelper",C="WrapForValidIterator",m=o.set,E=function(T){var R=o.getterFor(T?C:f);return n(e(l),{next:function(){var N=R(this);if(T)return N.nextHandler();if(N.done)return u(void 0,!0);try{var G=N.nextHandler();return N.returnHandlerResult?G:u(G,N.done)}catch(D){throw N.done=!0,D}},return:function(){var O=R(this),N=O.iterator;if(O.done=!0,T){var G=a(N,"return");return G?r(G,N):u(void 0,!0)}if(O.inner)try{c(O.inner.iterator,"normal")}catch(D){return c(N,"throw",D)}return N&&c(N,"normal"),u(void 0,!0)}})},v=E(!0),_=E(!1);return t(_,d,"Iterator Helper"),iteratorCreateProxy=function(T,R,O){var N=function(D,k){k?(k.iterator=D.iterator,k.next=D.next):k=D,k.type=R?C:f,k.returnHandlerResult=!!O,k.nextHandler=T,k.counter=0,k.done=!1,m(this,k)};return N.prototype=R?v:_,N},iteratorCreateProxy}var callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var r=requireAnObject(),e=requireIteratorClose();return callWithSafeIterationClosing=function(t,n,s,o){try{return o?n(r(s)[0],s[1]):n(s)}catch(a){e(t,"throw",a)}},callWithSafeIterationClosing}var hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var r=require_export(),e=requireFunctionCall(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorCreateProxy(),a=requireCallWithSafeIterationClosing(),l=requireIsPure(),u=o(function(){for(var c=this.iterator,d=this.predicate,f=this.next,C,m,E;;){if(C=n(e(f,c)),m=this.done=!!C.done,m)return;if(E=C.value,a(c,d,[E,this.counter++],!0))return E}});return r({target:"Iterator",proto:!0,real:!0,forced:l},{filter:function(d){return n(this),t(d),new u(s(this),{predicate:d})}}),es_iterator_filter}var hasRequiredEsnext_iterator_filter;function requireEsnext_iterator_filter(){return hasRequiredEsnext_iterator_filter||(hasRequiredEsnext_iterator_filter=1,requireEs_iterator_filter()),esnext_iterator_filter}requireEsnext_iterator_filter();var esnext_iterator_find={},es_iterator_find={},functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var r=requireClassofRaw(),e=requireFunctionUncurryThis();return functionUncurryThisClause=function(t){if(r(t)==="Function")return e(t)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var r=requireFunctionUncurryThisClause(),e=requireACallable(),t=requireFunctionBindNative(),n=r(r.bind);return functionBindContext=function(s,o){return e(s),o===void 0?s:t?n(s,o):function(){return s.apply(o,arguments)}},functionBindContext}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var r=requireWellKnownSymbol(),e=requireIterators(),t=r("iterator"),n=Array.prototype;return isArrayIteratorMethod=function(s){return s!==void 0&&(e.Array===s||n[t]===s)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var r=requireClassof(),e=requireGetMethod(),t=requireIsNullOrUndefined(),n=requireIterators(),s=requireWellKnownSymbol(),o=s("iterator");return getIteratorMethod=function(a){if(!t(a))return e(a,o)||e(a,"@@iterator")||n[r(a)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var r=requireFunctionCall(),e=requireACallable(),t=requireAnObject(),n=requireTryToString(),s=requireGetIteratorMethod(),o=TypeError;return getIterator=function(a,l){var u=arguments.length<2?s(a):l;if(e(u))return t(r(u,a));throw new o(n(a)+" is not iterable")},getIterator}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var r=requireFunctionBindContext(),e=requireFunctionCall(),t=requireAnObject(),n=requireTryToString(),s=requireIsArrayIteratorMethod(),o=requireLengthOfArrayLike(),a=requireObjectIsPrototypeOf(),l=requireGetIterator(),u=requireGetIteratorMethod(),c=requireIteratorClose(),d=TypeError,f=function(m,E){this.stopped=m,this.result=E},C=f.prototype;return iterate=function(m,E,v){var _=v&&v.that,T=!!(v&&v.AS_ENTRIES),R=!!(v&&v.IS_RECORD),O=!!(v&&v.IS_ITERATOR),N=!!(v&&v.INTERRUPTED),G=r(E,_),D,k,z,ne,Z,ve,xe,de=function(Me){return D&&c(D,"normal",Me),new f(!0,Me)},Se=function(Me){return T?(t(Me),N?G(Me[0],Me[1],de):G(Me[0],Me[1])):N?G(Me,de):G(Me)};if(R)D=m.iterator;else if(O)D=m;else{if(k=u(m),!k)throw new d(n(m)+" is not iterable");if(s(k)){for(z=0,ne=o(m);ne>z;z++)if(Z=Se(m[z]),Z&&a(C,Z))return Z;return new f(!1)}D=l(m,k)}for(ve=R?m.next:D.next;!(xe=e(ve,D)).done;){try{Z=Se(xe.value)}catch(Me){c(D,"throw",Me)}if(typeof Z=="object"&&Z&&a(C,Z))return Z}return new f(!1)},iterate}var hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{find:function(a){n(this),t(a);var l=s(this),u=0;return e(l,function(c,d){if(a(c,u++))return d(c)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var hasRequiredEsnext_iterator_find;function requireEsnext_iterator_find(){return hasRequiredEsnext_iterator_find||(hasRequiredEsnext_iterator_find=1,requireEs_iterator_find()),esnext_iterator_find}requireEsnext_iterator_find();var esnext_iterator_reduce={},es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=TypeError;return r({target:"Iterator",proto:!0,real:!0},{reduce:function(l){n(this),t(l);var u=s(this),c=arguments.length<2,d=c?void 0:arguments[1],f=0;if(e(u,function(C){c?(c=!1,d=C):d=l(d,C,f),f++},{IS_RECORD:!0}),c)throw new o("Reduce of empty iterator with no initial value");return d}}),es_iterator_reduce}var hasRequiredEsnext_iterator_reduce;function requireEsnext_iterator_reduce(){return hasRequiredEsnext_iterator_reduce||(hasRequiredEsnext_iterator_reduce=1,requireEs_iterator_reduce()),esnext_iterator_reduce}requireEsnext_iterator_reduce();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(r){hookCallback=r}function isArray$2(r){return r instanceof Array||Object.prototype.toString.call(r)==="[object Array]"}function isObject$2(r){return r!=null&&Object.prototype.toString.call(r)==="[object Object]"}function hasOwnProp(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function isObjectEmpty(r){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(r).length===0;var e;for(e in r)if(hasOwnProp(r,e))return!1;return!0}function isUndefined$2(r){return r===void 0}function isNumber$1(r){return typeof r=="number"||Object.prototype.toString.call(r)==="[object Number]"}function isDate$2(r){return r instanceof Date||Object.prototype.toString.call(r)==="[object Date]"}function map$1(r,e){var t=[],n,s=r.length;for(n=0;n<s;++n)t.push(e(r[n],n));return t}function extend$2(r,e){for(var t in e)hasOwnProp(e,t)&&(r[t]=e[t]);return hasOwnProp(e,"toString")&&(r.toString=e.toString),hasOwnProp(e,"valueOf")&&(r.valueOf=e.valueOf),r}function createUTC(r,e,t,n){return createLocalOrUTC(r,e,t,n,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(r){return r._pf==null&&(r._pf=defaultParsingFlags()),r._pf}var some$1;Array.prototype.some?some$1=Array.prototype.some:some$1=function(r){var e=Object(this),t=e.length>>>0,n;for(n=0;n<t;n++)if(n in e&&r.call(this,e[n],n,e))return!0;return!1};function isValid(r){var e=null,t=!1,n=r._d&&!isNaN(r._d.getTime());if(n&&(e=getParsingFlags(r),t=some$1.call(e.parsedDateParts,function(s){return s!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),r._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(r))r._isValid=n;else return n;return r._isValid}function createInvalid(r){var e=createUTC(NaN);return r!=null?extend$2(getParsingFlags(e),r):getParsingFlags(e).userInvalidated=!0,e}var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(r,e){var t,n,s,o=momentProperties.length;if(isUndefined$2(e._isAMomentObject)||(r._isAMomentObject=e._isAMomentObject),isUndefined$2(e._i)||(r._i=e._i),isUndefined$2(e._f)||(r._f=e._f),isUndefined$2(e._l)||(r._l=e._l),isUndefined$2(e._strict)||(r._strict=e._strict),isUndefined$2(e._tzm)||(r._tzm=e._tzm),isUndefined$2(e._isUTC)||(r._isUTC=e._isUTC),isUndefined$2(e._offset)||(r._offset=e._offset),isUndefined$2(e._pf)||(r._pf=getParsingFlags(e)),isUndefined$2(e._locale)||(r._locale=e._locale),o>0)for(t=0;t<o;t++)n=momentProperties[t],s=e[n],isUndefined$2(s)||(r[n]=s);return r}function Moment(r){copyConfig(this,r),this._d=new Date(r._d!=null?r._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),updateInProgress===!1&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(r){return r instanceof Moment||r!=null&&r._isAMomentObject!=null}function warn$2(r){hooks.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+r)}function deprecate(r,e){var t=!0;return extend$2(function(){if(hooks.deprecationHandler!=null&&hooks.deprecationHandler(null,r),t){var n=[],s,o,a,l=arguments.length;for(o=0;o<l;o++){if(s="",typeof arguments[o]=="object"){s+=`
[`+o+"] ";for(a in arguments[0])hasOwnProp(arguments[0],a)&&(s+=a+": "+arguments[0][a]+", ");s=s.slice(0,-2)}else s=arguments[o];n.push(s)}warn$2(r+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var deprecations={};function deprecateSimple(r,e){hooks.deprecationHandler!=null&&hooks.deprecationHandler(r,e),deprecations[r]||(warn$2(e),deprecations[r]=!0)}hooks.suppressDeprecationWarnings=!1;hooks.deprecationHandler=null;function isFunction$3(r){return typeof Function<"u"&&r instanceof Function||Object.prototype.toString.call(r)==="[object Function]"}function set$1(r){var e,t;for(t in r)hasOwnProp(r,t)&&(e=r[t],isFunction$3(e)?this[t]=e:this["_"+t]=e);this._config=r,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(r,e){var t=extend$2({},r),n;for(n in e)hasOwnProp(e,n)&&(isObject$2(r[n])&&isObject$2(e[n])?(t[n]={},extend$2(t[n],r[n]),extend$2(t[n],e[n])):e[n]!=null?t[n]=e[n]:delete t[n]);for(n in r)hasOwnProp(r,n)&&!hasOwnProp(e,n)&&isObject$2(r[n])&&(t[n]=extend$2({},t[n]));return t}function Locale(r){r!=null&&this.set(r)}var keys$2;Object.keys?keys$2=Object.keys:keys$2=function(r){var e,t=[];for(e in r)hasOwnProp(r,e)&&t.push(e);return t};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(r,e,t){var n=this._calendar[r]||this._calendar.sameElse;return isFunction$3(n)?n.call(e,t):n}function zeroFill(r,e,t){var n=""+Math.abs(r),s=e-n.length,o=r>=0;return(o?t?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(r,e,t,n){var s=n;typeof n=="string"&&(s=function(){return this[n]()}),r&&(formatTokenFunctions[r]=s),e&&(formatTokenFunctions[e[0]]=function(){return zeroFill(s.apply(this,arguments),e[1],e[2])}),t&&(formatTokenFunctions[t]=function(){return this.localeData().ordinal(s.apply(this,arguments),r)})}function removeFormattingTokens(r){return r.match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"")}function makeFormatFunction(r){var e=r.match(formattingTokens),t,n;for(t=0,n=e.length;t<n;t++)formatTokenFunctions[e[t]]?e[t]=formatTokenFunctions[e[t]]:e[t]=removeFormattingTokens(e[t]);return function(s){var o="",a;for(a=0;a<n;a++)o+=isFunction$3(e[a])?e[a].call(s,r):e[a];return o}}function formatMoment(r,e){return r.isValid()?(e=expandFormat(e,r.localeData()),formatFunctions[e]=formatFunctions[e]||makeFormatFunction(e),formatFunctions[e](r)):r.localeData().invalidDate()}function expandFormat(r,e){var t=5;function n(s){return e.longDateFormat(s)||s}for(localFormattingTokens.lastIndex=0;t>=0&&localFormattingTokens.test(r);)r=r.replace(localFormattingTokens,n),localFormattingTokens.lastIndex=0,t-=1;return r}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(r){var e=this._longDateFormat[r],t=this._longDateFormat[r.toUpperCase()];return e||!t?e:(this._longDateFormat[r]=t.match(formattingTokens).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[r])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(r){return this._ordinal.replace("%d",r)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(r,e,t,n){var s=this._relativeTime[t];return isFunction$3(s)?s(r,e,t,n):s.replace(/%d/i,r)}function pastFuture(r,e){var t=this._relativeTime[r>0?"future":"past"];return isFunction$3(t)?t(e):t.replace(/%s/i,e)}var aliases={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function normalizeUnits(r){return typeof r=="string"?aliases[r]||aliases[r.toLowerCase()]:void 0}function normalizeObjectUnits(r){var e={},t,n;for(n in r)hasOwnProp(r,n)&&(t=normalizeUnits(n),t&&(e[t]=r[n]));return e}var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function getPrioritizedUnits(r){var e=[],t;for(t in r)hasOwnProp(r,t)&&e.push({unit:t,priority:priorities[t]});return e.sort(function(n,s){return n.priority-s.priority}),e}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/,regexes;regexes={};function addRegexToken(r,e,t){regexes[r]=isFunction$3(e)?e:function(n,s){return n&&t?t:e}}function getParseRegexForToken(r,e){return hasOwnProp(regexes,r)?regexes[r](e._strict,e._locale):new RegExp(unescapeFormat(r))}function unescapeFormat(r){return regexEscape(r.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,o){return t||n||s||o}))}function regexEscape(r){return r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function absFloor(r){return r<0?Math.ceil(r)||0:Math.floor(r)}function toInt(r){var e=+r,t=0;return e!==0&&isFinite(e)&&(t=absFloor(e)),t}var tokens={};function addParseToken(r,e){var t,n=e,s;for(typeof r=="string"&&(r=[r]),isNumber$1(e)&&(n=function(o,a){a[e]=toInt(o)}),s=r.length,t=0;t<s;t++)tokens[r[t]]=n}function addWeekParseToken(r,e){addParseToken(r,function(t,n,s,o){s._w=s._w||{},e(t,s._w,s,o)})}function addTimeToArrayFromToken(r,e,t){e!=null&&hasOwnProp(tokens,r)&&tokens[r](e,t._a,t,r)}function isLeapYear$1(r){return r%4===0&&r%100!==0||r%400===0}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;addFormatToken("Y",0,0,function(){var r=this.year();return r<=9999?zeroFill(r,4):"+"+r});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,!0],0,"year");addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(r,e){e[YEAR]=r.length===2?hooks.parseTwoDigitYear(r):toInt(r)});addParseToken("YY",function(r,e){e[YEAR]=hooks.parseTwoDigitYear(r)});addParseToken("Y",function(r,e){e[YEAR]=parseInt(r,10)});function daysInYear(r){return isLeapYear$1(r)?366:365}hooks.parseTwoDigitYear=function(r){return toInt(r)+(toInt(r)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear$1(this.year())}function makeGetSet(r,e){return function(t){return t!=null?(set$1$1(this,r,t),hooks.updateOffset(this,e),this):get(this,r)}}function get(r,e){if(!r.isValid())return NaN;var t=r._d,n=r._isUTC;switch(e){case"Milliseconds":return n?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return n?t.getUTCSeconds():t.getSeconds();case"Minutes":return n?t.getUTCMinutes():t.getMinutes();case"Hours":return n?t.getUTCHours():t.getHours();case"Date":return n?t.getUTCDate():t.getDate();case"Day":return n?t.getUTCDay():t.getDay();case"Month":return n?t.getUTCMonth():t.getMonth();case"FullYear":return n?t.getUTCFullYear():t.getFullYear();default:return NaN}}function set$1$1(r,e,t){var n,s,o,a,l;if(!(!r.isValid()||isNaN(t))){switch(n=r._d,s=r._isUTC,e){case"Milliseconds":return void(s?n.setUTCMilliseconds(t):n.setMilliseconds(t));case"Seconds":return void(s?n.setUTCSeconds(t):n.setSeconds(t));case"Minutes":return void(s?n.setUTCMinutes(t):n.setMinutes(t));case"Hours":return void(s?n.setUTCHours(t):n.setHours(t));case"Date":return void(s?n.setUTCDate(t):n.setDate(t));case"FullYear":break;default:return}o=t,a=r.month(),l=r.date(),l=l===29&&a===1&&!isLeapYear$1(o)?28:l,s?n.setUTCFullYear(o,a,l):n.setFullYear(o,a,l)}}function stringGet(r){return r=normalizeUnits(r),isFunction$3(this[r])?this[r]():this}function stringSet(r,e){if(typeof r=="object"){r=normalizeObjectUnits(r);var t=getPrioritizedUnits(r),n,s=t.length;for(n=0;n<s;n++)this[t[n].unit](r[t[n].unit])}else if(r=normalizeUnits(r),isFunction$3(this[r]))return this[r](e);return this}function mod(r,e){return(r%e+e)%e}var indexOf$1;Array.prototype.indexOf?indexOf$1=Array.prototype.indexOf:indexOf$1=function(r){var e;for(e=0;e<this.length;++e)if(this[e]===r)return e;return-1};function daysInMonth(r,e){if(isNaN(r)||isNaN(e))return NaN;var t=mod(e,12);return r+=(e-t)/12,t===1?isLeapYear$1(r)?29:28:31-t%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(r){return this.localeData().monthsShort(this,r)});addFormatToken("MMMM",0,0,function(r){return this.localeData().months(this,r)});addRegexToken("M",match1to2,match1to2NoLeadingZero);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(r,e){return e.monthsShortRegex(r)});addRegexToken("MMMM",function(r,e){return e.monthsRegex(r)});addParseToken(["M","MM"],function(r,e){e[MONTH]=toInt(r)-1});addParseToken(["MMM","MMMM"],function(r,e,t,n){var s=t._locale.monthsParse(r,n,t._strict);s!=null?e[MONTH]=s:getParsingFlags(t).invalidMonth=r});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(r,e){return r?isArray$2(this._months)?this._months[r.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(e)?"format":"standalone"][r.month()]:isArray$2(this._months)?this._months:this._months.standalone}function localeMonthsShort(r,e){return r?isArray$2(this._monthsShort)?this._monthsShort[r.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(e)?"format":"standalone"][r.month()]:isArray$2(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(r,e,t){var n,s,o,a=r.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=createUTC([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return t?e==="MMM"?(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:null):(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:null):e==="MMM"?(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:null)):(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:null))}function localeMonthsParse(r,e,t){var n,s,o;if(this._monthsParseExact)return handleStrictParse.call(this,r,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=createUTC([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!t&&!this._monthsParse[n]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[n].test(r))return n;if(t&&e==="MMM"&&this._shortMonthsParse[n].test(r))return n;if(!t&&this._monthsParse[n].test(r))return n}}function setMonth(r,e){if(!r.isValid())return r;if(typeof e=="string"){if(/^\d+$/.test(e))e=toInt(e);else if(e=r.localeData().monthsParse(e),!isNumber$1(e))return r}var t=e,n=r.date();return n=n<29?n:Math.min(n,daysInMonth(r.year(),t)),r._isUTC?r._d.setUTCMonth(t,n):r._d.setMonth(t,n),r}function getSetMonth(r){return r!=null?(setMonth(this,r),hooks.updateOffset(this,!0),this):get(this,"Month")}function getDaysInMonth$1(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(r){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),r?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&r?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(r){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),r?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&r?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function r(u,c){return c.length-u.length}var e=[],t=[],n=[],s,o,a,l;for(s=0;s<12;s++)o=createUTC([2e3,s]),a=regexEscape(this.monthsShort(o,"")),l=regexEscape(this.months(o,"")),e.push(a),t.push(l),n.push(l),n.push(a);e.sort(r),t.sort(r),n.sort(r),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function createDate(r,e,t,n,s,o,a){var l;return r<100&&r>=0?(l=new Date(r+400,e,t,n,s,o,a),isFinite(l.getFullYear())&&l.setFullYear(r)):l=new Date(r,e,t,n,s,o,a),l}function createUTCDate(r){var e,t;return r<100&&r>=0?(t=Array.prototype.slice.call(arguments),t[0]=r+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(r)):e=new Date(Date.UTC.apply(null,arguments)),e}function firstWeekOffset(r,e,t){var n=7+e-t,s=(7+createUTCDate(r,0,n).getUTCDay()-e)%7;return-s+n-1}function dayOfYearFromWeeks(r,e,t,n,s){var o=(7+t-n)%7,a=firstWeekOffset(r,n,s),l=1+7*(e-1)+o+a,u,c;return l<=0?(u=r-1,c=daysInYear(u)+l):l>daysInYear(r)?(u=r+1,c=l-daysInYear(r)):(u=r,c=l),{year:u,dayOfYear:c}}function weekOfYear(r,e,t){var n=firstWeekOffset(r.year(),e,t),s=Math.floor((r.dayOfYear()-n-1)/7)+1,o,a;return s<1?(a=r.year()-1,o=s+weeksInYear(a,e,t)):s>weeksInYear(r.year(),e,t)?(o=s-weeksInYear(r.year(),e,t),a=r.year()+1):(a=r.year(),o=s),{week:o,year:a}}function weeksInYear(r,e,t){var n=firstWeekOffset(r,e,t),s=firstWeekOffset(r+1,e,t);return(daysInYear(r)-n+s)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addRegexToken("w",match1to2,match1to2NoLeadingZero);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2,match1to2NoLeadingZero);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(r,e,t,n){e[n.substr(0,1)]=toInt(r)});function localeWeek(r){return weekOfYear(r,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(r){var e=this.localeData().week(this);return r==null?e:this.add((r-e)*7,"d")}function getSetISOWeek(r){var e=weekOfYear(this,1,4).week;return r==null?e:this.add((r-e)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(r){return this.localeData().weekdaysMin(this,r)});addFormatToken("ddd",0,0,function(r){return this.localeData().weekdaysShort(this,r)});addFormatToken("dddd",0,0,function(r){return this.localeData().weekdays(this,r)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(r,e){return e.weekdaysMinRegex(r)});addRegexToken("ddd",function(r,e){return e.weekdaysShortRegex(r)});addRegexToken("dddd",function(r,e){return e.weekdaysRegex(r)});addWeekParseToken(["dd","ddd","dddd"],function(r,e,t,n){var s=t._locale.weekdaysParse(r,n,t._strict);s!=null?e.d=s:getParsingFlags(t).invalidWeekday=r});addWeekParseToken(["d","e","E"],function(r,e,t,n){e[n]=toInt(r)});function parseWeekday(r,e){return typeof r!="string"?r:isNaN(r)?(r=e.weekdaysParse(r),typeof r=="number"?r:null):parseInt(r,10)}function parseIsoWeekday(r,e){return typeof r=="string"?e.weekdaysParse(r)%7||7:isNaN(r)?null:r}function shiftWeekdays(r,e){return r.slice(e,7).concat(r.slice(0,e))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(r,e){var t=isArray$2(this._weekdays)?this._weekdays:this._weekdays[r&&r!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return r===!0?shiftWeekdays(t,this._week.dow):r?t[r.day()]:t}function localeWeekdaysShort(r){return r===!0?shiftWeekdays(this._weekdaysShort,this._week.dow):r?this._weekdaysShort[r.day()]:this._weekdaysShort}function localeWeekdaysMin(r){return r===!0?shiftWeekdays(this._weekdaysMin,this._week.dow):r?this._weekdaysMin[r.day()]:this._weekdaysMin}function handleStrictParse$1(r,e,t){var n,s,o,a=r.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=createUTC([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return t?e==="dddd"?(s=indexOf$1.call(this._weekdaysParse,a),s!==-1?s:null):e==="ddd"?(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1?s:null):(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null):e==="dddd"?(s=indexOf$1.call(this._weekdaysParse,a),s!==-1||(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null)):e==="ddd"?(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1||(s=indexOf$1.call(this._weekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null)):(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1||(s=indexOf$1.call(this._weekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1?s:null))}function localeWeekdaysParse(r,e,t){var n,s,o;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,r,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=createUTC([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[n].test(r))return n;if(t&&e==="ddd"&&this._shortWeekdaysParse[n].test(r))return n;if(t&&e==="dd"&&this._minWeekdaysParse[n].test(r))return n;if(!t&&this._weekdaysParse[n].test(r))return n}}function getSetDayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;var e=get(this,"Day");return r!=null?(r=parseWeekday(r,this.localeData()),this.add(r-e,"d")):e}function getSetLocaleDayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return r==null?e:this.add(r-e,"d")}function getSetISODayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;if(r!=null){var e=parseIsoWeekday(r,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function weekdaysRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&r?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function r(d,f){return f.length-d.length}var e=[],t=[],n=[],s=[],o,a,l,u,c;for(o=0;o<7;o++)a=createUTC([2e3,1]).day(o),l=regexEscape(this.weekdaysMin(a,"")),u=regexEscape(this.weekdaysShort(a,"")),c=regexEscape(this.weekdays(a,"")),e.push(l),t.push(u),n.push(c),s.push(l),s.push(u),s.push(c);e.sort(r),t.sort(r),n.sort(r),s.sort(r),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(r,e){addFormatToken(r,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}meridiem("a",!0);meridiem("A",!1);function matchMeridiem(r,e){return e._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2,match1to2HasZero);addRegexToken("h",match1to2,match1to2NoLeadingZero);addRegexToken("k",match1to2,match1to2NoLeadingZero);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(r,e,t){var n=toInt(r);e[HOUR]=n===24?0:n});addParseToken(["a","A"],function(r,e,t){t._isPm=t._locale.isPM(r),t._meridiem=r});addParseToken(["h","hh"],function(r,e,t){e[HOUR]=toInt(r),getParsingFlags(t).bigHour=!0});addParseToken("hmm",function(r,e,t){var n=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n)),getParsingFlags(t).bigHour=!0});addParseToken("hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n,2)),e[SECOND]=toInt(r.substr(s)),getParsingFlags(t).bigHour=!0});addParseToken("Hmm",function(r,e,t){var n=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n))});addParseToken("Hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n,2)),e[SECOND]=toInt(r.substr(s))});function localeIsPM(r){return(r+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(r,e,t){return r>11?t?"pm":"PM":t?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(r,e){var t,n=Math.min(r.length,e.length);for(t=0;t<n;t+=1)if(r[t]!==e[t])return t;return n}function normalizeLocale(r){return r&&r.toLowerCase().replace("_","-")}function chooseLocale(r){for(var e=0,t,n,s,o;e<r.length;){for(o=normalizeLocale(r[e]).split("-"),t=o.length,n=normalizeLocale(r[e+1]),n=n?n.split("-"):null;t>0;){if(s=loadLocale(o.slice(0,t).join("-")),s)return s;if(n&&n.length>=t&&commonPrefix(o,n)>=t-1)break;t--}e++}return globalLocale}function isLocaleNameSane(r){return!!(r&&r.match("^[^/\\\\]*$"))}function loadLocale(r){var e=null,t;if(locales[r]===void 0&&typeof module<"u"&&module&&module.exports&&isLocaleNameSane(r))try{e=globalLocale._abbr,t=require,t("./locale/"+r),getSetGlobalLocale(e)}catch{locales[r]=null}return locales[r]}function getSetGlobalLocale(r,e){var t;return r&&(isUndefined$2(e)?t=getLocale(r):t=defineLocale(r,e),t?globalLocale=t:typeof console<"u"&&console.warn&&console.warn("Locale "+r+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(r,e){if(e!==null){var t,n=baseConfig;if(e.abbr=r,locales[r]!=null)deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=locales[r]._config;else if(e.parentLocale!=null)if(locales[e.parentLocale]!=null)n=locales[e.parentLocale]._config;else if(t=loadLocale(e.parentLocale),t!=null)n=t._config;else return localeFamilies[e.parentLocale]||(localeFamilies[e.parentLocale]=[]),localeFamilies[e.parentLocale].push({name:r,config:e}),null;return locales[r]=new Locale(mergeConfigs(n,e)),localeFamilies[r]&&localeFamilies[r].forEach(function(s){defineLocale(s.name,s.config)}),getSetGlobalLocale(r),locales[r]}else return delete locales[r],null}function updateLocale(r,e){if(e!=null){var t,n,s=baseConfig;locales[r]!=null&&locales[r].parentLocale!=null?locales[r].set(mergeConfigs(locales[r]._config,e)):(n=loadLocale(r),n!=null&&(s=n._config),e=mergeConfigs(s,e),n==null&&(e.abbr=r),t=new Locale(e),t.parentLocale=locales[r],locales[r]=t),getSetGlobalLocale(r)}else locales[r]!=null&&(locales[r].parentLocale!=null?(locales[r]=locales[r].parentLocale,r===getSetGlobalLocale()&&getSetGlobalLocale(r)):locales[r]!=null&&delete locales[r]);return locales[r]}function getLocale(r){var e;if(r&&r._locale&&r._locale._abbr&&(r=r._locale._abbr),!r)return globalLocale;if(!isArray$2(r)){if(e=loadLocale(r),e)return e;r=[r]}return chooseLocale(r)}function listLocales(){return keys$2(locales)}function checkOverflow(r){var e,t=r._a;return t&&getParsingFlags(r).overflow===-2&&(e=t[MONTH]<0||t[MONTH]>11?MONTH:t[DATE]<1||t[DATE]>daysInMonth(t[YEAR],t[MONTH])?DATE:t[HOUR]<0||t[HOUR]>24||t[HOUR]===24&&(t[MINUTE]!==0||t[SECOND]!==0||t[MILLISECOND]!==0)?HOUR:t[MINUTE]<0||t[MINUTE]>59?MINUTE:t[SECOND]<0||t[SECOND]>59?SECOND:t[MILLISECOND]<0||t[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(r)._overflowDayOfYear&&(e<YEAR||e>DATE)&&(e=DATE),getParsingFlags(r)._overflowWeeks&&e===-1&&(e=WEEK),getParsingFlags(r)._overflowWeekday&&e===-1&&(e=WEEKDAY),getParsingFlags(r).overflow=e),r}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(r){var e,t,n=r._i,s=extendedIsoRegex.exec(n)||basicIsoRegex.exec(n),o,a,l,u,c=isoDates.length,d=isoTimes.length;if(s){for(getParsingFlags(r).iso=!0,e=0,t=c;e<t;e++)if(isoDates[e][1].exec(s[1])){a=isoDates[e][0],o=isoDates[e][2]!==!1;break}if(a==null){r._isValid=!1;return}if(s[3]){for(e=0,t=d;e<t;e++)if(isoTimes[e][1].exec(s[3])){l=(s[2]||" ")+isoTimes[e][0];break}if(l==null){r._isValid=!1;return}}if(!o&&l!=null){r._isValid=!1;return}if(s[4])if(tzRegex.exec(s[4]))u="Z";else{r._isValid=!1;return}r._f=a+(l||"")+(u||""),configFromStringAndFormat(r)}else r._isValid=!1}function extractFromRFC2822Strings(r,e,t,n,s,o){var a=[untruncateYear(r),defaultLocaleMonthsShort.indexOf(e),parseInt(t,10),parseInt(n,10),parseInt(s,10)];return o&&a.push(parseInt(o,10)),a}function untruncateYear(r){var e=parseInt(r,10);return e<=49?2e3+e:e<=999?1900+e:e}function preprocessRFC2822(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(r,e,t){if(r){var n=defaultLocaleWeekdaysShort.indexOf(r),s=new Date(e[0],e[1],e[2]).getDay();if(n!==s)return getParsingFlags(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function calculateOffset(r,e,t){if(r)return obsOffsets[r];if(e)return 0;var n=parseInt(t,10),s=n%100,o=(n-s)/100;return o*60+s}function configFromRFC2822(r){var e=rfc2822.exec(preprocessRFC2822(r._i)),t;if(e){if(t=extractFromRFC2822Strings(e[4],e[3],e[2],e[5],e[6],e[7]),!checkWeekday(e[1],t,r))return;r._a=t,r._tzm=calculateOffset(e[8],e[9],e[10]),r._d=createUTCDate.apply(null,r._a),r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),getParsingFlags(r).rfc2822=!0}else r._isValid=!1}function configFromString(r){var e=aspNetJsonRegex.exec(r._i);if(e!==null){r._d=new Date(+e[1]);return}if(configFromISO(r),r._isValid===!1)delete r._isValid;else return;if(configFromRFC2822(r),r._isValid===!1)delete r._isValid;else return;r._strict?r._isValid=!1:hooks.createFromInputFallback(r)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(r){r._d=new Date(r._i+(r._useUTC?" UTC":""))});function defaults$2(r,e,t){return r??e??t}function currentDateArray(r){var e=new Date(hooks.now());return r._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function configFromArray(r){var e,t,n=[],s,o,a;if(!r._d){for(s=currentDateArray(r),r._w&&r._a[DATE]==null&&r._a[MONTH]==null&&dayOfYearFromWeekInfo(r),r._dayOfYear!=null&&(a=defaults$2(r._a[YEAR],s[YEAR]),(r._dayOfYear>daysInYear(a)||r._dayOfYear===0)&&(getParsingFlags(r)._overflowDayOfYear=!0),t=createUTCDate(a,0,r._dayOfYear),r._a[MONTH]=t.getUTCMonth(),r._a[DATE]=t.getUTCDate()),e=0;e<3&&r._a[e]==null;++e)r._a[e]=n[e]=s[e];for(;e<7;e++)r._a[e]=n[e]=r._a[e]==null?e===2?1:0:r._a[e];r._a[HOUR]===24&&r._a[MINUTE]===0&&r._a[SECOND]===0&&r._a[MILLISECOND]===0&&(r._nextDay=!0,r._a[HOUR]=0),r._d=(r._useUTC?createUTCDate:createDate).apply(null,n),o=r._useUTC?r._d.getUTCDay():r._d.getDay(),r._tzm!=null&&r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),r._nextDay&&(r._a[HOUR]=24),r._w&&typeof r._w.d<"u"&&r._w.d!==o&&(getParsingFlags(r).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(r){var e,t,n,s,o,a,l,u,c;e=r._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,a=4,t=defaults$2(e.GG,r._a[YEAR],weekOfYear(createLocal(),1,4).year),n=defaults$2(e.W,1),s=defaults$2(e.E,1),(s<1||s>7)&&(u=!0)):(o=r._locale._week.dow,a=r._locale._week.doy,c=weekOfYear(createLocal(),o,a),t=defaults$2(e.gg,r._a[YEAR],c.year),n=defaults$2(e.w,c.week),e.d!=null?(s=e.d,(s<0||s>6)&&(u=!0)):e.e!=null?(s=e.e+o,(e.e<0||e.e>6)&&(u=!0)):s=o),n<1||n>weeksInYear(t,o,a)?getParsingFlags(r)._overflowWeeks=!0:u!=null?getParsingFlags(r)._overflowWeekday=!0:(l=dayOfYearFromWeeks(t,n,s,o,a),r._a[YEAR]=l.year,r._dayOfYear=l.dayOfYear)}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(r){if(r._f===hooks.ISO_8601){configFromISO(r);return}if(r._f===hooks.RFC_2822){configFromRFC2822(r);return}r._a=[],getParsingFlags(r).empty=!0;var e=""+r._i,t,n,s,o,a,l=e.length,u=0,c,d;for(s=expandFormat(r._f,r._locale).match(formattingTokens)||[],d=s.length,t=0;t<d;t++)o=s[t],n=(e.match(getParseRegexForToken(o,r))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&getParsingFlags(r).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),u+=n.length),formatTokenFunctions[o]?(n?getParsingFlags(r).empty=!1:getParsingFlags(r).unusedTokens.push(o),addTimeToArrayFromToken(o,n,r)):r._strict&&!n&&getParsingFlags(r).unusedTokens.push(o);getParsingFlags(r).charsLeftOver=l-u,e.length>0&&getParsingFlags(r).unusedInput.push(e),r._a[HOUR]<=12&&getParsingFlags(r).bigHour===!0&&r._a[HOUR]>0&&(getParsingFlags(r).bigHour=void 0),getParsingFlags(r).parsedDateParts=r._a.slice(0),getParsingFlags(r).meridiem=r._meridiem,r._a[HOUR]=meridiemFixWrap(r._locale,r._a[HOUR],r._meridiem),c=getParsingFlags(r).era,c!==null&&(r._a[YEAR]=r._locale.erasConvertYear(c,r._a[YEAR])),configFromArray(r),checkOverflow(r)}function meridiemFixWrap(r,e,t){var n;return t==null?e:r.meridiemHour!=null?r.meridiemHour(e,t):(r.isPM!=null&&(n=r.isPM(t),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function configFromStringAndArray(r){var e,t,n,s,o,a,l=!1,u=r._f.length;if(u===0){getParsingFlags(r).invalidFormat=!0,r._d=new Date(NaN);return}for(s=0;s<u;s++)o=0,a=!1,e=copyConfig({},r),r._useUTC!=null&&(e._useUTC=r._useUTC),e._f=r._f[s],configFromStringAndFormat(e),isValid(e)&&(a=!0),o+=getParsingFlags(e).charsLeftOver,o+=getParsingFlags(e).unusedTokens.length*10,getParsingFlags(e).score=o,l?o<n&&(n=o,t=e):(n==null||o<n||a)&&(n=o,t=e,a&&(l=!0));extend$2(r,t||e)}function configFromObject(r){if(!r._d){var e=normalizeObjectUnits(r._i),t=e.day===void 0?e.date:e.day;r._a=map$1([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),configFromArray(r)}}function createFromConfig(r){var e=new Moment(checkOverflow(prepareConfig(r)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function prepareConfig(r){var e=r._i,t=r._f;return r._locale=r._locale||getLocale(r._l),e===null||t===void 0&&e===""?createInvalid({nullInput:!0}):(typeof e=="string"&&(r._i=e=r._locale.preparse(e)),isMoment(e)?new Moment(checkOverflow(e)):(isDate$2(e)?r._d=e:isArray$2(t)?configFromStringAndArray(r):t?configFromStringAndFormat(r):configFromInput(r),isValid(r)||(r._d=null),r))}function configFromInput(r){var e=r._i;isUndefined$2(e)?r._d=new Date(hooks.now()):isDate$2(e)?r._d=new Date(e.valueOf()):typeof e=="string"?configFromString(r):isArray$2(e)?(r._a=map$1(e.slice(0),function(t){return parseInt(t,10)}),configFromArray(r)):isObject$2(e)?configFromObject(r):isNumber$1(e)?r._d=new Date(e):hooks.createFromInputFallback(r)}function createLocalOrUTC(r,e,t,n,s){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(t===!0||t===!1)&&(n=t,t=void 0),(isObject$2(r)&&isObjectEmpty(r)||isArray$2(r)&&r.length===0)&&(r=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=s,o._l=t,o._i=r,o._f=e,o._strict=n,createFromConfig(o)}function createLocal(r,e,t,n){return createLocalOrUTC(r,e,t,n,!1)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=createLocal.apply(null,arguments);return this.isValid()&&r.isValid()?r<this?this:r:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=createLocal.apply(null,arguments);return this.isValid()&&r.isValid()?r>this?this:r:createInvalid()});function pickBy(r,e){var t,n;if(e.length===1&&isArray$2(e[0])&&(e=e[0]),!e.length)return createLocal();for(t=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][r](t))&&(t=e[n]);return t}function min$1(){var r=[].slice.call(arguments,0);return pickBy("isBefore",r)}function max$1(){var r=[].slice.call(arguments,0);return pickBy("isAfter",r)}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(r){var e,t=!1,n,s=ordering.length;for(e in r)if(hasOwnProp(r,e)&&!(indexOf$1.call(ordering,e)!==-1&&(r[e]==null||!isNaN(r[e]))))return!1;for(n=0;n<s;++n)if(r[ordering[n]]){if(t)return!1;parseFloat(r[ordering[n]])!==toInt(r[ordering[n]])&&(t=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(r){var e=normalizeObjectUnits(r),t=e.year||0,n=e.quarter||0,s=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,l=e.hour||0,u=e.minute||0,c=e.second||0,d=e.millisecond||0;this._isValid=isDurationValid(e),this._milliseconds=+d+c*1e3+u*6e4+l*1e3*60*60,this._days=+a+o*7,this._months=+s+n*3+t*12,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(r){return r instanceof Duration}function absRound(r){return r<0?Math.round(-1*r)*-1:Math.round(r)}function compareArrays(r,e,t){var n=Math.min(r.length,e.length),s=Math.abs(r.length-e.length),o=0,a;for(a=0;a<n;a++)toInt(r[a])!==toInt(e[a])&&o++;return o+s}function offset$3(r,e){addFormatToken(r,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+zeroFill(~~(t/60),2)+e+zeroFill(~~t%60,2)})}offset$3("Z",":");offset$3("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(r,e,t){t._useUTC=!0,t._tzm=offsetFromString(matchShortOffset,r)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(r,e){var t=(e||"").match(r),n,s,o;return t===null?null:(n=t[t.length-1]||[],s=(n+"").match(chunkOffset)||["-",0,0],o=+(s[1]*60)+toInt(s[2]),o===0?0:s[0]==="+"?o:-o)}function cloneWithOffset(r,e){var t,n;return e._isUTC?(t=e.clone(),n=(isMoment(r)||isDate$2(r)?r.valueOf():createLocal(r).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),hooks.updateOffset(t,!1),t):createLocal(r).local()}function getDateOffset(r){return-Math.round(r._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(r,e,t){var n=this._offset||0,s;if(!this.isValid())return r!=null?this:NaN;if(r!=null){if(typeof r=="string"){if(r=offsetFromString(matchShortOffset,r),r===null)return this}else Math.abs(r)<16&&!t&&(r=r*60);return!this._isUTC&&e&&(s=getDateOffset(this)),this._offset=r,this._isUTC=!0,s!=null&&this.add(s,"m"),n!==r&&(!e||this._changeInProgress?addSubtract(this,createDuration(r-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:getDateOffset(this)}function getSetZone(r,e){return r!=null?(typeof r!="string"&&(r=-r),this.utcOffset(r,e),this):-this.utcOffset()}function setOffsetToUTC(r){return this.utcOffset(0,r)}function setOffsetToLocal(r){return this._isUTC&&(this.utcOffset(0,r),this._isUTC=!1,r&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var r=offsetFromString(matchOffset,this._i);r!=null?this.utcOffset(r):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(r){return this.isValid()?(r=r?createLocal(r).utcOffset():0,(this.utcOffset()-r)%60===0):!1}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$2(this._isDSTShifted))return this._isDSTShifted;var r={},e;return copyConfig(r,this),r=prepareConfig(r),r._a?(e=r._isUTC?createUTC(r._a):createLocal(r._a),this._isDSTShifted=this.isValid()&&compareArrays(r._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:!1}function isUtcOffset(){return this.isValid()?this._isUTC:!1}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(r,e){var t=r,n=null,s,o,a;return isDuration(r)?t={ms:r._milliseconds,d:r._days,M:r._months}:isNumber$1(r)||!isNaN(+r)?(t={},e?t[e]=+r:t.milliseconds=+r):(n=aspNetRegex.exec(r))?(s=n[1]==="-"?-1:1,t={y:0,d:toInt(n[DATE])*s,h:toInt(n[HOUR])*s,m:toInt(n[MINUTE])*s,s:toInt(n[SECOND])*s,ms:toInt(absRound(n[MILLISECOND]*1e3))*s}):(n=isoRegex.exec(r))?(s=n[1]==="-"?-1:1,t={y:parseIso(n[2],s),M:parseIso(n[3],s),w:parseIso(n[4],s),d:parseIso(n[5],s),h:parseIso(n[6],s),m:parseIso(n[7],s),s:parseIso(n[8],s)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(a=momentsDifference(createLocal(t.from),createLocal(t.to)),t={},t.ms=a.milliseconds,t.M=a.months),o=new Duration(t),isDuration(r)&&hasOwnProp(r,"_locale")&&(o._locale=r._locale),isDuration(r)&&hasOwnProp(r,"_isValid")&&(o._isValid=r._isValid),o}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(r,e){var t=r&&parseFloat(r.replace(",","."));return(isNaN(t)?0:t)*e}function positiveMomentsDifference(r,e){var t={};return t.months=e.month()-r.month()+(e.year()-r.year())*12,r.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+r.clone().add(t.months,"M"),t}function momentsDifference(r,e){var t;return r.isValid()&&e.isValid()?(e=cloneWithOffset(e,r),r.isBefore(e)?t=positiveMomentsDifference(r,e):(t=positiveMomentsDifference(e,r),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function createAdder(r,e){return function(t,n){var s,o;return n!==null&&!isNaN(+n)&&(deprecateSimple(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=t,t=n,n=o),s=createDuration(t,n),addSubtract(this,s,r),this}}function addSubtract(r,e,t,n){var s=e._milliseconds,o=absRound(e._days),a=absRound(e._months);r.isValid()&&(n=n??!0,a&&setMonth(r,get(r,"Month")+a*t),o&&set$1$1(r,"Date",get(r,"Date")+o*t),s&&r._d.setTime(r._d.valueOf()+s*t),n&&hooks.updateOffset(r,o||a))}var add$2=createAdder(1,"add"),subtract$1=createAdder(-1,"subtract");function isString$1(r){return typeof r=="string"||r instanceof String}function isMomentInput(r){return isMoment(r)||isDate$2(r)||isString$1(r)||isNumber$1(r)||isNumberOrStringArray(r)||isMomentInputObject(r)||r===null||r===void 0}function isMomentInputObject(r){var e=isObject$2(r)&&!isObjectEmpty(r),t=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,o,a=n.length;for(s=0;s<a;s+=1)o=n[s],t=t||hasOwnProp(r,o);return e&&t}function isNumberOrStringArray(r){var e=isArray$2(r),t=!1;return e&&(t=r.filter(function(n){return!isNumber$1(n)&&isString$1(r)}).length===0),e&&t}function isCalendarSpec(r){var e=isObject$2(r)&&!isObjectEmpty(r),t=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,o;for(s=0;s<n.length;s+=1)o=n[s],t=t||hasOwnProp(r,o);return e&&t}function getCalendarFormat(r,e){var t=r.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function calendar$1(r,e){arguments.length===1&&(arguments[0]?isMomentInput(arguments[0])?(r=arguments[0],e=void 0):isCalendarSpec(arguments[0])&&(e=arguments[0],r=void 0):(r=void 0,e=void 0));var t=r||createLocal(),n=cloneWithOffset(t,this).startOf("day"),s=hooks.calendarFormat(this,n)||"sameElse",o=e&&(isFunction$3(e[s])?e[s].call(this,t):e[s]);return this.format(o||this.localeData().calendar(s,this,createLocal(t)))}function clone$2(){return new Moment(this)}function isAfter(r,e){var t=isMoment(r)?r:createLocal(r);return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function isBefore(r,e){var t=isMoment(r)?r:createLocal(r);return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function isBetween(r,e,t,n){var s=isMoment(r)?r:createLocal(r),o=isMoment(e)?e:createLocal(e);return this.isValid()&&s.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(s,t):!this.isBefore(s,t))&&(n[1]===")"?this.isBefore(o,t):!this.isAfter(o,t))):!1}function isSame(r,e){var t=isMoment(r)?r:createLocal(r),n;return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(n=t.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function isSameOrAfter(r,e){return this.isSame(r,e)||this.isAfter(r,e)}function isSameOrBefore(r,e){return this.isSame(r,e)||this.isBefore(r,e)}function diff(r,e,t){var n,s,o;if(!this.isValid())return NaN;if(n=cloneWithOffset(r,this),!n.isValid())return NaN;switch(s=(n.utcOffset()-this.utcOffset())*6e4,e=normalizeUnits(e),e){case"year":o=monthDiff(this,n)/12;break;case"month":o=monthDiff(this,n);break;case"quarter":o=monthDiff(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-s)/864e5;break;case"week":o=(this-n-s)/6048e5;break;default:o=this-n}return t?o:absFloor(o)}function monthDiff(r,e){if(r.date()<e.date())return-monthDiff(e,r);var t=(e.year()-r.year())*12+(e.month()-r.month()),n=r.clone().add(t,"months"),s,o;return e-n<0?(s=r.clone().add(t-1,"months"),o=(e-n)/(n-s)):(s=r.clone().add(t+1,"months"),o=(e-n)/(s-n)),-(t+o)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(r){if(!this.isValid())return null;var e=r!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?formatMoment(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$3(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(t,"Z")):formatMoment(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var r="moment",e="",t,n,s,o;return this.isLocal()||(r=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+r+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(t+n+s+o)}function format$2(r){r||(r=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var e=formatMoment(this,r);return this.localeData().postformat(e)}function from(r,e){return this.isValid()&&(isMoment(r)&&r.isValid()||createLocal(r).isValid())?createDuration({to:this,from:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function fromNow(r){return this.from(createLocal(),r)}function to(r,e){return this.isValid()&&(isMoment(r)&&r.isValid()||createLocal(r).isValid())?createDuration({from:this,to:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function toNow(r){return this.to(createLocal(),r)}function locale(r){var e;return r===void 0?this._locale._abbr:(e=getLocale(r),e!=null&&(this._locale=e),this)}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(r){return r===void 0?this.localeData():this.locale(r)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(r,e){return(r%e+e)%e}function localStartOfDate(r,e,t){return r<100&&r>=0?new Date(r+400,e,t)-MS_PER_400_YEARS:new Date(r,e,t).valueOf()}function utcStartOfDate(r,e,t){return r<100&&r>=0?Date.UTC(r+400,e,t)-MS_PER_400_YEARS:Date.UTC(r,e,t)}function startOf(r){var e,t;if(r=normalizeUnits(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?utcStartOfDate:localStartOfDate,r){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":e=this._d.valueOf(),e-=mod$1(e,MS_PER_MINUTE);break;case"second":e=this._d.valueOf(),e-=mod$1(e,MS_PER_SECOND);break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function endOf(r){var e,t;if(r=normalizeUnits(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?utcStartOfDate:localStartOfDate,r){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=MS_PER_HOUR-mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":e=this._d.valueOf(),e+=MS_PER_MINUTE-mod$1(e,MS_PER_MINUTE)-1;break;case"second":e=this._d.valueOf(),e+=MS_PER_SECOND-mod$1(e,MS_PER_SECOND)-1;break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var r=this;return[r.year(),r.month(),r.date(),r.hour(),r.minute(),r.second(),r.millisecond()]}function toObject(){var r=this;return{years:r.year(),months:r.month(),date:r.date(),hours:r.hours(),minutes:r.minutes(),seconds:r.seconds(),milliseconds:r.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend$2({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(r,e,t,n){var s=t._locale.erasParse(r,n,t._strict);s?getParsingFlags(t).era=s:getParsingFlags(t).invalidEra=r});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(r,e,t,n){var s;t._locale._eraYearOrdinalRegex&&(s=r.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[YEAR]=t._locale.eraYearOrdinalParse(r,s):e[YEAR]=parseInt(r,10)});function localeEras(r,e){var t,n,s,o=this._eras||getLocale("en")._eras;for(t=0,n=o.length;t<n;++t){switch(typeof o[t].since){case"string":s=hooks(o[t].since).startOf("day"),o[t].since=s.valueOf();break}switch(typeof o[t].until){case"undefined":o[t].until=1/0;break;case"string":s=hooks(o[t].until).startOf("day").valueOf(),o[t].until=s.valueOf();break}}return o}function localeErasParse(r,e,t){var n,s,o=this.eras(),a,l,u;for(r=r.toUpperCase(),n=0,s=o.length;n<s;++n)if(a=o[n].name.toUpperCase(),l=o[n].abbr.toUpperCase(),u=o[n].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(l===r)return o[n];break;case"NNNN":if(a===r)return o[n];break;case"NNNNN":if(u===r)return o[n];break}else if([a,l,u].indexOf(r)>=0)return o[n]}function localeErasConvertYear(r,e){var t=r.since<=r.until?1:-1;return e===void 0?hooks(r.since).year():hooks(r.since).year()+(e-r.offset)*t}function getEraName(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].name;return""}function getEraNarrow(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].narrow;return""}function getEraAbbr(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].abbr;return""}function getEraYear(){var r,e,t,n,s=this.localeData().eras();for(r=0,e=s.length;r<e;++r)if(t=s[r].since<=s[r].until?1:-1,n=this.clone().startOf("day").valueOf(),s[r].since<=n&&n<=s[r].until||s[r].until<=n&&n<=s[r].since)return(this.year()-hooks(s[r].since).year())*t+s[r].offset;return this.year()}function erasNameRegex(r){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),r?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(r){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),r?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(r){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),r?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(r,e){return e.erasAbbrRegex(r)}function matchEraName(r,e){return e.erasNameRegex(r)}function matchEraNarrow(r,e){return e.erasNarrowRegex(r)}function matchEraYearOrdinal(r,e){return e._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var r=[],e=[],t=[],n=[],s,o,a,l,u,c=this.eras();for(s=0,o=c.length;s<o;++s)a=regexEscape(c[s].name),l=regexEscape(c[s].abbr),u=regexEscape(c[s].narrow),e.push(a),r.push(l),t.push(u),n.push(a),n.push(l),n.push(u);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(r,e){addFormatToken(0,[r,r.length],0,e)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(r,e,t,n){e[n.substr(0,2)]=toInt(r)});addWeekParseToken(["gg","GG"],function(r,e,t,n){e[n]=hooks.parseTwoDigitYear(r)});function getSetWeekYear(r){return getSetWeekYearHelper.call(this,r,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(r){return getSetWeekYearHelper.call(this,r,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var r=this.localeData()._week;return weeksInYear(this.year(),r.dow,r.doy)}function getWeeksInWeekYear(){var r=this.localeData()._week;return weeksInYear(this.weekYear(),r.dow,r.doy)}function getSetWeekYearHelper(r,e,t,n,s){var o;return r==null?weekOfYear(this,n,s).year:(o=weeksInYear(r,n,s),e>o&&(e=o),setWeekAll.call(this,r,e,t,n,s))}function setWeekAll(r,e,t,n,s){var o=dayOfYearFromWeeks(r,e,t,n,s),a=createUTCDate(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}addFormatToken("Q",0,"Qo","quarter");addRegexToken("Q",match1);addParseToken("Q",function(r,e){e[MONTH]=(toInt(r)-1)*3});function getSetQuarter(r){return r==null?Math.ceil((this.month()+1)/3):this.month((r-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addRegexToken("D",match1to2,match1to2NoLeadingZero);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(r,e){return r?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(r,e){e[DATE]=toInt(r.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(r,e,t){t._dayOfYear=toInt(r)});function getSetDayOfYear(r){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return r==null?e:this.add(r-e,"d")}addFormatToken("m",["mm",2],0,"minute");addRegexToken("m",match1to2,match1to2HasZero);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second");addRegexToken("s",match1to2,match1to2HasZero);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(r,e){e[MILLISECOND]=toInt(("0."+r)*1e3)}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add$2;proto.calendar=calendar$1;proto.clone=clone$2;proto.diff=diff;proto.endOf=endOf;proto.format=format$2;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract$1;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;typeof Symbol<"u"&&Symbol.for!=null&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth$1;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(r){return createLocal(r*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(r){return r}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set$1;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(r,e,t,n){var s=getLocale(),o=createUTC().set(n,e);return s[t](o,r)}function listMonthsImpl(r,e,t){if(isNumber$1(r)&&(e=r,r=void 0),r=r||"",e!=null)return get$1(r,e,t,"month");var n,s=[];for(n=0;n<12;n++)s[n]=get$1(r,n,t,"month");return s}function listWeekdaysImpl(r,e,t,n){typeof r=="boolean"?(isNumber$1(e)&&(t=e,e=void 0),e=e||""):(e=r,t=e,r=!1,isNumber$1(e)&&(t=e,e=void 0),e=e||"");var s=getLocale(),o=r?s._week.dow:0,a,l=[];if(t!=null)return get$1(e,(t+o)%7,n,"day");for(a=0;a<7;a++)l[a]=get$1(e,(a+o)%7,n,"day");return l}function listMonths(r,e){return listMonthsImpl(r,e,"months")}function listMonthsShort(r,e){return listMonthsImpl(r,e,"monthsShort")}function listWeekdays(r,e,t){return listWeekdaysImpl(r,e,t,"weekdays")}function listWeekdaysShort(r,e,t){return listWeekdaysImpl(r,e,t,"weekdaysShort")}function listWeekdaysMin(r,e,t){return listWeekdaysImpl(r,e,t,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(r){var e=r%10,t=toInt(r%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return r+t}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs$1(){var r=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),r.milliseconds=mathAbs(r.milliseconds),r.seconds=mathAbs(r.seconds),r.minutes=mathAbs(r.minutes),r.hours=mathAbs(r.hours),r.months=mathAbs(r.months),r.years=mathAbs(r.years),this}function addSubtract$1(r,e,t,n){var s=createDuration(e,t);return r._milliseconds+=n*s._milliseconds,r._days+=n*s._days,r._months+=n*s._months,r._bubble()}function add$1$1(r,e){return addSubtract$1(this,r,e,1)}function subtract$1$1(r,e){return addSubtract$1(this,r,e,-1)}function absCeil(r){return r<0?Math.floor(r):Math.ceil(r)}function bubble(){var r=this._milliseconds,e=this._days,t=this._months,n=this._data,s,o,a,l,u;return r>=0&&e>=0&&t>=0||r<=0&&e<=0&&t<=0||(r+=absCeil(monthsToDays(t)+e)*864e5,e=0,t=0),n.milliseconds=r%1e3,s=absFloor(r/1e3),n.seconds=s%60,o=absFloor(s/60),n.minutes=o%60,a=absFloor(o/60),n.hours=a%24,e+=absFloor(a/24),u=absFloor(daysToMonths(e)),t+=u,e-=absCeil(monthsToDays(u)),l=absFloor(t/12),t%=12,n.days=e,n.months=t,n.years=l,this}function daysToMonths(r){return r*4800/146097}function monthsToDays(r){return r*146097/4800}function as(r){if(!this.isValid())return NaN;var e,t,n=this._milliseconds;if(r=normalizeUnits(r),r==="month"||r==="quarter"||r==="year")switch(e=this._days+n/864e5,t=this._months+daysToMonths(e),r){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(monthsToDays(this._months)),r){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+r)}}function makeAs(r){return function(){return this.as(r)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y"),valueOf$1=asMilliseconds;function clone$1$1(){return createDuration(this)}function get$2(r){return r=normalizeUnits(r),this.isValid()?this[r+"s"]():NaN}function makeGetter(r){return function(){return this.isValid()?this._data[r]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round$1=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(r,e,t,n,s){return s.relativeTime(e||1,!!t,r,n)}function relativeTime$1(r,e,t,n){var s=createDuration(r).abs(),o=round$1(s.as("s")),a=round$1(s.as("m")),l=round$1(s.as("h")),u=round$1(s.as("d")),c=round$1(s.as("M")),d=round$1(s.as("w")),f=round$1(s.as("y")),C=o<=t.ss&&["s",o]||o<t.s&&["ss",o]||a<=1&&["m"]||a<t.m&&["mm",a]||l<=1&&["h"]||l<t.h&&["hh",l]||u<=1&&["d"]||u<t.d&&["dd",u];return t.w!=null&&(C=C||d<=1&&["w"]||d<t.w&&["ww",d]),C=C||c<=1&&["M"]||c<t.M&&["MM",c]||f<=1&&["y"]||["yy",f],C[2]=e,C[3]=+r>0,C[4]=n,substituteTimeAgo.apply(null,C)}function getSetRelativeTimeRounding(r){return r===void 0?round$1:typeof r=="function"?(round$1=r,!0):!1}function getSetRelativeTimeThreshold(r,e){return thresholds[r]===void 0?!1:e===void 0?thresholds[r]:(thresholds[r]=e,r==="s"&&(thresholds.ss=e-1),!0)}function humanize(r,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,n=thresholds,s,o;return typeof r=="object"&&(e=r,r=!1),typeof r=="boolean"&&(t=r),typeof e=="object"&&(n=Object.assign({},thresholds,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),s=this.localeData(),o=relativeTime$1(this,!t,n,s),t&&(o=s.pastFuture(+this,o)),s.postformat(o)}var abs$1$1=Math.abs;function sign(r){return(r>0)-(r<0)||+r}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var r=abs$1$1(this._milliseconds)/1e3,e=abs$1$1(this._days),t=abs$1$1(this._months),n,s,o,a,l=this.asSeconds(),u,c,d,f;return l?(n=absFloor(r/60),s=absFloor(n/60),r%=60,n%=60,o=absFloor(t/12),t%=12,a=r?r.toFixed(3).replace(/\.?0+$/,""):"",u=l<0?"-":"",c=sign(this._months)!==sign(l)?"-":"",d=sign(this._days)!==sign(l)?"-":"",f=sign(this._milliseconds)!==sign(l)?"-":"",u+"P"+(o?c+o+"Y":"")+(t?c+t+"M":"")+(e?d+e+"D":"")+(s||n||r?"T":"")+(s?f+s+"H":"")+(n?f+n+"M":"")+(r?f+a+"S":"")):"P0D"}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs$1;proto$2.add=add$1$1;proto$2.subtract=subtract$1$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(r,e,t){t._d=new Date(parseFloat(r)*1e3)});addParseToken("x",function(r,e,t){t._d=new Date(toInt(r))});//! moment.js
hooks.version="2.30.1";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min$1;hooks.max=max$1;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate$2;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var r=requireFunctionUncurryThis(),e=Set.prototype;return setHelpers={Set,add:r(e.add),has:r(e.has),remove:r(e.delete),proto:e},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var r=requireSetHelpers().has;return aSet=function(e){return r(e),e},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var r=requireFunctionCall();return iterateSimple=function(e,t,n){for(var s=n?e:e.iterator,o=e.next,a,l;!(a=r(o,s)).done;)if(l=t(a.value),l!==void 0)return l},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var r=requireFunctionUncurryThis(),e=requireIterateSimple(),t=requireSetHelpers(),n=t.Set,s=t.proto,o=r(s.forEach),a=r(s.keys),l=a(new n).next;return setIterate=function(u,c,d){return d?e({iterator:a(u),next:l},c):o(u,c)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var r=requireSetHelpers(),e=requireSetIterate(),t=r.Set,n=r.add;return setClone=function(s){var o=new t;return e(s,function(a){n(o,a)}),o},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var r=requireFunctionUncurryThisAccessor(),e=requireSetHelpers();return setSize=r(e.proto,"size","get")||function(t){return t.size},setSize}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var r=requireACallable(),e=requireAnObject(),t=requireFunctionCall(),n=requireToIntegerOrInfinity(),s=requireGetIteratorDirect(),o="Invalid size",a=RangeError,l=TypeError,u=Math.max,c=function(d,f){this.set=d,this.size=u(f,0),this.has=r(d.has),this.keys=r(d.keys)};return c.prototype={getIterator:function(){return s(e(t(this.keys,this.set)))},includes:function(d){return t(this.has,this.set,d)}},getSetRecord=function(d){e(d);var f=+d.size;if(f!==f)throw new l(o);var C=n(f);if(C<0)throw new a(o);return new c(d,C)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetClone(),n=requireSetSize(),s=requireGetSetRecord(),o=requireSetIterate(),a=requireIterateSimple(),l=e.has,u=e.remove;return setDifference=function(d){var f=r(this),C=s(d),m=t(f);return n(f)<=C.size?o(f,function(E){C.includes(E)&&u(m,E)}):a(C.getIterator(),function(E){l(f,E)&&u(m,E)}),m},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var r=requireGetBuiltIn(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},t=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(n,s){var o=r("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!s)return!0;try{return new o()[n](t(-1/0)),!1}catch{var a=new o;return a.add(1),a.add(2),s(a[n](t(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var r=require_export(),e=requireSetDifference(),t=requireSetMethodAcceptSetLike(),n=!t("difference",function(s){return s.size===0});return r({target:"Set",proto:!0,real:!0,forced:n},{difference:e}),es_set_difference_v2}requireEs_set_difference_v2();var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetSize(),n=requireGetSetRecord(),s=requireSetIterate(),o=requireIterateSimple(),a=e.Set,l=e.add,u=e.has;return setIntersection=function(d){var f=r(this),C=n(d),m=new a;return t(f)>C.size?o(C.getIterator(),function(E){u(f,E)&&l(m,E)}):s(f,function(E){C.includes(E)&&l(m,E)}),m},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var r=require_export(),e=requireFails(),t=requireSetIntersection(),n=requireSetMethodAcceptSetLike(),s=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return r({target:"Set",proto:!0,real:!0,forced:s},{intersection:t}),es_set_intersection_v2}requireEs_set_intersection_v2();var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var r=requireASet(),e=requireSetHelpers().has,t=requireSetSize(),n=requireGetSetRecord(),s=requireSetIterate(),o=requireIterateSimple(),a=requireIteratorClose();return setIsDisjointFrom=function(u){var c=r(this),d=n(u);if(t(c)<=d.size)return s(c,function(C){if(d.includes(C))return!1},!0)!==!1;var f=d.getIterator();return o(f,function(C){if(e(c,C))return a(f,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var r=require_export(),e=requireSetIsDisjointFrom(),t=requireSetMethodAcceptSetLike(),n=!t("isDisjointFrom",function(s){return!s});return r({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),es_set_isDisjointFrom_v2}requireEs_set_isDisjointFrom_v2();var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var r=requireASet(),e=requireSetSize(),t=requireSetIterate(),n=requireGetSetRecord();return setIsSubsetOf=function(o){var a=r(this),l=n(o);return e(a)>l.size?!1:t(a,function(u){if(!l.includes(u))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var r=require_export(),e=requireSetIsSubsetOf(),t=requireSetMethodAcceptSetLike(),n=!t("isSubsetOf",function(s){return s});return r({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),es_set_isSubsetOf_v2}requireEs_set_isSubsetOf_v2();var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var r=requireASet(),e=requireSetHelpers().has,t=requireSetSize(),n=requireGetSetRecord(),s=requireIterateSimple(),o=requireIteratorClose();return setIsSupersetOf=function(l){var u=r(this),c=n(l);if(t(u)<c.size)return!1;var d=c.getIterator();return s(d,function(f){if(!e(u,f))return o(d,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var r=require_export(),e=requireSetIsSupersetOf(),t=requireSetMethodAcceptSetLike(),n=!t("isSupersetOf",function(s){return!s});return r({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),es_set_isSupersetOf_v2}requireEs_set_isSupersetOf_v2();var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetClone(),n=requireGetSetRecord(),s=requireIterateSimple(),o=e.add,a=e.has,l=e.remove;return setSymmetricDifference=function(c){var d=r(this),f=n(c).getIterator(),C=t(d);return s(f,function(m){a(d,m)?l(C,m):o(C,m)}),C},setSymmetricDifference}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var r=require_export(),e=requireSetSymmetricDifference(),t=requireSetMethodAcceptSetLike();return r({target:"Set",proto:!0,real:!0,forced:!t("symmetricDifference")},{symmetricDifference:e}),es_set_symmetricDifference_v2}requireEs_set_symmetricDifference_v2();var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var r=requireASet(),e=requireSetHelpers().add,t=requireSetClone(),n=requireGetSetRecord(),s=requireIterateSimple();return setUnion=function(a){var l=r(this),u=n(a).getIterator(),c=t(l);return s(u,function(d){e(c,d)}),c},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var r=require_export(),e=requireSetUnion(),t=requireSetMethodAcceptSetLike();return r({target:"Set",proto:!0,real:!0,forced:!t("union")},{union:e}),es_set_union_v2}requireEs_set_union_v2();function to2dArray(r){const e=r.length;let t=0;for(;t<e;)r[t]=[r[t]],t+=1}function extendArray(r,e){const t=e.length;let n=0;for(;n<t;)r.push(e[n]),n+=1}function pivot(r){const e=[];if(!r||r.length===0||!r[0]||r[0].length===0)return e;const t=r.length,n=r[0].length;for(let s=0;s<t;s++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][s]=r[s][o];return e}function arrayReduce(r,e,t,n){let s=-1,o=r,a=t;Array.isArray(r)||(o=Array.from(r));const l=o.length;for(s+=1;s<l;)a=e(a,o[s],s,o),s+=1;return a}function arrayFilter(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,o=[];let a=-1;for(;t<s;){const l=n[t];e(l,t,n)&&(a+=1,o[a]=l),t+=1}return o}function arrayMap(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,o=[];let a=-1;for(;t<s;){const l=n[t];a+=1,o[a]=e(l,t,n),t+=1}return o}function arrayEach(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length;for(;t<s&&e(n[t],t,n)!==!1;)t+=1;return r}function arrayUnique(r){const e=[];return arrayEach(r,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function getDifferenceOfArrays(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const[n,...s]=[...e];let o=n;return arrayEach(s,a=>{o=o.filter(l=>!a.includes(l))}),o}function stringToArray(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return r.split(e)}function toSingleLine(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return arrayReduce(r,(o,a,l)=>{const u=a.replace(/\r?\n\s*/g,""),c=t[l]?t[l]:"";return o+u+c},"").trim()}function stringify$1(r){let e;switch(typeof r){case"string":case"number":e=`${r}`;break;case"object":e=r===null?"":r.toString();break;case"undefined":e="";break;default:e=r.toString();break}return e}function isDefined(r){return typeof r<"u"}function isUndefined$1(r){return typeof r>"u"}function isEmpty$1(r){return r===null||r===""||isUndefined$1(r)}function isRegExp$2(r){return Object.prototype.toString.call(r)==="[object RegExp]"}const _m="length",_hd$1=r=>parseInt(r,16),_pi$1=r=>parseInt(r,10),_ss$1=(r,e,t)=>r.substr(e,t),_cp$1=r=>r.codePointAt(0)-65,_norm=r=>`${r}`.replace(/\-/g,""),_extractTime=r=>_hd$1(_ss$1(_norm(r),_hd$1("12"),_cp$1("F")))/(_hd$1(_ss$1(_norm(r),_cp$1("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified$1=!1;const consoleMessages$1={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(r,e){const t=!isEmpty$1(r),n=typeof r=="string"&&r.toLowerCase()==="non-commercial-and-evaluation",s="15.0.0";let o,a="invalid",l="invalid";r=_norm(r||"");const u=_checkKeySchema(r);if(t||n||u)if(u){const c=hooks("16/12/2024","DD/MM/YYYY"),d=Math.floor(c.toDate().getTime()/864e5),f=_extractTime(r);o=hooks((f+1)*864e5,"x").format("MMMM DD, YYYY"),d>f?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(_ignored()&&(a="valid",l="valid"),!_notified$1&&a!=="valid"&&(consoleMessages$1[a]({keyValidityDate:o,hotVersion:s})&&console[a==="non_commercial"?"info":"warn"](consoleMessages$1[a]({keyValidityDate:o,hotVersion:s})),_notified$1=!0),l!=="valid"&&e.parentNode&&domMessages[l]({keyValidityDate:o,hotVersion:s})){const d=document.createElement("div");d.className="handsontable hot-display-license-info",d.innerHTML=domMessages[l]({keyValidityDate:o,hotVersion:s}),e.parentNode.insertBefore(d,e.nextSibling)}}function _checkKeySchema(r){let e=[][_m],t=e;if(r[_m]!==_cp$1("Z"))return!1;for(let n="",s="B<H4P+".split(""),o=_cp$1(s.shift());o;o=_cp$1(s.shift()||"A"))--o<""[_m]?t=t|(_pi$1(`${_pi$1(_hd$1(n)+(_hd$1(_ss$1(r,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_ss$1(r,o,o?s[_m]===1?9:8:6);return t===e}var es_json_stringify={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var r=requireFunctionUncurryThis();return arraySlice=r([].slice),arraySlice}var getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var r=requireFunctionUncurryThis(),e=requireIsArray(),t=requireIsCallable(),n=requireClassofRaw(),s=requireToString(),o=r([].push);return getJsonReplacerFunction=function(a){if(t(a))return a;if(e(a)){for(var l=a.length,u=[],c=0;c<l;c++){var d=a[c];typeof d=="string"?o(u,d):(typeof d=="number"||n(d)==="Number"||n(d)==="String")&&o(u,s(d))}var f=u.length,C=!0;return function(m,E){if(C)return C=!1,E;if(e(this))return E;for(var v=0;v<f;v++)if(u[v]===m)return E}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var r=require_export(),e=requireGetBuiltIn(),t=requireFunctionApply(),n=requireFunctionCall(),s=requireFunctionUncurryThis(),o=requireFails(),a=requireIsCallable(),l=requireIsSymbol(),u=requireArraySlice(),c=requireGetJsonReplacerFunction(),d=requireSymbolConstructorDetection(),f=String,C=e("JSON","stringify"),m=s(/./.exec),E=s("".charAt),v=s("".charCodeAt),_=s("".replace),T=s(1 .toString),R=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,N=/^[\uDC00-\uDFFF]$/,G=!d||o(function(){var ne=e("Symbol")("stringify detection");return C([ne])!=="[null]"||C({a:ne})!=="{}"||C(Object(ne))!=="{}"}),D=o(function(){return C("\uDF06\uD834")!=='"\\udf06\\ud834"'||C("\uDEAD")!=='"\\udead"'}),k=function(ne,Z){var ve=u(arguments),xe=c(Z);if(!(!a(xe)&&(ne===void 0||l(ne))))return ve[1]=function(de,Se){if(a(xe)&&(Se=n(xe,this,f(de),Se)),!l(Se))return Se},t(C,null,ve)},z=function(ne,Z,ve){var xe=E(ve,Z-1),de=E(ve,Z+1);return m(O,ne)&&!m(N,de)||m(N,ne)&&!m(O,xe)?"\\u"+T(v(ne,0),16):ne};return C&&r({target:"JSON",stat:!0,arity:3,forced:G||D},{stringify:function(Z,ve,xe){var de=u(arguments),Se=t(G?k:C,null,de);return D&&typeof Se=="string"?_(Se,R,z):Se}}),es_json_stringify}requireEs_json_stringify();var esnext_iterator_forEach={},es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{forEach:function(a){n(this),t(a);var l=s(this),u=0;e(l,function(c){a(c,u++)},{IS_RECORD:!0})}}),es_iterator_forEach}var hasRequiredEsnext_iterator_forEach;function requireEsnext_iterator_forEach(){return hasRequiredEsnext_iterator_forEach||(hasRequiredEsnext_iterator_forEach=1,requireEs_iterator_forEach()),esnext_iterator_forEach}requireEsnext_iterator_forEach();function duckSchema(r){let e;return Array.isArray(r)?e=r.length?new Array(r.length).fill(null):[]:(e={},objectEach(r,(t,n)=>{n!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[n]=duckSchema(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[n]=[duckSchema(t[0])]:e[n]=[]:e[n]=null)})),e}function inherit(r,e){return e.prototype.constructor=e,r.prototype=new e,r.prototype.constructor=r,r}function extend$1(r,e,t){const n=Array.isArray(t);return objectEach(e,(s,o)=>{(n===!1||t.includes(o))&&(r[o]=s)}),r}function deepExtend(r,e){objectEach(e,(t,n)=>{e[n]&&typeof e[n]=="object"?(r[n]||(Array.isArray(e[n])?r[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?r[n]=e[n]:r[n]={}),deepExtend(r[n],e[n])):r[n]=e[n]})}function deepClone(r){return typeof r=="object"?JSON.parse(JSON.stringify(r)):r}function clone$1(r){const e={};return objectEach(r,(t,n)=>{e[n]=t}),e}function mixin(r){r.MIXINS||(r.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return arrayEach(t,s=>{r.MIXINS.push(s.MIXIN_NAME),objectEach(s,(o,a)=>{if(r.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof o=="function")r.prototype[a]=o;else{const l=function(d,f){const C=`_${d}`,m=E=>{let v=E;return(Array.isArray(v)||isObject$1(v))&&(v=deepClone(v)),v};return function(){return this[C]===void 0&&(this[C]=m(f)),this[C]}},u=function(d){const f=`_${d}`;return function(C){this[f]=C}};Object.defineProperty(r.prototype,a,{get:l(a,o),set:u(a),configurable:!0})}})}),r}function isObjectEqual(r,e){return JSON.stringify(r)===JSON.stringify(e)}function isObject$1(r){return Object.prototype.toString.call(r)==="[object Object]"}function defineGetter(r,e,t,n){n.value=t,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(r,e,n)}function objectEach(r,e){for(const t in r)if((!r.hasOwnProperty||r.hasOwnProperty&&Object.prototype.hasOwnProperty.call(r,t))&&e(r[t],t,r)===!1)break;return r}function getProperty(r,e){const t=e.split(".");let n=r;return objectEach(t,s=>{if(n=n[s],n===void 0)return n=void 0,!1}),n}function setProperty(r,e,t){const n=e.split(".");let s=r;n.forEach((o,a)=>{a!==n.length-1?(hasOwnProperty(s,o)||(s[o]={}),s=s[o]):s[o]=t})}function deepObjectSize(r){if(!isObject$1(r))return 0;const e=function(t){let n=0;return isObject$1(t)?objectEach(t,(s,o)=>{o!=="__children"&&(n+=e(s))}):n+=1,n};return e(r)}function createObjectPropListener(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,n={_touched:!1,[t]:r,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[t]},set(s){this._touched=!0,this[t]=s},enumerable:!0,configurable:!0}),n}function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}const MIXIN_NAME$6="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(r,e){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,e),this._hooksStorage[r].push(e),this},removeHooksByKey(r){arrayEach(this._hooksStorage[r]||[],e=>{this.hot.removeHook(r,e)})},clearHooks(){objectEach(this._hooksStorage,(r,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply:apply$1,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply$1||(apply$1=function(e,t,n){return e.apply(t,n)});construct||(construct=function(e,t){return new e(...t)});const arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return apply$1(r,e,n)}}function unconstruct(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return construct(r,t)}}function addToSet(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const o=t(s);o!==s&&(isFrozen(e)||(e[n]=o),s=o)}r[s]=!0}return r}function cleanArray(r){for(let e=0;e<r.length;e++)objectHasOwnProperty(r,e)||(r[e]=null);return r}function clone(r){const e=create(null);for(const[t,n]of entries(r))objectHasOwnProperty(r,t)&&(Array.isArray(n)?e[t]=cleanArray(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=clone(n):e[t]=n);return e}function lookupGetter(r,e){for(;r!==null;){const n=getOwnPropertyDescriptor(r,e);if(n){if(n.get)return unapply(n.get);if(typeof n.value=="function")return unapply(n.value)}r=getPrototypeOf(r)}function t(){return null}return t}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*}/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},_createHooksMap=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=gt=>createDOMPurify(gt);if(e.version="3.2.3",e.removed=[],!r||!r.document||r.document.nodeType!==NODE_TYPE.document)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:l,Element:u,NodeFilter:c,NamedNodeMap:d=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:f,DOMParser:C,trustedTypes:m}=r,E=u.prototype,v=lookupGetter(E,"cloneNode"),_=lookupGetter(E,"remove"),T=lookupGetter(E,"nextSibling"),R=lookupGetter(E,"childNodes"),O=lookupGetter(E,"parentNode");if(typeof a=="function"){const gt=t.createElement("template");gt.content&&gt.content.ownerDocument&&(t=gt.content.ownerDocument)}let N,G="";const{implementation:D,createNodeIterator:k,createDocumentFragment:z,getElementsByTagName:ne}=t,{importNode:Z}=n;let ve=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof O=="function"&&D&&D.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:xe,ERB_EXPR:de,TMPLIT_EXPR:Se,DATA_ATTR:Me,ARIA_ATTR:Pe,IS_SCRIPT_OR_DATA:_e,ATTR_WHITESPACE:Oe,CUSTOM_ELEMENT:st}=EXPRESSIONS;let{IS_ALLOWED_URI:rt}=EXPRESSIONS,U=null;const te=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let V=null;const ue=addToSet({},[...html,...svg,...mathMl,...xml]);let Ne=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ge=null,Ue=null,Ie=!0,Ke=!0,le=!1,ge=!0,we=!1,qe=!0,$e=!1,ze=!1,it=!1,Ve=!1,Qe=!1,nt=!1,Ze=!0,at=!1;const St="user-content-";let bt=!0,q=!1,X={},F=null;const b=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ce=null;const Fe=addToSet({},["audio","video","img","source","image","track"]);let Le=null;const ae=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),re="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",he="http://www.w3.org/1999/xhtml";let Ae=he,je=!1,ke=null;const et=addToSet({},[re,me,he],stringToString);let pt=addToSet({},["mi","mo","mn","ms","mtext"]),A=addToSet({},["annotation-xml"]);const K=addToSet({},["title","style","font","a","script"]);let L=null;const j=["application/xhtml+xml","text/html"],Y="text/html";let oe=null,Te=null;const ee=t.createElement("form"),ye=function(De){return De instanceof RegExp||De instanceof Function},H=function(){let De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Te&&Te===De)){if((!De||typeof De!="object")&&(De={}),De=clone(De),L=j.indexOf(De.PARSER_MEDIA_TYPE)===-1?Y:De.PARSER_MEDIA_TYPE,oe=L==="application/xhtml+xml"?stringToString:stringToLowerCase,U=objectHasOwnProperty(De,"ALLOWED_TAGS")?addToSet({},De.ALLOWED_TAGS,oe):te,V=objectHasOwnProperty(De,"ALLOWED_ATTR")?addToSet({},De.ALLOWED_ATTR,oe):ue,ke=objectHasOwnProperty(De,"ALLOWED_NAMESPACES")?addToSet({},De.ALLOWED_NAMESPACES,stringToString):et,Le=objectHasOwnProperty(De,"ADD_URI_SAFE_ATTR")?addToSet(clone(ae),De.ADD_URI_SAFE_ATTR,oe):ae,ce=objectHasOwnProperty(De,"ADD_DATA_URI_TAGS")?addToSet(clone(Fe),De.ADD_DATA_URI_TAGS,oe):Fe,F=objectHasOwnProperty(De,"FORBID_CONTENTS")?addToSet({},De.FORBID_CONTENTS,oe):b,Ge=objectHasOwnProperty(De,"FORBID_TAGS")?addToSet({},De.FORBID_TAGS,oe):{},Ue=objectHasOwnProperty(De,"FORBID_ATTR")?addToSet({},De.FORBID_ATTR,oe):{},X=objectHasOwnProperty(De,"USE_PROFILES")?De.USE_PROFILES:!1,Ie=De.ALLOW_ARIA_ATTR!==!1,Ke=De.ALLOW_DATA_ATTR!==!1,le=De.ALLOW_UNKNOWN_PROTOCOLS||!1,ge=De.ALLOW_SELF_CLOSE_IN_ATTR!==!1,we=De.SAFE_FOR_TEMPLATES||!1,qe=De.SAFE_FOR_XML!==!1,$e=De.WHOLE_DOCUMENT||!1,Ve=De.RETURN_DOM||!1,Qe=De.RETURN_DOM_FRAGMENT||!1,nt=De.RETURN_TRUSTED_TYPE||!1,it=De.FORCE_BODY||!1,Ze=De.SANITIZE_DOM!==!1,at=De.SANITIZE_NAMED_PROPS||!1,bt=De.KEEP_CONTENT!==!1,q=De.IN_PLACE||!1,rt=De.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,Ae=De.NAMESPACE||he,pt=De.MATHML_TEXT_INTEGRATION_POINTS||pt,A=De.HTML_INTEGRATION_POINTS||A,Ne=De.CUSTOM_ELEMENT_HANDLING||{},De.CUSTOM_ELEMENT_HANDLING&&ye(De.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ne.tagNameCheck=De.CUSTOM_ELEMENT_HANDLING.tagNameCheck),De.CUSTOM_ELEMENT_HANDLING&&ye(De.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ne.attributeNameCheck=De.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),De.CUSTOM_ELEMENT_HANDLING&&typeof De.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ne.allowCustomizedBuiltInElements=De.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),we&&(Ke=!1),Qe&&(Ve=!0),X&&(U=addToSet({},text),V=[],X.html===!0&&(addToSet(U,html$1),addToSet(V,html)),X.svg===!0&&(addToSet(U,svg$1),addToSet(V,svg),addToSet(V,xml)),X.svgFilters===!0&&(addToSet(U,svgFilters),addToSet(V,svg),addToSet(V,xml)),X.mathMl===!0&&(addToSet(U,mathMl$1),addToSet(V,mathMl),addToSet(V,xml))),De.ADD_TAGS&&(U===te&&(U=clone(U)),addToSet(U,De.ADD_TAGS,oe)),De.ADD_ATTR&&(V===ue&&(V=clone(V)),addToSet(V,De.ADD_ATTR,oe)),De.ADD_URI_SAFE_ATTR&&addToSet(Le,De.ADD_URI_SAFE_ATTR,oe),De.FORBID_CONTENTS&&(F===b&&(F=clone(F)),addToSet(F,De.FORBID_CONTENTS,oe)),bt&&(U["#text"]=!0),$e&&addToSet(U,["html","head","body"]),U.table&&(addToSet(U,["tbody"]),delete Ge.tbody),De.TRUSTED_TYPES_POLICY){if(typeof De.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof De.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');N=De.TRUSTED_TYPES_POLICY,G=N.createHTML("")}else N===void 0&&(N=_createTrustedTypesPolicy(m,s)),N!==null&&typeof G=="string"&&(G=N.createHTML(""));freeze&&freeze(De),Te=De}},Q=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),pe=addToSet({},[...mathMl$1,...mathMlDisallowed]),Re=function(De){let ht=O(De);(!ht||!ht.tagName)&&(ht={namespaceURI:Ae,tagName:"template"});const Rt=stringToLowerCase(De.tagName),Pt=stringToLowerCase(ht.tagName);return ke[De.namespaceURI]?De.namespaceURI===me?ht.namespaceURI===he?Rt==="svg":ht.namespaceURI===re?Rt==="svg"&&(Pt==="annotation-xml"||pt[Pt]):!!Q[Rt]:De.namespaceURI===re?ht.namespaceURI===he?Rt==="math":ht.namespaceURI===me?Rt==="math"&&A[Pt]:!!pe[Rt]:De.namespaceURI===he?ht.namespaceURI===me&&!A[Pt]||ht.namespaceURI===re&&!pt[Pt]?!1:!pe[Rt]&&(K[Rt]||!Q[Rt]):!!(L==="application/xhtml+xml"&&ke[De.namespaceURI]):!1},Ce=function(De){arrayPush(e.removed,{element:De});try{O(De).removeChild(De)}catch{_(De)}},We=function(De,ht){try{arrayPush(e.removed,{attribute:ht.getAttributeNode(De),from:ht})}catch{arrayPush(e.removed,{attribute:null,from:ht})}if(ht.removeAttribute(De),De==="is")if(Ve||Qe)try{Ce(ht)}catch{}else try{ht.setAttribute(De,"")}catch{}},ot=function(De){let ht=null,Rt=null;if(it)De="<remove></remove>"+De;else{const Nt=stringMatch(De,/^[\r\n\t ]+/);Rt=Nt&&Nt[0]}L==="application/xhtml+xml"&&Ae===he&&(De='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+De+"</body></html>");const Pt=N?N.createHTML(De):De;if(Ae===he)try{ht=new C().parseFromString(Pt,L)}catch{}if(!ht||!ht.documentElement){ht=D.createDocument(Ae,"template",null);try{ht.documentElement.innerHTML=je?G:Pt}catch{}}const Vt=ht.body||ht.documentElement;return De&&Rt&&Vt.insertBefore(t.createTextNode(Rt),Vt.childNodes[0]||null),Ae===he?ne.call(ht,$e?"html":"body")[0]:$e?ht.documentElement:Vt},mt=function(De){return k.call(De.ownerDocument||De,De,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Ye=function(De){return De instanceof f&&(typeof De.nodeName!="string"||typeof De.textContent!="string"||typeof De.removeChild!="function"||!(De.attributes instanceof d)||typeof De.removeAttribute!="function"||typeof De.setAttribute!="function"||typeof De.namespaceURI!="string"||typeof De.insertBefore!="function"||typeof De.hasChildNodes!="function")},Et=function(De){return typeof l=="function"&&De instanceof l};function vt(gt,De,ht){arrayForEach(gt,Rt=>{Rt.call(e,De,ht,Te)})}const xt=function(De){let ht=null;if(vt(ve.beforeSanitizeElements,De,null),Ye(De))return Ce(De),!0;const Rt=oe(De.nodeName);if(vt(ve.uponSanitizeElement,De,{tagName:Rt,allowedTags:U}),De.hasChildNodes()&&!Et(De.firstElementChild)&&regExpTest(/<[/\w]/g,De.innerHTML)&&regExpTest(/<[/\w]/g,De.textContent)||De.nodeType===NODE_TYPE.progressingInstruction||qe&&De.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,De.data))return Ce(De),!0;if(!U[Rt]||Ge[Rt]){if(!Ge[Rt]&&ft(Rt)&&(Ne.tagNameCheck instanceof RegExp&&regExpTest(Ne.tagNameCheck,Rt)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(Rt)))return!1;if(bt&&!F[Rt]){const Pt=O(De)||De.parentNode,Vt=R(De)||De.childNodes;if(Vt&&Pt){const Nt=Vt.length;for(let ur=Nt-1;ur>=0;--ur){const pr=v(Vt[ur],!0);pr.__removalCount=(De.__removalCount||0)+1,Pt.insertBefore(pr,T(De))}}}return Ce(De),!0}return De instanceof u&&!Re(De)||(Rt==="noscript"||Rt==="noembed"||Rt==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,De.innerHTML)?(Ce(De),!0):(we&&De.nodeType===NODE_TYPE.text&&(ht=De.textContent,arrayForEach([xe,de,Se],Pt=>{ht=stringReplace(ht,Pt," ")}),De.textContent!==ht&&(arrayPush(e.removed,{element:De.cloneNode()}),De.textContent=ht)),vt(ve.afterSanitizeElements,De,null),!1)},He=function(De,ht,Rt){if(Ze&&(ht==="id"||ht==="name")&&(Rt in t||Rt in ee))return!1;if(!(Ke&&!Ue[ht]&&regExpTest(Me,ht))){if(!(Ie&&regExpTest(Pe,ht))){if(!V[ht]||Ue[ht]){if(!(ft(De)&&(Ne.tagNameCheck instanceof RegExp&&regExpTest(Ne.tagNameCheck,De)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(De))&&(Ne.attributeNameCheck instanceof RegExp&&regExpTest(Ne.attributeNameCheck,ht)||Ne.attributeNameCheck instanceof Function&&Ne.attributeNameCheck(ht))||ht==="is"&&Ne.allowCustomizedBuiltInElements&&(Ne.tagNameCheck instanceof RegExp&&regExpTest(Ne.tagNameCheck,Rt)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(Rt))))return!1}else if(!Le[ht]){if(!regExpTest(rt,stringReplace(Rt,Oe,""))){if(!((ht==="src"||ht==="xlink:href"||ht==="href")&&De!=="script"&&stringIndexOf(Rt,"data:")===0&&ce[De])){if(!(le&&!regExpTest(_e,stringReplace(Rt,Oe,"")))){if(Rt)return!1}}}}}}return!0},ft=function(De){return De!=="annotation-xml"&&stringMatch(De,st)},yt=function(De){vt(ve.beforeSanitizeAttributes,De,null);const{attributes:ht}=De;if(!ht||Ye(De))return;const Rt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V,forceKeepAttr:void 0};let Pt=ht.length;for(;Pt--;){const Vt=ht[Pt],{name:Nt,namespaceURI:ur,value:pr}=Vt,cr=oe(Nt);let Qt=Nt==="value"?pr:stringTrim(pr);if(Rt.attrName=cr,Rt.attrValue=Qt,Rt.keepAttr=!0,Rt.forceKeepAttr=void 0,vt(ve.uponSanitizeAttribute,De,Rt),Qt=Rt.attrValue,at&&(cr==="id"||cr==="name")&&(We(Nt,De),Qt=St+Qt),qe&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Qt)){We(Nt,De);continue}if(Rt.forceKeepAttr||(We(Nt,De),!Rt.keepAttr))continue;if(!ge&&regExpTest(/\/>/i,Qt)){We(Nt,De);continue}we&&arrayForEach([xe,de,Se],Gn=>{Qt=stringReplace(Qt,Gn," ")});const di=oe(De.nodeName);if(He(di,cr,Qt)){if(N&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!ur)switch(m.getAttributeType(di,cr)){case"TrustedHTML":{Qt=N.createHTML(Qt);break}case"TrustedScriptURL":{Qt=N.createScriptURL(Qt);break}}try{ur?De.setAttributeNS(ur,Nt,Qt):De.setAttribute(Nt,Qt),Ye(De)?Ce(De):arrayPop(e.removed)}catch{}}}vt(ve.afterSanitizeAttributes,De,null)},It=function gt(De){let ht=null;const Rt=mt(De);for(vt(ve.beforeSanitizeShadowDOM,De,null);ht=Rt.nextNode();)vt(ve.uponSanitizeShadowNode,ht,null),xt(ht),yt(ht),ht.content instanceof o&&gt(ht.content);vt(ve.afterSanitizeShadowDOM,De,null)};return e.sanitize=function(gt){let De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ht=null,Rt=null,Pt=null,Vt=null;if(je=!gt,je&&(gt="<!-->"),typeof gt!="string"&&!Et(gt))if(typeof gt.toString=="function"){if(gt=gt.toString(),typeof gt!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return gt;if(ze||H(De),e.removed=[],typeof gt=="string"&&(q=!1),q){if(gt.nodeName){const pr=oe(gt.nodeName);if(!U[pr]||Ge[pr])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(gt instanceof l)ht=ot("<!---->"),Rt=ht.ownerDocument.importNode(gt,!0),Rt.nodeType===NODE_TYPE.element&&Rt.nodeName==="BODY"||Rt.nodeName==="HTML"?ht=Rt:ht.appendChild(Rt);else{if(!Ve&&!we&&!$e&&gt.indexOf("<")===-1)return N&&nt?N.createHTML(gt):gt;if(ht=ot(gt),!ht)return Ve?null:nt?G:""}ht&&it&&Ce(ht.firstChild);const Nt=mt(q?gt:ht);for(;Pt=Nt.nextNode();)xt(Pt),yt(Pt),Pt.content instanceof o&&It(Pt.content);if(q)return gt;if(Ve){if(Qe)for(Vt=z.call(ht.ownerDocument);ht.firstChild;)Vt.appendChild(ht.firstChild);else Vt=ht;return(V.shadowroot||V.shadowrootmode)&&(Vt=Z.call(n,Vt,!0)),Vt}let ur=$e?ht.outerHTML:ht.innerHTML;return $e&&U["!doctype"]&&ht.ownerDocument&&ht.ownerDocument.doctype&&ht.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,ht.ownerDocument.doctype.name)&&(ur="<!DOCTYPE "+ht.ownerDocument.doctype.name+`>
`+ur),we&&arrayForEach([xe,de,Se],pr=>{ur=stringReplace(ur,pr," ")}),N&&nt?N.createHTML(ur):ur},e.setConfig=function(){let gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};H(gt),ze=!0},e.clearConfig=function(){Te=null,ze=!1},e.isValidAttribute=function(gt,De,ht){Te||H({});const Rt=oe(gt),Pt=oe(De);return He(Rt,Pt,ht)},e.addHook=function(gt,De){typeof De=="function"&&arrayPush(ve[gt],De)},e.removeHook=function(gt){return arrayPop(ve[gt])},e.removeHooks=function(gt){ve[gt]=[]},e.removeAllHooks=function(){ve=_createHooksMap()},e}var purify=createDOMPurify();function toUpperCaseFirst(r){return r[0].toUpperCase()+r.substr(1)}function randomString(){function r(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return r()+r()+r()+r()}function isPercentValue(r){return/^([0-9][0-9]?%$)|(^100%$)/.test(r)}function substitute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${r}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,n)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[n]===void 0?"":e[n])}function stripTags(r){return sanitize(`${r}`,{ALLOWED_TAGS:[]})}function sanitize(r,e){return purify.sanitize(r,e)}const A11Y_TABINDEX=r=>["tabindex",r],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=r=>["aria-label",r],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=r=>["aria-haspopup",r],A11Y_ROWCOUNT=r=>["aria-rowcount",r],A11Y_COLCOUNT=r=>["aria-colcount",r],A11Y_ROWINDEX=r=>["aria-rowindex",r],A11Y_COLINDEX=r=>["aria-colindex",r],A11Y_EXPANDED=r=>["aria-expanded",r],A11Y_SORT=r=>["aria-sort",r],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=r=>["aria-checked",r],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=r=>["aria-controls",r],A11Y_ACTIVEDESCENDANT=r=>["aria-activedescendant",r],A11Y_LIVE=r=>["aria-live",r],A11Y_RELEVANT=r=>["aria-relevant",r],A11Y_SETSIZE=r=>["aria-setsize",r],A11Y_POSINSET=r=>["aria-posinset",r];function getParent(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,n=null,s=r;for(;s!==null;){if(t===e){n=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(t+=1,s=s.parentNode)}return n}function isThisHotChild(r,e){const t=r.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function getFrameElement(r){return Object.getPrototypeOf(r.parent)&&r.frameElement}function getParentWindow(r){return getFrameElement(r)&&r.parent}function closest(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:s}=Node;let o=r;for(;o!=null&&o!==t;){const{nodeType:a,nodeName:l}=o;if(a===n&&(e.includes(l)||e.includes(o)))return o;const{host:u}=o;u&&a===s?o=u:o=o.parentNode}return null}function closestDown(r,e,t){const n=[];let s=r;for(;s&&(s=closest(s,e,t),!(!s||t&&!t.contains(s)));)n.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const o=n.length;return o?n[o-1]:null}function findFirstParentWithClass(r,e){const t={element:void 0,classNames:[]};let n=r;for(;n!==null&&n!==r.ownerDocument.documentElement&&!t.element;){if(typeof e=="string"&&n.classList.contains(e))t.element=n,t.classNames.push(e);else if(e instanceof RegExp){const s=Array.from(n.classList).filter(o=>e.test(o));s.length&&(t.element=n,t.classNames.push(...s))}n=n.parentElement}return t}function isChildOf(r,e){let t=r.parentNode,n=[];for(typeof e=="string"?r.defaultView?n=Array.prototype.slice.call(r.querySelectorAll(e),0):n=Array.prototype.slice.call(r.ownerDocument.querySelectorAll(e),0):n.push(e);t!==null;){if(n.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function index$1(r){let e=0,t=r;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function overlayContainsElement(r,e,t){const n=t.parentElement.querySelector(`.ht_clone_${r}`);return n?n.contains(e):null}function filterEmptyClassNames(r){return!r||!r.length?[]:r.filter(e=>!!e)}function filterRegexes(r,e){if(!r||!r.length)return{regexFree:[],regexes:[]};const t=[],n=[];return n.push(...r.filter(s=>{const o=s instanceof RegExp;return o&&e&&t.push(s),!o})),{regexFree:n,regexes:t}}function hasClass$1(r,e){return r.classList===void 0||typeof e!="string"||e===""?!1:r.classList.contains(e)}function addClass$1(r,e){typeof e=="string"&&(e=e.split(" ")),e=filterEmptyClassNames(e),e.length>0&&r.classList.add(...e)}function removeClass$1(r,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:n}=filterRegexes(e,!0);t=filterEmptyClassNames(t),t.length>0&&r.classList.remove(...t),n.forEach(s=>{r.classList.forEach(o=>{s.test(o)&&r.classList.remove(o)})})}function setAttribute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&r.setAttribute(...n)})}function removeAttribute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:n}=filterRegexes(e,!0);t.forEach(s=>{s!==""&&r.removeAttribute(s)}),n.forEach(s=>{r.getAttributeNames().forEach(o=>{s.test(o)&&r.removeAttribute(o)})})}function removeTextNodes(r){if(r.nodeType===3)r.parentNode.removeChild(r);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(r.nodeName)>-1){const e=r.childNodes;for(let t=e.length-1;t>=0;t--)removeTextNodes(e[t])}}function empty$2(r){let e;for(;e=r.lastChild;)r.removeChild(e)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(e)?r.innerHTML=t?sanitize(e):e:fastInnerText(r,e)}function fastInnerText(r,e){const t=r.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(empty$2(r),r.appendChild(r.ownerDocument.createTextNode(e)))}function isVisible(r){const e=r.ownerDocument.documentElement,t=r.ownerDocument.defaultView;let n=r;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return isVisible(n.host.impl);if(n.host)return isVisible(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function offset$2(r){const e=r.ownerDocument,t=e.defaultView,n=e.documentElement;let s=r,o,a,l;for(o=s.offsetLeft,a=s.offsetTop,l=s;(s=s.offsetParent)&&!(s===e.body||!("offsetLeft"in s));)o+=s.offsetLeft,a+=s.offsetTop,l=s;return l&&l.style.position==="fixed"&&(o+=t.pageXOffset||n.scrollLeft,a+=t.pageYOffset||n.scrollTop),{left:o,top:a}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?getWindowScrollTop(e):r.scrollTop}function getScrollLeft(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?getWindowScrollLeft(e):r.scrollLeft}function getScrollableElement(r){let e=r.ownerDocument,t=e?e.defaultView:void 0;e||(e=r.document?r.document:r,t=e.defaultView);const n=["auto","scroll"];let s=r.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:o,overflowX:a,overflowY:l}=s.style;if([o,a,l].includes("scroll"))return s;if({overflow:o,overflowX:a,overflowY:l}=t.getComputedStyle(s),n.includes(o)||n.includes(a)||n.includes(l)||s.clientHeight<=s.scrollHeight+1&&(n.includes(l)||n.includes(o))||s.clientWidth<=s.scrollWidth+1&&(n.includes(a)||n.includes(o)))return s;s=s.parentNode}return t}function getMaximumScrollTop(r){return r.scrollHeight-r.clientHeight}function getMaximumScrollLeft(r){return r.scrollWidth-r.clientWidth}function getTrimmingContainer(r){const e=r.ownerDocument,t=e.defaultView;let n=r.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const s=t.getComputedStyle(n),o=["scroll","hidden","auto"],a=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(l)||o.includes(u))return n;n=n.parentNode}return t}function getStyle(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(r){if(r===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const n=r.style[e];if(n!==""&&n!==void 0)return n;const s=t.getComputedStyle(r);if(s[e]!==""&&s[e]!==void 0)return s[e]}function outerWidth(r){return r.offsetWidth}function outerHeight(r){return r.offsetHeight}function innerHeight$1(r){return r.clientHeight||r.innerHeight}function innerWidth(r){return r.clientWidth||r.innerWidth}function getCaretPosition(r){return r.selectionStart?r.selectionStart:0}function getSelectionEndPosition(r){return r.selectionEnd?r.selectionEnd:0}function clearTextSelection(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;r.getSelection&&(r.getSelection().empty?r.getSelection().empty():r.getSelection().removeAllRanges&&r.getSelection().removeAllRanges())}function setCaretPosition(r,e,t){if(t===void 0&&(t=e),r.setSelectionRange){r.focus();try{r.setSelectionRange(e,t)}catch{const s=r.parentNode,o=s.style.display;s.style.display="block",r.setSelectionRange(e,t),s.style.display=o}}}let cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=r.createElement("div");e.style.height="200px",e.style.width="100%";const t=r.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(r.body||r.documentElement).appendChild(t);const n=e.offsetWidth;t.style.overflow="scroll";let s=e.offsetWidth;return n===s&&(s=t.clientWidth),(r.body||r.documentElement).removeChild(t),n-s}function getScrollbarWidth(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(r)),cachedScrollbarWidth}function hasVerticalScrollbar(r){return r.offsetWidth!==r.clientWidth}function hasHorizontalScrollbar(r){return r.offsetHeight!==r.clientHeight}function setOverlayPosition(r,e,t){r.style.transform=`translate3d(${e},${t},0)`}function resetCssTransform(r){r.style.transform&&r.style.transform!==""&&(r.style.transform="")}function isInput(r){return r&&(["INPUT","SELECT","TEXTAREA"].indexOf(r.nodeName)>-1||r.contentEditable==="true")}function isOutsideInput(r){return isInput(r)&&r.hasAttribute("data-hot-input")===!1}function isDetached(r){return!r.parentNode}function observeVisibilityChangeOnce(r,e){new IntersectionObserver((n,s)=>{n.forEach(o=>{o.isIntersecting&&r.offsetParent!==null&&(e(),s.unobserve(r))})},{root:r.ownerDocument.body}).observe(r)}function makeElementContentEditableAndSelectItsContent(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=r.ownerDocument,s=n.createRange(),o=n.defaultView.getSelection();setAttribute(r,"contenteditable",!0),t&&setAttribute(r,...A11Y_HIDDEN()),e&&addClass$1(r,"invisibleSelection"),s.selectNodeContents(r),o.removeAllRanges(),o.addRange(s)}function removeContentEditableFromElementAndDeselect(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=r.ownerDocument.defaultView.getSelection();r.hasAttribute("aria-hidden")&&r.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&removeClass$1(r,"invisibleSelection"),r.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(r,t),e(),removeContentEditableFromElementAndDeselect(r,t)}function _defineProperty$1X(r,e,t){return(e=_toPropertyKey$1X(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1X(r){var e=_toPrimitive$1X(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1X(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$a="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$a}constructor(e){_defineProperty$1X(this,"hot",void 0),_defineProperty$1X(this,"state",EDITOR_STATE.VIRGIN),_defineProperty$1X(this,"_opened",!1),_defineProperty$1X(this,"_fullEditMode",!1),_defineProperty$1X(this,"_closeCallback",null),_defineProperty$1X(this,"TD",null),_defineProperty$1X(this,"row",null),_defineProperty$1X(this,"col",null),_defineProperty$1X(this,"prop",null),_defineProperty$1X(this,"originalValue",null),_defineProperty$1X(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,s,o,a){this.TD=s,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,s,o,a;if(t){const u=this.hot.getSelectedLast();n=Math.max(Math.min(u[0],u[2]),0),s=Math.max(Math.min(u[1],u[3]),0),o=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[n,s,o,a]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",n,s,!1,"meta");Array.isArray(l)&&([n,s]=l),this.hot.populateFromArray(n,s,e,o,a,"edit")}beginEditing(e,t){if(this.state!==EDITOR_STATE.VIRGIN)return;const n=this.hot,s=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const u=typeof e=="string"?e:stringify$1(this.originalValue);this.setValue(u)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),n.view.scrollViewport(n._createCellCoords(s,o))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,t,n){let s;if(n){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),n(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:s=[[o]],this.state=EDITOR_STATE.WAITING,this.saveValue(s,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(a)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(e){this.state===EDITOR_STATE.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:s}=this.hot.view._wt,o=this.hot.rootWindow,a=offset$2(t),l=outerWidth(t),u=offset$2(this.hot.rootElement),c=outerWidth(this.hot.rootElement),d=n.topOverlay.holder,f=n.inlineStartOverlay.holder,C=d!==o?d.scrollTop:0,m=f!==o?f.scrollLeft:0,E=o.innerWidth-u.left-c,{wtTable:v}=(e=n.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,_=v.name,T=["master","inline_start"].includes(_)?C:0,R=["master","top","bottom"].includes(_)?m:0,O=a.top===u.top?0:1;let N=a.top-u.top-O-T,G=0;this.hot.isRtl()?G=o.innerWidth-a.left-l-E-1+R:G=a.left-u.left-1-R,["top","top_inline_start_corner"].includes(_)&&(N+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(G+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const D=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(D&&k<=0||k===Z)&&(N+=1),z<=0&&(G+=1);const ve=s.rowsRenderCalculator.startPosition,xe=s.columnsRenderCalculator.startPosition,de=Math.abs(n.inlineStartOverlay.getScrollPosition()),Se=n.topOverlay.getScrollPosition(),Me=getScrollbarWidth(this.hot.rootDocument);let Pe=t.offsetTop;if(["inline_start","master"].includes(_)&&(Pe+=ve-Se),["bottom","bottom_inline_start_corner"].includes(_)){const{wtViewport:Ie,wtTable:Ke}=n.bottomOverlay.clone;Pe+=Ie.getWorkspaceHeight()-Ke.getHeight()-Me}let _e=t.offsetLeft;this.hot.isRtl()?(_e>=0?_e=v.getWidth()-t.offsetLeft:_e=Math.abs(_e),_e+=xe-de-l):["top","master","bottom"].includes(_)&&(_e+=xe-de);const Oe=o.getComputedStyle(this.TD),st=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",rt=parseInt(Oe[st],10)>0?0:1,U=parseInt(Oe.borderTopWidth,10)>0?0:1,te=outerWidth(t)+rt,V=outerHeight(t)+U,ue=hasVerticalScrollbar(d)?Me:0,Ne=hasHorizontalScrollbar(f)?Me:0,Ge=this.hot.view.maximumVisibleElementWidth(_e)-ue+rt,Ue=Math.max(this.hot.view.maximumVisibleElementHeight(Pe)-Ne+U,this.hot.view.getDefaultRowHeight());return{top:N,start:G,height:V,maxHeight:Ue,width:te,maxWidth:Ge}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}mixin(BaseEditor,hooksRefRegisterer);function stopImmediatePropagation(r){r.isImmediatePropagationEnabled=!1,r.cancelBubble=!0}function isImmediatePropagationStopped(r){return r.isImmediatePropagationEnabled===!1}function isRightClick(r){return r.button===2}function isLeftClick(r){return r.button===0}function isTouchEvent(r){return r instanceof TouchEvent}function offsetRelativeTo(r,e){const t={x:r.offsetX,y:r.offsetY};let n=r.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return t;for(;n!==e;)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;return t}function _defineProperty$1W(r,e,t){return(e=_toPropertyKey$1W(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1W(r){var e=_toPrimitive$1W(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1W(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class EventManager{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1W(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){n.call(this,extendEvent(a))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:o,options:s,eventManager:this}),e.addEventListener(t,o,s),()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===t&&a.element===e){if(n&&n!==a.callback||s&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,s=e;n||(n=e.ownerDocument?e.ownerDocument:e,s=n.defaultView);const o={bubbles:!0,cancelable:t!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):a=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}}function extendEvent(r){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=function(){e.apply(this),stopImmediatePropagation(this)},r}function requestAnimationFrame$1(r){return window.requestAnimationFrame(r)}function cancelAnimationFrame$1(r){window.cancelAnimationFrame(r)}function isTouchSupported(){return"ontouchstart"in window}function isCSR$1(){return typeof window<"u"}let comparisonFunction;function getComparisonFunction(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(r,e).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(t,n)=>`${t}`.localeCompare(n):comparisonFunction=(t,n)=>t===n?0:t>n?-1:1,comparisonFunction)}const tester=r=>{const e={value:!1};return e.test=(t,n)=>{e.value=r(t,n)},e},browsers={chrome:tester((r,e)=>/Chrome/.test(r)&&/Google/.test(e)),chromeWebKit:tester(r=>/CriOS/.test(r)),edge:tester(r=>/Edge/.test(r)),edgeWebKit:tester(r=>/EdgiOS/.test(r)),firefox:tester(r=>/Firefox/.test(r)),firefoxWebKit:tester(r=>/FxiOS/.test(r)),mobile:tester(r=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)),safari:tester((r,e)=>/Safari/.test(r)&&/Apple Computer/.test(e))},platforms={mac:tester(r=>/^Mac/.test(r)),win:tester(r=>/^Win/.test(r)),linux:tester(r=>/^Linux/.test(r)),ios:tester(r=>/iPhone|iPad|iPod/i.test(r))};function setBrowserMeta(){let{userAgent:r=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,t=>{let{test:n}=t;return void n(r,e)})}function setPlatformMeta(){let{platform:r=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,e=>{let{test:t}=e;return void t(r)})}isCSR$1()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return r>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS$1(){return platforms.mac.value}var esnext_iterator_map={},es_iterator_map={},iteratorMap,hasRequiredIteratorMap;function requireIteratorMap(){if(hasRequiredIteratorMap)return iteratorMap;hasRequiredIteratorMap=1;var r=requireFunctionCall(),e=requireACallable(),t=requireAnObject(),n=requireGetIteratorDirect(),s=requireIteratorCreateProxy(),o=requireCallWithSafeIterationClosing(),a=s(function(){var l=this.iterator,u=t(r(this.next,l)),c=this.done=!!u.done;if(!c)return o(l,this.mapper,[u.value,this.counter++],!0)});return iteratorMap=function(u){return t(this),e(u),new a(n(this),{mapper:u})},iteratorMap}var hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var r=require_export(),e=requireIteratorMap(),t=requireIsPure();return r({target:"Iterator",proto:!0,real:!0,forced:t},{map:e}),es_iterator_map}var hasRequiredEsnext_iterator_map;function requireEsnext_iterator_map(){return hasRequiredEsnext_iterator_map||(hasRequiredEsnext_iterator_map=1,requireEs_iterator_map()),esnext_iterator_map}requireEsnext_iterator_map();function isNumeric(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof r;if(t==="number")return!isNaN(r)&&isFinite(r);if(t==="string"){if(r.length===0)return!1;if(r.length===1)return/\d/.test(r);const n=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(r.trim())}else if(t==="object")return!!r&&typeof r.valueOf()=="number"&&!(r instanceof Date);return!1}function isNumericLike(r){return isNumeric(r,[","])}function rangeEach(r,e,t){let n=-1;for(typeof e=="function"?(t=e,e=r):n=r-1;++n<=e&&t(n)!==!1;);}function rangeEachReverse(r,e,t){let n=r+1;for(typeof e=="function"&&(t=e,e=0);--n>=e&&t(n)!==!1;);}function valueAccordingPercent(r,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(r*e/100,10)}function clamp(r,e,t){return Math.min(r,e)===r?e:Math.max(r,t)===r?t:r}function observe(r,e,t){r.addEventListener(e,t,!1)}function unObserve(r,e,t){r.removeEventListener(e,t,!1)}function getComputedStyle$2(r){return r.ownerDocument.defaultView.getComputedStyle(r)}function createInputElementResizer(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:f=>f.value,...e},n=r.body,s=r.createTextNode(""),o=r.createElement("span");let a;function l(){var f,C;s.textContent=t.textContent(a),o.style.position="absolute",o.style.fontSize=getComputedStyle$2(a).fontSize,o.style.fontFamily=getComputedStyle$2(a).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const m=parseInt(((f=getComputedStyle$2(a))===null||f===void 0?void 0:f.paddingInlineStart)||0,10),E=parseInt(((C=getComputedStyle$2(a))===null||C===void 0?void 0:C.paddingInlineEnd)||0,10),v=o.clientWidth+2+m+E;n.removeChild(o);const _=a.style;_.height=`${t.minHeight}px`,t.minWidth>v?_.width=`${t.minWidth}px`:v>t.maxWidth?_.width=`${t.maxWidth}px`:_.width=`${v}px`;const T=a.scrollHeight?a.scrollHeight-1:0;t.minHeight>T?_.height=`${t.minHeight}px`:t.maxHeight<T?(_.height=`${t.maxHeight}px`,_.overflowY="visible"):_.height=`${T}px`}function u(){r.defaultView.setTimeout(l,0)}function c(f){if(f&&f.minHeight)if(f.minHeight==="inherit")t.minHeight=a.clientHeight;else{const C=parseInt(f.minHeight,10);isNaN(C)||(t.minHeight=C)}if(f&&f.maxHeight)if(f.maxHeight==="inherit")t.maxHeight=a.clientHeight;else{const C=parseInt(f.maxHeight,10);isNaN(C)||(t.maxHeight=C)}if(f&&f.minWidth)if(f.minWidth==="inherit")t.minWidth=a.clientWidth;else{const C=parseInt(f.minWidth,10);isNaN(C)||(t.minWidth=C)}if(f&&f.maxWidth)if(f.maxWidth==="inherit")t.maxWidth=a.clientWidth;else{const C=parseInt(f.maxWidth,10);isNaN(C)||(t.maxWidth=C)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(s))}function d(f,C){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=f,c(C),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${t.minHeight}px`,a.style.minWidth=`${t.minWidth}px`,a.style.maxWidth=`${t.maxWidth}px`,a.style.overflowY="hidden"),m&&(observe(a,"input",l),observe(a,"keydown",u)),l()}return{init:d,resize:l,unObserve(){unObserve(a,"input",l),unObserve(a,"keydown",u)}}}function updateCaretPosition(r,e){const t=getCaretPosition(e),n=e.value.split(`
`);let s=t,o=0;for(let a=0;a<n.length;a++){const l=n[a];a!==0&&(o+=n[a-1].length+1);const u=o+l.length;if(r==="home"?s=o:r==="end"&&(s=u),t<=u)break}setCaretPosition(e,s)}function _defineProperty$1V(r,e,t){return(e=_toPropertyKey$1V(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1V(r){var e=_toPrimitive$1V(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1V(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$f="textEditor",EDITOR_TYPE$9="text";class TextEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$9}constructor(e){super(e),_defineProperty$1V(this,"eventManager",new EventManager(this)),_defineProperty$1V(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty$1V(this,"TEXTAREA",void 0),_defineProperty$1V(this,"textareaStyle",void 0),_defineProperty$1V(this,"TEXTAREA_PARENT",void 0),_defineProperty$1V(this,"textareaParentStyle",void 0),_defineProperty$1V(this,"layerClass",void 0),this.eventManager=new EventManager(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),isThisHotChild(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,s,o,a){const l=this.state;if(super.prepare(e,t,n,s,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),l!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass$1(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass$1(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass$1(this.TEXTAREA_PARENT,this.layerClass)&&removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;rangeEach(e.length-1,n=>{const s=e[n];if(hasClass$1(s,"handsontableEditor"))return t=!0,!1}),hasClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),t?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass$1(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass$1(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:n,width:s,maxWidth:o,height:a,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const u=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(s,o),minHeight:Math.min(a,l),maxWidth:o,maxHeight:l},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP$f},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(s(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[l]=a;updateCaretPosition(l,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[l]=a;updateCaretPosition(l,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$f)}}const GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor",command$F={name:"editorCloseAndSave",callback(r){r._getEditorManager().closeEditorAndSaveChanges()}},command$E={name:"editorCloseAndSaveByArrowKeys",callback(r,e,t){const n=r._getEditorManager(),s=n.getActiveEditor();s.isInFullEditMode()&&s.state===EDITOR_STATE.EDITING||(n.closeEditorAndSaveChanges(),r.getSelected()&&(t.includes("arrowdown")?r.selection.transformStart(1,0):t.includes("arrowup")?r.selection.transformStart(-1,0):t.includes("arrowleft")?r.selection.transformStart(0,-1*r.getDirectionFactor()):t.includes("arrowright")&&r.selection.transformStart(0,r.getDirectionFactor())),e.preventDefault())}},command$D={name:"editorCloseAndSaveByEnter",callback(r,e){const t=r._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},command$C={name:"editorCloseWithoutSaving",callback(r){const e=r._getEditorManager();e.closeEditorAndRestoreOriginalValue(r.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},command$B={name:"editorFastOpen",callback(r,e){const{highlight:t}=r.getSelectedRangeLast();t.isHeader()||r._getEditorManager().openEditor(null,e,!0)}},command$A={name:"editorOpen",callback(r,e,t){const n=r._getEditorManager(),s=r.getSelectedRangeLast(),{highlight:o}=s;if(r.selection.isMultiple()&&!s.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0){const a=r.getSettings(),l=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;t.includes("shift")?r.selection.transformFocus(-l.row,-l.col):r.selection.transformFocus(l.row,l.col);return}o.isHeader()||(r.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),stopImmediatePropagation(e))}};function getAllCommands$2(){return[command$F,command$E,command$D,command$C,command$B,command$A]}const command$z={name:"extendCellsSelectionDown",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(1,0)}},command$y={name:"extendCellsSelectionDownByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.min(e.row+r.countVisibleRows(),r.countRows()-1),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(n!==null){const s=r._createCellCoords(n,e.col),o=e.row-r.getFirstFullyVisibleRow(),a=Math.min(s.row-o,r.countRows()-1);r.selection.setRangeEnd(s),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}},command$x={name:"extendCellsSelectionLeft",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,-1*r.getDirectionFactor())}},command$w={name:"extendCellsSelectionRight",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,r.getDirectionFactor())}},command$v={name:"extendCellsSelectionToColumns",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByRowHeader()?r.selection.selectAll(!0,!0):r.selectColumns(t.col,n.col,e)}},command$u={name:"extendCellsSelectionToMostBottom",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(r.countRows()-1,-1),u=s.clone();u.row=n.row,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(l,o.col))}}},command$t={name:"extendCellsSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const a=t.getNearestNotHiddenIndex(r.countCols()-1,-1),l=s.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(o.row,a))}}},command$s={name:"extendCellsSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const a=parseInt(r.getSettings().fixedColumnsStart,10),l=t.getNearestNotHiddenIndex(a,1),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$r={name:"extendCellsSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$q={name:"extendCellsSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$p={name:"extendCellsSelectionToMostTop",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(0,1),u=s.clone();u.row=n.row,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(l,o.col))}}},command$o={name:"extendCellsSelectionToRows",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByColumnHeader()?r.selection.selectAll(!0,!0):r.selectRows(t.row,n.row,e)}},command$n={name:"extendCellsSelectionUp",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(-1,0)}},command$m={name:"extendCellsSelectionUpByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.max(e.row-r.countVisibleRows(),0),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(n!==null){const s=r._createCellCoords(n,e.col),o=e.row-r.getFirstFullyVisibleRow(),a=Math.max(s.row-o,0);r.selection.setRangeEnd(s),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands$1(){return[command$z,command$y,command$x,command$w,command$v,command$u,command$t,command$s,command$r,command$q,command$p,command$o,command$n,command$m]}const command$l={name:"moveCellSelectionDown",callback(r){let{selection:e}=r;e.transformStart(1,0)}},command$k={name:"moveCellSelectionDownByViewportHeight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=r.countVisibleRows()+t;n===r.countRows()-1?s=1:n+s>r.countRows()&&(s=r.countRows()-n-1),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}},command$j={name:"moveCellSelectionInlineEnd",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(-s.row,-s.col):r.selection.transformStart(-s.row,-s.col)}},command$i={name:"moveCellSelectionInlineStart",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(s.row,s.col):r.selection.transformStart(s.row,s.col)}},command$h={name:"moveCellSelectionLeft",callback(r){r.selection.transformStart(0,-1*r.getDirectionFactor())}},command$g={name:"moveCellSelectionRight",callback(r){r.selection.transformStart(0,r.getDirectionFactor())}},command$f={name:"moveCellSelectionToMostBottom",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);t===null&&(t=-1),r.selection.setRangeStart(r._createCellCoords(t,e))}},command$e={name:"moveCellSelectionToMostBottomInlineEnd",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsBottom,10),o=t.getNearestNotHiddenIndex(r.countRows()-s-1,-1),a=n.getNearestNotHiddenIndex(r.countCols()-1,-1);e.setRangeStart(r._createCellCoords(o,a))}},command$d={name:"moveCellSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r;e.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},command$c={name:"moveCellSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,n=parseInt(r.getSettings().fixedColumnsStart,10),s=r.getSelectedRangeLast().highlight.row,o=t.getNearestNotHiddenIndex(n,1);e.setRangeStart(r._createCellCoords(s,o))}},command$b={name:"moveCellSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,n=r.getSelectedRangeLast().highlight.row;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);s===null&&(s=r.isRtl()?-1:-r.countRowHeaders()),e.setRangeStart(r._createCellCoords(n,s))}},command$a={name:"moveCellSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{row:n}=r.getSelectedRangeLast().highlight;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);s===null&&(s=r.isRtl()?-r.countRowHeaders():-1),e.setRangeStart(r._createCellCoords(n,s))}},command$9={name:"moveCellSelectionToMostTop",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-r.countColHeaders()),r.selection.setRangeStart(r._createCellCoords(t,e))}},command$8={name:"moveCellSelectionToMostTopInlineStart",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsTop,10),o=parseInt(r.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(s,1),l=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(r._createCellCoords(a,l))}},command$7={name:"moveCellSelectionUp",callback(r){let{selection:e}=r;e.transformStart(-1,0)}},command$6={name:"moveCellSelectionUpByViewportHight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=-(r.countVisibleRows()+t);n===-t?s=-1:n+s<t&&(s=-(n+t)),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}};function getAllCommands(){return[command$l,command$k,command$j,command$i,command$h,command$g,command$f,command$e,command$d,command$c,command$b,command$a,command$9,command$8,command$7,command$6]}const command$5={name:"emptySelectedCells",callback(r){r.emptySelectedCells(),r._getEditorManager().prepareEditor()}},command$4={name:"scrollToFocusedCell",callback(r){const{highlight:e}=r.getSelectedRangeLast(),t=r.getFirstFullyVisibleRow()-1,n=r.getFirstFullyVisibleColumn()-1,s=r.getLastFullyVisibleRow()+1,o=r.getLastFullyVisibleColumn()+1,a=r._createCellCoords(t,n),l=r._createCellCoords(s,o);if(!r._createCellRange(a,a,l).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const d=Math.floor(r.countVisibleCols()/2);c.col=Math.max(e.col-d,0)}if(e.row>=0){const d=Math.floor(r.countVisibleRows()/2);c.row=Math.max(e.row-d,0)}r.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},command$3={name:"selectAllCells",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},command$2={name:"selectAllCellsAndHeaders",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},command$1={name:"populateSelectedCellsData",callback(r){const e=r.getSelectedRange(),{row:t,col:n}=e[e.length-1].highlight.normalize(),s=r.getDataAtCell(t,n),o=new Map;for(let a=0;a<e.length;a++)e[a].forAll((l,u)=>{if(l>=0&&u>=0&&(l!==t||u!==n)){const{readOnly:c}=r.getCellMeta(l,u);c||o.set(`${l}x${u}`,[l,u,s])}});r.setDataAtCell(Array.from(o.values()))}},allCommands=[...getAllCommands$2(),...getAllCommands$1(),...getAllCommands(),command$5,command$4,command$3,command$2,command$1];function createKeyboardShortcutCommandsPool(r){const e={};return allCommands.forEach(t=>{let{name:n,callback:s}=t;e[n]=function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return s(r,...a)}}),e}function shortcutsEditorContext(r){const e=r.getShortcutManager().addContext("editor"),t=createKeyboardShortcutCommandsPool(r),n={group:EDITOR_EDIT_GROUP};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>t.editorCloseAndSaveByEnter(s,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(s,o)=>t.editorCloseAndSaveByEnter(s,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:r.getShortcutManager().getContext("grid"),callback:(s,o)=>t.editorCloseAndSave(s,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(s,o)=>t.editorCloseAndSaveByArrowKeys(s,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],n)}function shortcutsGridContext(r){const e=r.getShortcutManager().addContext("grid"),t=createKeyboardShortcutCommandsPool(r),n={runOnlyIf:()=>{const{navigableHeaders:s}=r.getSettings();return isDefined(r.getSelected())&&(s||!s&&r.countRenderedRows()>0&&r.countRenderedCols()>0)},group:GRID_GROUP};e.addShortcuts([{keys:[["F2"]],callback:s=>t.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>t.editorOpen(s,o)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(r.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var s;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=r.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var s,o;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())&&((o=r.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],n)}function registerAllShortcutContexts(r){[shortcutsGridContext,shortcutsEditorContext].forEach(e=>e(r))}const SHORTCUTS_GROUP$e="handsontableEditor",EDITOR_TYPE$8="handsontable";class HandsontableEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a);const l=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,d){const f=this.getSourceData(d.row,d.col);f!==void 0&&l.setValue(f),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$1(u,a.handsontable),this.htOptions=u}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.htEditor.useTheme(e)})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:SHORTCUTS_GROUP$e,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},s=(o,a)=>{const l=this.htEditor;if(o!==void 0&&(o<0||l.flipped&&o>l.countRows()-1?l.deselectCell():l.selectCell(o,0),l.getData().length))return a.preventDefault(),stopImmediatePropagation(a),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let l,u;return!a.getSelectedLast()&&a.flipped?l=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(u=a.getSelectedLast()[0],l=Math.max(0,u-1)):(u=a.getSelectedLast()[0],l=u-1)),s(l,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let l,u;if(!a.getSelectedLast()&&!a.flipped)l=0;else if(a.getSelectedLast()){if(a.flipped)l=a.getSelectedLast()[0]+1;else if(!a.flipped){const c=a.countRows()-1;u=a.getSelectedLast()[0],l=Math.min(c,u+1)}}return s(l,o)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$e)}}const KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(r){return r===32||r>=48&&r<=57||r>=96&&r<=111||r>=186&&r<=192||r>=219&&r<=222||r>=226||r>=65&&r<=90}function isFunctionKey(r){return FUNCTION_KEYS.includes(r)}function isCtrlMetaKey(r){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(r)}function isKey(r,e){const t=e.split("|");let n=!1;return arrayEach(t,s=>{if(r===KEY_CODES[s])return n=!0,!1}),n}const RENDERER_TYPE$b="base";function baseRenderer(r,e,t,n,s,o,a){const l=a.ariaTags,u=[],c=[],d=[],f=[];a.className&&addClass$1(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),l&&f.push(A11Y_READONLY())):l&&d.push(A11Y_READONLY()[0]),a.valid===!1&&a.invalidCellClassName?(u.push(a.invalidCellClassName),l&&f.push(A11Y_INVALID())):(c.push(a.invalidCellClassName),l&&d.push(A11Y_INVALID()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!o&&a.placeholder&&u.push(a.placeholderCellClassName),removeClass$1(e,c),addClass$1(e,u),removeAttribute(e,d),setAttribute(e,f)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$b;const RENDERER_TYPE$a="text";function textRenderer(r,e,t,n,s,o,a){baseRenderer.apply(this,[r,e,t,n,s,o,a]);let l=o;if(!l&&a.placeholder&&(l=a.placeholder),l=stringify$1(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){empty$2(e);const u=r.rootDocument.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=r.getSourceDataAtRow(t),e.appendChild(u)}else fastInnerText(e,l)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$a;function _classPrivateFieldInitSpec$T(r,e,t){_checkPrivateRedeclaration$1a(r,e),e.set(r,t)}function _checkPrivateRedeclaration$1a(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1U(r,e,t){return(e=_toPropertyKey$1U(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1U(r){var e=_toPrimitive$1U(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1U(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$T(r,e){return r.get(_assertClassBrand$1a(r,e))}function _assertClassBrand$1a(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$7="autocomplete";var _idPrefix=new WeakMap;class AutocompleteEditor extends HandsontableEditor{constructor(){super(...arguments),_defineProperty$1U(this,"query",null),_defineProperty$1U(this,"strippedChoices",[]),_defineProperty$1U(this,"rawChoices",[]),_classPrivateFieldInitSpec$T(this,_idPrefix,this.hot.guid.slice(0,9)),_defineProperty$1U(this,"sortByRelevance",function(e,t,n){const s=[],o=[],a=e.length;let l=t.length,u,c,d,f;if(a===0){for(d=0;d<l;d++)o.push(d);return o}for(d=0;d<l;d++){if(c=stripTags(stringify$1(t[d])),n)f=c.indexOf(e);else{const C=this.cellProperties.locale;f=c.toLocaleLowerCase(C).indexOf(e.toLocaleLowerCase(C))}f!==-1&&(u=c.length-f-a,s.push({baseIndex:d,index:f,charsLeft:u,value:c}))}for(s.sort((C,m)=>{if(m.index===-1)return-1;if(C.index===-1)return 1;if(C.index<m.index)return-1;if(m.index<C.index)return 1;if(C.index===m.index){if(C.charsLeft<m.charsLeft)return-1;if(C.charsLeft>m.charsLeft)return 1}return 0}),d=0,l=s.length;d<l;d++)o.push(s[d].baseIndex);return o})}static get EDITOR_TYPE(){return EDITOR_TYPE$7}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return isDefined(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),addClass$1(this.htContainer,"autocompleteEditor"),addClass$1(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet$T(_idPrefix,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=n==null?void 0:n.length,{row:o,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[outerWidth(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(l,u,c,d,f,C,m)=>{textRenderer(l,u,c,d,f,C,m);const{filteringCaseSensitive:E,allowHtml:v,locale:_}=this.cellProperties,T=this.query;let R=stringify$1(C),O,N;R&&!v&&(O=E===!0?R.indexOf(T):R.toLocaleLowerCase(_).indexOf(T.toLocaleLowerCase(_)),O!==-1&&(N=R.substr(O,T.length),R=R.replace(N,`<strong>${N}</strong>`))),t&&setAttribute(u,[A11Y_OPTION(),...n?[A11Y_SETSIZE(s)]:[],...n?[A11Y_POSINSET(n.indexOf(C)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=R},afterSelectionEnd:(l,u)=>{if(t){const c=this.htEditor.getCell(l,u,!0);setAttribute(c,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(c.id))}}}),t&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet$T(_idPrefix,this)}-listbox-${o}-${a}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=getCaretPosition(this.TEXTAREA),n=getSelectionEndPosition(this.TEXTAREA),s=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,l=null,u=e;s&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(a)?a.length:0;if(o===!1)c&&(l=a[0]);else{const d=[];for(let f=0,C=u.length;f<C&&!(s&&c<=f);f++)c?d.push(u[a[f]]):d.push(u[f]);l=0,u=d}this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),setCaretPosition(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=getTrimmingContainer(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||n==="horizontal"))return!1;const s=offset$2(this.TEXTAREA),o=outerHeight(this.TEXTAREA),a=this.getHeight(),l=e.scrollTop,u=outerHeight(this.hot.view._wt.wtTable.THEAD),c=offset$2(e),d=s.top-c.top-u+l,f=e.scrollHeight-d-u-o,C=a>f&&d>f;return C?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(C?d:f,a),C}limitDropdownIfNeeded(e,t){if(t>e){let n=0,s=0,o=0,a=null;do o=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),n+=o,s+=1;while(n<e);a=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-a}px`),this.setDropdownHeight(n-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+getScrollbarWidth(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(o,a)=>a).reduce((o,a)=>o+this.htEditor.getRowHeight(a),0)+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=arrayMap(e,o=>stringify$1(o));return arrayMap(n,o=>t?o:stripTags(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n={row:t?t.from.row:-1};let s=!1;return e===KEY_CODES.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(s=!0),e===KEY_CODES.ARROW_UP&&n.row>-1&&(s=!0),s}onBeforeKeyDown(e){if(isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){let t=10;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const EDITOR_TYPE$6="checkbox";class CheckboxEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$6}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');hasClass$1(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const getWindow$1=()=>window,getDocument=()=>window.document,sto=(r,e)=>window.setTimeout(r,e),addEvent=function(r,e,t,n){r.addEventListener(e,t,!!n)},removeEvent=function(r,e,t,n){r.removeEventListener(e,t,!!n)},trim=function(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")},hasClass=function(r,e){return(" "+r.className+" ").indexOf(" "+e+" ")!==-1},addClass=function(r,e){hasClass(r,e)||(r.className=r.className===""?e:r.className+" "+e)},removeClass=function(r,e){r.className=trim((" "+r.className+" ").replace(" "+e+" "," "))},isArray$1=function(r){return/Array/.test(Object.prototype.toString.call(r))},isDate$1=function(r){return/Date/.test(Object.prototype.toString.call(r))&&!isNaN(r.getTime())},isWeekend=function(r){let e=r.getDay();return e===0||e===6},isLeapYear=function(r){return r%4===0&&r%100!==0||r%400===0},getDaysInMonth=function(r,e){return[31,isLeapYear(r)?29:28,31,30,31,30,31,31,30,31,30,31][e]},setToStartOfDay=function(r){isDate$1(r)&&r.setHours(0,0,0,0)},compareDates=function(r,e){return r.getTime()===e.getTime()},extend=function(r,e,t){let n,s;for(n in e)s=r[n]!==void 0,s&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?isDate$1(e[n])?t&&(r[n]=new Date(e[n].getTime())):isArray$1(e[n])?t&&(r[n]=e[n].slice(0)):r[n]=extend({},e[n],t):(t||!s)&&(r[n]=e[n]);return r},fireEvent=function(r,e,t){let n=getDocument().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=extend(n,t),r.dispatchEvent(n)},adjustCalendar=function(r){return r.month<0&&(r.year-=Math.ceil(Math.abs(r.month)/12),r.month+=12),r.month>11&&(r.year+=Math.floor(Math.abs(r.month)/12),r.month-=12),r},defaults$1={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(r,e,t){for(e+=r.firstDay;e>=7;)e-=7;return t?r.i18n.weekdaysShort[e]:r.i18n.weekdays[e]},renderDay=function(r){let e=[],t="false";if(r.isEmpty)if(r.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),r.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return r.isDisabled&&e.push("is-disabled"),r.isToday&&e.push("is-today"),r.isSelected&&(e.push("is-selected"),t="true"),r.hasEvent&&e.push("has-event"),r.isInRange&&e.push("is-inrange"),r.isStartRange&&e.push("is-startrange"),r.isEndRange&&e.push("is-endrange"),'<td data-day="'+r.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+r.year+'" data-pika-month="'+r.month+'" data-pika-day="'+r.day+'">'+r.day+"</button></td>"},isoWeek=function(r,e){r.setHours(0,0,0,0);let t=r.getDate(),n=r.getDay(),s=e,o=s-1,a=7,l=function(C){return(C+a-1)%a};r.setDate(t+o-l(n));let u=new Date(r.getFullYear(),0,s),c=24*60*60*1e3,d=(r.getTime()-u.getTime())/c;return 1+Math.round((d-o+l(u.getDay()))/a)},renderWeek=function(r,e,t,n,s){let o=new Date(n,t,e);return'<td class="pika-week">'+(r.hasMoment?r.moment(o).isoWeek():isoWeek(o,s))+"</td>"},renderRow=function(r,e,t,n){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?r.reverse():r).join("")+"</tr>"},renderBody=function(r){return"<tbody>"+r.join("")+"</tbody>"},renderHead=function(r){let e,t=[];for(r.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+renderDayName(r,e)+'">'+renderDayName(r,e,!0)+"</abbr></th>");return"<thead><tr>"+(r.isRTL?t.reverse():t).join("")+"</tr></thead>"},renderTitle=function(r,e,t,n,s,o){let a,l,u,c=r._o,d=t===c.minYear,f=t===c.maxYear,C='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',m,E,v=!0,_=!0;for(u=[],a=0;a<12;a++)u.push('<option value="'+(t===s?a-e:12+a-e)+'"'+(a===n?' selected="selected"':"")+(d&&a<c.minMonth||f&&a>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[a]+"</option>");for(m='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+u.join("")+"</select></div>",isArray$1(c.yearRange)?(a=c.yearRange[0],l=c.yearRange[1]+1):(a=t-c.yearRange,l=1+t+c.yearRange),u=[];a<l&&a<=c.maxYear;a++)a>=c.minYear&&u.push('<option value="'+a+'"'+(a===t?' selected="selected"':"")+">"+a+"</option>");return E='<div class="pika-label">'+t+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+u.join("")+"</select></div>",c.showMonthAfterYear?C+=E+m:C+=m+E,d&&(n===0||c.minMonth>=n)&&(v=!1),f&&(n===11||c.maxMonth<=n)&&(_=!1),e===0&&(C+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===r._o.numberOfMonths-1&&(C+='<button class="pika-next'+(_?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),C+="</div>"},renderTable=function(r,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+renderHead(r)+renderBody(e)+"</table>"};function Pikaday(r){let e=this,t=e.config(r);e._onMouseDown=function(s){if(!e._v)return;s=s||getWindow$1().event;let o=s.target||s.srcElement;if(o)if(hasClass(o,"is-disabled")||(hasClass(o,"pika-button")&&!hasClass(o,"is-empty")&&!hasClass(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),t.bound&&sto(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):hasClass(o,"pika-prev")?e.prevMonth():hasClass(o,"pika-next")&&e.nextMonth()),hasClass(o,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||getWindow$1().event;let o=s.target||s.srcElement;o&&(hasClass(o,"pika-select-month")?e.gotoMonth(o.value):hasClass(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(s){if(s=s||getWindow$1().event,e.isVisible())switch(s.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let s=this.moment(t.field.value,t.format,t.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(s){let o;s.firedBy!==e&&(o=e._parseFieldValue(),isDate$1(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=getDocument().activeElement;do if(hasClass(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=sto(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||getWindow$1().event;let o=s.target||s.srcElement,a=o;if(o){!hasEventListeners&&hasClass(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),addEvent(o,"change",e._onChange)));do if(hasClass(a,"pika-single")||a===t.trigger)return;while(a=a.parentNode);e._v&&o!==t.trigger&&a!==t.trigger&&e.hide()}},e.el=getDocument().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),addEvent(e.el,"mousedown",e._onMouseDown,!0),addEvent(e.el,"touchend",e._onMouseDown,!0),addEvent(e.el,"change",e._onChange),t.keyboardInput&&addEvent(getDocument(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?getDocument().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),addEvent(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let n=t.defaultDate;isDate$1(n)?t.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",addEvent(t.trigger,"click",e._onInputClick),addEvent(t.trigger,"focus",e._onInputFocus),addEvent(t.trigger,"blur",e._onInputBlur)):this.show()}Pikaday.prototype={config:function(r){this._o||(this._o=extend({},defaults$1,!0));let e=extend(this._o,r,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,isDate$1(e.minDate)||(e.minDate=!1),isDate$1(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),isArray$1(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||defaults$1.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(r){return r=r||this._o.format,isDate$1(this._d)?this._o.toString?this._o.toString(this._d,r):this.hasMoment?this.moment(this._d).format(r):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(r,e){this.hasMoment&&this.moment.isMoment(r)&&this.setDate(r.toDate(),e)},useMoment:function(r){this.hasMoment=!0,this.moment=r},getDate:function(){return isDate$1(this._d)?new Date(this._d.getTime()):null},setDate:function(r,e){if(!r)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof r=="string"&&(r=new Date(Date.parse(r))),!isDate$1(r))return;let t=this._o.minDate,n=this._o.maxDate;isDate$1(t)&&r<t?r=t:isDate$1(n)&&r>n&&(r=n),this._d=new Date(r.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(r){let e=!0;if(isDate$1(r)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=r.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=s<t.getTime()||n.getTime()<s}e&&(this.calendars=[{month:r.getMonth(),year:r.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(r,e){let t=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,s;r==="add"?s=new Date(t.valueOf()+n):r==="subtract"&&(s=new Date(t.valueOf()-n)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let r=1;r<this._o.numberOfMonths;r++)this.calendars[r]=adjustCalendar({month:this.calendars[0].month+r,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(r){isNaN(r)||(this.calendars[0].month=parseInt(r,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(r){isNaN(r)||(this.calendars[0].year=parseInt(r,10),this.adjustCalendars())},setMinDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.minDate=r,this._o.minYear=r.getFullYear(),this._o.minMonth=r.getMonth()):(this._o.minDate=defaults$1.minDate,this._o.minYear=defaults$1.minYear,this._o.minMonth=defaults$1.minMonth,this._o.startRange=defaults$1.startRange),this.draw()},setMaxDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.maxDate=r,this._o.maxYear=r.getFullYear(),this._o.maxMonth=r.getMonth()):(this._o.maxDate=defaults$1.maxDate,this._o.maxYear=defaults$1.maxYear,this._o.maxMonth=defaults$1.maxMonth,this._o.endRange=defaults$1.endRange),this.draw()},setStartRange:function(r){this._o.startRange=r},setEndRange:function(r){this._o.endRange=r},draw:function(r){if(!this._v&&!r)return;let e=this._o,t=e.minYear,n=e.maxYear,s=e.minMonth,o=e.maxMonth,a="",l;this._y<=t&&(this._y=t,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=n&&(this._y=n,!isNaN(o)&&this._m>o&&(this._m=o));for(let u=0;u<e.numberOfMonths;u++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+renderTitle(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,l)+this.render(this.calendars[u].year,this.calendars[u].month,l)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&sto(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let r,e,t,n,s,o,a,l,u,c,d;this._o.container||(this.el.style.position="absolute",r=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,n=getWindow$1().innerWidth||getDocument().documentElement.clientWidth,s=getWindow$1().innerHeight||getDocument().documentElement.clientHeight,o=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,c=!0,d=!0,u=r.getBoundingClientRect(),a=u.left+getWindow$1().pageXOffset,l=u.bottom+getWindow$1().pageYOffset,(this._o.reposition&&a+e>n||this._o.position.indexOf("right")>-1&&a-e+r.offsetWidth>0)&&(a=a-e+r.offsetWidth,c=!1),(this._o.reposition&&l+t>s+o||this._o.position.indexOf("top")>-1&&l-t-r.offsetHeight>0)&&(l=l-t-r.offsetHeight,d=!1),a<0&&(a=0),l<0&&(l=0),this.el.style.left=a+"px",this.el.style.top=l+"px",addClass(this.el,c?"left-aligned":"right-aligned"),addClass(this.el,d?"bottom-aligned":"top-aligned"),removeClass(this.el,c?"right-aligned":"left-aligned"),removeClass(this.el,d?"top-aligned":"bottom-aligned"))},render:function(r,e,t){let n=this._o,s=new Date,o=getDaysInMonth(r,e),a=new Date(r,e,1).getDay(),l=[],u=[];setToStartOfDay(s),n.firstDay>0&&(a-=n.firstDay,a<0&&(a+=7));let c=e===0?11:e-1,d=e===11?0:e+1,f=e===0?r-1:r,C=e===11?r+1:r,m=getDaysInMonth(f,c),E=o+a,v=E;for(;v>7;)v-=7;E+=7-v;let _=!1;for(let T=0,R=0;T<E;T++){let O=new Date(r,e,1+(T-a)),N=isDate$1(this._d)?compareDates(O,this._d):!1,G=compareDates(O,s),D=n.events.indexOf(O.toDateString())!==-1,k=T<a||T>=o+a,z=1+(T-a),ne=e,Z=r,ve=n.startRange&&compareDates(n.startRange,O),xe=n.endRange&&compareDates(n.endRange,O),de=n.startRange&&n.endRange&&n.startRange<O&&O<n.endRange,Se=n.minDate&&O<n.minDate||n.maxDate&&O>n.maxDate||n.disableWeekends&&isWeekend(O)||n.disableDayFn&&n.disableDayFn(O);k&&(T<a?(z=m+z,ne=c,Z=f):(z=z-o,ne=d,Z=C));let Me={day:z,month:ne,year:Z,hasEvent:D,isSelected:N,isToday:G,isDisabled:Se,isEmpty:k,isStartRange:ve,isEndRange:xe,isInRange:de,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&N&&(_=!0),u.push(renderDay(Me)),++R===7&&(n.showWeekNumber&&u.unshift(renderWeek(this,T-a,e,r,n.firstWeekOfYearMinDays)),l.push(renderRow(u,n.isRTL,n.pickWholeWeek,_)),u=[],R=0,_=!1)}return renderTable(n,l,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let r=this._v;r!==!1&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,r!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let r=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),r.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),r.field&&(removeEvent(r.field,"change",this._onInputChange),r.bound&&(removeEvent(r.trigger,"click",this._onInputClick),removeEvent(r.trigger,"focus",this._onInputFocus),removeEvent(r.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _defineProperty$1T(r,e,t){return(e=_toPropertyKey$1T(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1T(r){var e=_toPrimitive$1T(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1T(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor";class DateEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1T(this,"defaultDateFormat","DD/MM/YYYY"),_defineProperty$1T(this,"parentDestroyed",!1),_defineProperty$1T(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE$5}init(){if(typeof hooks!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||(removeClass$1(this.datePicker,/ht-theme-.*/g),addClass$1(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass$1(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();removeClass$1(this.datePicker,/ht-theme-.*/g),addClass$1(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{hasClass$1(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),s=e?isFunctionKey(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(hooks),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,hooks(o,t,!0).isValid()&&this.$datePicker.setMoment(hooks(o,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!n&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,hooks(o,t,!0).isValid()&&this.$datePicker.setMoment(hooks(o,t),!0),!s&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(t,this.cellProperties.datePickerConfig);const n=t.onSelect,s=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=hooks(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),n&&n()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:s}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(t=o.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,l=n.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),u=n.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),c=s.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),d=s.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=l&&this.row<=u&&this.col>=c&&this.col<=d){const f=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+f.top+outerHeight(this.TD)}px`;let C=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?C+=f.right-outerWidth(this.datePicker):C+=f.left,this.datePickerStyle.left=`${C}px`}else this.hideDatepicker()}}function warn$1(){isDefined(console)&&console.warn(...arguments)}function error(){isDefined(console)&&console.error(...arguments)}function isFunction$2(r){return typeof r=="function"}function debounce$2(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,n;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(()=>{n=r.apply(this,a)},e),n}return s}function partial(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return r.apply(this,t.concat(a))}}function curry(r){const e=r.length;function t(n){return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=n.concat(a);let c;return u.length>=e?c=r.apply(this,u):c=t(u),c}}return t([])}function fastCall(r,e,t,n,s,o,a,l){return isDefined(l)?r.call(e,t,n,s,o,a,l):isDefined(a)?r.call(e,t,n,s,o,a):isDefined(o)?r.call(e,t,n,s,o):isDefined(s)?r.call(e,t,n,s):isDefined(n)?r.call(e,t,n):isDefined(t)?r.call(e,t):r.call(e)}const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]);var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var r=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(e,t,n){for(var s=0,o=arguments.length>2?n:r(t),a=new e(o);o>s;)a[s]=t[s++];return a},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var r=requireGlobalThis();return getBuiltInPrototypeMethod=function(e,t){var n=r[e],s=n&&n.prototype;return s&&s[t]},getBuiltInPrototypeMethod}var addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var r=requireWellKnownSymbol(),e=requireObjectCreate(),t=requireObjectDefineProperty().f,n=r("unscopables"),s=Array.prototype;return s[n]===void 0&&t(s,n,{configurable:!0,value:e(null)}),addToUnscopables=function(o){s[n][o]=!0},addToUnscopables}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var r=require_export(),e=requireFunctionUncurryThis(),t=requireACallable(),n=requireToIndexedObject(),s=requireArrayFromConstructorAndList(),o=requireGetBuiltInPrototypeMethod(),a=requireAddToUnscopables(),l=Array,u=e(o("Array","sort"));return r({target:"Array",proto:!0},{toSorted:function(d){d!==void 0&&t(d);var f=n(this),C=s(l,f);return u(C,d)}}),a("toSorted"),es_array_toSorted}requireEs_array_toSorted();function _classPrivateMethodInitSpec$Q(r,e){_checkPrivateRedeclaration$19(r,e),e.add(r)}function _classPrivateFieldInitSpec$S(r,e,t){_checkPrivateRedeclaration$19(r,e),e.set(r,t)}function _checkPrivateRedeclaration$19(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$P(r,e,t){return r.set(_assertClassBrand$19(r,e),t),t}function _classPrivateFieldGet$S(r,e){return r.get(_assertClassBrand$19(r,e))}function _assertClassBrand$19(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const MAX_SKIPPED_HOOKS_COUNT=100;var _hooks$1=new WeakMap,_skippedHooksCount=new WeakMap,_needsSort=new WeakMap,_HooksBucket_brand=new WeakSet;class HooksBucket{constructor(){_classPrivateMethodInitSpec$Q(this,_HooksBucket_brand),_classPrivateFieldInitSpec$S(this,_hooks$1,new Map),_classPrivateFieldInitSpec$S(this,_skippedHooksCount,new Map),_classPrivateFieldInitSpec$S(this,_needsSort,new Set),REGISTERED_HOOKS.forEach(e=>_assertClassBrand$19(_HooksBucket_brand,this,_createHooksCollection).call(this,e))}getHooks(e){var t;return(t=_classPrivateFieldGet$S(_hooks$1,this).get(e))!==null&&t!==void 0?t:[]}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classPrivateFieldGet$S(_hooks$1,this).has(e)||(_assertClassBrand$19(_HooksBucket_brand,this,_createHooksCollection).call(this,e),REGISTERED_HOOKS.push(e));const s=_classPrivateFieldGet$S(_hooks$1,this).get(e);if(s.find(c=>c.callback===t))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,l=!!n.initialHook;let u=!1;if(l){const c=s.find(d=>d.initialHook);c&&(c.callback=t,u=!0)}if(!u){s.push({callback:t,orderIndex:o,runOnce:a,initialHook:l,skip:!1});let c=_classPrivateFieldGet$S(_needsSort,this).has(e);!c&&o!==0&&(c=!0,_classPrivateFieldGet$S(_needsSort,this).add(e)),c&&s.length>1&&_classPrivateFieldGet$S(_hooks$1,this).set(e,s.toSorted((d,f)=>d.orderIndex-f.orderIndex))}}has(e){return _classPrivateFieldGet$S(_hooks$1,this).has(e)&&_classPrivateFieldGet$S(_hooks$1,this).get(e).length>0}remove(e,t){if(!_classPrivateFieldGet$S(_hooks$1,this).has(e))return!1;const n=_classPrivateFieldGet$S(_hooks$1,this).get(e),s=n.find(o=>o.callback===t);if(s){let o=_classPrivateFieldGet$S(_skippedHooksCount,this).get(e);return s.skip=!0,o+=1,o>MAX_SKIPPED_HOOKS_COUNT&&(_classPrivateFieldGet$S(_hooks$1,this).set(e,n.filter(a=>!a.skip)),o=0),_classPrivateFieldGet$S(_skippedHooksCount,this).set(e,o),!0}return!1}destroy(){_classPrivateFieldGet$S(_hooks$1,this).clear(),_classPrivateFieldGet$S(_skippedHooksCount,this).clear(),_classPrivateFieldSet$P(_hooks$1,this,null),_classPrivateFieldSet$P(_skippedHooksCount,this,null)}}function _createHooksCollection(r){_classPrivateFieldGet$S(_hooks$1,this).set(r,[]),_classPrivateFieldGet$S(_skippedHooksCount,this).set(r,0)}function _defineProperty$1S(r,e,t){return(e=_toPropertyKey$1S(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1S(r){var e=_toPrimitive$1S(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1S(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Hooks{constructor(){_defineProperty$1S(this,"globalBucket",new HooksBucket)}static getSingleton(){return getGlobalSingleton()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new HooksBucket),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?arrayEach(t,o=>this.add(e,o,n)):(REMOVED_HOOKS.has(e)&&warn$1(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn$1(DEPRECATED_HOOKS.get(e)),this.getBucket(n).add(e,t,{orderIndex:s,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?arrayEach(t,o=>this.once(e,o,n)):this.getBucket(n).add(e,t,{orderIndex:s,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(t)?arrayEach(t,s=>this.addAsFixed(e,s,n)):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,s,o,a,l,u){{const c=this.getBucket().getHooks(t),d=c?c.length:0;let f=0;if(d)for(;f<d;){if(!c[f]||c[f].skip){f+=1;continue}const C=fastCall(c[f].callback,e,n,s,o,a,l,u);C!==void 0&&(n=C),c[f]&&c[f].runOnce&&this.remove(t,c[f].callback),f+=1}}{const c=this.getBucket(e).getHooks(t),d=c?c.length:0;let f=0;if(d)for(;f<d;){if(!c[f]||c[f].skip){f+=1;continue}const C=fastCall(c[f].callback,e,n,s,o,a,l,u);C!==void 0&&(n=C),c[f]&&c[f].runOnce&&this.remove(t,c[f].callback,e),f+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}deregister(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}isDeprecated(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}isRegistered(e){return REGISTERED_HOOKS.indexOf(e)>=0}getRegistered(){return REGISTERED_HOOKS}}const globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}const EDITOR_TYPE$4="dropdown";class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$4}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Hooks.getSingleton().add("beforeValidate",function(r,e,t){const n=this.propToCol(t);if(Number.isInteger(n)){const s=this.getCellMeta(e,n);s.editor===DropdownEditor&&s.strict===void 0&&(s.filter=!1,s.strict=!0)}});const EDITOR_TYPE$3="numeric";class NumericEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$3}}function _defineProperty$1R(r,e,t){return(e=_toPropertyKey$1R(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1R(r){var e=_toPrimitive$1R(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1R(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$2="password";class PasswordEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1R(this,"autoResize",createInputElementResizer(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return EDITOR_TYPE$2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty$2(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$d="selectEditor",EDITOR_TYPE$1="select";class SelectEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$1}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...A11Y_HIDDEN()),e.appendChild(this.hot.rootDocument.createTextNode("")),addClass$1(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",hasClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)&&removeClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a);const l=this.cellProperties.selectOptions;let u;typeof l=="function"?u=this.prepareOptions(l(this.row,this.col,this.prop)):u=this.prepareOptions(l),empty$2(this.select),objectEach(u,(c,d)=>{const f=this.hot.rootDocument.createElement("OPTION");f.value=d,fastInnerHTML(f,c),this.select.appendChild(f)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,s=e.length;n<s;n++)t[e[n]]=e[n];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:n,height:s}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${s}px`,o.width=`${n}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",addClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={group:SHORTCUTS_GROUP$d};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$d)}}const EDITOR_TYPE="time";class TimeEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.TEXTAREA.dir="ltr"}}const collection=new Map;function staticRegister(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(r)||collection.set(r,new Map);const e=collection.get(r);function t(l,u){e.set(l,u)}function n(l){return e.get(l)}function s(l){return e.has(l)}function o(){return[...e.keys()]}function a(){return[...e.values()]}return{register:t,getItem:n,hasItem:s,getNames:o,getValues:a}}const registeredEditorClasses=new WeakMap,{register:register$4,getItem:getItem$3,hasItem:hasItem$3,getNames:getNames$3,getValues:getValues$3}=staticRegister("editors");function RegisteredEditor(r){const e={},t=r;this.getConstructor=function(){return r},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new t(n)),e[n.guid]},Hooks.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function _getEditorInstance(r,e){let t;if(typeof r=="function")registeredEditorClasses.get(r)||_register$3(null,r),t=registeredEditorClasses.get(r);else if(typeof r=="string")t=getItem$3(r);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${r}"`);return t.getInstance(e)}function _getItem$3(r){if(typeof r=="function")return r;if(!hasItem$3(r))throw Error(`No registered editor found under "${r}" name`);return getItem$3(r).getConstructor()}function _register$3(r,e){r&&typeof r!="string"&&(e=r,r=e.EDITOR_TYPE);const t=new RegisteredEditor(e);typeof r=="string"&&register$4(r,t),registeredEditorClasses.set(e,t)}function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}const RENDERER_TYPE$9="html";function htmlRenderer(r,e,t,n,s,o,a){baseRenderer.apply(this,[r,e,t,n,s,o,a]),fastInnerHTML(e,o??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$9;const RENDERER_TYPE$8="autocomplete";function autocompleteRenderer(r,e,t,n,s,o,a){const{rootDocument:l}=r,u=a.allowHtml?htmlRenderer:textRenderer,c=l.createElement("DIV"),d=r.getSettings().ariaTags;if(c.className="htAutocompleteArrow",d&&c.setAttribute(...A11Y_HIDDEN()),c.appendChild(l.createTextNode("")),u.apply(this,[r,e,t,n,s,o,a]),e.firstChild||e.appendChild(l.createTextNode("")),e.insertBefore(c,e.firstChild),addClass$1(e,"htAutocomplete"),!r.acArrowListener){const f=new EventManager(r);r.acArrowListener=function(C){hasClass$1(C.target,"htAutocompleteArrow")&&r.view._wt.getSetting("onCellDblClick",null,r._createCellCoords(t,n),e)},f.addEventListener(r.rootElement,"mousedown",r.acArrowListener),r.addHookOnce("afterDestroy",()=>{f.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$8;const RENDERER_TYPE$7="dropdown";function dropdownRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE$7;var esnext_iterator_every={},es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{every:function(a){n(this),t(a);var l=s(this),u=0;return!e(l,function(c,d){if(!a(c,u++))return d()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var hasRequiredEsnext_iterator_every;function requireEsnext_iterator_every(){return hasRequiredEsnext_iterator_every||(hasRequiredEsnext_iterator_every=1,requireEs_iterator_every()),esnext_iterator_every}requireEsnext_iterator_every();const CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,_dictionaryKeys=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS},Symbol.toStringTag,{value:"Module"})),isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$c="checkboxRenderer",RENDERER_TYPE$6="checkbox";Hooks.getSingleton().add("modifyAutoColumnSizeSeed",function(r,e,t){const{label:n,type:s,row:o,column:a,prop:l}=e;if(s===RENDERER_TYPE$6){if(n){const{value:u,property:c}=n;let d=t;if(u)d=typeof u=="function"?u(o,a,l,t):u;else if(c){const f=this.getDataAtRowProp(o,c);d=f!==null?f:t}r=d}return r}});function checkboxRenderer(r,e,t,n,s,o,a){const{rootDocument:l}=r,u=r.getSettings().ariaTags;baseRenderer.apply(this,[r,e,t,n,s,o,a]),registerEvents(r);let c=createInput(l);const d=a.label;let f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),empty$2(e),o===a.checkedTemplate||stringify$1(o).toLocaleLowerCase(a.locale)===stringify$1(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:o===a.uncheckedTemplate||stringify$1(o).toLocaleLowerCase(a.locale)===stringify$1(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:isEmpty$1(o)?addClass$1(c,"noValue"):(c.style.display="none",addClass$1(c,BAD_VALUE_CLASS),f=!0),setAttribute(c,[[ATTR_ROW,t],[ATTR_COLUMN,n]]),u&&setAttribute(c,[A11Y_LABEL(c.checked?r.getTranslatedPhrase(CHECKBOX_CHECKED):r.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(c.checked),A11Y_CHECKBOX()]),!f&&d){let v="";if(d.value)v=typeof d.value=="function"?d.value.call(this,t,n,s,o):d.value;else if(d.property){const T=r.getDataAtRowProp(t,d.property);v=T!==null?T:""}const _=createLabel(l,v,d.separated!==!0);d.position==="before"?d.separated?(e.appendChild(_),e.appendChild(c)):(_.appendChild(c),c=_):(!d.position||d.position==="after")&&(d.separated?(e.appendChild(c),e.appendChild(_)):(_.insertBefore(c,_.firstChild),c=_))}(!d||d&&!d.separated)&&e.appendChild(c),f&&e.appendChild(l.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(r)||(isListeningKeyDownEvent.set(r,!0),C());function C(){const _=r.getShortcutManager().getContext("grid"),T={group:SHORTCUTS_GROUP$c,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};_.addShortcuts([{keys:[["space"]],callback:()=>(m(),!E()),runOnlyIf:()=>{var R;return(R=r.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}},{keys:[["enter"]],callback:()=>(m(),!E()),runOnlyIf:()=>{const R=r.getSelectedRangeLast();return r.getSettings().enterBeginsEditing&&(R==null?void 0:R.highlight.isCell())&&!r.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!E()),runOnlyIf:()=>{var R;return(R=r.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}}],T)}function m(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const _=r.getSelectedRange(),T=[],R=new Map;let O=[],N=0;if(_){for(let G=0;G<_.length;G++){const{row:D,col:k}=_[G].getTopStartCorner(),{row:z,col:ne}=_[G].getBottomEndCorner();for(let Z=D;Z<=z;Z+=1)for(let ve=k;ve<=ne;ve+=1){const xe=r.getCellMeta(Z,ve);if(xe.hidden)continue;const de={checkedTemplate:xe.checkedTemplate,uncheckedTemplate:xe.uncheckedTemplate};if(xe.type!=="checkbox"){v===!0&&!xe.readOnly&&(R.has(T.length)?R.set(T.length,[...R.get(T.length),[Z,ve,null]]):R.set(T.length,[[Z,ve,null]]));continue}if(xe.readOnly===!0)continue;typeof xe.checkedTemplate>"u"&&(xe.checkedTemplate=!0),typeof xe.uncheckedTemplate>"u"&&(xe.uncheckedTemplate=!1);const Se=r.getDataAtCell(Z,ve);v===!1?[xe.checkedTemplate,xe.checkedTemplate.toString()].includes(Se)?O.push([Z,ve,xe.uncheckedTemplate,de]):[xe.uncheckedTemplate,xe.uncheckedTemplate.toString(),null,void 0].includes(Se)&&O.push([Z,ve,xe.checkedTemplate,de]):O.push([Z,ve,xe.uncheckedTemplate,de]),N+=1}T.push(N),N=0}O.every(G=>{let[,,D]=G;return D===O[0][2]})?O=O.map(G=>{let[D,k,z]=G;return[D,k,z]}):O=O.map(G=>{let[D,k,,z]=G;return[D,k,z.checkedTemplate]}),O.length>0&&T.forEach((G,D)=>{let k=O.splice(0,G);R.size&&R.has(D)&&(k=[...k,...R.get(D)]),r.setDataAtCell(k)})}}function E(){const v=r.getSelectedRange();if(v){for(let _=0;_<v.length;_++){const T=v[_].getTopStartCorner(),R=v[_].getBottomEndCorner();for(let O=T.row;O<=R.row;O++)for(let N=T.col;N<=R.col;N++){if(r.getCellMeta(O,N).readOnly)continue;const D=r.getCell(O,N);if(D instanceof HTMLElement&&D.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$6;function registerEvents(r){let e=isCheckboxListenerAdded.get(r);if(!e){const{rootElement:t}=r;e=new EventManager(r),e.addEventListener(t,"click",n=>onClick(n,r)),e.addEventListener(t,"mouseup",n=>onMouseUp(n,r)),e.addEventListener(t,"change",n=>onChange(n,r)),isCheckboxListenerAdded.set(r,e)}return e}function createInput(r){const e=r.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function createLabel(r,e,t){const n=r.createElement("label");return n.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,n.appendChild(r.createTextNode(e)),n.cloneNode(!0)}function onMouseUp(r,e){const{target:t}=r;isCheckboxInput(t)&&(!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN)||setTimeout(e.listen,10))}function onClick(r,e){const{target:t}=r;if(!isCheckboxInput(t)||!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN))return;const n=parseInt(t.getAttribute(ATTR_ROW),10),s=parseInt(t.getAttribute(ATTR_COLUMN),10);e.getCellMeta(n,s).readOnly&&r.preventDefault()}function onChange(r,e){const{target:t}=r;if(!isCheckboxInput(t)||!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN))return;const n=parseInt(t.getAttribute(ATTR_ROW),10),s=parseInt(t.getAttribute(ATTR_COLUMN),10),o=e.getCellMeta(n,s);if(!o.readOnly){let a=null;r.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(n,s,a)}}function isCheckboxInput(r){return r.tagName==="INPUT"&&r.getAttribute("type")==="checkbox"}const RENDERER_TYPE$5="handsontable";function handsontableRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$2(r){return r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var enUS,hasRequiredEnUS;function requireEnUS(){return hasRequiredEnUS||(hasRequiredEnUS=1,enUS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){let e=r%10;return~~(r%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),enUS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var unformatting,hasRequiredUnformatting;function requireUnformatting(){if(hasRequiredUnformatting)return unformatting;hasRequiredUnformatting=1;const r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(u){return u.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function t(u,c,d,f,C,m,E){if(!isNaN(+u))return+u;let v="",_=u.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(_!==u)return-1*t(_,c,d,f,C,m);for(let D=0;D<r.length;D++){let k=r[D];if(v=u.replace(RegExp(`([0-9 ])(${k.key})$`),"$1"),v!==u)return t(v,c,d,f,C,m)*k.factor}if(v=u.replace("%",""),v!==u)return t(v,c,d,f,C,m)/100;let T=parseFloat(u);if(isNaN(T))return;let R=f(T);if(R&&R!=="."&&(v=u.replace(new RegExp(`${e(R)}$`),""),v!==u))return t(v,c,d,f,C,m);let O={};Object.keys(m).forEach(D=>{O[m[D]]=D});let N=Object.keys(O).sort().reverse(),G=N.length;for(let D=0;D<G;D++){let k=N[D],z=O[k];if(v=u.replace(k,""),v!==u){let ne;switch(z){case"thousand":ne=Math.pow(10,3);break;case"million":ne=Math.pow(10,6);break;case"billion":ne=Math.pow(10,9);break;case"trillion":ne=Math.pow(10,12);break}return t(v,c,d,f,C,m)*ne}}}function n(u,c,d){let f=u.replace(d,"");return f=f.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),f=f.replace(c.decimal,"."),f}function s(u,c,d="",f,C,m,E){if(u==="")return;if(u===C)return 0;let v=n(u,c,d);return t(v,c,d,f,C,m)}function o(u,c){if(!(u.indexOf(":")&&c.thousands!==":"))return!1;let f=u.split(":");if(f.length!==3)return!1;let C=+f[0],m=+f[1],E=+f[2];return!isNaN(C)&&!isNaN(m)&&!isNaN(E)}function a(u){let c=u.split(":"),d=+c[0],f=+c[1];return+c[2]+60*f+3600*d}function l(u,c){const d=requireGlobalState();let f=d.currentDelimiters(),C=d.currentCurrency().symbol,m=d.currentOrdinal(),E=d.getZeroFormat(),v=d.currentAbbreviations(),_;if(typeof u=="string")o(u,f)?_=a(u):_=s(u,f,C,m,E,v);else if(typeof u=="number")_=u;else return;if(_!==void 0)return _}return unformatting={unformat:l},unformatting}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var validating$1,hasRequiredValidating;function requireValidating(){if(hasRequiredValidating)return validating$1;hasRequiredValidating=1;let r=requireUnformatting();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,t=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],o=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:t},base:{type:"string",validValues:["decimal","binary","general"],restriction:(_,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:_=>_.output==="byte"},characteristic:{type:"number",restriction:_=>_>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(_,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:_=>_>=0,message:"value must be positive"},{restriction:(_,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:_=>_>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(_,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},d={languageTag:{type:"string",mandatory:!0,restriction:_=>_.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(_,T){let R=C(_),O=E(T);return R&&O}function C(_){return r.unformat(_)!==void 0}function m(_,T,R,O=!1){let N=Object.keys(_).map(G=>{if(!T[G])return console.error(`${R} Invalid key: ${G}`),!1;let D=_[G],k=T[G];if(typeof k=="string"&&(k={type:k}),k.type==="format"){if(!m(D,c,`[Validate ${G}]`,!0))return!1}else if(typeof D!==k.type)return console.error(`${R} ${G} type mismatched: "${k.type}" expected, "${typeof D}" provided`),!1;if(k.restrictions&&k.restrictions.length){let z=k.restrictions.length;for(let ne=0;ne<z;ne++){let{restriction:Z,message:ve}=k.restrictions[ne];if(!Z(D,_))return console.error(`${R} ${G} invalid value: ${ve}`),!1}}return k.restriction&&!k.restriction(D,_)?(console.error(`${R} ${G} invalid value: ${k.message}`),!1):k.validValues&&k.validValues.indexOf(D)===-1?(console.error(`${R} ${G} invalid value: must be among ${JSON.stringify(k.validValues)}, "${D}" provided`),!1):!(k.children&&!m(D,k.children,`[Validate ${G}]`))});return O||N.push(...Object.keys(T).map(G=>{let D=T[G];if(typeof D=="string"&&(D={type:D}),D.mandatory){let k=D.mandatory;if(typeof k=="function"&&(k=k(_)),k&&_[G]===void 0)return console.error(`${R} Missing mandatory key "${G}"`),!1}return!0})),N.reduce((G,D)=>G&&D,!0)}function E(_){return m(_,c,"[Validate format]")}function v(_){return m(_,d,"[Validate language]")}return validating$1={validate:f,validateFormat:E,validateInput:C,validateLanguage:v},validating$1}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function parsePrefix(r,e){let t=r.match(/^{([^}]*)}/);return t?(e.prefix=t[1],r.slice(t[0].length)):r}function parsePostfix(r,e){let t=r.match(/{([^}]*)}$/);return t?(e.postfix=t[1],r.slice(0,-t[0].length)):r}function parseOutput(r,e){if(r.indexOf("$")!==-1){e.output="currency";return}if(r.indexOf("%")!==-1){e.output="percent";return}if(r.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(r.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(r.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(r.indexOf(":")!==-1){e.output="time";return}r.indexOf("o")!==-1&&(e.output="ordinal")}function parseThousandSeparated(r,e){r.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function parseSpaceSeparated(r,e){r.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function parseTotalLength(r,e){let t=r.match(/[1-9]+[0-9]*/);t&&(e.totalLength=+t[0])}function parseCharacteristic(r,e){let n=r.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function parseMantissa(r,e){let t=r.split(".")[1];if(t){let n=t.match(/0+/);n&&(e.mantissa=n[0].length)}}function parseTrimMantissa(r,e){const t=r.split(".")[1];t&&(e.trimMantissa=t.indexOf("[")!==-1)}function parseAverage(r,e){r.indexOf("a")!==-1&&(e.average=!0)}function parseForceAverage(r,e){r.indexOf("K")!==-1?e.forceAverage="thousand":r.indexOf("M")!==-1?e.forceAverage="million":r.indexOf("B")!==-1?e.forceAverage="billion":r.indexOf("T")!==-1&&(e.forceAverage="trillion")}function parseOptionalMantissa(r,e){r.match(/\[\.]/)?e.optionalMantissa=!0:r.match(/\./)&&(e.optionalMantissa=!1)}function parseOptionalCharacteristic(r,e){if(r.indexOf(".")!==-1){let t=r.split(".")[0];e.optionalCharacteristic=t.indexOf("0")===-1}}function parseNegative(r,e){r.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),r.match(/^\+?-/)&&(e.negative="sign")}function parseForceSign(r,e){r.match(/^\+/)&&(e.forceSign=!0)}function parseFormat(r,e={}){return typeof r!="string"?r:(r=parsePrefix(r,e),r=parsePostfix(r,e),parseOutput(r,e),parseTotalLength(r,e),parseCharacteristic(r,e),parseOptionalCharacteristic(r,e),parseAverage(r,e),parseForceAverage(r,e),parseMantissa(r,e),parseOptionalMantissa(r,e),parseTrimMantissa(r,e),parseThousandSeparated(r,e),parseSpaceSeparated(r,e),parseNegative(r,e),parseForceSign(r,e),e)}var parsing$2={parseFormat};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var globalState$2,hasRequiredGlobalState;function requireGlobalState(){if(hasRequiredGlobalState)return globalState$2;hasRequiredGlobalState=1;const r=requireEnUS(),e=requireValidating(),t=parsing$2;let n={},s,o={},a=null,l={};function u(d){s=d}function c(){return o[s]}return n.languages=()=>Object.assign({},o),n.currentLanguage=()=>s,n.currentBytes=()=>c().bytes||{},n.currentCurrency=()=>c().currency,n.currentAbbreviations=()=>c().abbreviations,n.currentDelimiters=()=>c().delimiters,n.currentOrdinal=()=>c().ordinal,n.currentDefaults=()=>Object.assign({},c().defaults,l),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().timeFormat),n.setDefaults=d=>{d=t.parseFormat(d),e.validateFormat(d)&&(l=d)},n.getZeroFormat=()=>a,n.setZeroFormat=d=>a=typeof d=="string"?d:null,n.hasZeroFormat=()=>a!==null,n.languageData=d=>{if(d){if(o[d])return o[d];throw new Error(`Unknown tag "${d}"`)}return c()},n.registerLanguage=(d,f=!1)=>{if(!e.validateLanguage(d))throw new Error("Invalid language data");o[d.languageTag]=d,f&&u(d.languageTag)},n.setLanguage=(d,f=r.languageTag)=>{if(!o[d]){let C=d.split("-")[0],m=Object.keys(o).find(E=>E.split("-")[0]===C);if(!o[m]){u(f);return}u(m);return}u(d)},n.registerLanguage(r),s=r.languageTag,globalState$2=n,globalState$2}function commonjsRequire$1(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function loadLanguagesInNode(r,e){r.forEach(t=>{let n;try{n=commonjsRequire$1(`../languages/${t}`)}catch{console.error(`Unable to load "${t}". No matching language file found.`)}n&&e.registerLanguage(n)})}var loading=r=>({loadLanguagesInNode:e=>loadLanguagesInNode(e,r)}),bignumber={exports:{}};(function(r){(function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,o=Math.floor,a="[BigNumber Error] ",l=a+"Number primitive has more than 15 significant digits: ",u=1e14,c=14,d=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],C=1e7,m=1e9;function E(D){var k,z,ne,Z=ue.prototype={constructor:ue,toString:null,valueOf:null},ve=new ue(1),xe=20,de=4,Se=-7,Me=21,Pe=-1e7,_e=1e7,Oe=!1,st=1,rt=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},te="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function ue(le,ge){var we,qe,$e,ze,it,Ve,Qe,nt,Ze=this;if(!(Ze instanceof ue))return new ue(le,ge);if(ge==null){if(le&&le._isBigNumber===!0){Ze.s=le.s,!le.c||le.e>_e?Ze.c=Ze.e=null:le.e<Pe?Ze.c=[Ze.e=0]:(Ze.e=le.e,Ze.c=le.c.slice());return}if((Ve=typeof le=="number")&&le*0==0){if(Ze.s=1/le<0?(le=-le,-1):1,le===~~le){for(ze=0,it=le;it>=10;it/=10,ze++);ze>_e?Ze.c=Ze.e=null:(Ze.e=ze,Ze.c=[le]);return}nt=String(le)}else{if(!n.test(nt=String(le)))return ne(Ze,nt,Ve);Ze.s=nt.charCodeAt(0)==45?(nt=nt.slice(1),-1):1}(ze=nt.indexOf("."))>-1&&(nt=nt.replace(".","")),(it=nt.search(/e/i))>0?(ze<0&&(ze=it),ze+=+nt.slice(it+1),nt=nt.substring(0,it)):ze<0&&(ze=nt.length)}else{if(R(ge,2,te.length,"Base"),ge==10&&V)return Ze=new ue(le),Ie(Ze,xe+Ze.e+1,de);if(nt=String(le),Ve=typeof le=="number"){if(le*0!=0)return ne(Ze,nt,Ve,ge);if(Ze.s=1/le<0?(nt=nt.slice(1),-1):1,ue.DEBUG&&nt.replace(/^0\.0*|\./,"").length>15)throw Error(l+le)}else Ze.s=nt.charCodeAt(0)===45?(nt=nt.slice(1),-1):1;for(we=te.slice(0,ge),ze=it=0,Qe=nt.length;it<Qe;it++)if(we.indexOf(qe=nt.charAt(it))<0){if(qe=="."){if(it>ze){ze=Qe;continue}}else if(!$e&&(nt==nt.toUpperCase()&&(nt=nt.toLowerCase())||nt==nt.toLowerCase()&&(nt=nt.toUpperCase()))){$e=!0,it=-1,ze=0;continue}return ne(Ze,String(le),Ve,ge)}Ve=!1,nt=z(nt,ge,10,Ze.s),(ze=nt.indexOf("."))>-1?nt=nt.replace(".",""):ze=nt.length}for(it=0;nt.charCodeAt(it)===48;it++);for(Qe=nt.length;nt.charCodeAt(--Qe)===48;);if(nt=nt.slice(it,++Qe)){if(Qe-=it,Ve&&ue.DEBUG&&Qe>15&&(le>d||le!==o(le)))throw Error(l+Ze.s*le);if((ze=ze-it-1)>_e)Ze.c=Ze.e=null;else if(ze<Pe)Ze.c=[Ze.e=0];else{if(Ze.e=ze,Ze.c=[],it=(ze+1)%c,ze<0&&(it+=c),it<Qe){for(it&&Ze.c.push(+nt.slice(0,it)),Qe-=c;it<Qe;)Ze.c.push(+nt.slice(it,it+=c));it=c-(nt=nt.slice(it)).length}else it-=Qe;for(;it--;nt+="0");Ze.c.push(+nt)}}else Ze.c=[Ze.e=0]}ue.clone=E,ue.ROUND_UP=0,ue.ROUND_DOWN=1,ue.ROUND_CEIL=2,ue.ROUND_FLOOR=3,ue.ROUND_HALF_UP=4,ue.ROUND_HALF_DOWN=5,ue.ROUND_HALF_EVEN=6,ue.ROUND_HALF_CEIL=7,ue.ROUND_HALF_FLOOR=8,ue.EUCLID=9,ue.config=ue.set=function(le){var ge,we;if(le!=null)if(typeof le=="object"){if(le.hasOwnProperty(ge="DECIMAL_PLACES")&&(we=le[ge],R(we,0,m,ge),xe=we),le.hasOwnProperty(ge="ROUNDING_MODE")&&(we=le[ge],R(we,0,8,ge),de=we),le.hasOwnProperty(ge="EXPONENTIAL_AT")&&(we=le[ge],we&&we.pop?(R(we[0],-1e9,0,ge),R(we[1],0,m,ge),Se=we[0],Me=we[1]):(R(we,-1e9,m,ge),Se=-(Me=we<0?-we:we))),le.hasOwnProperty(ge="RANGE"))if(we=le[ge],we&&we.pop)R(we[0],-1e9,-1,ge),R(we[1],1,m,ge),Pe=we[0],_e=we[1];else if(R(we,-1e9,m,ge),we)Pe=-(_e=we<0?-we:we);else throw Error(a+ge+" cannot be zero: "+we);if(le.hasOwnProperty(ge="CRYPTO"))if(we=le[ge],we===!!we)if(we)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Oe=we;else throw Oe=!we,Error(a+"crypto unavailable");else Oe=we;else throw Error(a+ge+" not true or false: "+we);if(le.hasOwnProperty(ge="MODULO_MODE")&&(we=le[ge],R(we,0,9,ge),st=we),le.hasOwnProperty(ge="POW_PRECISION")&&(we=le[ge],R(we,0,m,ge),rt=we),le.hasOwnProperty(ge="FORMAT"))if(we=le[ge],typeof we=="object")U=we;else throw Error(a+ge+" not an object: "+we);if(le.hasOwnProperty(ge="ALPHABET"))if(we=le[ge],typeof we=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(we))V=we.slice(0,10)=="0123456789",te=we;else throw Error(a+ge+" invalid: "+we)}else throw Error(a+"Object expected: "+le);return{DECIMAL_PLACES:xe,ROUNDING_MODE:de,EXPONENTIAL_AT:[Se,Me],RANGE:[Pe,_e],CRYPTO:Oe,MODULO_MODE:st,POW_PRECISION:rt,FORMAT:U,ALPHABET:te}},ue.isBigNumber=function(le){if(!le||le._isBigNumber!==!0)return!1;if(!ue.DEBUG)return!0;var ge,we,qe=le.c,$e=le.e,ze=le.s;e:if({}.toString.call(qe)=="[object Array]"){if((ze===1||ze===-1)&&$e>=-1e9&&$e<=m&&$e===o($e)){if(qe[0]===0){if($e===0&&qe.length===1)return!0;break e}if(ge=($e+1)%c,ge<1&&(ge+=c),String(qe[0]).length==ge){for(ge=0;ge<qe.length;ge++)if(we=qe[ge],we<0||we>=u||we!==o(we))break e;if(we!==0)return!0}}}else if(qe===null&&$e===null&&(ze===null||ze===1||ze===-1))return!0;throw Error(a+"Invalid BigNumber: "+le)},ue.maximum=ue.max=function(){return Ge(arguments,-1)},ue.minimum=ue.min=function(){return Ge(arguments,1)},ue.random=function(){var le=9007199254740992,ge=Math.random()*le&2097151?function(){return o(Math.random()*le)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(we){var qe,$e,ze,it,Ve,Qe=0,nt=[],Ze=new ue(ve);if(we==null?we=xe:R(we,0,m),it=s(we/c),Oe)if(crypto.getRandomValues){for(qe=crypto.getRandomValues(new Uint32Array(it*=2));Qe<it;)Ve=qe[Qe]*131072+(qe[Qe+1]>>>11),Ve>=9e15?($e=crypto.getRandomValues(new Uint32Array(2)),qe[Qe]=$e[0],qe[Qe+1]=$e[1]):(nt.push(Ve%1e14),Qe+=2);Qe=it/2}else if(crypto.randomBytes){for(qe=crypto.randomBytes(it*=7);Qe<it;)Ve=(qe[Qe]&31)*281474976710656+qe[Qe+1]*1099511627776+qe[Qe+2]*4294967296+qe[Qe+3]*16777216+(qe[Qe+4]<<16)+(qe[Qe+5]<<8)+qe[Qe+6],Ve>=9e15?crypto.randomBytes(7).copy(qe,Qe):(nt.push(Ve%1e14),Qe+=7);Qe=it/7}else throw Oe=!1,Error(a+"crypto unavailable");if(!Oe)for(;Qe<it;)Ve=ge(),Ve<9e15&&(nt[Qe++]=Ve%1e14);for(it=nt[--Qe],we%=c,it&&we&&(Ve=f[c-we],nt[Qe]=o(it/Ve)*Ve);nt[Qe]===0;nt.pop(),Qe--);if(Qe<0)nt=[ze=0];else{for(ze=-1;nt[0]===0;nt.splice(0,1),ze-=c);for(Qe=1,Ve=nt[0];Ve>=10;Ve/=10,Qe++);Qe<c&&(ze-=c-Qe)}return Ze.e=ze,Ze.c=nt,Ze}}(),ue.sum=function(){for(var le=1,ge=arguments,we=new ue(ge[0]);le<ge.length;)we=we.plus(ge[le++]);return we},z=function(){var le="0123456789";function ge(we,qe,$e,ze){for(var it,Ve=[0],Qe,nt=0,Ze=we.length;nt<Ze;){for(Qe=Ve.length;Qe--;Ve[Qe]*=qe);for(Ve[0]+=ze.indexOf(we.charAt(nt++)),it=0;it<Ve.length;it++)Ve[it]>$e-1&&(Ve[it+1]==null&&(Ve[it+1]=0),Ve[it+1]+=Ve[it]/$e|0,Ve[it]%=$e)}return Ve.reverse()}return function(we,qe,$e,ze,it){var Ve,Qe,nt,Ze,at,St,bt,q,X=we.indexOf("."),F=xe,b=de;for(X>=0&&(Ze=rt,rt=0,we=we.replace(".",""),q=new ue(qe),St=q.pow(we.length-X),rt=Ze,q.c=ge(G(_(St.c),St.e,"0"),10,$e,le),q.e=q.c.length),bt=ge(we,qe,$e,it?(Ve=te,le):(Ve=le,te)),nt=Ze=bt.length;bt[--Ze]==0;bt.pop());if(!bt[0])return Ve.charAt(0);if(X<0?--nt:(St.c=bt,St.e=nt,St.s=ze,St=k(St,q,F,b,$e),bt=St.c,at=St.r,nt=St.e),Qe=nt+F+1,X=bt[Qe],Ze=$e/2,at=at||Qe<0||bt[Qe+1]!=null,at=b<4?(X!=null||at)&&(b==0||b==(St.s<0?3:2)):X>Ze||X==Ze&&(b==4||at||b==6&&bt[Qe-1]&1||b==(St.s<0?8:7)),Qe<1||!bt[0])we=at?G(Ve.charAt(1),-F,Ve.charAt(0)):Ve.charAt(0);else{if(bt.length=Qe,at)for(--$e;++bt[--Qe]>$e;)bt[Qe]=0,Qe||(++nt,bt=[1].concat(bt));for(Ze=bt.length;!bt[--Ze];);for(X=0,we="";X<=Ze;we+=Ve.charAt(bt[X++]));we=G(we,nt,Ve.charAt(0))}return we}}(),k=function(){function le(qe,$e,ze){var it,Ve,Qe,nt,Ze=0,at=qe.length,St=$e%C,bt=$e/C|0;for(qe=qe.slice();at--;)Qe=qe[at]%C,nt=qe[at]/C|0,it=bt*Qe+nt*St,Ve=St*Qe+it%C*C+Ze,Ze=(Ve/ze|0)+(it/C|0)+bt*nt,qe[at]=Ve%ze;return Ze&&(qe=[Ze].concat(qe)),qe}function ge(qe,$e,ze,it){var Ve,Qe;if(ze!=it)Qe=ze>it?1:-1;else for(Ve=Qe=0;Ve<ze;Ve++)if(qe[Ve]!=$e[Ve]){Qe=qe[Ve]>$e[Ve]?1:-1;break}return Qe}function we(qe,$e,ze,it){for(var Ve=0;ze--;)qe[ze]-=Ve,Ve=qe[ze]<$e[ze]?1:0,qe[ze]=Ve*it+qe[ze]-$e[ze];for(;!qe[0]&&qe.length>1;qe.splice(0,1));}return function(qe,$e,ze,it,Ve){var Qe,nt,Ze,at,St,bt,q,X,F,b,ce,Fe,Le,ae,re,me,he,Ae=qe.s==$e.s?1:-1,je=qe.c,ke=$e.c;if(!je||!je[0]||!ke||!ke[0])return new ue(!qe.s||!$e.s||(je?ke&&je[0]==ke[0]:!ke)?NaN:je&&je[0]==0||!ke?Ae*0:Ae/0);for(X=new ue(Ae),F=X.c=[],nt=qe.e-$e.e,Ae=ze+nt+1,Ve||(Ve=u,nt=v(qe.e/c)-v($e.e/c),Ae=Ae/c|0),Ze=0;ke[Ze]==(je[Ze]||0);Ze++);if(ke[Ze]>(je[Ze]||0)&&nt--,Ae<0)F.push(1),at=!0;else{for(ae=je.length,me=ke.length,Ze=0,Ae+=2,St=o(Ve/(ke[0]+1)),St>1&&(ke=le(ke,St,Ve),je=le(je,St,Ve),me=ke.length,ae=je.length),Le=me,b=je.slice(0,me),ce=b.length;ce<me;b[ce++]=0);he=ke.slice(),he=[0].concat(he),re=ke[0],ke[1]>=Ve/2&&re++;do{if(St=0,Qe=ge(ke,b,me,ce),Qe<0){if(Fe=b[0],me!=ce&&(Fe=Fe*Ve+(b[1]||0)),St=o(Fe/re),St>1)for(St>=Ve&&(St=Ve-1),bt=le(ke,St,Ve),q=bt.length,ce=b.length;ge(bt,b,q,ce)==1;)St--,we(bt,me<q?he:ke,q,Ve),q=bt.length,Qe=1;else St==0&&(Qe=St=1),bt=ke.slice(),q=bt.length;if(q<ce&&(bt=[0].concat(bt)),we(b,bt,ce,Ve),ce=b.length,Qe==-1)for(;ge(ke,b,me,ce)<1;)St++,we(b,me<ce?he:ke,ce,Ve),ce=b.length}else Qe===0&&(St++,b=[0]);F[Ze++]=St,b[0]?b[ce++]=je[Le]||0:(b=[je[Le]],ce=1)}while((Le++<ae||b[0]!=null)&&Ae--);at=b[0]!=null,F[0]||F.splice(0,1)}if(Ve==u){for(Ze=1,Ae=F[0];Ae>=10;Ae/=10,Ze++);Ie(X,ze+(X.e=Ze+nt*c-1)+1,it,at)}else X.e=nt,X.r=+at;return X}}();function Ne(le,ge,we,qe){var $e,ze,it,Ve,Qe;if(we==null?we=de:R(we,0,8),!le.c)return le.toString();if($e=le.c[0],it=le.e,ge==null)Qe=_(le.c),Qe=qe==1||qe==2&&(it<=Se||it>=Me)?N(Qe,it):G(Qe,it,"0");else if(le=Ie(new ue(le),ge,we),ze=le.e,Qe=_(le.c),Ve=Qe.length,qe==1||qe==2&&(ge<=ze||ze<=Se)){for(;Ve<ge;Qe+="0",Ve++);Qe=N(Qe,ze)}else if(ge-=it,Qe=G(Qe,ze,"0"),ze+1>Ve){if(--ge>0)for(Qe+=".";ge--;Qe+="0");}else if(ge+=ze-Ve,ge>0)for(ze+1==Ve&&(Qe+=".");ge--;Qe+="0");return le.s<0&&$e?"-"+Qe:Qe}function Ge(le,ge){for(var we,qe,$e=1,ze=new ue(le[0]);$e<le.length;$e++)qe=new ue(le[$e]),(!qe.s||(we=T(ze,qe))===ge||we===0&&ze.s===ge)&&(ze=qe);return ze}function Ue(le,ge,we){for(var qe=1,$e=ge.length;!ge[--$e];ge.pop());for($e=ge[0];$e>=10;$e/=10,qe++);return(we=qe+we*c-1)>_e?le.c=le.e=null:we<Pe?le.c=[le.e=0]:(le.e=we,le.c=ge),le}ne=function(){var le=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ge=/^([^.]+)\.$/,we=/^\.([^.]+)$/,qe=/^-?(Infinity|NaN)$/,$e=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(ze,it,Ve,Qe){var nt,Ze=Ve?it:it.replace($e,"");if(qe.test(Ze))ze.s=isNaN(Ze)?null:Ze<0?-1:1;else{if(!Ve&&(Ze=Ze.replace(le,function(at,St,bt){return nt=(bt=bt.toLowerCase())=="x"?16:bt=="b"?2:8,!Qe||Qe==nt?St:at}),Qe&&(nt=Qe,Ze=Ze.replace(ge,"$1").replace(we,"0.$1")),it!=Ze))return new ue(Ze,nt);if(ue.DEBUG)throw Error(a+"Not a"+(Qe?" base "+Qe:"")+" number: "+it);ze.s=null}ze.c=ze.e=null}}();function Ie(le,ge,we,qe){var $e,ze,it,Ve,Qe,nt,Ze,at=le.c,St=f;if(at){e:{for($e=1,Ve=at[0];Ve>=10;Ve/=10,$e++);if(ze=ge-$e,ze<0)ze+=c,it=ge,Qe=at[nt=0],Ze=o(Qe/St[$e-it-1]%10);else if(nt=s((ze+1)/c),nt>=at.length)if(qe){for(;at.length<=nt;at.push(0));Qe=Ze=0,$e=1,ze%=c,it=ze-c+1}else break e;else{for(Qe=Ve=at[nt],$e=1;Ve>=10;Ve/=10,$e++);ze%=c,it=ze-c+$e,Ze=it<0?0:o(Qe/St[$e-it-1]%10)}if(qe=qe||ge<0||at[nt+1]!=null||(it<0?Qe:Qe%St[$e-it-1]),qe=we<4?(Ze||qe)&&(we==0||we==(le.s<0?3:2)):Ze>5||Ze==5&&(we==4||qe||we==6&&(ze>0?it>0?Qe/St[$e-it]:0:at[nt-1])%10&1||we==(le.s<0?8:7)),ge<1||!at[0])return at.length=0,qe?(ge-=le.e+1,at[0]=St[(c-ge%c)%c],le.e=-ge||0):at[0]=le.e=0,le;if(ze==0?(at.length=nt,Ve=1,nt--):(at.length=nt+1,Ve=St[c-ze],at[nt]=it>0?o(Qe/St[$e-it]%St[it])*Ve:0),qe)for(;;)if(nt==0){for(ze=1,it=at[0];it>=10;it/=10,ze++);for(it=at[0]+=Ve,Ve=1;it>=10;it/=10,Ve++);ze!=Ve&&(le.e++,at[0]==u&&(at[0]=1));break}else{if(at[nt]+=Ve,at[nt]!=u)break;at[nt--]=0,Ve=1}for(ze=at.length;at[--ze]===0;at.pop());}le.e>_e?le.c=le.e=null:le.e<Pe&&(le.c=[le.e=0])}return le}function Ke(le){var ge,we=le.e;return we===null?le.toString():(ge=_(le.c),ge=we<=Se||we>=Me?N(ge,we):G(ge,we,"0"),le.s<0?"-"+ge:ge)}return Z.absoluteValue=Z.abs=function(){var le=new ue(this);return le.s<0&&(le.s=1),le},Z.comparedTo=function(le,ge){return T(this,new ue(le,ge))},Z.decimalPlaces=Z.dp=function(le,ge){var we,qe,$e,ze=this;if(le!=null)return R(le,0,m),ge==null?ge=de:R(ge,0,8),Ie(new ue(ze),le+ze.e+1,ge);if(!(we=ze.c))return null;if(qe=(($e=we.length-1)-v(this.e/c))*c,$e=we[$e])for(;$e%10==0;$e/=10,qe--);return qe<0&&(qe=0),qe},Z.dividedBy=Z.div=function(le,ge){return k(this,new ue(le,ge),xe,de)},Z.dividedToIntegerBy=Z.idiv=function(le,ge){return k(this,new ue(le,ge),0,1)},Z.exponentiatedBy=Z.pow=function(le,ge){var we,qe,$e,ze,it,Ve,Qe,nt,Ze,at=this;if(le=new ue(le),le.c&&!le.isInteger())throw Error(a+"Exponent not an integer: "+Ke(le));if(ge!=null&&(ge=new ue(ge)),Ve=le.e>14,!at.c||!at.c[0]||at.c[0]==1&&!at.e&&at.c.length==1||!le.c||!le.c[0])return Ze=new ue(Math.pow(+Ke(at),Ve?le.s*(2-O(le)):+Ke(le))),ge?Ze.mod(ge):Ze;if(Qe=le.s<0,ge){if(ge.c?!ge.c[0]:!ge.s)return new ue(NaN);qe=!Qe&&at.isInteger()&&ge.isInteger(),qe&&(at=at.mod(ge))}else{if(le.e>9&&(at.e>0||at.e<-1||(at.e==0?at.c[0]>1||Ve&&at.c[1]>=24e7:at.c[0]<8e13||Ve&&at.c[0]<=9999975e7)))return ze=at.s<0&&O(le)?-0:0,at.e>-1&&(ze=1/ze),new ue(Qe?1/ze:ze);rt&&(ze=s(rt/c+2))}for(Ve?(we=new ue(.5),Qe&&(le.s=1),nt=O(le)):($e=Math.abs(+Ke(le)),nt=$e%2),Ze=new ue(ve);;){if(nt){if(Ze=Ze.times(at),!Ze.c)break;ze?Ze.c.length>ze&&(Ze.c.length=ze):qe&&(Ze=Ze.mod(ge))}if($e){if($e=o($e/2),$e===0)break;nt=$e%2}else if(le=le.times(we),Ie(le,le.e+1,1),le.e>14)nt=O(le);else{if($e=+Ke(le),$e===0)break;nt=$e%2}at=at.times(at),ze?at.c&&at.c.length>ze&&(at.c.length=ze):qe&&(at=at.mod(ge))}return qe?Ze:(Qe&&(Ze=ve.div(Ze)),ge?Ze.mod(ge):ze?Ie(Ze,rt,de,it):Ze)},Z.integerValue=function(le){var ge=new ue(this);return le==null?le=de:R(le,0,8),Ie(ge,ge.e+1,le)},Z.isEqualTo=Z.eq=function(le,ge){return T(this,new ue(le,ge))===0},Z.isFinite=function(){return!!this.c},Z.isGreaterThan=Z.gt=function(le,ge){return T(this,new ue(le,ge))>0},Z.isGreaterThanOrEqualTo=Z.gte=function(le,ge){return(ge=T(this,new ue(le,ge)))===1||ge===0},Z.isInteger=function(){return!!this.c&&v(this.e/c)>this.c.length-2},Z.isLessThan=Z.lt=function(le,ge){return T(this,new ue(le,ge))<0},Z.isLessThanOrEqualTo=Z.lte=function(le,ge){return(ge=T(this,new ue(le,ge)))===-1||ge===0},Z.isNaN=function(){return!this.s},Z.isNegative=function(){return this.s<0},Z.isPositive=function(){return this.s>0},Z.isZero=function(){return!!this.c&&this.c[0]==0},Z.minus=function(le,ge){var we,qe,$e,ze,it=this,Ve=it.s;if(le=new ue(le,ge),ge=le.s,!Ve||!ge)return new ue(NaN);if(Ve!=ge)return le.s=-ge,it.plus(le);var Qe=it.e/c,nt=le.e/c,Ze=it.c,at=le.c;if(!Qe||!nt){if(!Ze||!at)return Ze?(le.s=-ge,le):new ue(at?it:NaN);if(!Ze[0]||!at[0])return at[0]?(le.s=-ge,le):new ue(Ze[0]?it:de==3?-0:0)}if(Qe=v(Qe),nt=v(nt),Ze=Ze.slice(),Ve=Qe-nt){for((ze=Ve<0)?(Ve=-Ve,$e=Ze):(nt=Qe,$e=at),$e.reverse(),ge=Ve;ge--;$e.push(0));$e.reverse()}else for(qe=(ze=(Ve=Ze.length)<(ge=at.length))?Ve:ge,Ve=ge=0;ge<qe;ge++)if(Ze[ge]!=at[ge]){ze=Ze[ge]<at[ge];break}if(ze&&($e=Ze,Ze=at,at=$e,le.s=-le.s),ge=(qe=at.length)-(we=Ze.length),ge>0)for(;ge--;Ze[we++]=0);for(ge=u-1;qe>Ve;){if(Ze[--qe]<at[qe]){for(we=qe;we&&!Ze[--we];Ze[we]=ge);--Ze[we],Ze[qe]+=u}Ze[qe]-=at[qe]}for(;Ze[0]==0;Ze.splice(0,1),--nt);return Ze[0]?Ue(le,Ze,nt):(le.s=de==3?-1:1,le.c=[le.e=0],le)},Z.modulo=Z.mod=function(le,ge){var we,qe,$e=this;return le=new ue(le,ge),!$e.c||!le.s||le.c&&!le.c[0]?new ue(NaN):!le.c||$e.c&&!$e.c[0]?new ue($e):(st==9?(qe=le.s,le.s=1,we=k($e,le,0,3),le.s=qe,we.s*=qe):we=k($e,le,0,st),le=$e.minus(we.times(le)),!le.c[0]&&st==1&&(le.s=$e.s),le)},Z.multipliedBy=Z.times=function(le,ge){var we,qe,$e,ze,it,Ve,Qe,nt,Ze,at,St,bt,q,X,F,b=this,ce=b.c,Fe=(le=new ue(le,ge)).c;if(!ce||!Fe||!ce[0]||!Fe[0])return!b.s||!le.s||ce&&!ce[0]&&!Fe||Fe&&!Fe[0]&&!ce?le.c=le.e=le.s=null:(le.s*=b.s,!ce||!Fe?le.c=le.e=null:(le.c=[0],le.e=0)),le;for(qe=v(b.e/c)+v(le.e/c),le.s*=b.s,Qe=ce.length,at=Fe.length,Qe<at&&(q=ce,ce=Fe,Fe=q,$e=Qe,Qe=at,at=$e),$e=Qe+at,q=[];$e--;q.push(0));for(X=u,F=C,$e=at;--$e>=0;){for(we=0,St=Fe[$e]%F,bt=Fe[$e]/F|0,it=Qe,ze=$e+it;ze>$e;)nt=ce[--it]%F,Ze=ce[it]/F|0,Ve=bt*nt+Ze*St,nt=St*nt+Ve%F*F+q[ze]+we,we=(nt/X|0)+(Ve/F|0)+bt*Ze,q[ze--]=nt%X;q[ze]=we}return we?++qe:q.splice(0,1),Ue(le,q,qe)},Z.negated=function(){var le=new ue(this);return le.s=-le.s||null,le},Z.plus=function(le,ge){var we,qe=this,$e=qe.s;if(le=new ue(le,ge),ge=le.s,!$e||!ge)return new ue(NaN);if($e!=ge)return le.s=-ge,qe.minus(le);var ze=qe.e/c,it=le.e/c,Ve=qe.c,Qe=le.c;if(!ze||!it){if(!Ve||!Qe)return new ue($e/0);if(!Ve[0]||!Qe[0])return Qe[0]?le:new ue(Ve[0]?qe:$e*0)}if(ze=v(ze),it=v(it),Ve=Ve.slice(),$e=ze-it){for($e>0?(it=ze,we=Qe):($e=-$e,we=Ve),we.reverse();$e--;we.push(0));we.reverse()}for($e=Ve.length,ge=Qe.length,$e-ge<0&&(we=Qe,Qe=Ve,Ve=we,ge=$e),$e=0;ge;)$e=(Ve[--ge]=Ve[ge]+Qe[ge]+$e)/u|0,Ve[ge]=u===Ve[ge]?0:Ve[ge]%u;return $e&&(Ve=[$e].concat(Ve),++it),Ue(le,Ve,it)},Z.precision=Z.sd=function(le,ge){var we,qe,$e,ze=this;if(le!=null&&le!==!!le)return R(le,1,m),ge==null?ge=de:R(ge,0,8),Ie(new ue(ze),le,ge);if(!(we=ze.c))return null;if($e=we.length-1,qe=$e*c+1,$e=we[$e]){for(;$e%10==0;$e/=10,qe--);for($e=we[0];$e>=10;$e/=10,qe++);}return le&&ze.e+1>qe&&(qe=ze.e+1),qe},Z.shiftedBy=function(le){return R(le,-9007199254740991,d),this.times("1e"+le)},Z.squareRoot=Z.sqrt=function(){var le,ge,we,qe,$e,ze=this,it=ze.c,Ve=ze.s,Qe=ze.e,nt=xe+4,Ze=new ue("0.5");if(Ve!==1||!it||!it[0])return new ue(!Ve||Ve<0&&(!it||it[0])?NaN:it?ze:1/0);if(Ve=Math.sqrt(+Ke(ze)),Ve==0||Ve==1/0?(ge=_(it),(ge.length+Qe)%2==0&&(ge+="0"),Ve=Math.sqrt(+ge),Qe=v((Qe+1)/2)-(Qe<0||Qe%2),Ve==1/0?ge="5e"+Qe:(ge=Ve.toExponential(),ge=ge.slice(0,ge.indexOf("e")+1)+Qe),we=new ue(ge)):we=new ue(Ve+""),we.c[0]){for(Qe=we.e,Ve=Qe+nt,Ve<3&&(Ve=0);;)if($e=we,we=Ze.times($e.plus(k(ze,$e,nt,1))),_($e.c).slice(0,Ve)===(ge=_(we.c)).slice(0,Ve))if(we.e<Qe&&--Ve,ge=ge.slice(Ve-3,Ve+1),ge=="9999"||!qe&&ge=="4999"){if(!qe&&(Ie($e,$e.e+xe+2,0),$e.times($e).eq(ze))){we=$e;break}nt+=4,Ve+=4,qe=1}else{(!+ge||!+ge.slice(1)&&ge.charAt(0)=="5")&&(Ie(we,we.e+xe+2,1),le=!we.times(we).eq(ze));break}}return Ie(we,we.e+xe+1,de,le)},Z.toExponential=function(le,ge){return le!=null&&(R(le,0,m),le++),Ne(this,le,ge,1)},Z.toFixed=function(le,ge){return le!=null&&(R(le,0,m),le=le+this.e+1),Ne(this,le,ge)},Z.toFormat=function(le,ge,we){var qe,$e=this;if(we==null)le!=null&&ge&&typeof ge=="object"?(we=ge,ge=null):le&&typeof le=="object"?(we=le,le=ge=null):we=U;else if(typeof we!="object")throw Error(a+"Argument not an object: "+we);if(qe=$e.toFixed(le,ge),$e.c){var ze,it=qe.split("."),Ve=+we.groupSize,Qe=+we.secondaryGroupSize,nt=we.groupSeparator||"",Ze=it[0],at=it[1],St=$e.s<0,bt=St?Ze.slice(1):Ze,q=bt.length;if(Qe&&(ze=Ve,Ve=Qe,Qe=ze,q-=ze),Ve>0&&q>0){for(ze=q%Ve||Ve,Ze=bt.substr(0,ze);ze<q;ze+=Ve)Ze+=nt+bt.substr(ze,Ve);Qe>0&&(Ze+=nt+bt.slice(ze)),St&&(Ze="-"+Ze)}qe=at?Ze+(we.decimalSeparator||"")+((Qe=+we.fractionGroupSize)?at.replace(new RegExp("\\d{"+Qe+"}\\B","g"),"$&"+(we.fractionGroupSeparator||"")):at):Ze}return(we.prefix||"")+qe+(we.suffix||"")},Z.toFraction=function(le){var ge,we,qe,$e,ze,it,Ve,Qe,nt,Ze,at,St,bt=this,q=bt.c;if(le!=null&&(Ve=new ue(le),!Ve.isInteger()&&(Ve.c||Ve.s!==1)||Ve.lt(ve)))throw Error(a+"Argument "+(Ve.isInteger()?"out of range: ":"not an integer: ")+Ke(Ve));if(!q)return new ue(bt);for(ge=new ue(ve),nt=we=new ue(ve),qe=Qe=new ue(ve),St=_(q),ze=ge.e=St.length-bt.e-1,ge.c[0]=f[(it=ze%c)<0?c+it:it],le=!le||Ve.comparedTo(ge)>0?ze>0?ge:nt:Ve,it=_e,_e=1/0,Ve=new ue(St),Qe.c[0]=0;Ze=k(Ve,ge,0,1),$e=we.plus(Ze.times(qe)),$e.comparedTo(le)!=1;)we=qe,qe=$e,nt=Qe.plus(Ze.times($e=nt)),Qe=$e,ge=Ve.minus(Ze.times($e=ge)),Ve=$e;return $e=k(le.minus(we),qe,0,1),Qe=Qe.plus($e.times(nt)),we=we.plus($e.times(qe)),Qe.s=nt.s=bt.s,ze=ze*2,at=k(nt,qe,ze,de).minus(bt).abs().comparedTo(k(Qe,we,ze,de).minus(bt).abs())<1?[nt,qe]:[Qe,we],_e=it,at},Z.toNumber=function(){return+Ke(this)},Z.toPrecision=function(le,ge){return le!=null&&R(le,1,m),Ne(this,le,ge,2)},Z.toString=function(le){var ge,we=this,qe=we.s,$e=we.e;return $e===null?qe?(ge="Infinity",qe<0&&(ge="-"+ge)):ge="NaN":(le==null?ge=$e<=Se||$e>=Me?N(_(we.c),$e):G(_(we.c),$e,"0"):le===10&&V?(we=Ie(new ue(we),xe+$e+1,de),ge=G(_(we.c),we.e,"0")):(R(le,2,te.length,"Base"),ge=z(G(_(we.c),$e,"0"),10,le,qe,!0)),qe<0&&we.c[0]&&(ge="-"+ge)),ge},Z.valueOf=Z.toJSON=function(){return Ke(this)},Z._isBigNumber=!0,D!=null&&ue.set(D),ue}function v(D){var k=D|0;return D>0||D===k?k:k-1}function _(D){for(var k,z,ne=1,Z=D.length,ve=D[0]+"";ne<Z;){for(k=D[ne++]+"",z=c-k.length;z--;k="0"+k);ve+=k}for(Z=ve.length;ve.charCodeAt(--Z)===48;);return ve.slice(0,Z+1||1)}function T(D,k){var z,ne,Z=D.c,ve=k.c,xe=D.s,de=k.s,Se=D.e,Me=k.e;if(!xe||!de)return null;if(z=Z&&!Z[0],ne=ve&&!ve[0],z||ne)return z?ne?0:-de:xe;if(xe!=de)return xe;if(z=xe<0,ne=Se==Me,!Z||!ve)return ne?0:!Z^z?1:-1;if(!ne)return Se>Me^z?1:-1;for(de=(Se=Z.length)<(Me=ve.length)?Se:Me,xe=0;xe<de;xe++)if(Z[xe]!=ve[xe])return Z[xe]>ve[xe]^z?1:-1;return Se==Me?0:Se>Me^z?1:-1}function R(D,k,z,ne){if(D<k||D>z||D!==o(D))throw Error(a+(ne||"Argument")+(typeof D=="number"?D<k||D>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(D))}function O(D){var k=D.c.length-1;return v(D.e/c)==k&&D.c[k]%2!=0}function N(D,k){return(D.length>1?D.charAt(0)+"."+D.slice(1):D)+(k<0?"e":"e+")+k}function G(D,k,z){var ne,Z;if(k<0){for(Z=z+".";++k;Z+=z);D=Z+D}else if(ne=D.length,++k>ne){for(Z=z,k-=ne;--k;Z+=z);D+=Z}else k<ne&&(D=D.slice(0,k)+"."+D.slice(k));return D}t=E(),t.default=t.BigNumber=t,r.exports?r.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(commonjsGlobal)})(bignumber);var bignumberExports=bignumber.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const globalState$1=requireGlobalState(),validating=requireValidating(),parsing$1=parsing$2,BigNumber$1=bignumberExports,powers={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},defaultOptions={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes,decimalSuffixes}=globalState$1.currentBytes(),bytes={general:{scale:1024,suffixes:decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:decimalSuffixes,marker:"d"}};function format$1(r,e={},t){if(typeof e=="string"&&(e=parsing$1.parseFormat(e)),!validating.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",o=e.postfix||"",a=formatNumbro(r,e,t);return a=insertPrefix(a,s),a=insertPostfix(a,o),a}function formatNumbro(r,e,t){switch(e.output){case"currency":return e=formatOrDefault(e,globalState$1.currentCurrencyDefaultFormat()),formatCurrency(r,e,globalState$1);case"percent":return e=formatOrDefault(e,globalState$1.currentPercentageDefaultFormat()),formatPercentage(r,e,globalState$1,t);case"byte":return e=formatOrDefault(e,globalState$1.currentByteDefaultFormat()),formatByte(r,e,globalState$1,t);case"time":return e=formatOrDefault(e,globalState$1.currentTimeDefaultFormat()),formatTime(r);case"ordinal":return e=formatOrDefault(e,globalState$1.currentOrdinalDefaultFormat()),formatOrdinal(r,e,globalState$1);case"number":default:return formatNumber$1({instance:r,providedFormat:e,numbro:t})}}function getDecimalByteUnit(r){let e=bytes.decimal;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getBinaryByteUnit(r){let e=bytes.binary;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getByteUnit(r){let e=bytes.general;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getFormatByteUnits(r,e,t){let n=e[0],s=Math.abs(r);if(s>=t){for(let o=1;o<e.length;++o){let a=Math.pow(t,o),l=Math.pow(t,o+1);if(s>=a&&s<l){n=e[o],r=r/a;break}}n===e[0]&&(r=r/Math.pow(t,e.length-1),n=e[e.length-1])}return{value:r,suffix:n}}function formatByte(r,e,t,n){let s=e.base||"binary",o=Object.assign({},defaultOptions,e);const{binarySuffixes:a,decimalSuffixes:l}=t.currentBytes();let c={general:{scale:1024,suffixes:l||decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:a||binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:l||decimalSuffixes,marker:"d"}}[s],{value:d,suffix:f}=getFormatByteUnits(r._value,c.suffixes,c.scale);return`${formatNumber$1({instance:n(d),providedFormat:e,state:t,defaults:t.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${f}`}function formatOrdinal(r,e,t){let n=t.currentOrdinal(),s=Object.assign({},defaultOptions,e),o=formatNumber$1({instance:r,providedFormat:e,state:t}),a=n(r._value);return`${o}${s.spaceSeparated?" ":""}${a}`}function formatTime(r){let e=Math.floor(r._value/60/60),t=Math.floor((r._value-e*60*60)/60),n=Math.round(r._value-e*60*60-t*60);return`${e}:${t<10?"0":""}${t}:${n<10?"0":""}${n}`}function formatPercentage(r,e,t,n){let s=e.prefixSymbol,o=formatNumber$1({instance:n(r._value*100),providedFormat:e,state:t}),a=Object.assign({},defaultOptions,e);return s?`%${a.spaceSeparated?" ":""}${o}`:`${o}${a.spaceSeparated?" ":""}%`}function formatCurrency(r,e,t){const n=t.currentCurrency();let s=Object.assign({},e),o=Object.assign({},defaultOptions,s),a,l="",u=!!o.totalLength||!!o.forceAverage||o.average,c=s.currencyPosition||n.position,d=s.currencySymbol||n.symbol;const f=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),f&&(l=" "),c==="infix"&&(a=l+d+l);let C=formatNumber$1({instance:r,providedFormat:s,state:t,decimalSeparator:a});return c==="prefix"&&(r._value<0&&o.negative==="sign"?C=`-${l}${d}${C.slice(1)}`:r._value>0&&o.forceSign?C=`+${l}${d}${C.slice(1)}`:C=d+l+C),(!c||c==="postfix")&&(l=!o.spaceSeparatedAbbreviation&&u?"":l,C=C+l+d),C}function computeAverage({value:r,forceAverage:e,lowPrecision:t=!0,abbreviations:n,spaceSeparated:s=!1,totalLength:o=0,roundingFunction:a=Math.round}){let l="",u=Math.abs(r),c=-1;if(e&&n[e]&&powers[e]?(l=n[e],r=r/powers[e]):u>=powers.trillion||t&&a(u/powers.trillion)===1?(l=n.trillion,r=r/powers.trillion):u<powers.trillion&&u>=powers.billion||t&&a(u/powers.billion)===1?(l=n.billion,r=r/powers.billion):u<powers.billion&&u>=powers.million||t&&a(u/powers.million)===1?(l=n.million,r=r/powers.million):(u<powers.million&&u>=powers.thousand||t&&a(u/powers.thousand)===1)&&(l=n.thousand,r=r/powers.thousand),l&&(l=(s?" ":"")+l),o){let f=r<0,C=r.toString().split(".")[0],m=f?C.length-1:C.length;c=Math.max(o-m,0)}return{value:r,abbreviation:l,mantissaPrecision:c}}function computeExponential({value:r,characteristicPrecision:e}){let[t,n]=r.toExponential().split("e"),s=+t;if(!e)return{value:s,abbreviation:`e${n}`};let o=1;return o<e&&(s=s*Math.pow(10,e-o),n=+n-(e-o),n=n>=0?`+${n}`:n),{value:s,abbreviation:`e${n}`}}function zeroes(r){let e="";for(let t=0;t<r;t++)e+="0";return e}function toFixedLarge(r,e){let t=r.toString(),[n,s]=t.split("e"),[o,a=""]=n.split(".");if(+s>0)t=o+a+zeroes(s-a.length);else{let l=".";+o<0?l=`-0${l}`:l=`0${l}`;let u=(zeroes(-s-1)+Math.abs(o)+a).substr(0,e);u.length<e&&(u+=zeroes(e-u.length)),t=l+u}return+s>0&&e>0&&(t+=`.${zeroes(e)}`),t}function toFixed(r,e,t=Math.round){return r.toString().indexOf("e")!==-1?toFixedLarge(r,e):new BigNumber$1(t(+`${r}e+${e}`)/Math.pow(10,e)).toFixed(e)}function setMantissaPrecision(r,e,t,n,s,o){if(n===-1)return r;let a=toFixed(e,n,o),[l,u=""]=a.toString().split(".");if(u.match(/^0+$/)&&(t||s))return l;let c=u.match(/0+$/);return s&&c?`${l}.${u.toString().slice(0,c.index)}`:a.toString()}function setCharacteristicPrecision(r,e,t,n){let s=r,[o,a]=s.toString().split(".");if(o.match(/^-?0$/)&&t)return a?`${o.replace("0","")}.${a}`:o.replace("0","");const l=e<0&&o.indexOf("-")===0;if(l&&(o=o.slice(1),s=s.slice(1)),o.length<n){let u=n-o.length;for(let c=0;c<u;c++)s=`0${s}`}return l&&(s=`-${s}`),s.toString()}function indexesOfGroupSpaces(r,e){let t=[],n=0;for(let s=r;s>0;s--)n===e&&(t.unshift(s),n=0),n++;return t}function replaceDelimiters(r,e,t,n,s){let o=n.currentDelimiters(),a=o.thousands;s=s||o.decimal;let l=o.thousandsSize||3,u=r.toString(),c=u.split(".")[0],d=u.split(".")[1];const f=e<0&&c.indexOf("-")===0;return t&&(f&&(c=c.slice(1)),indexesOfGroupSpaces(c.length,l).forEach((m,E)=>{c=c.slice(0,m+E)+a+c.slice(m+E)}),f&&(c=`-${c}`)),d?u=c+s+d:u=c,u}function insertAbbreviation(r,e){return r+e}function insertSign(r,e,t){return e===0?r:+r==0?r.replace("-",""):e>0?`+${r}`:t==="sign"?r:`(${r.replace("-","")})`}function insertPrefix(r,e){return e+r}function insertPostfix(r,e){return r+e}function formatNumber$1({instance:r,providedFormat:e,state:t=globalState$1,decimalSeparator:n,defaults:s=t.currentDefaults()}){let o=r._value;if(o===0&&t.hasZeroFormat())return t.getZeroFormat();if(!isFinite(o))return o.toString();let a=Object.assign({},defaultOptions,s,e),l=a.totalLength,u=l?0:a.characteristic,c=a.optionalCharacteristic,d=a.forceAverage,f=a.lowPrecision,C=!!l||!!d||a.average,m=l?-1:C&&e.mantissa===void 0?0:a.mantissa,E=l?!1:e.optionalMantissa===void 0?m===-1:a.optionalMantissa,v=a.trimMantissa,_=a.thousandSeparated,T=a.spaceSeparated,R=a.negative,O=a.forceSign,N=a.exponential,G=a.roundingFunction,D="";if(C){let z=computeAverage({value:o,forceAverage:d,lowPrecision:f,abbreviations:t.currentAbbreviations(),spaceSeparated:T,roundingFunction:G,totalLength:l});o=z.value,D+=z.abbreviation,l&&(m=z.mantissaPrecision)}if(N){let z=computeExponential({value:o,characteristicPrecision:u});o=z.value,D=z.abbreviation+D}let k=setMantissaPrecision(o.toString(),o,E,m,v,G);return k=setCharacteristicPrecision(k,o,c,u),k=replaceDelimiters(k,o,_,t,n),(C||N)&&(k=insertAbbreviation(k,D)),(O||o<0)&&(k=insertSign(k,o,R)),k}function formatOrDefault(r,e){if(!r)return e;let t=Object.keys(r);return t.length===1&&t[0]==="output"?e:r}var formatting=r=>({format:(...e)=>format$1(...e,r),getByteUnit:(...e)=>getByteUnit(...e,r),getBinaryByteUnit:(...e)=>getBinaryByteUnit(...e,r),getDecimalByteUnit:(...e)=>getDecimalByteUnit(...e,r),formatOrDefault});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const BigNumber=bignumberExports;function add$1(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.plus(s).toNumber(),r}function subtract(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.minus(s).toNumber(),r}function multiply(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.times(s).toNumber(),r}function divide(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.dividedBy(s).toNumber(),r}function set(r,e,t){let n=e;return t.isNumbro(e)&&(n=e._value),r._value=n,r}function difference$1(r,e,t){let n=t(r._value);return subtract(n,e,t),Math.abs(n._value)}var manipulating=r=>({add:(e,t)=>add$1(e,t,r),subtract:(e,t)=>subtract(e,t,r),multiply:(e,t)=>multiply(e,t,r),divide:(e,t)=>divide(e,t,r),set:(e,t)=>set(e,t,r),difference:(e,t)=>difference$1(e,t,r),BigNumber});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const VERSION="2.5.0",globalState=requireGlobalState(),validator=requireValidating(),loader=loading(numbro),unformatter=requireUnformatting();let formatter=formatting(numbro),manipulate=manipulating(numbro);const parsing=parsing$2;class Numbro{constructor(e){this._value=e}clone(){return numbro(this._value)}format(e={}){return formatter.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=parsing.parseFormat(e)),e=formatter.formatOrDefault(e,globalState.currentCurrencyDefaultFormat()),e.output="currency",formatter.format(this,e)}formatTime(e={}){return e.output="time",formatter.format(this,e)}binaryByteUnits(){return formatter.getBinaryByteUnit(this)}decimalByteUnits(){return formatter.getDecimalByteUnit(this)}byteUnits(){return formatter.getByteUnit(this)}difference(e){return manipulate.difference(this,e)}add(e){return manipulate.add(this,e)}subtract(e){return manipulate.subtract(this,e)}multiply(e){return manipulate.multiply(this,e)}divide(e){return manipulate.divide(this,e)}set(e){return manipulate.set(this,normalizeInput(e))}value(){return this._value}valueOf(){return this._value}}function normalizeInput(r){let e=r;return numbro.isNumbro(r)?e=r._value:typeof r=="string"?e=numbro.unformat(r):isNaN(r)&&(e=NaN),e}function numbro(r){return new Numbro(normalizeInput(r))}numbro.version=VERSION;numbro.isNumbro=function(r){return r instanceof Numbro};numbro.language=globalState.currentLanguage;numbro.registerLanguage=globalState.registerLanguage;numbro.setLanguage=globalState.setLanguage;numbro.languages=globalState.languages;numbro.languageData=globalState.languageData;numbro.zeroFormat=globalState.setZeroFormat;numbro.defaultFormat=globalState.currentDefaults;numbro.setDefaults=globalState.setDefaults;numbro.defaultCurrencyFormat=globalState.currentCurrencyDefaultFormat;numbro.validate=validator.validate;numbro.loadLanguagesInNode=loader.loadLanguagesInNode;numbro.unformat=unformatter.unformat;numbro.BigNumber=manipulate.BigNumber;var numbro_1=numbro,numbro$1=getDefaultExportFromCjs$2(numbro_1);const RENDERER_TYPE$4="numeric";function getRenderedValue(r,e){if(isNumeric(r)){const t=e.numericFormat,n=t&&t.culture||"-",s=t&&t.pattern;if(typeof n<"u"&&!numbro$1.languages()[n]){const o=n.replace("-",""),a=numbro$1.allLanguages?numbro$1.allLanguages[n]:numbro$1[o];a&&numbro$1.registerLanguage(a)}numbro$1.setLanguage(n),r=numbro$1(r).format(s||"0")}return r}function numericRenderer(r,e,t,n,s,o,a){let l=o;if(isNumeric(l)){const u=a.className||"",c=u.length?u.split(" "):[];l=getRenderedValue(l,a),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),a.className=c.join(" "),e.dir="ltr"}textRenderer(r,e,t,n,s,l,a)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$4;const RENDERER_TYPE$3="password";function passwordRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a]);const l=a.hashLength||e.innerHTML.length,u=a.hashSymbol||"*";let c="";rangeEach(l-1,()=>{c+=u}),fastInnerHTML(e,c)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$3;const RENDERER_TYPE$2="select";function selectRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE$2;const RENDERER_TYPE$1="time";function timeRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a]),e.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE$1;const{register:register$3,getItem:getItem$2,hasItem:hasItem$2,getNames:getNames$2,getValues:getValues$2}=staticRegister("renderers");function _getItem$2(r){if(typeof r=="function")return r;if(!hasItem$2(r))throw Error(`No registered renderer found under "${r}" name`);return getItem$2(r)}function _register$2(r,e){typeof r!="string"&&(e=r,r=e.RENDERER_TYPE),register$3(r,e)}function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(dropdownRenderer),_register$2(handsontableRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(selectRenderer),_register$2(textRenderer),_register$2(timeRenderer)}const VALIDATOR_TYPE$4="autocomplete";function autocompleteValidator(r,e){let t=r;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,process(t,e)):process(t,e)(this.source):e(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$4;function process(r,e){const t=r;return function(n){let s=!1;for(let o=0,a=n.length;o<a;o++)if(t===n[o]){s=!0;break}e(s)}}function getNormalizedDate(r){const e=new Date(r);return isNaN(new Date(`${r}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const VALIDATOR_TYPE$3="date";function dateValidator(r,e){const t=_getEditorInstance(EDITOR_TYPE$5,this.instance);let n=r,s=!0;n==null&&(n="");let o=hooks(n,this.dateFormat||t.defaultDateFormat,!0).isValid(),a=hooks(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(s=!1),!a&&o&&(s=!0),a&&!o)if(this.correctFormat===!0){const l=correctFormat(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,l,"dateValidator"),s=!0}else s=!1;e(s)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function correctFormat(r,e){const t=hooks(getNormalizedDate(r)),n=hooks(r,e),s=r.search(/[A-z]/g)>-1;let o;return t.isValid()&&t.format("x")===n.format("x")||!n.isValid()||s?o=t:o=n,o.format(e)}const VALIDATOR_TYPE$2="dropdown";function dropdownValidator(r,e){autocompleteValidator.apply(this,[r,e])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;const VALIDATOR_TYPE$1="numeric";function numericValidator(r,e){let t=r;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:isNumeric(r))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(r,e){const t=this.timeFormat||"h:mm:ss a";let n=!0,s=r;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const o=/^\d{1,2}$/.test(s);o&&(s+=":00");const a=hooks(s,STRICT_FORMATS,!0).isValid()?hooks(s):hooks(s,t);let l=a.isValid(),u=hooks(s,t,!0).isValid()&&!o;if(this.allowEmpty&&s===""&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(this.correctFormat===!0){const c=a.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;const{register:register$2,getItem:getItem$1,hasItem:hasItem$1,getNames:getNames$1,getValues:getValues$1}=staticRegister("validators");function _getItem$1(r){if(typeof r=="function")return r;if(!hasItem$1(r))throw Error(`No registered validator found under "${r}" name`);return getItem$1(r)}function _register$1(r,e){typeof r!="string"&&(e=r,r=e.VALIDATOR_TYPE),register$2(r,e)}function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dropdownValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}const CELL_TYPE$9="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$9,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$8="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$8,editor:CheckboxEditor,renderer:checkboxRenderer},RENDERER_TYPE="date";function dateRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE;const CELL_TYPE$7="date",DateCellType={CELL_TYPE:CELL_TYPE$7,editor:DateEditor,renderer:dateRenderer,validator:dateValidator},CELL_TYPE$6="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$6,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator},CELL_TYPE$5="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$5,editor:HandsontableEditor,renderer:handsontableRenderer},CELL_TYPE$4="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$4,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE$3="password",PasswordCellType={CELL_TYPE:CELL_TYPE$3,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE$2="select",SelectCellType={CELL_TYPE:CELL_TYPE$2,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE$1="text",TextCellType={CELL_TYPE:CELL_TYPE$1,editor:TextEditor,renderer:textRenderer},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator},{register:register$1,getItem,hasItem,getNames,getValues}=staticRegister("cellTypes");function _getItem(r){if(!hasItem(r))throw Error(`You declared cell type "${r}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem(r)}function _register(r,e){typeof r!="string"&&(e=r,r=e.CELL_TYPE);const{editor:t,renderer:n,validator:s}=e;t&&_register$3(r,t),n&&_register$2(r,n),s&&_register$1(r,s),register$1(r,e)}function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(SelectCellType),_register(TextCellType),_register(TimeCellType)}const ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=r=>`The priority '${r}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=r=>`The priority '${r}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:r,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;r=isFunction$2(r)?r:DEFAULT_ERROR_PRIORITY_EXISTS,e=isFunction$2(e)?e:DEFAULT_ERROR_PRIORITY_NAN;function n(o,a){if(!isNumeric(o))throw new Error(e(o));if(t.has(o))throw new Error(r(o));t.set(o,a)}function s(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[a,l]=ORDER_MAP.get(o)||ORDER_MAP.get(ASC);return[...t].sort((u,c)=>u[0]<c[0]?a:l).map(u=>u[1])}return{addItem:n,getItems:s}}const DEFAULT_ERROR_ID_EXISTS=r=>`The id '${r}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;r=isFunction$2(r)?r:DEFAULT_ERROR_ID_EXISTS;function t(c,d){if(u(c))throw new Error(r(c));e.set(c,d)}function n(c){return e.delete(c)}function s(){e.clear()}function o(c){const[d]=l().find(f=>{let[C,m]=f;return c===m?C:!1})||[null];return d}function a(c){return e.get(c)}function l(){return[...e]}function u(c){return e.has(c)}return{addItem:t,clear:s,getId:o,getItem:a,getItems:l,hasItem:u,removeItem:n}}const DEFAULT_ERROR_ITEM_EXISTS=r=>`'${r}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;r=isFunction$2(r)?r:DEFAULT_ERROR_ITEM_EXISTS;function t(o){if(e.has(o))throw new Error(r(o));e.add(o)}function n(){return[...e]}function s(){e.clear()}return{addItem:t,clear:s,getItems:n}}const ERROR_PLUGIN_REGISTERED=r=>`There is already registered "${r}" plugin.`,ERROR_PRIORITY_REGISTERED=r=>`There is already registered plugin on priority "${r}".`,ERROR_PRIORITY_NAN=r=>`The priority "${r}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(r){const e=toUpperCaseFirst(r);return uniquePluginsList.getItem(e)}function hasPlugin(r){return!!getPlugin(r)}function registerPlugin(r,e,t){[r,e,t]=unifyPluginArguments(r,e,t),getPlugin(r)===void 0&&_registerPlugin(r,e,t)}function _registerPlugin(r,e,t){const n=toUpperCaseFirst(r);if(uniquePluginsList.hasItem(n))throw new Error(ERROR_PLUGIN_REGISTERED(n));t===void 0?uniquePluginsQueue.addItem(n):priorityPluginsQueue.addItem(t,n),uniquePluginsList.addItem(n,e)}function unifyPluginArguments(r,e,t){return typeof r=="function"&&(e=r,r=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[r,e,t]}function _classPrivateMethodInitSpec$P(r,e){_checkPrivateRedeclaration$18(r,e),e.add(r)}function _classPrivateFieldInitSpec$R(r,e,t){_checkPrivateRedeclaration$18(r,e),e.set(r,t)}function _checkPrivateRedeclaration$18(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1Q(r,e,t){return(e=_toPropertyKey$1Q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1Q(r){var e=_toPrimitive$1Q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1Q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$R(r,e){return r.get(_assertClassBrand$18(r,e))}function _assertClassBrand$18(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),defaultMainSettingSymbol=Symbol("mainSetting"),PLUGIN_KEY$y="base",missingDepsMsgs=[];let initializedPlugins=null;var _hooks=new WeakMap,_BasePlugin_brand=new WeakSet;class BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$y}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){_classPrivateMethodInitSpec$P(this,_BasePlugin_brand),_defineProperty$1Q(this,"eventManager",new EventManager(this)),_defineProperty$1Q(this,"pluginName",null),_defineProperty$1Q(this,"pluginsInitializedCallbacks",[]),_defineProperty$1Q(this,"isPluginsReady",!1),_defineProperty$1Q(this,"enabled",!1),_defineProperty$1Q(this,"initialized",!1),_classPrivateFieldInitSpec$R(this,_hooks,{}),defineGetter(this,"hot",e,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const s=[];if(t.forEach(o=>{const[a,l]=o.split(":");if(!DEPS_TYPE_CHECKERS.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);DEPS_TYPE_CHECKERS.get(a)(l)||s.push(` - ${l} (${a})`)}),s.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");missingDepsMsgs.push(o)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf("UndoRedo")>=0&&initializedPlugins.splice(initializedPlugins.indexOf("UndoRedo"),1),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const s=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw missingDepsMsgs.length=0,new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return t;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(t)||isObject$1(t))&&n[defaultMainSettingSymbol]===e){var s;return Array.isArray(t)?t:(s=t[e])!==null&&s!==void 0?s:n[e]}if(isObject$1(t)){var o;return(o=t[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,t,n){_classPrivateFieldGet$R(_hooks,this)[e]=_classPrivateFieldGet$R(_hooks,this)[e]||[];const s=_classPrivateFieldGet$R(_hooks,this)[e];this.hot.addHook(e,t,n),s.push(t),_classPrivateFieldGet$R(_hooks,this)[e]=s}removeHooks(e){arrayEach(_classPrivateFieldGet$R(_hooks,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=_classPrivateFieldGet$R(_hooks,this);objectEach(e,(t,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){arrayEach(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=_assertClassBrand$18(_BasePlugin_brand,this,_isRelevantToSettings).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),objectEach(this,(t,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function _isRelevantToSettings(r){if(!r)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(r[e[t]]!==void 0)return!0;return!1}function _defineProperty$1P(r,e,t){return(e=_toPropertyKey$1P(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1P(r){var e=_toPrimitive$1P(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1P(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}let GhostTable$1=class{constructor(e){_defineProperty$1P(this,"hot",null),_defineProperty$1P(this,"container",null),_defineProperty$1P(this,"injected",!1),_defineProperty$1P(this,"rows",[]),_defineProperty$1P(this,"columns",[]),_defineProperty$1P(this,"samples",null),_defineProperty$1P(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),arrayEach(this.rows,t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),arrayEach(this.columns,t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{arrayEach(n.strings,s=>{t.appendChild(this.createColElement(s.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),n.appendChild(s)),this.samples.forEach(o=>{arrayEach(o.strings,a=>{const l=a.col,u=this.hot.getCellMeta(e,l),c=this.hot.getCellRenderer(u),d=t.createElement("td");d.setAttribute("ghost-table",1),c(this.hot,d,e,l,this.hot.colToProp(l),a.value,u),n.appendChild(d)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");n.push([-1,s]),t.appendChild(s)}this.samples.forEach(s=>{arrayEach(s.strings,o=>{const a=o.col,l=e.createElement("th");n.push([a,l]),t.appendChild(l)})}),this.table.tHead.appendChild(t),arrayEach(n,s=>{const[o,a]=s;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach(s=>{arrayEach(s.strings,o=>{const a=o.row,l=this.hot.getCellMeta(a,e),u=this.hot.getCellRenderer(l),c=t.createElement("td"),d=t.createElement("tr");c.setAttribute("ghost-table",1),u(this.hot,c,a,e,this.hot.colToProp(e),o.value,l),d.appendChild(c),n.appendChild(d)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let s=0;t>=0&&e>=0&&(s=this.hot.getCellMeta(t,e).colspan);let o=this.hot.getColWidth(e);if(s>1)for(let a=e+1;a<e+s;a++)o+=this.hot.getColWidth(a);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("table"),o=t.createElement("thead"),a=t.createElement("tbody"),l=t.createElement("colgroup"),u=t.createElement("tr"),c=t.createElement("th");return this.isVertical()&&s.appendChild(l),this.isHorizontal()&&(u.appendChild(c),o.appendChild(u),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(o),this.isVertical()&&a.appendChild(u),s.appendChild(a),addClass$1(s,e),n.appendChild(s),{fragment:n,table:s,tHead:o,tBody:a,colGroup:l,tr:u,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return addClass$1(s,o),n.appendChild(s),{fragment:n,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function _defineProperty$1O(r,e,t){return(e=_toPropertyKey$1O(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1O(r){var e=_toPrimitive$1O(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1O(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(e){_defineProperty$1O(this,"samples",null),_defineProperty$1O(this,"dataFactory",null),_defineProperty$1O(this,"customSampleCount",null),_defineProperty$1O(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const s=new Map,{from:o,to:a}=typeof n=="number"?{from:n,to:n}:n;return rangeEach(o,a,l=>{const u=this.generateSample(e,t,l);s.set(l,u)}),s}generateSample(e,t,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,o=e==="row"?"col":"row",a=[];return rangeEach(t.from,t.to,l=>{const u=e==="row"?this.dataFactory(n,l):this.dataFactory(l,n);if(u===!1)return;const{value:c,bundleSeed:d}=u,f=typeof d=="string"&&d.length>0;let C;f?C=d:isObject$1(c)?C=`${Object.keys(c).length}`:Array.isArray(c)?C=`${c.length}`:C=`${stringify$1(c).length}`,s.has(C)||s.set(C,{needed:this.getSampleCount(),strings:[]});const m=s.get(C);m.needed&&(!(a.indexOf(c)>-1)||this.allowDuplicates||f)&&(m.strings.push({value:c,[o]:l}),a.push(c),m.needed-=1)}),s}}var es_array_at={},hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireToIntegerOrInfinity(),s=requireAddToUnscopables();return r({target:"Array",proto:!0},{at:function(a){var l=e(this),u=t(l),c=n(a),d=c>=0?c:u+c;return d<0||d>=u?void 0:l[d]}}),s("at"),es_array_at}requireEs_array_at();var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var r=require_export(),e=requireFunctionUncurryThis(),t=requireRequireObjectCoercible(),n=requireToIntegerOrInfinity(),s=requireToString(),o=requireFails(),a=e("".charAt),l=o(function(){return"".at(-2)!=="\uD842"});return r({target:"String",proto:!0,forced:l},{at:function(c){var d=s(t(this)),f=d.length,C=n(c),m=C>=0?C:f+C;return m<0||m>=f?void 0:a(d,m)}}),es_string_atAlternative}requireEs_string_atAlternative();function _defineProperty$1N(r,e,t){return(e=_toPropertyKey$1N(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1N(r){var e=_toPrimitive$1N(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1N(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class FullyVisibleColumnsCalculationType{constructor(){_defineProperty$1N(this,"count",0),_defineProperty$1N(this,"startColumn",null),_defineProperty$1N(this,"endColumn",null),_defineProperty$1N(this,"startPosition",null),_defineProperty$1N(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:o,columnWidth:a}=t,l=s>0?o+1:o;n>=s&&n+a<=s+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:l,needReverse:u,startPositions:c,columnWidth:d}=e;if(this.endColumn===l-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const E=c[this.endColumn]+d-c[this.startColumn-1];if(E<=s&&(this.startColumn-=1),E>=s)break}this.startPosition=(t=c[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?s+1:s,C=n+s-f,m=this.startColumn===null?0:e.getColumnWidth(this.startColumn);C<-1*o||n>c.at(-1)||-1*n-s>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1M(r,e,t){return(e=_toPropertyKey$1M(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1M(r){var e=_toPrimitive$1M(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1M(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class FullyVisibleRowsCalculationType{constructor(){_defineProperty$1M(this,"count",0),_defineProperty$1M(this,"startRow",null),_defineProperty$1M(this,"endRow",null),_defineProperty$1M(this,"startPosition",null),_defineProperty$1M(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:o,rowHeight:a}=t;n>=s&&n+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:o,totalRows:a,needReverse:l,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const C=u[this.endRow]+c-u[this.startRow-1];if(C<=s-o&&(this.startRow-=1),C>=s-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null;const d=n+s-o,f=this.startRow===null?0:e.getRowHeight(this.startRow);d<f||n>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1L(r,e,t){return(e=_toPropertyKey$1L(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1L(r){var e=_toPrimitive$1L(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1L(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class PartiallyVisibleColumnsCalculationType{constructor(){_defineProperty$1L(this,"count",0),_defineProperty$1L(this,"startColumn",null),_defineProperty$1L(this,"endColumn",null),_defineProperty$1L(this,"startPosition",null),_defineProperty$1L(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:o}=t;n<=s&&(this.startColumn=e);const a=s>0?o+1:o;n>=s&&n<=s+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:l,needReverse:u,startPositions:c,columnWidth:d}=e;if(this.endColumn===l-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=c[this.endColumn]+d-c[this.startColumn-1];if(this.startColumn-=1,m>s)break}this.startPosition=(t=c[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?s+1:s;n+s-f<-1*o||n>c.at(-1)+d||-1*n-s>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1K(r,e,t){return(e=_toPropertyKey$1K(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1K(r){var e=_toPrimitive$1K(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1K(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class PartiallyVisibleRowsCalculationType{constructor(){_defineProperty$1K(this,"count",0),_defineProperty$1K(this,"startRow",null),_defineProperty$1K(this,"endRow",null),_defineProperty$1K(this,"startPosition",null),_defineProperty$1K(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:o}=t;n<=s&&(this.startRow=e),n>=s&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:o,totalRows:a,needReverse:l,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const f=u[this.endRow]+c-u[this.startRow-1];if(this.startRow-=1,f>=s-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null,n+s-o<0||n>u.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1J(r,e,t){return(e=_toPropertyKey$1J(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1J(r){var e=_toPrimitive$1J(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1J(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedAllColumnsCalculationType{constructor(){_defineProperty$1J(this,"count",0),_defineProperty$1J(this,"startColumn",0),_defineProperty$1J(this,"endColumn",0),_defineProperty$1J(this,"startPosition",0),_defineProperty$1J(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function _defineProperty$1I(r,e,t){return(e=_toPropertyKey$1I(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1I(r){var e=_toPrimitive$1I(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1I(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedAllRowsCalculationType{constructor(){_defineProperty$1I(this,"count",0),_defineProperty$1I(this,"startRow",0),_defineProperty$1I(this,"endRow",0),_defineProperty$1I(this,"startPosition",0),_defineProperty$1I(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function _defineProperty$1H(r,e,t){return(e=_toPropertyKey$1H(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1H(r){var e=_toPrimitive$1H(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1H(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{constructor(){super(...arguments),_defineProperty$1H(this,"columnStartOffset",0),_defineProperty$1H(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:s,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const a=this.startColumn,l=this.endColumn;n(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-l}this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=o[this.startColumn])!==null&&t!==void 0?t:null,s<this.endColumn&&(this.endColumn=s-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1G(r,e,t){return(e=_toPropertyKey$1G(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1G(r){var e=_toPrimitive$1G(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1G(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{constructor(){super(...arguments),_defineProperty$1G(this,"rowStartOffset",0),_defineProperty$1G(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:s,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const a=this.startRow,l=this.endRow;n(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-l}this.startRow<0&&(this.startRow=0),this.startPosition=(t=o[this.startRow])!==null&&t!==void 0?t:null,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1F(r,e,t){return(e=_toPropertyKey$1F(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1F(r){var e=_toPrimitive$1F(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1F(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewportBaseCalculator{constructor(e){_defineProperty$1F(this,"calculationTypes",[]),_defineProperty$1F(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[n,s]=t;this.calculationResults.set(n,s),s.initialize(e)})}_process(e,t){this.calculationTypes.forEach(n=>{let[,s]=n;return s.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,n]=t;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function _defineProperty$1E(r,e,t){return(e=_toPropertyKey$1E(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1E(r){var e=_toPrimitive$1E(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1E(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const DEFAULT_WIDTH=50;class ViewportColumnsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:s,totalColumns:o,columnWidthFn:a,overrideFn:l,inlineStartOffset:u}=e;super(t),_defineProperty$1E(this,"viewportWidth",0),_defineProperty$1E(this,"scrollOffset",0),_defineProperty$1E(this,"zeroBasedScrollOffset",0),_defineProperty$1E(this,"totalColumns",0),_defineProperty$1E(this,"columnWidthFn",null),_defineProperty$1E(this,"columnWidth",0),_defineProperty$1E(this,"overrideFn",null),_defineProperty$1E(this,"inlineStartOffset",0),_defineProperty$1E(this,"totalCalculatedWidth",0),_defineProperty$1E(this,"startPositions",[]),_defineProperty$1E(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=l,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?DEFAULT_WIDTH:t}}function _defineProperty$1D(r,e,t){return(e=_toPropertyKey$1D(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1D(r){var e=_toPrimitive$1D(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1D(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewportRowsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:s,totalRows:o,defaultRowHeight:a,rowHeightFn:l,overrideFn:u,horizontalScrollbarHeight:c}=e;super(t),_defineProperty$1D(this,"viewportHeight",0),_defineProperty$1D(this,"scrollOffset",0),_defineProperty$1D(this,"zeroBasedScrollOffset",0),_defineProperty$1D(this,"totalRows",0),_defineProperty$1D(this,"rowHeightFn",null),_defineProperty$1D(this,"rowHeight",0),_defineProperty$1D(this,"overrideFn",null),_defineProperty$1D(this,"horizontalScrollbarHeight",0),_defineProperty$1D(this,"innerViewportHeight",0),_defineProperty$1D(this,"totalCalculatedHeight",0),_defineProperty$1D(this,"startPositions",[]),_defineProperty$1D(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalRows=o,this.rowHeightFn=l,this.overrideFn=u,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function _classPrivateFieldInitSpec$Q(r,e,t){_checkPrivateRedeclaration$17(r,e),e.set(r,t)}function _checkPrivateRedeclaration$17(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1C(r,e,t){return(e=_toPropertyKey$1C(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1C(r){var e=_toPrimitive$1C(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1C(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$Q(r,e){return r.get(_assertClassBrand$17(r,e))}function _classPrivateFieldSet$O(r,e,t){return r.set(_assertClassBrand$17(r,e),t),t}function _assertClassBrand$17(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _isRtl$2=new WeakMap;class CellCoords{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty$1C(this,"row",null),_defineProperty$1C(this,"col",null),_classPrivateFieldInitSpec$Q(this,_isRtl$2,!1),_classPrivateFieldSet$O(_isRtl$2,this,n),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:s,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-s||this.row>=t||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet$Q(_isRtl$2,this)}isSouthEastOf(e){return this.row>=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof CellCoords&&_classPrivateFieldSet$O(_isRtl$2,this,e.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet$Q(_isRtl$2,this))}toObject(){return{row:this.row,col:this.col}}}function _classPrivateFieldInitSpec$P(r,e,t){_checkPrivateRedeclaration$16(r,e),e.set(r,t)}function _checkPrivateRedeclaration$16(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1B(r,e,t){return(e=_toPropertyKey$1B(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1B(r){var e=_toPrimitive$1B(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1B(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$P(r,e){return r.get(_assertClassBrand$16(r,e))}function _classPrivateFieldSet$N(r,e,t){return r.set(_assertClassBrand$16(r,e),t),t}function _assertClassBrand$16(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _isRtl$1=new WeakMap;class CellRange{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty$1B(this,"highlight",null),_defineProperty$1B(this,"from",null),_defineProperty$1B(this,"to",null),_classPrivateFieldInitSpec$P(this,_isRtl$1,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),_classPrivateFieldSet$N(_isRtl$1,this,s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,s=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return s.row<=t&&o.row>=t&&s.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),o=this.getDirection(),a=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),u=Math.min(n.row,a.row),c=Math.min(n.col,a.col),d=Math.max(s.row,l.row),f=Math.max(s.col,l.col),C=this._createCellCoords(u,c),m=this._createCellCoords(d,f);return this.from=C,this.to=m,this.setDirection(o),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof CellCoords))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return t.top===n.top&&s.push("top"),t.right===n.right&&s.push(_classPrivateFieldGet$P(_isRtl$1,this)?"left":"right"),t.bottom===n.bottom&&s.push("bottom"),t.left===n.left&&s.push(_classPrivateFieldGet$P(_isRtl$1,this)?"right":"left"),s}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)!(this.from.row===s&&this.from.col===o)&&!(this.to.row===s&&this.to.col===o)&&n.push(this._createCellCoords(s,o));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)e.row===s&&e.col===o?n.push(e):t.row===s&&t.col===o?n.push(t):n.push(this._createCellCoords(s,o));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let s=t.row;s<=n.row;s++)for(let o=t.col;o<=n.col;o++)if(e(s,o)===!1)return}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet$P(_isRtl$1,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new CellCoords(e,t,_classPrivateFieldGet$P(_isRtl$1,this))}}function _classPrivateFieldInitSpec$O(r,e,t){_checkPrivateRedeclaration$15(r,e),e.set(r,t)}function _checkPrivateRedeclaration$15(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$O(r,e){return r.get(_assertClassBrand$15(r,e))}function _classPrivateFieldSet$M(r,e,t){return r.set(_assertClassBrand$15(r,e),t),t}function _assertClassBrand$15(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap;let Event$1=class{constructor(e,t,n,s,o,a){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec$O(this,_wtSettings,void 0),_classPrivateFieldInitSpec$O(this,_domBindings,void 0),_classPrivateFieldInitSpec$O(this,_wtTable,void 0),_classPrivateFieldInitSpec$O(this,_selectionManager,void 0),_classPrivateFieldInitSpec$O(this,_parent,void 0),_classPrivateFieldInitSpec$O(this,_eventManager,void 0),_classPrivateFieldInitSpec$O(this,_facadeGetter,void 0),_classPrivateFieldInitSpec$O(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec$O(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec$O(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet$M(_wtSettings,this,n),_classPrivateFieldSet$M(_domBindings,this,t),_classPrivateFieldSet$M(_wtTable,this,o),_classPrivateFieldSet$M(_selectionManager,this,a),_classPrivateFieldSet$M(_parent,this,l),_classPrivateFieldSet$M(_eventManager,this,s),_classPrivateFieldSet$M(_facadeGetter,this,e),this.registerEvents()}registerEvents(){_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"contextmenu",n=>this.onContextMenu(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).TABLE,"mouseover",n=>this.onMouseOver(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"touchstart",n=>this.onTouchStart(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet$O(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet$O(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"mouseup",n=>this.onMouseUp(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"mousedown",n=>this.onMouseDown(n))};isMobileBrowser()?e():(isTouchSupported()&&e(),t())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this)&&n){const[s,o]=[n.row,_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this).from.row],[a,l]=[n.col,_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this).from.col];return s===o&&a===l}return!1}parentCell(e){const t={},n=_classPrivateFieldGet$O(_wtTable,this).TABLE,s=closestDown(e,["TD","TH"],n);return s?(t.coords=_classPrivateFieldGet$O(_wtTable,this).getCoords(s),t.TD=s):hasClass$1(e,"wtBorder")&&hasClass$1(e,"current")?(t.coords=_classPrivateFieldGet$O(_selectionManager,this).getFocusSelection().cellRange.highlight,t.TD=_classPrivateFieldGet$O(_wtTable,this).getCell(t.coords)):hasClass$1(e,"wtBorder")&&hasClass$1(e,"area")&&_classPrivateFieldGet$O(_selectionManager,this).getAreaSelection().cellRange&&(t.coords=_classPrivateFieldGet$O(_selectionManager,this).getAreaSelection().cellRange.to,t.TD=_classPrivateFieldGet$O(_wtTable,this).getCell(t.coords)),t}onMouseDown(e){const t=_classPrivateFieldGet$O(_domBindings,this).rootDocument.activeElement,n=partial(getParent,e.target),s=e.target;if(!["TD","TH"].includes(t.nodeName)&&(s===t||n(0)===t||n(1)===t))return;const o=this.parentCell(s);hasClass$1(s,"corner")?_classPrivateFieldGet$O(_wtSettings,this).getSetting("onCellCornerMouseDown",e,s):o.TD&&_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=o.TD,clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[0]),_classPrivateFieldGet$O(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(e){if(_classPrivateFieldGet$O(_wtSettings,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseOver"))return;const t=_classPrivateFieldGet$O(_wtTable,this).TABLE,n=closestDown(e.target,["TD","TH"],t),s=_classPrivateFieldGet$O(_parent,this)||this;n&&n!==s.lastMouseOver&&isChildOf(n,t)&&(s.lastMouseOver=n,this.callListener("onCellMouseOver",e,_classPrivateFieldGet$O(_wtTable,this).getCoords(n),n))}onMouseOut(e){if(!_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseOut"))return;const t=_classPrivateFieldGet$O(_wtTable,this).TABLE,n=closestDown(e.target,["TD","TH"],t),s=closestDown(e.relatedTarget,["TD","TH"],t),o=_classPrivateFieldGet$O(_parent,this)||this;n&&n!==s&&isChildOf(n,t)&&(this.callListener("onCellMouseOut",e,_classPrivateFieldGet$O(_wtTable,this).getCoords(n),n),s===null&&(o.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[0]&&t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[1]?(hasClass$1(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=null):t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=t.TD,clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[1]),_classPrivateFieldGet$O(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(e){_classPrivateFieldSet$M(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet$O(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,s=(t=this.parentCell(n))===null||t===void 0?void 0:t.coords,o=isDefined(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&o&&_classPrivateFieldGet$O(_wtSettings,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(n)&&!l.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,s){const o=_classPrivateFieldGet$O(_wtSettings,this).getSettingPure(e);o&&o(t,n,s,_classPrivateFieldGet$O(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[1]),_classPrivateFieldGet$O(_eventManager,this).destroy()}};function _defineProperty$1A(r,e,t){return(e=_toPropertyKey$1A(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1A(r){var e=_toPrimitive$1A(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1A(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ColumnFilter{constructor(e,t,n){_defineProperty$1A(this,"offset",void 0),_defineProperty$1A(this,"total",void 0),_defineProperty$1A(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _defineProperty$1z(r,e,t){return(e=_toPropertyKey$1z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1z(r){var e=_toPrimitive$1z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowFilter{constructor(e,t,n){_defineProperty$1z(this,"offset",void 0),_defineProperty$1z(this,"total",void 0),_defineProperty$1z(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _defineProperty$1y(r,e,t){return(e=_toPropertyKey$1y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1y(r){var e=_toPrimitive$1y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewSize{constructor(){_defineProperty$1y(this,"currentSize",0),_defineProperty$1y(this,"nextSize",0),_defineProperty$1y(this,"currentOffset",0),_defineProperty$1y(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function _defineProperty$1x(r,e,t){return(e=_toPropertyKey$1x(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1x(r){var e=_toPrimitive$1x(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1x(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewSizeSet{constructor(){_defineProperty$1x(this,"size",new ViewSize),_defineProperty$1x(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty$1x(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ViewSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}function _defineProperty$1w(r,e,t){return(e=_toPropertyKey$1w(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1w(r){var e=_toPrimitive$1w(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1w(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class OrderView{constructor(e,t,n){_defineProperty$1w(this,"rootNode",void 0),_defineProperty$1w(this,"nodesPool",void 0),_defineProperty$1w(this,"sizeSet",new ViewSizeSet),_defineProperty$1w(this,"childNodeType",void 0),_defineProperty$1w(this,"visualIndex",0),_defineProperty$1w(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(WORKING_SPACE_TOP))break;s=s.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:s}=t.getViewSize();let o=this.getRenderedChildCount();for(;o<s;){const l=this.nodesPool();!n||n&&t.isPlaceOn(WORKING_SPACE_BOTTOM)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}const a=n&&t.isPlaceOn(WORKING_SPACE_TOP);for(;o>s;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(WORKING_SPACE_BOTTOM)&&(n+=t.sharedSize.nextSize);let s=e.childNodes[n];if(s.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,s),s=o}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class SharedOrderView extends OrderView{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function _defineProperty$1v(r,e,t){return(e=_toPropertyKey$1v(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1v(r){var e=_toPrimitive$1v(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1v(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class NodesPool{constructor(e){_defineProperty$1v(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function _defineProperty$1u(r,e,t){return(e=_toPropertyKey$1u(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1u(r){var e=_toPrimitive$1u(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1u(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseRenderer{constructor(e,t){_defineProperty$1u(this,"nodesPool",null),_defineProperty$1u(this,"nodeType",void 0),_defineProperty$1u(this,"rootNode",void 0),_defineProperty$1u(this,"table",null),_defineProperty$1u(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new NodesPool(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function _defineProperty$1t(r,e,t){return(e=_toPropertyKey$1t(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1t(r){var e=_toPrimitive$1t(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1t(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),_defineProperty$1t(this,"orderViews",new WeakMap),_defineProperty$1t(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:s,cells:o}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=s.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=o.obtainOrderView(u);c.appendView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const C=c.getCurrentNode();C.className="",C.removeAttribute("style"),removeAttribute(C,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(C,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(f+1),A11Y_TABINDEX(-1)]),t[f](l,C,f)}c.end()}}}class ColumnHeadersRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,o=s+t;for(let l=0,u=e;l<u;l++){for(n=this.rootNode.childNodes[l],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let l=e;l<a;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&empty$2(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:n,columnsToRender:s,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&setAttribute(a,[A11Y_ROW(),A11Y_ROWINDEX(t+1)]);for(let l=-1*o;l<s;l+=1){const u=this.table.renderedColumnToSource(l),c=a.childNodes[l+o];c.className="",c.removeAttribute("style"),removeAttribute(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(c,[A11Y_COLINDEX(l+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...l>=0?[A11Y_SCOPE_COL()]:[A11Y_ROW()]]),n[t](u,c,t)}}}}let performanceWarningAppeared$1=!1;class ColGroupRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!performanceWarningAppeared$1&&e>1e3&&(performanceWarningAppeared$1=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let s=0;s<t;s++){const o=this.table.renderedColumnToSource(s),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[s].style.width=`${a}px`}for(let s=0;s<e;s++){const o=this.table.renderedColumnToSource(s),a=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[s+t].style.width=`${a}px`}const n=this.rootNode.firstChild;n&&addClass$1(n,"rowHeader")}}function _defineProperty$1s(r,e,t){return(e=_toPropertyKey$1s(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1s(r){var e=_toPrimitive$1s(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1s(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let performanceWarningAppeared=!1;class RowsRenderer extends BaseRenderer{constructor(e){super("TR",e),_defineProperty$1s(this,"orderView",void 0),this.orderView=new OrderView(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let s=0;s<e;s++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(s);if(this.table.isAriaEnabled()){var t,n;setAttribute(o,[A11Y_ROW(),A11Y_ROWINDEX(a+((t=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}removeClass$1(o,[ROW_CLASSNAMES.rowEven,ROW_CLASSNAMES.rowOdd]),(a+1)%2===0?addClass$1(o,ROW_CLASSNAMES.rowEven):addClass$1(o,ROW_CLASSNAMES.rowOdd)}this.orderView.end()}}function _defineProperty$1r(r,e,t){return(e=_toPropertyKey$1r(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1r(r){var e=_toPrimitive$1r(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1r(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CellsRenderer extends BaseRenderer{constructor(){super("TD"),_defineProperty$1r(this,"orderViews",new WeakMap),_defineProperty$1r(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:s}=this.table;for(let l=0;l<e;l++){const u=this.table.renderedRowToSource(l),c=n.getRenderedNode(l);this.sourceRowIndex=u;const d=this.obtainOrderView(c),f=s.obtainOrderView(c);d.prependView(f).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let C=0;C<t;C++){d.render();const m=d.getCurrentNode(),E=this.table.renderedColumnToSource(C);if(hasClass$1(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),removeAttribute(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,E,m),this.table.isAriaEnabled()){var o,a;setAttribute(m,[...m.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(E+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}d.end()}}}function _defineProperty$1q(r,e,t){return(e=_toPropertyKey$1q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1q(r){var e=_toPrimitive$1q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TableRenderer{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty$1q(this,"rootNode",void 0),_defineProperty$1q(this,"rootDocument",void 0),_defineProperty$1q(this,"rowHeaders",null),_defineProperty$1q(this,"columnHeaders",null),_defineProperty$1q(this,"colGroup",null),_defineProperty$1q(this,"rows",null),_defineProperty$1q(this,"cells",null),_defineProperty$1q(this,"rowFilter",null),_defineProperty$1q(this,"columnFilter",null),_defineProperty$1q(this,"rowUtils",null),_defineProperty$1q(this,"columnUtils",null),_defineProperty$1q(this,"rowsToRender",0),_defineProperty$1q(this,"columnsToRender",0),_defineProperty$1q(this,"rowHeaderFunctions",[]),_defineProperty$1q(this,"rowHeadersCount",0),_defineProperty$1q(this,"columnHeaderFunctions",[]),_defineProperty$1q(this,"columnHeadersCount",0),_defineProperty$1q(this,"cellRenderer",void 0),_defineProperty$1q(this,"activeOverlayName",void 0),_defineProperty$1q(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:s,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),s.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=s,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const s=t.getRenderedNode(n),o=this.rowUtils;if(s.firstChild){const a=this.renderedRowToSource(n),l=o.getHeightByOverlayName(a,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;l?s.firstChild.style.height=`${l-c}px`:s.firstChild.style.height=""}}}}class Renderer{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:s,rowUtils:o,columnUtils:a,cellRenderer:l,stylesHandler:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(e,{cellRenderer:l,stylesHandler:u}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(t),colGroup:new ColGroupRenderer(n),rows:new RowsRenderer(s),cells:new CellsRenderer}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _defineProperty$1p(r,e,t){return(e=_toPropertyKey$1p(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1p(r){var e=_toPrimitive$1p(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1p(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ColumnUtils{constructor(e,t){_defineProperty$1p(this,"dataAccessObject",void 0),_defineProperty$1p(this,"wtSettings",void 0),_defineProperty$1p(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const n=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let a=Array.isArray(t)?t[o]:t;a=a??s,this.headerWidths.set(o,a)}}}}function _defineProperty$1o(r,e,t){return(e=_toPropertyKey$1o(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1o(r){var e=_toPrimitive$1o(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1o(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowUtils{constructor(e,t){_defineProperty$1o(this,"dataAccessObject",void 0),_defineProperty$1o(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(t=t===void 0?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(n=n===void 0?s:Math.max(n,s)),n}}function _defineProperty$1n(r,e,t){return(e=_toPropertyKey$1n(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1n(r){var e=_toPrimitive$1n(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1n(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Table{constructor(e,t,n,s,o){_defineProperty$1n(this,"wtSettings",null),_defineProperty$1n(this,"domBindings",void 0),_defineProperty$1n(this,"TBODY",null),_defineProperty$1n(this,"THEAD",null),_defineProperty$1n(this,"COLGROUP",null),_defineProperty$1n(this,"hasTableHeight",!0),_defineProperty$1n(this,"hasTableWidth",!0),_defineProperty$1n(this,"isTableVisible",!1),_defineProperty$1n(this,"tableOffset",0),_defineProperty$1n(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}createHider(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}createHolder(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(n.parentNode,[A11Y_PRESENTATION()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:n,wtViewport:s}=this.dataAccessObject,o=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),u=l.length,c=t.getSetting("columnHeaders"),d=c.length;let f=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=offset$2(this.holder),f=s.createCalculators(f),u&&!t.getSetting("fixedColumnsStart"))){const m=n.inlineStartOverlay.getScrollPosition(),E=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,E!==this.correctHeaderWidth&&(f=!1)}if(f)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=offset$2(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=o>0?this.getFirstRenderedRow():0,E=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new RowFilter(m,o,d),this.columnFilter=new ColumnFilter(E,a,u);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const _={};this.wtSettings.getSetting("beforeDraw",!0,_),v=_.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(l,c),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||s.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let C=!1;return this.isMaster&&(C=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(C=n.bottomOverlay.resetFixedPosition()||C),C=n.inlineStartOverlay.resetFixedPosition()||C,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const s=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,a,l;const u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),a=this.getColumnHeader(t,n),a&&(l=innerHeight$1(a),(!o&&s<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),Array.isArray(u)?u[n]!==null&&u[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(u[n]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]||u))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let o=0,a=s.length;o<a;o++)if(n[o]){if(!t[o]||t[o].childNodes.length===0)return;t[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let s=0;s<n;s++){const o=this.rowFilter.renderedToSource(s);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}}getCell(e){let t=e.row,n=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(s&&Array.isArray(s)&&([t,n]=s),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,n=null;if(e<0){var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return t!==void 0&&n!==void 0?n.childNodes.length<t+1?!1:n.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[t];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const o=s.childNodes[n];o&&t.push(o)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(t>=n)return;const s=this.rowFilter.sourceToRendered(e),o=s<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):s,l=(s<0?this.THEAD:this.TBODY).childNodes[o];return l==null?void 0:l.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<n;s++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o==null?void 0:o.childNodes[s];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=closest(t,["TD","TH"])),t===null)return null;const n=t.parentNode,s=n.parentNode;let o=index$1(n),a=t.cellIndex;overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_TOP,t,this.wtRootElement)?s.nodeName==="THEAD"&&(o-=s.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-s.childNodes.length+o:s===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a);const l=this.wtSettings.getSetting("onModifyGetCoordsElement",o,a);return l&&Array.isArray(l)&&([o,a]=l),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=innerHeight$1(this.TBODY)-1,s=this.wot.stylesHandler.areCellsBorderBox(),o=s?outerHeight:innerHeight$1,a=s?0:1,l=s?1:0;let u,c,d,f,C;if(!(t===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,d=this.rowFilter.renderedToSource(e),u=this.getRowHeight(d),f=this.getTrForRow(d),C=f.querySelector("th");const m=d===0?l:0;C?c=o(C):c=o(f)-a,(!u&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<c-m||u<c)&&(s||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[d]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const e=outerWidth(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=outerHeight(this.hider);return e!==0?e:this.getHeight()}isVisible(){return isVisible(this.TABLE)}_modifyRowHeaderWidth(e){let t=isFunction$2(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const MIXIN_NAME$5="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const r=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=r-e;return r===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});const MIXIN_NAME$4="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const r=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});class BottomInlineStartCornerOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_BOTTOM_INLINE_START_CORNER)}}mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom);mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart);const CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]);function _classPrivateMethodInitSpec$O(r,e){_checkPrivateRedeclaration$14(r,e),e.add(r)}function _checkPrivateRedeclaration$14(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1m(r,e,t){return(e=_toPropertyKey$1m(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1m(r){var e=_toPrimitive$1m(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1m(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$14(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet;class Scroll{constructor(e){_classPrivateMethodInitSpec$O(this,_Scroll_brand),_defineProperty$1m(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const s=this.scrollViewportHorizontally(e.col,t),o=this.scrollViewportVertically(e.row,n);return s||o}scrollViewportHorizontally(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:s}=this.dataAccessObject;if(!n)return!1;const o=createObjectPropListener(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>s)return!1;t=o.value;const{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject,u=t==="auto";if(u&&e<a)return!1;const c=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();let f=!1;return(u&&(e<c||e>d)||!u)&&(f=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleColumn():t==="end")),f}scrollViewportVertically(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:s}=this.dataAccessObject;if(!n)return!1;const o=createObjectPropListener(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>s)return!1;t=o.value;const{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject,c=t==="auto";if(c&&(e<l||e>s-a-1))return!1;const d=this.getFirstVisibleRow(),f=this.getLastVisibleRow();let C=!1;return(c&&(e<d||e>f)||!c)&&(C=u.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():t==="bottom")),C}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand$14(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand$14(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand$14(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand$14(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function _getLastColumnIndex(r){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:s,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(t.mainTableScrollableElement===a){const l=e.getSetting("rtlMode");let u=null;if(l){const d=n.TABLE.getBoundingClientRect(),C=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-C)}else u=offset$2(n.wtRootElement).left;const c=Math.abs(getScrollLeft(a,a));if(u>c){const d=innerWidth(a);let f=s.getRowHeaderWidth();for(let C=1;C<=o;C++)if(f+=t.sumCellSizes(C-1,C),u+f-c>=d){r=C-2;break}}}return r}function _getLastRowIndex(r){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:s,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const a=offset$2(t.wtRootElement),l=getScrollTop(o,o);if(a.top>l){const u=innerHeight$1(o);let c=n.getColumnHeaderHeight();for(let d=1;d<=s;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){r=d-2;break}}}return r}function _defineProperty$1l(r,e,t){return(e=_toPropertyKey$1l(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1l(r){var e=_toPrimitive$1l(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1l(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CoreAbstract{get eventManager(){return new EventManager(this)}constructor(e,t){_defineProperty$1l(this,"wtTable",void 0),_defineProperty$1l(this,"wtScroll",void 0),_defineProperty$1l(this,"wtViewport",void 0),_defineProperty$1l(this,"wtOverlays",void 0),_defineProperty$1l(this,"selectionManager",void 0),_defineProperty$1l(this,"wtEvent",void 0),_defineProperty$1l(this,"guid",`wt_${randomString()}`),_defineProperty$1l(this,"drawInterrupted",!1),_defineProperty$1l(this,"drawn",!1),_defineProperty$1l(this,"activeOverlayName","master"),_defineProperty$1l(this,"domBindings",void 0),_defineProperty$1l(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Scroll(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){fastInnerText(n,e[t])}])}}createCellCoords(e,t){return new CellCoords(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new CellRange(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _defineProperty$1k(r,e,t){return(e=_toPropertyKey$1k(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1k(r){var e=_toPrimitive$1k(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1k(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Clone extends CoreAbstract{constructor(e,t,n){super(e,t),_defineProperty$1k(this,"cloneSource",void 0),_defineProperty$1k(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new Event$1(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function _defineProperty$1j(r,e,t){return(e=_toPropertyKey$1j(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1j(r){var e=_toPrimitive$1j(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1j(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Overlay{constructor(e,t,n,s,o){_defineProperty$1j(this,"wtSettings",null),defineGetter(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=s;const{TABLE:a,hider:l,spreader:u,holder:c,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=d,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE)}getRelativeCellPosition(e,t,n){if(this.clone.wtTable.holder.contains(e)===!1){warn$1(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},d={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return s?f=this.getRelativeCellPositionWithinWindow(a,o,d,c):f=this.getRelativeCellPositionWithinHolder(a,l,o,d,c),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,s){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,l=0;if(!t)a=s.start;else{let u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+getScrollbarWidth())),a=u<=0?-1*u:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:l=s.top,{start:n.start+a,top:n.top+l}}getRelativeCellPositionWithinHolder(e,t,n,s,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,u=0;if(n||(l=a.horizontal-o.start),t){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(u=a.vertical-o.top);return{start:s.start-l,top:s.top-u}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,o=n.createElement("div"),a=n.createElement("table"),l=e.wtRootElement.parentNode;o.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&setAttribute(o,[A11Y_PRESENTATION()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),l.appendChild(o);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===CLONE_TOP||c==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=s:s.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE),new Clone(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,s=t.style,o=e.parentNode.style;[n,s,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BottomInlineStartCornerOverlay extends Overlay{constructor(e,t,n,s,o,a){super(e,t,CLONE_BOTTOM_INLINE_START_CORNER,n,s),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new BottomInlineStartCornerOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${o}px`,t.style.bottom=`${a}px`}else resetCssTransform(t),this.repositionOverlay();let n=outerHeight(this.clone.wtTable.TABLE);const s=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(n)),s.style.bottom=`${o}px`}}const MIXIN_NAME$3="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const r=this.dataAccessObject.startColumnRendered;return r===null?-1:r},getFirstVisibleColumn(){const r=this.dataAccessObject.startColumnVisible;return r===null?-1:r},getFirstPartiallyVisibleColumn(){const r=this.dataAccessObject.startColumnPartiallyVisible;return r===null?-1:r},getLastRenderedColumn(){const r=this.dataAccessObject.endColumnRendered;return r===null?-1:r},getLastVisibleColumn(){const r=this.dataAccessObject.endColumnVisible;return r===null?-1:r},getLastPartiallyVisibleColumn(){const r=this.dataAccessObject.endColumnPartiallyVisible;return r===null?-1:r},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});class BottomOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_BOTTOM)}}mixin(BottomOverlayTable,stickyRowsBottom);mixin(BottomOverlayTable,calculatedColumns);function _defineProperty$1i(r,e,t){return(e=_toPropertyKey$1i(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1i(r){var e=_toPrimitive$1i(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1i(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BottomOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_BOTTOM,n,s),_defineProperty$1i(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new BottomOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(n=this.getOverlayOffset(),t.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(n)),s.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(getWindowScrollLeft(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,stylesHandler:s}=this.wot,o=s.getDefaultRowHeight();let a=e,l=0;for(;a<t;){const u=n.getRowHeight(a);l+=u===void 0?o:u,a+=1}return l}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let c=t.getWorkspaceWidth();t.hasVerticalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;t&&o.offsetHeight!==o.clientHeight&&(a=getScrollbarWidth(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=a,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=s-o,l=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+s,0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,s=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||t===0)&&s.length>0){const a=this.wot.wtTable.holder.parentNode,l=hasClass$1(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(addClass$1(a,"innerBorderBottom"),o=!l):(removeClass$1(a,"innerBorderBottom"),o=l)}return o}}const MIXIN_NAME$2="calculatedRows",calculatedRows={getFirstRenderedRow(){const r=this.dataAccessObject.startRowRendered;return r===null?-1:r},getFirstVisibleRow(){const r=this.dataAccessObject.startRowVisible;return r===null?-1:r},getFirstPartiallyVisibleRow(){const r=this.dataAccessObject.startRowPartiallyVisible;return r===null?-1:r},getLastRenderedRow(){const r=this.dataAccessObject.endRowRendered;return r===null?-1:r},getLastVisibleRow(){const r=this.dataAccessObject.endRowVisible;return r===null?-1:r},getLastPartiallyVisibleRow(){const r=this.dataAccessObject.endRowPartiallyVisible;return r===null?-1:r},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});class InlineStartOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_INLINE_START)}}mixin(InlineStartOverlayTable,calculatedRows);mixin(InlineStartOverlayTable,stickyColumnsStart);const MIXIN_NAME$1="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(r,e){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(e),this},runLocalHooks(r,e,t,n,s,o,a){if(this._localHooks[r]){const l=this._localHooks[r].length;for(let u=0;u<l;u++)fastCall(this._localHooks[r][u],this,e,t,n,s,o,a)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});let Selection$2=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection$2,localHooks);const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",getCornerStyle=r=>{const e=r.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const t=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),s=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:t,height:t,borderWidth:n,borderStyle:"solid",borderColor:s})};var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var r=requireAddToUnscopables();return r("flat"),es_array_unscopables_flat}requireEs_array_unscopables_flat();function _classPrivateMethodInitSpec$N(r,e){_checkPrivateRedeclaration$13(r,e),e.add(r)}function _classPrivateFieldInitSpec$N(r,e,t){_checkPrivateRedeclaration$13(r,e),e.set(r,t)}function _checkPrivateRedeclaration$13(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$N(r,e){return r.get(_assertClassBrand$13(r,e))}function _classPrivateFieldSet$L(r,e,t){return r.set(_assertClassBrand$13(r,e),t),t}function _assertClassBrand$13(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot$1=new WeakMap,_SelectionScanner_brand=new WeakSet;class SelectionScanner{constructor(){_classPrivateMethodInitSpec$N(this,_SelectionScanner_brand),_classPrivateFieldInitSpec$N(this,_selection,void 0),_classPrivateFieldInitSpec$N(this,_activeOverlaysWot$1,void 0)}setActiveOverlay(e){return _classPrivateFieldSet$L(_activeOverlaysWot$1,this,e),this}setActiveSelection(e){return _classPrivateFieldSet$L(_selection,this,e),this}scan(){const e=_classPrivateFieldGet$N(_selection,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="area"?this.scanCellsRange(n=>t.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n)),this.scanCellsRange(n=>t.add(n))):e==="fill"?this.scanCellsRange(n=>t.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>t.add(n)),this.scanRowsInCellsRange(n=>t.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanColumnsInCellsRange(n=>t.add(n))),t}scanColumnsInHeadersRange(e){const[t,n,s,o]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),l=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount();let c=0;for(let d=-a.getRowHeadersCount();d<l;d++){const f=a.columnFilter.renderedToSource(d);if(!(f<n||f>o)){for(let C=-u;C<0;C++){if(C<t||C>s)continue;const m=C+u;let E=a.getColumnHeader(f,m);const v=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingColumnHeader",f,m,{selectionType:_classPrivateFieldGet$N(_selection,this).settings.selectionType,columnCursor:c,selectionWidth:o-n+1});v!==null&&(v!==f&&(E=a.getColumnHeader(v,m)),e(E))}c+=1}}}scanRowsInHeadersRange(e){const[t,n,s,o]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),l=a.getRenderedRowsCount(),u=a.getRowHeadersCount();let c=0;for(let d=-a.getColumnHeadersCount();d<l;d++){const f=a.rowFilter.renderedToSource(d);if(!(f<t||f>s)){for(let C=-u;C<0;C++){if(C<n||C>o)continue;const m=C+u;let E=a.getRowHeader(f,m);const v=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingRowHeader",f,m,{selectionType:_classPrivateFieldGet$N(_selection,this).settings.selectionType,rowCursor:c,selectionHeight:s-t+1});v!==null&&(v!==f&&(E=a.getRowHeader(v,m)),e(E))}c+=1}}}scanCellsRange(e){const{wtTable:t}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanCellsRange).call(this,(n,s)=>{const o=t.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(n,s)),a=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onAfterDrawSelection",n,s,_classPrivateFieldGet$N(_selection,this).settings.layerLevel);typeof a=="string"&&addClass$1(o,a),e(o)})}scanRowsInCellsRange(e){const[t,,n]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:s}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanViewportRange).call(this,(o,a)=>{if(o>=t&&o<=n){const l=s.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(o,a));e(l)}})}scanColumnsInCellsRange(e){const[,t,,n]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:s}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanViewportRange).call(this,(o,a)=>{if(a>=t&&a<=n){const l=s.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(o,a));e(l)}})}}function _scanCellsRange(r){let[e,t,n,s]=_classPrivateFieldGet$N(_selection,this).getCorners();if(e<0&&n<0||t<0&&s<0)return;const{wtTable:o}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),a=e!==n||t!==s;if(t=Math.max(t,0),s=Math.max(s,0),e=Math.max(e,0),n=Math.max(n,0),a){if(t=Math.max(t,o.getFirstRenderedColumn()),s=Math.min(s,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),s<t||n<e)return}else if(!(o.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(e,t))instanceof HTMLElement))return;for(let l=e;l<=n;l+=1)for(let u=t;u<=s;u+=1)r(l,u)}function _scanViewportRange(r){const{wtTable:e}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),t=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let s=0;s<t;s+=1){const o=e.rowFilter.renderedToSource(s);for(let a=0;a<n;a+=1)r(o,e.columnFilter.renderedToSource(a))}}class Border{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=getCornerStyle(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const s=this.main.childNodes[t];this.eventManager.addEventListener(s,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),stopImmediatePropagation(e);const n=this,s=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none";function a(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){a(u)&&(n.eventManager.removeEventListener(s,"mousemove",l),t.style.display="block")}this.eventManager.addEventListener(s,"mousemove",l)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let l=0;l<5;l++){const u=n[l],c=t.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(c.className+=" hidden"),s=c.style,s.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,s.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,s.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};objectEach(s,(a,l)=>{this.selectionHandles.styles.bottomHitArea[l]=a,this.selectionHandles.styles.topHitArea[l]=a});const o={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};objectEach(o,(a,l)=>{this.selectionHandles.styles.bottom[l]=a,this.selectionHandles.styles.top[l]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,n,s,o,a){const u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:d,bottom:f,bottomHitArea:C}=this.selectionHandles.styles,m=parseInt(c.borderWidth,10),E=parseInt(c.width,10),v=parseInt(d.width,10),_=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();c.top=`${parseInt(n-E-1,10)}px`,c[u]=`${parseInt(s-E-1,10)}px`,d.top=`${parseInt(n-v/4*3,10)}px`,d[u]=`${parseInt(s-v/4*3,10)}px`;const R=Math.min(parseInt(s+o,10),_-E-m*2),O=Math.min(parseInt(s+o-v/4,10),_-v-m*2);f[u]=`${R}px`,C[u]=`${O}px`;const N=Math.min(parseInt(n+a,10),T-E-m*2),G=Math.min(parseInt(n+a-v/4,10),T-v-m*2);f.top=`${N}px`,C.top=`${G}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",d.display="block",this.isPartRange(e,t)?(f.display="none",C.display="none"):(f.display="block",C.display="block")):(c.display="none",f.display="none",d.display="none",C.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",d.zIndex="9999"):(c.zIndex="",d.zIndex="")}appear(e){if(this.disabled)return;let[t,n,s,o]=e;if(t<0&&s<0||n<0&&o<0){this.disappear();return}const{wtTable:a,rootDocument:l,rootWindow:u}=this.wot,c=t!==s||n!==o,d=a.getFirstRenderedRow(),f=a.getLastRenderedRow(),C=a.getFirstRenderedColumn(),m=a.getLastRenderedColumn();let E;if(c){if(n=Math.max(n,C),o=Math.min(o,m),t=Math.max(t,d),s=Math.min(s,f),o<n||s<t){this.disappear();return}E=a.getCell(this.wot.createCellCoords(t,n))}else if(E=a.getCell(this.wot.createCellCoords(t,n)),!(E instanceof HTMLElement)){this.disappear();return}const v=c?a.getCell(this.wot.createCellCoords(s,o)):E,_=offset$2(E),T=c?offset$2(v):_,R=offset$2(a.TABLE),O=_.top,N=_.left,G=this.wot.wtSettings.getSetting("rtlMode");let D=0,k=0;if(G){const _e=outerWidth(a.TABLE),Oe=outerWidth(E),st=u.innerWidth-R.left-_e;k=N+Oe-T.left,D=u.innerWidth-N-Oe-st-1}else k=T.left+outerWidth(v)-N,D=N-R.left-1;if(this.isEntireColumnSelected(t,s)){const _e=t,Oe=this.getDimensionsFromHeader("columns",n,o,_e,R);let st=null;Oe&&([st,D,k]=Oe),st&&(E=st)}let z=O-R.top-1,ne=T.top+outerHeight(v)-O;if(this.isEntireRowSelected(n,o)){const _e=n,Oe=this.getDimensionsFromHeader("rows",t,s,_e,R);let st=null;Oe&&([st,z,ne]=Oe),st&&(E=st)}const Z=u.getComputedStyle(E);parseInt(Z.borderTopWidth,10)>0&&(z+=1,ne=ne>0?ne-1:0),parseInt(Z[G?"borderRightWidth":"borderLeftWidth"],10)>0&&(D+=1,k=k>0?k-1:0);const ve=G?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[ve]=`${D}px`,this.topStyle.width=`${k}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[ve]=`${D}px`,this.startStyle.height=`${ne}px`,this.startStyle.display="block";const xe=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+ne-xe}px`,this.bottomStyle[ve]=`${D}px`,this.bottomStyle.width=`${k}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[ve]=`${D+k-xe}px`,this.endStyle.height=`${ne+1}px`,this.endStyle.display="block";let de=this.settings.border.cornerVisible;de=typeof de=="function"?de(this.settings.layerLevel):de;const Se=this.wot.getSetting("onModifyGetCellCoords",s,o,!1,"render");let[Me,Pe]=[s,o];if(Se&&Array.isArray(Se)&&([,,Me,Pe]=Se),isMobileBrowser()||!de||this.isPartRange(Me,Pe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+ne+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[ve]=`${D+k+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let _e=getTrimmingContainer(a.TABLE);const Oe=_e===u;Oe&&(_e=l.documentElement);const st=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,rt=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),U=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const te=Oe?v.getBoundingClientRect().left:v.offsetLeft;let V=!1,ue=0;G?(ue=te-parseInt(this.cornerDefaultStyle.width,10)/2,V=ue<0):(ue=te+outerWidth(v)+parseInt(this.cornerDefaultStyle.width,10)/2,V=ue>=innerWidth(_e)),V&&(this.cornerStyle[ve]=`${Math.floor(D+k+this.cornerCenterPointOffset-rt-st)}px`,this.cornerStyle[G?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(Oe?v.getBoundingClientRect().top:v.offsetTop)+outerHeight(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight$1(_e)&&(this.cornerStyle.top=`${Math.floor(z+ne+this.cornerCenterPointOffset-U-st)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,o,z,D,k,ne)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,s,o){const{wtTable:a}=this.wot,l=a.wtRootElement.parentNode;let u=null,c=null,d=null,f=null,C=null,m=null,E=null,v=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},c=function(){return outerHeight(...arguments)},d="ht__selection--rows",m="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},c=function(){return outerWidth(...arguments)},d="ht__selection--columns",m="left";break}if(l.classList.contains(d)){const _=this.wot.getSetting("columnHeaders").length;if(E=u(t,_-s),v=u(n,_-s),!E||!v)return!1;const T=offset$2(E),R=offset$2(v);return E&&v&&(f=T[m]-o[m]-1,C=R[m]+c(v)-T[m]),[E,f,C]}return!1}changeBorderStyle(e,t){const n=this[e].style,s=t[e];!s||s.hide?addClass$1(this[e],"hidden"):(hasClass$1(this[e],"hidden")&&removeClass$1(this[e],"hidden"),n.backgroundColor=s.color,(e==="top"||e==="bottom")&&(n.height=`${s.width}px`),(e==="start"||e==="end")&&(n.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width=`${t.width}px`,n.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?addClass$1(this[e],"hidden"):removeClass$1(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _classPrivateMethodInitSpec$M(r,e){_checkPrivateRedeclaration$12(r,e),e.add(r)}function _classPrivateFieldInitSpec$M(r,e,t){_checkPrivateRedeclaration$12(r,e),e.set(r,t)}function _checkPrivateRedeclaration$12(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$M(r,e){return r.get(_assertClassBrand$12(r,e))}function _classPrivateFieldSet$K(r,e,t){return r.set(_assertClassBrand$12(r,e),t),t}function _assertClassBrand$12(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet;class SelectionManager{constructor(e){_classPrivateMethodInitSpec$M(this,_SelectionManager_brand),_classPrivateFieldInitSpec$M(this,_activeOverlaysWot,void 0),_classPrivateFieldInitSpec$M(this,_selections,void 0),_classPrivateFieldInitSpec$M(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec$M(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec$M(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec$M(this,_selectionBorders,new Map),_classPrivateFieldSet$K(_selections,this,e)}setActiveOverlay(e){return _classPrivateFieldSet$K(_activeOverlaysWot,this,e),_classPrivateFieldGet$M(_scanner,this).setActiveOverlay(_classPrivateFieldGet$M(_activeOverlaysWot,this)),_classPrivateFieldGet$M(_appliedClasses,this).has(_classPrivateFieldGet$M(_activeOverlaysWot,this))||_classPrivateFieldGet$M(_appliedClasses,this).set(_classPrivateFieldGet$M(_activeOverlaysWot,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet$M(_selections,this)!==null?_classPrivateFieldGet$M(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet$M(_selections,this)!==null?_classPrivateFieldGet$M(_selections,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_classPrivateFieldGet$M(_selectionBorders,this).has(e)){const n=_classPrivateFieldGet$M(_selectionBorders,this).get(e);if(n.has(_classPrivateFieldGet$M(_activeOverlaysWot,this)))return n.get(_classPrivateFieldGet$M(_activeOverlaysWot,this));const s=new Border(_classPrivateFieldGet$M(_activeOverlaysWot,this),e.settings);return n.set(_classPrivateFieldGet$M(_activeOverlaysWot,this),s),s}const t=new Border(_classPrivateFieldGet$M(_activeOverlaysWot,this),e.settings);return _classPrivateFieldGet$M(_selectionBorders,this).set(e,new Map([[_classPrivateFieldGet$M(_activeOverlaysWot,this),t]])),t}getBorderInstances(e){var t,n;return Array.from((t=(n=_classPrivateFieldGet$M(_selectionBorders,this).get(e))===null||n===void 0?void 0:n.values())!==null&&t!==void 0?t:[])}destroyBorders(e){_classPrivateFieldGet$M(_selectionBorders,this).get(e).forEach(t=>t.destroy()),_classPrivateFieldGet$M(_selectionBorders,this).delete(e)}render(e){if(_classPrivateFieldGet$M(_selections,this)===null)return;e&&_assertClassBrand$12(_SelectionManager_brand,this,_resetCells).call(this);const t=Array.from(_classPrivateFieldGet$M(_selections,this)),n=new Map,s=new Map;for(let o=0;o<t.length;o++){const a=t[o],{className:l,headerAttributes:u,createLayers:c,selectionType:d}=a.settings;_classPrivateFieldGet$M(_destroyListeners,this).has(a)||(_classPrivateFieldGet$M(_destroyListeners,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const f=this.getBorderInstance(a);if(a.isEmpty()){f==null||f.disappear();continue}l&&_classPrivateFieldGet$M(_scanner,this).setActiveSelection(a).scan().forEach(E=>{if(n.has(E)){const v=n.get(E);v.has(l)&&c===!0?v.set(l,v.get(l)+1):v.set(l,1)}else n.set(E,new Map([[l,1]]));u&&(s.has(E)||s.set(E,[]),E.nodeName==="TH"&&s.get(E).push(...u))});const C=a.getCorners();_classPrivateFieldGet$M(_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",C,d),f==null||f.appear(C)}n.forEach((o,a)=>{var l;const u=Array.from(o).map(c=>{let[d,f]=c;return f===1?d:[d,...Array.from({length:f-1},(C,m)=>`${d}-${m+1}`)]}).flat();u.forEach(c=>_classPrivateFieldGet$M(_appliedClasses,this).get(_classPrivateFieldGet$M(_activeOverlaysWot,this)).add(c)),addClass$1(a,u),a.nodeName==="TD"&&Array.isArray((l=_classPrivateFieldGet$M(_selections,this).options)===null||l===void 0?void 0:l.cellAttributes)&&setAttribute(a,_classPrivateFieldGet$M(_selections,this).options.cellAttributes)}),Array.from(s.keys()).forEach(o=>{setAttribute(o,[...s.get(o)])})}}function _resetCells(){const r=_classPrivateFieldGet$M(_appliedClasses,this).get(_classPrivateFieldGet$M(_activeOverlaysWot,this)),e=_classPrivateFieldGet$M(_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)r.add(e[t]);r.forEach(t=>{var n,s;const o=_classPrivateFieldGet$M(_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${t}`);let a=[];Array.isArray((n=_classPrivateFieldGet$M(_selections,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(a=_classPrivateFieldGet$M(_selections,this).options.cellAttributes.map(l=>l[0])),Array.isArray((s=_classPrivateFieldGet$M(_selections,this).options)===null||s===void 0?void 0:s.headerAttributes)&&(a=[...a,..._classPrivateFieldGet$M(_selections,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,u=o.length;l<u;l++)removeClass$1(o[l],t),removeAttribute(o[l],a)}),r.clear()}class InlineStartOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_INLINE_START,n,s)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new InlineStartOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===t&&(!s||s!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(n,`${o}px`,"0px")):(o=this.getScrollPosition(),resetCssTransform(n));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,getWindowScrollTop(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let s=e,o=0;for(;s<t;)o+=this.wot.wtTable.getColumnWidth(s)||n,s+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="vertical"){let c=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollHeight),a.height=`${c}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const u=outerWidth(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=getCornerStyle(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,s=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=o===0&&s.length>0&&!hasClass$1(l.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),d=0;if(t){const f=this.wot.wtTable.getColumnWidth(e),C=this.wot.wtViewport.getViewportWidth();f>C&&(t=!1)}return t&&l.offsetWidth!==l.clientWidth&&(d=getScrollbarWidth(this.domBindings.rootDocument)),t?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=u):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=d,getMaximumScrollLeft(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=s-o;n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,s=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),a=t.getSetting("totalRows"),l=t.getSetting("preventOverflow")==="vertical";a?removeClass$1(n,"emptyRows"):addClass$1(n,"emptyRows");let u=!1;if(!l){if(o&&!s.length)addClass$1(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&s.length){const c=hasClass$1(n,"innerBorderInlineStart");e?(addClass$1(n,"innerBorderLeft innerBorderInlineStart"),u=!c):(removeClass$1(n,"innerBorderLeft innerBorderInlineStart"),u=c)}}return u}}const MIXIN_NAME="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});class TopInlineStartCornerOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_TOP_INLINE_START_CORNER)}}mixin(TopInlineStartCornerOverlayTable,stickyRowsTop);mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart);function _defineProperty$1h(r,e,t){return(e=_toPropertyKey$1h(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1h(r){var e=_toPrimitive$1h(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1h(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TopInlineStartCornerOverlay extends Overlay{constructor(e,t,n,s,o,a){super(e,t,CLONE_TOP_INLINE_START_CORNER,n,s),_defineProperty$1h(this,"topOverlay",void 0),_defineProperty$1h(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new TopInlineStartCornerOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();setOverlayPosition(e,`${s}px`,`${o}px`)}else resetCssTransform(e);let t=outerHeight(this.clone.wtTable.TABLE);const n=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class TopOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_TOP)}}mixin(TopOverlayTable,stickyRowsTop);mixin(TopOverlayTable,calculatedColumns);function _defineProperty$1g(r,e,t){return(e=_toPropertyKey$1g(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1g(r){var e=_toPrimitive$1g(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1g(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TopOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_TOP,n,s),_defineProperty$1g(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new TopOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let s=0,o=!1;if(this.trimmingContainer===t&&(!n||n!=="vertical")){const{wtTable:l}=this.wot,u=l.hider.getBoundingClientRect(),c=Math.ceil(u.bottom),d=e.offsetHeight;o=c===d,s=this.getOverlayOffset(),setOverlayPosition(e,"0px",`${s}px`)}else s=this.getScrollPosition(),resetCssTransform(e);const a=this.adjustHeaderBordersPosition(s,o);return this.adjustElementsSize(),a}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(getWindowScrollLeft(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wot.stylesHandler.getDefaultRowHeight();let s=e,o=0;for(;s<t;){const a=this.wot.wtTable.getRowHeight(s);o+=a===void 0?n:a,s+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let c=t.getWorkspaceWidth();t.hasVerticalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=getCornerStyle(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:s}=this,a=(n.cloneSource?n.cloneSource:n).wtTable.holder,l=s.getSetting("columnHeaders"),c=s.getSetting("fixedRowsTop")===0&&l.length>0&&!hasClass$1(a.parentNode,"innerBorderTop")?1:0;let d=this.getTableParentOffset(),f=0;if(t){const C=this.wot.wtTable.getRowHeight(e),m=this.wot.wtViewport.getViewportHeight();C>m&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(f=getScrollbarWidth(this.domBindings.rootDocument)),t){const C=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");d+=this.sumCellSizes(0,e+1),d-=n.wtViewport.getViewportHeight()-this.sumCellSizes(m-C,m),d+=1,d+=c}else d+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return d+=f,getMaximumScrollTop(this.mainTableScrollableElement)===d-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=s-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,s=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),a=n.getSetting("preventOverflow")==="horizontal";o?removeClass$1(s,"emptyColumns"):addClass$1(s,"emptyColumns");let l=!1;if(!t&&!a){const u=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,d=n.getSetting("columnHeaders");if((c||u===0)&&d.length>0){const f=hasClass$1(s,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(addClass$1(s,"innerBorderTop"),l=!f):(removeClass$1(s,"innerBorderTop"),l=f)}}return l}}function _classPrivateFieldInitSpec$L(r,e,t){_checkPrivateRedeclaration$11(r,e),e.set(r,t)}function _checkPrivateRedeclaration$11(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1f(r,e,t){return(e=_toPropertyKey$1f(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1f(r){var e=_toPrimitive$1f(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1f(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$J(r,e,t){return r.set(_assertClassBrand$11(r,e),t),t}function _classPrivateFieldGet$L(r,e){return r.get(_assertClassBrand$11(r,e))}function _assertClassBrand$11(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap;class Overlays{constructor(e,t,n,s,o,a){_defineProperty$1f(this,"wot",null),_classPrivateFieldInitSpec$L(this,_overlays,[]),_defineProperty$1f(this,"topOverlay",null),_defineProperty$1f(this,"bottomOverlay",null),_defineProperty$1f(this,"inlineStartOverlay",null),_defineProperty$1f(this,"topInlineStartCornerOverlay",null),_defineProperty$1f(this,"bottomInlineStartCornerOverlay",null),_defineProperty$1f(this,"browserLineHeight",void 0),_defineProperty$1f(this,"wtSettings",null),_classPrivateFieldInitSpec$L(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec$L(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec$L(this,_containerDomResizeCountTimeout,null),_defineProperty$1f(this,"resizeObserver",new ResizeObserver(d=>{requestAnimationFrame$1(()=>{!Array.isArray(d)||!d.length||(_classPrivateFieldSet$J(_containerDomResizeCount,this,_classPrivateFieldGet$L(_containerDomResizeCount,this)+1),_classPrivateFieldGet$L(_containerDomResizeCount,this)===100&&(warn$1("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet$L(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet$L(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet$J(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=s,this.domBindings=n,this.facadeGetter=t,this.wtTable=a;const{rootDocument:l,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=getScrollbarWidth(l);const c=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:getScrollableElement(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[..._classPrivateFieldGet$L(_overlays,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),s=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=s||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...e),this.bottomOverlay=new BottomOverlay(...e),this.inlineStartOverlay=new InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet$J(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet$J(_hasRenderingStateChanged,this,_classPrivateFieldGet$L(_overlays,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),_classPrivateFieldGet$L(_overlays,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet$L(_overlays,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",f=>this.onTableScroll(f),{passive:!0}),n!==s&&this.eventManager.addEventListener(s,"scroll",f=>this.onTableScroll(f),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,l=this.wtSettings.getSetting("preventWheel"),u={passive:a};(l||o||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,l),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{if(f&&f.needFullRender){const{holder:C}=f.clone.wtTable;this.eventManager.addEventListener(C,"wheel",m=>this.onCloneWheel(m,l),u)}});let d;this.eventManager.addEventListener(t,"resize",()=>{requestAnimationFrame$1(()=>{clearTimeout(d),this.wtSettings.getSetting("onWindowResize"),d=setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(s!==t&&o!==t&&!e.target.contains(s)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,l=o!==n&&a!==n&&!a.contains(o),u=s!==n&&a!==n&&!a.contains(s);if(this.keyPressed&&(l||u)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=isKey(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const s=this.scrollVertically(t),o=this.scrollHorizontally(n);return s||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[s,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=s;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=s)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet$L(_hasRenderingStateChanged,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),_classPrivateFieldSet$J(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=getScrollableElement(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,s=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),s}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,s=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,d=l+this.inlineStartOverlay.sumCellSizes(0,o),C=t.hider.style,m=()=>s?!1:this.scrollableElement.scrollTop>Math.max(0,c-t.holder.clientHeight),E=()=>s?!1:this.scrollableElement.scrollLeft>Math.max(0,d-t.holder.clientWidth),v=m()?1:0,_=E()?1:0;C.width=`${d+_}px`,C.height=`${c+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return arrayEach(t,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(n=s.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(t,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function _defineProperty$1e(r,e,t){return(e=_toPropertyKey$1e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1e(r){var e=_toPrimitive$1e(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1e(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Settings{constructor(e){_defineProperty$1e(this,"settings",{}),_defineProperty$1e(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(t,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(t===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const s=this.getSetting("data",e,t);fastInnerText(n,s??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?objectEach(e,(n,s)=>{this.settings[s]=n}):this.settings[e]=t,this}getSetting(e,t,n,s,o){return typeof this.settings[e]=="function"?this.settings[e](t,n,s,o):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class MasterTable extends Table{constructor(e,t,n,s){super(e,t,n,s,"master")}alignOverlaysWithTrimmingContainer(){const e=getTrimmingContainer(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,s=getStyle(e,"height",t),o=getStyle(e,"overflow",t),a=this.holder.style,{scrollWidth:l,scrollHeight:u}=e;let c=e.offsetWidth,d=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const C=e.cloneNode(!1);C.style.overflow="auto",C.style.position="absolute",e.nextElementSibling?n.insertBefore(C,e.nextElementSibling):n.appendChild(C);const m=parseInt(t.getComputedStyle(C).height,10);n.removeChild(C),m===0&&(d=0)}d=Math.min(d,u),a.height=s==="auto"?"auto":`${d}px`,c=Math.min(c,l),a.width=`${c}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:d>0,this.hasTableWidth=c>0}this.isTableVisible=isVisible(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[n]){const l=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let c=0;c<o;c++)for(let d=-1*l;d<u;d++)this.markIfOversizedColumnHeader(d);t.hasOversizedColumnHeadersMarked[n]=!0}}}mixin(MasterTable,calculatedRows);mixin(MasterTable,calculatedColumns);class Viewport{constructor(e,t,n,s,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=outerHeight(t)>0&&t.clientHeight>0?t.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let s;if(n===t){const o=this.wtSettings.getSetting("totalColumns");s=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>s&&(s=e.documentElement.clientWidth)}else s=n.clientWidth;return s}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,s=e;for(;s<t;)n+=this.wtTable.getColumnWidth(s),s+=1;return n}getWorkspaceOffset(){return offset$2(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,s=t.length;n<s;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,o=t.length;s<o;s++)n?(this.rowHeaderWidth+=outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const u=t.getSetting("fixedRowsTop"),c=t.getSetting("fixedRowsBottom"),d=t.getSetting("totalRows");return u&&l>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=a,s-=a),c&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(d-c,d),s-=a),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:e.map(f=>[f,this.rowsCalculatorTypes.get(f)()]),viewportHeight:s,scrollOffset:l,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:f=>n.getRowHeight(f),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=t.getSetting("fixedColumnsStart");if(a&&o>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=l,s-=l}return n.holder.clientWidth!==n.holder.offsetWidth&&(s-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:e.map(l=>[l,this.columnsCalculatorTypes.get(l)()]),viewportWidth:s,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:l=>n.getColumnWidth(l),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,n=this.createRowsCalculator(),s=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!t.getSetting("renderAllColumns")){const o=s.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=s.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=s.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:s,endRow:o,rowStartOffset:a,rowEndOffset:l}=this.rowsRenderCalculator,u=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(t=Math.max(0,t-Math.min(a,c)),n=Math.min(u,n+Math.min(l,c))):c==="auto"&&(t=Math.max(0,t-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(l/2))),t<s||t===s&&t>0?!1:!(n>o||n===o&&n<u)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:s,endColumn:o,columnStartOffset:a,columnEndOffset:l}=this.columnsRenderCalculator,u=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(t=Math.max(0,t-Math.min(a,c)),n=Math.min(u,n+Math.min(l,c))):c==="auto"&&(t=Math.max(0,t-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(l/2))),t<s||t===s&&t>0?!1:!(n>o||n===o&&n<u)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}function _classPrivateMethodInitSpec$L(r,e){_checkPrivateRedeclaration$10(r,e),e.add(r)}function _classPrivateFieldInitSpec$K(r,e,t){_checkPrivateRedeclaration$10(r,e),e.set(r,t)}function _checkPrivateRedeclaration$10(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$K(r,e){return r.get(_assertClassBrand$10(r,e))}function _classPrivateFieldSet$I(r,e,t){return r.set(_assertClassBrand$10(r,e),t),t}function _assertClassBrand$10(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const CLASSIC_THEME_DEFAULT_HEIGHT=23;var _themeName=new WeakMap,_rootElement=new WeakMap,_rootComputedStyle=new WeakMap,_rootDocument$1=new WeakMap,_isClassicTheme=new WeakMap,_cssVars=new WeakMap,_computedStyles=new WeakMap,_StylesHandler_brand=new WeakSet;class StylesHandler{constructor(e){_classPrivateMethodInitSpec$L(this,_StylesHandler_brand),_classPrivateFieldInitSpec$K(this,_themeName,void 0),_classPrivateFieldInitSpec$K(this,_rootElement,void 0),_classPrivateFieldInitSpec$K(this,_rootComputedStyle,void 0),_classPrivateFieldInitSpec$K(this,_rootDocument$1,void 0),_classPrivateFieldInitSpec$K(this,_isClassicTheme,!0),_classPrivateFieldInitSpec$K(this,_cssVars,{}),_classPrivateFieldInitSpec$K(this,_computedStyles,{}),_classPrivateFieldSet$I(_rootElement,this,e.rootTable.parentElement.parentElement),_classPrivateFieldSet$I(_rootDocument$1,this,e.rootDocument)}isClassicTheme(){return _classPrivateFieldGet$K(_isClassicTheme,this)}getCSSVariableValue(e){var t;if(_classPrivateFieldGet$K(_isClassicTheme,this))return null;if(_classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`])return _classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`];const n=(t=_assertClassBrand$10(_StylesHandler_brand,this,_getParsedNumericCSSValue).call(this,`--ht-${e}`))!==null&&t!==void 0?t:_assertClassBrand$10(_StylesHandler_brand,this,_getCSSValue).call(this,`--ht-${e}`);if(n!==null)return _classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var t;return(t=_classPrivateFieldGet$K(_computedStyles,this))===null||t===void 0?void 0:t.td[e]}getDefaultRowHeight(){if(_classPrivateFieldGet$K(_isClassicTheme,this))return CLASSIC_THEME_DEFAULT_HEIGHT;const e=_assertClassBrand$10(_StylesHandler_brand,this,_calculateRowHeight).call(this);return!e&&hasClass$1(_classPrivateFieldGet$K(_rootElement,this),"ht-wrapper")?(warn$1(`The "${_classPrivateFieldGet$K(_themeName,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),_classPrivateFieldSet$I(_isClassicTheme,this,!0),this.useTheme(),CLASSIC_THEME_DEFAULT_HEIGHT):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){_assertClassBrand$10(_StylesHandler_brand,this,_cacheStylesheetValues).call(this),_classPrivateFieldSet$I(_isClassicTheme,this,!0),_classPrivateFieldSet$I(_themeName,this,e||void 0);return}e&&e!==_classPrivateFieldGet$K(_themeName,this)&&(_classPrivateFieldGet$K(_themeName,this)&&_assertClassBrand$10(_StylesHandler_brand,this,_clearCachedValues).call(this),_classPrivateFieldSet$I(_themeName,this,e),_classPrivateFieldSet$I(_isClassicTheme,this,!1),_assertClassBrand$10(_StylesHandler_brand,this,_applyClassNames).call(this),_assertClassBrand$10(_StylesHandler_brand,this,_cacheStylesheetValues).call(this))}getThemeName(){return _classPrivateFieldGet$K(_themeName,this)}removeClassNames(){hasClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))&&removeClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))}}function _calculateRowHeight(){const r=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),t=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return r===null||e===null||isNaN(t)?null:r+2*e+t}function _applyClassNames(){removeClass$1(_classPrivateFieldGet$K(_rootElement,this),/ht-theme-.*/g),addClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))}function _cacheStylesheetValues(){this.isClassicTheme()||_classPrivateFieldSet$I(_rootComputedStyle,this,getComputedStyle(_classPrivateFieldGet$K(_rootElement,this)));const r=_assertClassBrand$10(_StylesHandler_brand,this,_getStylesForTD).call(this,["box-sizing","border-bottom-width"]);_classPrivateFieldGet$K(_computedStyles,this).td={..._classPrivateFieldGet$K(_computedStyles,this).td,"box-sizing":r["box-sizing"],"border-bottom-width":r["border-bottom-width"]}}function _getStylesForTD(r){const e=_classPrivateFieldGet$K(_rootDocument$1,this),t=_classPrivateFieldGet$K(_rootElement,this),n=e.createElement("table"),s=e.createElement("tbody"),o=e.createElement("tr"),a=e.createElement("tr"),l=e.createElement("td");a.appendChild(l),s.appendChild(o),s.appendChild(a),n.appendChild(s),t.appendChild(n);const u=getComputedStyle(l),c={};return r.forEach(d=>{c[d]=u.getPropertyValue(d)}),t.removeChild(n),c}function _getParsedNumericCSSValue(r){const e=Math.ceil(parseFloat(_assertClassBrand$10(_StylesHandler_brand,this,_getCSSValue).call(this,r)));return Number.isNaN(e)?null:e}function _getCSSValue(r){const e=_classPrivateFieldGet$K(_rootComputedStyle,this).getPropertyValue(r);return e===""?null:e}function _clearCachedValues(){_classPrivateFieldSet$I(_computedStyles,this,{}),_classPrivateFieldSet$I(_cssVars,this,{}),_classPrivateFieldSet$I(_isClassicTheme,this,!0)}class Walkontable extends CoreAbstract{constructor(e,t){super(e,new Settings(t)),this.stylesHandler=new StylesHandler(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new MasterTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Viewport(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new Event$1(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Overlays(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],n=[];objectEach(e,(s,o)=>{this.wtSettings.getSetting(o).length&&n.push(s),t.push(s)}),removeClass$1(this.wtTable.wtRootElement.parentNode,t),addClass$1(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var t;if(!CLONE_TYPES.includes(e))return null;const n=e.replace(/_([a-z])/g,s=>s[1].toUpperCase());return(t=this.wtOverlays[`${n}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class WalkontableFacade{constructor(e){e instanceof CoreAbstract?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const n=new WalkontableFacade(t);return()=>n},this._wot=new Walkontable(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,s,o){return this._wot.wtSettings.getSetting(e,t,n,s,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}var esnext_iterator_some={},es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{some:function(a){n(this),t(a);var l=s(this),u=0;return e(l,function(c,d){if(a(c,u++))return d()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var hasRequiredEsnext_iterator_some;function requireEsnext_iterator_some(){return hasRequiredEsnext_iterator_some||(hasRequiredEsnext_iterator_some=1,requireEs_iterator_some()),esnext_iterator_some}requireEsnext_iterator_some();function _defineProperty$1d(r,e,t){return(e=_toPropertyKey$1d(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1d(r){var e=_toPrimitive$1d(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1d(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class IndexMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1d(this,"indexedValues",[]),_defineProperty$1d(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction$2(this.initValueOrFn)?rangeEach(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):rangeEach(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mixin(IndexMap,localHooks);function getListWithInsertedItems$3(r,e,t,n){const s=t.length?t[0]:void 0;return[...r.slice(0,s),...t.map((o,a)=>isFunction$2(n)?n(o,a):n),...s===void 0?[]:r.slice(s)]}function getListWithRemovedItems$3(r,e){return arrayFilter(r,(t,n)=>e.includes(n)===!1)}class PhysicalIndexToValueMap extends IndexMap{insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),super.remove(e)}}class HidingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return arrayReduce(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function getListWithInsertedItems$2(r,e,t){return[...r.slice(0,e),...t,...r.slice(e)]}function getListWithRemovedItems$2(r,e){return arrayFilter(r,t=>e.includes(t)===!1)}function getDecreasedIndexes(r,e){return arrayMap(r,t=>t-e.filter(n=>n<t).length)}function getIncreasedIndexes(r,e){const t=e[0],n=e.length;return arrayMap(r,s=>s>=t?s+n:s)}function _defineProperty$1c(r,e,t){return(e=_toPropertyKey$1c(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1c(r){var e=_toPrimitive$1c(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1c(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class LinkedPhysicalIndexToValueMap extends IndexMap{constructor(){super(...arguments),_defineProperty$1c(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[e]),isFunction$2(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,e),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class TrimmingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=r=>{if(alterStrategies.has(r)===!1)throw new Error(`Alter strategy with ID '${r}' does not exist.`);return alterStrategies.get(r)};class IndexesSequence extends IndexMap{constructor(){super(e=>e)}insert(e,t){const n=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$2(n,e,t),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}}const availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(r))throw new Error(`The provided map type ("${r}") does not exist.`);return new(availableIndexMapTypes.get(r))(e)}function _defineProperty$1b(r,e,t){return(e=_toPropertyKey$1b(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1b(r){var e=_toPrimitive$1b(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1b(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class MapCollection{constructor(){_defineProperty$1b(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);isDefined(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return isUndefined$1(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}mixin(MapCollection,localHooks);function _defineProperty$1a(r,e,t){return(e=_toPropertyKey$1a(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1a(r){var e=_toPrimitive$1a(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1a(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class AggregatedCollection extends MapCollection{constructor(e,t){super(),_defineProperty$1a(this,"mergedValuesCache",[]),_defineProperty$1a(this,"aggregationFunction",void 0),_defineProperty$1a(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=arrayMap(this.get(),o=>o.getValues()),n=[],s=isDefined(t[0])&&t[0].length||0;for(let o=0;o<s;o+=1){const a=[];for(let l=0;l<this.getLength();l+=1)a.push(t[l][o]);n.push(a)}return arrayMap(n,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return isDefined(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function _classPrivateFieldInitSpec$J(r,e,t){_checkPrivateRedeclaration$$(r,e),e.set(r,t)}function _checkPrivateRedeclaration$$(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$H(r,e,t){return r.set(_assertClassBrand$$(r,e),t),t}function _classPrivateFieldGet$J(r,e){return r.get(_assertClassBrand$$(r,e))}function _assertClassBrand$$(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap;class ChangesObserver{constructor(){_classPrivateFieldInitSpec$J(this,_currentInitialChanges,[])}subscribe(e){return this.addLocalHook("change",e),this._write(_classPrivateFieldGet$J(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_classPrivateFieldSet$H(_currentInitialChanges,this,e)}}mixin(ChangesObserver,localHooks);function arrayDiff(r,e){const t=[];let n=0,s=0;for(;n<r.length&&s<e.length;n++,s++)r[n]!==e[s]&&t.push({op:"replace",index:s,oldValue:r[n],newValue:e[s]});for(;n<e.length;n++)t.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;s<r.length;s++)t.push({op:"remove",index:s,oldValue:r[s],newValue:void 0});return t}function _classPrivateFieldInitSpec$I(r,e,t){_checkPrivateRedeclaration$_(r,e),e.set(r,t)}function _checkPrivateRedeclaration$_(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$I(r,e){return r.get(_assertClassBrand$_(r,e))}function _classPrivateFieldSet$G(r,e,t){return r.set(_assertClassBrand$_(r,e),t),t}function _assertClassBrand$_(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap;class ChangesObservable{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec$I(this,_observers,new Set),_classPrivateFieldInitSpec$I(this,_indexMatrix,[]),_classPrivateFieldInitSpec$I(this,_currentIndexState,[]),_classPrivateFieldInitSpec$I(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec$I(this,_initialIndexValue,!1),_classPrivateFieldSet$G(_initialIndexValue,this,e??!1)}createObserver(){const e=new ChangesObserver;return _classPrivateFieldGet$I(_observers,this).add(e),e.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet$I(_observers,this).delete(e)}),e._writeInitialChanges(arrayDiff(_classPrivateFieldGet$I(_indexMatrix,this),_classPrivateFieldGet$I(_currentIndexState,this))),e}emit(e){let t=_classPrivateFieldGet$I(_currentIndexState,this);(!_classPrivateFieldGet$I(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet$I(_indexMatrix,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(_classPrivateFieldGet$I(_initialIndexValue,this)):_classPrivateFieldSet$G(_indexMatrix,this,new Array(e.length).fill(_classPrivateFieldGet$I(_initialIndexValue,this))),_classPrivateFieldGet$I(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet$G(_isMatrixIndexesInitialized,this,!0),t=_classPrivateFieldGet$I(_indexMatrix,this)));const n=arrayDiff(t,e);_classPrivateFieldGet$I(_observers,this).forEach(s=>s._write(n)),_classPrivateFieldSet$G(_currentIndexState,this,e)}}function _defineProperty$19(r,e,t){return(e=_toPropertyKey$19(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$19(r){var e=_toPrimitive$19(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$19(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class IndexMapper{constructor(){_defineProperty$19(this,"indexesSequence",new IndexesSequence),_defineProperty$19(this,"trimmingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$19(this,"hidingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$19(this,"variousMapsCollection",new MapCollection),_defineProperty$19(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty$19(this,"notTrimmedIndexesCache",[]),_defineProperty$19(this,"notHiddenIndexesCache",[]),_defineProperty$19(this,"isBatched",!1),_defineProperty$19(this,"indexesSequenceChanged",!1),_defineProperty$19(this,"indexesChangeSource",void 0),_defineProperty$19(this,"trimmedIndexesChanged",!1),_defineProperty$19(this,"hiddenIndexesChanged",!1),_defineProperty$19(this,"renderablePhysicalIndexesCache",[]),_defineProperty$19(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty$19(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,createIndexMap(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof TrimmingMap?this.trimmingMapsCollection.register(e,t):t instanceof HidingMap?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return isDefined(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return isDefined(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return t>0?a=o.findIndex(l=>l>e):a=o.reverse().findIndex(l=>l<e),a===-1?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(n)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const n=arrayMap(e,c=>this.getPhysicalFromVisualIndex(c)),s=this.getNotTrimmedIndexesLength(),o=e.length,a=getListWithRemovedItems$2(this.getIndexesSequence(),n),l=a.filter(c=>this.isTrimmed(c)===!1);let u=a.indexOf(l[l.length-1])+1;if(t+o<s){const c=l[t];u=a.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems$2(a,u,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],s=isDefined(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=arrayMap(new Array(t).fill(s),(l,u)=>l+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromRenderableIndex(t),s=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(s,t)}}}mixin(IndexMapper,localHooks);function _classPrivateMethodInitSpec$K(r,e){_checkPrivateRedeclaration$Z(r,e),e.add(r)}function _classPrivateFieldInitSpec$H(r,e,t){_checkPrivateRedeclaration$Z(r,e),e.set(r,t)}function _checkPrivateRedeclaration$Z(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$18(r,e,t){return(e=_toPropertyKey$18(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$18(r){var e=_toPrimitive$18(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$18(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$H(r,e){return r.get(_assertClassBrand$Z(r,e))}function _classPrivateFieldSet$F(r,e,t){return r.set(_assertClassBrand$Z(r,e),t),t}function _assertClassBrand$Z(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutoColumnSizeSeed");const PLUGIN_KEY$x="autoColumnSize",PLUGIN_PRIORITY$w=10,COLUMN_SIZE_MAP_NAME="autoColumnSize";var _cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet;class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$x}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$w}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),_classPrivateMethodInitSpec$K(this,_AutoColumnSize_brand),_defineProperty$18(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$18(this,"samplesGenerator",new SamplesGenerator((t,n)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o))return!1;const a=this.hot.getCellMeta(t,n);let l="";a.spanned||(l=this.hot.getDataAtCell(t,n));let u="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=this.hot.runHooks("modifyAutoColumnSizeSeed",u,a,l)),{value:l,bundleSeed:u}})),_defineProperty$18(this,"inProgress",!1),_defineProperty$18(this,"measuredColumns",0),_defineProperty$18(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$H(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec$H(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,n,s)=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,t,n,s))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$x]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onAfterLoadData$7).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onBeforeChange$1).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onAfterFormulasValuesUpdate$1).call(e,...s)}),this.addHook("beforeRender",()=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeRender$2).call(this)),this.addHook("modifyColWidth",(n,s)=>this.getColumnWidth(s,n)),this.addHook("init",()=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onInit$3).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet$F(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,e,t,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;rangeEach(s.from,s.to,a=>{let l=this.hot.toPhysicalColumn(a);l===null&&(l=a),(n||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l))&&this.samplesGenerator.generateColumnSamples(a,o).forEach((c,d)=>this.ghostTable.addColumn(d,c))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,l)=>{const u=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(u,l)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const s=this.hot.countCols()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){cancelAnimationFrame$1(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+AutoColumnSize.CALCULATION_STEP,s)},e,t),n=n+AutoColumnSize.CALCULATION_STEP+1,n<s?o=requestAnimationFrame$1(a):(cancelAnimationFrame$1(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateColumnsWidth({from:0,to:l},e,t),n=l+1),n<s?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$x];let t=AutoColumnSize.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return isObject$1(e)&&(t=e.syncLimit,isPercentValue(t)?t=valueAccordingPercent(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof s=="number"&&(s=Math.max(s,DEFAULT_WIDTH))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,s,o)=>{const a=_classPrivateFieldGet$H(_cachedColumnHeaders,this).length;return(a-1<o||_classPrivateFieldGet$H(_cachedColumnHeaders,this)[o]!==s)&&n.push(this.hot.toVisualColumn(o)),a-1<o?_classPrivateFieldGet$H(_cachedColumnHeaders,this).push(s):_classPrivateFieldGet$H(_cachedColumnHeaders,this)[o]=s,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificColumnsWidth(r){const e={from:0,to:this.hot.countRows()-1};r.forEach(t=>{const n=this.hot.toPhysicalColumn(t);n!==null&&(this.hot._getColWidthFromSettings(n)||this.samplesGenerator.generateColumnSamples(t,e).forEach((o,a)=>this.ghostTable.addColumn(a,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,n)=>{const s=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(s,n)})},!0),this.ghostTable.clean())}function _onBeforeRender$2(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand$Z(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet$H(_visualColumnsToRefresh,this)),_classPrivateFieldSet$F(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData$7(r,e){e||this.recalculateAllColumnsWidth()}function _onBeforeChange$1(r){const e=r.reduce((t,n)=>{let[,s]=n;const o=this.hot.propToCol(s);return Number.isInteger(o)&&t.indexOf(o)===-1&&t.push(o),t},[]);_classPrivateFieldGet$H(_visualColumnsToRefresh,this).push(...e)}function _onBeforeColumnResize$1(r,e,t){let n=r;return t&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function _onInit$3(){_classPrivateFieldSet$F(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate$1(r){const e=r.reduce((t,n)=>{var s;const o=(s=n.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(o)){const a=this.hot.toVisualColumn(o);t.indexOf(a)===-1&&t.push(a)}return t},[]);_classPrivateFieldGet$H(_visualColumnsToRefresh,this).push(...e)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(r,e,t){let n,s,o;return e[0]===r[0]&&e[1]<r[1]?(o="left",n=t(e[0],e[1]),s=t(e[2],r[1]-1)):e[2]===r[2]&&e[0]===r[0]&&e[3]>r[3]?(o="right",n=t(e[0],r[3]+1),s=t(e[2],e[3])):e[0]<r[0]&&e[1]===r[1]?(o="up",n=t(e[0],e[1]),s=t(r[0]-1,e[3])):e[2]>r[2]&&e[1]===r[1]&&(o="down",n=t(r[2]+1,e[1]),s=t(e[2],e[3])),n&&n.normalize(),s&&s.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:s}}function getMappedFillHandleSetting(r){const e={};return r===!0?(e.directions=Object.keys(DIRECTIONS),e.autoInsertRow=!0):isObject$1(r)?(isDefined(r.autoInsertRow)?r.direction===DIRECTIONS.horizontal?e.autoInsertRow=!1:e.autoInsertRow=r.autoInsertRow:e.autoInsertRow=!1,isDefined(r.direction)?e.directions=[r.direction]:e.directions=Object.keys(DIRECTIONS)):typeof r=="string"?(e.directions=[r],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function _classPrivateMethodInitSpec$J(r,e){_checkPrivateRedeclaration$Y(r,e),e.add(r)}function _checkPrivateRedeclaration$Y(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$17(r,e,t){return(e=_toPropertyKey$17(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$17(r){var e=_toPrimitive$17(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$17(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$Y(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutofillRange");Hooks.getSingleton().register("beforeAutofill");Hooks.getSingleton().register("afterAutofill");const PLUGIN_KEY$w="autofill",PLUGIN_PRIORITY$v=20,SETTING_KEYS$3=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200;var _Autofill_brand=new WeakSet;class Autofill extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$J(this,_Autofill_brand),_defineProperty$17(this,"addingStarted",!1),_defineProperty$17(this,"mouseDownOnCellCorner",!1),_defineProperty$17(this,"mouseDragOutside",!1),_defineProperty$17(this,"handleDraggedCells",0),_defineProperty$17(this,"directions",[]),_defineProperty$17(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$w}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$v}static get SETTING_KEYS(){return[PLUGIN_KEY$w,...SETTING_KEYS$3]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$Y(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_assertClassBrand$Y(_Autofill_brand,this,_onCellCornerDblClick).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>_assertClassBrand$Y(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:s,endCol:o}]),l=[],u=[],c=[];return arrayEach(a,d=>{for(let f=d.startRow;f<=d.endRow;f+=1)l.indexOf(f)===-1&&l.push(f);for(let f=d.startCol;f<=d.endCol;f+=1)u.indexOf(f)===-1&&u.push(f)}),arrayEach(l,d=>{const f=[];arrayEach(u,C=>{f.push(this.hot.getCopyableData(d,C))}),c.push(f)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,s]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),l=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const u=[a.row,a.col,l.row,l.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,t),Math.max(l.row,n),Math.max(l.col,s)],u),{directionOfDrag:d,startOfDragCoords:f,endOfDragCoords:C}=getDragDirectionAndRange(u,c,(m,E)=>this.hot._createCellCoords(m,E));if(f&&f.row>-1&&f.col>-1){const m=this.getSelectionData(),E=o.clone(),v=this.hot._createCellRange(f,f,C),_=this.hot.runHooks("beforeAutofill",m,E,v,d);if(_===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let T=_;const R=_;if(["up","left"].indexOf(d)>-1&&!(R.length===1&&R[0].length===0))if(T=[],d==="up"){const O=C.row-f.row+1,N=O%R.length;for(let G=0;G<O;G++)T.push(R[(G+(R.length-N))%R.length])}else{const O=C.col-f.col+1,N=O%R[0].length;for(let G=0;G<R.length;G++){T.push([]);for(let D=0;D<O;D++)T[G].push(R[G][(D+(R[G].length-N))%R[G].length])}}this.hot.populateFromArray(f.row,f.col,T,C.row,C.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",T,E,v,d),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let s=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const o=t.getTopStartCorner();(n.col<=e.col||o.col>=e.col)&&(s=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(s=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(DIRECTIONS.vertical))s=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(DIRECTIONS.horizontal))s=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let s;for(let o=e[2]+1;o<n;o++){for(let u=e[1];u<=e[3];u++){const c=t[o][u];if(!isEmpty$1(c))return-1}const a=t[o][e[1]-1],l=t[o][e[3]+1];(!isEmpty$1(a)||!isEmpty$1(l))&&(s=o)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...arrayMap(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=offset$2(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+outerHeight(this.hot.table),s=offset$2(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+outerWidth(this.hot.table);return e.clientY>n&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$Y(_Autofill_brand,this,_onMouseUp$5).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$Y(_Autofill_brand,this,_onMouseMove$4).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(r){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(r),this.addNewRowIfNeeded())}function _onMouseUp$5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove$4(r){const e=this.getIfMouseWasDraggedOutside(r);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _classPrivateMethodInitSpec$I(r,e){_checkPrivateRedeclaration$X(r,e),e.add(r)}function _classPrivateFieldInitSpec$G(r,e,t){_checkPrivateRedeclaration$X(r,e),e.set(r,t)}function _checkPrivateRedeclaration$X(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$16(r,e,t){return(e=_toPropertyKey$16(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$16(r){var e=_toPrimitive$16(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$16(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$E(r,e,t){return r.set(_assertClassBrand$X(r,e),t),t}function _classPrivateFieldGet$G(r,e){return r.get(_assertClassBrand$X(r,e))}function _assertClassBrand$X(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$v="autoRowSize",PLUGIN_PRIORITY$u=40,ROW_WIDTHS_MAP_NAME="autoRowSize";var _visualRowsToRefresh=new WeakMap,_AutoRowSize_brand=new WeakSet;class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$v}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$u}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_classPrivateMethodInitSpec$I(this,_AutoRowSize_brand),_defineProperty$16(this,"headerHeight",null),_defineProperty$16(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$16(this,"samplesGenerator",new SamplesGenerator((t,n)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o)||t>=0&&n>=0&&this.hot.getCellMeta(t,n).hidden)return!1;let a;return t>=0?a=this.hot.getDataAtCell(t,n):t===-1&&(a=this.hot.getColHeader(n)),{value:a}})),_defineProperty$16(this,"inProgress",!1),_defineProperty$16(this,"measuredRows",0),_defineProperty$16(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$G(this,_visualRowsToRefresh,[]),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(t,n,s)=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,t,n,s))}isEnabled(){const e=this.hot.getSettings()[PLUGIN_KEY$v];return e===!0||isObject$1(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onAfterLoadData$6).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onBeforeChange).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onAfterFormulasValuesUpdate).call(e,...s)}),this.addHook("beforeRender",()=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRender$1).call(this)),this.addHook("modifyRowHeight",(n,s)=>this.getRowHeight(s,n)),this.addHook("init",()=>_assertClassBrand$X(_AutoRowSize_brand,this,_onInit$2).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,n)=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,e,t,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(a.get(-1))}rangeEach(s.from,s.to,a=>{let l=this.hot.toPhysicalRow(a);l===null&&(l=a),(n||this.rowHeightsMap.getValueAtIndex(l)===null)&&this.samplesGenerator.generateRowSamples(a,o).forEach((c,d)=>this.ghostTable.addRow(d,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,l)=>{a<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),l)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const s=this.hot.countRows()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){cancelAnimationFrame$1(o),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+AutoRowSize.CALCULATION_STEP,s)},e,t),n=n+AutoRowSize.CALCULATION_STEP+1,n<s?o=requestAnimationFrame$1(a):(cancelAnimationFrame$1(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateRowsHeight({from:0,to:l},e,t),n=l+1),n<s?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$v];let t=AutoRowSize.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return isObject$1(e)&&(t=e.syncLimit,isPercentValue(t)?t=valueAccordingPercent(n,t):t>>=0),Math.min(t,n)}getRowHeight(e,t){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=t;return n!==null&&n>(t||0)&&(s=n),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{rangeEach(Math.min(t,n),Math.max(t,n),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificRowsHeight(r){const e={from:0,to:this.hot.countCols()-1};r.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((s,o)=>this.ghostTable.addRow(o,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,n)=>{const s=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(s,n)})},!0),this.ghostTable.clean())}function _onBeforeRender$1(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand$X(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet$G(_visualRowsToRefresh,this)),_classPrivateFieldSet$E(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(r,e,t){let n=r;return t&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function _onAfterLoadData$6(r,e){e||this.recalculateAllRowsHeight()}function _onBeforeChange(r){const e=r.reduce((t,n)=>{let[s]=n;return t.indexOf(s)===-1&&t.push(s),t},[]);_classPrivateFieldGet$G(_visualRowsToRefresh,this).push(...e)}function _onInit$2(){this.recalculateAllRowsHeight()}function _onAfterFormulasValuesUpdate(r){const e=r.reduce((t,n)=>{var s;const o=(s=n.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(o)){const a=this.hot.toVisualRow(o);t.indexOf(a)===-1&&t.push(a)}return t},[]);_classPrivateFieldGet$G(_visualRowsToRefresh,this).push(...e)}const{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}=alterUtilsFactory("physicallyIndexed");class LooseBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,t){const n=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$1(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$1(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}}const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class StrictBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,t,(n,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function _classPrivateMethodInitSpec$H(r,e){_checkPrivateRedeclaration$W(r,e),e.add(r)}function _checkPrivateRedeclaration$W(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$15(r,e,t){return(e=_toPropertyKey$15(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$15(r){var e=_toPrimitive$15(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$15(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$W(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$u="bindRowsWithHeaders",PLUGIN_PRIORITY$t=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]);var _BindRowsWithHeaders_brand=new WeakSet;class BindRowsWithHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$H(this,_BindRowsWithHeaders_brand),_defineProperty$15(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$u}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$t}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$u]}enablePlugin(){var e;if(this.enabled)return;const t=(e=bindTypeToMapStrategy.get(this.getSetting()))!==null&&e!==void 0?e:bindTypeToMapStrategy.get(DEFAULT_BIND);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",n=>_assertClassBrand$W(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function _onModifyRowHeader(r){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(r))}function _classPrivateMethodInitSpec$G(r,e){_checkPrivateRedeclaration$V(r,e),e.add(r)}function _classPrivateFieldInitSpec$F(r,e,t){_checkPrivateRedeclaration$V(r,e),e.set(r,t)}function _checkPrivateRedeclaration$V(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$14(r,e,t){return(e=_toPropertyKey$14(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$14(r){var e=_toPrimitive$14(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$14(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$F(r,e){return r.get(_assertClassBrand$V(r,e))}function _classPrivateFieldSet$D(r,e,t){return r.set(_assertClassBrand$V(r,e),t),t}function _assertClassBrand$V(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$t="collapsibleColumns",PLUGIN_PRIORITY$s=290,SETTING_KEYS$2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP$b=PLUGIN_KEY$t,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet;class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$G(this,_CollapsibleColumns_brand),_defineProperty$14(this,"nestedHeadersPlugin",null),_defineProperty$14(this,"headerStateManager",null),_classPrivateFieldInitSpec$F(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$t}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$s}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY$t,...SETTING_KEYS$2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$t]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||warn$1("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$D(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand$V(_CollapsibleColumns_brand,this,_onInit$1).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$V(_CollapsibleColumns_brand,e,_onAfterLoadData$5).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$V(_CollapsibleColumns_brand,e,_onAfterGetColHeader$4).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(n,s,o)=>_assertClassBrand$V(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown$6).call(this,n,s,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$D(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(t,n))!==null&&e!==void 0?e:{};if(s)return o?this.expandSection({row:t,col:a}):this.collapseSection({row:t,col:a}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:SHORTCUTS_GROUP$b,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$b)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};rangeEach(0,e-1,a=>{const l=t.childNodes[a],u=n.childNodes[a],c=s?s.childNodes[a]:null;rangeEach(0,l.childNodes.length-1,d=>{let f=l.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);o(f),u&&u.childNodes[d]&&(f=u.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f)),s&&c&&c.childNodes[d]&&(f=c.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(n=>{const{collapsible:s,origColspan:o,headerLevel:a,columnIndex:l,isCollapsed:u}=n;if(s===!0&&o>1&&(u&&e==="expand"||!u&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:l}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!actionDictionary.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=arrayFilter(e,m=>{let{row:E}=m;return E<0});let s=n.length>0;arrayEach(n,m=>{var E;let{row:v,col:_}=m;const{collapsible:T,isCollapsed:R}=(E=this.headerStateManager.getHeaderSettings(v,_))!==null&&E!==void 0?E:{};if(!T||R&&t==="collapse"||!R&&t==="expand")return s=!1,!1});const o=[],a=[];s&&arrayEach(n,m=>{let{row:E,col:v}=m;const{colspanCompensation:_,affectedColumns:T,rollbackModification:R}=this.headerStateManager.triggerNodeModification(t,E,v);_>0&&(a.push(...T),o.push(R))});const l=this.getCollapsedColumns();let u=[];t==="collapse"?u=arrayUnique([...l,...a]):t==="expand"&&(u=arrayFilter(l,m=>!a.includes(m)));const c=actionDictionary.get(t);if(this.hot.runHooks(c.beforeHook,l,u,s)===!1){arrayEach(o,m=>{m()});return}this.hot.batchExecution(()=>{arrayEach(a,m=>{_classPrivateFieldGet$F(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(m),c.hideColumn)})},!0);const f=this.getCollapsedColumns().length!==l.length,C=this.hot.getSelectedRangeLast();if(t==="collapse"&&f&&C){const{row:m,col:E}=C.highlight;if((this.hot.rowIndexMapper.isHidden(m)||this.hot.columnIndexMapper.isHidden(E))&&a.includes(E)){const _=m>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(m,1,!0):m,T=E>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(E,1,!0):E;_!==null&&T!==null&&this.hot.selectCell(_,T)}}this.hot.runHooks(c.afterHook,l,u,s,f),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return _classPrivateFieldGet$F(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet$D(_collapsedColumnsMap,this,null),super.destroy()}}function _onAfterGetColHeader$4(r,e,t){var n;const{collapsible:s,origColspan:o,isCollapsed:a}=(n=this.headerStateManager.getHeaderSettings(t,r))!==null&&n!==void 0?n:{},l=s&&o>1&&r>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(e,[A11Y_EXPANDED("")[0]]),l)c||(c=this.hot.rootDocument.createElement("div"),addClass$1(c,COLLAPSIBLE_ELEMENT_CLASS),e.querySelector("div:first-child").appendChild(c)),removeClass$1(c,["collapsed","expanded"]),a?(addClass$1(c,"collapsed"),fastInnerText(c,"+"),u&&setAttribute(e,...A11Y_EXPANDED(!1))):(addClass$1(c,"expanded"),fastInnerText(c,"-"),u&&setAttribute(e,...A11Y_EXPANDED(!0))),u&&setAttribute(c,...A11Y_HIDDEN());else{var d;(d=c)===null||d===void 0||d.remove()}}function _onBeforeOnCellMouseDown$6(r,e){hasClass$1(r.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass$1(r.target,"expanded")?(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):hasClass$1(r.target,"collapsed")&&(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),stopImmediatePropagation(r))}function _onInit$1(){this.updatePlugin()}function _onAfterLoadData$5(r,e){e||this.updatePlugin()}function _defineProperty$13(r,e,t){return(e=_toPropertyKey$13(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$13(r){var e=_toPrimitive$13(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$13(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0;class ColumnStatesManager{constructor(e,t){_defineProperty$13(this,"hot",void 0),_defineProperty$13(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty$13(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty$13(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty$13(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty$13(this,"compareFunctionFactory",void 0),_defineProperty$13(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){isObject$1(e)&&objectEach(e,(t,n)=>{inheritedColumnProperties.includes(n)&&(this[n]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[n]=t;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return isObject$1(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[n,s]=t;return{column:this.hot.toVisualColumn(n),...s}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(isDefined(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function compareFunctionFactory$4(r,e,t){const n=e.locale;return function(s,o){const{sortEmptyCells:a}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),s===o?DO_NOT_SWAP:isEmpty$1(s)?isEmpty$1(o)?DO_NOT_SWAP:a&&r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty$1(o)?a&&r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(s)&&!isNaN(o)?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(s)&&isNaN(o)||(isNaN(s)||isNaN(o)||(s=parseFloat(s),o=parseFloat(o)),s<o)?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:s>o?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$4="default";function compareFunctionFactory$3(r,e,t){return function(n,s){const o=parseFloat(n),a=parseFloat(s),{sortEmptyCells:l}=t;if(o===a||isNaN(o)&&isNaN(a))return DO_NOT_SWAP;if(l){if(isEmpty$1(n))return r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty$1(s))return r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(o)?FIRST_AFTER_SECOND:isNaN(a)?FIRST_BEFORE_SECOND:o<a?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>a?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$3="numeric";function compareFunctionFactory$2(r,e,t){const n=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:o}=t;return function(a,l){const u=isEmpty$1(a),c=isEmpty$1(l),d=u?s:a,f=c?s:l,C=d===s||d===n,m=f===s||f===n;if(o===!1){if(u&&c===!1)return FIRST_AFTER_SECOND;if(u===!1&&c)return FIRST_BEFORE_SECOND}return C===!1&&m?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:C&&m===!1?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:C===!1&&m===!1?compareFunctionFactory$4(r,e,t)(a,l):d===s&&f===n?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:d===n&&f===s?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$2="checkbox";function compareFunctionFactory$1(r,e,t){return createDateTimeCompareFunction(r,e.dateFormat,t)}const COLUMN_DATA_TYPE$1="date";function compareFunctionFactory(r,e,t){return createDateTimeCompareFunction(r,e.timeFormat,t)}const COLUMN_DATA_TYPE="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(r){return hasGloballyCompareFunctionFactory(r)?getGloballyCompareFunctionFactory(r):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$4)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2);registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1);registerCompareFunctionFactory(COLUMN_DATA_TYPE$4,compareFunctionFactory$4);registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3);registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(r,e){const t=getRootComparator(e);for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o];r.sort(t(...s))}const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(r){if(isObject$1(r)===!1)return!1;const{column:e,sortOrder:t}=r;return Number.isInteger(e)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(t)}function areValidSortStates(r){if(r.some(t=>isValidColumnState(t)===!1))return!1;const e=r.map(t=>{let{column:n}=t;return n});return new Set(e).size===e.length}function getNextSortOrder(r){if(r!==DESC_SORT_STATE)return r===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(r){return r.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(r,e){if(r<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function wasHeaderClickedProperly(r,e,t){return r===-1&&e>=0&&isRightClick(t)===!1}function createDateTimeCompareFunction(r,e,t){return function(n,s){const{sortEmptyCells:o}=t;if(n===s)return DO_NOT_SWAP;if(isEmpty$1(n))return isEmpty$1(s)?DO_NOT_SWAP:o&&r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty$1(s))return o&&r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const a=hooks(n,e),l=hooks(s,e);return a.isValid()?l.isValid()?l.isAfter(a)?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:l.isBefore(a)?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}const HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(r,e,t,n){const s=[HEADER_SORT_CLASS];if(n&&s.push(HEADER_ACTION_CLASS),t===!1)return s.push(HEADER_CLASS_INDICATOR_DISABLED),s;const o=r.getSortOrderOfColumn(e);return isDefined(o)&&s.push(orderToCssClass.get(o)),s}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator$1(r,e){return function(t,n){const[,...s]=t,[,...o]=n;return function(l){const u=r[l],c=e[l],d=s[l],f=o[l],C=c.columnSorting;return(C.compareFunctionFactory?C.compareFunctionFactory:getCompareFunctionFactory(c.type))(u,c,C)(d,f)}(0)}}function _classPrivateMethodInitSpec$F(r,e){_checkPrivateRedeclaration$U(r,e),e.add(r)}function _checkPrivateRedeclaration$U(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$12(r,e,t){return(e=_toPropertyKey$12(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$12(r){var e=_toPrimitive$12(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$12(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$U(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$s="columnSorting",PLUGIN_PRIORITY$r=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP$a=PLUGIN_KEY$s;registerRootComparator(PLUGIN_KEY$s,rootComparator$1);Hooks.getSingleton().register("beforeColumnSort");Hooks.getSingleton().register("afterColumnSort");var _ColumnSorting_brand=new WeakSet;class ColumnSorting extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$F(this,_ColumnSorting_brand),_defineProperty$12(this,"columnStatesManager",null),_defineProperty$12(this,"columnMetaCache",null),_defineProperty$12(this,"pluginKey",PLUGIN_KEY$s),_defineProperty$12(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$s}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$r}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(t=>{let n=this.hot.toVisualColumn(t);return n===null&&(n=t),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$U(_ColumnSorting_brand,this,_onAfterGetColHeader$3).call(this,t,n)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$U(_ColumnSorting_brand,e,_onBeforeOnCellMouseDown$5).call(e,...n)}),this.addHook("afterOnCellMouseDown",(t,n)=>this.onAfterOnCellMouseDown(t,n)),this.addHook("afterInit",()=>_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$U(_ColumnSorting_brand,e,_onAfterLoadData$4).call(e,...n)}),this.hot.view&&_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,n)=>{const s=getHeaderSpanElement(n);isFirstLevelColumnHeader(t,n)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$a})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$a)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",t,n,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,s?n:t,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return isDefined(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return areValidSortStates(e)&&e.every(n=>{let{column:s}=n;return s<=t&&s>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),n=s=>{let{column:o,...a}=s;return{column:this.hot.toPhysicalColumn(o),...a}};t.initialConfig=arrayMap(e,n),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=s=>{let{column:o,...a}=s;return{column:this.hot.toVisualColumn(o),...a}};return isDefined(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=arrayMap(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(isDefined(t)){const s=getNextSortOrder(t);return isDefined(s)?{column:e,sortOrder:s}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:getNextSortOrder()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=n!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(s){if(isUndefined$1(a))return[...o.slice(0,n),...o.slice(n+1)];if(t===APPEND_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,n),...o.slice(n+1),a];if(t===REPLACE_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,n),a,...o.slice(n+1)]}return isDefined(a)?o.concat(a):o}getPluginColumnConfig(e){if(isObject$1(e)){const t=e[this.pluginKey];if(isObject$1(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(s);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):isFunction$2(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],n=this.hot.countRows(),s=c=>arrayMap(e,d=>this.hot.getDataAtCell(c,d.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)t.push([this.hot.toPhysicalRow(c)].concat(s(c)));const o=arrayMap(t,c=>c[0]);sort(t,this.pluginKey,arrayMap(e,c=>c.sortOrder),arrayMap(e,c=>this.getFirstCellSettings(c.column)));for(let c=t.length;c<n;c+=1)t.push([c].concat(s(c)));const a=arrayMap(t,c=>c[0]),l=new Map(arrayMap(o,(c,d)=>[c,a[d]])),u=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),c=>l.has(c)?l.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(u)}sortBySettings(e){if(isObject$1(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||isObject$1(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(removeClass$1(e,getClassesToRemove$1()),this.enabled!==!1){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];addClass$1(e,getClassesToAdd$1(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&hasClass$1(e.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,t){if(wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const n=this.hot.getActiveEditor(),s=this.getColumnNextConfig(t.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function _loadOrSortBySettings(){const r=this.getAllSavedSortSettings();if(isObject$1(r))this.sortBySettings(r);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function _onAfterGetColHeader$3(r,e){const t=getHeaderSpanElement(e);if(isFirstLevelColumnHeader(r,e)===!1||t===null)return;const n=this.getFirstCellSettings(r)[this.pluginKey],s=n.indicator,o=n.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,r,s,o),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(r);setAttribute(e,...A11Y_SORT(a?`${a}ending`:"none"))}}function _onAfterLoadData$4(r){r===!0&&this.hot.view&&_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown$5(r,e,t,n){wasHeaderClickedProperly(e.row,e.col,r)!==!1&&this.wasClickableHeaderClicked(r,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function _defineProperty$11(r,e,t){return(e=_toPropertyKey$11(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$11(r){var e=_toPrimitive$11(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$11(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Endpoints{constructor(e,t){_defineProperty$11(this,"plugin",void 0),_defineProperty$11(this,"hot",void 0),_defineProperty$11(this,"endpoints",[]),_defineProperty$11(this,"settings",void 0),_defineProperty$11(this,"settingsType","array"),_defineProperty$11(this,"currentEndpoint",null),_defineProperty$11(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),arrayEach(n,s=>{const o={};this.assignSetting(s,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,o,"reversedRowCoords",!1),this.assignSetting(s,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"sourceColumn",s.destinationColumn),this.assignSetting(s,o,"type","sum"),this.assignSetting(s,o,"forceNumeric",!1),this.assignSetting(s,o,"suppressDataTypeErrors",!0),this.assignSetting(s,o,"customFunction",null),this.assignSetting(s,o,"readOnly",!0),this.assignSetting(s,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,n,s){if(n==="ranges"&&e[n]===void 0){t[n]=s;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(s instanceof Error)throw s;t[n]=s}else n==="destinationRow"&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}resetSetupBeforeStructureAlteration(e,t,n){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();arrayEach(o,a=>{s==="row"&&a.destinationRow>=t&&(e==="insert_row"?a.alterRowOffset=n:e==="remove_row"&&(a.alterRowOffset=-1*n)),s==="col"&&a.destinationColumn>=t&&(e==="insert_col"?a.alterColumnOffset=n:e==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,n,s,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const C=()=>(this.hot.removeHook("beforeViewRender",C),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",C);return}const l=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),d=e.indexOf("move_row")===0,f=t;arrayEach(c,C=>{l==="row"&&C.destinationRow>=f&&(C.alterRowOffset=u*n),l==="col"&&C.destinationColumn>=f&&(C.alterColumnOffset=u*n)}),this.resetAllEndpoints(c,!d),d?arrayEach(c,C=>{this.extendEndpointRanges(C,f,s[0],s.length),this.recreatePhysicalRanges(C),this.clearOffsetInformation(C)}):arrayEach(c,C=>{this.shiftEndpointCoordinates(C,f)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,s){arrayEach(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?n>o[1]?o[1]+=s:n<o[0]&&(o[0]-=s):n>=o[0]&&n<=o[1]&&(o[1]-=s,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,n=[],s=[];arrayEach(t,o=>{const a=[];if(o[1])for(let l=o[0];l<=o[1];l++)a.push(this.hot.toPhysicalRow(l));else a.push(this.hot.toPhysicalRow(o[0]));s.push(a)}),arrayEach(s,o=>{let a=[];arrayEach(o,(l,u)=>{u===0?a.push(l):o[u]!==o[u-1]+1&&(a.push(o[u-1]),n.push(a),a=[],a.push(l)),u===o.length-1&&(a.push(l),n.push(a))})}),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,arrayEach(e.ranges,n=>{arrayEach(n,(s,o)=>{s>=t&&(n[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const o=s.alterRowOffset||0,a=s.alterColumnOffset||0;return s.destinationRow+o>=this.hot.countRows()||s.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],arrayEach(e,(n,s,o)=>{`${n[2]||""}`!=`${n[3]}`&&arrayEach(this.getAllEndpoints(),(a,l)=>{this.hot.propToCol(o[s][1])===a.sourceColumn&&t.indexOf(l)===-1&&t.push(l)})}),arrayEach(t,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let l=0;Number.isInteger(a)&&(l=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(l)}n?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn$1("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function isNullishOrNaN(r){return r==null||isNaN(r)}function _classPrivateMethodInitSpec$E(r,e){_checkPrivateRedeclaration$T(r,e),e.add(r)}function _checkPrivateRedeclaration$T(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$10(r,e,t){return(e=_toPropertyKey$10(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$10(r){var e=_toPrimitive$10(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$10(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$T(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$r="columnSummary",PLUGIN_PRIORITY$q=220;var _ColumnSummary_brand=new WeakSet;class ColumnSummary extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$E(this,_ColumnSummary_brand),_defineProperty$10(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$r}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$q}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$r]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$r],this.endpoints=new Endpoints(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterInit$3).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterChange$2).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterUpdateSettings).call(e,...n)}),this.addHook("beforeCreateRow",(t,n,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,s)),this.addHook("beforeCreateCol",(t,n,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(t,n,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,s)),this.addHook("afterCreateCol",(t,n,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterRowMove).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return objectEach(e.ranges,n=>{t+=this.getPartialSum(n,e.sourceColumn)}),t}getPartialSum(e,t){let n=0,s=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(s,t),o=isNullishOrNaN(o)?null:o,o!==null){const l=(`${o}`.split(".")[1]||[]).length||1;l>a&&(a=l)}n+=o||0,s-=1}while(s>=e[0]);return Math.round(n*10**a)/10**a}calculateMinMax(e,t){let n=null;return objectEach(e.ranges,s=>{const o=this.getPartialMinMax(s,e.sourceColumn,t);if(n===null&&o!==null&&(n=o),o!==null)switch(t){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o);break}}),n===null?"Not enough data":n}getPartialMinMax(e,t,n){let s=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,t),a=isNullishOrNaN(a)?null:a,s===null)s=a;else if(a!==null)switch(n){case"min":s=Math.min(s,a);break;case"max":s=Math.max(s,a);break}o-=1}while(o>=e[0]);return s}countEmpty(e,t){let n,s=0,o=e[1]||e[0];do n=this.getCellValue(o,t),n=isNullishOrNaN(n)?null:n,n===null&&(s+=1),o-=1;while(o>=e[0]);return s}countEntries(e){let t=0;const n=e.ranges;return objectEach(n,s=>{const o=s[1]===void 0?1:s[1]-s[0]+1,a=this.countEmpty(s,e.sourceColumn);t+=o,t-=a}),t}calculateAverage(e){const t=this.calculateSum(e),n=this.countEntries(e);return t/n}getCellValue(e,t){const n=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),a="";if(n!==null&&s!==null&&(a=this.hot.getCellMeta(n,s).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function _onAfterInit$3(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(r){r.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange$2(r,e){r&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(r)}function _onAfterRowMove(r,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",r[0],r.length,r,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,r.length,r,this.pluginName)}function _classPrivateMethodInitSpec$D(r,e){_checkPrivateRedeclaration$S(r,e),e.add(r)}function _classPrivateFieldInitSpec$E(r,e,t){_checkPrivateRedeclaration$S(r,e),e.set(r,t)}function _checkPrivateRedeclaration$S(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$E(r,e){return r.get(_assertClassBrand$S(r,e))}function _classPrivateFieldSet$C(r,e,t){return r.set(_assertClassBrand$S(r,e),t),t}function _assertClassBrand$S(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet;class EditorResizeObserver{constructor(){_classPrivateMethodInitSpec$D(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec$E(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec$E(this,_observedElement,null),_classPrivateFieldInitSpec$E(this,_observer,new ResizeObserver(e=>_assertClassBrand$S(_EditorResizeObserver_brand,this,_onResize).call(this,e)))}setObservedElement(e){_classPrivateFieldSet$C(_observedElement,this,e)}unobserve(){_classPrivateFieldGet$E(_observer,this).unobserve(_classPrivateFieldGet$E(_observedElement,this))}observe(){_classPrivateFieldSet$C(_ignoreInitialCall,this,!0),_classPrivateFieldGet$E(_observer,this).observe(_classPrivateFieldGet$E(_observedElement,this))}destroy(){_classPrivateFieldGet$E(_observer,this).disconnect()}}function _onResize(r){if(_classPrivateFieldGet$E(_ignoreInitialCall,this)||!Array.isArray(r)||!r.length){_classPrivateFieldSet$C(_ignoreInitialCall,this,!1);return}r.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:s}=t[0];this.runLocalHooks("resize",n,s)})}mixin(EditorResizeObserver,localHooks);function _classPrivateFieldInitSpec$D(r,e,t){_checkPrivateRedeclaration$R(r,e),e.set(r,t)}function _checkPrivateRedeclaration$R(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$D(r,e){return r.get(_assertClassBrand$R(r,e))}function _classPrivateFieldSet$B(r,e,t){return r.set(_assertClassBrand$R(r,e),t),t}function _assertClassBrand$R(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rootDocument=new WeakMap,_isRtl=new WeakMap,_container$1=new WeakMap,_editor$1=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver$1=new WeakMap;class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;_classPrivateFieldInitSpec$D(this,_rootDocument,void 0),_classPrivateFieldInitSpec$D(this,_isRtl,!1),_classPrivateFieldInitSpec$D(this,_container$1,null),_classPrivateFieldInitSpec$D(this,_editor$1,void 0),_classPrivateFieldInitSpec$D(this,_editorStyle,void 0),_classPrivateFieldInitSpec$D(this,_hidden,!0),_classPrivateFieldInitSpec$D(this,_resizeObserver$1,new EditorResizeObserver),_classPrivateFieldSet$B(_rootDocument,this,e),_classPrivateFieldSet$B(_isRtl,this,t),_classPrivateFieldSet$B(_editor$1,this,this.createEditor()),_classPrivateFieldSet$B(_editorStyle,this,_classPrivateFieldGet$D(_editor$1,this).style),_classPrivateFieldGet$D(_resizeObserver$1,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet$D(_resizeObserver$1,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,t){_classPrivateFieldGet$D(_editorStyle,this).left=`${e}px`,_classPrivateFieldGet$D(_editorStyle,this).top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet$D(_resizeObserver$1,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){_classPrivateFieldGet$D(_editorStyle,this).display="block",_classPrivateFieldSet$B(_hidden,this,!1)}hide(){_classPrivateFieldGet$D(_resizeObserver$1,this).unobserve(),_classPrivateFieldGet$D(_hidden,this)||(_classPrivateFieldGet$D(_editorStyle,this).display="none"),_classPrivateFieldSet$B(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet$D(_editorStyle,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet$D(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=_classPrivateFieldGet$D(_rootDocument,this).createElement("div"),t=_classPrivateFieldGet$D(_rootDocument,this).createElement("textarea");return e.style.display="none",_classPrivateFieldSet$B(_container$1,this,_classPrivateFieldGet$D(_rootDocument,this).createElement("div")),_classPrivateFieldGet$D(_container$1,this).setAttribute("dir",_classPrivateFieldGet$D(_isRtl,this)?"rtl":"ltr"),addClass$1(_classPrivateFieldGet$D(_container$1,this),CommentEditor.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet$D(_rootDocument,this).body.appendChild(_classPrivateFieldGet$D(_container$1,this)),addClass$1(e,CommentEditor.CLASS_EDITOR),addClass$1(t,CommentEditor.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),_classPrivateFieldGet$D(_container$1,this).appendChild(e),e}getInputElement(){return _classPrivateFieldGet$D(_editor$1,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}getEditorElement(){return _classPrivateFieldGet$D(_editor$1,this)}destroy(){const e=_classPrivateFieldGet$D(_container$1,this)?_classPrivateFieldGet$D(_container$1,this).parentNode:null;_classPrivateFieldGet$D(_editor$1,this).parentNode.removeChild(_classPrivateFieldGet$D(_editor$1,this)),_classPrivateFieldSet$B(_editor$1,this,null),_classPrivateFieldSet$B(_editorStyle,this,null),_classPrivateFieldGet$D(_resizeObserver$1,this).destroy(),e&&e.removeChild(_classPrivateFieldGet$D(_container$1,this))}}mixin(CommentEditor,localHooks);function _defineProperty$$(r,e,t){return(e=_toPropertyKey$$(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$$(r){var e=_toPrimitive$$(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$$(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250;class DisplaySwitch{constructor(e){_defineProperty$$(this,"wasLastActionShow",!0),_defineProperty$$(this,"showDebounced",null),_defineProperty$$(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce$2(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}mixin(DisplaySwitch,localHooks);function prepareVerticalAlignClass(r,e){return r.indexOf(e)!==-1?r:`${r.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function prepareHorizontalAlignClass(r,e){return r.indexOf(e)!==-1?r:`${r.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function getAlignmentClasses(r,e){const t={};return arrayEach(r,n=>{n.forAll((s,o)=>{s>=0&&o>=0&&(t[s]||(t[s]=[]),t[s][o]=e(s,o))})}),t}function align(r,e,t,n,s){arrayEach(r,o=>{o.forAll((a,l)=>{a>=0&&l>=0&&applyAlignClassName(a,l,e,t,n,s)})})}function applyAlignClassName(r,e,t,n,s,o){const a=s(r,e);let l=n;a.className&&(t==="vertical"?l=prepareVerticalAlignClass(a.className,n):l=prepareHorizontalAlignClass(a.className,n)),o(r,e,"className",l)}function markLabelAsSelected(r){return`<span class="selected"></span>${r}`}function checkSelectionConsistency(r,e){let t=!1;return Array.isArray(r)&&arrayEach(r,n=>(n.forAll((s,o)=>{if(s>=0&&o>=0&&e(s,o))return t=!0,!1}),t)),t}function getDocumentOffsetByElement(r,e){const t={top:0,left:0};if(e!==r.ownerDocument){const{frameElement:n}=e.defaultView,{top:s,left:o}=n.getBoundingClientRect();t.top=s,t.left=o}return t}const KEY$c="---------";function separatorItem(){return{name:KEY$c}}const KEY$b="alignment";function alignmentItem(){return{key:KEY$b,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY$b}:left`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:center`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:right`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:justify`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{name:KEY$c},{key:`${KEY$b}:top`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:middle`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:bottom`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1}]}}}const KEY$a="clear_column";function clearColumnItem(){return{key:KEY$a,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(r,e){const t=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const KEY$9="col_left";function columnLeftItem(){return{key:KEY$9,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const r=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,r.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$8="col_right";function columnRightItem(){return{key:KEY$8,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const r=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,r.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$7="make_read_only";function readOnlyItem(){return{key:KEY$7,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(t,n)=>this.getCellMeta(t,n).readOnly)&&(r=markLabelAsSelected(r)),r},callback(){const r=this.getSelectedRange(),e=checkSelectionConsistency(r,(t,n)=>this.getCellMeta(t,n).readOnly);arrayEach(r,t=>{t.forAll((n,s)=>{n>=0&&s>=0&&this.setCellMeta(n,s,"readOnly",!e)})}),this.render()},disabled(){const r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const KEY$6="redo";function redoItem(){return{key:KEY$6,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){const r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(e!==rootCall&&e!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(r),n=e===rootCall;let s=SELECTION_TYPE_UNRECOGNIZED;if(t){const o=r[0];r.length===0?s=SELECTION_TYPE_EMPTY:n&&o instanceof CellRange?s=SELECTION_TYPE_OBJECT:n&&Array.isArray(o)?s=detectSelectionType(o,childCall):r.length>=2&&r.length<=4&&!r.some((l,u)=>!ARRAY_TYPE_PATTERN[u].includes(typeof l))&&(s=SELECTION_TYPE_ARRAY)}return s}function normalizeSelectionFactory(r){let{createCellCoords:e,createCellRange:t,keepDirection:n=!1,propToCol:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(r))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=r===SELECTION_TYPE_OBJECT;let l=a?o.from.row:o[0],u=a?o.from.col:o[1],c=a?o.to.row:o[2],d=a?o.to.col:o[3];if(typeof s=="function"&&(typeof u=="string"&&(u=s(u)),typeof d=="string"&&(d=s(d))),isUndefined$1(c)&&(c=l),isUndefined$1(d)&&(d=u),!n){const m=l,E=u,v=c,_=d;l=Math.min(m,v),u=Math.min(E,_),c=Math.max(m,v),d=Math.max(E,_)}const f=e(l,u),C=e(c,d);return t(f,f,C)}}function transformSelectionToColumnDistance(r){const e=detectSelectionType(r.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const t=normalizeSelectionFactory(e,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),n=new Set;arrayEach(r.getSelected(),a=>{const{from:l,to:u}=t(a),c=Math.max(l.col,0),d=u.col-c+1;arrayEach(Array.from(new Array(d),(f,C)=>c+C),f=>{n.has(f)||n.add(f)})});const s=Array.from(n).sort((a,l)=>a-l);return arrayReduce(s,(a,l,u,c)=>(u!==0&&l===c[u-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}function transformSelectionToRowDistance(r){const e=detectSelectionType(r.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const t=normalizeSelectionFactory(e,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),n=new Set;arrayEach(r.getSelected(),a=>{const{from:l,to:u}=t(a),c=Math.max(l.row,0),d=u.row-c+1;arrayEach(Array.from(new Array(d),(f,C)=>c+C),f=>{n.has(f)||n.add(f)})});const s=Array.from(n).sort((a,l)=>a-l);return arrayReduce(s,(a,l,u,c)=>(u!==0&&l===c[u-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}const KEY$5="remove_col";function removeColumnItem(){return{key:KEY$5,name(){const r=this.getSelected();let e=0;if(r)if(r.length>1)e=1;else{const[,t,,n]=r[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const KEY$4="remove_row";function removeRowItem(){return{key:KEY$4,name(){const r=this.getSelected();let e=0;if(r)if(r.length>1)e=1;else{const[t,,n]=r[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KEY$3="row_above";function rowAboveItem(){return{key:KEY$3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const r=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",r.row,1,"ContextMenu.rowAbove")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$2="row_below";function rowBelowItem(){return{key:KEY$2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const r=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",r.row,1,"ContextMenu.rowBelow")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$1="no_items";function noItemsItem(){return{key:KEY$1,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const KEY="undo";function undoItem(){return{key:KEY,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){const r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ITEMS=[KEY$3,KEY$2,KEY$9,KEY$8,KEY$a,KEY$4,KEY$5,KEY,KEY$6,KEY$7,KEY$b,KEY$c,KEY$1],_predefinedItems={[KEY$c]:separatorItem,[KEY$1]:noItemsItem,[KEY$3]:rowAboveItem,[KEY$2]:rowBelowItem,[KEY$9]:columnLeftItem,[KEY$8]:columnRightItem,[KEY$a]:clearColumnItem,[KEY$4]:removeRowItem,[KEY$5]:removeColumnItem,[KEY]:undoItem,[KEY$6]:redoItem,[KEY$7]:readOnlyItem,[KEY$b]:alignmentItem};function predefinedItems(){const r={};return objectEach(_predefinedItems,(e,t)=>{r[t]=e()}),r}function addEditCommentItem(r){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&r.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const e=this.getSelectedRangeLast();r.setRange(e),r.show(),r.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(r){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((t,n)=>{t>=0&&n>=0&&r.removeCommentAtCell(t,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(r){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(n,s)=>r.getCommentMeta(n,s,META_READONLY))?markLabelAsSelected(e):e},callback(){this.getSelectedRangeLast().forAll((t,n)=>{if(t>=0&&n>=0){const s=!!r.getCommentMeta(t,n,META_READONLY);r.updateCommentMeta(t,n,{[META_READONLY]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!r.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _classPrivateMethodInitSpec$C(r,e){_checkPrivateRedeclaration$Q(r,e),e.add(r)}function _classPrivateFieldInitSpec$C(r,e,t){_checkPrivateRedeclaration$Q(r,e),e.set(r,t)}function _checkPrivateRedeclaration$Q(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$_(r,e,t){return(e=_toPropertyKey$_(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$_(r){var e=_toPrimitive$_(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$_(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$A(r,e,t){return r.set(_assertClassBrand$Q(r,e),t),t}function _classPrivateFieldGet$C(r,e){return r.get(_assertClassBrand$Q(r,e))}function _assertClassBrand$Q(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$q="comments",PLUGIN_PRIORITY$p=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP$9=PLUGIN_KEY$q,SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY$q}`;var _editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet;class Comments extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$C(this,_Comments_brand),_defineProperty$_(this,"range",{}),_classPrivateFieldInitSpec$C(this,_editor,null),_classPrivateFieldInitSpec$C(this,_displaySwitch,null),_classPrivateFieldInitSpec$C(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec$C(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec$C(this,_cellBelowCursor,null),_classPrivateFieldInitSpec$C(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY$q}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$p}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$q]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$C(_editor,this)||(_classPrivateFieldSet$A(_editor,this,new CommentEditor(this.hot.rootDocument,this.hot.isRtl())),_classPrivateFieldGet$C(_editor,this).addLocalHook("resize",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$Q(_Comments_brand,e,_onEditorResize).call(e,...n)})),_classPrivateFieldGet$C(_displaySwitch,this)||_classPrivateFieldSet$A(_displaySwitch,this,new DisplaySwitch(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,n,s,o,a,l)=>_assertClassBrand$Q(_Comments_brand,this,_onAfterRenderer).call(this,t,l)),this.addHook("afterScroll",()=>_assertClassBrand$Q(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>_assertClassBrand$Q(_Comments_brand,this,_onAfterDocumentKeyDown$1).call(this,t)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$Q(_Comments_brand,e,_updateEditorThemeClassName).call(e,...n)}),_classPrivateFieldGet$C(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet$C(_displaySwitch,this).addLocalHook("show",(t,n)=>this.showAtCell(t,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$C(_displaySwitch,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(SHORTCUTS_CONTEXT_NAME);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();_classPrivateFieldSet$A(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(SHORTCUTS_CONTEXT_NAME),this.hot._registerTimeout(()=>{_classPrivateFieldSet$A(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:SHORTCUTS_GROUP$9}),n.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet$C(_editor,this).setValue(_classPrivateFieldGet$C(_commentValueBeforeSave,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$C(_editor,this).isVisible()&&_classPrivateFieldGet$C(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$C(_editor,this).isVisible()&&_classPrivateFieldGet$C(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$9)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>_assertClassBrand$Q(_Comments_brand,this,_onMouseOver$2).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>_assertClassBrand$Q(_Comments_brand,this,_onMouseDown$2).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$Q(_Comments_brand,this,_onMouseUp$4).call(this)),this.eventManager.addEventListener(t,"focus",()=>_assertClassBrand$Q(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(t,"blur",()=>_assertClassBrand$Q(_Comments_brand,this,_onEditorBlur).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=closest(e.target,"TD","TBODY");return!!(t&&hasClass$1(t,"htCommentCell")&&closest(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=_classPrivateFieldGet$C(_editor,this).getValue();let n="";e!=null?n=e:t!=null&&(n=t);const s=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(s,o,{[META_COMMENT_VALUE]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,META_COMMENT_VALUE)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,META_COMMENT_VALUE)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:n}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _classPrivateFieldGet$C(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet$C(_editor,this).setValue((e=s[META_COMMENT]?s[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&e!==void 0?e:""),_classPrivateFieldGet$C(_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){_classPrivateFieldGet$C(_editor,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet$C(_editor,this).isVisible()))return;const{rowIndexMapper:s,columnIndexMapper:o}=this.hot,{row:a,col:l}=this.range.from;let u=s.getRenderableFromVisualIndex(a),c=o.getRenderableFromVisualIndex(l);const d=u===null;_classPrivateFieldGet$C(_editor,this).setPosition(0,0),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1))),c===null&&(c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1)));const f=u===null,C=c===null;u=(e=u)!==null&&e!==void 0?e:0,c=(t=c)!==null&&t!==void 0?t:0;const{rootWindow:m,view:{_wt:E}}=this.hot,{wtTable:v}=E,_=E.getCell({row:u,col:c},!0),T=this.getCommentMeta(a,l,META_STYLE);T?_classPrivateFieldGet$C(_editor,this).setSize(T.width,T.height):_classPrivateFieldGet$C(_editor,this).resetSize();const R=C?0:v.getColumnWidth(c),O=d&&!f?outerHeight(_):0,{left:N,top:G,width:D,height:k}=_.getBoundingClientRect(),{width:z,height:ne}=_classPrivateFieldGet$C(_editor,this).getSize(),{innerWidth:Z,innerHeight:ve}=this.hot.rootWindow,xe=this.hot.rootDocument.documentElement;let de=N+m.scrollX+R,Se=G+m.scrollY+O;this.hot.isRtl()&&(de-=z+R),this.hot.isLtr()&&N+D+z>Z?de=N+m.scrollX-z-1:this.hot.isRtl()&&de<-(xe.scrollWidth-xe.clientWidth)&&(de=N+m.scrollX+R+1),G+ne>ve&&(Se-=ne-k+1),_classPrivateFieldGet$C(_editor,this).setPosition(de,Se),_classPrivateFieldGet$C(_editor,this).setReadOnlyState(this.getCommentMeta(a,l,META_READONLY)),_classPrivateFieldGet$C(_editor,this).observeSize()}focusEditor(){_classPrivateFieldGet$C(_editor,this).focus()}updateCommentMeta(e,t,n){const s=this.hot.getCellMeta(e,t)[META_COMMENT];let o;s?(o=deepClone(s),deepExtend(o,n)):o=n,this.hot.setCellMeta(e,t,META_COMMENT,o)}getCommentMeta(e,t,n){const s=this.hot.getCellMeta(e,t);if(s[META_COMMENT])return s[META_COMMENT][n]}addToContextMenu(e){e.items.push({name:KEY$c},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getEditorInputElement(){return _classPrivateFieldGet$C(_editor,this).getInputElement()}destroy(){var e,t;(e=_classPrivateFieldGet$C(_editor,this))===null||e===void 0||e.destroy(),(t=_classPrivateFieldGet$C(_displaySwitch,this))===null||t===void 0||t.destroy(),super.destroy()}}function _onMouseDown$2(r){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet$C(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(r)){const e=closest(r.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function _onMouseOver$2(r){const{rootDocument:e}=this.hot;if(!(_classPrivateFieldGet$C(_preventEditorAutoSwitch,this)||_classPrivateFieldGet$C(_editor,this).isFocused()||hasClass$1(r.target,"wtBorder")||_classPrivateFieldGet$C(_cellBelowCursor,this)===r.target||!_classPrivateFieldGet$C(_editor,this)))if(_classPrivateFieldSet$A(_cellBelowCursor,this,e.elementFromPoint(r.clientX,r.clientY)),this.targetIsCellWithComment(r)){const t=this.hot._createCellRange(this.hot.getCoords(r.target));_classPrivateFieldGet$C(_displaySwitch,this).show(t)}else isChildOf(r.target,e)&&!this.targetIsCommentTextArea(r)&&_classPrivateFieldGet$C(_displaySwitch,this).hide()}function _onMouseUp$4(){_classPrivateFieldSet$A(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(r,e){e[META_COMMENT]&&e[META_COMMENT][META_COMMENT_VALUE]&&addClass$1(r,e.commentedCellClassName)}function _onEditorBlur(){_classPrivateFieldSet$A(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet$A(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME)}function _onEditorResize(r,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width:r,height:e}})}function _onAfterDocumentKeyDown$1(r){_classPrivateFieldGet$C(_editor,this).isFocused()&&stopImmediatePropagation(r)}function _onAfterScroll(){_classPrivateFieldGet$C(_preventEditorHiding,this)||this.hide()}function _updateEditorThemeClassName(){const r=_classPrivateFieldGet$C(_editor,this).getEditorElement();removeClass$1(r,/ht-theme-.*/g),addClass$1(r,this.hot.getCurrentThemeName())}var es_array_unshift={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var r=requireTryToString(),e=TypeError;return deletePropertyOrThrow=function(t,n){if(!delete t[n])throw new e("Cannot delete property "+r(n)+" of "+r(t))},deletePropertyOrThrow}var hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireArraySetLength(),s=requireDeletePropertyOrThrow(),o=requireDoesNotExceedSafeInteger(),a=[].unshift(0)!==1,l=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},u=a||!l();return r({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(d){var f=e(this),C=t(f),m=arguments.length;if(m){o(C+m);for(var E=C;E--;){var v=E+m;E in f?f[v]=f[E]:s(f,v)}for(var _=0;_<m;_++)f[_]=arguments[_]}return n(f,C+m)}}),es_array_unshift}requireEs_array_unshift();function _defineProperty$Z(r,e,t){return(e=_toPropertyKey$Z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Z(r){var e=_toPrimitive$Z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CommandExecutor{constructor(e){_defineProperty$Z(this,"hot",void 0),_defineProperty$Z(this,"commands",{}),_defineProperty$Z(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const o=e.split(":"),a=o[0],l=o.length===2?o[1]:null;let u=this.commands[a];if(!u)throw new Error(`Menu command '${a}' not exists.`);if(l&&u.submenu&&(u=findSubCommand(l,u.submenu.items)),u.disabled===!0||typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0||hasOwnProperty(u,"submenu"))return;const c=[];typeof u.callback=="function"&&c.push(u.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(o.join(":")),arrayEach(c,d=>d.apply(this.hot,n))}}function findSubCommand(r,e){let t;return arrayEach(e,n=>{const s=n.key?n.key.split(":"):null;if(Array.isArray(s)&&s[1]===r)return t=n,!1}),t}function _defineProperty$Y(r,e,t){return(e=_toPropertyKey$Y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Y(r){var e=_toPrimitive$Y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ItemsFactory{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty$Y(this,"hot",void 0),_defineProperty$Y(this,"predefinedItems",predefinedItems()),_defineProperty$Y(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,objectEach(e,(n,s)=>{let o="";n.name===KEY$c?(t[KEY$c]=n,o=KEY$c):isNaN(parseInt(s,10))?(n.key=n.key===void 0?s:n.key,t[s]=n,o=n.key):(t[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(e,this.defaultOrderPattern,this.predefinedItems)}}function getItems(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let s=r;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),isObject$1(s)?objectEach(s,(o,a)=>{let l=t[typeof o=="string"?o:a];l||(l=o),isObject$1(o)?extend$1(l,o):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):arrayEach(s,(o,a)=>{let l=t[o];!l&&ITEMS.indexOf(o)>=0||(l||(l={name:o,key:`${a}`}),isObject$1(o)&&extend$1(l,o),l.key===void 0&&(l.key=a),n.push(l))}),n}function _defineProperty$X(r,e,t){return(e=_toPropertyKey$X(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$X(r){var e=_toPrimitive$X(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$X(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Cursor{constructor(e,t){_defineProperty$X(this,"top",void 0),_defineProperty$X(this,"topRelative",void 0),_defineProperty$X(this,"left",void 0),_defineProperty$X(this,"leftRelative",void 0),_defineProperty$X(this,"scrollTop",void 0),_defineProperty$X(this,"scrollLeft",void 0),_defineProperty$X(this,"cellHeight",void 0),_defineProperty$X(this,"cellWidth",void 0);const n=t.scrollY,s=t.scrollX;let o,a,l,u,c,d;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),l=parseInt(e.left,10),c=e.height||0,d=e.width||0,a=o,u=l,o+=n,l+=s):this.type==="event"&&(o=parseInt(e.pageY,10),l=parseInt(e.pageX,10),c=e.target.clientHeight,d=e.target.clientWidth,a=o-n,u=l-s),this.top=o,this.topRelative=a,this.left=l,this.leftRelative=u,this.scrollTop=n,this.scrollLeft=s,this.cellHeight=c,this.cellWidth=d}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _classPrivateFieldInitSpec$B(r,e,t){_checkPrivateRedeclaration$P(r,e),e.set(r,t)}function _checkPrivateRedeclaration$P(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$B(r,e){return r.get(_assertClassBrand$P(r,e))}function _classPrivateFieldSet$z(r,e,t){return r.set(_assertClassBrand$P(r,e),t),t}function _assertClassBrand$P(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset$1=new WeakMap;class Positioner{constructor(e){_classPrivateFieldInitSpec$B(this,_container,void 0),_classPrivateFieldInitSpec$B(this,_parentContainer,void 0),_classPrivateFieldInitSpec$B(this,_cursor,void 0),_classPrivateFieldInitSpec$B(this,_keepInViewport,!1),_classPrivateFieldInitSpec$B(this,_offset$1,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet$z(_keepInViewport,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet$B(_offset$1,this)[e]=t,this}setElement(e){return _classPrivateFieldSet$z(_container,this,e),this}setParentElement(e){return _classPrivateFieldSet$z(_parentContainer,this,e),this}updatePosition(e){_classPrivateFieldSet$z(_cursor,this,new Cursor(e,_classPrivateFieldGet$B(_container,this).ownerDocument.defaultView)),_classPrivateFieldGet$B(_keepInViewport,this)?(_classPrivateFieldGet$B(_cursor,this).fitsBelow(_classPrivateFieldGet$B(_container,this))?this.setPositionBelowCursor():_classPrivateFieldGet$B(_cursor,this).fitsAbove(_classPrivateFieldGet$B(_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet$B(_container,this).dir==="rtl"?_classPrivateFieldGet$B(_cursor,this).fitsOnLeft(_classPrivateFieldGet$B(_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet$B(_cursor,this).fitsOnRight(_classPrivateFieldGet$B(_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).above+_classPrivateFieldGet$B(_cursor,this).top-_classPrivateFieldGet$B(_container,this).offsetHeight;_classPrivateFieldGet$B(_parentContainer,this)&&(e=_classPrivateFieldGet$B(_cursor,this).top+_classPrivateFieldGet$B(_cursor,this).cellHeight-_classPrivateFieldGet$B(_container,this).offsetHeight+3),_classPrivateFieldGet$B(_container,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).below+_classPrivateFieldGet$B(_cursor,this).top+1;_classPrivateFieldGet$B(_parentContainer,this)&&(e=_classPrivateFieldGet$B(_cursor,this).top-1),_classPrivateFieldGet$B(_container,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_classPrivateFieldGet$B(_cursor,this).left;if(_classPrivateFieldGet$B(_parentContainer,this)){const t=_classPrivateFieldGet$B(_parentContainer,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(_classPrivateFieldGet$B(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);e+=_classPrivateFieldGet$B(_cursor,this).cellWidth+n}else e+=_classPrivateFieldGet$B(_offset$1,this).right;_classPrivateFieldGet$B(_container,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).left+_classPrivateFieldGet$B(_cursor,this).left-_classPrivateFieldGet$B(_container,this).offsetWidth;if(_classPrivateFieldGet$B(_parentContainer,this)){const t=_classPrivateFieldGet$B(_parentContainer,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(_classPrivateFieldGet$B(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}_classPrivateFieldGet$B(_container,this).style.left=`${e}px`}}function createPaginator(r){let{initialPage:e=-1,size:t=()=>0,onItemSelect:n=()=>{},onClear:s=()=>{}}=r;const o=new Set;let a=clamp(e,-1,E()-1);function l(_,T){const R=E()-1;return _<0&&(_=R),_>R&&(_=0),o.has(_)?-1:(o.add(_),n(_,!1)===!1&&(_=l(T===1?++_:--_,T)),_)}function u(_){_>-1&&_<E()&&n(_,!0)!==!1&&(a=_)}function c(){return a}function d(){E()>0&&(o.clear(),a=l(0,1))}function f(){E()>0&&(o.clear(),a=l(E()-1,-1))}function C(){E()>0&&(o.clear(),a=l(++a,1))}function m(){E()>0&&(o.clear(),a=l(--a,-1))}function E(){return Math.max(t(),0)}function v(){o.clear(),a=e,s()}return{setCurrentPage:u,getCurrentPage:c,toFirstItem:d,toLastItem:f,toNextItem:C,toPreviousItem:m,getSize:E,clear:v}}function normalizeSelection(r){return arrayMap(r,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function isItemSubMenu(r){return hasOwnProperty(r,"submenu")}function isItemSeparator(r){return new RegExp(KEY$c,"i").test(r.name)}function isItemDisabled(r,e){return r.disabled===!0||typeof r.disabled=="function"&&r.disabled.call(e)===!0}function isItemSelectionDisabled(r){return hasOwnProperty(r,"disableSelection")}function isSeparator(r){return hasClass$1(r,"htSeparator")}function hasSubMenu(r){return hasClass$1(r,"htSubmenu")}function isDisabled(r){return hasClass$1(r,"htDisabled")}function isSelectionDisabled(r){return hasClass$1(r,"htSelectionDisabled")}function isItemHidden(r,e){return!r.hidden||!(typeof r.hidden=="function"&&r.hidden.call(e))}function shiftSeparators(r,e){const t=r.slice(0);for(let n=0;n<t.length&&t[n].name===e;)t.shift();return t}function popSeparators(r,e){let t=r.slice(0);return t.reverse(),t=shiftSeparators(t,e),t.reverse(),t}function removeDuplicatedSeparators(r){const e=[];return arrayEach(r,(t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function filterSeparators(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$c,t=r.slice(0);return t=shiftSeparators(t,e),t=popSeparators(t,e),t=removeDuplicatedSeparators(t),t}function isItemCheckable(r){return r.checkable===!0}function createMenuNavigator(r){return createPaginator({size:()=>r.countRows(),onItemSelect(e,t){const n=r.getCell(e,0);if(!n||isSeparator(n)||isDisabled(n)||isSelectionDisabled(n))return!1;r.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){r.deselectCell()}})}function createDefaultShortcutsList(r){const{hot:e,hotMenu:t}=r;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>r.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,s)=>{const o=e.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;s.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),r.close(!0)}},{keys:[["Escape"]],callback:()=>r.close()},{keys:[["ArrowDown"]],callback:()=>r.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>r.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const n=t.getSelectedLast();if(n){const s=r.openSubMenu(n[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&r.isSubMenu()&&(r.close(),r.isSubMenu()&&r.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>r.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>r.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const s=t.getSelectedLast();s&&(t.getSourceDataAtRow(s[0]).submenu?r.openSubMenu(s[0]).getNavigator().toFirstItem():(r.executeCommand(n),r.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):r.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):r.getNavigator().toLastItem()}}]}const SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$8=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];n(createDefaultShortcutsList(r)),e.forEach(c=>{let{shortcuts:d,contextName:f}=c;s(d,f)});function n(c,d){l(d).addShortcuts(c,{group:SHORTCUTS_CONTEXT})}function s(c,d){const f=l(d);c.forEach(C=>{let{keys:m}=C;m.forEach(E=>f.removeShortcutsByKeys(E))}),t.push({shortcuts:c,contextName:d}),n(c,d)}function o(){return[...t]}function a(c){return c?`${SHORTCUTS_GROUP$8}:${c}`:SHORTCUTS_GROUP$8}function l(c){var d;const f=r.hotMenu.getShortcutManager(),C=a(c);return(d=f.getContext(C))!==null&&d!==void 0?d:f.addContext(C)}function u(c){r.hotMenu.getShortcutManager().setActiveContextName(a(c))}return{addCustomShortcuts:s,getCustomShortcuts:o,getContext:l,listen:u}}function createMenuItemRenderer(r){return(e,t,n,s,o,a)=>{const l=e.getSourceDataAtRow(n),u=r.rootDocument.createElement("div"),c=typeof a=="function"?a.call(r):a,d=typeof l.ariaLabel=="function"?l.ariaLabel.call(r):l.ariaLabel,f=typeof l.ariaChecked=="function"?l.ariaChecked.call(r):l.ariaChecked;if(empty$2(t),addClass$1(u,"htItemWrapper"),r.getSettings().ariaTags){const C=!isItemDisabled(l,r)&&!isItemSelectionDisabled(l)&&!isItemSeparator(l);setAttribute(t,[...isItemCheckable(l)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(d),A11Y_CHECKED(f)]:[A11Y_MENU_ITEM(),A11Y_LABEL(c)],...C?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(l,r)?[A11Y_DISABLED()]:[],...isItemSubMenu(l)?[A11Y_EXPANDED(!1)]:[]])}t.className="",t.appendChild(u),isItemSeparator(l)?addClass$1(t,"htSeparator"):typeof l.renderer=="function"?(addClass$1(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,u,n,s,o,c))):fastInnerHTML(u,c),isItemDisabled(l,r)?addClass$1(t,"htDisabled"):isItemSelectionDisabled(l)?addClass$1(t,"htSelectionDisabled"):isItemSubMenu(l)&&addClass$1(t,"htSubmenu")}}function _classPrivateFieldInitSpec$A(r,e,t){_checkPrivateRedeclaration$O(r,e),e.set(r,t)}function _checkPrivateRedeclaration$O(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$W(r,e,t){return(e=_toPropertyKey$W(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$W(r){var e=_toPrimitive$W(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$W(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$y(r,e,t){return r.set(_assertClassBrand$O(r,e),t),t}function _classPrivateFieldGet$A(r,e){return r.get(_assertClassBrand$O(r,e))}function _assertClassBrand$O(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const MIN_WIDTH=215;var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap;class Menu{get tableBorderWidth(){return _classPrivateFieldGet$A(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet$y(_tableBorderWidth,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet$A(_tableBorderWidth,this)}constructor(e,t){var n=this;_defineProperty$W(this,"hot",void 0),_defineProperty$W(this,"options",void 0),_defineProperty$W(this,"eventManager",new EventManager(this)),_defineProperty$W(this,"container",void 0),_defineProperty$W(this,"positioner",void 0),_defineProperty$W(this,"hotMenu",null),_defineProperty$W(this,"hotSubMenus",{}),_defineProperty$W(this,"parentMenu",void 0),_defineProperty$W(this,"menuItems",null),_defineProperty$W(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec$A(this,_navigator,void 0),_classPrivateFieldInitSpec$A(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec$A(this,_tableBorderWidth,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(s,o)=>{if(!o){var a;(a=this.hotMenu)===null||a===void 0||a.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=getParentWindow(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return _classPrivateFieldGet$A(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet$A(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=debounce$2(l=>this.openSubMenu(l),300),t=this.options.minWidth||MIN_WIDTH;let n=!1,s=arrayFilter(this.menuItems,l=>(l.key===KEY$1&&(n=!0),isItemHidden(l,this.hot)));if(s.length<1&&!n)s.push(predefinedItems()[KEY$1]);else if(s.length===0)return;s=filterSeparators(s,KEY$c);let o=!1;const a={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(l){return isDefined(l)&&l<t?t:l},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(l,u)=>{_classPrivateFieldGet$A(_navigator,this).setCurrentPage(u.row)},afterOnCellMouseOver:(l,u)=>{this.isAllSubMenusClosed()?e(u.row):this.openSubMenu(u.row)},rowHeights:l=>s[l].name===KEY$c?1:void 0,afterOnCellContextMenu:l=>{l.preventDefault(),isWindowsOS()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(l,u,c,d,f)=>{this.hotMenu.view.isMouseDown()&&(f.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:l=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(l))},afterOnCellMouseUp:l=>{(!isWindowsOS()||!isRightClick(l))&&o&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet$y(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet$y(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet$A(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet$A(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const n=this.parentMenu.hotMenu.getCell(t[0],0);setAttribute(n,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!hasSubMenu(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),s=new Menu(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(n.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=s,this.hot.getSettings().ariaTags&&setAttribute(t,[A11Y_EXPANDED(!0)]),s}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&setAttribute(s,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),s=n?normalizeSelection(n):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){return e.isCommand===!1||isItemSeparator(e)||isItemDisabled(e,this.hot)||isItemSubMenu(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,n=e.hider.style,s=e.holder.style,o=parseInt(n.width,10),a=arrayReduce(t,(l,u,c)=>{const f=this.hotMenu.getCell(c,0)?outerHeight(this.hotMenu.getCell(c,0)):0;return l+(u.name===KEY$c?1:f)},0);s.width=`${o}px`,s.height=`${a}px`,n.height=s.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let n=e,s;return n&&(isFunction$2(n)&&(n=n.call(this.hot),n===null||isUndefined$1(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,s=t.querySelector(`.${this.options.className}.${n}`)),s||(s=t.createElement("div"),addClass$1(s,`htMenu ${this.options.className}`),n&&addClass$1(s,n),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&hasClass$1(e.target,"htCore")&&isChildOf(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mixin(Menu,localHooks);function _classPrivateMethodInitSpec$B(r,e){_checkPrivateRedeclaration$N(r,e),e.add(r)}function _checkPrivateRedeclaration$N(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$V(r,e,t){return(e=_toPropertyKey$V(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$V(r){var e=_toPrimitive$V(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$V(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$N(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$p="contextMenu",PLUGIN_PRIORITY$o=70,SHORTCUTS_GROUP$7=PLUGIN_KEY$p;Hooks.getSingleton().register("afterContextMenuDefaultOptions");Hooks.getSingleton().register("beforeContextMenuShow");Hooks.getSingleton().register("afterContextMenuShow");Hooks.getSingleton().register("afterContextMenuHide");Hooks.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet;class ContextMenu extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$B(this,_ContextMenu_brand),_defineProperty$V(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$V(this,"itemsFactory",null),_defineProperty$V(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$p}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$o}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$3,KEY$2,KEY$c,KEY$9,KEY$8,KEY$c,KEY$4,KEY$5,KEY$c,KEY,KEY$6,KEY$c,KEY$7,KEY$c,KEY$b]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$p]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$p];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuBeforeOpen$1).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuAfterOpen$1).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuAfterClose$1).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",n=>_assertClassBrand$N(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$7})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$7)}open(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),objectEach(n,(o,a)=>{this.menu.setOffset(a,o)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);const e=this.hot.getSettings()[PLUGIN_KEY$p],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),arrayEach(n,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _onAfterOnCellContextMenu(r){const e=this.hot.getSettings(),t=e.rowHeaders,n=e.colHeaders;function s(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const o=r.target;if(this.close(),hasClass$1(o,"handsontableInput")||(r.preventDefault(),r.stopPropagation(),!(t||n)&&!s(o)&&!(hasClass$1(o,"current")&&hasClass$1(o,"wtBorder"))))return;const a=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:r.clientY+a.top,left:r.clientX+a.left})}function _onMenuBeforeOpen$1(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen$1(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose$1(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY$c};const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(r){const e=[[""]];if(r.length===0)return e;let t=0,n=0,s;for(;r.length>0&&s!==r.length;)if(s=r.length,r.match(regNextEmptyCell))r=r.replace(regNextEmptyCell,""),t+=1,e[n][t]="";else if(r.match(regUniversalNewLine))r=r.replace(regUniversalNewLine,""),t=0,n+=1,e[n]=[""];else{let o="";if(r.startsWith('"')){let a=0,l=!0;for(;l;){const u=r.slice(0,1);u==='"'&&(a+=1),o+=u,r=r.slice(1),(r.length===0||r.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,u=>new Array(Math.floor(u.length/2)).fill('"').join(""))}else{const a=r.match(regNextCellNoQuotes);o=a?a[0]:"",r=r.slice(o.length)}e[n][t]=o}return e}function stringify(r){let e,t,n,s,o="",a;for(e=0,t=r.length;e<t;e+=1){for(s=r[e].length,n=0;n<s;n+=1)n>0&&(o+="	"),a=r[e][n],typeof a=="string"?a.indexOf(`
`)>-1?o+=`"${a.replace(/"/g,'""')}"`:o+=a:a==null?o+="":o+=a;e!==t-1&&(o+=`
`)}return o}function copyItem(r){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){r.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(r){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,t)},callback(){r.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(r){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,t)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyWithColumnHeadersItem(r){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,t)},callback(){r.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function cutItem(r){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){r.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class ClipboardData{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}}function _classPrivateMethodInitSpec$A(r,e){_checkPrivateRedeclaration$M(r,e),e.add(r)}function _classPrivateFieldInitSpec$z(r,e,t){_checkPrivateRedeclaration$M(r,e),e.set(r,t)}function _checkPrivateRedeclaration$M(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$z(r,e){return r.get(_assertClassBrand$M(r,e))}function _classPrivateFieldSet$x(r,e,t){return r.set(_assertClassBrand$M(r,e),t),t}function _assertClassBrand$M(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet;class CopyableRangesFactory{constructor(e){let{countRows:t,countColumns:n,rowsLimit:s,columnsLimit:o,countColumnHeaders:a}=e;_classPrivateMethodInitSpec$A(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec$z(this,_selectedRange,void 0),_classPrivateFieldInitSpec$z(this,_countRows,void 0),_classPrivateFieldInitSpec$z(this,_countColumns,void 0),_classPrivateFieldInitSpec$z(this,_rowsLimit,void 0),_classPrivateFieldInitSpec$z(this,_columnsLimit$1,void 0),_classPrivateFieldInitSpec$z(this,_countColumnHeaders,void 0),_classPrivateFieldSet$x(_countRows,this,t),_classPrivateFieldSet$x(_countColumns,this,n),_classPrivateFieldSet$x(_rowsLimit,this,s),_classPrivateFieldSet$x(_columnsLimit$1,this,o),_classPrivateFieldSet$x(_countColumnHeaders,this,a)}setSelectedRange(e){_classPrivateFieldSet$x(_selectedRange,this,e)}getCellsRange(){if(_classPrivateFieldGet$z(_countRows,this).call(this)===0||_classPrivateFieldGet$z(_countColumns,this).call(this)===0)return null;const{row:e,col:t}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{row:n,col:s}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),o=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,e,n),a=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,t,s);return{isRangeTrimmed:n!==o||s!==a,startRow:e,startCol:t,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet$z(_countColumns,this).call(this)===0||_classPrivateFieldGet$z(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),n=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(_classPrivateFieldGet$z(_countColumns,this).call(this)===0||_classPrivateFieldGet$z(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),n=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-_classPrivateFieldGet$z(_countColumnHeaders,this).call(this),startCol:e,endRow:-1,endCol:n}}}function _trimColumnsRange(r,e){return Math.min(e,Math.max(r+_classPrivateFieldGet$z(_columnsLimit$1,this).call(this)-1,r))}function _trimRowsRange(r,e){return Math.min(e,Math.max(r+_classPrivateFieldGet$z(_rowsLimit,this).call(this)-1,r))}function normalizeRanges(r){const e=[],t=[];return arrayEach(r,n=>{const s=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);rangeEach(s,o,u=>{e.indexOf(u)===-1&&e.push(u)});const a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);rangeEach(a,l,u=>{t.indexOf(u)===-1&&t.push(u)})}),{rows:e,columns:t}}var es_string_replaceAll={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var r=requireIsObject(),e=requireClassofRaw(),t=requireWellKnownSymbol(),n=t("match");return isRegexp=function(s){var o;return r(s)&&((o=s[n])!==void 0?!!o:e(s)==="RegExp")},isRegexp}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var r=requireAnObject();return regexpFlags=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var r=requireFunctionCall(),e=requireHasOwnProperty(),t=requireObjectIsPrototypeOf(),n=requireRegexpFlags(),s=RegExp.prototype;return regexpGetFlags=function(o){var a=o.flags;return a===void 0&&!("flags"in s)&&!e(o,"flags")&&t(s,o)?r(n,o):a},regexpGetFlags}var getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var r=requireFunctionUncurryThis(),e=requireToObject(),t=Math.floor,n=r("".charAt),s=r("".replace),o=r("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(u,c,d,f,C,m){var E=d+u.length,v=f.length,_=l;return C!==void 0&&(C=e(C),_=a),s(m,_,function(T,R){var O;switch(n(R,0)){case"$":return"$";case"&":return u;case"`":return o(c,0,d);case"'":return o(c,E);case"<":O=C[o(R,1,-1)];break;default:var N=+R;if(N===0)return T;if(N>v){var G=t(N/10);return G===0?T:G<=v?f[G-1]===void 0?n(R,1):f[G-1]+n(R,1):T}O=f[N-1]}return O===void 0?"":O})},getSubstitution}var hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var r=require_export(),e=requireFunctionCall(),t=requireFunctionUncurryThis(),n=requireRequireObjectCoercible(),s=requireIsCallable(),o=requireIsNullOrUndefined(),a=requireIsRegexp(),l=requireToString(),u=requireGetMethod(),c=requireRegexpGetFlags(),d=requireGetSubstitution(),f=requireWellKnownSymbol(),C=requireIsPure(),m=f("replace"),E=TypeError,v=t("".indexOf),_=t("".replace),T=t("".slice),R=Math.max;return r({target:"String",proto:!0},{replaceAll:function(N,G){var D=n(this),k,z,ne,Z,ve,xe,de,Se,Me,Pe,_e=0,Oe="";if(!o(N)){if(k=a(N),k&&(z=l(n(c(N))),!~v(z,"g")))throw new E("`.replaceAll` does not allow non-global regexes");if(ne=u(N,m),ne)return e(ne,N,D,G);if(C&&k)return _(l(D),N,G)}for(Z=l(D),ve=l(N),xe=s(G),xe||(G=l(G)),de=ve.length,Se=R(1,de),Me=v(Z,ve);Me!==-1;)Pe=xe?l(G(ve,Me,Z)):d(ve,Z,Me,[],void 0,G),Oe+=T(Z,_e,Me)+Pe,_e=Me+de,Me=Me+Se>Z.length?-1:v(Z,ve,Me+Se);return _e<Z.length&&(Oe+=T(Z,_e)),Oe}}),es_string_replaceAll}requireEs_string_replaceAll();const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(r=>`(${r})`).join("|"),"gi");function isHTMLTable(r){return(r&&r.nodeName||"")==="TABLE"}function instanceToHTML(r){const e=r.hasColHeaders(),t=r.hasRowHeaders(),n=[e?-1:0,t?-1:0,r.countRows()-1,r.countCols()-1],s=r.getData(...n),o=s.length,a=o>0?s[0].length:0,l=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],d=t?1:0,f=e?1:0;for(let C=0;C<o;C+=1){const m=e&&C===0,E=[];for(let _=0;_<a;_+=1){const T=!m&&t&&_===0;let R="";if(m)R=`<th>${r.getColHeader(_-d)}</th>`;else if(T)R=`<th>${r.getRowHeader(C-f)}</th>`;else{const O=s[C][_],{hidden:N,rowspan:G,colspan:D}=r.getCellMeta(C-f,_-d);if(!N){const k=[];if(G&&k.push(`rowspan="${G}"`),D&&k.push(`colspan="${D}"`),isEmpty$1(O))R=`<td ${k.join(" ")}></td>`;else{const z=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${k.join(" ")}>${z}</td>`}}}E.push(R)}const v=["<tr>",...E,"</tr>"].join("");m?u.splice(1,0,v):c.splice(-1,0,v)}return l.splice(1,0,u.join(""),c.join("")),l.join("")}function _dataToHTML(r){const e=r.length,t=["<table>"];for(let n=0;n<e;n+=1){const s=r[n],o=s.length,a=[];n===0&&t.push("<tbody>");for(let l=0;l<o;l+=1){const u=s[l],c=isEmpty$1(u)?"":u.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,d=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(d.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${c}</td>`)}t.push("<tr>",...a,"</tr>"),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function htmlToGridSettings(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},n=e.createDocumentFragment(),s=e.createElement("div");n.appendChild(s);let o=r;if(typeof o=="string"){const O=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,N=>{const G=N.match(/<td\b[^>]*?>/g)[0],D=/<p.*?>/g,k=N.substring(G.length,N.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(D,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${G}${k}</td>`});s.insertAdjacentHTML("afterbegin",`${O}`),o=s.querySelector("table")}if(!o||!isHTMLTable(o))return;const a=s.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce((O,N)=>O+N.colSpan,0)-(l?1:0):0,d=o.tFoot&&Array.from(o.tFoot.rows)||[],f=[];let C=!1,m=0,E=0;if(o.tHead){const O=Array.from(o.tHead.rows).filter(N=>{const G=N.querySelector("td")!==null;return G&&f.push(N),!G});m=O.length,C=m>0,m>1?t.nestedHeaders=Array.from(O).reduce((N,G)=>{const D=Array.from(G.cells).reduce((k,z,ne)=>{if(l&&ne===0)return k;const{colSpan:Z,innerHTML:ve}=z,xe=Z>1?{label:ve,colspan:Z}:ve;return k.push(xe),k},[]);return N.push(D),N},[]):C&&(t.colHeaders=Array.from(O[0].children).reduce((N,G,D)=>(l&&D===0||N.push(G.innerHTML),N),[]))}f.length&&(t.fixedRowsTop=f.length),d.length&&(t.fixedRowsBottom=d.length);const v=[...f,...Array.from(o.tBodies).reduce((O,N)=>(O.push(...Array.from(N.rows)),O),[]),...d];E=v.length;const _=new Array(E);for(let O=0;O<E;O++)_[O]=new Array(c);const T=[],R=[];for(let O=0;O<E;O++){const N=v[O],G=Array.from(N.cells),D=G.length;for(let k=0;k<D;k++){const z=G[k],{nodeName:ne,innerHTML:Z,rowSpan:ve,colSpan:xe}=z,de=_[O].findIndex(Se=>Se===void 0);if(ne==="TD"){if(ve>1||xe>1){for(let _e=O;_e<O+ve;_e++)if(_e<E)for(let Oe=de;Oe<de+xe;Oe++)_[_e][Oe]=null;const Me=z.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||T.push({col:de,row:O,rowspan:ve,colspan:xe})}let Se="";a&&/excel/gi.test(a.content)?Se=Z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Se=Z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),_[O][de]=Se.replace(regEscapedChars,Me=>ESCAPED_HTML_CHARS[Me])}else R.push(Z)}}return T.length&&(t.mergeCells=T),R.length&&(t.rowHeaders=R),_.length&&(t.data=_),t}function _classPrivateMethodInitSpec$z(r,e){_checkPrivateRedeclaration$L(r,e),e.add(r)}function _classPrivateFieldInitSpec$y(r,e,t){_checkPrivateRedeclaration$L(r,e),e.set(r,t)}function _checkPrivateRedeclaration$L(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$U(r,e,t){return(e=_toPropertyKey$U(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$U(r){var e=_toPrimitive$U(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$U(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$y(r,e){return r.get(_assertClassBrand$L(r,e))}function _classPrivateFieldSet$w(r,e,t){return r.set(_assertClassBrand$L(r,e),t),t}function _assertClassBrand$L(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterCopyLimit");Hooks.getSingleton().register("modifyCopyableRange");Hooks.getSingleton().register("beforeCut");Hooks.getSingleton().register("afterCut");Hooks.getSingleton().register("beforePaste");Hooks.getSingleton().register("afterPaste");Hooks.getSingleton().register("beforeCopy");Hooks.getSingleton().register("afterCopy");const PLUGIN_KEY$o="copyPaste",PLUGIN_PRIORITY$n=80,SETTING_KEYS$1=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet;class CopyPaste extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$z(this,_CopyPaste_brand),_defineProperty$U(this,"columnsLimit",1/0),_defineProperty$U(this,"rowsLimit",1/0),_defineProperty$U(this,"pasteMode","overwrite"),_defineProperty$U(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec$y(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec$y(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec$y(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec$y(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec$y(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec$y(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec$y(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec$y(this,_preventViewportScrollOnPaste,!1),_defineProperty$U(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$o}static get SETTING_KEYS(){return[PLUGIN_KEY$o,...SETTING_KEYS$1]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$n}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$o]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),_classPrivateFieldSet$w(_enableCopyColumnHeaders,this,this.getSetting("copyColumnHeaders")),_classPrivateFieldSet$w(_enableCopyColumnGroupHeaders,this,this.getSetting("copyColumnGroupHeaders")),_classPrivateFieldSet$w(_enableCopyColumnHeadersOnly,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(t=this.getSetting("uiContainer"))!==null&&t!==void 0?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>_assertClassBrand$L(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions$4).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onAfterSelection).call(n,...o)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand$L(_CopyPaste_brand,this,_onAfterSelectionEnd$1).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),isSafari()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onSafariMouseEnter).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onSafariMouseLeave).call(n,...o)}),this.addHook("afterSelection",()=>_assertClassBrand$L(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$w(_copyMode,this,e),_classPrivateFieldSet$w(_isTriggeredByCopy,this,!0),_assertClassBrand$L(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet$w(_isTriggeredByCut,this,!0),_assertClassBrand$L(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(e){return stringify(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:s}=normalizeRanges(e);return arrayEach(n,o=>{const a=[];arrayEach(s,l=>{o<0?a.push(this.hot.getColHeader(l,o)):a.push(this.hot.getCopyableData(o,l))}),t.push(a)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const n=new PasteEvent;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet$y(_copyableRangesFactory,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$y(_copyMode,this)==="column-headers-only"?t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$y(_copyMode,this)==="with-column-headers"?t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$y(_copyMode,this)==="with-column-group-headers"&&t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getAllColumnHeadersRange()),t.set("cells",_classPrivateFieldGet$y(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:o,startCol:a,endRow:l,endCol:u}=s;return{startRow:o,startCol:a,endRow:l,endCol:u}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:s,startCol:o,endRow:a,endCol:l}=n;this.hot.runHooks("afterCopyLimit",a-s+1,l-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,s=e[0].length,o=[],{row:a,col:l}=t.getTopStartCorner(),{row:u,col:c}=t.getBottomEndCorner();let d=a,f=l,C=a,m=l;for(;o.length<n||d<=u;){const{skipRowOnPaste:E,visualRow:v}=this.hot.getCellMeta(d,l);if(d=v+1,E===!0)continue;C=v,f=l;const _=[],T=o.length%n;for(;_.length<s||f<=c;){const{skipColumnOnPaste:R,visualCol:O}=this.hot.getCellMeta(a,f);if(f=O+1,R===!0)continue;m=O;const N=_.length%s;_.push(e[T][N])}o.push(_)}return _classPrivateFieldSet$w(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,C,m]}onCopy(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$y(_isTriggeredByCopy,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$w(_isTriggeredByCopy,this,!1);const o=this.getRangedData(this.copyableRanges),a=_assertClassBrand$L(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)){const u=stringify(o);if(e&&e.clipboardData){const c=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[META_HEAD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}_classPrivateFieldSet$w(_copyMode,this,"cells-only")}onCut(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$y(_isTriggeredByCut,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$w(_isTriggeredByCut,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const l=stringify(o);if(e&&e.clipboardData){const u=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[META_HEAD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const d=sanitize(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=htmlToGridSettings(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=parse(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o);this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function _ensureClipboardEventsGetTriggered(r){if(isSafari()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,s=this.hot.getCell(t,n,!0);s&&runWithSelectedContendEditableElement(s,()=>{this.hot.rootDocument.execCommand(r)})}}else this.hot.rootDocument.execCommand(r)}function _countCopiedHeaders(r){const{rows:e}=normalizeRanges(r);let t=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)t+=1;return{columnHeadersCount:t}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const r=this.hot.getSelectedRangeLast();if(r){const{row:e,col:t}=r.highlight,n=this.hot.getCell(e,t,!0);n&&makeElementContentEditableAndSelectItsContent(n)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const r=this.hot.getSelectedRangeLast();if(r){const{row:e,col:t}=r.highlight,n=this.hot.getCell(e,t,!0);n!=null&&n.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(n)}}}function _onAfterContextMenuDefaultOptions$4(r){r.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$y(_enableCopyColumnHeaders,this)&&r.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$y(_enableCopyColumnGroupHeaders,this)&&r.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$y(_enableCopyColumnHeadersOnly,this)&&r.items.push(copyColumnHeadersOnlyItem(this)),r.items.push(cutItem(this))}function _onAfterSelection(r,e,t,n,s){_classPrivateFieldGet$y(_preventViewportScrollOnPaste,this)&&(s.value=!0),_classPrivateFieldSet$w(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd$1(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand$L(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand$L(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand$L(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(r,e){return`border_row${r}col${e}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(r){if(isDefined(r.start)||isDefined(r.left)){var e;r.start=(e=r.start)!==null&&e!==void 0?e:r.left}if(isDefined(r.end)||isDefined(r.right)){var t;r.end=(t=r.end)!==null&&t!==void 0?t:r.right}return delete r.left,delete r.right,r}function denormalizeBorder(r){return isDefined(r.start)&&(r.left=r.start),isDefined(r.end)&&(r.right=r.end),r}function createEmptyBorders(r,e){return{id:createId(r,e),border:createDefaultHtBorder(),row:r,col:e,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(r,e){return hasOwnProperty(e,"border")&&e.border&&(r.border=e.border),hasOwnProperty(e,"top")&&isDefined(e.top)&&(e.top?(isObject$1(e.top)||(e.top=createDefaultCustomBorder()),r.top=e.top):(e.top=createSingleEmptyBorder(),r.top=e.top)),hasOwnProperty(e,"bottom")&&isDefined(e.bottom)&&(e.bottom?(isObject$1(e.bottom)||(e.bottom=createDefaultCustomBorder()),r.bottom=e.bottom):(e.bottom=createSingleEmptyBorder(),r.bottom=e.bottom)),hasOwnProperty(e,"start")&&isDefined(e.start)&&(e.start?(isObject$1(e.start)||(e.start=createDefaultCustomBorder()),r.start=e.start):(e.start=createSingleEmptyBorder(),r.start=e.start)),hasOwnProperty(e,"end")&&isDefined(e.end)&&(e.end?(isObject$1(e.end)||(e.end=createDefaultCustomBorder()),r.end=e.end):(e.end=createSingleEmptyBorder(),r.end=e.end)),r}function checkSelectionBorders(r,e){let t=!1;return arrayEach(r.getSelectedRange(),n=>{n.forAll((s,o)=>{if(s<0||o<0)return;const a=r.getCellMeta(s,o).borders;if(a)if(e){if(!hasOwnProperty(a[e],"hide")||a[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function markSelected(r){return`<span class="selected"></span>${r}`}function hasLeftRightTypeOptions(r){return r.some(e=>isDefined(e.left)||isDefined(e.right))}function hasStartEndTypeOptions(r){return r.some(e=>isDefined(e.start)||isDefined(e.end))}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(r){var e;return(e=physicalToInlinePropNames.get(r))!==null&&e!==void 0?e:r}function bottom$1(r){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(e=markSelected(e)),e},callback(e,t){const n=checkSelectionBorders(this,"bottom");r.prepareBorder(t,"bottom",n)}}}function left$1(r){const e=r.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,e)&&(t=markSelected(t)),t},callback(t,n){const s=checkSelectionBorders(this,e);r.prepareBorder(n,e,s)}}}function noBorders(r){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){r.prepareBorder(t,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right$1(r){const e=r.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,e)&&(t=markSelected(t)),t},callback(t,n){const s=checkSelectionBorders(this,e);r.prepareBorder(n,e,s)}}}function top$1(r){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(e=markSelected(e)),e},callback(e,t){const n=checkSelectionBorders(this,"top");r.prepareBorder(t,"top",n)}}}function _defineProperty$T(r,e,t){return(e=_toPropertyKey$T(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$T(r){var e=_toPrimitive$T(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$T(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class VisualSelection extends Selection$2{constructor(e,t){super(e,null),_defineProperty$T(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,s=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);return s===null||o===null?null:((s.row>o.row||s.col>o.col)&&(s=t,o=n),this.settings.createCellRange(s,s,o))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(s===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(s,o)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(t,n,s)),a!==null&&e.overlaps(a)){const l=e.highlight.clone();if(l.row>=0&&(l.row=a.row),l.col>=0&&(l.col=a.col),this.cellRange===null){const u=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(t);return n.row===null||n.col===null||s.row===null||s.col===null?null:this.settings.createCellRange(n,n,s)}}function createHighlight$8(r){let{activeHeaderClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight$7(r){let{areaCornerVisible:e,...t}=r;return new VisualSelection({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:AREA_TYPE})}function createHighlight$6(r){let{...e}=r;return new VisualSelection({className:"highlight",...e,selectionType:AREA_TYPE})}function createHighlight$5(r){let{columnClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:COLUMN_TYPE})}function createHighlight$4(r){let{cellCornerVisible:e,...t}=r;return new VisualSelection({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:FOCUS_TYPE})}function createHighlight$3(r){let{border:e,visualCellRange:t,...n}=r;return new VisualSelection({...e,...n,selectionType:CUSTOM_SELECTION_TYPE},t)}function createHighlight$2(r){let{...e}=r;return new VisualSelection({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:FILL_TYPE})}function createHighlight$1(r){let{headerClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:HEADER_TYPE})}function createHighlight(r){let{rowClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:ROW_TYPE})}function _classPrivateMethodInitSpec$y(r,e){_checkPrivateRedeclaration$K(r,e),e.add(r)}function _checkPrivateRedeclaration$K(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$S(r,e,t){return(e=_toPropertyKey$S(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$S(r){var e=_toPrimitive$S(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$S(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$K(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet;class Highlight{constructor(e){_classPrivateMethodInitSpec$y(this,_Highlight_brand),_defineProperty$S(this,"options",void 0),_defineProperty$S(this,"layerLevel",0),_defineProperty$S(this,"focus",void 0),_defineProperty$S(this,"fill",void 0),_defineProperty$S(this,"layeredAreas",new Map),_defineProperty$S(this,"areas",new Map),_defineProperty$S(this,"rowHeaders",new Map),_defineProperty$S(this,"columnHeaders",new Map),_defineProperty$S(this,"activeRowHeaders",new Map),_defineProperty$S(this,"activeColumnHeaders",new Map),_defineProperty$S(this,"activeCornerHeaders",new Map),_defineProperty$S(this,"rowHighlights",new Map),_defineProperty$S(this,"columnHighlights",new Map),_defineProperty$S(this,"customSelections",[]),this.options=e,this.focus=createHighlight$4(e),this.fill=createHighlight$2(e)}isEnabledFor(e,t){let n=e;e===FOCUS_TYPE&&(n="current");let s=this.options.disabledCellSelection(t.row,t.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight$7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight$6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight$1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight$1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight$8)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight$8)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight$8)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight$5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(createHighlight$3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach(this.areas.values(),e=>void e.clear()),arrayEach(this.layeredAreas.values(),e=>void e.clear()),arrayEach(this.rowHeaders.values(),e=>void e.clear()),arrayEach(this.columnHeaders.values(),e=>void e.clear()),arrayEach(this.activeRowHeaders.values(),e=>void e.clear()),arrayEach(this.activeColumnHeaders.values(),e=>void e.clear()),arrayEach(this.activeCornerHeaders.values(),e=>void e.clear()),arrayEach(this.rowHighlights.values(),e=>void e.clear()),arrayEach(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _createHighlight(r,e){const t=this.layerLevel;if(r.has(t))return r.get(t);const n=e({layerLevel:t,...this.options});return r.set(t,n),n}function _defineProperty$R(r,e,t){return(e=_toPropertyKey$R(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$R(r){var e=_toPrimitive$R(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$R(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}let SelectionRange$1=class{constructor(e){_defineProperty$R(this,"ranges",[]),_defineProperty$R(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}};function _classPrivateMethodInitSpec$x(r,e){_checkPrivateRedeclaration$J(r,e),e.add(r)}function _classPrivateFieldInitSpec$x(r,e,t){_checkPrivateRedeclaration$J(r,e),e.set(r,t)}function _checkPrivateRedeclaration$J(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$x(r,e){return r.get(_assertClassBrand$J(r,e))}function _classPrivateFieldSet$v(r,e,t){return r.set(_assertClassBrand$J(r,e),t),t}function _assertClassBrand$J(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset=new WeakMap,_Transformation_brand=new WeakSet;class Transformation{constructor(e,t){_classPrivateMethodInitSpec$x(this,_Transformation_brand),_classPrivateFieldInitSpec$x(this,_range,void 0),_classPrivateFieldInitSpec$x(this,_options,void 0),_classPrivateFieldInitSpec$x(this,_offset,{x:0,y:0}),_classPrivateFieldSet$v(_range,this,e),_classPrivateFieldSet$v(_options,this,t)}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=_classPrivateFieldGet$x(_options,this).createCellCoords(e,t);let o=_classPrivateFieldGet$x(_range,this).current().highlight;const a=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(o);let l=0,u=0;if(this.runLocalHooks("beforeTransformStart",s),a.row!==null&&a.col!==null){const{width:c,height:d}=_assertClassBrand$J(_Transformation_brand,this,_getTableSize).call(this),{row:f,col:C}=_assertClassBrand$J(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,o),m=_classPrivateFieldGet$x(_options,this).fixedRowsBottom(),E=_classPrivateFieldGet$x(_options,this).minSpareRows(),v=_classPrivateFieldGet$x(_options,this).minSpareCols(),_=_classPrivateFieldGet$x(_options,this).autoWrapRow(),T=_classPrivateFieldGet$x(_options,this).autoWrapCol(),R=_classPrivateFieldGet$x(_options,this).createCellCoords(f+s.row,C+s.col);if(R.row>=d){const G=createObjectPropListener(n&&E>0&&m===0),D=R.col+1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(R.row-d,D>=c?D-c:D);this.runLocalHooks("beforeColumnWrap",G,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),D>=c),G.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet$x(_options,this).countRenderableRows()):T&&R.assign(k)}else if(R.row<0){const G=createObjectPropListener(T),D=R.col-1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(d+R.row,D<0?c+D:D);this.runLocalHooks("beforeColumnWrap",G,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),D<0),T&&R.assign(k)}if(R.col>=c){const G=createObjectPropListener(n&&v>0),D=R.row+1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(D>=d?D-d:D,R.col-c);this.runLocalHooks("beforeRowWrap",G,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),D>=d),G.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet$x(_options,this).countRenderableColumns()):_&&R.assign(k)}else if(R.col<0){const G=createObjectPropListener(_),D=R.row-1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(D<0?d+D:D,c+R.col);this.runLocalHooks("beforeRowWrap",G,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),D<0),_&&R.assign(k)}const{rowDir:O,colDir:N}=_assertClassBrand$J(_Transformation_brand,this,_clampCoords).call(this,R);l=O,u=N,o=_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,R)}return this.runLocalHooks("afterTransformStart",o,l,u),o}transformEnd(e,t){const n=_classPrivateFieldGet$x(_options,this).createCellCoords(e,t),s=_classPrivateFieldGet$x(_range,this).current(),o=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(s.highlight),a=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,s.to.row,s.from.row),l=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,s.to.col,s.from.col),u=s.to.clone();let c=0,d=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&a!==null&&l!==null){const{row:f,col:C}=_assertClassBrand$J(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,s.highlight),m=_classPrivateFieldGet$x(_options,this).createCellCoords(a+n.row,l+n.col),E=s.getTopStartCorner(),v=s.getTopEndCorner(),_=s.getBottomEndCorner();if(n.col<0&&l>=C&&m.col<C){const N=m.col-C;m.col=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,E.col,v.col)+N}else if(n.col>0&&l<=C&&m.col>C){const N=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,v.col,E.col),G=Math.max(m.col-N,1);m.col=N+G}if(n.row<0&&a>=f&&m.row<f){const N=m.row-f;m.row=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,E.row,_.row)+N}else if(n.row>0&&a<=f&&m.row>f){const N=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,_.row,E.row),G=Math.max(m.row-N,1);m.row=N+G}const{rowDir:T,colDir:R}=_assertClassBrand$J(_Transformation_brand,this,_clampCoords).call(this,m);c=T,d=R;const O=_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,m);n.row===0&&n.col!==0?u.col=O.col:n.row!==0&&n.col===0?u.row=O.row:(u.row=O.row,u.col=O.col)}return this.runLocalHooks("afterTransformEnd",u,c,d),u}setOffsetSize(e){let{x:t,y:n}=e;_classPrivateFieldSet$v(_offset,this,{x:t,y:n})}resetOffsetSize(){_classPrivateFieldSet$v(_offset,this,{x:0,y:0})}}function _clampCoords(r){const{width:e,height:t}=_assertClassBrand$J(_Transformation_brand,this,_getTableSize).call(this);let n=0,s=0;return r.row<0?(n=-1,r.row=0):r.row>0&&r.row>=t&&(n=1,r.row=t-1),r.col<0?(s=-1,r.col=0):r.col>0&&r.col>=e&&(s=1,r.col=e-1),{rowDir:n,colDir:s}}function _getTableSize(){return{width:_classPrivateFieldGet$x(_offset,this).x+_classPrivateFieldGet$x(_options,this).countRenderableColumns(),height:_classPrivateFieldGet$x(_offset,this).y+_classPrivateFieldGet$x(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(r,e){const t=_classPrivateFieldGet$x(_options,this).findFirstNonHiddenRenderableRow(r,e);return t===null?null:_classPrivateFieldGet$x(_offset,this).y+t}function _findFirstNonHiddenZeroBasedColumn(r,e){const t=_classPrivateFieldGet$x(_options,this).findFirstNonHiddenRenderableColumn(r,e);return t===null?null:_classPrivateFieldGet$x(_offset,this).x+t}function _visualToZeroBasedCoords(r){const{row:e,col:t}=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(r);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return _classPrivateFieldGet$x(_options,this).createCellCoords(_classPrivateFieldGet$x(_offset,this).y+e,_classPrivateFieldGet$x(_offset,this).x+t)}function _zeroBasedToVisualCoords(r){const e=r.clone();return e.col=r.col-_classPrivateFieldGet$x(_offset,this).x,e.row=r.row-_classPrivateFieldGet$x(_offset,this).y,_classPrivateFieldGet$x(_options,this).renderableToVisualCoords(e)}mixin(Transformation,localHooks);function _classPrivateFieldInitSpec$w(r,e,t){_checkPrivateRedeclaration$I(r,e),e.set(r,t)}function _checkPrivateRedeclaration$I(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$Q(r,e,t){return(e=_toPropertyKey$Q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Q(r){var e=_toPrimitive$Q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$w(r,e){return r.get(_assertClassBrand$I(r,e))}function _classPrivateFieldSet$u(r,e,t){return r.set(_assertClassBrand$I(r,e),t),t}function _assertClassBrand$I(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap;let Selection$1=class{constructor(e,t){var n=this;_defineProperty$Q(this,"settings",void 0),_defineProperty$Q(this,"tableProps",void 0),_defineProperty$Q(this,"inProgress",!1),_defineProperty$Q(this,"selectedRange",new SelectionRange$1((s,o,a)=>this.tableProps.createCellRange(s,o,a))),_defineProperty$Q(this,"highlight",void 0),_classPrivateFieldInitSpec$w(this,_transformation,void 0),_classPrivateFieldInitSpec$w(this,_focusTransformation,void 0),_defineProperty$Q(this,"selectedByRowHeader",new Set),_defineProperty$Q(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec$w(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec$w(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec$w(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec$w(this,_expectedLayersCount,-1),this.settings=e,this.tableProps=t,this.highlight=new Highlight({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(s,o)=>this.tableProps.isDisabledCellSelection(s,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),createCellRange:(s,o,a)=>this.tableProps.createCellRange(s,o,a)}),_classPrivateFieldSet$u(_transformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),_classPrivateFieldSet$u(_focusTransformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformStart",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformStart",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformEnd",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("insertRowRequire",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("insertRowRequire",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("insertColRequire",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("insertColRequire",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeRowWrap",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeRowWrap",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeColumnWrap",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeColumnWrap",...o)}),_classPrivateFieldGet$w(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),_classPrivateFieldGet$w(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){_classPrivateFieldSet$u(_selectionSource,this,e)}markEndSource(){_classPrivateFieldSet$u(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet$w(_selectionSource,this)}setExpectedLayers(e){_classPrivateFieldSet$u(_expectedLayersCount,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet$u(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=isUndefined$1(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,l=e.clone();_classPrivateFieldSet$u(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,l),(!o||o&&!a&&isUndefined$1(t))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(s.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||s>0)&&(n===0&&t.col<0&&!o||s===0&&t.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),d=this.isMultiple();a.setTo(t),d&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),d&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}n>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const l=_classPrivateFieldGet$w(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet$w(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),s=this.tableProps.countCols();t<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),E=>void E.clear()),arrayEach(this.highlight.getLayeredAreas(),E=>void E.clear()),arrayEach(this.highlight.getRowHeaders(),E=>void E.clear()),arrayEach(this.highlight.getColumnHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveRowHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveColumnHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveCornerHeaders(),E=>void E.clear()),arrayEach(this.highlight.getRowHighlights(),E=>void E.clear()),arrayEach(this.highlight.getColumnHighlights(),E=>void E.clear())),this.highlight.useLayerLevel(t);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),d.clear(),f.clear(),C.clear(),m.clear(),this.highlight.isEnabledFor(AREA_TYPE,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),t===1)){const E=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(E.from).commit().syncWith(E),this.highlight.createLayeredArea().add(E.from).commit().syncWith(E),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(HEADER_TYPE,e.highlight)){if(!e.isSingleHeader()){const _=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),O=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(l.add(_).commit(),u.add(R).commit(),C.add(_).commit(),m.add(R).commit()):(l.add(_).add(T).commit(),u.add(R).add(O).commit(),C.add(_).add(T).commit(),m.add(R).add(O).commit())}const E=!_classPrivateFieldGet$w(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(s>0&&s===e.getWidth()||s===0&&this.isSelectedByRowHeader()),v=!_classPrivateFieldGet$w(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());E&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&d.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),E&&v&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(_classPrivateFieldSet$u(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_classPrivateFieldGet$w(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$w(_transformation,this).resetOffsetSize(),this.setRangeStart(_classPrivateFieldGet$w(_transformation,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?_classPrivateFieldGet$w(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$w(_transformation,this).resetOffsetSize(),this.setRangeEnd(_classPrivateFieldGet$w(_transformation,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:s,col:o}=n.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,o-1),l=this.tableProps.countRenderableRowsInRange(0,s-1);n.highlight.isHeader()?_classPrivateFieldGet$w(_focusTransformation,this).setOffsetSize({x:o<0?Math.abs(o):-a,y:s<0?Math.abs(s):-l}):_classPrivateFieldGet$w(_focusTransformation,this).setOffsetSize({x:o<0?0:-a,y:s<0?0:-l});const u=_classPrivateFieldGet$w(_focusTransformation,this).transformStart(e,t);this.setRangeFocus(u.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:s,to:o,highlight:a}=n,l=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),d=c?-1:0,f=c?0:t;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(clamp(s.row+f,d,l-1),s.col),m=this.tableProps.createCellCoords(clamp(o.row+t,d,l-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(clamp(a.row+t,0,l-1),a.col)):this.setRangeStartOnly(C,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:s,to:o,highlight:a}=n,l=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),d=u?-1:0,f=u?0:t;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(s.row,clamp(s.col+f,d,l-1)),m=this.tableProps.createCellCoords(o.row,clamp(o.col+t,d,l-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(a.row,clamp(a.col+t,0,l-1))):this.setRangeStartOnly(C,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet$w(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{col:o}=s.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(a>0&&o<0||a===0)&&s.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{row:o}=s.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(a>0&&o<0||a===0)&&s.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),c=n?-u:0,d=t?-l:0;if(c===0&&d===0&&(o===0||a===0))return;let f=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:C,disableHeadersHighlight:m}=s;_classPrivateFieldSet$u(_disableHeadersHighlight,this,m),C&&Number.isInteger(C==null?void 0:C.row)&&Number.isInteger(C==null?void 0:C.col)&&(f=this.tableProps.createCellCoords(clamp(C.row,c,o-1),clamp(C.col,d,a-1)));const E=this.tableProps.createCellCoords(c,d),v=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.setRangeStartOnly(E,void 0,f),d<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),_classPrivateFieldSet$u(_disableHeadersHighlight,this,!1)}selectCells(e){var t=this;const n=detectSelectionType(e);if(n===SELECTION_TYPE_EMPTY)return!1;if(n===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=normalizeSelectionFactory(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},l=!e.some(u=>{const c=s(u),d=c.isValid(a);return!(d&&!c.containsHeaders()||d&&c.containsHeaders()&&c.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),arrayEach(e,u=>{const{from:c,to:d}=s(u);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(d.clone())}),this.finish()),l}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countRows(),l=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),c=u===0?0:-u,d=this.tableProps.createCellCoords(c,s),f=this.tableProps.createCellCoords(a-1,o),C=this.tableProps.createCellRange(d,d,f).isValid({countRows:a,countCols:l,countRowHeaders:0,countColHeaders:u});if(C){let m=0,E=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(m=clamp(n.row,c,a-1),E=clamp(n.col,Math.min(s,o),Math.max(s,o))):(m=clamp(n,c,a-1),E=s);const v=this.tableProps.createCellCoords(m,E),_=u===0?0:clamp(v.row,c,-1),T=a-1,R=this.tableProps.createCellCoords(_,s),O=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",R,O,v),R.row=_,O.row=T,this.setRangeStartOnly(R,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.runLocalHooks("afterSelectColumns",R,O,v),this.finish()}return C}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=a===0?0:-a,u=this.tableProps.createCellCoords(e,l),c=this.tableProps.createCellCoords(t,o-1),d=this.tableProps.createCellRange(u,u,c).isValid({countRows:s,countCols:o,countRowHeaders:a,countColHeaders:0});if(d){let f=0,C=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(f=clamp(n.row,Math.min(e,t),Math.max(e,t)),C=clamp(n.col,l,o-1)):(f=e,C=clamp(n,l,o-1));const m=this.tableProps.createCellCoords(f,C),E=a===0?0:clamp(m.col,l,-1),v=o-1,_=this.tableProps.createCellCoords(e,E),T=this.tableProps.createCellCoords(t,v);this.runLocalHooks("beforeSelectRows",_,T,m),_.col=E,T.col=v,this.setRangeStartOnly(_,void 0,m),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",_,T,m),this.finish()}return d}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:s,to:o,highlight:a}=n;this.clear(),a.assign({row:clamp(a.row,-1/0,e-1),col:clamp(a.col,-1/0,t-1)}),s.assign({row:clamp(s.row,-1/0,e-1),col:clamp(s.col,-1/0,t-1)}),o.assign({row:clamp(o.row,0,e-1),col:clamp(o.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(a).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const t=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(FOCUS_TYPE,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),C.commit(),m.commit()}this.highlight.useLayerLevel(t)}};mixin(Selection$1,localHooks);function mouseDown(r){let{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:s,selection:o,controller:a,cellCoordsFactory:l}=r;const u=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),d=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&u)s.row>=0&&s.col>=0&&!a.cell?o.setRangeEnd(s):(c||d)&&s.row>=0&&s.col>=0&&!a.cell?o.setRangeEnd(l(s.row,s.col)):c&&s.row<0&&!a.column?o.setRangeEnd(l(u.to.row,s.col)):d&&s.col<0&&!a.row?o.setRangeEnd(l(s.row,u.to.col)):(!c&&!d&&s.col<0||c&&s.col<0)&&!a.row?o.selectRows(Math.max(u.from.row,0),s.row,s.col):(!c&&!d&&s.row<0||d&&s.row<0)&&!a.column&&o.selectColumns(Math.max(u.from.col,0),s.col,s.row);else{const f=!o.inInSelection(s),C=t||n&&f;s.row<0&&s.col>=0&&!a.column?C&&o.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!a.row?C&&o.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!a.cell?C&&o.setRangeStart(s):s.col<0&&s.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function mouseOver(r){let{isLeftClick:e,coords:t,selection:n,controller:s,cellCoordsFactory:o}=r;if(!e)return;const a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),u=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),l&&!s.column?n.setRangeEnd(o(c-1,t.col)):a&&!s.row?n.setRangeEnd(o(t.row,u-1)):s.cell||n.setRangeEnd(t),n.markEndSource()}const handlers$1=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(r,e){let{coords:t,selection:n,controller:s,cellCoordsFactory:o}=e;handlers$1.get(r.type)({coords:t,selection:n,controller:s,cellCoordsFactory:o,isShiftKey:r.shiftKey,isLeftClick:isLeftClick(r)||r.type==="touchstart",isRightClick:isRightClick(r)})}function _classPrivateMethodInitSpec$w(r,e){_checkPrivateRedeclaration$H(r,e),e.add(r)}function _checkPrivateRedeclaration$H(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$P(r,e,t){return(e=_toPropertyKey$P(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$P(r){var e=_toPrimitive$P(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$P(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$H(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$n="customBorders",PLUGIN_PRIORITY$m=90;var _CustomBorders_brand=new WeakSet;class CustomBorders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$w(this,_CustomBorders_brand),_defineProperty$P(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$n}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$m}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$n]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$H(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions$3).call(this,e)),this.addHook("init",()=>_assertClassBrand$H(_CustomBorders_brand,this,_onAfterInit$2).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),s=normalizeBorder(t));const o=detectSelectionType(e),a=normalizeSelectionFactory(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach(e,l=>{a(l).forAll((u,c)=>{arrayEach(n,d=>{this.prepareBorderFromCustomAdded(u,c,s,toInlinePropName(d))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=detectSelectionType(e),n=normalizeSelectionFactory(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return arrayEach(e,o=>{n(o).forAll((a,l)=>{arrayEach(this.savedBorders,u=>{u.row===a&&u.col===l&&s.push(denormalizeBorder(u))})})}),s}clearBorders(e){e?this.setBorders(e):(arrayEach(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,n,s){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||t>=a)return;let l=createEmptyBorders(e,t);n&&(l=extendDefaultBorder(l,n),arrayEach(this.hot.selection.highlight.customSelections,u=>{if(l.id===u.settings.id)return Object.assign(u.settings,n),l.id=u.settings.id,l.top=u.settings.top,l.bottom=u.settings.bottom,l.start=u.settings.start,l.end=u.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(l)),this.insertBorderIntoSettings(l,s)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);rangeEach(e.from.row,n,o=>{rangeEach(e.from.col,s,a=>{const l=createEmptyBorders(o,a);let u=0;o===e.from.row&&hasOwnProperty(t,"top")&&(u+=1,l.top=t.top),o===e.to.row&&hasOwnProperty(t,"bottom")&&(u+=1,l.bottom=t.bottom),a===e.from.col&&hasOwnProperty(t,"start")&&(u+=1,l.start=t.start),a===e.to.col&&hasOwnProperty(t,"end")&&(u+=1,l.end=t.end),u>0&&(this.hot.setCellMeta(o,a,"borders",denormalizeBorder(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,t){const n=createId(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,s){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=createEmptyBorders(e,t):o=normalizeBorder(o),s?(o[n]=createSingleEmptyBorder(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,n,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))):(o[n]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(o,n,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))}prepareBorder(e,t,n){arrayEach(e,s=>{let{start:o,end:a}=s;if(o.row===a.row&&o.col===a.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":rangeEach(o.col,a.col,l=>{rangeEach(o.row,a.row,u=>{this.removeAllBorders(u,l)})});break;case"top":rangeEach(o.col,a.col,l=>{this.setBorder(o.row,l,t,n)});break;case"bottom":rangeEach(o.col,a.col,l=>{this.setBorder(a.row,l,t,n)});break;case"start":rangeEach(o.row,a.row,l=>{this.setBorder(l,o.col,t,n)});break;case"end":rangeEach(o.row,a.row,l=>{this.setBorder(l,a.col,t,n)});break}})}createCustomBorders(e){arrayEach(e,t=>{const n=normalizeBorder(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,n):this.prepareBorderFromCustomAdded(t.row,t.col,n)})}countHide(e){const{top:t,bottom:n,start:s,end:o}=e;return arrayReduce([t,n,s,o],(l,u)=>{let c=l;return u&&u.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const t=arrayMap(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){arrayEach(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){arrayEach(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=arrayMap(this.savedBorders,n=>n.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):arrayEach(this.savedBorders,(s,o)=>{if(e.id===s.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,n){let s=!1;return arrayEach(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return arrayEach(a,l=>{l.toggleHiddenClass(t,n)}),s=!0,!1}}),s}checkCustomSelections(e,t,n){const s=this.countHide(e);let o=!1;return s===4?(this.removeAllBorders(e.row,e.col),o=!0):arrayEach(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=t,a.commit(),n){const l=this.hot.view._wt.selectionManager.getBorderInstances(a);arrayEach(l,u=>{u.changeBorderStyle(n,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[PLUGIN_KEY$n];if(Array.isArray(e)){const t=deepClone(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=hasLeftRightTypeOptions(e),n=hasStartEndTypeOptions(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _onAfterContextMenuDefaultOptions$3(r){this.hot.getSettings()[PLUGIN_KEY$n]&&r.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top$1(this),right$1(this),bottom$1(this),left$1(this),noBorders(this)]}})}function _onAfterInit$2(){this.changeBorderSettings()}function _classPrivateMethodInitSpec$v(r,e){_checkPrivateRedeclaration$G(r,e),e.add(r)}function _checkPrivateRedeclaration$G(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$O(r,e,t){return(e=_toPropertyKey$O(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$O(r){var e=_toPrimitive$O(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$O(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$G(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$m="dragToScroll",PLUGIN_PRIORITY$l=100;var _DragToScroll_brand=new WeakSet;class DragToScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$v(this,_DragToScroll_brand),_defineProperty$O(this,"boundaries",null),_defineProperty$O(this,"callback",null),_defineProperty$O(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$m}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$l}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$m]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_assertClassBrand$G(_DragToScroll_brand,this,_setupListening).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$G(_DragToScroll_brand,this,_setupListening).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",n=>this.onMouseMove(n)),t=getParentWindow(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function _setupListening(r){if(isRightClick(r))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,n)=>{var s,o;const a=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,l=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(a+Math.sign(t)*50,l+Math.sign(n)*20)}),this.listen()}function _classPrivateMethodInitSpec$u(r,e){_checkPrivateRedeclaration$F(r,e),e.add(r)}function _classPrivateFieldInitSpec$v(r,e,t){_checkPrivateRedeclaration$F(r,e),e.set(r,t)}function _checkPrivateRedeclaration$F(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$N(r,e,t){return(e=_toPropertyKey$N(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$N(r){var e=_toPrimitive$N(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$N(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$v(r,e){return r.get(_assertClassBrand$F(r,e))}function _classPrivateFieldSet$t(r,e,t){return r.set(_assertClassBrand$F(r,e),t),t}function _assertClassBrand$F(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterDropdownMenuDefaultOptions");Hooks.getSingleton().register("beforeDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuHide");Hooks.getSingleton().register("afterDropdownMenuExecute");const PLUGIN_KEY$l="dropdownMenu",PLUGIN_PRIORITY$k=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP$6=PLUGIN_KEY$l;var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet;class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$l}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$k}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$9,KEY$8,KEY$c,KEY$5,KEY$c,KEY$a,KEY$c,KEY$7,KEY$c,KEY$b]}constructor(e){super(e),_classPrivateMethodInitSpec$u(this,_DropdownMenu_brand),_defineProperty$N(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$N(this,"itemsFactory",null),_defineProperty$N(this,"menu",null),_classPrivateFieldInitSpec$v(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$F(_DropdownMenu_brand,this,_onAfterGetColHeader$2).call(this,t,n))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$l]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$F(_DropdownMenu_brand,e,_onBeforeOnCellMouseDown$4).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$F(_DropdownMenu_brand,e,_onBeforeViewportScrollHorizontally$1).call(e,...o)});const t=this.hot.getSettings()[PLUGIN_KEY$l],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>_assertClassBrand$F(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,o)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.executeCommand.call(e,...a)}),arrayEach(s,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),o=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,s.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),l=a.getBoundingClientRect();this.open({left:l.left+o.left,top:l.top+a.offsetHeight+o.top},{left:l.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var n;const s=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP$6},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var n;const s=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$6}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$6)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_assertClassBrand$F(_DropdownMenu_brand,this,_onTableClick).call(this,e))}open(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),objectEach(n,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _addCustomShortcuts(r){r.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(r){if(hasClass$1(r.target,BUTTON_CLASS_NAME)){const e=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),t=r.target.getBoundingClientRect();r.stopPropagation(),_classPrivateFieldSet$t(_isButtonClicked,this,!1),this.open({left:t.left+e.left,top:t.top+r.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function _onAfterGetColHeader$2(r,e){const t=e.parentNode;if(!t)return;const n=t.parentNode.childNodes,s=Array.prototype.indexOf.call(n,t);if(r<0||s!==n.length-1)return;const o=e.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=BUTTON_CLASS_NAME,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(a,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(e,[A11Y_HASPOPUP("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function _onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand$F(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(r){_assertClassBrand$F(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,r)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally$1(r){return _classPrivateFieldGet$v(_isButtonClicked,this)?null:r}function _onBeforeOnCellMouseDown$4(r){hasClass$1(r.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet$t(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY$c};function _defineProperty$M(r,e,t){return(e=_toPropertyKey$M(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$M(r){var e=_toPrimitive$M(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$M(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataProvider{constructor(e){_defineProperty$M(this,"hot",void 0),_defineProperty$M(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:s}=this._getDataRange(),o=this.options,a=[];return rangeEach(e,n,l=>{const u=[];!o.exportHiddenRows&&this._isHiddenRow(l)||(rangeEach(t,s,c=>{!o.exportHiddenColumns&&this._isHiddenColumn(c)||u.push(this.hot.getDataAtCell(l,c))}),a.push(u))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),s=this.hot.getRowHeader();rangeEach(t,n,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(s[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),s=this.hot.getColHeader();rangeEach(t,n,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(s[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,s=0,o=t,a=e]=this.options.range;return n=Math.max(n,0),s=Math.max(s,0),o=Math.min(o,t),a=Math.min(a,e),{startRow:n,startCol:s,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function _defineProperty$L(r,e,t){return(e=_toPropertyKey$L(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$L(r){var e=_toPrimitive$L(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$L(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){_defineProperty$L(this,"dataProvider",void 0),_defineProperty$L(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=clone$1(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=extend$1(clone$1(BaseType.DEFAULT_OPTIONS),t),t=extend$1(t,e),t.filename=substitute(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`;class Csv extends BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const s=n.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let l=e.bom?"\uFEFF":"";return s&&(n=arrayMap(n,u=>this._escapeCell(u,!0)),a&&(l+=e.columnDelimiter),l+=n.join(e.columnDelimiter),l+=e.rowDelimiter),arrayEach(t,(u,c)=>{c>0&&(l+=e.rowDelimiter),a&&(l+=this._escapeCell(o[c])+e.columnDelimiter),l+=u.map(d=>this._escapeCell(d)).join(e.columnDelimiter)}),l}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=stringify$1(e);return n!==""&&(t||n.indexOf(CHAR_CARRIAGE_RETURN)>=0||n.indexOf(CHAR_DOUBLE_QUOTES)>=0||n.indexOf(CHAR_LINE_FEED)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:Csv};function typeFactory(r,e,t){return typeof EXPORT_TYPES[r]=="function"?new EXPORT_TYPES[r](e,t):null}const PLUGIN_KEY$k="exportFile",PLUGIN_PRIORITY$j=240;class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$k}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$j}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:s}=this.hot,o=this._createTypeFormatter(e,t),a=this._createBlob(o),l=s.URL||s.webkitURL,u=n.createElement("a"),c=`${o.options.filename}.${o.options.fileExtension}`;if(u.download!==void 0){const d=l.createObjectURL(a);u.style.display="none",u.setAttribute("href",d),u.setAttribute("download",c),n.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),n.body.removeChild(u),setTimeout(()=>{l.revokeObjectURL(d)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,c)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error(`Export format type "${e}" is not supported.`);return typeFactory(e,new DataProvider(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function _defineProperty$K(r,e,t){return(e=_toPropertyKey$K(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$K(r){var e=_toPrimitive$K(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$K(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseComponent{constructor(e,t){let{id:n,stateless:s=!0}=t;_defineProperty$K(this,"hot",void 0),_defineProperty$K(this,"id",void 0),_defineProperty$K(this,"elements",[]),_defineProperty$K(this,"hidden",!1),_defineProperty$K(this,"stateId",""),_defineProperty$K(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mixin(BaseComponent,localHooks);const conditions={};function getCondition(r,e){if(!conditions[r])throw Error(`Filter condition "${r}" does not exist.`);const{condition:t,descriptor:n}=conditions[r];let s=e;return n.inputValuesDecorator&&(s=n.inputValuesDecorator(s)),function(o){return t.apply(o.meta.instance,[].concat([o],[s]))}}function getConditionDescriptor(r){if(!conditions[r])throw Error(`Filter condition "${r}" does not exist.`);return conditions[r].descriptor}function registerCondition(r,e,t){t.key=r,conditions[r]={condition:e,descriptor:t}}const CONDITION_NAME$k="none";function condition$k(){return!0}registerCondition(CONDITION_NAME$k,condition$k,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const CONDITION_NAME$j="empty";function condition$j(r){return isEmpty$1(r.value)}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$i="not_empty";function condition$i(r,e){return!getCondition(CONDITION_NAME$j,e)(r)}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$h="eq";function condition$h(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale)===stringify$1(t)}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$g="neq";function condition$g(r,e){return!getCondition(CONDITION_NAME$h,e)(r)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$f="gt";function condition$f(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value>n}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$e="gte";function condition$e(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value>=n}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$d="lt";function condition$d(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value<n}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$c="lte";function condition$c(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value<=n}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$b="date_after";function condition$b(r,e){let[t]=e;const n=hooks(r.value,r.meta.dateFormat),s=hooks(t,r.meta.dateFormat);return!n.isValid()||!s.isValid()?!1:n.diff(s)>=0}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});const CONDITION_NAME$a="date_before";function condition$a(r,e){let[t]=e;const n=hooks(r.value,r.meta.dateFormat),s=hooks(t,r.meta.dateFormat);return!n.isValid()||!s.isValid()?!1:n.diff(s)<=0}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const CONDITION_NAME$9="between";function condition$9(r,e){let[t,n]=e,s=t,o=n;if(r.meta.type==="numeric"){const a=parseFloat(s,10),l=parseFloat(o,10);s=Math.min(a,l),o=Math.max(a,l)}else if(r.meta.type==="date"){const a=getCondition(CONDITION_NAME$a,[o]),l=getCondition(CONDITION_NAME$b,[s]);return a(r)&&l(r)}return r.value>=s&&r.value<=o}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$8="not_between";function condition$8(r,e){return!getCondition(CONDITION_NAME$9,e)(r)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$7="begins_with";function condition$7(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).startsWith(stringify$1(t))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$6="ends_with";function condition$6(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).endsWith(stringify$1(t))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$5="contains";function condition$5(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).indexOf(stringify$1(t))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const CONDITION_NAME$4="not_contains";function condition$4(r,e){return!getCondition(CONDITION_NAME$5,e)(r)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});const CONDITION_NAME$3="date_tomorrow";function condition$3(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});const CONDITION_NAME$2="date_today";function condition$2(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});const CONDITION_NAME$1="date_yesterday";function condition$1(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});getComparisonFunction();function toVisualValue(r,e){let t=r;return t===""&&(t=`(${e})`),t}const SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&typeof Array.from=="function";function createArrayAssertion(r){let e=r;return SUPPORT_SET_CONSTRUCTOR&&(e=new Set(e)),function(t){let n;return SUPPORT_SET_CONSTRUCTOR?n=e.has(t):n=!!~e.indexOf(t),n}}function toEmptyString(r){return r??""}function unifyColumnValues(r){let e=r;return SUPPORT_FAST_DEDUPE?e=Array.from(new Set(e)):e=arrayUnique(e),e=e.sort((t,n)=>typeof t=="number"&&typeof n=="number"?t-n:t===n?0:t>n?1:-1),e}function intersectValues(r,e,t,n){const s=[],o=r===e;let a;return o||(a=createArrayAssertion(e)),arrayEach(r,l=>{let u=!1;(o||a(l))&&(u=!0);const c={checked:u,value:l,visualValue:toVisualValue(l,t)};n&&n(c),s.push(c)}),s}const CONDITION_NAME="by_value";function condition(r,e){let[t]=e;return t(r.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator(r){let[e]=r;return[createArrayAssertion(e)]},showOperators:!1});const operations={};function getOperationFunc(r){if(!operations[r])throw Error(`Operation with id "${r}" does not exist.`);const e=operations[r].func;return function(t,n){return e(t,n)}}function getOperationName(r){return operations[r].name}function registerOperation(r,e,t){operations[r]={name:e,func:t}}const OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(r,e){return r.every(t=>t.func(e))}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);const OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(r,e){return r.some(t=>t.func(e))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);const OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(r,e){if(r.length<3)throw Error("Operation doesn't work on less then three conditions.");return r.slice(0,r.length-1).some(t=>t.func(e))&&r[r.length-1].func(e)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$f,CONDITION_NAME$e,CONDITION_NAME$d,CONDITION_NAME$c,CONDITION_NAME$9,CONDITION_NAME$8],[TYPE_TEXT]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$7,CONDITION_NAME$6,KEY$c,CONDITION_NAME$5,CONDITION_NAME$4],[TYPE_DATE]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$a,CONDITION_NAME$b,CONDITION_NAME$9,KEY$c,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]};function getOptionsList(r){const e=[];let t=r;return TYPES[t]||(t=TYPE_TEXT),arrayEach(TYPES[t],n=>{let s;n===KEY$c?s={name:KEY$c}:s=clone$1(getConditionDescriptor(n)),e.push(s)}),e}function _defineProperty$J(r,e,t){return(e=_toPropertyKey$J(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$J(r){var e=_toPrimitive$J(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$J(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];let BaseUI$3=class Ac{static get DEFAULTS(){return clone$1({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){_defineProperty$J(this,"hot",void 0),_defineProperty$J(this,"eventManager",new EventManager(this)),_defineProperty$J(this,"options",void 0),_defineProperty$J(this,"_element",void 0),_defineProperty$J(this,"buildState",void 0),this.hot=e,this.options=extend$1(Ac.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}isBuilt(){return this.buildState===STATE_BUILT$2}translateIfPossible(e){return typeof e=="string"&&e.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,n)=>{this.eventManager.addEventListener(t,n,s=>this.runLocalHooks(n,s,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass$1(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),objectEach(this.options,(n,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(n))}),this._element.appendChild(t),arrayEach(EVENTS_TO_REGISTER,n=>e(t,n))}else arrayEach(EVENTS_TO_REGISTER,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI$3,localHooks);function _classPrivateMethodInitSpec$t(r,e){_checkPrivateRedeclaration$E(r,e),e.add(r)}function _classPrivateFieldInitSpec$u(r,e,t){_checkPrivateRedeclaration$E(r,e),e.set(r,t)}function _checkPrivateRedeclaration$E(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$u(r,e){return r.get(_assertClassBrand$E(r,e))}function _classPrivateFieldSet$s(r,e,t){return r.set(_assertClassBrand$E(r,e),t),t}function _assertClassBrand$E(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _input$1=new WeakMap,_InputUI_brand=new WeakSet;class InputUI extends BaseUI$3{static get DEFAULTS(){return clone$1({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,extend$1(InputUI.DEFAULTS,t)),_classPrivateMethodInitSpec$t(this,_InputUI_brand),_classPrivateFieldInitSpec$u(this,_input$1,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>_assertClassBrand$E(_InputUI_brand,this,_onKeyup).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");_classPrivateFieldSet$s(_input$1,this,this._element.firstChild),addClass$1(this._element,"htUIInput"),addClass$1(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$u(_input$1,this).type=this.options.type,_classPrivateFieldGet$u(_input$1,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet$u(_input$1,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet$u(_input$1,this).focus()}}function _onKeyup(r){this.options.value=r.target.value}function _classPrivateMethodInitSpec$s(r,e){_checkPrivateRedeclaration$D(r,e),e.add(r)}function _classPrivateFieldInitSpec$t(r,e,t){_checkPrivateRedeclaration$D(r,e),e.set(r,t)}function _checkPrivateRedeclaration$D(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$r(r,e,t){return r.set(_assertClassBrand$D(r,e),t),t}function _classPrivateFieldGet$t(r,e){return r.get(_assertClassBrand$D(r,e))}function _assertClassBrand$D(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items$1=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet;class SelectUI extends BaseUI$3{static get DEFAULTS(){return clone$1({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,extend$1(SelectUI.DEFAULTS,t)),_classPrivateMethodInitSpec$s(this,_SelectUI_brand),_classPrivateFieldInitSpec$t(this,_menu,null),_classPrivateFieldInitSpec$t(this,_items$1,[]),_classPrivateFieldInitSpec$t(this,_caption,void 0),_classPrivateFieldInitSpec$t(this,_captionElement,void 0),_classPrivateFieldInitSpec$t(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet$t(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand$D(_SelectUI_brand,this,_onClick).call(this))}setItems(e){_classPrivateFieldSet$r(_items$1,this,this.translateNames(e)),_classPrivateFieldGet$t(_menu,this)&&_classPrivateFieldGet$t(_menu,this).setMenuItems(_classPrivateFieldGet$t(_items$1,this))}translateNames(e){return arrayEach(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),_classPrivateFieldSet$r(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet$t(_menu,this).setMenuItems(_classPrivateFieldGet$t(_items$1,this));const e=new BaseUI$3(this.hot,{className:"htUISelectCaption"}),t=new BaseUI$3(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet$r(_caption,this,e),_classPrivateFieldSet$r(_captionElement,this,e.element),_classPrivateFieldSet$r(_dropdown,this,t),this.hot.getSettings().ariaTags&&(setAttribute(t.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach([e,t],n=>this._element.appendChild(n.element)),_classPrivateFieldGet$t(_menu,this).addLocalHook("select",n=>_assertClassBrand$D(_SelectUI_brand,this,_onMenuSelect).call(this,n)),_classPrivateFieldGet$t(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand$D(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=_classPrivateFieldGet$t(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet$t(_captionElement,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();_classPrivateFieldGet$t(_menu,this)&&(_classPrivateFieldGet$t(_menu,this).open(),_classPrivateFieldGet$t(_menu,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),_classPrivateFieldGet$t(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet$t(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet$t(_menu,this)&&_classPrivateFieldGet$t(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet$t(_menu,this)&&(_classPrivateFieldGet$t(_menu,this).destroy(),_classPrivateFieldSet$r(_menu,this,null)),_classPrivateFieldGet$t(_caption,this)&&_classPrivateFieldGet$t(_caption,this).destroy(),_classPrivateFieldGet$t(_dropdown,this)&&_classPrivateFieldGet$t(_dropdown,this).destroy(),super.destroy()}}function _onMenuSelect(r){r.name!==KEY$c&&(this.options.value=r,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function _classPrivateMethodInitSpec$r(r,e){_checkPrivateRedeclaration$C(r,e),e.add(r)}function _checkPrivateRedeclaration$C(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$I(r,e,t){return(e=_toPropertyKey$I(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$I(r){var e=_toPrimitive$I(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$I(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$C(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet;class ConditionComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$r(this,_ConditionComponent_brand),_defineProperty$I(this,"name",""),_defineProperty$I(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_assertClassBrand$C(_ConditionComponent_brand,this,_onConditionSelect).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),arrayEach(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>_assertClassBrand$C(_ConditionComponent_brand,this,_onInputKeyDown$2).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=clone$1(e.command);t.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),arrayEach(e.args,(n,s)=>{if(s>t.inputsCount-1)return!1;const o=this.getInputElement(s);o.setValue(n),o[t.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$k),t=[];return arrayEach(this.getInputElements(),(n,s)=>{e.inputsCount>s&&t.push(n.getValue())}),{command:e,args:t}}updateState(e,t){const n=getConditionDescriptor(e?e.name:CONDITION_NAME$k);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||arrayEach(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof SelectUI)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,s,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass$1(t.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return addClass$1(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[getConditionDescriptor(CONDITION_NAME$k)];if(e!==null){const{visualIndex:n}=e;t=getOptionsList(this.hot.getDataType(0,n,this.hot.countRows(),n))}arrayEach(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function _onConditionSelect(r){arrayEach(this.getInputElements(),(e,t)=>{e[r.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",r)}function _onInputKeyDown$2(r){isKey(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(r))}function _classPrivateFieldInitSpec$s(r,e,t){_checkPrivateRedeclaration$B(r,e),e.set(r,t)}function _checkPrivateRedeclaration$B(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$s(r,e){return r.get(_assertClassBrand$B(r,e))}function _classPrivateFieldSet$q(r,e,t){return r.set(_assertClassBrand$B(r,e),t),t}function _assertClassBrand$B(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_label=new WeakMap;class RadioInputUI extends BaseUI$3{static get DEFAULTS(){return clone$1({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,extend$1(RadioInputUI.DEFAULTS,t)),_classPrivateFieldInitSpec$s(this,_input,void 0),_classPrivateFieldInitSpec$s(this,_label,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet$q(_label,this,e),_classPrivateFieldSet$q(_input,this,this._element.firstChild),_classPrivateFieldGet$s(_input,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$s(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet$s(_input,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet$s(_input,this).checked=e)}focus(){this.isBuilt()&&_classPrivateFieldGet$s(_input,this).focus()}}function _classPrivateMethodInitSpec$q(r,e){_checkPrivateRedeclaration$A(r,e),e.add(r)}function _checkPrivateRedeclaration$A(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$H(r,e,t){return(e=_toPropertyKey$H(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$H(r){var e=_toPrimitive$H(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$H(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$A(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const SELECTED_AT_START_ELEMENT_INDEX=0;var _OperatorsComponent_brand=new WeakSet;class OperatorsComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$q(this,_OperatorsComponent_brand),_defineProperty$H(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass$1(t.parentNode,"htFiltersMenuOperators"),arrayEach(this.elements,n=>t.appendChild(n.element)),t)}}buildOperatorsElement(){const e=[OPERATION_ID$2,OPERATION_ID$1];arrayEach(e,t=>{const n=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:t,textContent:getOperationName(t)},value:t,checked:t===e[SELECTED_AT_START_ELEMENT_INDEX],id:t});n.addLocalHook("change",s=>_assertClassBrand$A(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,s)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(toSingleLine`Radio button with index ${e} doesn't exist.`);arrayEach(this.elements,(t,n)=>{t.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof RadioInputUI&&t.isChecked());return e?e.getValue():OPERATION_ID$2}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,t=arguments.length>1?arguments[1]:void 0,n=e;n===OPERATION_ID&&(n=OPERATION_ID$1),this.state.setValueAtIndex(t,n)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}}function _onRadioInputChange(r){this.setState(r.target.value)}const COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(r){let e=r+1,t="",n;for(;e>0;)n=(e-1)%COLUMN_LABEL_BASE_LENGTH,t=String.fromCharCode(65+n)+t,e=parseInt((e-n)/COLUMN_LABEL_BASE_LENGTH,10);return t}function dataRowToChangesArray(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=r;const n=[];return(!Array.isArray(r)||!Array.isArray(r[0]))&&(t=[r]),t.forEach((s,o)=>{Array.isArray(s)?s.forEach((a,l)=>{n.push([o+e,l,a])}):Object.keys(s).forEach(a=>{n.push([o+e,a,s[a]])})}),n}function countFirstRowKeys(r){let e=0;return Array.isArray(r)&&(r[0]&&Array.isArray(r[0])?e=r[0].length:r[0]&&isObject$1(r[0])&&(e=deepObjectSize(r[0]))),e}function isArrayOfArrays(r){return!!(Array.isArray(r)&&r.length&&r.every(e=>Array.isArray(e)))}function isArrayOfObjects(r){return!!(Array.isArray(r)&&r.length&&r.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function _classPrivateFieldInitSpec$r(r,e,t){_checkPrivateRedeclaration$z(r,e),e.set(r,t)}function _checkPrivateRedeclaration$z(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$r(r,e){return r.get(_assertClassBrand$z(r,e))}function _classPrivateFieldSet$p(r,e,t){return r.set(_assertClassBrand$z(r,e),t),t}function _assertClassBrand$z(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap;class LinkUI extends BaseUI$3{static get DEFAULTS(){return clone$1({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,extend$1(LinkUI.DEFAULTS,t)),_classPrivateFieldInitSpec$r(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet$p(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet$r(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet$r(_link,this).focus()}activate(){_classPrivateFieldGet$r(_link,this).click()}}function _classPrivateMethodInitSpec$p(r,e){_checkPrivateRedeclaration$y(r,e),e.add(r)}function _classPrivateFieldInitSpec$q(r,e,t){_checkPrivateRedeclaration$y(r,e),e.set(r,t)}function _checkPrivateRedeclaration$y(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$q(r,e){return r.get(_assertClassBrand$y(r,e))}function _classPrivateFieldSet$o(r,e,t){return r.set(_assertClassBrand$y(r,e),t),t}function _assertClassBrand$y(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$5="multipleSelect.itemBox";var _items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet;class MultipleSelectUI extends BaseUI$3{static get DEFAULTS(){return clone$1({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,extend$1(MultipleSelectUI.DEFAULTS,t)),_classPrivateMethodInitSpec$p(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec$q(this,_items,[]),_classPrivateFieldInitSpec$q(this,_itemsBox,void 0),_classPrivateFieldInitSpec$q(this,_locale,void 0),_classPrivateFieldInitSpec$q(this,_searchInput,void 0),_classPrivateFieldInitSpec$q(this,_selectAllUI,void 0),_classPrivateFieldInitSpec$q(this,_clearAllUI,void 0),_classPrivateFieldSet$o(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet$o(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet$o(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet$q(_itemsBox,this)}registerHooks(){_classPrivateFieldGet$q(_searchInput,this).addLocalHook("keydown",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onInputKeyDown$1).call(this,e)),_classPrivateFieldGet$q(_searchInput,this).addLocalHook("input",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onInput).call(this,e)),_classPrivateFieldGet$q(_selectAllUI,this).addLocalHook("click",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,e)),_classPrivateFieldGet$q(_clearAllUI,this).addLocalHook("click",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,e))}setItems(e){var t;_classPrivateFieldSet$o(_items,this,e),(t=_classPrivateFieldGet$q(_itemsBox,this))===null||t===void 0||t.loadData(_classPrivateFieldGet$q(_items,this))}setLocale(e){_classPrivateFieldSet$o(_locale,this,e)}getLocale(){return _classPrivateFieldGet$q(_locale,this)}getItems(){return[..._classPrivateFieldGet$q(_items,this)]}getValue(){return itemsToValue(_classPrivateFieldGet$q(_items,this))}getSearchInputElement(){return _classPrivateFieldGet$q(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet$q(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet$q(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet$q(_items,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new BaseUI$3(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet$q(_selectAllUI,this),_classPrivateFieldGet$q(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet$q(_searchInput,this).element),this._element.appendChild(n.element),this._element.appendChild(t);const s=o=>{var a;if(!this._element)return;(a=_classPrivateFieldGet$q(_itemsBox,this))===null||a===void 0||a.destroy(),addClass$1(o,"htUIMultipleSelectHot"),_classPrivateFieldSet$o(_itemsBox,this,new this.hot.constructor(o,{data:_classPrivateFieldGet$q(_items,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,d,f,C,m,E)=>{c.title=E.instance.getDataAtRowProp(d,E.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet$q(_itemsBox,this).listen()},colWidths:()=>_classPrivateFieldGet$q(_itemsBox,this).container.scrollWidth-getScrollbarWidth(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet$q(_itemsBox,this).init(),this.hot.addHook("afterSetTheme",(c,d)=>{d||_classPrivateFieldGet$q(_itemsBox,this).useTheme(c)});const u=_classPrivateFieldGet$q(_itemsBox,this).getShortcutManager().getContext("grid");u.removeShortcutsByKeys(["Tab"]),u.removeShortcutsByKeys(["Shift","Tab"]),u.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:SHORTCUTS_GROUP$5}),u.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{_classPrivateFieldGet$q(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:SHORTCUTS_GROUP$5})};s(t),this.hot._registerTimeout(()=>s(t),100)}focus(){this.isBuilt()&&_classPrivateFieldGet$q(_itemsBox,this).listen()}reset(){_classPrivateFieldGet$q(_searchInput,this).reset(),_classPrivateFieldGet$q(_selectAllUI,this).reset(),_classPrivateFieldGet$q(_clearAllUI,this).reset()}update(){this.isBuilt()&&(_classPrivateFieldGet$q(_itemsBox,this).loadData(valueToItems(_classPrivateFieldGet$q(_items,this),this.options.value)),super.update())}destroy(){var e;(e=_classPrivateFieldGet$q(_itemsBox,this))===null||e===void 0||e.destroy(),_classPrivateFieldGet$q(_searchInput,this).destroy(),_classPrivateFieldGet$q(_clearAllUI,this).destroy(),_classPrivateFieldGet$q(_selectAllUI,this).destroy(),_classPrivateFieldSet$o(_searchInput,this,null),_classPrivateFieldSet$o(_clearAllUI,this,null),_classPrivateFieldSet$o(_selectAllUI,this,null),_classPrivateFieldSet$o(_itemsBox,this,null),_classPrivateFieldSet$o(_items,this,null),super.destroy()}}function _onInput(r){const e=r.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[..._classPrivateFieldGet$q(_items,this)]:t=_classPrivateFieldGet$q(_items,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),_classPrivateFieldGet$q(_itemsBox,this).loadData(t)}function _onInputKeyDown$1(r){this.runLocalHooks("keydown",r,this),partial(isKey,r.keyCode)("ARROW_DOWN")&&(r.preventDefault(),stopImmediatePropagation(r),_classPrivateFieldGet$q(_itemsBox,this).listen(),_classPrivateFieldGet$q(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(r){const e=[];r.preventDefault(),_classPrivateFieldGet$q(_itemsBox,this).getSourceData().forEach((t,n)=>{t.checked=!0,e.push(dataRowToChangesArray(t,n)[0])}),_classPrivateFieldGet$q(_itemsBox,this).setSourceDataAtCell(e)}function _onClearAllClick(r){const e=[];r.preventDefault(),_classPrivateFieldGet$q(_itemsBox,this).getSourceData().forEach((t,n)=>{t.checked=!1,e.push(dataRowToChangesArray(t,n)[0])}),_classPrivateFieldGet$q(_itemsBox,this).setSourceDataAtCell(e)}function valueToItems(r,e){const t=createArrayAssertion(e);return r.map(n=>(n.checked=t(n.value),n))}function itemsToValue(r){const e=[];return r.forEach(t=>{t.checked&&e.push(t.value)}),e}function _classPrivateMethodInitSpec$o(r,e){_checkPrivateRedeclaration$x(r,e),e.add(r)}function _checkPrivateRedeclaration$x(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$G(r,e,t){return(e=_toPropertyKey$G(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$G(r){var e=_toPrimitive$G(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$G(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$x(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet;class ValueComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$o(this,_ValueComponent_brand),_defineProperty$G(this,"name",""),this.name=t.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_assertClassBrand$x(_ValueComponent_brand,this,_onInputKeyDown).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>_assertClassBrand$x(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===CONDITION_NAME){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?CONDITION_NAME$k:CONDITION_NAME},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(n,s,o,a,l)=>{const[u]=arrayFilter(s,f=>f.name===CONDITION_NAME),c={},d=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(u){const f=a(n,l),C=arrayMap(f,R=>R.value),m=new Map(f.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),E=unifyColumnValues(C);o&&(u.args[0]=o);const v=[],_=intersectValues(E,u.args[0],d,R=>{R.checked&&v.push(R.value),_assertClassBrand$x(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,R,m)}),T=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,T).locale,c.args=[v],c.command=getConditionDescriptor(CONDITION_NAME),c.itemsSnapshot=_}else c.args=[],c.command=getConditionDescriptor(CONDITION_NAME$k);this.state.setValueAtIndex(n,c)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,s,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return addClass$1(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),n=t.map(u=>u.value),s=new Map(t.map(u=>[u.value,u.meta])),o=unifyColumnValues(n),a=intersectValues(o,o,e,u=>{_assertClassBrand$x(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,u,s)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:arrayMap(this.hot.getDataAtCol(e.visualIndex),(t,n)=>({value:toEmptyString(t),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function _onInputKeyDown(r){isKey(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(r))}function _triggerModifyMultipleSelectionValueHook(r,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(r.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",r.visualValue,e.get(r.value)))}function _onModifyDisplayedValue(r,e){switch(e.type){case"numeric":return getRenderedValue(r,e);default:return r}}var _ActionBarComponent;function _classPrivateMethodInitSpec$n(r,e){_checkPrivateRedeclaration$w(r,e),e.add(r)}function _checkPrivateRedeclaration$w(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$F(r,e,t){return(e=_toPropertyKey$F(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$F(r){var e=_toPrimitive$F(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$F(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$w(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet;class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),_classPrivateMethodInitSpec$n(this,_ActionBarComponent_brand),_defineProperty$F(this,"name",""),this.name=t.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach(this.elements,e=>{e.addLocalHook("click",(t,n)=>_assertClassBrand$w(_ActionBarComponent_brand,this,_onButtonClick).call(this,t,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass$1(t.parentNode,"htFiltersMenuActionBar"),arrayEach(this.elements,n=>t.appendChild(n.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_ActionBarComponent=ActionBarComponent;function _onButtonClick(r,e){e.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function _defineProperty$E(r,e,t){return(e=_toPropertyKey$E(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$E(r){var e=_toPrimitive$E(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$E(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const MAP_NAME="ConditionCollection.filteringStates";class ConditionCollection{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty$E(this,"hot",void 0),_defineProperty$E(this,"isMapRegistrable",void 0),_defineProperty$E(this,"filteringStates",new LinkedPhysicalIndexToValueMap),_defineProperty$E(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var n;const s=this.filteringStates.getValueAtIndex(t),o=(n=s==null?void 0:s.conditions)!==null&&n!==void 0?n:[],a=s==null?void 0:s.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return e.length?getOperationFunc(n)(e,t):!0}addCondition(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,s=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=arrayMap(t.args,d=>typeof d=="string"?d.toLocaleLowerCase(o):d),l=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const u=this.getOperation(e);if(u){if(u!==n)throw Error(toSingleLine`The column of index ${e} has been already applied with a \`${u}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined$1(operations[n]))throw new Error(toSingleLine`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:l,args:a,func:getCondition(l,a)}]},s):c.push({name:l,args:a,func:getCondition(l,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return(t=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return arrayReduce(this.filteringStates.getEntries(),(e,t)=>{let[n,{operation:s,conditions:o}]=t;return e.push({column:n,operation:s,conditions:arrayMap(o,a=>{let{name:l,args:u}=a;return{name:l,args:u}})}),e},[])}importAllConditions(e){this.clean(),arrayEach(e,t=>{arrayEach(t.conditions,n=>this.addCondition(t.column,n))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some(s=>s.name===t):n.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}mixin(ConditionCollection,localHooks);function _defineProperty$D(r,e,t){return(e=_toPropertyKey$D(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$D(r){var e=_toPrimitive$D(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$D(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataFilter{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty$D(this,"conditionCollection",void 0),_defineProperty$D(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return arrayEach(this.conditionCollection.getFilteredColumns(),(t,n)=>{let s=this.columnDataFactory(t);n&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return arrayEach(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&n.push(s)}),n}_getIntersectData(e,t){const n=[];return arrayEach(t,s=>{const o=s.meta.visualRow;e[o]!==void 0&&(n[o]=e[o])}),n}}function _classPrivateMethodInitSpec$m(r,e){_checkPrivateRedeclaration$v(r,e),e.add(r)}function _checkPrivateRedeclaration$v(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$C(r,e,t){return(e=_toPropertyKey$C(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$C(r){var e=_toPrimitive$C(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$C(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$v(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet;class ConditionUpdateObserver{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec$m(this,_ConditionUpdateObserver_brand),_defineProperty$C(this,"hot",void 0),_defineProperty$C(this,"conditionCollection",void 0),_defineProperty$C(this,"columnDataFactory",void 0),_defineProperty$C(this,"changes",[]),_defineProperty$C(this,"grouping",!1),_defineProperty$C(this,"latestEditedColumnPosition",-1),_defineProperty$C(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",s=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=s.slice(0,o),l=s.slice(o);l.length&&l[0].column===e&&l.shift();const u=curry(function(d,f){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new ConditionCollection(n.hot,!1),E=[].concat(d,C);m.importAllConditions(E);const v=n.columnDataFactory(f);let _;m.isEmpty()?_=v:_=new DataFilter(m,R=>n.columnDataFactory(R)).filter(),_=arrayMap(_,R=>R.meta.visualRow);const T=createArrayAssertion(_);return m.destroy(),arrayFilter(v,R=>T(R.meta.visualRow))})(a),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),objectEach(this,(e,t)=>{this[t]=null})}}function _onConditionBeforeModify(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach(this.latestOrderStack,r=>{this.updateStatesAtColumn(r)})}mixin(ConditionUpdateObserver,localHooks);function createFocusNavigator(r){return createPaginator({initialPage:0,size:()=>r.length,onItemSelect:(t,n)=>{const s=r[t];if(s instanceof MultipleSelectUI)return n;if(s.element&&!isVisible(s.element))return!1;s.focus()}})}const SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(r,e){let t=-1,n;const s=createFocusNavigator(e),o=f=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),s.setCurrentPage(e.indexOf(f))};e.forEach(f=>{f instanceof BaseUI$3&&(f.addLocalHook("click",o(f)),f.addLocalHook("focus",o(f)),f.addLocalHook("afterClose",o(f)))}),u(r);function a(f){const C=n.getKeyboardShortcutsCtrl(),m=f.getKeyboardShortcutsCtrl();s.clear(),m.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:C.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{f.isSubMenu()&&f.close(),C.listen(SHORTCUTS_MENU_CONTEXT)}}]),!f.isSubMenu()&&C.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:E=>{const v=n.getNavigator();v.getCurrentPage()>-1&&(t=v.getCurrentPage()),v.clear(),E.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:E=>{const v=e[s.getCurrentPage()];v instanceof SelectUI&&(v.openOptions(),E.preventDefault()),v instanceof LinkUI&&(v.activate(),E.preventDefault()),v instanceof BaseUI$3||E.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}function l(){n.focus(),n.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function u(f){f.addLocalHook("afterSelectionChange",C=>{C.key.startsWith("filter_")||s.clear()}),f.addLocalHook("afterSubmenuOpen",a),f.addLocalHook("afterOpen",a),n=f}function c(){return n}function d(){return t}return{...s,listen:l,setMenu:u,getMenu:c,getLastMenuPage:d}}function _classPrivateMethodInitSpec$l(r,e){_checkPrivateRedeclaration$u(r,e),e.add(r)}function _classPrivateFieldInitSpec$p(r,e,t){_checkPrivateRedeclaration$u(r,e),e.set(r,t)}function _checkPrivateRedeclaration$u(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$B(r,e,t){return(e=_toPropertyKey$B(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$B(r){var e=_toPrimitive$B(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$B(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$n(r,e,t){return r.set(_assertClassBrand$u(r,e),t),t}function _classPrivateFieldGet$p(r,e){return r.get(_assertClassBrand$u(r,e))}function _assertClassBrand$u(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$j="filters",PLUGIN_PRIORITY$i=250,SHORTCUTS_GROUP$4=PLUGIN_KEY$j;var _menuFocusNavigator=new WeakMap,_dropdownMenuTraces=new WeakMap,_Filters_brand=new WeakSet;class Filters extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$j}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$i}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),_classPrivateMethodInitSpec$l(this,_Filters_brand),_defineProperty$B(this,"dropdownMenuPlugin",null),_defineProperty$B(this,"conditionCollection",null),_defineProperty$B(this,"conditionUpdateObserver",null),_defineProperty$B(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty$B(this,"filtersRowsMap",null),_classPrivateFieldInitSpec$p(this,_menuFocusNavigator,void 0),_classPrivateFieldInitSpec$p(this,_dropdownMenuTraces,new WeakSet),this.hot.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$u(_Filters_brand,this,_onAfterGetColHeader$1).call(this,t,n))}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$j]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,s=l=>(l.addLocalHook("accept",()=>_assertClassBrand$u(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),l.addLocalHook("cancel",()=>_assertClassBrand$u(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),l.addLocalHook("change",u=>_assertClassBrand$u(_Filters_brand,this,_onComponentChange).call(this,l,u)),l),o=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,a=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const l=new ConditionComponent(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:n});l.addLocalHook("afterClose",()=>_assertClassBrand$u(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",s(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const l=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});l.addLocalHook("afterClose",()=>_assertClassBrand$u(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",s(l))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new ValueComponent(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.hot,this.conditionCollection,l=>this.getDataMapAtColumn(l)),this.conditionUpdateObserver.addLocalHook("update",l=>_assertClassBrand$u(_Filters_brand,this,_updateComponents).call(this,l))),this.components.forEach(l=>l.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return _assertClassBrand$u(_Filters_brand,e,_onAfterDropdownMenuDefaultOptions).call(e,...u)}),this.addHook("beforeDropdownMenuShow",()=>_assertClassBrand$u(_Filters_brand,this,_onBeforeDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand$u(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand$u(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",l=>_assertClassBrand$u(_Filters_brand,this,_onAfterChange$1).call(this,l)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet$p(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const l=[{focus:()=>{const c=_classPrivateFieldGet$p(_menuFocusNavigator,this).getMenu(),d=c.getNavigator(),f=_classPrivateFieldGet$p(_menuFocusNavigator,this).getLastMenuPage();c.focus(),f>0?d.setCurrentPage(f):d.toFirstItem()}},...Array.from(this.components).map(c=>{let[,d]=c;return d.getElements()}).flat()];_classPrivateFieldSet$n(_menuFocusNavigator,this,createMenuFocusController(this.dropdownMenuPlugin.menu,l));const u=c=>{_classPrivateFieldGet$p(_menuFocusNavigator,this).listen(),c.preventDefault(),isKey(c.keyCode,"TAB")&&(c.shiftKey?_classPrivateFieldGet$p(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet$p(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",u),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",u)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,n)=>{t.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:SHORTCUTS_GROUP$4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$4)}addCondition(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},s)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let s=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack)!==!1)if(n){const l=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=arrayMap(t.filter(),c=>c.meta.visualRow);const u=createArrayAssertion(s);rangeEach(this.hot.countSourceRows()-1,c=>{u(c)||l.push(c)}),arrayEach(l,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!s.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return arrayEach(this.hot.getSourceDataAtCol(t),(s,o)=>{var a;const{row:l,col:u,visualCol:c,visualRow:d,type:f,instance:C,dateFormat:m,locale:E}=this.hot.getCellMeta(o,t),v=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&a!==void 0?a:s;n.push({meta:{row:l,col:u,visualCol:c,visualRow:d,type:f,instance:C,dateFormat:m,locale:E},value:toEmptyString(v)})}),n}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),n=unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var t;const n=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,s){let o=e;return o===OPERATION_ID$1&&t.command.key!==CONDITION_NAME$k&&n.command.key!==CONDITION_NAME$k&&s.command.key!==CONDITION_NAME$k?o=OPERATION_ID:s.command.key!==CONDITION_NAME$k&&(t.command.key===CONDITION_NAME$k||n.command.key===CONDITION_NAME$k)&&(o=OPERATION_ID$2),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new DataFilter(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return arrayEach(s,a=>{arrayEach(t.menuItems,(l,u)=>{l.key===a.getMenuItemDescriptor().key&&e.push(u)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,s=n.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];const u=this.getIndexesOfComponents(...a);e?s.showRows(u):s.hideRows(u),n.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function _onAfterChange$1(r){r&&arrayEach(r,e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function _onAfterDropdownMenuShow(){const r=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),r.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onBeforeDropdownMenuShow(){const r=this.dropdownMenuPlugin.menu;_classPrivateFieldGet$p(_dropdownMenuTraces,this).has(r)||_classPrivateFieldGet$p(_menuFocusNavigator,this).setMenu(r),_classPrivateFieldGet$p(_dropdownMenuTraces,this).add(r)}function _onAfterDropdownMenuDefaultOptions(r){r.items.push({name:KEY$c}),this.components.forEach(e=>{r.items.push(e.getMenuItemDescriptor())})}function _onActionBarSubmit(r){var e;if(r==="accept"){const n=this.getSelectedColumn();if(n===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:s}=n,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,l);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(s);c===-1&&(c=void 0),this.conditionCollection.removeConditions(s),o.command.key!==CONDITION_NAME$k&&(this.conditionCollection.addCondition(s,o,u,c),a.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(s,a,u,c)),l.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(s,l,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(d=>d.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function _onComponentChange(r,e){const t=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),r.constructor===ConditionComponent&&!e.inputsCount&&this.setListeningDropdownMenu(),t.updateMenuDimensions()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader$1(r,e){const t=this.hot.toPhysicalColumn(r);this.enabled&&this.conditionCollection.hasConditions(t)?addClass$1(e,"htFiltersActive"):removeClass$1(e,"htFiltersActive")}function _updateComponents(r){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:n}}=r,s=t.filter(a=>a.name===CONDITION_NAME),o=t.filter(a=>a.name!==CONDITION_NAME);if(s.length>=2||o.length>=3)warn$1(toSingleLine`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(r)}}const DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(r){var e;return{maxColumns:r.maxColumns,maxRows:r.maxRows,language:(e=r[PLUGIN_KEY$i])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function cleanEngineSettings(r){return Object.keys(r).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=r[t]),e),{})}function getEngineSettingsWithDefaultsAndOverrides(r){var e;const t=r[PLUGIN_KEY$i],n=cleanEngineSettings(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=getEngineSettingsOverrides(r);return{...DEFAULT_SETTINGS,...n,...s}}function getEngineSettingsWithOverrides(r){var e;const t=r[PLUGIN_KEY$i],n=cleanEngineSettings(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=getEngineSettingsOverrides(r);return{...n,...s}}function haveEngineSettingsChanged(r,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==r[t])}function getEngineRelationshipRegistry(){const r="engine_relationship",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(r)||e.register(r,new Map),e.getItem(r)}function getSharedEngineUsageRegistry(){const r="shared_engine_usage",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(r)||e.register(r,new Map),e.getItem(r)}function setupEngine(r){const e=r.getSettings(),t=e[PLUGIN_KEY$i],n=t==null?void 0:t.engine;if(t===!0||isUndefined$1(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var s;return registerEngine((s=n.hyperformula)!==null&&s!==void 0?s:n,e,r)}else if(typeof n=="object"&&isUndefined$1(n.hyperformula)){const o=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(r),a&&a.push(r.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(n.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(n.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn$1(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function registerEngine(r,e,t){const n=e[PLUGIN_KEY$i],s=getEngineSettingsWithDefaultsAndOverrides(e),o=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry();registerCustomFunctions(r,n.functions),registerLanguage(r,n.language);const l=r.buildEmpty(s);return o.set(l,[t]),a.set(l,[t.guid]),registerNamedExpressions(l,n.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function getRegisteredHotInstances(r){var e;const t=getEngineRelationshipRegistry(),n=t.size===0?[]:Array.from((e=t.get(r))!==null&&e!==void 0?e:[]);return new Map(n.map(s=>[s.getPlugin("formulas").sheetId,s]))}function unregisterEngine(r,e){if(r){const t=getEngineRelationshipRegistry(),n=t.get(r),s=getSharedEngineUsageRegistry(),o=s.get(r);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&t.delete(r)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(s.delete(r),r.destroy()))}}function registerCustomFunctions(r,e){e&&e.forEach(t=>{const{name:n,plugin:s,translations:o}=t;try{r.registerFunction(n,s,o)}catch(a){warn$1(a.message)}})}function registerLanguage(r,e){if(e){const{langCode:t}=e;try{r.registerLanguage(t,e)}catch(n){warn$1(n.message)}}}function registerNamedExpressions(r,e){e&&(r.suspendEvaluation(),e.forEach(t=>{const{name:n,expression:s,scope:o,options:a}=t;try{r.addNamedExpression(n,s,o,a)}catch(l){warn$1(l.message)}}),r.resumeEvaluation())}function setupSheet(r,e){return(isUndefined$1(e)||!r.doesSheetExist(e))&&(e=r.addSheet(e)),e}const DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(r){return typeof r=="string"&&r.charAt(0)==="'"&&r.charAt(1)==="="}function unescapeFormulaExpression(r){return isEscapedFormulaExpression(r)?r.substr(1):r}function isFormula$1(r){return typeof r=="string"&&r.startsWith("=")}function isDate(r,e){return typeof r=="string"&&e==="date"}function isDateValid(r,e){return hooks(r,e,!0).isValid()}function getDateInHfFormat(r,e){return hooks(r,e,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(r,e){return hooks(r,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(e)}function getDateFromExcelDate(r,e){const n=new Date(Date.UTC(0,0,r+-1));return hooks(n).format(e)}function getMoveLine(r,e,t){const n=Array.from(Array(t).keys()).filter(o=>r.includes(o)===!1);if(e===0){var s;return(s=n[e])!==null&&s!==void 0?s:0}return n[e-1]+1}function getInitiallyCalculatedMoves(r,e){const t=[];return r.forEach(n=>{const s={from:n,to:e};t.forEach(o=>{const a=o.from>o.to,l=o.to<=s.from;o.from>s.from&&l&&a&&(s.from+=1)}),s.from>=e&&(e+=1),t.push(s)}),t}function adjustedCalculatedMoves(r){return r.forEach((e,t)=>{r.slice(t+1).forEach(s=>{const o=s.from<s.to;s.from>e.from&&o&&(s.from-=1)})}),r}function getMoves(r,e,t){const n=getInitiallyCalculatedMoves(r,getMoveLine(r,e,t));return adjustedCalculatedMoves(n)}function _classPrivateFieldInitSpec$o(r,e,t){_checkPrivateRedeclaration$t(r,e),e.set(r,t)}function _checkPrivateRedeclaration$t(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$o(r,e){return r.get(_assertClassBrand$t(r,e))}function _classPrivateFieldSet$m(r,e,t){return r.set(_assertClassBrand$t(r,e),t),t}function _assertClassBrand$t(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap;class AxisSyncer{constructor(e,t,n){_classPrivateFieldInitSpec$o(this,_axis,void 0),_classPrivateFieldInitSpec$o(this,_indexMapper,void 0),_classPrivateFieldInitSpec$o(this,_indexSyncer,void 0),_classPrivateFieldInitSpec$o(this,_indexesSequence,[]),_classPrivateFieldInitSpec$o(this,_movedIndexes,[]),_classPrivateFieldInitSpec$o(this,_finalIndex,void 0),_classPrivateFieldInitSpec$o(this,_removedIndexes,[]),_classPrivateFieldSet$m(_axis,this,e),_classPrivateFieldSet$m(_indexMapper,this,t),_classPrivateFieldSet$m(_indexSyncer,this,n)}setRemovedHfIndexes(e){return _classPrivateFieldSet$m(_removedIndexes,this,e.map(t=>{const n=_classPrivateFieldGet$o(_indexMapper,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(n)})),_classPrivateFieldGet$o(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet$o(_removedIndexes,this)}getHfIndexFromVisualIndex(e){const t=_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence(),n=_classPrivateFieldGet$o(_indexMapper,this).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const n=`move${toUpperCaseFirst(_classPrivateFieldGet$o(_axis,this))}s`;_classPrivateFieldGet$o(_indexSyncer,this).getEngine().batch(()=>{e.forEach(s=>{const o=s.from!==s.to,a=s.from+1!==s.to;o&&a&&_classPrivateFieldGet$o(_indexSyncer,this).getEngine()[n](_classPrivateFieldGet$o(_indexSyncer,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,n){n!==!1&&(_classPrivateFieldSet$m(_movedIndexes,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),_classPrivateFieldSet$m(_finalIndex,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(_classPrivateFieldGet$o(_indexSyncer,this).isPerformingUndoRedo()||e===!1||t===!1)return;const n=getMoves(_classPrivateFieldGet$o(_movedIndexes,this),_classPrivateFieldGet$o(_finalIndex,this),_classPrivateFieldGet$o(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet$o(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet$o(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${toUpperCaseFirst(_classPrivateFieldGet$o(_axis,this))}Order`;return t=>{if(_classPrivateFieldGet$o(_indexSyncer,this).isPerformingUndoRedo())return;const n=_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence();if(t==="update"&&n.length>0){const s=_classPrivateFieldGet$o(_indexesSequence,this).map(u=>n.indexOf(u)),o=_classPrivateFieldGet$o(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet$o(_indexSyncer,this).getSheetId());let a;_classPrivateFieldGet$o(_axis,this)==="row"?a=o.height:a=o.width;const l=s.length;for(let u=l;u<a;u+=1)s.push(u);_classPrivateFieldGet$o(_indexSyncer,this).getEngine()[e](_classPrivateFieldGet$o(_indexSyncer,this).getSheetId(),s)}_classPrivateFieldSet$m(_indexesSequence,this,n)}}init(){_classPrivateFieldSet$m(_indexesSequence,this,_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence())}}function _classPrivateFieldInitSpec$n(r,e,t){_checkPrivateRedeclaration$s(r,e),e.set(r,t)}function _checkPrivateRedeclaration$s(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$n(r,e){return r.get(_assertClassBrand$s(r,e))}function _classPrivateFieldSet$l(r,e,t){return r.set(_assertClassBrand$s(r,e),t),t}function _assertClassBrand$s(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap;class IndexSyncer{constructor(e,t,n){_classPrivateFieldInitSpec$n(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec$n(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec$n(this,_postponeAction,void 0),_classPrivateFieldInitSpec$n(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec$n(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec$n(this,_engine,null),_classPrivateFieldInitSpec$n(this,_sheetId,null),_classPrivateFieldSet$l(_rowIndexSyncer,this,new AxisSyncer("row",e,this)),_classPrivateFieldSet$l(_columnIndexSyncer,this,new AxisSyncer("column",t,this)),_classPrivateFieldSet$l(_postponeAction,this,n)}getForAxis(e){return e==="row"?_classPrivateFieldGet$n(_rowIndexSyncer,this):_classPrivateFieldGet$n(_columnIndexSyncer,this)}setPerformUndo(e){_classPrivateFieldSet$l(_isPerformingUndo,this,e)}setPerformRedo(e){_classPrivateFieldSet$l(_isPerformingRedo,this,e)}isPerformingUndoRedo(){return _classPrivateFieldGet$n(_isPerformingUndo,this)||_classPrivateFieldGet$n(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet$n(_sheetId,this)}getEngine(){return _classPrivateFieldGet$n(_engine,this)}getPostponeAction(){return _classPrivateFieldGet$n(_postponeAction,this)}setupSyncEndpoint(e,t){_classPrivateFieldSet$l(_engine,this,e),_classPrivateFieldSet$l(_sheetId,this,t),_classPrivateFieldGet$n(_rowIndexSyncer,this).init(),_classPrivateFieldGet$n(_columnIndexSyncer,this).init()}}function _classPrivateMethodInitSpec$k(r,e){_checkPrivateRedeclaration$r(r,e),e.add(r)}function _defineProperty$A(r,e,t){return(e=_toPropertyKey$A(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$A(r){var e=_toPrimitive$A(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$A(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldInitSpec$m(r,e,t){_checkPrivateRedeclaration$r(r,e),e.set(r,t)}function _checkPrivateRedeclaration$r(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$k(r,e,t){return r.set(_assertClassBrand$r(r,e),t),t}function _classPrivateFieldGet$m(r,e){return r.get(_assertClassBrand$r(r,e))}function _assertClassBrand$r(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$i="formulas",SETTING_KEYS=["maxRows","maxColumns","language"],PLUGIN_PRIORITY$h=260;Hooks.getSingleton().register("afterNamedExpressionAdded");Hooks.getSingleton().register("afterNamedExpressionRemoved");Hooks.getSingleton().register("afterSheetAdded");Hooks.getSingleton().register("afterSheetRemoved");Hooks.getSingleton().register("afterSheetRenamed");Hooks.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=r=>r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto";var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet;class Formulas extends BasePlugin{constructor(){var e;super(...arguments),e=this,_classPrivateMethodInitSpec$k(this,_Formulas_brand),_classPrivateFieldInitSpec$m(this,_internalOperationPending,!1),_classPrivateFieldInitSpec$m(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec$m(this,_engineListeners,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineValuesUpdated).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineNamedExpressionsAdded).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineNamedExpressionsRemoved).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetAdded).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetRenamed).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetRemoved).call(e,...n)}]]),_defineProperty$A(this,"staticRegister",staticRegister("formulas")),_defineProperty$A(this,"engine",null),_defineProperty$A(this,"sheetName",null),_defineProperty$A(this,"indexSyncer",null),_defineProperty$A(this,"rowAxisSyncer",null),_defineProperty$A(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$i}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$h}static get SETTING_KEYS(){return[PLUGIN_KEY$i,...SETTING_KEYS]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$i]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=setupEngine(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){warn$1("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...s)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterLoadData$3).call(t,...s)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...s)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterLoadData$3).call(t,...s)}),this.addHook("modifyData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onModifyData).call(t,...s)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onModifySourceData).call(t,...s)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeValidate).call(t,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetSourceDataAtCell).call(t,...s)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...s)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeCreateRow).call(t,...s)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeCreateCol).call(t,...s)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCreateRow$2).call(t,...s)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCreateCol$1).call(t,...s)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeRemoveRow$1).call(t,...s)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeRemoveCol).call(t,...s)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterRemoveRow$2).call(t,...s)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterRemoveCol$1).call(t,...s)}),this.indexSyncer=new IndexSyncer(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,s,o,a)=>{this.rowAxisSyncer.storeMovesInformation(n,s,a)}),this.hot.addHook("beforeColumnMove",(n,s,o,a)=>{this.columnAxisSyncer.storeMovesInformation(n,s,a)}),this.hot.addHook("afterRowMove",(n,s,o,a,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("afterColumnMove",(n,s,o,a,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("beforeColumnFreeze",(n,s)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(n,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(n,s)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(n,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCellMetaReset).call(t,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterDetachChild$1).call(t,...s)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeAutofill).call(t,...s)}),_classPrivateFieldGet$m(_engineListeners,this).forEach(n=>{let[s,o]=n;return this.engine.on(s,o)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet$m(_engineListeners,this).forEach(e=>{let[t,n]=e;return this.engine.off(t,n)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[PLUGIN_KEY$i];if(isDefined(n)&&isDefined(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[PLUGIN_KEY$i].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){_classPrivateFieldGet$m(_engineListeners,this).forEach(e=>{var t;let[n,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(n,s)}),_classPrivateFieldSet$k(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(isDefined(t)&&!isArrayOfArrays(t))return warn$1("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return warn$1("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(n){return warn$1(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){error(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${toUpperCaseFirst(PLUGIN_KEY$i)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return s!==null&&o!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(s=>{var o;const a=s==null||(o=s.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(n.has(a)||n.add(a))}),getRegisteredHotInstances(this.engine).forEach((s,o)=>{if((t||o!==this.sheetId)&&n.has(o)){var a;s.render(),(a=s.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=o=>{var a;const{row:l,col:u,sheet:c}=(a=o==null?void 0:o.address)!==null&&a!==void 0?a:{};return isDefined(c)?`${c}:${l}x${u}`:""},s=new Set(t.map(o=>n(o)));e.forEach(o=>{var a,l;const{row:u,col:c}=(a=o.address)!==null&&a!==void 0?a:{};if(isDefined(u)===!1||isDefined(c)===!1||u>=this.hot.countRows()||c>=this.hot.countCols())return;const d=o==null||(l=o.address)===null||l===void 0?void 0:l.sheet,f=n(o);if(d!==void 0&&!s.has(f)){const C=getRegisteredHotInstances(this.engine).get(d);if(!C)return;C.validateCell(C.getDataAtCell(u,c),C.getCellMeta(u,c),()=>{})}})}syncChangeWithEngine(e,t,n){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){warn$1(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const o=this.hot.getCellMeta(e,t);return isDate(n,o.type)&&(isDateValid(n,o.dateFormat)?n=getDateInHfFormat(n,o.dateFormat):isFormula$1(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(s,n)}}function _onBeforeValidate(r,e,t){const n=this.hot.propToCol(t);if(this.isFormulaCellType(e,n)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let a=this.engine.getCellValue(s);return o.type==="date"&&isNumeric(a)&&(a=getDateFromExcelDate(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return r}function _onBeforeAutofill(r,e,t){const{row:n,col:s}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),{row:l,col:u}=t.getTopStartCorner(),{row:c,col:d}=t.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(C)===!1)return!1;const m=this.engine.getFillRangeData(f,C),{row:E,col:v}=f.start,{row:_,col:T}=f.end,R=_-E+1,O=T-v+1;for(let N=0;N<m.length;N+=1)for(let G=0;G<m[N].length;G+=1){const D=m[N][G],k=E+N%R,z=v+G%O,ne=this.hot.getCellMeta(k,z);isDate(D,ne.type)&&(D.startsWith("'")?m[N][G]=D.slice(1):this.isFormulaCellType(k,z,this.sheetId)===!1&&(m[N][G]=getDateInHotFormat(D,ne.dateFormat)))}return m}function _onBeforeLoadData$1(r,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$i))||_classPrivateFieldSet$k(_hotWasInitializedWithEmptyData,this,isUndefined$1(this.hot.getSettings().data))}function _onAfterCellMetaReset(){const r=this.hot.getSourceDataArray();let e=!1;r.forEach((t,n)=>{t.forEach((s,o)=>{const a=this.hot.getCellMeta(n,o),l=a.dateFormat;isDate(s,a.type)&&(e=!0,isDateValid(s,l)?r[n][o]=getDateInHfFormat(s,l):this.isFormulaCellType(n,o)===!1&&(r[n][o]=`'${s}`))})}),e===!0&&(_classPrivateFieldSet$k(_internalOperationPending,this,!0),this.engine.setSheetContent(this.sheetId,r),_classPrivateFieldSet$k(_internalOperationPending,this,!1))}function _onAfterLoadData$3(r,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$i)))if(this.sheetName=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$i].sheetName),_classPrivateFieldGet$m(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){_classPrivateFieldSet$k(_internalOperationPending,this,!0);const s=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),_classPrivateFieldSet$k(_internalOperationPending,this,!1)}}}function _onModifyData(r,e,t,n){if(n!=="get"||_classPrivateFieldGet$m(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(r);if(s===null||e===null)return;if(!this.isFormulaCellType(s,e)&&this.getCellType(s,e)!=="ARRAY"){isEscapedFormulaExpression(t.value)&&(t.value=unescapeFormulaExpression(t.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(a),u=this.hot.getCellsMeta().find(d=>d.visualRow===s&&d.visualCol===e);u===void 0&&(u={}),u.type==="date"&&isNumeric(l)&&(l=getDateFromExcelDate(l,u.dateFormat));const c=typeof l=="object"&&l!==null?l.value:l;t.value=c}function _onModifySourceData(r,e,t,n){if(n!=="get"||_classPrivateFieldGet$m(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(r),o=this.hot.propToCol(e);if(s===null||o===null||!this.isFormulaCellType(s,o)&&this.getCellType(s,o)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};t.value=this.engine.getCellSerialized(u)}function _onAfterSetDataAtCell(r,e){if(isBlockedSource(e))return;const t=[],n=[],s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,,u]=o;const c=this.hot.propToCol(l),d=this.hot.toPhysicalRow(a),f=this.hot.toPhysicalColumn(c),C={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};d!==null&&f!==null?this.syncChangeWithEngine(a,c,u):t.push([a,c,u]),n.push({address:C})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{t.forEach(a=>{let[l,u,c]=a;this.syncChangeWithEngine(l,u,c)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,n)}function _onAfterSetSourceDataAtCell(r,e){if(isBlockedSource(e))return;const t=[],n=[];r.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a);if(!isNumeric(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){warn$1(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),t.push(...this.engine.setCellContents(c,l))}),this.renderDependentSheets(t),this.validateDependentCells(t,n)}function _onBeforeCreateRow(r,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countRows()&&(t=r),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function _onBeforeCreateCol(r,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countCols()&&(t=r),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function _onBeforeRemoveRow$1(r,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function _onBeforeRemoveCol(r,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function _onAfterCreateRow$2(r,e,t){if(isBlockedSource(t))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(r),e]);this.renderDependentSheets(n)}function _onAfterCreateCol$1(r,e,t){if(isBlockedSource(t))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(r),e]);this.renderDependentSheets(n)}function _onAfterRemoveRow$2(r,e,t,n){if(isBlockedSource(n))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,l)=>l-a),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function _onAfterRemoveCol$1(r,e,t,n){if(isBlockedSource(n))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,l)=>l-a),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function _onAfterDetachChild$1(r,e,t){var n;_classPrivateFieldSet$k(_internalOperationPending,this,!0);const s=this.hot.getSourceDataArray(t,0,t+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$k(_internalOperationPending,this,!1),s.forEach((o,a)=>{o.forEach((l,u)=>{this.engine.setCellContents({col:u,row:t+a,sheet:this.sheetId},[[l]])})})}function _onEngineValuesUpdated(r){this.hot.runHooks("afterFormulasValuesUpdate",r)}function _onEngineNamedExpressionsAdded(r,e){this.hot.runHooks("afterNamedExpressionAdded",r,e)}function _onEngineNamedExpressionsRemoved(r,e){this.hot.runHooks("afterNamedExpressionRemoved",r,e)}function _onEngineSheetAdded(r){this.hot.runHooks("afterSheetAdded",r)}function _onEngineSheetRenamed(r,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",r,e)}function _onEngineSheetRemoved(r,e){this.hot.runHooks("afterSheetRemoved",r,e)}function hideColumnItem(r){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,s]=e;n-s!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),o=[];for(let u=n;u<=s;u+=1)o.push(u);r.hideColumns(o);const a=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function showColumnItem(r){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback(){var t,n;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&n!==void 0?n:this.countCols()-1,r.showColumns(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countCols()||this.selectColumns(s,o)},disabled:!1,hidden(){const t=arrayMap(r.getHiddenColumns(),f=>this.toPhysicalColumn(f));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().col,o=n.getBottomEndCorner().col,a=this.columnIndexMapper,l=a.getRenderableFromVisualIndex(s),u=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),d=[];if(s!==o){const f=o-s+1,C=u-l+1;if(f>C){const m=c.slice(s,o+1);d.push(...m.filter(E=>t.includes(E)))}}else if(l===0&&l<s)d.push(...c.slice(0,s));else if(l===null)d.push(...c.slice(0,this.countCols()));else{const f=this.countCols()-1,C=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));u===C&&f>o&&d.push(...c.slice(o+1))}return arrayEach(d,f=>{e.push(this.toVisualColumn(f))}),e.length===0}}}function _classPrivateMethodInitSpec$j(r,e){_checkPrivateRedeclaration$q(r,e),e.add(r)}function _classPrivateFieldInitSpec$l(r,e,t){_checkPrivateRedeclaration$q(r,e),e.set(r,t)}function _checkPrivateRedeclaration$q(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$l(r,e){return r.get(_assertClassBrand$q(r,e))}function _classPrivateFieldSet$j(r,e,t){return r.set(_assertClassBrand$q(r,e),t),t}function _assertClassBrand$q(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideColumns");Hooks.getSingleton().register("afterHideColumns");Hooks.getSingleton().register("beforeUnhideColumns");Hooks.getSingleton().register("afterUnhideColumns");const PLUGIN_KEY$h="hiddenColumns",PLUGIN_PRIORITY$g=310;var _hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet;class HiddenColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$j(this,_HiddenColumns_brand),_classPrivateFieldInitSpec$l(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$h}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$g}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$h]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$j(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet$l(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand$q(_HiddenColumns_brand,this,_onMapInit$4).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$l(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$q(_HiddenColumns_brand,e,_onAfterContextMenuDefaultOptions$2).call(e,...n)}),this.addHook("afterGetCellMeta",(t,n,s)=>_assertClassBrand$q(_HiddenColumns_brand,this,_onAfterGetCellMeta$2).call(this,t,n,s)),this.addHook("modifyColWidth",(t,n)=>_assertClassBrand$q(_HiddenColumns_brand,this,_onModifyColWidth$3).call(this,t,n),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$q(_HiddenColumns_brand,e,_onAfterGetColHeader).call(e,...n)}),this.addHook("modifyCopyableRange",t=>_assertClassBrand$q(_HiddenColumns_brand,this,_onModifyCopyableRange$1).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let s=t;const o=_classPrivateFieldGet$l(_hiddenColumnsMap,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalColumn(c));arrayEach(u,c=>{o[c]=!1}),s=arrayReduce(o,(c,d,f)=>(d&&c.push(this.hot.toVisualColumn(f)),c),[])}this.hot.runHooks("beforeUnhideColumns",t,s,n&&a)!==!1&&(n&&a&&_classPrivateFieldGet$l(_hiddenColumnsMap,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,n&&a,n&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet$l(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,n,n&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return arrayMap(_classPrivateFieldGet$l(_hiddenColumnsMap,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _classPrivateFieldGet$l(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){_classPrivateFieldSet$j(_hiddenColumnsMap,this,null),super.destroy()}}function _onModifyColWidth$3(r,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof r=="number"&&this.hot.hasColHeaders())return r+15}function _onAfterGetCellMeta$2(r,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const n=t.className.split(" ");if(n.length>0){const s=n.indexOf("afterHiddenColumn");s>-1&&n.splice(s,1),t.className=n.join(" ")}}}function _onModifyCopyableRange$1(r){if(this.getSetting("copyPasteEnabled"))return r;const e=[],t=(n,s,o,a)=>{e.push({startRow:n,endRow:s,startCol:o,endCol:a})};return arrayEach(r,n=>{let s=!0,o=0;rangeEach(n.startCol,n.endCol,a=>{this.isHidden(a)?(s||t(n.startRow,n.endRow,o,a-1),s=!0):(s&&(o=a),a===n.endCol&&t(n.startRow,n.endRow,o,a),s=!1)})}),e}function _onAfterGetColHeader(r,e){if(!this.getSetting("indicators")||r<0)return;const t=[];r>=1&&this.isHidden(r-1)&&t.push("afterHiddenColumn"),r<this.hot.countCols()-1&&this.isHidden(r+1)&&t.push("beforeHiddenColumn"),addClass$1(e,t)}function _onAfterContextMenuDefaultOptions$2(r){r.items.push({name:KEY$c},hideColumnItem(this),showColumnItem(this))}function _onMapInit$4(){const r=this.getSetting("columns");Array.isArray(r)&&this.hideColumns(r)}function hideRowItem(r){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,s]=e;n-s!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),o=[];for(let u=n;u<=s;u+=1)o.push(u);r.hideRows(o);const a=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function showRowItem(r){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var t,n;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&n!==void 0?n:this.countRows()-1,r.showRows(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countRows()||this.selectRows(s,o)},disabled:!1,hidden(){const t=arrayMap(r.getHiddenRows(),f=>this.toPhysicalRow(f));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().row,o=n.getBottomEndCorner().row,a=this.rowIndexMapper,l=a.getRenderableFromVisualIndex(s),u=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),d=[];if(s!==o){const f=o-s+1,C=u-l+1;if(f>C){const m=c.slice(s,o+1);d.push(...m.filter(E=>t.includes(E)))}}else if(l===0&&l<s)d.push(...c.slice(0,s));else if(l===null)d.push(...c.slice(0,this.countRows()));else{const f=this.countRows()-1,C=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));u===C&&f>o&&d.push(...c.slice(o+1))}return arrayEach(d,f=>{e.push(this.toVisualRow(f))}),e.length===0}}}function _classPrivateMethodInitSpec$i(r,e){_checkPrivateRedeclaration$p(r,e),e.add(r)}function _classPrivateFieldInitSpec$k(r,e,t){_checkPrivateRedeclaration$p(r,e),e.set(r,t)}function _checkPrivateRedeclaration$p(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$k(r,e){return r.get(_assertClassBrand$p(r,e))}function _classPrivateFieldSet$i(r,e,t){return r.set(_assertClassBrand$p(r,e),t),t}function _assertClassBrand$p(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideRows");Hooks.getSingleton().register("afterHideRows");Hooks.getSingleton().register("beforeUnhideRows");Hooks.getSingleton().register("afterUnhideRows");const PLUGIN_KEY$g="hiddenRows",PLUGIN_PRIORITY$f=320;var _hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet;class HiddenRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$i(this,_HiddenRows_brand),_classPrivateFieldInitSpec$k(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$g}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$f}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$g]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$i(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet$k(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand$p(_HiddenRows_brand,this,_onMapInit$3).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$k(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$p(_HiddenRows_brand,e,_onAfterContextMenuDefaultOptions$1).call(e,...n)}),this.addHook("afterGetCellMeta",(t,n,s)=>_assertClassBrand$p(_HiddenRows_brand,this,_onAfterGetCellMeta$1).call(this,t,n,s)),this.addHook("modifyRowHeight",(t,n)=>_assertClassBrand$p(_HiddenRows_brand,this,_onModifyRowHeight$1).call(this,t,n)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$p(_HiddenRows_brand,e,_onAfterGetRowHeader$1).call(e,...n)}),this.addHook("modifyCopyableRange",t=>_assertClassBrand$p(_HiddenRows_brand,this,_onModifyCopyableRange).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let s=t;const o=_classPrivateFieldGet$k(_hiddenRowsMap,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalRow(c));arrayEach(u,c=>{o[c]=!1}),s=arrayReduce(o,(c,d,f)=>(d&&c.push(this.hot.toVisualRow(f)),c),[])}this.hot.runHooks("beforeUnhideRows",t,s,n&&a)!==!1&&(n&&a&&_classPrivateFieldGet$k(_hiddenRowsMap,this).setValues(o),this.hot.runHooks("afterUnhideRows",t,s,n&&a,n&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet$k(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,n,n&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return arrayMap(_classPrivateFieldGet$k(_hiddenRowsMap,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _classPrivateFieldGet$k(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_classPrivateFieldSet$i(_hiddenRowsMap,this,null),super.destroy()}}function _onModifyRowHeight$1(r,e){return this.isHidden(e)?0:r}function _onAfterGetCellMeta$1(r,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(r)&&(t.skipRowOnPaste=!0),this.isHidden(r-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const n=t.className.split(" ");if(n.length>0){const s=n.indexOf("afterHiddenRow");s>-1&&n.splice(s,1),t.className=n.join(" ")}}}function _onModifyCopyableRange(r){if(this.getSetting("copyPasteEnabled"))return r;const e=[],t=(n,s,o,a)=>{e.push({startRow:n,endRow:s,startCol:o,endCol:a})};return arrayEach(r,n=>{let s=!0,o=0;rangeEach(n.startRow,n.endRow,a=>{this.isHidden(a)?(s||t(o,a-1,n.startCol,n.endCol),s=!0):(s&&(o=a),a===n.endRow&&t(o,a,n.startCol,n.endCol),s=!1)})}),e}function _onAfterGetRowHeader$1(r,e){if(!this.getSetting("indicators")||r<0)return;const t=[];r>=1&&this.isHidden(r-1)&&t.push("afterHiddenRow"),r<this.hot.countRows()-1&&this.isHidden(r+1)&&t.push("beforeHiddenRow"),addClass$1(e,t)}function _onAfterContextMenuDefaultOptions$1(r){r.items.push({name:KEY$c},hideRowItem(this),showRowItem(this))}function _onMapInit$3(){const r=this.getSetting("rows");Array.isArray(r)&&this.hideRows(r)}function freezeColumnItem(r){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,t){const[{start:{col:n}}]=t;r.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function unfreezeColumnItem(r){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){const[{start:{col:n}}]=t;r.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function _classPrivateMethodInitSpec$h(r,e){_checkPrivateRedeclaration$o(r,e),e.add(r)}function _classPrivateFieldInitSpec$j(r,e,t){_checkPrivateRedeclaration$o(r,e),e.set(r,t)}function _checkPrivateRedeclaration$o(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$j(r,e){return r.get(_assertClassBrand$o(r,e))}function _classPrivateFieldSet$h(r,e,t){return r.set(_assertClassBrand$o(r,e),t),t}function _assertClassBrand$o(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnFreeze");Hooks.getSingleton().register("afterColumnFreeze");Hooks.getSingleton().register("beforeColumnUnfreeze");Hooks.getSingleton().register("afterColumnUnfreeze");const PLUGIN_KEY$f="manualColumnFreeze",PLUGIN_PRIORITY$e=110;var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet;class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$h(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec$j(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$f}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$e}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$f]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$o(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>_assertClassBrand$o(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,e,t)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet$h(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;_classPrivateFieldGet$j(_afterFirstUse,this)||_classPrivateFieldSet$h(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;_classPrivateFieldGet$j(_afterFirstUse,this)||_classPrivateFieldSet$h(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function _addContextMenuEntry(r){r.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(r,e){if(_classPrivateFieldGet$j(_afterFirstUse,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||r.some(n=>n<t))return!1}}function _defineProperty$z(r,e,t){return(e=_toPropertyKey$z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$z(r){var e=_toPrimitive$z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px";let BaseUI$2=class{constructor(e){_defineProperty$z(this,"hot",void 0),_defineProperty$z(this,"_element",null),_defineProperty$z(this,"state",STATE_INITIALIZED$1),_defineProperty$z(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED$1}build(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}isAppended(){return this.state===STATE_APPENDED$1}isBuilt(){return this.state>=STATE_BUILT$1}setPosition(e,t){isNumeric(e)&&(this._element.style.top=e+UNIT$1),isNumeric(t)&&(this._element.style[this.inlineProperty]=t+UNIT$1)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){isNumeric(e)&&(this._element.style.width=e+UNIT$1),isNumeric(t)&&(this._element.style.height=t+UNIT$1)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){isNumeric(e)&&(this._element.style.marginTop=e+UNIT$1),isNumeric(t)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=t+UNIT$1)}getOffset(){const e=this._element.style,t=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const CSS_CLASSNAME$3="ht__manualColumnMove--backlight";let BacklightUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$3)}};const CSS_CLASSNAME$2="ht__manualColumnMove--guideline";let GuidelineUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$2)}};function _classPrivateMethodInitSpec$g(r,e){_checkPrivateRedeclaration$n(r,e),e.add(r)}function _classPrivateFieldInitSpec$i(r,e,t){_checkPrivateRedeclaration$n(r,e),e.set(r,t)}function _checkPrivateRedeclaration$n(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$g(r,e,t){return r.set(_assertClassBrand$n(r,e),t),t}function _classPrivateFieldGet$i(r,e){return r.get(_assertClassBrand$n(r,e))}function _assertClassBrand$n(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnMove");Hooks.getSingleton().register("afterColumnMove");const PLUGIN_KEY$e="manualColumnMove",PLUGIN_PRIORITY$d=120,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns";var _backlight$1=new WeakMap,_guideline$1=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed$3=new WeakMap,_target$1=new WeakMap,_cachedDropIndex$1=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet;class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$g(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec$i(this,_backlight$1,new BacklightUI$1(this.hot)),_classPrivateFieldInitSpec$i(this,_guideline$1,new GuidelineUI$1(this.hot)),_classPrivateFieldInitSpec$i(this,_columnsToMove,[]),_classPrivateFieldInitSpec$i(this,_countCols,0),_classPrivateFieldInitSpec$i(this,_pressed$3,!1),_classPrivateFieldInitSpec$i(this,_target$1,{}),_classPrivateFieldInitSpec$i(this,_cachedDropIndex$1,void 0),_classPrivateFieldInitSpec$i(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec$i(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec$i(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec$i(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$e}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$d}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$e]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onBeforeOnCellMouseDown$3).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onBeforeOnCellMouseOver$2).call(e,...n)}),this.addHook("afterScrollVertically",()=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onAfterLoadData$2).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),_classPrivateFieldGet$i(_backlight$1,this).destroy(),_classPrivateFieldGet$i(_guideline$1,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=_classPrivateFieldGet$i(_cachedDropIndex$1,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,n,s);if(_classPrivateFieldSet$g(_cachedDropIndex$1,this,void 0),o===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=s&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,s,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return _classPrivateFieldSet$g(_cachedDropIndex$1,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>n,o=t<0,a=e.some(u=>u<0),l=e.some(u=>u>=n);return!(s||o||a||l)}isColumnOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}countFinalIndex(e,t){const n=arrayReduce(e,(s,o)=>(o<t&&(s+=1),s),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let s=0;for(let o=e;o<=t;o+=1){const a=n.getRenderableFromVisualIndex(o);o<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$e];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return rangeEach(e,t,s=>{n.push(s)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet$i(_hoveredColumn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet$i(_hoveredColumn,this)-1);const a=t.hider.offsetWidth,l=t.TBODY.offsetLeft,u=_classPrivateFieldGet$i(_backlight$1,this).getOffset().start,c=_classPrivateFieldGet$i(_backlight$1,this).getSize().width;let d=0,f=0;if(this.hot.isRtl()){const E=this.hot.rootWindow,v=outerWidth(this.hot.rootElement),_=E.innerWidth-_classPrivateFieldGet$i(_rootElementOffset,this)-v;f=E.innerWidth-_classPrivateFieldGet$i(_target$1,this).eventPageX-_-(n.scrollX===void 0?s:0)}else f=_classPrivateFieldGet$i(_target$1,this).eventPageX-(_classPrivateFieldGet$i(_rootElementOffset,this)-(n.scrollX===void 0?s:0));if(_classPrivateFieldGet$i(_hasRowHeaders,this)&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet$i(_hoveredColumn,this))&&(o+=s),o+=d,_classPrivateFieldGet$i(_hoveredColumn,this)<0)_classPrivateFieldGet$i(_fixedColumnsStart,this)>0?_classPrivateFieldGet$i(_target$1,this).col=0:_classPrivateFieldGet$i(_target$1,this).col=e>0?e-1:e;else if(_classPrivateFieldGet$i(_target$1,this).TD.offsetWidth/2+o<=f){const E=_classPrivateFieldGet$i(_hoveredColumn,this)>=_classPrivateFieldGet$i(_countCols,this)?_classPrivateFieldGet$i(_countCols,this)-1:_classPrivateFieldGet$i(_hoveredColumn,this);_classPrivateFieldGet$i(_target$1,this).col=E+1,o+=_classPrivateFieldGet$i(_target$1,this).TD.offsetWidth}else _classPrivateFieldGet$i(_target$1,this).col=_classPrivateFieldGet$i(_hoveredColumn,this);let C=f,m=o;f+c+u>=a?C=a-c-u:f+u<l+d&&(C=l+d+Math.abs(u)),o>=a-1?m=a-1:m===0?m=1:n.scrollX!==void 0&&_classPrivateFieldGet$i(_hoveredColumn,this)<_classPrivateFieldGet$i(_fixedColumnsStart,this)&&(m-=_classPrivateFieldGet$i(_rootElementOffset,this)<=n.scrollX?_classPrivateFieldGet$i(_rootElementOffset,this):0),_classPrivateFieldGet$i(_backlight$1,this).setPosition(null,C),_classPrivateFieldGet$i(_guideline$1,this).setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onMouseMove$3).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onMouseUp$3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$i(_backlight$1,this).build(),_classPrivateFieldGet$i(_guideline$1,this).build()}destroy(){_classPrivateFieldGet$i(_backlight$1,this).destroy(),_classPrivateFieldGet$i(_guideline$1,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$3(r,e,t,n){const s=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=hasClass$1(r.target,"sortAction");if(!a||!o||_classPrivateFieldGet$i(_pressed$3,this)||r.button!==0||l){_classPrivateFieldSet$g(_pressed$3,this,!1),_classPrivateFieldGet$i(_columnsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}const u=_classPrivateFieldGet$i(_guideline$1,this).isBuilt()&&!_classPrivateFieldGet$i(_guideline$1,this).isAppended(),c=_classPrivateFieldGet$i(_backlight$1,this).isBuilt()&&!_classPrivateFieldGet$i(_backlight$1,this).isAppended();u&&c&&(_classPrivateFieldGet$i(_guideline$1,this).appendTo(s.hider),_classPrivateFieldGet$i(_backlight$1,this).appendTo(s.hider));const{from:d,to:f}=a,C=Math.min(d.col,f.col),m=Math.max(d.col,f.col);if(e.row<0&&e.col>=C&&e.col<=m){n.column=!0,_classPrivateFieldSet$g(_pressed$3,this,!0);const E=t.firstChild?offsetRelativeTo(r,t.firstChild).x:r.offsetX;_classPrivateFieldGet$i(_target$1,this).eventPageX=r.pageX,_classPrivateFieldSet$g(_hoveredColumn,this,e.col),_classPrivateFieldGet$i(_target$1,this).TD=t,_classPrivateFieldGet$i(_target$1,this).col=e.col,_classPrivateFieldSet$g(_columnsToMove,this,this.prepareColumnsToMoving(C,m)),_classPrivateFieldSet$g(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet$g(_countCols,this,this.hot.countCols()),_classPrivateFieldSet$g(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet$g(_rootElementOffset,this,offset$2(this.hot.rootElement).left);const v=_classPrivateFieldGet$i(_hasRowHeaders,this)?-1:0,_=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,T=e.col<_classPrivateFieldGet$i(_fixedColumnsStart,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(E-(this.hot.isRtl()?t.offsetWidth:0)),N=this.getColumnsWidth(C,e.col-1)+O,G=this.getColumnsWidth(v,C-1)+(T?R:0)+N;_classPrivateFieldGet$i(_backlight$1,this).setPosition(_,G),_classPrivateFieldGet$i(_backlight$1,this).setSize(this.getColumnsWidth(C,m),s.hider.offsetHeight-_),_classPrivateFieldGet$i(_backlight$1,this).setOffset(null,-N),addClass$1(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),_classPrivateFieldSet$g(_pressed$3,this,!1),_classPrivateFieldGet$i(_columnsToMove,this).length=0}function _onMouseMove$3(r){_classPrivateFieldGet$i(_pressed$3,this)&&(_classPrivateFieldGet$i(_target$1,this).eventPageX=r.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver$2(r,e,t,n){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$i(_pressed$3,this)||(_classPrivateFieldGet$i(_columnsToMove,this).indexOf(e.col)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI$1):addClass$1(this.hot.rootElement,CSS_SHOW_UI$1),n.row=!0,n.column=!0,n.cell=!0,_classPrivateFieldSet$g(_hoveredColumn,this,e.col),_classPrivateFieldGet$i(_target$1,this).TD=t)}function _onMouseUp$3(){const r=_classPrivateFieldGet$i(_target$1,this).col,e=_classPrivateFieldGet$i(_columnsToMove,this).length;if(_classPrivateFieldSet$g(_hoveredColumn,this,void 0),_classPrivateFieldSet$g(_pressed$3,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),e<1||r===void 0)return;const t=_classPrivateFieldGet$i(_columnsToMove,this)[0],n=this.hot.toPhysicalColumn(t),s=this.dragColumns(_classPrivateFieldGet$i(_columnsToMove,this),r);if(_classPrivateFieldGet$i(_columnsToMove,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(n),a=o+e-1;this.hot.selectColumns(o,a)}}function _onAfterScrollVertically(){const r=this.hot.view._wt.wtTable,e=r.getColumnHeaderHeight(0)+1,t=r.holder.scrollTop,n=e+t;_classPrivateFieldGet$i(_backlight$1,this).setPosition(n),_classPrivateFieldGet$i(_backlight$1,this).setSize(null,r.hider.offsetHeight-n)}function _onAfterLoadData$2(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$f(r,e){_checkPrivateRedeclaration$m(r,e),e.add(r)}function _classPrivateFieldInitSpec$h(r,e,t){_checkPrivateRedeclaration$m(r,e),e.set(r,t)}function _checkPrivateRedeclaration$m(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$f(r,e,t){return r.set(_assertClassBrand$m(r,e),t),t}function _classPrivateFieldGet$h(r,e){return r.get(_assertClassBrand$m(r,e))}function _assertClassBrand$m(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$d="manualColumnResize",PLUGIN_PRIORITY$c=130,PERSISTENT_STATE_KEY$1="manualColumnWidths";var _currentTH$1=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize$1=new WeakMap,_startY$1=new WeakMap,_startWidth=new WeakMap,_startOffset$1=new WeakMap,_handle$1=new WeakMap,_guide$1=new WeakMap,_pressed$2=new WeakMap,_isTriggeredByRMB$1=new WeakMap,_dblclick$1=new WeakMap,_autoresizeTimeout$1=new WeakMap,_columnWidthsMap=new WeakMap,_config$1=new WeakMap,_ManualColumnResize_brand=new WeakSet;class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$d}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$c}constructor(e){super(e),_classPrivateMethodInitSpec$f(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec$h(this,_currentTH$1,null),_classPrivateFieldInitSpec$h(this,_currentCol,null),_classPrivateFieldInitSpec$h(this,_selectedCols,[]),_classPrivateFieldInitSpec$h(this,_currentWidth,null),_classPrivateFieldInitSpec$h(this,_newSize$1,null),_classPrivateFieldInitSpec$h(this,_startY$1,null),_classPrivateFieldInitSpec$h(this,_startWidth,null),_classPrivateFieldInitSpec$h(this,_startOffset$1,null),_classPrivateFieldInitSpec$h(this,_handle$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$h(this,_guide$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$h(this,_pressed$2,null),_classPrivateFieldInitSpec$h(this,_isTriggeredByRMB$1,!1),_classPrivateFieldInitSpec$h(this,_dblclick$1,0),_classPrivateFieldInitSpec$h(this,_autoresizeTimeout$1,null),_classPrivateFieldInitSpec$h(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec$h(this,_config$1,void 0),addClass$1(_classPrivateFieldGet$h(_handle$1,this),"manualColumnResizer"),addClass$1(_classPrivateFieldGet$h(_guide$1,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$d]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$f(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$h(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMapInit$2).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$h(_columnWidthsMap,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onModifyColWidth$2).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onBeforeStretchingColumnWidth).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onBeforeColumnResize).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$f(_config$1,this,_classPrivateFieldGet$h(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,_classPrivateFieldGet$h(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,e),e.value}setManualSize(e,t){const n=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return _classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(s,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;_classPrivateFieldSet$f(_currentTH$1,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(_classPrivateFieldGet$h(_currentTH$1,this)),s=n.col;if(s<0)return;const o=outerHeight(_classPrivateFieldGet$h(_currentTH$1,this)),a=_classPrivateFieldGet$h(_currentTH$1,this).getBoundingClientRect(),l=s<t.getSetting("fixedColumnsStart");let u;l&&(u=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$h(_currentTH$1,this),n.row,n.col)),u||(u=t.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet$h(_currentTH$1,this),n.row,n.col)),_classPrivateFieldSet$f(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),_classPrivateFieldSet$f(_selectedCols,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();arrayEach(d,f=>{const C=f.getTopStartCorner().col,m=f.getBottomEndCorner().col;rangeEach(C,m,E=>{_classPrivateFieldGet$h(_selectedCols,this).includes(E)||_classPrivateFieldGet$h(_selectedCols,this).push(E)})})}_classPrivateFieldGet$h(_selectedCols,this).includes(_classPrivateFieldGet$h(_currentCol,this))||_classPrivateFieldSet$f(_selectedCols,this,[_classPrivateFieldGet$h(_currentCol,this)]),_classPrivateFieldSet$f(_startOffset$1,this,u.start-6),_classPrivateFieldSet$f(_startWidth,this,parseInt(a.width,10)),_classPrivateFieldGet$h(_handle$1,this).style.top=`${u.top}px`,_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$h(_startOffset$1,this)+_classPrivateFieldGet$h(_startWidth,this)}px`,_classPrivateFieldGet$h(_handle$1,this).style.height=`${o}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$h(_handle$1,this))}refreshHandlePosition(){_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$h(_startOffset$1,this)+_classPrivateFieldGet$h(_currentWidth,this)}px`}setupGuidePosition(){const e=parseInt(outerHeight(_classPrivateFieldGet$h(_handle$1,this)),10),t=parseInt(_classPrivateFieldGet$h(_handle$1,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass$1(_classPrivateFieldGet$h(_handle$1,this),"active"),addClass$1(_classPrivateFieldGet$h(_guide$1,this),"active"),_classPrivateFieldGet$h(_guide$1,this).style.top=`${t}px`,this.refreshGuidePosition(),_classPrivateFieldGet$h(_guide$1,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$h(_guide$1,this))}refreshGuidePosition(){_classPrivateFieldGet$h(_guide$1,this).style[this.inlineDir]=_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$h(_handle$1,this),"active"),removeClass$1(_classPrivateFieldGet$h(_guide$1,this),"active")}checkIfColumnHeader(e){const t=closest(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(n,s)=>{const o=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$h(_newSize$1,this),n,!0);o!==void 0&&_classPrivateFieldSet$f(_newSize$1,this,o),this.setManualSize(n,_classPrivateFieldGet$h(_newSize$1,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$h(_newSize$1,this),n,!0),s&&e()};_classPrivateFieldGet$h(_dblclick$1,this)>=2&&(_classPrivateFieldGet$h(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$h(_selectedCols,this),s=>{t(s)}),e()):arrayEach(_classPrivateFieldGet$h(_selectedCols,this),s=>{t(s,!0)})),_classPrivateFieldSet$f(_dblclick$1,this,0),_classPrivateFieldSet$f(_autoresizeTimeout$1,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseOver$1).call(this,n)),this.eventManager.addEventListener(t,"mousedown",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseDown$1).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseMove$2).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseUp$2).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$h(_handle$1,this),"contextmenu",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onContextMenu$1).call(this))}destroy(){super.destroy()}}function _onMapInit$2(){const r=this.hot.getSettings()[PLUGIN_KEY$d],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0):Array.isArray(r)?(this.hot.batchExecution(()=>{r.forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0),_classPrivateFieldSet$f(_config$1,this,r)):r===!0&&Array.isArray(_classPrivateFieldGet$h(_config$1,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet$h(_config$1,this).forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0)}function _onMouseOver$1(r){if(!isDetached(r.target)&&_classPrivateFieldGet$h(_isTriggeredByRMB$1,this)!==!0&&this.checkIfColumnHeader(r.target)){const e=this.getClosestTHParent(r.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(_classPrivateFieldGet$h(_pressed$2,this)||this.setupHandlePosition(e))}}function _onMouseDown$1(r){r.target.parentNode===this.hot.rootElement&&hasClass$1(r.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$h(_currentTH$1,this)),this.setupGuidePosition(),_classPrivateFieldSet$f(_pressed$2,this,!0),_classPrivateFieldGet$h(_autoresizeTimeout$1,this)===null&&(_classPrivateFieldSet$f(_autoresizeTimeout$1,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$h(_autoresizeTimeout$1,this))),_classPrivateFieldSet$f(_dblclick$1,this,_classPrivateFieldGet$h(_dblclick$1,this)+1),this.startX=r.pageX,_classPrivateFieldSet$f(_newSize$1,this,_classPrivateFieldGet$h(_startWidth,this)))}function _onMouseMove$2(r){if(_classPrivateFieldGet$h(_pressed$2,this)){const e=(r.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet$f(_currentWidth,this,_classPrivateFieldGet$h(_startWidth,this)+e),arrayEach(_classPrivateFieldGet$h(_selectedCols,this),t=>{_classPrivateFieldSet$f(_newSize$1,this,this.setManualSize(t,_classPrivateFieldGet$h(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp$2(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,n)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$h(_newSize$1,this),t,!1),n&&r(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$h(_newSize$1,this),t,!1)};_classPrivateFieldGet$h(_pressed$2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$f(_pressed$2,this,!1),_classPrivateFieldGet$h(_newSize$1,this)!==_classPrivateFieldGet$h(_startWidth,this)&&(_classPrivateFieldGet$h(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$h(_selectedCols,this),n=>{e(n)}),r()):arrayEach(_classPrivateFieldGet$h(_selectedCols,this),n=>{e(n,!0)})),this.setupHandlePosition(_classPrivateFieldGet$h(_currentTH$1,this)))}function _onContextMenu$1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$h(_handle$1,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$h(_guide$1,this)),_classPrivateFieldSet$f(_pressed$2,this,!1),_classPrivateFieldSet$f(_isTriggeredByRMB$1,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$f(_isTriggeredByRMB$1,this,!1)})}function _onModifyColWidth$2(r,e){let t=r;if(this.enabled){const n=this.hot.toPhysicalColumn(e),s=_classPrivateFieldGet$h(_columnWidthsMap,this).getValueAtIndex(n);this.hot.getSettings()[PLUGIN_KEY$d]&&s&&(t=s)}return t}function _onBeforeStretchingColumnWidth(r,e){const t=_classPrivateFieldGet$h(_columnWidthsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof t=="number"?t:r}function _onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function _defineProperty$y(r,e,t){return(e=_toPropertyKey$y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$y(r){var e=_toPrimitive$y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px";let BaseUI$1=class{constructor(e){_defineProperty$y(this,"hot",void 0),_defineProperty$y(this,"_element",null),_defineProperty$y(this,"state",STATE_INITIALIZED),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT}setPosition(e,t){e!==void 0&&(this._element.style.top=e+UNIT),t!==void 0&&(this._element.style.left=t+UNIT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+UNIT),t&&(this._element.style.height=t+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+UNIT),t&&(this._element.style.marginLeft=t+UNIT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const CSS_CLASSNAME$1="ht__manualRowMove--backlight";class BacklightUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$1)}}const CSS_CLASSNAME="ht__manualRowMove--guideline";class GuidelineUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME)}}function _classPrivateMethodInitSpec$e(r,e){_checkPrivateRedeclaration$l(r,e),e.add(r)}function _classPrivateFieldInitSpec$g(r,e,t){_checkPrivateRedeclaration$l(r,e),e.set(r,t)}function _checkPrivateRedeclaration$l(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$e(r,e,t){return r.set(_assertClassBrand$l(r,e),t),t}function _classPrivateFieldGet$g(r,e){return r.get(_assertClassBrand$l(r,e))}function _assertClassBrand$l(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeRowMove");Hooks.getSingleton().register("afterRowMove");const PLUGIN_KEY$c="manualRowMove",PLUGIN_PRIORITY$b=140,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows";var _backlight=new WeakMap,_guideline=new WeakMap,_rowsToMove=new WeakMap,_pressed$1=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet;class ManualRowMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$e(this,_ManualRowMove_brand),_classPrivateFieldInitSpec$g(this,_backlight,new BacklightUI(this.hot)),_classPrivateFieldInitSpec$g(this,_guideline,new GuidelineUI(this.hot)),_classPrivateFieldInitSpec$g(this,_rowsToMove,[]),_classPrivateFieldInitSpec$g(this,_pressed$1,void 0),_classPrivateFieldInitSpec$g(this,_target,{}),_classPrivateFieldInitSpec$g(this,_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$c}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$b}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$c]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onBeforeOnCellMouseDown$2).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onBeforeOnCellMouseOver$1).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand$l(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onAfterLoadData$1).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet$g(_backlight,this).destroy(),_classPrivateFieldGet$g(_guideline,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=_classPrivateFieldGet$g(_cachedDropIndex,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,n,s);if(_classPrivateFieldSet$e(_cachedDropIndex,this,void 0),o===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=s&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,s,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return _classPrivateFieldSet$e(_cachedDropIndex,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>n,o=t<0,a=e.some(u=>u<0),l=e.some(u=>u>=n);return!(s||o||a||l)}isRowOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}countFinalIndex(e,t){const n=arrayReduce(e,(s,o)=>(o<t&&(s+=1),s),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let s=0;for(let o=e;o<=t;o++){const a=n.getRenderableFromVisualIndex(o);a!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$c];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:s}=e,o=Math.min(n.row,s.row),a=Math.max(n.row,s.row);return rangeEach(o,a,l=>{t.push(l)}),t}refreshPositions(){const e=_classPrivateFieldGet$g(_target,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=_classPrivateFieldGet$g(_target,this).TD,l=this.hot.rootElement,u=offset$2(l),c=getTrimmingContainer(l),d=o.holder.scrollTop,f=this.hot.rootWindow!==c?c.scrollTop:0,C=u.top-f,m=_classPrivateFieldGet$g(_target,this).eventPageY-C+d,E=o.hider.offsetHeight,v=o.TBODY.offsetTop,_=_classPrivateFieldGet$g(_backlight,this).getOffset().top,T=_classPrivateFieldGet$g(_backlight,this).getSize().height,R=a.offsetHeight/2,O=a.offsetHeight;let N=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const G=m>=N+R;this.isFixedRowTop(e.row)&&(N+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_classPrivateFieldGet$g(_target,this).row=t>0?t-1:t:G?(_classPrivateFieldGet$g(_target,this).row=e.row+1,N+=e.row===0?O-1:O):_classPrivateFieldGet$g(_target,this).row=e.row;let D=m,k=N;m+T+_>=E?D=E-T-_:m+_<v&&(D=v+Math.abs(_)),N>=E-1&&(k=E-1),_classPrivateFieldGet$g(_backlight,this).setPosition(D),_classPrivateFieldGet$g(_guideline,this).setPosition(k)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$l(_ManualRowMove_brand,this,_onMouseMove$1).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$l(_ManualRowMove_brand,this,_onMouseUp$1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$g(_backlight,this).build(),_classPrivateFieldGet$g(_guideline,this).build()}destroy(){_classPrivateFieldGet$g(_backlight,this).destroy(),_classPrivateFieldGet$g(_guideline,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$2(r,e,t,n){const{wtTable:s,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!a||_classPrivateFieldGet$g(_pressed$1,this)||r.button!==0){_classPrivateFieldSet$e(_pressed$1,this,!1),_classPrivateFieldGet$g(_rowsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const u=_classPrivateFieldGet$g(_guideline,this).isBuilt()&&!_classPrivateFieldGet$g(_guideline,this).isAppended(),c=_classPrivateFieldGet$g(_backlight,this).isBuilt()&&!_classPrivateFieldGet$g(_backlight,this).isAppended();u&&c&&(_classPrivateFieldGet$g(_guideline,this).appendTo(s.hider),_classPrivateFieldGet$g(_backlight,this).appendTo(s.hider));const{from:d,to:f}=l,C=Math.min(d.row,f.row),m=Math.max(d.row,f.row);if(e.col<0&&e.row>=C&&e.row<=m){n.row=!0,_classPrivateFieldSet$e(_pressed$1,this,!0),_classPrivateFieldGet$g(_target,this).eventPageY=r.pageY,_classPrivateFieldGet$g(_target,this).coords=e,_classPrivateFieldGet$g(_target,this).TD=t,_classPrivateFieldSet$e(_rowsToMove,this,this.prepareRowsToMoving());const E=s.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(C,e.row-1)+r.offsetY;_classPrivateFieldGet$g(_backlight,this).setPosition(null,E),_classPrivateFieldGet$g(_backlight,this).setSize(s.hider.offsetWidth-E,this.getRowsHeight(C,m)),_classPrivateFieldGet$g(_backlight,this).setOffset(-v,null),addClass$1(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet$e(_pressed$1,this,!1),_classPrivateFieldGet$g(_rowsToMove,this).length=0}function _onMouseMove$1(r){_classPrivateFieldGet$g(_pressed$1,this)&&(_classPrivateFieldGet$g(_target,this).eventPageY=r.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver$1(r,e,t,n){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$g(_pressed$1,this)||(_classPrivateFieldGet$g(_rowsToMove,this).indexOf(e.row)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI):addClass$1(this.hot.rootElement,CSS_SHOW_UI),n.row=!0,n.column=!0,n.cell=!0,_classPrivateFieldGet$g(_target,this).coords=e,_classPrivateFieldGet$g(_target,this).TD=t)}function _onMouseUp$1(){const r=_classPrivateFieldGet$g(_target,this).row,e=_classPrivateFieldGet$g(_rowsToMove,this).length;if(_classPrivateFieldSet$e(_pressed$1,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),e<1||r===void 0)return;const t=_classPrivateFieldGet$g(_rowsToMove,this)[0],n=this.hot.toPhysicalRow(t),s=this.dragRows(_classPrivateFieldGet$g(_rowsToMove,this),r);if(_classPrivateFieldGet$g(_rowsToMove,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(n),a=o+e-1;this.hot.selectRows(o,a)}}function _onAfterScrollHorizontally(){const r=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=r.holder.scrollLeft,n=e+t;_classPrivateFieldGet$g(_backlight,this).setPosition(null,n),_classPrivateFieldGet$g(_backlight,this).setSize(r.hider.offsetWidth-n)}function _onAfterLoadData$1(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$d(r,e){_checkPrivateRedeclaration$k(r,e),e.add(r)}function _classPrivateFieldInitSpec$f(r,e,t){_checkPrivateRedeclaration$k(r,e),e.set(r,t)}function _checkPrivateRedeclaration$k(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$d(r,e,t){return r.set(_assertClassBrand$k(r,e),t),t}function _classPrivateFieldGet$f(r,e){return r.get(_assertClassBrand$k(r,e))}function _assertClassBrand$k(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$b="manualRowResize",PLUGIN_PRIORITY$a=30,PERSISTENT_STATE_KEY="manualRowHeights";var _currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startHeight=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,_config=new WeakMap,_ManualRowResize_brand=new WeakSet;class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$b}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$a}constructor(e){super(e),_classPrivateMethodInitSpec$d(this,_ManualRowResize_brand),_classPrivateFieldInitSpec$f(this,_currentTH,null),_classPrivateFieldInitSpec$f(this,_currentRow,null),_classPrivateFieldInitSpec$f(this,_selectedRows,[]),_classPrivateFieldInitSpec$f(this,_currentHeight,null),_classPrivateFieldInitSpec$f(this,_newSize,null),_classPrivateFieldInitSpec$f(this,_startY,null),_classPrivateFieldInitSpec$f(this,_startHeight,null),_classPrivateFieldInitSpec$f(this,_startOffset,null),_classPrivateFieldInitSpec$f(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$f(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$f(this,_pressed,!1),_classPrivateFieldInitSpec$f(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec$f(this,_dblclick,0),_classPrivateFieldInitSpec$f(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec$f(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec$f(this,_config,void 0),addClass$1(_classPrivateFieldGet$f(_handle,this),"manualRowResizer"),addClass$1(_classPrivateFieldGet$f(_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$b]}enablePlugin(){this.enabled||(_classPrivateFieldSet$d(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$f(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMapInit$1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$f(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(e,t)=>_assertClassBrand$k(_ManualRowResize_brand,this,_onModifyRowHeight).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$d(_config,this,_classPrivateFieldGet$f(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet$f(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),s=Math.max(t,this.hot.view.getDefaultRowHeight());return _classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,s),s}getLastDesiredRowHeight(){return _classPrivateFieldGet$f(_currentHeight,this)}setupHandlePosition(e){_classPrivateFieldSet$d(_currentTH,this,e);const{view:t}=this.hot,{_wt:n}=t,s=n.wtTable.getCoords(_classPrivateFieldGet$f(_currentTH,this)),o=s.row;if(o<0)return;const a=outerWidth(_classPrivateFieldGet$f(_currentTH,this)),l=_classPrivateFieldGet$f(_currentTH,this).getBoundingClientRect(),u=o<n.getSetting("fixedRowsTop"),c=o>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let d;u?d=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col):c&&(d=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col)),d||(d=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col)),_classPrivateFieldSet$d(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),_classPrivateFieldSet$d(_selectedRows,this,[]);const f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){const C=this.hot.getSelectedRange();arrayEach(C,m=>{const E=m.getTopStartCorner().row,v=m.getBottomStartCorner().row;rangeEach(E,v,_=>{_classPrivateFieldGet$f(_selectedRows,this).includes(_)||_classPrivateFieldGet$f(_selectedRows,this).push(_)})})}_classPrivateFieldGet$f(_selectedRows,this).includes(_classPrivateFieldGet$f(_currentRow,this))||_classPrivateFieldSet$d(_selectedRows,this,[_classPrivateFieldGet$f(_currentRow,this)]),_classPrivateFieldSet$d(_startOffset,this,d.top-6),_classPrivateFieldSet$d(_startHeight,this,parseInt(l.height,10)),_classPrivateFieldGet$f(_handle,this).style.top=`${_classPrivateFieldGet$f(_startOffset,this)+_classPrivateFieldGet$f(_startHeight,this)}px`,_classPrivateFieldGet$f(_handle,this).style[this.inlineDir]=`${d.start}px`,_classPrivateFieldGet$f(_handle,this).style.width=`${a}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$f(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet$f(_handle,this).style.top=`${_classPrivateFieldGet$f(_startOffset,this)+_classPrivateFieldGet$f(_currentHeight,this)}px`}setupGuidePosition(){const e=parseInt(outerWidth(_classPrivateFieldGet$f(_handle,this)),10),t=parseInt(_classPrivateFieldGet$f(_handle,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass$1(_classPrivateFieldGet$f(_handle,this),"active"),addClass$1(_classPrivateFieldGet$f(_guide,this),"active"),_classPrivateFieldGet$f(_guide,this).style.top=_classPrivateFieldGet$f(_handle,this).style.top,_classPrivateFieldGet$f(_guide,this).style[this.inlineDir]=`${t}px`,_classPrivateFieldGet$f(_guide,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$f(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet$f(_guide,this).style.top=_classPrivateFieldGet$f(_handle,this).style.top}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$f(_handle,this),"active"),removeClass$1(_classPrivateFieldGet$f(_guide,this),"active")}checkIfRowHeader(e){const t=closest(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,s.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&_classPrivateFieldGet$f(_newSize,this)<t?t:_classPrivateFieldGet$f(_newSize,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(n,s)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);o!==void 0&&_classPrivateFieldSet$d(_newSize,this,o),this.setManualSize(n,_classPrivateFieldGet$f(_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),s&&e()};_classPrivateFieldGet$f(_dblclick,this)>=2&&(_classPrivateFieldGet$f(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$f(_selectedRows,this),s=>{t(s)}),e()):arrayEach(_classPrivateFieldGet$f(_selectedRows,this),s=>{t(s,!0)})),_classPrivateFieldSet$d(_dblclick,this,0),_classPrivateFieldSet$d(_autoresizeTimeout,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseOver).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseDown).call(this,n)),this.eventManager.addEventListener(t,"mousemove",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseMove).call(this,n)),this.eventManager.addEventListener(t,"mouseup",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$f(_handle,this),"contextmenu",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}}function _onMouseOver(r){if(!isDetached(r.target)&&_classPrivateFieldGet$f(_isTriggeredByRMB,this)!==!0&&this.checkIfRowHeader(r.target)){const e=this.getClosestTHParent(r.target);e&&(_classPrivateFieldGet$f(_pressed,this)||this.setupHandlePosition(e))}}function _onMouseDown(r){hasClass$1(r.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$f(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet$d(_pressed,this,!0),_classPrivateFieldGet$f(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet$d(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$f(_autoresizeTimeout,this))),_classPrivateFieldSet$d(_dblclick,this,_classPrivateFieldGet$f(_dblclick,this)+1),_classPrivateFieldSet$d(_startY,this,r.pageY),_classPrivateFieldSet$d(_newSize,this,_classPrivateFieldGet$f(_startHeight,this)))}function _onMouseMove(r){_classPrivateFieldGet$f(_pressed,this)&&(_classPrivateFieldSet$d(_currentHeight,this,_classPrivateFieldGet$f(_startHeight,this)+(r.pageY-_classPrivateFieldGet$f(_startY,this))),arrayEach(_classPrivateFieldGet$f(_selectedRows,this),e=>{_classPrivateFieldSet$d(_newSize,this,this.setManualSize(e,_classPrivateFieldGet$f(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&r(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};_classPrivateFieldGet$f(_pressed,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$d(_pressed,this,!1),_classPrivateFieldGet$f(_newSize,this)!==_classPrivateFieldGet$f(_startHeight,this)&&(_classPrivateFieldGet$f(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$f(_selectedRows,this),n=>{e(n)}),r()):arrayEach(_classPrivateFieldGet$f(_selectedRows,this),n=>{e(n,!0)})),this.setupHandlePosition(_classPrivateFieldGet$f(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$f(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$f(_guide,this)),_classPrivateFieldSet$d(_pressed,this,!1),_classPrivateFieldSet$d(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$d(_isTriggeredByRMB,this,!1)})}function _onModifyRowHeight(r,e){let t=r;if(this.enabled){const n=this.hot.toPhysicalRow(e),s=_classPrivateFieldGet$f(_rowHeightsMap,this).getValueAtIndex(n);this.hot.getSettings()[PLUGIN_KEY$b]&&s&&(t=s)}return t}function _onMapInit$1(){const r=this.hot.getSettings()[PLUGIN_KEY$b],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)}):Array.isArray(r)?(r.forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)}),_classPrivateFieldSet$d(_config,this,r)):r===!0&&Array.isArray(_classPrivateFieldGet$f(_config,this))&&_classPrivateFieldGet$f(_config,this).forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)})},!0)}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var r=requireAddToUnscopables();return r("flatMap"),es_array_unscopables_flatMap}requireEs_array_unscopables_flatMap();var esnext_iterator_flatMap={},es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var r=requireFunctionCall(),e=requireAnObject(),t=requireGetIteratorDirect(),n=requireGetIteratorMethod();return getIteratorFlattenable=function(s,o){(!o||typeof s!="string")&&e(s);var a=n(s);return t(e(a!==void 0?r(a,s):s))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var r=require_export(),e=requireFunctionCall(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireGetIteratorFlattenable(),a=requireIteratorCreateProxy(),l=requireIteratorClose(),u=requireIsPure(),c=a(function(){for(var d=this.iterator,f=this.mapper,C,m;;){if(m=this.inner)try{if(C=n(e(m.next,m.iterator)),!C.done)return C.value;this.inner=null}catch(E){l(d,"throw",E)}if(C=n(e(this.next,d)),this.done=!!C.done)return;try{this.inner=o(f(C.value,this.counter++),!1)}catch(E){l(d,"throw",E)}}});return r({target:"Iterator",proto:!0,real:!0,forced:u},{flatMap:function(f){return n(this),t(f),new c(s(this),{mapper:f,inner:null})}}),es_iterator_flatMap}var hasRequiredEsnext_iterator_flatMap;function requireEsnext_iterator_flatMap(){return hasRequiredEsnext_iterator_flatMap||(hasRequiredEsnext_iterator_flatMap=1,requireEs_iterator_flatMap()),esnext_iterator_flatMap}requireEsnext_iterator_flatMap();function _classPrivateFieldInitSpec$e(r,e,t){_checkPrivateRedeclaration$j(r,e),e.set(r,t)}function _checkPrivateRedeclaration$j(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$x(r,e,t){return(e=_toPropertyKey$x(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$x(r){var e=_toPrimitive$x(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$x(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$e(r,e){return r.get(_assertClassBrand$j(r,e))}function _classPrivateFieldSet$c(r,e,t){return r.set(_assertClassBrand$j(r,e),t),t}function _assertClassBrand$j(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap;class MergedCellCoords{constructor(e,t,n,s,o,a){_defineProperty$x(this,"row",void 0),_defineProperty$x(this,"col",void 0),_defineProperty$x(this,"rowspan",void 0),_defineProperty$x(this,"colspan",void 0),_defineProperty$x(this,"removed",!1),_defineProperty$x(this,"cellCoordsFactory",void 0),_defineProperty$x(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec$e(this,_cellRange,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=s,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:s,colspan:o}=e;return toSingleLine`The merged cell declared with {row: ${t}, col: ${n},\x20
      rowspan: ${s}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:n,rowspan:s,colspan:o}=e;return t<0||n<0||s<0||o<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return n===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return n===0||t===0}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),_classPrivateFieldSet$c(_cellRange,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",l=Math.min(t,s),u=Math.max(t,s),c=this[a],d=this[a]+this[o]-1;if(c>=t&&(this[a]+=n),n>0)t<=d&&t>c&&(this[o]+=n);else if(n<0){if(l<=c&&u>=d)return this.removed=!0,_classPrivateFieldSet$c(_cellRange,this,null),!1;if(c>=l&&c<=u){const f=u-c+1,C=Math.abs(n)-f;this[a]-=C+n,this[o]-=f}else if(c<=l&&d>=u)this[o]+=n;else if(c<=l&&d>=l&&d<u){const f=d-l+1;this[o]-=f}}return _classPrivateFieldSet$c(_cellRange,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet$e(_cellRange,this)||_classPrivateFieldSet$c(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet$e(_cellRange,this)}}function _classPrivateMethodInitSpec$c(r,e){_checkPrivateRedeclaration$i(r,e),e.add(r)}function _checkPrivateRedeclaration$i(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$w(r,e,t){return(e=_toPropertyKey$w(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$w(r){var e=_toPrimitive$w(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$w(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$i(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet;class MergedCellsCollection{constructor(e){_classPrivateMethodInitSpec$c(this,_MergedCellsCollection_brand),_defineProperty$w(this,"plugin",void 0),_defineProperty$w(this,"mergedCells",[]),_defineProperty$w(this,"mergedCellsMatrix",new Map),_defineProperty$w(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(t))!==null&&n!==void 0?n:!1}getByRange(e){let t=!1;return arrayEach(this.mergedCells,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(t=n,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(s=>{const{row:o,col:a,colspan:l,rowspan:u}=s;for(let c=o;c<o+u;c++)for(let d=a;d<a+l;d++)t.add(`r${c},c${d}`)}),e.filter(s=>{const{row:o,col:a,colspan:l,rowspan:u}=s,c=new Set;let d=!1;for(let f=o;f<o+u;f++){for(let C=a;C<a+l;C++){const m=`r${f},c${C}`;if(t.has(m)){warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(s)),d=!0;break}c.add(m)}if(d)break}return d||t.add(...c),!d})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:s}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),l=[];for(let u=n;u<=o;u++)for(let c=s;c<=a;c++){const d=this.get(u,c);d&&(t||!t&&d.row===u&&d.col===c)&&l.push(d)}return l}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,s=e.col,o=e.rowspan,a=e.colspan,l=new MergedCellCoords(n,s,o,a,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(n,s),c=t?!1:this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),this.mergedCells.push(l),_assertClassBrand$i(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,l),l):(warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,t){const n=this.get(e,t),s=n?this.mergedCells.indexOf(n):-1;return n&&s!==-1?(this.mergedCells.splice(s,1),_assertClassBrand$i(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,n),n):!1}clear(){arrayEach(this.mergedCells,e=>{let{row:t,col:n,rowspan:s,colspan:o}=e;rangeEach(t,t+s,a=>{rangeEach(n,n+o,l=>{const u=this.hot.getCell(a,l);u&&(u.removeAttribute("rowspan"),u.removeAttribute("colspan"),u.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:s,col:o,rowspan:a,colspan:l}=n,u=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleRow(),d=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleColumn(),f=clamp(c,s,s+a-1),C=clamp(d,o,o+l-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(C,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(s,o)}getStartMostColumnIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",-1);let s=t;for(let o=0;o<n.length;o++)if(n[o]<=t){s=n[o];break}return s}getEndMostColumnIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",1);let s=t;for(let o=0;o<n.length;o++)if(n[o]>=t){s=n[o];break}return s}getTopMostRowIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",-1);let s=t;for(let o=0;o<n.length;o++)if(n[o]<=t){s=n[o];break}return s}getBottomMostRowIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",1);let s=t;for(let o=0;o<n.length;o++)if(n[o]>=t){s=n[o];break}return s}shiftCollections(e,t,n){const s=[0,0];switch(e){case"right":s[0]+=n;break;case"left":s[0]-=n;break;case"down":s[1]+=n;break;case"up":s[1]-=n;break}const o=[];this.mergedCells.forEach(a=>{a.shift(s,t),a.removed&&o.push(a)}),o.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{_assertClassBrand$i(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,a)})}}function _getNonIntersectingIndexes(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,s=t===1?r.getTopStartCorner():r.getBottomEndCorner(),o=t===1?r.getBottomEndCorner():r.getTopStartCorner();for(let a=s.row;t===1?a<=o.row:a>=o.row;a+=t)for(let l=s.col;t===1?l<=o.col:l>=o.col;l+=t){const u=e==="row"?a:l,c=this.get(a,l);let d=u;c&&(d=t===1?c[e]+c[`${e}span`]-1:c[e]),n.has(u)||n.set(u,new Set),n.get(u).add(d)}return Array.from(new Set(Array.from(n.entries()).filter(a=>{let[,l]=a;return l.size===1}).flatMap(a=>{let[,l]=a;return Array.from(l)})))}function _addMergedCellToMatrix(r){for(let e=r.row;e<r.row+r.rowspan;e++)for(let t=r.col;t<r.col+r.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,r)}function _removeMergedCellFromMatrix(r){for(let e=r.row;e<r.row+r.rowspan;e++)for(let t=r.col;t<r.col+r.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function _defineProperty$v(r,e,t){return(e=_toPropertyKey$v(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$v(r){var e=_toPrimitive$v(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$v(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class AutofillCalculations{constructor(e){_defineProperty$v(this,"plugin",void 0),_defineProperty$v(this,"mergedCellsCollection",void 0),_defineProperty$v(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let n=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?n="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?n="up":t[1]===e[1]&&t[2]===e[2]?n="right":n="left",n}snapDragArea(e,t,n,s){const o=t.slice(0),a=this.getAutofillSize(e,t,n),[l,u,c,d]=e,C=["up","down"].indexOf(n)>-1?c-l+1:d-u+1,m=Math.floor(a/C)*C,E=a-m,v=this.getFarthestCollection(e,t,n,s);if(v){if(n==="down"){const _=v.row+v.rowspan-l-E;o[2]+_>=this.plugin.hot.countRows()?o[2]-=E:o[2]+=E?_:0}else if(n==="right"){const _=v.col+v.colspan-u-E;o[3]+_>=this.plugin.hot.countCols()?o[3]-=E:o[3]+=E?_:0}else if(n==="up"){const _=c-E-v.row+1;o[0]+_<0?o[0]+=E:o[0]-=E?_:0}else if(n==="left"){const _=d-E-v.col+1;o[1]+_<0?o[1]+=E:o[1]-=E?_:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:s,fillSize:a,dragArea:o,cycleLength:C}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),extend$1(this.currentFillData,e)}getAutofillSize(e,t,n){const[s,o,a,l]=e,[u,c,d,f]=t;switch(n){case"up":return s-u;case"down":return d-a;case"left":return o-c;case"right":return f-l;default:return null}}getDragArea(e,t,n){const[s,o,a,l]=e,[u,c,d,f]=t;switch(n){case"up":return[u,c,s-1,l];case"down":return[a+1,o,d,l];case"left":return[u,c,a,o-1];case"right":return[s,l+1,d,f];default:return null}}getFarthestCollection(e,t,n,s){const[o,a,l,u]=e,c=["up","down"].indexOf(n)>-1,d=c?l:u,f=c?o:a,C=this.getAutofillSize(e,t,n),m=c?l-o+1:u-a+1,E=Math.floor(C/m)*m,v=C-E;let _=null,T=null,R=null;switch(n){case"up":_="includesVertically",R=d-v+1;break;case"left":_="includesHorizontally",R=d-v+1;break;case"down":_="includesVertically",R=f+v-1;break;case"right":_="includesHorizontally",R=f+v-1;break}return arrayEach(s,O=>{O[_](R)&&O.isFarther(T,n)&&(T=O)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,o=(c,d)=>{switch(s){case"up":return c.row-d>=t.from.row;case"down":return c.row+c.rowspan-1+d<=t.to.row;case"left":return c.col-d>=t.from.column;case"right":return c.col+c.colspan-1+d<=t.to.column;default:return null}};let a=0,l=null,u=1;do for(let c=0;c<n.length;c+=1){if(l=n[c],a=u*this.currentFillData.cycleLength,o(l,a))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:l.row-a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-a,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+a,colspan:l.colspan});break}c===n.length-1&&(u+=1)}while(o(l,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return arrayEach(e,s=>{const o=s[0],a=this.plugin.hot.propToCol(s[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a)}),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const s=this.getDragArea(e,t,n),[o,a,l,u]=s,c=this.plugin.hot._createCellCoords(o,a),d=this.plugin.hot._createCellCoords(l,u),f=this.plugin.hot._createCellRange(c,c,d);return this.mergedCellsCollection.getWithinRange(f,!0).length>0}}function _defineProperty$u(r,e,t){return(e=_toPropertyKey$u(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$u(r){var e=_toPrimitive$u(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$u(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SelectionCalculations{constructor(e){_defineProperty$u(this,"plugin",void 0),_defineProperty$u(this,"hot",void 0),_defineProperty$u(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,s){const o=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const d=this.plugin.mergedCellsCollection.get(e,t);if(!d)return;const f=d.getLastRow(),C=d.getLastColumn();if(o<=d.row&&a<=d.col&&l>=f&&u>=C)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(d,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+s,e.col+o));for(let s=0;s<n.length;s+=1){const o=[];for(let a=0;a<t.length;a+=1)o[a]=t[a].includes(n[s]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function toggleMergeItem(r){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=r.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;r.toggleMerge(e),this.selectCell(t.row,t.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?MergedCellCoords.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function _defineProperty$t(r,e,t){return(e=_toPropertyKey$t(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$t(r){var e=_toPrimitive$t(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$t(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class NodeStructure{constructor(e){_defineProperty$t(this,"data",void 0),_defineProperty$t(this,"next",null),_defineProperty$t(this,"prev",null),this.data=e}}class LinkedList{constructor(){_defineProperty$t(this,"first",null),_defineProperty$t(this,"last",null)}push(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const n=this.last;this.last=t,t.prev=n,n.next=t}return t}unshift(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const n=this.first;this.first=t,t.next=n,n.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||n===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,n,s;for(;t;){if(t.data===e)return n=t.next,s=t.prev,n&&(n.prev=s),s&&(s.next=n),t===this.first&&(this.first=n),t===this.last&&(this.last=s),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,s){s&&(e(s,s.next),s.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,n;for(;e;)n=e.next,e.next=t,t.prev=e,t=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=t,this.last=n}}function _classPrivateMethodInitSpec$b(r,e){_checkPrivateRedeclaration$h(r,e),e.add(r)}function _classPrivateFieldInitSpec$d(r,e,t){_checkPrivateRedeclaration$h(r,e),e.set(r,t)}function _checkPrivateRedeclaration$h(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$d(r,e){return r.get(_assertClassBrand$h(r,e))}function _classPrivateFieldSet$b(r,e,t){return r.set(_assertClassBrand$h(r,e),t),t}function _assertClassBrand$h(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet;class FocusOrder{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:s}=e;_classPrivateMethodInitSpec$b(this,_FocusOrder_brand),_classPrivateFieldInitSpec$d(this,_cellsHorizontalOrder,new LinkedList),_classPrivateFieldInitSpec$d(this,_cellsVerticalOrder,new LinkedList),_classPrivateFieldInitSpec$d(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec$d(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec$d(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec$d(this,_rowIndexMapper,null),_classPrivateFieldInitSpec$d(this,_columnIndexMapper,null),_classPrivateFieldSet$b(_mergedCellsGetter,this,t),_classPrivateFieldSet$b(_rowIndexMapper,this,n),_classPrivateFieldSet$b(_columnIndexMapper,this,s)}getCurrentVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet$d(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet$d(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,_classPrivateFieldGet$d(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,_classPrivateFieldGet$d(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),n=e.getBottomEndCorner(),s=new WeakSet;_classPrivateFieldSet$b(_cellsHorizontalOrder,this,new LinkedList);for(let a=t.row;a<=n.row;a++)if(!_classPrivateFieldGet$d(_rowIndexMapper,this).isHidden(a))for(let l=t.col;l<=n.col;l++){if(_classPrivateFieldGet$d(_columnIndexMapper,this).isHidden(l))continue;const u=_assertClassBrand$h(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$d(_cellsHorizontalOrder,this),s,a,l);u&&_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,u)}_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet$d(_cellsHorizontalOrder,this).last,_classPrivateFieldGet$d(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first);const o=new WeakSet;_classPrivateFieldSet$b(_cellsVerticalOrder,this,new LinkedList);for(let a=t.col;a<=n.col;a++)if(!_classPrivateFieldGet$d(_columnIndexMapper,this).isHidden(a))for(let l=t.row;l<=n.row;l++){if(_classPrivateFieldGet$d(_rowIndexMapper,this).isHidden(l))continue;const u=_assertClassBrand$h(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$d(_cellsVerticalOrder,this),o,l,a);u&&_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,u)}_classPrivateFieldGet$d(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet$d(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet$d(_cellsVerticalOrder,this).last,_classPrivateFieldGet$d(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet$d(_cellsVerticalOrder,this).first)}setActiveNode(e,t){return _classPrivateFieldGet$d(_cellsHorizontalOrder,this).inorder(n=>{const{rowStart:s,rowEnd:o,colStart:a,colEnd:l}=n.data;if(e>=s&&e<=o&&t>=a&&t<=l)return _classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,n),!1}),_classPrivateFieldGet$d(_cellsVerticalOrder,this).inorder(n=>{const{rowStart:s,rowEnd:o,colStart:a,colEnd:l}=n.data;if(e>=s&&e<=o&&t>=a&&t<=l)return _classPrivateFieldSet$b(_currentVerticalLinkedNode,this,n),!1}),this}}function _pushOrderNode(r,e,t,n,s){const o=r.getTopStartCorner(),a=r.getBottomEndCorner(),l=r.highlight.clone().normalize(),u=_classPrivateFieldGet$d(_mergedCellsGetter,this).call(this,n,s);if(u&&t.has(u))return null;const c={colStart:s,colEnd:s,rowStart:n,rowEnd:n};if(u){if(t.add(u),u.row<o.row||u.row+u.rowspan-1>a.row||u.col<o.col||u.col+u.colspan-1>a.col)return null;c.colStart=u.col,c.colEnd=u.col+u.colspan-1,c.rowStart=u.row,c.rowEnd=u.row+u.rowspan-1}const d=e.push(c);return n===l.row&&s===l.col||u&&l.row>=u.row&&l.row<=u.row+u.rowspan-1&&l.col>=u.col&&l.col<=u.col+u.colspan-1?d:null}function createMergeCellRenderer(r){const{hot:e}=r,{rowIndexMapper:t,columnIndexMapper:n}=e;function s(){}function o(a,l,u){const c=r.mergedCellsCollection.get(l,u);if(!isObject$1(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="";return}const{row:d,col:f,colspan:C,rowspan:m}=c,[E,v]=r.translateMergedCellToRenderable(d,m,f,C),_=r.getSetting("virtualized"),T=t.getRenderableFromVisualIndex(l),R=n.getRenderableFromVisualIndex(u),O=E-T+1,N=v-R+1;let G=t.getNearestNotHiddenIndex(d,1),D=n.getNearestNotHiddenIndex(f,1);if(_){const ne=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(ne)||(G=Math.max(G,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(ne)||(D=Math.max(D,e.getFirstRenderedVisibleColumn()))}const k=Math.min(m,O),z=Math.min(C,N);G===l&&D===u?(a.setAttribute("rowspan",k),a.setAttribute("colspan",z)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function _classPrivateMethodInitSpec$a(r,e){_checkPrivateRedeclaration$g(r,e),e.add(r)}function _classPrivateFieldInitSpec$c(r,e,t){_checkPrivateRedeclaration$g(r,e),e.set(r,t)}function _checkPrivateRedeclaration$g(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$s(r,e,t){return(e=_toPropertyKey$s(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$s(r){var e=_toPrimitive$s(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$s(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$a(r,e,t){return r.set(_assertClassBrand$g(r,e),t),t}function _classPrivateFieldGet$c(r,e){return r.get(_assertClassBrand$g(r,e))}function _assertClassBrand$g(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeMergeCells");Hooks.getSingleton().register("afterMergeCells");Hooks.getSingleton().register("beforeUnmergeCells");Hooks.getSingleton().register("afterUnmergeCells");const PLUGIN_KEY$a="mergeCells",PLUGIN_PRIORITY$9=150,SHORTCUTS_GROUP$3=PLUGIN_KEY$a;var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet;class MergeCells extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$a(this,_MergeCells_brand),_defineProperty$s(this,"mergedCellsCollection",null),_defineProperty$s(this,"autofillCalculations",null),_defineProperty$s(this,"selectionCalculations",null),_classPrivateFieldInitSpec$c(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec$c(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec$c(this,_focusOrder,new FocusOrder({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec$c(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY$a}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$9}static get DEFAULT_SETTINGS(){return{[defaultMainSettingSymbol]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$a]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new AutofillCalculations(this),this.selectionCalculations=new SelectionCalculations(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterInit$1).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformFocus).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformStart$1).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformEnd).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSelectionHighlightSet$1).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSelectionFocusSet).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterSelectionFocusSet).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterSelectionEnd).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterIsMultipleSelection).call(e,...n)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet$c(_cellRenderer,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_addMergeActionsToContextMenu).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterGetCellMeta).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterViewportRowCalculatorOverride).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterViewportColumnCalculatorOverride$1).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyAutofillRange).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterCreateCol).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterRemoveCol).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterCreateRow$1).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterRemoveRow$1).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterChange).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeDrawAreaBorders).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterDrawSelection).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeRemoveCellClassNames).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeBeginEditing).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyRowHeightByOverlayName).call(e,...n)}),this.addHook("beforeUndoStackChange",(t,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:s,rowspan:o}=n;for(let a=s+1;a<s+o;a++)t.push(a)}),t=[...new Set(t)],t.forEach(n=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(s);a&&(a.style.background=getStyle(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=getStyle(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?MergedCellCoords.containsNegativeValues(e)?(warn$1(MergedCellCoords.NEGATIVE_VALUES_WARNING(e)),!1):MergedCellCoords.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn$1(MergedCellCoords.IS_OUT_OF_BOUNDS_WARNING(e)),!1):MergedCellCoords.isSingleCell(e)?(warn$1(MergedCellCoords.IS_SINGLE_CELL(e)),!1):MergedCellCoords.containsZeroSpan(e)?(warn$1(MergedCellCoords.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,c=this.hot._createCellCoords(o,a),d=this.hot._createCellCoords(o+l-1,a+u-1),f=this.hot._createCellRange(c,c,d);this.mergeRange(f,!0,!0);for(let C=o;C<o+l;C++)for(let m=a;m<a+u;m++)(C!==o||m!==a)&&n.push([C,m,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:s.row,col:s.col,rowspan:o.row-s.row+1,colspan:o.col-s.col+1},l=[];let u=null;return this.canMergeRange(a,t)?(this.hot.runHooks("beforeMergeCells",e,t),rangeEach(0,a.rowspan-1,d=>{rangeEach(0,a.colspan-1,f=>{let C=null;l[d]||(l[d]=[]),d===0&&f===0?C=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+d,a.col+f,"hidden",!0),l[d][f]=C})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,t)?(n?u=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,t),u):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),arrayEach(n,s=>{this.mergedCellsCollection.remove(s.row,s.col),rangeEach(0,s.rowspan-1,o=>{rangeEach(0,s.colspan-1,a=>{this.hot.removeCellMeta(s.row+o,s.col+a,"hidden"),this.hot.removeCellMeta(s.row+o,s.col+a,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,s){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(n,s);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,t,n,s){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(n,s);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:SHORTCUTS_GROUP$3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$3)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,s=n.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(s,o);if(isObject$1(a)){const l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,s=n.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(s,o);if(isObject$1(a)){const l=a.row+a.rowspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1));if(u>e.endRow){e.endRow=u,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,s=n.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,s);if(isObject$1(a)){const l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,s=n.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,s);if(isObject$1(a)){const l=a.col+a.colspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1));if(u>e.endColumn){e.endColumn=u,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,n,s){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let l,u;t===0?l=o.getNearestNotHiddenIndex(e,1):l=o.getNearestNotHiddenIndex(e+t-1,-1),s===0?u=a.getNearestNotHiddenIndex(n,1):u=a.getNearestNotHiddenIndex(n+s-1,-1);const c=e>=0?o.getRenderableFromVisualIndex(l):e,d=n>=0?a.getRenderableFromVisualIndex(u):n;return[c,d]}}function _onAfterInit$1(){this.generateFromSettings(),this.hot.render()}function _onAfterIsMultipleSelection(r){if(r){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),s=t.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(n.row===e[o].row&&n.col===e[o].col&&s.row===e[o].row+e[o].rowspan-1&&s.col===e[o].col+e[o].colspan-1)return!1}return r}function _onModifyTransformFocus(r){_classPrivateFieldGet$c(_lastFocusDelta,this).row=r.row,_classPrivateFieldGet$c(_lastFocusDelta,this).col=r.col}function _onModifyTransformStart$1(r){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:n,rowIndexMapper:s}=this.hot;_classPrivateFieldGet$c(_lastSelectedFocus,this)&&(s.getRenderableFromVisualIndex(_classPrivateFieldGet$c(_lastSelectedFocus,this).row)!==null&&(t.row=_classPrivateFieldGet$c(_lastSelectedFocus,this).row),n.getRenderableFromVisualIndex(_classPrivateFieldGet$c(_lastSelectedFocus,this).col)!==null&&(t.col=_classPrivateFieldGet$c(_lastSelectedFocus,this).col),_classPrivateFieldSet$a(_lastSelectedFocus,this,null));const o=this.mergedCellsCollection.get(t.row,t.col);if(!o)return;const a=o.col,l=o.col+o.colspan-1;if(r.col<0){const d=t.col>=a&&t.col<=l?a-1:l,f=n.getNearestNotHiddenIndex(d,-1);f===null?r.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(f,t.col)-1,1)}else if(r.col>0){const d=t.col>=a&&t.col<=l?l+1:a,f=n.getNearestNotHiddenIndex(d,1);f===null?r.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,f)-1,1)}const u=o.row,c=o.row+o.rowspan-1;if(r.row<0){const d=t.row>=u&&t.row<=c?u-1:c,f=s.getNearestNotHiddenIndex(d,-1);f===null?r.row=-this.hot.view.countRenderableRowsInRange(0,t.row):r.row=-Math.max(this.hot.view.countRenderableRowsInRange(f,t.row)-1,1)}else if(r.row>0){const d=t.row>=u&&t.row<=c?c+1:u,f=s.getNearestNotHiddenIndex(d,1);f===null?r.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):r.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,f)-1,1)}}function _onModifyTransformEnd(r){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:n}=e,{columnIndexMapper:s,rowIndexMapper:o}=this.hot,a=(l,u)=>{t.expand(this.hot._createCellCoords(l,u));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(r.col<0){let l=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+r.col;a(n.row,l),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(l=t.getTopStartCorner().col);const u=s.getNearestNotHiddenIndex(l,1);u!==null&&(r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,n.col)-1,1))}else if(r.col>0){let l=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+r.col;a(n.row,l),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(l=t.getBottomEndCorner().col);const u=s.getNearestNotHiddenIndex(l,-1);u!==null&&(r.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,u)-1,1))}if(r.row<0){let l=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+r.row;a(l,n.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(l=t.getTopStartCorner().row);const u=o.getNearestNotHiddenIndex(l,1);u!==null&&(r.row=-Math.max(this.hot.view.countRenderableRowsInRange(u,n.row)-1,1))}else if(r.row>0){let l=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+r.row;a(l,n.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(l=t.getBottomStartCorner().row);const u=o.getNearestNotHiddenIndex(l,-1);u!==null&&(r.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,u)-1,1))}}function _onBeforeSelectionHighlightSet$1(){const r=this.hot.getSelectedRangeLast(),{highlight:e}=r;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet$a(_lastSelectedFocus,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);_classPrivateFieldSet$a(_lastSelectedFocus,this,e.clone()),t&&e.assign(t)}function _onModifyGetCellCoords(r,e,t,n){if(r<0||e<0)return;const s=this.mergedCellsCollection.get(r,e);if(!s)return;const{row:o,col:a,colspan:l,rowspan:u}=s,c=o,d=a,f=o+u-1,C=a+l-1;if(n==="render"&&this.getSetting("virtualized")){const m=this.hot.view.getActiveOverlayName(),E=["top","top_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleColumn();return[clamp(E,c,f),clamp(v,d,C),clamp(this.hot.getLastRenderedVisibleRow(),c,f),clamp(this.hot.getLastRenderedVisibleColumn(),d,C)]}return[c,d,f,C]}function _addMergeActionsToContextMenu(r){r.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet$a(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet$c(_lastSelectedFocus,this).isCell())return;const r=this.hot.getSelectedRangeLast(),e=r.getVerticalDirection(),t=r.getHorizontalDirection(),n=_classPrivateFieldGet$c(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet$c(_focusOrder,this).setActiveNode(n.row,n.col),_classPrivateFieldGet$c(_lastFocusDelta,this).row>0||_classPrivateFieldGet$c(_lastFocusDelta,this).col>0?_classPrivateFieldGet$c(_focusOrder,this).setPrevNodeAsActive():(t==="E-W"&&_classPrivateFieldGet$c(_lastFocusDelta,this).col<0||e==="S-N"&&_classPrivateFieldGet$c(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet$c(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(r,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:s}=this.hot;let o=null,a=null;if(_classPrivateFieldGet$c(_lastFocusDelta,this).col<0){const{rowEnd:l,colEnd:u}=_classPrivateFieldGet$c(_focusOrder,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(u,-1),o=s.getNearestNotHiddenIndex(l,-1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).col>0){const{rowStart:l,colStart:u}=_classPrivateFieldGet$c(_focusOrder,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(u,1),o=s.getNearestNotHiddenIndex(l,1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).row<0){const{rowEnd:l,colEnd:u}=_classPrivateFieldGet$c(_focusOrder,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(u,-1),o=s.getNearestNotHiddenIndex(l,-1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).row>0){const{rowStart:l,colStart:u}=_classPrivateFieldGet$c(_focusOrder,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(u,1),o=s.getNearestNotHiddenIndex(l,1)}if(o!==null||a!==null){const l=this.hot._createCellCoords(o,a),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();r=l.row,e=l.col,u?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):t.highlight.assign(l),c.clear(),c.add(l).commit()}_classPrivateFieldGet$c(_focusOrder,this).setActiveNode(r,e),_classPrivateFieldSet$a(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd(){this.hot.getSelectedRangeLast().isHeader()||_classPrivateFieldGet$c(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _onAfterGetCellMeta(r,e,t){const n=this.mergedCellsCollection.get(r,e);n&&(n.row!==r||n.col!==e?t.copyable=!1:(t.rowspan=n.rowspan,t.colspan=n.colspan))}function _onAfterViewportRowCalculatorOverride(r){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(r,e),this.modifyViewportRowEnd(r,e)}function _onAfterViewportColumnCalculatorOverride$1(r){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(r,e),this.modifyViewportColumnEnd(r,e)}function _onModifyAutofillRange(r,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,r);let n=r;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,t))return n=e,n;const s=this.hot._createCellCoords(e[0],e[1]),o=this.hot._createCellCoords(e[2],e[3]),a=this.hot._createCellRange(s,s,o),l=this.mergedCellsCollection.getWithinRange(a);return l.length===0||(n=this.autofillCalculations.snapDragArea(e,n,t,l)),n}function _onAfterCreateCol(r,e){this.mergedCellsCollection.shiftCollections("right",r,e)}function _onAfterRemoveCol(r,e){this.mergedCellsCollection.shiftCollections("left",r,e)}function _onAfterCreateRow$1(r,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",r,e)}function _onAfterRemoveRow$1(r,e){this.mergedCellsCollection.shiftCollections("up",r,e)}function _onAfterChange(r,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(r)}function _onBeforeDrawAreaBorders(r,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(t);arrayEach(n,s=>{t.getBottomEndCorner().row===s.getLastRow()&&t.getBottomEndCorner().col===s.getLastColumn()&&(r[2]=s.row,r[3]=s.col)})}}function _onAfterDrawSelection(r,e,t,n){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(r,e,t,n)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(r,e,t,n){if(!(n instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(s);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(a,a,l))}function _onModifyRowHeightByOverlayName(r,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return r;let n,s;if(t==="master")n=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const C=this.hot.view.getOverlayByName(t);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return r;const a=this.hot._createCellCoords(e,n),l=this.hot._createCellCoords(e,s),u=this.hot._createCellRange(a,a,l),c=this.mergedCellsCollection.getWithinRange(u,!0),d=c.reduce((C,m)=>{let{rowspan:E}=m;return Math.max(C,E)},1);let f=0;return c.length>1&&c[0].rowspan<d&&(f=d-c[0].rowspan),c.forEach(C=>{var m;let{rowspan:E}=C,v=0;t==="top"||t==="top_inline_start_corner"?v=Math.min(d,this.hot.view.countNotHiddenFixedRowsTop()-e):v=E-f,r=Math.max((m=r)!==null&&m!==void 0?m:0,_assertClassBrand$g(_MergeCells_brand,this,_sumCellsHeights).call(this,e,v))}),r}function _sumCellsHeights(r,e){const t=this.hot.view.getDefaultRowHeight(),n=this.hot.getPlugin("autoRowSize");let s=0;for(let a=r;a<r+e;a++)if(!this.hot.rowIndexMapper.isHidden(a)){var o;s+=(o=n==null?void 0:n.getRowHeight(a))!==null&&o!==void 0?o:t}return s}function rootComparator(r,e){return function(t,n){const[,...s]=t,[,...o]=n;return function a(l){const u=r[l],c=e[l],d=s[l],f=o[l],C=c.multiColumnSorting,E=(C.compareFunctionFactory?C.compareFunctionFactory:getCompareFunctionFactory(c.type))(u,c,C)(d,f);if(E===DO_NOT_SWAP){const v=l+1;if(typeof e[v]<"u")return a(v)}return E}(0)}}function warnAboutPluginsConflict(){warn$1(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(r,e,t){const n=[];return t===!1||r.isColumnSorted(e)&&r.getNumberOfSortedColumns()>1&&n.push(`${COLUMN_ORDER_PREFIX}-${r.getIndexOfColumnInSortQueue(e)+1}`),n}function getClassesToRemove(r){const e=r.className.split(" "),t=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return e.filter(n=>t.test(n))}function _defineProperty$r(r,e,t){return(e=_toPropertyKey$r(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$r(r){var e=_toPrimitive$r(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$r(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const PLUGIN_KEY$9="multiColumnSorting",PLUGIN_PRIORITY$8=170,CONFLICTED_PLUGIN_KEY="columnSorting",SHORTCUTS_GROUP$2=PLUGIN_KEY$9;registerRootComparator(PLUGIN_KEY$9,rootComparator);class MultiColumnSorting extends ColumnSorting{constructor(){super(...arguments),_defineProperty$r(this,"pluginKey",PLUGIN_KEY$9)}static get PLUGIN_KEY(){return PLUGIN_KEY$9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$8}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&(warnAboutPluginsConflict(),this.hot.getPlugin(CONFLICTED_PLUGIN_KEY).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$2})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$2)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];super.updateHeaderClasses(e,...n),removeClass$1(e,getClassesToRemove(e)),this.enabled!==!1&&addClass$1(e,getClassesToAdd(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(t.col)))}}function _defineProperty$q(r,e,t){return(e=_toPropertyKey$q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$q(r){var e=_toPrimitive$q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const PLUGIN_KEY$8="multipleSelectionHandles",PLUGIN_PRIORITY$7=160;class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),_defineProperty$q(this,"dragged",[]),_defineProperty$q(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$7}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(s);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let o;if(hasClass$1(s.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1;if(hasClass$1(s.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if(hasClass$1(s.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(hasClass$1(s.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{const{rootDocument:o}=this.hot;let a,l,u,c,d,f;if(e.dragged.length===0)return;const C=o.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!C||C===e.lastSetCell||((C.nodeName==="TD"||C.nodeName==="TH")&&(a=e.hot.getCoords(C),a.col===-1&&(a.col=0),l=e.hot.getSelectedRangeLast(),u=l.getWidth(),c=l.getHeight(),d=l.getDirection(),u===1&&c===1&&e.hot.selection.setRangeEnd(a),f=e.getCurrentRangeCoords(l,a,e.touchStartRange.direction,d,e.dragged[0]),f.start!==null&&e.hot.selection.setRangeStart(f.start),e.hot.selection.setRangeEnd(f.end),e.lastSetCell=C),s.preventDefault())})}getCurrentRangeCoords(e,t,n,s,o){const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.getBottomStartCorner(),c=e.getTopEndCorner();let d={start:null,end:null};switch(n){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":o==="top"?d={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SE-NW":o==="bottom"&&(d={start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,a.col)});break}break;case"NW-SE":switch(s){case"NE-SW":o==="top"?d={start:t,end:u}:d.end=t;break;case"NW-SE":o==="top"?d={start:t,end:l}:d.end=t;break;case"SE-NW":o==="top"?d={start:t,end:a}:d.end=t;break;case"SW-NE":o==="top"?d={start:t,end:c}:d.end=t;break}break;case"SW-NE":switch(s){case"NW-SE":o==="bottom"?d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SW-NE":o==="top"?d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)}:d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(a.row,t.col)};break;case"SE-NW":o==="bottom"?d={start:this.hot._createCellCoords(t.row,c.col),end:this.hot._createCellCoords(a.row,t.col)}:o==="top"&&(d={start:u,end:t});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(d.end=t);break;case"SE-NW":o==="top"?d.end=t:d={start:t,end:a};break}break}return d}isDragged(){return this.dragged.length>0}}function createDefaultHeaderSettings(){let{label:r="",colspan:e=1,origColspan:t=1,collapsible:n=!1,crossHiddenColumns:s=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:l=!1,isPlaceholder:u=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:r,colspan:e,origColspan:t,collapsible:n,isCollapsed:o,crossHiddenColumns:s,isHidden:a,isRoot:l,isPlaceholder:u,headerClassNames:c}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function normalizeSettings(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;arrayEach(r,s=>{const o=[];let a=0;t.push(o),arrayEach(s,l=>{const u=createDefaultHeaderSettings();if(isObject$1(l)){const{label:d,colspan:f,headerClassName:C}=l;u.label=stringify$1(d),typeof f=="number"&&f>1&&(u.colspan=f,u.origColspan=f),typeof C=="string"&&(u.headerClassNames=[...C.split(" ")])}else u.label=stringify$1(l);a+=u.origColspan;let c=!1;if(a>=e&&(u.colspan=u.origColspan-(a-e),u.origColspan=u.colspan,c=!0),o.push(u),u.colspan>1)for(let d=0;d<u.colspan-1;d++)o.push(createPlaceholderHeaderSettings());return!c})});const n=Math.max(...arrayMap(t,s=>s.length));return arrayEach(t,s=>{if(s.length<n){const o=arrayMap(new Array(n-s.length),()=>createDefaultHeaderSettings());s.splice(s.length,0,...o)}}),t}function _classPrivateFieldInitSpec$b(r,e,t){_checkPrivateRedeclaration$f(r,e),e.set(r,t)}function _checkPrivateRedeclaration$f(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$b(r,e){return r.get(_assertClassBrand$f(r,e))}function _classPrivateFieldSet$9(r,e,t){return r.set(_assertClassBrand$f(r,e),t),t}function _assertClassBrand$f(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap;class SourceSettings{constructor(){_classPrivateFieldInitSpec$b(this,_data,[]),_classPrivateFieldInitSpec$b(this,_dataLength,0),_classPrivateFieldInitSpec$b(this,_columnsLimit,1/0)}setColumnsLimit(e){_classPrivateFieldSet$9(_columnsLimit,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$9(_data,this,normalizeSettings(e,_classPrivateFieldGet$b(_columnsLimit,this))),_classPrivateFieldSet$9(_dataLength,this,_classPrivateFieldGet$b(_data,this).length)}getData(){return _classPrivateFieldGet$b(_data,this)}mergeWith(e){arrayEach(e,t=>{let{row:n,col:s,...o}=t;const a=this.getHeaderSettings(n,s);a!==null&&extend$1(a,o,HEADER_CONFIGURABLE_PROPS)})}map(e){arrayEach(_classPrivateFieldGet$b(_data,this),t=>{arrayEach(t,n=>{const s=e({...n});isObject$1(s)&&extend$1(n,s,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(e,t){var n;if(e>=_classPrivateFieldGet$b(_dataLength,this)||e<0)return null;const s=_classPrivateFieldGet$b(_data,this)[e];return Array.isArray(s)===!1||t>=s.length?null:(n=s[t])!==null&&n!==void 0?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=_classPrivateFieldGet$b(_dataLength,this)||e<0)return s;const o=_classPrivateFieldGet$b(_data,this)[e];let a=0;for(let l=t;l<o.length;l++){const u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=u.colspan,s.push(u),u.colspan>1&&(l+=u.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return _classPrivateFieldGet$b(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet$b(_dataLength,this)>0?_classPrivateFieldGet$b(_data,this)[0].length:0}clear(){_classPrivateFieldSet$9(_data,this,[]),_classPrivateFieldSet$9(_dataLength,this,0)}}function _defineProperty$p(r,e,t){return(e=_toPropertyKey$p(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$p(r){var e=_toPrimitive$p(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$p(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(r,e){let t=r.call(e,this);for(let n=0;n<this.childs.length;n++){if(t===!1)return!1;t=depthFirstPreOrder.call(this.childs[n],r,e)}return t}const TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(r,e){for(let t=0;t<this.childs.length;t++)if(depthFirstPostOrder.call(this.childs[t],r,e)===!1)return!1;return r.call(e,this)}const TRAVERSAL_BF="BF";function breadthFirst(r,e){const t=[this];function n(){if(t.length===0)return;const s=t.shift();t.push(...s.childs),r.call(e,s)!==!1&&n()}n()}const DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]);class TreeNode{constructor(e){_defineProperty$p(this,"data",{}),_defineProperty$p(this,"parent",null),_defineProperty$p(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new TreeNode({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);TRAVERSAL_STRATEGIES.get(t).call(this,e,this)}walkUp(e){const t=this,n=s=>{e.call(t,s)!==!1&&s.parent!==null&&n(s.parent)};n(this)}}function _classPrivateFieldInitSpec$a(r,e,t){_checkPrivateRedeclaration$e(r,e),e.set(r,t)}function _checkPrivateRedeclaration$e(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$a(r,e){return r.get(_assertClassBrand$e(r,e))}function _classPrivateFieldSet$8(r,e,t){return r.set(_assertClassBrand$e(r,e),t),t}function _assertClassBrand$e(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap;class HeadersTree{constructor(e){_classPrivateFieldInitSpec$a(this,_rootNodes,new Map),_classPrivateFieldInitSpec$a(this,_rootsIndex,new Map),_classPrivateFieldInitSpec$a(this,_sourceSettings$1,null),_classPrivateFieldSet$8(_sourceSettings$1,this,e)}getRoots(){return Array.from(_classPrivateFieldGet$a(_rootNodes,this).values())}getRootByColumn(e){let t;return _classPrivateFieldGet$a(_rootsIndex,this).has(e)&&(t=_classPrivateFieldGet$a(_rootNodes,this).get(_classPrivateFieldGet$a(_rootsIndex,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const s=t-_classPrivateFieldGet$a(_rootsIndex,this).get(t);let o=0,a;return n.walkDown(l=>{const{data:{origColspan:u,headerLevel:c}}=l;if(e===c){if(s>=o&&s<=o+u-1)return a=l,a.data.isRoot=t===a.data.columnIndex,!1;o+=u}}),a}rebuildTreeIndex(){let e=0;_classPrivateFieldGet$a(_rootsIndex,this).clear(),arrayEach(_classPrivateFieldGet$a(_rootNodes,this),t=>{let[,{data:{colspan:n}}]=t;for(let s=e;s<e+n;s++)_classPrivateFieldGet$a(_rootsIndex,this).set(s,e);e+=n})}buildTree(){this.clear();const e=_classPrivateFieldGet$a(_sourceSettings$1,this).getColumnsCount();let t=0;for(;t<e;){const n=_classPrivateFieldGet$a(_sourceSettings$1,this).getHeaderSettings(0,t),s=new TreeNode;_classPrivateFieldGet$a(_rootNodes,this).set(t,s),this.buildLeaves(s,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=_classPrivateFieldGet$a(_sourceSettings$1,this).getHeadersSettings(n,t,s);n+=1,arrayEach(o,a=>{const l={...a,headerLevel:n-1,columnIndex:t};let u;n===1?(e.data=l,u=e):(u=new TreeNode(l),e.addChild(u)),n<_classPrivateFieldGet$a(_sourceSettings$1,this).getLayersCount()&&this.buildLeaves(u,t,n,a.origColspan),t+=a.origColspan})}clear(){_classPrivateFieldGet$a(_rootNodes,this).clear(),_classPrivateFieldGet$a(_rootsIndex,this).clear()}}function traverseHiddenNodeColumnIndexes(r,e){r.walkDown(t=>{let{data:n,childs:s}=t;if(!n.isHidden&&(e(n.columnIndex),s.length===0))for(let o=1;o<n.colspan;o++)e(n.columnIndex+o)})}function getFirstChildProperty(r,e){let{childs:t}=r;if(t.length!==0)return t[0].data[e]}function isNodeReflectsFirstChildColspan(r){return getFirstChildProperty(r,"origColspan")===r.data.origColspan}function expandNode(r){const{data:e,childs:t}=r;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(r))return expandNode(t[0]);e.isCollapsed=!1;const s=t.slice(1),o=new Set;let a=0;if(s.length>0)arrayEach(s,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const u=l.data;a+=u.colspan,traverseHiddenNodeColumnIndexes(l,c=>{o.add(c)})});else{const{colspan:l,origColspan:u,columnIndex:c}=e;a=u-l;for(let d=1;d<u;d++)o.add(c+d)}return r.walkUp(l=>{const{data:u}=l;u.colspan+=a,u.colspan>=u.origColspan?(u.colspan=u.origColspan,u.isCollapsed=!1):isNodeReflectsFirstChildColspan(l)&&(u.isCollapsed=getFirstChildProperty(l,"isCollapsed"))}),{rollbackModification:()=>collapseNode(r),affectedColumns:Array.from(o),colspanCompensation:a}}function collapseNode(r){var e;const{data:t,childs:n}=r;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(r))return collapseNode(n[0]);t.isCollapsed=!0;const o=n.slice(1),a=new Set;if(o.length>0)arrayEach(o,u=>{traverseHiddenNodeColumnIndexes(u,c=>{a.add(c)}),u.data.clonedTree=u.cloneTree(),u.walkDown(c=>{let{data:d}=c;d.isHidden=!0})});else{const{origColspan:u,columnIndex:c}=t;for(let d=1;d<u;d++){const f=c+d;a.add(f)}}const l=t.colspan-((e=getFirstChildProperty(r,"colspan"))!==null&&e!==void 0?e:1);return r.walkUp(u=>{const{data:c}=u;c.colspan-=l,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):isNodeReflectsFirstChildColspan(u)&&(c.isCollapsed=getFirstChildProperty(u,"isCollapsed"))}),{rollbackModification:()=>expandNode(r),affectedColumns:Array.from(a),colspanCompensation:l}}function hideColumn(r,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=r.data;if(t.includes(e))return;let n=!1;r.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return n=!0,!1}),!n&&r.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function showColumn(r,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=r.data;if(!t.includes(e))return;let n=!1;r.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return n=!0,!1}),!n&&r.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(r,e,t){if(!availableModifiers.has(r))throw new Error(`The node modifier action ("${r}") does not exist.`);return availableModifiers.get(r)(e,t)}function generateMatrix(r){const e=[];return arrayEach(r,t=>{t.walkDown(n=>{const s=n.data,{origColspan:o,columnIndex:a,headerLevel:l,crossHiddenColumns:u}=s,c=createNestedArrayIfNecessary(e,l);let d=!1;for(let f=a;f<a+o;f++)if(u.includes(f)||d)c.push(createPlaceholderHeaderSettings());else{const m=createHeaderSettings(s);m.isRoot=!0,c.push(m),d=!0}})}),e}function createHeaderSettings(r){const{crossHiddenColumns:e,...t}=createDefaultHeaderSettings(r);return t}function createNestedArrayIfNecessary(r,e){let t;return Array.isArray(r[e])?t=r[e]:(t=[],r[e]=t),t}function _classPrivateFieldInitSpec$9(r,e,t){_checkPrivateRedeclaration$d(r,e),e.set(r,t)}function _checkPrivateRedeclaration$d(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$7(r,e,t){return r.set(_assertClassBrand$d(r,e),t),t}function _classPrivateFieldGet$9(r,e){return r.get(_assertClassBrand$d(r,e))}function _assertClassBrand$d(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap;class StateManager{constructor(){_classPrivateFieldInitSpec$9(this,_sourceSettings,new SourceSettings),_classPrivateFieldInitSpec$9(this,_headersTree,new HeadersTree(_classPrivateFieldGet$9(_sourceSettings,this))),_classPrivateFieldInitSpec$9(this,_stateMatrix,[[]])}setState(e){_classPrivateFieldGet$9(_sourceSettings,this).setData(e);let t=!1;try{_classPrivateFieldGet$9(_headersTree,this).buildTree()}catch{_classPrivateFieldGet$9(_headersTree,this).clear(),_classPrivateFieldGet$9(_sourceSettings,this).clear(),t=!0}return _classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots())),t}setColumnsLimit(e){_classPrivateFieldGet$9(_sourceSettings,this).setColumnsLimit(e)}mergeStateWith(e){const t=arrayMap(e,n=>{let{row:s,...o}=n;return{row:s<0?this.rowCoordsToLevel(s):s,...o}});_classPrivateFieldGet$9(_sourceSettings,this).mergeWith(t),_classPrivateFieldGet$9(_headersTree,this).buildTree(),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))}mapState(e){_classPrivateFieldGet$9(_sourceSettings,this).map(e),_classPrivateFieldGet$9(_headersTree,this).buildTree(),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))}mapNodes(e){return arrayReduce(_classPrivateFieldGet$9(_headersTree,this).getRoots(),(t,n)=>(n.walkDown(s=>{const o=e(s.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const s=_classPrivateFieldGet$9(_headersTree,this).getNode(t,n);let o;return s&&(o=triggerNodeModification(e,s,n),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(s=_classPrivateFieldGet$9(_stateMatrix,this)[e])===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?{...n.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=_classPrivateFieldGet$9(_headersTree,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const s=n-e+1;let o=!1,a=null;for(let l=e;l<=n;l++){const u=_classPrivateFieldGet$9(_headersTree,this).getRootByColumn(l);if(!u)break;o=!0,u.walkDown(c=>{const{columnIndex:d,headerLevel:f,origColspan:C,isHidden:m}=c.data;m||C<=s&&d>=e&&d+C-1<=n&&(a===null||f<a)&&(a=f)},TRAVERSAL_DF_PRE)}return o&&a===null?-1:this.levelToRowCoords((t=a)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:s}=(n=this.getHeaderSettings(e,t))!==null&&n!==void 0?n:{isRoot:!0};if(s)return t;let o=t-1;for(;o>=0;){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o-=1}return o}findRightMostColumnIndex(e,t){var n;const{isRoot:s,origColspan:o}=(n=this.getHeaderSettings(e,t))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(s)return t+o-1;let a=t+1;for(;a<this.getColumnsCount();){var l;const{isRoot:u}=(l=this.getHeaderSettings(e,a))!==null&&l!==void 0?l:{isRoot:!0};if(u)break;a+=1}return a-1}getLayersCount(){return _classPrivateFieldGet$9(_sourceSettings,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet$9(_sourceSettings,this).getColumnsCount()}clear(){_classPrivateFieldSet$7(_stateMatrix,this,[]),_classPrivateFieldGet$9(_sourceSettings,this).clear(),_classPrivateFieldGet$9(_headersTree,this).clear()}}function _defineProperty$o(r,e,t){return(e=_toPropertyKey$o(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$o(r){var e=_toPrimitive$o(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$o(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class GhostTable{constructor(e,t){_defineProperty$o(this,"hot",void 0),_defineProperty$o(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$o(this,"layersCount",0),_defineProperty$o(this,"container",void 0),_defineProperty$o(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let n=0;n<t;n++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=n.getRenderableIndexesLength();for(let u=0;u<this.layersCount;u++){const c=t.createElement("tr");for(let d=0;d<l;d++){let f=n.getVisualFromRenderableIndex(d);f===null&&(f=d);const C=t.createElement("th"),m=this.nestedHeaderSettingsGetter(u,f);if(m&&(!m.isPlaceholder||m.isHidden)){let E=m.label;a&&(E+='<button class="changeType"></button>'),fastInnerHTML(C,E),C.colSpan=m.colspan,c.appendChild(C)}}o.appendChild(c)}s.appendChild(o),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function _classPrivateMethodInitSpec$9(r,e){_checkPrivateRedeclaration$c(r,e),e.add(r)}function _defineProperty$n(r,e,t){return(e=_toPropertyKey$n(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$n(r){var e=_toPrimitive$n(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$n(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldInitSpec$8(r,e,t){_checkPrivateRedeclaration$c(r,e),e.set(r,t)}function _checkPrivateRedeclaration$c(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$6(r,e,t){return r.set(_assertClassBrand$c(r,e),t),t}function _classPrivateFieldGet$8(r,e){return r.get(_assertClassBrand$c(r,e))}function _assertClassBrand$c(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$7="nestedHeaders",PLUGIN_PRIORITY$6=280;var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_recentlyHighlightCoords=new WeakMap,_NestedHeaders_brand=new WeakSet;class NestedHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$9(this,_NestedHeaders_brand),_classPrivateFieldInitSpec$8(this,_stateManager,new StateManager),_classPrivateFieldInitSpec$8(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec$8(this,_focusInitialCoords,null),_classPrivateFieldInitSpec$8(this,_isColumnsSelectionInProgress,!1),_classPrivateFieldInitSpec$8(this,_recentlyHighlightCoords,null),_defineProperty$n(this,"ghostTable",new GhostTable(this.hot,(e,t)=>this.getHeaderSettings(e,t))),_defineProperty$n(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$6}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$7]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&warn$1(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_onInit).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterLoadData).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseDown$1).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterOnCellMouseDown).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseOver).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseUp).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeSelectionHighlightSet).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyTransformStart).call(e,...s)}),this.addHook("afterSelection",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeViewportScrollHorizontally).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",n=>_assertClassBrand$c(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyColWidth$1).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyColumnHeaderValue).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeHighlightingColumnHeader).call(e,...s)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeCopy).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeSelectColumns).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterViewportColumnCalculatorOverride).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyFocusedElement).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_classPrivateFieldGet$8(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$8(_stateManager,this).setState(e)),this.detectedOverlappedHeaders&&warn$1(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,n)=>{const s=t===!0?"hide-column":"show-column";_classPrivateFieldGet$8(_stateManager,this).triggerColumnModification(s,n)}),!_classPrivateFieldGet$8(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet$6(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(n=>{let{op:s,index:o,newValue:a}=n;if(s==="replace"){const l=a===!0?"hide-column":"show-column";_classPrivateFieldGet$8(_stateManager,this).triggerColumnModification(l,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_classPrivateFieldGet$8(_stateManager,this).clear(),_classPrivateFieldGet$8(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$6(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet$8(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet$8(_stateManager,this).getLayersCount()}getHeaderSettings(e,t){return _classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<t;a++){const l=n.childNodes[a];if(!l)break;const u=s.childNodes[a],c=o?o.childNodes[a]:null;for(let d=0,f=l.childNodes.length;d<f;d++)l.childNodes[d].removeAttribute("colspan"),removeClass$1(l.childNodes[d],"hiddenHeader"),u&&u.childNodes[d]&&(u.childNodes[d].removeAttribute("colspan"),removeClass$1(u.childNodes[d],"hiddenHeader")),o&&c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),removeClass$1(c.childNodes[d],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,o)=>{var a;const{columnIndexMapper:l,view:u}=this.hot;let c=l.getVisualFromRenderableIndex(s);c===null&&(c=s),o.removeAttribute("colspan"),removeClass$1(o,"hiddenHeader");const{colspan:d,isHidden:f,isPlaceholder:C,headerClassNames:m}=(a=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,c))!==null&&a!==void 0?a:{label:""};if(C||f)addClass$1(o,"hiddenHeader");else if(d>1){var E,v;const{wtOverlays:_}=u._wt,T=(E=_.topInlineStartCornerOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(o),R=(v=_.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o),O=T||R?Math.min(d,n-s):d;O>1&&o.setAttribute("colspan",O)}if(this.hot.view.appendColHeader(c,o,function(){return t.getColumnHeaderValue(...arguments)},e),!C&&!f){const _=o.querySelector("div.relative");_&&m&&m.length>0&&(removeClass$1(_,this.hot.getColumnMeta(c).headerClassName),addClass$1(_,m))}}}getColumnHeaderValue(e,t){var n;const{isHidden:s,isPlaceholder:o}=(n=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(t,e))!==null&&n!==void 0?n:{};return o||s?"":this.hot.getColHeader(e,t)}destroy(){_classPrivateFieldSet$6(_stateManager,this,null),_classPrivateFieldGet$8(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet$8(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$6(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(e.row,e.col)}}function _updateFocusHighlightPosition(){var r;const e=(r=this.hot)===null||r===void 0?void 0:r.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const s=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(t.row,t.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}}function _onBeforeViewportScrollHorizontally(r,e){var t;const n=this.hot.getSelectedRangeLast();if(!n)return r;const{highlight:s}=n,{navigableHeaders:o}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),l=o?s.row:(t=_classPrivateFieldGet$8(_recentlyHighlightCoords,this))===null||t===void 0?void 0:t.row,u=a?r:s.col,c=l<0&&u>=0;if(_classPrivateFieldSet$6(_recentlyHighlightCoords,this,null),!c)return r;const d=this.hot.getFirstFullyVisibleColumn(),f=this.hot.getLastFullyVisibleColumn(),C=f-d+1,m=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(l,u),E=_classPrivateFieldGet$8(_stateManager,this).findRightMostColumnIndex(l,u),v=E-m+1;if(m<d&&E>f)return m;if(a){let _=null;return m>=d&&E>f?v>C?(e.value="start",_=m):(e.value="end",_=E):m<d&&E<=f&&(v>C?(e.value="end",_=E):(e.value="start",_=m)),_}return m<=d?m:E}function _onBeforeHighlightingColumnHeader(r,e,t){const n=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(e,r);if(!n)return r;const{columnCursor:s,selectionType:o,selectionWidth:a}=t,{isRoot:l,colspan:u}=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,r);if(o===HEADER_TYPE){if(!l)return n.columnIndex}else if(o===ACTIVE_HEADER_TYPE&&(u>a-s||!l))return null;return r}function _onBeforeCopy(r,e,t){let{columnHeadersCount:n}=t;if(n!==0)for(let o=0;o<e.length;o++){const{startRow:a,startCol:l,endRow:u,endCol:c}=e[o],d=u-a+1,f=l-c+1;if(a>=0||f===1)break;for(let C=l;C<=c;C++)for(let m=a;m<=u;m++){var s;const E=d+m,v=C-l;if(v===0)continue;((s=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(m,C))===null||s===void 0?void 0:s.isRoot)===!1&&(r[E][v]="")}}}function _onBeforeOnCellMouseDown$1(r,e,t,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function _onAfterOnCellMouseDown(r,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;_classPrivateFieldSet$6(_focusInitialCoords,this,e.clone()),_classPrivateFieldSet$6(_isColumnsSelectionInProgress,this,!0);const{selection:n}=this.hot,s=n.isSelected()?n.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:l}=t,u=!n.inInSelection(e);r.shiftKey&&s?e.col<s.from.col?o.push(s.getTopEndCorner().col,a,e.row):e.col>s.from.col?o.push(s.getTopStartCorner().col,a+l-1,e.row):o.push(a,a+l-1,e.row):(isLeftClick(r)||isRightClick(r)&&u||isTouchEvent(r))&&o.push(a,a+l-1,e.row),n.selectColumns(...o)}function _onBeforeOnCellMouseOver(r,e,t,n){if(!this.hot.view.isMouseDown()||n.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:o,origColspan:a}=s,l=this.hot.getSelectedRangeLast(),u=l.getTopStartCorner(),c=l.getBottomEndCorner(),{from:d}=l;n.column=!0,n.cell=!0;const f=[],C=clamp(e.row,-1/0,-1);e.col<d.col?f.push(c.col,o,C):e.col>d.col?f.push(u.col,o+a-1,C):f.push(o,o+a-1,C),this.hot.selection.selectColumns(...f)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet$6(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet(){const{navigableHeaders:r}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet$8(_isColumnsSelectionInProgress,this)||!r)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:s,origColspan:o}=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet$8(_focusInitialCoords,this).row,_classPrivateFieldGet$8(_focusInitialCoords,this).col);if(e.setHighlight(_classPrivateFieldGet$8(_focusInitialCoords,this)),o>e.getWidth()||s<t||s+o-1>n){const a=_classPrivateFieldGet$8(_stateManager,this).findTopMostEntireHeaderLevel(clamp(t,s,s+o-1),clamp(n,s,s+o-1));e.highlight.row=a,e.highlight.col=e.from.col}}function _onModifyTransformStart(r){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+r.row,e.col+r.col);if(!(t.isHeader()&&t.col>=0))return;const s=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(t.row,t.col),o=_classPrivateFieldGet$8(_stateManager,this).findRightMostColumnIndex(t.row,t.col);if(r.col<0){const a=e.col>=s&&e.col<=o?s-1:o,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);l===null?r.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,e.col)-1,1)}else if(r.col>0){const a=e.col>=s&&e.col<=o?o+1:s,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);l===null?r.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,l)-1,1)}}function _onBeforeSelectColumns(r,e,t){const n=r.row,s=this._getHeaderTreeNodeDataByCoords({row:n,col:r.col}),o=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});_classPrivateFieldSet$6(_recentlyHighlightCoords,this,t.clone()),e.col<r.col?(s&&(r.col=s.columnIndex+s.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=r.col&&(s&&(r.col=s.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function _onAfterGetColumnHeaderRenderers(r){r.length=0;for(let e=0;e<_classPrivateFieldGet$8(_stateManager,this).getLayersCount();e++)r.push(this.headerRendererFactory(e))}function _onAfterViewportColumnCalculatorOverride(r){const e=_classPrivateFieldGet$8(_stateManager,this).getLayersCount();let t=r.startColumn,n=!!e;for(let s=0;s<e;s++){const o=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(s,r.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(n=!1),isNumeric(a)&&a<r.startColumn){t=a;break}}r.startColumn=n?_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(0,t).columnIndex:t}function _onModifyColWidth$1(r,e){const t=this.ghostTable.getWidth(e);return r>t?r:t}function _onModifyColumnHeaderValue(r,e,t){var n;const{label:s}=(n=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(t,e))!==null&&n!==void 0?n:{label:""};return s}function _onModifyFocusedElement(r,e){if(r<0)return this.hot.getCell(r,_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(r,e),!0)}function _onInit(){this.updatePlugin()}function _onAfterLoadData(r,e){e||this.updatePlugin()}function _defineProperty$m(r,e,t){return(e=_toPropertyKey$m(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$m(r){var e=_toPrimitive$m(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$m(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataManager{constructor(e,t){_defineProperty$m(this,"hot",void 0),_defineProperty$m(this,"data",null),_defineProperty$m(this,"plugin",void 0),_defineProperty$m(this,"parentReference",new WeakMap),_defineProperty$m(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&arrayEach(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,n,s){let o=!1,a=t;if(isNaN(a)&&a.end)return a;let l=e;return l||(l={__children:this.data},o=!0,a-=1),n!=null&&a===n?{result:l,end:!0}:s!=null&&l===s?{result:a,end:!0}:(a+=1,l.__children&&arrayEach(l.__children,u=>{if(this.parentReference.set(u,o?null:l),a=this.readTreeNodes(u,a,n,s),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return objectEach(this.data[0],(t,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(arrayEach(n.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var n;return((n=e.__children)===null||n===void 0?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((t=n.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();const a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let s=n,o;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){const l=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);s=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),s=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(s,o+1,null);break;case"above":this.addChildAtIndex(s,o,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const s=[];Array.isArray(e)?(rangeEach(e[0],e[2],C=>{const m=this.translateTrimmedRow(C);s.push(this.getDataObject(m))}),rangeEach(0,s.length-2,C=>{this.detachFromParent(s[C],!1)}),n=s[s.length-1]):n=e;const o=this.getRowIndex(n),a=this.countChildren(n),l=this.getRowIndexWithinParent(n),u=this.getRowParent(n),c=this.getRowParent(u),d=this.getRowIndex(c);let f=null;if(this.hot.runHooks("beforeDetachChild",u,n),l!=null){const C=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,C,this.plugin.pluginName),u.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,C,this.plugin.pluginName),c){f=d+this.countChildren(c);const m=this.getChild(c,this.countChildren(c)-1),E=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",E+1,a+1,this.plugin.pluginName),c.__children.push(n)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const s=[];arrayEach(n,o=>{s.push(this.getDataObject(o))}),arrayEach(s,o=>{const a=this.getRowIndexWithinParent(o),l=this.getRowParent(o);l===null?this.data.splice(a,1):l.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,t,n){const s=this.getDataObject(e-1);let o=null,a=e;s&&s.__children&&s.__children.length===0?(o=s,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?n?o.__children.splice(a,t,...n):o.__children.splice(a,t):n?this.data.splice(a,t,...n):this.data.splice(a,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do n=this.getRowParent(n),n!==null&&(t=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,s){const o=t===this.hot.countRows(),a=this.getRowParent(e),l=this.getRowIndexWithinParent(e),u=a.__children.slice(l,l+1),c=e>t;let d=o?this.getRowParent(t-1):this.getRowParent(t);d==null&&(d=this.getRowParent(t-1)),d==null&&(d=this.getDataObject(t-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(t),d.__children=[]);const f=o||n||s?d.__children.length:this.getRowIndexWithinParent(t),C=a===d;d.__children.splice(f,0,u[0]),a.__children.splice(l+(c&&C?1:0),1),this.syncRowWithRawSource(a),C||this.syncRowWithRawSource(d)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function _defineProperty$l(r,e,t){return(e=_toPropertyKey$l(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$l(r){var e=_toPrimitive$l(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$l(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseUI{constructor(e,t){_defineProperty$l(this,"hot",void 0),_defineProperty$l(this,"plugin",void 0),this.hot=t,this.plugin=e}}class HeadersUI extends BaseUI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(n),o=this.dataManager.getDataObject(n),a=t.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),u=a.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(arrayEach(u,d=>{d&&a.removeChild(d)}),addClass$1(t,HeadersUI.CSS_CLASSES.indicatorContainer),s){const{rootDocument:d}=this.hot,f=l.cloneNode(!0);a.innerHTML="",rangeEach(0,s-1,()=>{const C=d.createElement("SPAN");addClass$1(C,HeadersUI.CSS_CLASSES.emptyIndicator),a.appendChild(C)}),a.appendChild(f)}if(this.dataManager.hasChildren(o)){const d=this.hot.rootDocument.createElement("DIV");c&&setAttribute(d,[A11Y_HIDDEN()]),addClass$1(t,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(addClass$1(d,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),c&&setAttribute(t,[A11Y_EXPANDED(!1)])):(addClass$1(d,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),c&&setAttribute(t,[A11Y_EXPANDED(!0)])),a.appendChild(d)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let s=11;n.isClassicTheme()||(s=n.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*t+25),this.hot.render()}}class CollapsingUI extends BaseUI{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,s)},shiftStash:function(s,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),arrayEach(n.lastCollapsedRows,(l,u)=>{l>=s&&l<o&&(n.lastCollapsedRows[u]=l+a)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,s),n.lastCollapsedRows=void 0},trimStash:(s,o)=>{rangeEach(s,s+o-1,a=>{const l=this.lastCollapsedRows.indexOf(a);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,a=null,l=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{s.push(this.dataManager.getRowIndex(u))}),l=this.collapseRows(s,!0,!1),n&&this.trimRows(l),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),l}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];arrayEach(e,o=>{s.push(...this.collapseChildren(o,!1,!1))}),n&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return arrayEach(e,o=>{s.push(o),t&&this.collapseChildRows(o,s)}),n&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);arrayEach(s.__children,o=>{const a=this.dataManager.getRowIndex(o);t.push(a),this.collapseChildRows(a,t)})}n&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return arrayEach(e,o=>{s.push(o),t&&this.expandChildRows(o,s)}),n&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);arrayEach(s.__children,o=>{if(!this.isAnyParentCollapsed(o)){const a=this.dataManager.getRowIndex(o);t.push(a),this.expandChildRows(a,t)}})}n&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,a=null,l=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{const c=this.dataManager.getRowIndex(u);s.push(c)}),l=this.expandRows(s,!0,!1),n&&this.untrimRows(l),t&&this.renderAndAdjust(),l}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];arrayEach(e,o=>{s.push(...this.expandChildren(o,!1,!1))}),n&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&arrayEach(t.__children,s=>{const o=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return n=!1,!1}),n}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);hasClass$1(e.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),stopImmediatePropagation(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function _classPrivateFieldInitSpec$7(r,e,t){_checkPrivateRedeclaration$b(r,e),e.set(r,t)}function _checkPrivateRedeclaration$b(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$k(r,e,t){return(e=_toPropertyKey$k(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$k(r){var e=_toPrimitive$k(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$k(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$7(r,e){return r.get(_assertClassBrand$b(r,e))}function _assertClassBrand$b(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap;class ContextMenuUI extends BaseUI{constructor(){super(...arguments),_defineProperty$k(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec$7(this,_menuEntries,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(n);this.dataManager.addChild(s)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(s)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,n=>{if(n===0)return arrayEach(t,(s,o)=>{e.items.splice(n+o,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return rangeEach(0,e.items.length-1,t=>{const n=_classPrivateFieldGet$7(_menuEntries,this)[e.items[t].key];n!=null&&(e.items[t].callback=n)}),e}}function _defineProperty$j(r,e,t){return(e=_toPropertyKey$j(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$j(r){var e=_toPrimitive$j(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$j(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowMoveController{constructor(e){_defineProperty$j(this,"plugin",void 0),_defineProperty$j(this,"hot",void 0),_defineProperty$j(this,"dataManager",void 0),_defineProperty$j(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:s}))return!1;this.movedToCollapsed=!1;const a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let u=!0;const c=e.map(E=>{if(!u)return!1;const v=this.dataManager.translateTrimmedRow(E);return u=this.shouldAllowMoving(v,l),v}),d=c.indexOf(l)===-1;if(!u||!d)return!1;const f=this.getBaseParent(c),C=this.getTargetParent(a,l),m=f===C;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(C),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,l,m),this.moveRows(c,l,C),this.dataManager.rewriteCache(),this.moveCellsMeta(c,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:s,movePossible:o}=e;let a=!1;return isUndefined$1(s)&&(warn$1(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,s,o,!1),a=!0),a}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return n==null&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const s=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){const n=[],s=Math.max(...e)<t;e.forEach(o=>{n.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let s=0,o=0,a=null,l=null;if(this.movedToCollapsed){let u=null;e[n-1]<t?u=this.dataManager.translateTrimmedRow(t-n):u=this.dataManager.translateTrimmedRow(t);const c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),d=this.dataManager.getRowIndex(c);s=this.dataManager.untranslateTrimmedRow(d),o=s}else e[n-1]<t?(o=t-1,s=o-n+1):(s=t,o=s+n-1);a=this.hot.selection,l=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(s,0)),a.setRangeEnd(this.hot._createCellCoords(o,l),!0)}isRowOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}}function _classPrivateMethodInitSpec$8(r,e){_checkPrivateRedeclaration$a(r,e),e.add(r)}function _classPrivateFieldInitSpec$6(r,e,t){_checkPrivateRedeclaration$a(r,e),e.set(r,t)}function _checkPrivateRedeclaration$a(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$i(r,e,t){return(e=_toPropertyKey$i(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$i(r){var e=_toPrimitive$i(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$i(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$6(r,e){return r.get(_assertClassBrand$a(r,e))}function _classPrivateFieldSet$5(r,e,t){return r.set(_assertClassBrand$a(r,e),t),t}function _assertClassBrand$a(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$6="nestedRows",PLUGIN_PRIORITY$5=300,SHORTCUTS_GROUP$1=PLUGIN_KEY$6,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet;class NestedRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$8(this,_NestedRows_brand),_defineProperty$i(this,"dataManager",null),_defineProperty$i(this,"headersUI",null),_defineProperty$i(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec$6(this,_skipRender,!1),_classPrivateFieldInitSpec$6(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$5}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$6]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager(this,this.hot),this.collapsingUI=new CollapsingUI(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new ContextMenuUI(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterInit).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeViewRender).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onFilterData).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterContextMenuDefaultOptions).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterGetRowHeader).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeOnCellMouseDown).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeRemoveRow).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterRemoveRow).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeAddChild).call(e,...n)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterAddChild).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeDetachChild).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterDetachChild).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onModifyRowHeaderWidth).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterCreateRow).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeRowMove).call(e,...n)}),this.addHook("beforeLoadData",t=>_assertClassBrand$a(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.addHook("beforeUpdateData",t=>_assertClassBrand$a(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:SHORTCUTS_GROUP$1,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$1)}disableCoreAPIModifiers(){_classPrivateFieldSet$5(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet$5(_skipCoreAPIModifiers,this,!1)}onModifyRowData(e){if(!_classPrivateFieldGet$6(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_classPrivateFieldGet$6(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return _classPrivateFieldGet$6(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function _onBeforeRowMove(r,e,t,n){return this.rowMoveController.onBeforeRowMove(r,e,t,n)}function _onBeforeOnCellMouseDown(r,e,t){this.collapsingUI.toggleState(r,e,t)}function _onFilterData(r,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(r,e,t),_classPrivateFieldSet$5(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions(r){return this.contextMenuUI.appendOptions(r)}function _onAfterGetRowHeader(r,e){this.headersUI.appendLevelIndicators(r,e)}function _onModifyRowHeaderWidth(r){return Math.max(this.headersUI.rowHeaderWidthCache,r)}function _onAfterRemoveRow(r,e,t,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet$5(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow(r,e,t){const n=Array.from(t.reduce((s,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return s.add(o),Array.isArray(a)&&a.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(o)},new Set));t.length=0,t.push(...n)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(r,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild(r,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow(){this.dataManager.rewriteCache()}function _onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(r,e){_classPrivateFieldGet$6(_skipRender,this)&&(e.skipRender=!0)}function _onBeforeLoadData(r){if(!isArrayOfObjects(r)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$6]=!1,this.disablePlugin();return}this.dataManager.setData(r),this.dataManager.rewriteCache()}function _defineProperty$h(r,e,t){return(e=_toPropertyKey$h(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$h(r){var e=_toPrimitive$h(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$h(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Storage{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty$h(this,"rootWindow",void 0),_defineProperty$h(this,"prefix",void 0),_defineProperty$h(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=typeof e>"u"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){arrayEach(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function _defineProperty$g(r,e,t){return(e=_toPropertyKey$g(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$g(r){var e=_toPrimitive$g(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$g(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}Hooks.getSingleton().register("persistentStateSave");Hooks.getSingleton().register("persistentStateLoad");Hooks.getSingleton().register("persistentStateReset");const PLUGIN_KEY$5="persistentState",PLUGIN_PRIORITY$4=0;class PersistentState extends BasePlugin{constructor(){super(...arguments),_defineProperty$g(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$4}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$5]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Storage(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function _classPrivateMethodInitSpec$7(r,e){_checkPrivateRedeclaration$9(r,e),e.add(r)}function _checkPrivateRedeclaration$9(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$f(r,e,t){return(e=_toPropertyKey$f(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$f(r){var e=_toPrimitive$f(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$f(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$9(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$4="search",PLUGIN_PRIORITY$3=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(r,e,t,n,s){r.getCellMeta(e,t).isSearchResult=s},DEFAULT_QUERY_METHOD=function(r,e,t){return isUndefined$1(r)||r===null||!r.toLocaleLowerCase||r.length===0||isUndefined$1(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(r.toLocaleLowerCase(t.locale))!==-1};var _Search_brand=new WeakSet;class Search extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$7(this,_Search_brand),_defineProperty$f(this,"callback",DEFAULT_CALLBACK),_defineProperty$f(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty$f(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY$4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$3}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$4]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$4];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$9(_Search_brand,e,_onBeforeRenderer).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$9(_Search_brand,e,_onBeforeRenderer).call(e,...s)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),o=this.hot.countCols(),a=[],l=this.hot;return rangeEach(0,s-1,u=>{rangeEach(0,o-1,c=>{const d=this.hot.getDataAtCell(u,c),f=this.hot.getCellMeta(u,c),C=f.search.callback||t,E=(f.search.queryMethod||n)(e,d,f);if(E){const v={row:u,col:c,data:d};a.push(v)}C&&C(l,u,c,d,E)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){isObject$1(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _onBeforeRenderer(r,e,t,n,s,o){const a=o.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}function _defineProperty$e(r,e,t){return(e=_toPropertyKey$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$e(r){var e=_toPrimitive$e(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$e(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class StretchStrategy{constructor(e){_defineProperty$e(this,"viewportWidth",void 0),_defineProperty$e(this,"overwriteColumnWidthFn",void 0),_defineProperty$e(this,"baseWidths",new Map),_defineProperty$e(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class StretchAllStrategy extends StretchStrategy{calculate(){const e=Array.from(this.baseWidths).reduce((f,C)=>{let[,m]=C;return f+m},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,s=[],o=[];let a=this.viewportWidth,l=0;if(this.baseWidths.forEach((f,C)=>{const m=Math.round(f*n),E=this.overwriteColumnWidthFn(m,C);m===E&&m>=DEFAULT_WIDTH?(s.push([C,E]),l+=E):m!==E&&(s.push([C,E]),o.push(C),a-=E)}),a<=DEFAULT_WIDTH){this.stretchedWidths.clear();return}const u=a/l;let c=-1,d=0;s.forEach((f,C)=>{let[m,E]=f,v=E;o.includes(m)||(v=Math.round(E*u)),this.stretchedWidths.set(m,v),c=m,C<s.length-1&&(d+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-d))}}function _classPrivateFieldInitSpec$5(r,e,t){_checkPrivateRedeclaration$8(r,e),e.set(r,t)}function _checkPrivateRedeclaration$8(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$5(r,e){return r.get(_assertClassBrand$8(r,e))}function _classPrivateFieldSet$4(r,e,t){return r.set(_assertClassBrand$8(r,e),t),t}function _assertClassBrand$8(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _lastColumnWidth=new WeakMap,_lastColumnIndex=new WeakMap;class StretchLastStrategy extends StretchStrategy{constructor(){super(...arguments),_classPrivateFieldInitSpec$5(this,_lastColumnWidth,0),_classPrivateFieldInitSpec$5(this,_lastColumnIndex,-1)}prepare(e){super.prepare(e),_classPrivateFieldSet$4(_lastColumnWidth,this,0),_classPrivateFieldSet$4(_lastColumnIndex,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),_classPrivateFieldSet$4(_lastColumnIndex,this,e),_classPrivateFieldSet$4(_lastColumnWidth,this,t)}calculate(){if(_classPrivateFieldGet$5(_lastColumnIndex,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,s)=>{let[,o]=s;return n+o},0),t=Math.max(this.viewportWidth-e+_classPrivateFieldGet$5(_lastColumnWidth,this),0);this.stretchedWidths.set(_classPrivateFieldGet$5(_lastColumnIndex,this),t)}}function _classPrivateMethodInitSpec$6(r,e){_checkPrivateRedeclaration$7(r,e),e.add(r)}function _classPrivateFieldInitSpec$4(r,e,t){_checkPrivateRedeclaration$7(r,e),e.set(r,t)}function _checkPrivateRedeclaration$7(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$4(r,e){return r.get(_assertClassBrand$7(r,e))}function _classPrivateFieldSet$3(r,e,t){return r.set(_assertClassBrand$7(r,e),t),t}function _assertClassBrand$7(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const STRETCH_WIDTH_MAP_NAME="stretchColumns";var _hot$1=new WeakMap,_widthsMap=new WeakMap,_stretchStrategies=new WeakMap,_activeStrategy=new WeakMap,_StretchCalculator_brand=new WeakSet;class StretchCalculator{constructor(e){_classPrivateMethodInitSpec$6(this,_StretchCalculator_brand),_classPrivateFieldInitSpec$4(this,_hot$1,void 0),_classPrivateFieldInitSpec$4(this,_widthsMap,void 0),_classPrivateFieldInitSpec$4(this,_stretchStrategies,new Map([["all",new StretchAllStrategy(_assertClassBrand$7(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))],["last",new StretchLastStrategy(_assertClassBrand$7(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))]])),_classPrivateFieldInitSpec$4(this,_activeStrategy,"none"),_classPrivateFieldSet$3(_hot$1,this,e),_classPrivateFieldSet$3(_widthsMap,this,_classPrivateFieldGet$4(_hot$1,this).columnIndexMapper.createAndRegisterIndexMap(STRETCH_WIDTH_MAP_NAME,"physicalIndexToValue"))}useStrategy(e){_classPrivateFieldSet$3(_activeStrategy,this,_classPrivateFieldGet$4(_stretchStrategies,this).has(e)?e:"none")}refreshStretching(){if(_classPrivateFieldGet$4(_activeStrategy,this)==="none"){_classPrivateFieldGet$4(_widthsMap,this).clear();return}_classPrivateFieldGet$4(_hot$1,this).batchExecution(()=>{_classPrivateFieldGet$4(_widthsMap,this).clear();const e=_classPrivateFieldGet$4(_stretchStrategies,this).get(_classPrivateFieldGet$4(_activeStrategy,this));let n=_classPrivateFieldGet$4(_hot$1,this).view.getViewportWidth();_assertClassBrand$7(_StretchCalculator_brand,this,_willVerticalScrollAppear).call(this)&&(n-=getScrollbarWidth(_classPrivateFieldGet$4(_hot$1,this).rootDocument)),e.prepare({viewportWidth:n});for(let s=0;s<_classPrivateFieldGet$4(_hot$1,this).countCols();s++)_classPrivateFieldGet$4(_hot$1,this).columnIndexMapper.isHidden(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,_assertClassBrand$7(_StretchCalculator_brand,this,_getWidthWithoutStretching).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[o,a]=s;_classPrivateFieldGet$4(_widthsMap,this).setValueAtIndex(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(o),a)})},!0)}getStretchedWidth(e){return _classPrivateFieldGet$4(_widthsMap,this).getValueAtIndex(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(e))}}function _willVerticalScrollAppear(){const{view:r}=_classPrivateFieldGet$4(_hot$1,this);if(r.isVerticallyScrollableByWindow())return!1;const e=r.getViewportHeight(),t=_classPrivateFieldGet$4(_hot$1,this).countRows(),n=r.getStylesHandler().getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<t;l++){var a;if(s+=((a=_classPrivateFieldGet$4(_hot$1,this).getRowHeight(l))!==null&&a!==void 0?a:n)+(l===0?1:0),s>e){o=!0;break}}return o}function _getWidthWithoutStretching(r){var e;return(e=_classPrivateFieldGet$4(_hot$1,this).getColWidth(r,"StretchColumns"))!==null&&e!==void 0?e:DEFAULT_WIDTH}function _overwriteColumnWidthFn(r,e){return _classPrivateFieldGet$4(_hot$1,this).runHooks("beforeStretchingColumnWidth",r,e)}function _classPrivateMethodInitSpec$5(r,e){_checkPrivateRedeclaration$6(r,e),e.add(r)}function _classPrivateFieldInitSpec$3(r,e,t){_checkPrivateRedeclaration$6(r,e),e.set(r,t)}function _checkPrivateRedeclaration$6(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$2(r,e,t){return r.set(_assertClassBrand$6(r,e),t),t}function _classPrivateFieldGet$3(r,e){return r.get(_assertClassBrand$6(r,e))}function _assertClassBrand$6(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$3="stretchColumns",PLUGIN_PRIORITY$2=155;var _stretchCalculator=new WeakMap,_previousTableWidth=new WeakMap,_resizeObserver=new WeakMap,_StretchColumns_brand=new WeakSet;class StretchColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$5(this,_StretchColumns_brand),_classPrivateFieldInitSpec$3(this,_stretchCalculator,new StretchCalculator(this.hot)),_classPrivateFieldInitSpec$3(this,_previousTableWidth,null),_classPrivateFieldInitSpec$3(this,_resizeObserver,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;(t=this.hot)!==null&&t!==void 0&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:s}=n;_classPrivateFieldGet$3(_previousTableWidth,this)!==null&&_classPrivateFieldGet$3(_previousTableWidth,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),_classPrivateFieldSet$2(_previousTableWidth,this,s.width)})})}))}static get PLUGIN_KEY(){return PLUGIN_KEY$3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$2}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$3(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),_classPrivateFieldGet$3(_resizeObserver,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$6(_StretchColumns_brand,e,_onBeforeRender).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$6(_StretchColumns_brand,e,_onModifyColWidth).call(e,...n)},10),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$3(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_classPrivateFieldGet$3(_resizeObserver,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return _classPrivateFieldGet$3(_stretchCalculator,this).getStretchedWidth(e)}destroy(){_classPrivateFieldGet$3(_resizeObserver,this).disconnect(),_classPrivateFieldSet$2(_resizeObserver,this,null),_classPrivateFieldSet$2(_stretchCalculator,this,null),super.destroy()}}function _onModifyColWidth(r,e,t){if(t===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:r}function _onBeforeRender(r){r&&_classPrivateFieldGet$3(_stretchCalculator,this).refreshStretching()}function _classPrivateMethodInitSpec$4(r,e){_checkPrivateRedeclaration$5(r,e),e.add(r)}function _checkPrivateRedeclaration$5(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$d(r,e,t){return(e=_toPropertyKey$d(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$d(r){var e=_toPrimitive$d(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$d(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$5(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$2="touchScroll",PLUGIN_PRIORITY$1=200;var _TouchScroll_brand=new WeakSet;class TouchScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$4(this,_TouchScroll_brand),_defineProperty$d(this,"scrollbars",[]),_defineProperty$d(this,"clones",[]),_defineProperty$d(this,"lockedCollection",!1),_defineProperty$d(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$1}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}}function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:r,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(r),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),n&&this.scrollbars.push(n),s&&s.clone&&this.scrollbars.push(s),this.clones=[],r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach(this.clones,r=>{addClass$1(r,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach(this.clones,r=>{removeClass$1(r,"hide-tween"),addClass$1(r,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach(this.clones,r=>{removeClass$1(r,"show-tween")})},400),arrayEach(this.scrollbars,r=>{r.refresh(),r.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function _classPrivateMethodInitSpec$3(r,e){_checkPrivateRedeclaration$4(r,e),e.add(r)}function _checkPrivateRedeclaration$4(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$c(r,e,t){return(e=_toPropertyKey$c(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$c(r){var e=_toPrimitive$c(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$c(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$4(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$1="trimRows",PLUGIN_PRIORITY=330;var _TrimRows_brand=new WeakSet;class TrimRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$3(this,_TrimRows_brand),_defineProperty$c(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$1}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand$4(_TrimRows_brand,this,_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,n,n&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let s=t;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;n&&a&&(arrayEach(e,u=>{o[u]=!1}),s=arrayReduce(o,(u,c,d)=>(c&&u.push(d),u),[])),this.hot.runHooks("beforeUntrimRow",t,s,n&&a)!==!1&&(n&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,s,n&&a,n&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<t)}destroy(){super.destroy()}}function _onMapInit(){const r=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(r)&&this.hot.batchExecution(()=>{arrayEach(r,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var es_object_fromEntries={},hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var r=require_export(),e=requireIterate(),t=requireCreateProperty();return r({target:"Object",stat:!0},{fromEntries:function(s){var o={};return e(s,function(a,l){t(o,a,l)},{AS_ENTRIES:!0}),o}}),es_object_fromEntries}requireEs_object_fromEntries();const SHORTCUTS_GROUP="undoRedo",PLUGIN_KEY="undoRedo";function UndoRedo$1(r){const e=this;this.instance=r,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,r.addHook("afterChange",function(n,s){const o=n&&n.length;if(!o||!n.find(u=>{const[,,c,d]=u;return c!==d}))return;const l=()=>{const u=n.reduce((d,f)=>(d.push([...f]),d),[]);arrayEach(u,d=>{d[1]=r.propToCol(d[1])});const c=o>1?this.getSelected():[[u[0][0],u[0][1]]];return new UndoRedo$1.ChangeAction(u,c)};e.done(l,s)}),r.addHook("afterCreateRow",(n,s,o)=>{e.done(()=>new UndoRedo$1.CreateRowAction(n,s),o)});const t=(n,s,o,a)=>{const l=["visualRow","visualCol","row","col","prop"],u=l.length,c=[];return rangeEach(o,a,d=>{rangeEach(n,s,f=>{const C=r.getCellMeta(f,d);if(Object.keys(C).length!==u){const m=Object.fromEntries(Object.entries(C).filter(E=>{let[v]=E;return l.includes(v)===!1}));c.push([C.visualRow,C.visualCol,m])}})}),c};r.addHook("beforeRemoveRow",(n,s,o,a)=>{const l=()=>{const u=r.toPhysicalRow(n),c=u+s-1,d=deepClone(e.instance.getSourceData(u,0,u+s-1,e.instance.countSourceCols()-1));return new UndoRedo$1.RemoveRowAction(u,d,r.getSettings().fixedRowsBottom,r.getSettings().fixedRowsTop,r.rowIndexMapper.getIndexesSequence(),t(u,c,0,r.countCols()-1))};e.done(l,a)}),r.addHook("afterCreateCol",(n,s,o)=>{e.done(()=>new UndoRedo$1.CreateColumnAction(n,s),o)}),r.addHook("beforeRemoveCol",(n,s,o,a)=>{const l=()=>{const u=e.instance.getSourceDataArray(),c=(e.instance.countCols()+n)%e.instance.countCols(),d=c+s-1,f=[],C=[],m=[];rangeEach(u.length-1,_=>{const T=[],R=u[_];rangeEach(c,d,O=>{T.push(R[r.toPhysicalColumn(O)])}),f.push(T)}),rangeEach(s-1,_=>{m.push(r.toPhysicalColumn(c+_))}),Array.isArray(r.getSettings().colHeaders)&&rangeEach(s-1,_=>{C.push(r.getSettings().colHeaders[r.toPhysicalColumn(c+_)]||null)});const E=r.columnIndexMapper.getIndexesSequence(),v=r.rowIndexMapper.getIndexesSequence();return new UndoRedo$1.RemoveColumnAction(c,m,f,C,E,v,r.getSettings().fixedColumnsStart,t(0,r.countRows(),c,d))};e.done(l,a)}),r.addHook("beforeCellAlignment",(n,s,o,a)=>{e.done(()=>new UndoRedo$1.CellAlignmentAction(n,s,o,a))}),r.addHook("beforeFilter",(n,s)=>{e.done(()=>new UndoRedo$1.FiltersAction(n,s))}),r.addHook("beforeRowMove",(n,s)=>{n!==!1&&e.done(()=>new UndoRedo$1.RowMoveAction(n,s))}),r.addHook("beforeColumnMove",(n,s)=>{n!==!1&&e.done(()=>new UndoRedo$1.ColumnMoveAction(n,s))}),r.addHook("beforeMergeCells",(n,s)=>{s||e.done(()=>new UndoRedo$1.MergeCellsAction(r,n))}),r.addHook("afterUnmergeCells",(n,s)=>{s||e.done(()=>new UndoRedo$1.UnmergeCellsAction(r,n))}),r.addHook("beforeColumnSort",(n,s,o)=>{o&&e.done(()=>new UndoRedo$1.ColumnSortAction(n,s))}),r.addHook("afterInit",()=>{e.init()})}UndoRedo$1.prototype.done=function(r,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const o=r(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())};UndoRedo$1.prototype.undo=function(){if(this.isUndoAvailable()){const r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice());const t=deepClone(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};UndoRedo$1.prototype.redo=function(){if(this.isRedoAvailable()){const r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice());const t=deepClone(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};UndoRedo$1.prototype.isUndoAvailable=function(){return this.doneActions.length>0};UndoRedo$1.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};UndoRedo$1.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};UndoRedo$1.prototype.isEnabled=function(){return this.enabled};UndoRedo$1.prototype.enable=function(){if(this.isEnabled())return;const r=this.instance;this.enabled=!0,exposeUndoRedoMethods(r),this.registerShortcuts(),r.addHook("afterChange",onAfterChange)};UndoRedo$1.prototype.disable=function(){if(!this.isEnabled())return;const r=this.instance;this.enabled=!1,removeExposedUndoRedoMethods(r),this.unregisterShortcuts(),r.removeHook("afterChange",onAfterChange)};UndoRedo$1.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};UndoRedo$1.Action=function(){};UndoRedo$1.Action.prototype.undo=function(){};UndoRedo$1.Action.prototype.redo=function(){};UndoRedo$1.ChangeAction=function(r,e){this.changes=r,this.selected=e,this.actionType="change"};inherit(UndoRedo$1.ChangeAction,UndoRedo$1.Action);UndoRedo$1.ChangeAction.prototype.undo=function(r,e){const t=deepClone(this.changes),n=r.countEmptyRows(!0),s=r.countEmptyCols(!0);for(let a=0,l=t.length;a<l;a++)t[a].splice(3,1);r.addHookOnce("afterChange",e),r.setDataAtCell(t,null,null,"UndoRedo.undo");for(let a=0,l=t.length;a<l;a++){const[u,c]=t[a];r.getSettings().minSpareRows&&u+1+r.getSettings().minSpareRows===r.countRows()&&n===r.getSettings().minSpareRows&&(r.alter("remove_row",parseInt(u+1,10),r.getSettings().minSpareRows),r.undoRedo.doneActions.pop()),r.getSettings().minSpareCols&&c+1+r.getSettings().minSpareCols===r.countCols()&&s===r.getSettings().minSpareCols&&(r.alter("remove_col",parseInt(c+1,10),r.getSettings().minSpareCols),r.undoRedo.doneActions.pop())}const o=r.getSelectedLast();if(o!==void 0){const[a,l]=t[0],[u,c]=o,d=r.getFirstFullyVisibleRow(),f=r.getFirstFullyVisibleColumn(),C=a>=d,m=l>=f;if((C&&m)===!1&&(u!==a||c!==l)===!0){const _={row:a,col:l};C===!1&&(_.verticalSnap="top"),m===!1&&(_.horizontalSnap="start"),r.scrollViewportTo(_)}}r.selectCells(this.selected,!1,!1)};UndoRedo$1.ChangeAction.prototype.redo=function(r,e){const t=deepClone(this.changes);for(let n=0,s=t.length;n<s;n++)t[n].splice(2,1);r.addHookOnce("afterChange",e),r.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&r.selectCells(this.selected,!1,!1)};UndoRedo$1.CreateRowAction=function(r,e){this.index=r,this.amount=e,this.actionType="insert_row"};inherit(UndoRedo$1.CreateRowAction,UndoRedo$1.Action);UndoRedo$1.CreateRowAction.prototype.undo=function(r,e){const t=r.countRows(),n=r.getSettings().minSpareRows;this.index>=t&&this.index-n<t&&(this.index-=n),r.addHookOnce("afterRemoveRow",e),r.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};UndoRedo$1.CreateRowAction.prototype.redo=function(r,e){r.addHookOnce("afterCreateRow",e),r.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.RemoveRowAction=function(r,e,t,n,s,o){this.index=r,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=n,this.rowIndexesSequence=s,this.removedCellMetas=o};inherit(UndoRedo$1.RemoveRowAction,UndoRedo$1.Action);UndoRedo$1.RemoveRowAction.prototype.undo=function(r,e){const t=r.getSettings(),n=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);n.push([this.index+o,isNaN(l)?a:l,s[a]])})}),r.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;r.setCellMetaObject(o,a,l)}),r.addHookOnce("afterViewRender",e),r.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),r.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};UndoRedo$1.RemoveRowAction.prototype.redo=function(r,e){r.addHookOnce("afterRemoveRow",e),r.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};UndoRedo$1.CreateColumnAction=function(r,e){this.index=r,this.amount=e,this.actionType="insert_col"};inherit(UndoRedo$1.CreateColumnAction,UndoRedo$1.Action);UndoRedo$1.CreateColumnAction.prototype.undo=function(r,e){r.addHookOnce("afterRemoveCol",e),r.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};UndoRedo$1.CreateColumnAction.prototype.redo=function(r,e){r.addHookOnce("afterCreateCol",e),r.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.RemoveColumnAction=function(r,e,t,n,s,o,a,l){this.index=r,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=n,this.columnPositions=s.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a,this.removedCellMetas=l};inherit(UndoRedo$1.RemoveColumnAction,UndoRedo$1.Action);UndoRedo$1.RemoveColumnAction.prototype.undo=function(r,e){const t=r.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),s=(c,d,f)=>f[this.indexes.indexOf(n[d])],o=this.data.length,a=[];for(let c=0;c<o;c++)a.push(arrayMap(this.data[c],s));const l=arrayMap(this.headers,s),u=[];r.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach(r.getSourceDataArray(),(c,d)=>{arrayEach(n,(f,C)=>{c[f]=a[d][C],u.push([d,f,c[f]])})}),r.setSourceDataAtCell(u,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&arrayEach(l,(c,d)=>{r.getSettings().colHeaders[n[d]]=c}),this.removedCellMetas.forEach(c=>{let[d,f,C]=c;r.setCellMetaObject(d,f,C)}),r.batchExecution(()=>{r.rowIndexMapper.setIndexesSequence(this.rowPositions),r.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.RemoveColumnAction.prototype.redo=function(r,e){r.addHookOnce("afterRemoveCol",e),r.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.CellAlignmentAction=function(r,e,t,n){this.stateBefore=r,this.range=e,this.type=t,this.alignment=n};UndoRedo$1.CellAlignmentAction.prototype.undo=function(r,e){arrayEach(this.range,t=>{t.forAll((n,s)=>{n>=0&&s>=0&&r.setCellMeta(n,s,"className",this.stateBefore[n][s]||" htLeft")})}),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.CellAlignmentAction.prototype.redo=function(r,e){align(this.range,this.type,this.alignment,(t,n)=>r.getCellMeta(t,n),(t,n,s,o)=>r.setCellMeta(t,n,s,o)),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.FiltersAction=function(r,e){this.previousConditionsStack=e,this.conditionsStack=r,this.actionType="filter"};inherit(UndoRedo$1.FiltersAction,UndoRedo$1.Action);UndoRedo$1.FiltersAction.prototype.undo=function(r,e){const t=r.getPlugin("filters");r.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};UndoRedo$1.FiltersAction.prototype.redo=function(r,e){const t=r.getPlugin("filters");r.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class MergeCellsAction extends UndoRedo$1.Action{constructor(e,t){super(),this.cellRange=t;const n=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,s.row,s.col)}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}UndoRedo$1.MergeCellsAction=MergeCellsAction;class UnmergeCellsAction extends UndoRedo$1.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}UndoRedo$1.UnmergeCellsAction=UnmergeCellsAction;UndoRedo$1.RowMoveAction=function(r,e){this.rows=r.slice(),this.finalRowIndex=e,this.actionType="row_move"};inherit(UndoRedo$1.RowMoveAction,UndoRedo$1.Action);UndoRedo$1.RowMoveAction.prototype.undo=function(r,e){const t=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",e),getMoves(this.rows,this.finalRowIndex,r.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),t.moveRow(a,o)}),r.render(),r.deselectCell(),r.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};UndoRedo$1.RowMoveAction.prototype.redo=function(r,e){const t=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),r.render(),r.deselectCell(),r.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};UndoRedo$1.ColumnMoveAction=function(r,e){this.columns=r.slice(),this.finalColumnIndex=e,this.actionType="col_move"};inherit(UndoRedo$1.ColumnMoveAction,UndoRedo$1.Action);UndoRedo$1.ColumnMoveAction.prototype.undo=function(r,e){const t=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",e),getMoves(this.columns,this.finalColumnIndex,r.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),t.moveColumn(a,o)}),r.render(),r.deselectCell(),r.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};UndoRedo$1.ColumnMoveAction.prototype.redo=function(r,e){const t=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),r.render(),r.deselectCell(),r.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};UndoRedo$1.ColumnSortAction=function(r,e){this.previousSortState=r,this.nextSortState=e};inherit(UndoRedo$1.ColumnSortAction,UndoRedo$1.Action);UndoRedo$1.ColumnSortAction.prototype.undo=function(r,e){const t=r.getPlugin("columnSorting"),n=r.getPlugin("multiColumnSorting"),s=n.isEnabled()?n:t;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),e()};UndoRedo$1.ColumnSortAction.prototype.redo=function(r,e){const t=r.getPlugin("columnSorting"),n=r.getPlugin("multiColumnSorting");(n.isEnabled()?n:t).sort(this.nextSortState),e()};UndoRedo$1.prototype.init=function(){const r=this.instance.getSettings().undo,e=typeof r>"u"||r;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};UndoRedo$1.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:s=>!s.altKey,group:SHORTCUTS_GROUP};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};UndoRedo$1.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP)};function onAfterChange(r,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function exposeUndoRedoMethods(r){r.undo=function(){return r.undoRedo.undo()},r.redo=function(){return r.undoRedo.redo()},r.isUndoAvailable=function(){return r.undoRedo.isUndoAvailable()},r.isRedoAvailable=function(){return r.undoRedo.isRedoAvailable()},r.clearUndo=function(){return r.undoRedo.clear()}}function removeExposedUndoRedoMethods(r){delete r.undo,delete r.redo,delete r.isUndoAvailable,delete r.isRedoAvailable,delete r.clearUndo}const hook=Hooks.getSingleton();hook.add("afterUpdateSettings",function(){var r;(r=this.getPlugin("undoRedo"))===null||r===void 0||r.init()});hook.register("beforeUndo");hook.register("afterUndo");hook.register("beforeRedo");hook.register("afterRedo");UndoRedo$1.PLUGIN_KEY=PLUGIN_KEY;UndoRedo$1.SETTING_KEYS=!0;function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(StretchColumns),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(UndoRedo$1)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs$3(reactDomExports);var web_immediate={},web_clearImmediate={},validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var r=TypeError;return validateArgumentsLength=function(e,t){if(e<t)throw new r("Not enough arguments");return e},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var r=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(r),environmentIsIos}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var r=requireGlobalThis(),e=requireEnvironmentUserAgent(),t=requireClassofRaw(),n=function(s){return e.slice(0,s.length)===s};return environment=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":r.Bun&&typeof Bun.version=="string"?"BUN":r.Deno&&typeof Deno.version=="object"?"DENO":t(r.process)==="process"?"NODE":r.window&&r.document?"BROWSER":"REST"}(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var r=requireEnvironment();return environmentIsNode=r==="NODE",environmentIsNode}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var r=requireGlobalThis(),e=requireFunctionApply(),t=requireFunctionBindContext(),n=requireIsCallable(),s=requireHasOwnProperty(),o=requireFails(),a=requireHtml(),l=requireArraySlice(),u=requireDocumentCreateElement(),c=requireValidateArgumentsLength(),d=requireEnvironmentIsIos(),f=requireEnvironmentIsNode(),C=r.setImmediate,m=r.clearImmediate,E=r.process,v=r.Dispatch,_=r.Function,T=r.MessageChannel,R=r.String,O=0,N={},G="onreadystatechange",D,k,z,ne;o(function(){D=r.location});var Z=function(Se){if(s(N,Se)){var Me=N[Se];delete N[Se],Me()}},ve=function(Se){return function(){Z(Se)}},xe=function(Se){Z(Se.data)},de=function(Se){r.postMessage(R(Se),D.protocol+"//"+D.host)};return(!C||!m)&&(C=function(Me){c(arguments.length,1);var Pe=n(Me)?Me:_(Me),_e=l(arguments,1);return N[++O]=function(){e(Pe,void 0,_e)},k(O),O},m=function(Me){delete N[Me]},f?k=function(Se){E.nextTick(ve(Se))}:v&&v.now?k=function(Se){v.now(ve(Se))}:T&&!d?(z=new T,ne=z.port2,z.port1.onmessage=xe,k=t(ne.postMessage,ne)):r.addEventListener&&n(r.postMessage)&&!r.importScripts&&D&&D.protocol!=="file:"&&!o(de)?(k=de,r.addEventListener("message",xe,!1)):G in u("script")?k=function(Se){a.appendChild(u("script"))[G]=function(){a.removeChild(this),Z(Se)}}:k=function(Se){setTimeout(ve(Se),0)}),task={set:C,clear:m},task}var hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var r=require_export(),e=requireGlobalThis(),t=requireTask().clear;return r({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==t},{clearImmediate:t}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var r=requireGlobalThis(),e=requireFunctionApply(),t=requireIsCallable(),n=requireEnvironment(),s=requireEnvironmentUserAgent(),o=requireArraySlice(),a=requireValidateArgumentsLength(),l=r.Function,u=/MSIE .\./.test(s)||n==="BUN"&&function(){var c=r.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")}();return schedulersFix=function(c,d){var f=d?2:1;return u?function(C,m){var E=a(arguments.length,1)>f,v=t(C)?C:l(C),_=E?o(arguments,f):[],T=E?function(){e(v,this,_)}:v;return d?c(T,m):c(T)}:c},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var r=require_export(),e=requireGlobalThis(),t=requireTask().set,n=requireSchedulersFix(),s=e.setImmediate?n(t,!1):t;return r({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==s},{setImmediate:s}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}requireWeb_immediate();function _classPrivateMethodInitSpec$2(r,e){_checkPrivateRedeclaration$3(r,e),e.add(r)}function _checkPrivateRedeclaration$3(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$b(r,e,t){return(e=_toPropertyKey$b(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$b(r){var e=_toPrimitive$b(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$b(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$3(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet;class EditorManager{constructor(e,t,n){_classPrivateMethodInitSpec$2(this,_EditorManager_brand),_defineProperty$b(this,"hot",void 0),_defineProperty$b(this,"tableMeta",void 0),_defineProperty$b(this,"selection",void 0),_defineProperty$b(this,"eventManager",void 0),_defineProperty$b(this,"destroyed",!1),_defineProperty$b(this,"activeEditor",void 0),_defineProperty$b(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new EventManager(e),this.hot.addHook("afterDocumentKeyDown",s=>_assertClassBrand$3(_EditorManager_brand,this,_onAfterDocumentKeyDown).call(this,s)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",s)}),this.hot.view._wt.update("onCellDblClick",(s,o,a)=>_assertClassBrand$3(_EditorManager_brand,this,_onCellDblClick).call(this,s,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:s}=t,o=this.hot.runHooks("modifyGetCellCoords",n,s,!1,"meta");let a=n,l=s;if(Array.isArray(o)&&([a,l]=o),this.cellProperties=this.hot.getCellMeta(a,l),!this.isCellEditable()){this.clearActiveEditor();return}const u=this.hot.getCell(n,s,!0);if(u){const c=this.hot.getCellEditor(this.cellProperties),d=this.hot.colToProp(l),f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),l);this.activeEditor=_getEditorInstance(c,this.hot),this.activeEditor.prepare(n,s,d,u,f,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const s=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",s.highlight.row,s.highlight.col,e,t,n);if(t instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&s.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:s}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,l=o.isHidden(this.hot.toPhysicalRow(n))||a.isHidden(this.hot.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!t||l)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function _onAfterDocumentKeyDown(r){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||isImmediatePropagationStopped(r))return;const{keyCode:t}=r,n=(r.ctrlKey||r.metaKey)&&!r.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(t)&&!isCtrlMetaKey(t)&&!n&&!this.isEditorOpened()&&this.openEditor("",r)}function _onCellDblClick(r,e){e.isCell()&&this.openEditor(null,r,!0)}const instances=new WeakMap;EditorManager.getInstance=function(r,e,t){let n=instances.get(r);return n||(n=new EditorManager(r,e,t),instances.set(r,n)),n};function _classPrivateMethodInitSpec$1(r,e){_checkPrivateRedeclaration$2(r,e),e.add(r)}function _classPrivateFieldInitSpec$2(r,e,t){_checkPrivateRedeclaration$2(r,e),e.set(r,t)}function _checkPrivateRedeclaration$2(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$2(r,e){return r.get(_assertClassBrand$2(r,e))}function _classPrivateFieldSet$1(r,e,t){return r.set(_assertClassBrand$2(r,e),t),t}function _assertClassBrand$2(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet;class FocusManager{constructor(e){var t=this;_classPrivateMethodInitSpec$1(this,_FocusManager_brand),_classPrivateFieldInitSpec$2(this,_hot,void 0),_classPrivateFieldInitSpec$2(this,_focusMode,void 0),_classPrivateFieldInitSpec$2(this,_refocusDelay,1),_classPrivateFieldInitSpec$2(this,_refocusElementGetter,null),_classPrivateFieldInitSpec$2(this,_debouncedSelect,new Map);const n=e.getSettings();_classPrivateFieldSet$1(_hot,this,e),_classPrivateFieldSet$1(_focusMode,this,n.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet$2(_hot,this).addHook("afterUpdateSettings",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_onUpdateSettings).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelectionFocusSet",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelectionEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusEditorElement).call(t,...o)})}getFocusMode(){return _classPrivateFieldGet$2(_focusMode,this)}setFocusMode(e){Object.values(FOCUS_MODES).includes(e)?_classPrivateFieldSet$1(_focusMode,this,e):warn$1(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet$2(_refocusDelay,this)}setRefocusDelay(e){_classPrivateFieldSet$1(_refocusDelay,this,e)}setRefocusElementGetter(e){_classPrivateFieldSet$1(_refocusElementGetter,this,e)}getRefocusElement(){var e;return typeof _classPrivateFieldGet$2(_refocusElementGetter,this)=="function"?_classPrivateFieldGet$2(_refocusElementGetter,this).call(this):(e=_classPrivateFieldGet$2(_hot,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=n=>{var s,o;const a=(s=_classPrivateFieldGet$2(_hot,this).getSelectedRangeLast())===null||s===void 0?void 0:s.highlight;if(!a)return;let l=_classPrivateFieldGet$2(_hot,this).runHooks("modifyFocusedElement",a.row,a.col,n);l instanceof HTMLElement||(l=n),l&&!((o=_classPrivateFieldGet$2(_hot,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&l.focus({preventScroll:!0})};e?t(e):_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,n=>t(n))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet$2(_refocusDelay,this);_classPrivateFieldGet$2(_hot,this).getSettings().imeFastEdit&&!((e=_classPrivateFieldGet$2(_hot,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(_classPrivateFieldGet$2(_debouncedSelect,this).has(t)||_classPrivateFieldGet$2(_debouncedSelect,this).set(t,debounce$2(()=>{var n;(n=this.getRefocusElement())===null||n===void 0||n.select()},t)),_classPrivateFieldGet$2(_debouncedSelect,this).get(t)())}}function _getSelectedCell(r){var e;const t=(e=_classPrivateFieldGet$2(_hot,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!_classPrivateFieldGet$2(_hot,this).selection.isCellVisible(t)){r(null);return}const n=_classPrivateFieldGet$2(_hot,this).getCell(t.row,t.col,!0);n===null?_classPrivateFieldGet$2(_hot,this).addHookOnce("afterScroll",()=>{r(_classPrivateFieldGet$2(_hot,this).getCell(t.row,t.col,!0))}):r(n)}function _focusCell(){_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,r=>{const{activeElement:e}=_classPrivateFieldGet$2(_hot,this).rootDocument;e&&isOutsideInput(e)&&e.blur(),this.focusOnHighlightedCell(r)})}function _focusEditorElement(){_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,r=>{this.getFocusMode()===FOCUS_MODES.MIXED&&r.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onUpdateSettings(r){typeof r.imeFastEdit=="boolean"&&this.setFocusMode(r.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(r){holder.set(r,!0)}function hasValidParameter(r){return r===rootInstanceSymbol}function isRootInstance(r){return holder.has(r)}function _classPrivateMethodInitSpec(r,e){_checkPrivateRedeclaration$1(r,e),e.add(r)}function _classPrivateFieldInitSpec$1(r,e,t){_checkPrivateRedeclaration$1(r,e),e.set(r,t)}function _checkPrivateRedeclaration$1(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$a(r,e,t){return(e=_toPropertyKey$a(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$a(r){var e=_toPrimitive$a(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$a(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$1(r,e){return r.get(_assertClassBrand$1(r,e))}function _classPrivateFieldSet(r,e,t){return r.set(_assertClassBrand$1(r,e),t),t}function _assertClassBrand$1(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_TableView_brand=new WeakSet;class TableView{constructor(e){_classPrivateMethodInitSpec(this,_TableView_brand),_defineProperty$a(this,"hot",void 0),_defineProperty$a(this,"eventManager",void 0),_defineProperty$a(this,"settings",void 0),_defineProperty$a(this,"THEAD",void 0),_defineProperty$a(this,"TBODY",void 0),_defineProperty$a(this,"_wt",void 0),_defineProperty$a(this,"activeWt",void 0),_classPrivateFieldInitSpec$1(this,_columnHeadersCount,0),_classPrivateFieldInitSpec$1(this,_rowHeadersCount,0),_defineProperty$a(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec$1(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec$1(this,_mouseDown,void 0),_classPrivateFieldInitSpec$1(this,_table,void 0),_classPrivateFieldInitSpec$1(this,_lastWidth,0),_classPrivateFieldInitSpec$1(this,_lastHeight,0),this.hot=e,this.eventManager=new EventManager(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),_assertClassBrand$1(_TableView_brand,this,_updateScrollbarClassNames).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),addClass$1(e,"handsontable"),_classPrivateFieldSet(_table,this,t.createElement("TABLE")),addClass$1(_classPrivateFieldGet$1(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass$1(_classPrivateFieldGet$1(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet$1(_table,this),[A11Y_PRESENTATION()]),setAttribute(e,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=t.createElement("THEAD"),_classPrivateFieldGet$1(_table,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),_classPrivateFieldGet$1(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet$1(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet$1(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:s}=this.hot,o=t.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{_classPrivateFieldSet(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(l.target)||(clearTextSelection(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_classPrivateFieldSet(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{_classPrivateFieldGet$1(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&clearTextSelection(s),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{n.isInProgress()&&!l.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{n.isInProgress()&&isLeftClick(l)&&n.finish(),_classPrivateFieldSet(_mouseDown,this,!1);const u=isOutsideInput(t.activeElement);isInput(t.activeElement)&&!u||(u||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(l.target)&&!isRightClick(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{n.isInProgress()&&isRightClick(l)&&(n.finish(),_classPrivateFieldSet(_mouseDown,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),_classPrivateFieldSet(_mouseDown,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,d=l.y||l.clientY;let f=l.target;if(_classPrivateFieldGet$1(_mouseDown,this)||!e||!this.hot.view)return;const{holder:C}=this._wt.wtTable;if(f===C){const E=getScrollbarWidth(t);if(t.elementFromPoint(c+E,d)!==C||t.elementFromPoint(c,d+E)!==C)return}else for(;f!==o;){if(f===null){if(l.isTargetWebComponent)break;return}if(f===e)return;f=f.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=getParentWindow(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=getParentWindow(a);this.eventManager.addEventListener(_classPrivateFieldGet$1(_table,this),"selectstart",l=>{this.settings.fragmentSelection||isInput(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return n===null&&(n=e),s===null&&(s=t),[n,s]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),s=e.getNearestNotHiddenIndex(n-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,s){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,t),a=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let l=0;return t<0?l=a+1:t>0&&(l=s-a),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const n=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");n&&addClass$1(n,e)}removeClassNameFromLicenseElement(e){var t;const n=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");n&&removeClass$1(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet$1(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,l)=>{const u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),_classPrivateFieldSet(_rowHeadersCount,this,o.length),this.hot.getSettings().ariaTags&&_assertClassBrand$1(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand$1(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet$1(_rowHeadersCount,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,l)=>{const u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),_classPrivateFieldSet(_columnHeadersCount,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const l=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),u=l===null?o:l;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(o,a,l)=>{const[u,c]=this.translateFromRenderableToVisualIndex(o,a),d=this.hot.runHooks("modifyGetCellCoords",u,c,!1,"meta");let f=u,C=c;Array.isArray(d)&&([f,C]=d);const m=this.hot.getCellMeta(f,C),E=this.hot.colToProp(C);let v=this.hot.getDataAtRowProp(f,E);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,m)),this.hot.runHooks("beforeRenderer",l,u,c,E,v,m),this.hot.getCellRenderer(m)(this.hot,l,u,c,E,v,m),this.hot.runHooks("afterRenderer",l,u,c,E,v,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,_classPrivateFieldSet(_mouseDown,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,c,l,d),!isImmediatePropagationStopped(o)&&(handleMouseEvent(o,{coords:c,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,C)=>this.hot._createCellCoords(f,C)}),this.hot.runHooks("afterOnCellMouseDown",o,c,l),this.activeWt=this._wt)},onCellContextMenu:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,_classPrivateFieldSet(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,c,l),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,c,l),this.activeWt=this._wt)},onCellMouseOut:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",o,c,l),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,c,l),this.activeWt=this._wt)},onCellMouseOver:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",o,c,l,d),!isImmediatePropagationStopped(o)&&(_classPrivateFieldGet$1(_mouseDown,this)&&handleMouseEvent(o,{coords:c,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,C)=>this.hot._createCellCoords(f,C)}),this.hot.runHooks("afterOnCellMouseOver",o,c,l),this.activeWt=this._wt)},onCellMouseUp:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",o,c,l),!(isImmediatePropagationStopped(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,c,l),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;return!u&&(c=l.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollVertically",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:l.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(o,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;return!u&&(c=l.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:l.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,l)=>{const u=this.hot.rowIndexMapper,c=o<0;let d=o;c||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingRowHeader",d,a,l);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(o,a,l)=>{const u=this.hot.columnIndexMapper,c=o<0;let d=o;c||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingColumnHeader",d,a,l);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(o,a,l)=>{let u;const[c,d]=this.translateFromRenderableToVisualIndex(o,a),f=this.hot.selection.getSelectedRange();if(f.size()>0){const m=f.peekByIndex(l??0);u=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",c,d,u,l)},onBeforeDrawBorders:(o,a)=>{const[l,u,c,d]=o,f=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",f,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,l,u)=>{const c=this.hot.rowIndexMapper,d=this.hot.columnIndexMapper,f=a>=0?d.getVisualFromRenderableIndex(a):a,C=o>=0?c.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCellCoords",C,f,l,u);if(Array.isArray(m)){const[E,v,_,T]=m;return[E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,1)):E,v>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(v,1)):v,_>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(_,-1)):_,T>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=a>=0?u.getVisualFromRenderableIndex(a):a,d=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCoordsElement",d,c);if(Array.isArray(f)){const[C,m]=f;return[C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,1)):C,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),u=o.startRow,c=o.endRow;if(typeof a=="number")o.startRow=Math.max(u-a,0),o.endRow=Math.min(c+a,l-1);else if(a==="auto"){const d=Math.max(1,Math.ceil(c/l*12));o.startRow=Math.max(u-d,0),o.endRow=Math.min(c+d,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),u=o.startColumn,c=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(u-a,0),o.endColumn=Math.min(c+a,l-1)),a==="auto"){const d=Math.max(1,Math.ceil(c/l*6));o.startColumn=Math.max(u-d,0),o.endColumn=Math.min(c+d,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WalkontableFacade(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:s}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,s),this.eventManager.addEventListener(t,"mousedown",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(isInput(e))return!0;const t=isChildOf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _classPrivateFieldGet$1(_mouseDown,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!hasClass$1(n,"relative")){empty$2(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:s}=this.hot,o=n.createElement("div"),a=n.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,s),o.appendChild(a),t.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(t.firstChild){const a=t.firstChild;hasClass$1(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,n,s),a.className="",addClass$1(a,["relative",...o()])):(empty$2(t),this.appendColHeader(e,t,n,s))}else{const{rootDocument:a}=this.hot,l=a.createElement("div"),u=a.createElement("span"),c=o();l.classList.add("relative",...c),u.className="colHeader",this.settings.ariaTags&&(setAttribute(l,...A11Y_PRESENTATION()),setAttribute(u,...A11Y_PRESENTATION())),this.updateCellHeader(u,e,n,s),l.appendChild(u),t.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,t,s)}updateCellHeader(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=t;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(hasClass$1(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(t):hasClass$1(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(t))),o>-1?fastInnerHTML(e,n(t,s)):(fastInnerText(e,""),addClass$1(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,t){_classPrivateFieldSet(_lastWidth,this,e),_classPrivateFieldSet(_lastHeight,this,t)}getLastSize(){return{width:_classPrivateFieldGet$1(_lastWidth,this),height:_classPrivateFieldGet$1(_lastHeight,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(t??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(t??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet$1(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet$1(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(r){const e=_assertClassBrand$1(_TableView_brand,this,_getAriaColcount).call(this)+r;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(e))}function _updateScrollbarClassNames(){const r=this.hot.rootElement;this.hasVerticalScroll()?addClass$1(r,"htHasScrollY"):removeClass$1(r,"htHasScrollY"),this.hasHorizontalScroll()?addClass$1(r,"htHasScrollX"):removeClass$1(r,"htHasScrollX")}function _defineProperty$9(r,e,t){return(e=_toPropertyKey$9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$9(r){var e=_toPrimitive$9(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataSource{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty$9(this,"hot",void 0),_defineProperty$9(this,"data",void 0),_defineProperty$9(this,"dataType","array"),_defineProperty$9(this,"colToProp",()=>{}),_defineProperty$9(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return arrayEach(this.data,(n,s)=>{const o=this.getAtCell(s,e);t.push(o)}),t}getAtRow(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=t===void 0&&n===void 0,{dataDotNotation:a}=this.hot.getSettings();let l=null,u=null;if(l=this.modifyRowData(e),Array.isArray(l))u=[],o?l.forEach((c,d)=>{u[d]=this.getAtPhysicalCell(e,d,l)}):rangeEach(t,n,c=>{u[c-t]=this.getAtPhysicalCell(e,c,l)});else if(isObject$1(l)||isFunction$2(l))if(s?u=[]:u={},!o||s){const d=this.countFirstRowKeys()-1;rangeEach(0,d,f=>{const C=this.colToProp(f);if(f>=(t||0)&&f<=(n||d)&&!Number.isInteger(C)){const m=this.getAtPhysicalCell(e,C,l);s?u.push(m):a?setProperty(u,C,m):u[C]=m}})}else objectEach(l,(c,d)=>{const f=this.getAtPhysicalCell(e,d,l);a?setProperty(u,d,f):u[d]=f});return u}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=createObjectPropListener(n);this.hot.runHooks("modifySourceData",e,t,s,"set"),s.isTouched()&&(n=s.value)}Number.isInteger(t)?this.data[e][t]=n:setProperty(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let s=null;if(n)if(typeof t=="string"){const{dataDotNotation:o}=this.hot.getSettings();s=o?getProperty(n,t):n[t]}else typeof t=="function"?s=t(n):s=n[t];if(this.hot.hasHook("modifySourceData")){const o=createObjectPropListener(s);this.hot.runHooks("modifySourceData",e,t,o,"get"),o.isTouched()&&(s=o.value)}return s}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=null,a=null,l=null,u=null;e===null||t===null?(s=!0,o=0,l=this.countRows()-1):(o=Math.min(e.row,t.row),a=Math.min(e.col,t.col),l=Math.max(e.row,t.row),u=Math.max(e.col,t.col));const c=[];return rangeEach(o,l,d=>{c.push(s?this.getAtRow(d,void 0,void 0,n):this.getAtRow(d,a,u,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}}function extendNotExistingKeys(r,e){return objectEach(e,(t,n)=>{isUndefined$1(r[n])&&(r[n]=t)}),r}function normalizeLanguageCode(r){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(r);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:r}function warnUserAboutLanguageRegistration(r){isDefined(r)&&error(toSingleLine`Language with code "${r}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(r,e){return Array.isArray(r)&&Number.isInteger(e)?r[e]:r}const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register(r,e){registerGloballyPhraseFormatter(r,e)}function getAll(){return getGlobalPhraseFormatters()}register("pluralize",pluralize);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const dictionary$1={languageCode:"en-US",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked"},dictionaryKeys=_dictionaryKeys,DEFAULT_LANGUAGE_CODE=dictionary$1.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(dictionary$1);function registerLanguageDictionary(r,e){let t=r,n=e;return isObject$1(r)&&(n=r,t=n.languageCode),extendLanguageDictionary(t,n),registerGloballyLanguageDictionary(t,deepClone(n)),deepClone(n)}function extendLanguageDictionary(r,e){r!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(e,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(r){return hasLanguageDictionary(r)?deepClone(getGlobalLanguageDictionary(r)):null}function hasLanguageDictionary(r){return hasGlobalLanguageDictionary(r)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(r,e,t){const n=getLanguageDictionary(r);if(n===null)return null;const s=n[e];if(isUndefined$1(s))return null;const o=getFormattedPhrase(s,t);return Array.isArray(o)?o[0]:o}function getFormattedPhrase(r,e){let t=r;return arrayEach(getAll(),n=>{t=n(r,e)}),t}function getValidLanguageCode(r){let e=normalizeLanguageCode(r);return hasLanguageDictionary(e)||(e=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(r)),e}function _defineProperty$8(r,e,t){return(e=_toPropertyKey$8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$8(r){var e=_toPrimitive$8(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){_defineProperty$8(this,"hot",void 0),_defineProperty$8(this,"metaManager",void 0),_defineProperty$8(this,"tableMeta",void 0),_defineProperty$8(this,"dataSource",void 0),_defineProperty$8(this,"duckSchema",void 0),_defineProperty$8(this,"colToPropCache",void 0),_defineProperty$8(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let s=0,o=0,a=!1;if(typeof t=="function"){const l=deepObjectSize(e);s=l>0?l:this.countFirstRowKeys(),a=!0}else{const l=this.tableMeta.maxCols;s=Math.min(l,t.length)}for(n=0;n<s;n++){const l=a?t(n):t[n];if(isObject$1(l)){if(typeof l.data<"u"){const u=a?o:n;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(e,t,n){let s=t,o=n,a;return typeof s>"u"&&(s=0,o=""),typeof e=="object"&&!Array.isArray(e)&&objectEach(e,(l,u)=>{l===null?(a=o+u,this.colToPropCache.push(a),this.propToColCache.set(a,s),s+=1):s=this.recursiveDuckColumns(l,s,`${u}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&isDefined(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(isDefined(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let a=o,l=0,u=e;if((typeof u!="number"||u>=o)&&(u=o),u<this.hot.countRows()&&(a=this.hot.toPhysicalRow(u)),this.hot.runHooks("beforeCreateRow",u,t,n)===!1||a===null)return{delta:0};const d=this.tableMeta.maxRows,f=this.getSchema().length,C=[];for(;l<t&&o+l<d;){let E=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?E=deepClone(this.getSchema()):(E=[],rangeEach(f-1,()=>E.push(null))):this.hot.dataType==="function"?E=this.tableMeta.dataSchema(u+l):(E={},deepExtend(E,this.getSchema())),C.push(E),l+=1}this.hot.rowIndexMapper.insertIndexes(u,l),s==="below"&&(a=Math.min(a+1,o)),this.spliceData(a,0,C);const m=this.hot.toVisualRow(a);return this.hot.countSourceRows()===C.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):n!=="auto"&&this.metaManager.createRow(a,t)),this.hot.runHooks("afterCreateRow",m,l,n),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:a}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,a=this.tableMeta.maxCols,l=this.hot.countSourceCols();let u=e;if((typeof u!="number"||u>=l)&&(u=l),this.hot.runHooks("beforeCreateCol",u,t,n)===!1)return{delta:0};let d=l;u<this.hot.countCols()&&(d=this.hot.toPhysicalColumn(u));const f=this.hot.countSourceRows();let C=this.hot.countCols(),m=0,E=d;s==="end"&&(E=Math.min(E+1,l));const v=E;for(;m<t&&C<a;){if(typeof u!="number"||u>=C)if(f>0)for(let T=0;T<f;T+=1)typeof o[T]>"u"&&(o[T]=[]),o[T].push(null);else o.push([null]);else for(let T=0;T<f;T++)o[T].splice(E,0,null);m+=1,E+=1,C+=1}this.hot.columnIndexMapper.insertIndexes(u,m),m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(v,t));const _=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",_,m,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:v}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-t;const o=this.visualRowsToPhysical(s,t),a=this.hot.countSourceRows();if(s=(a+s)%a,this.hot.runHooks("beforeRemoveRow",s,o.length,o,n)===!1)return!1;const u=o.length;if(this.filterData(s,u,o),s<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const d=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&d===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((d,f)=>f-d).forEach(d=>{this.metaManager.removeRow(d,1)}),this.hot.runHooks("afterRemoveRow",s,u,o,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-t:e;s=(this.hot.countCols()+s)%this.hot.countCols();const o=this.visualColumnsToPhysical(s,t),a=o.slice(0).sort((f,C)=>C-f);if(this.hot.runHooks("beforeRemoveCol",s,t,o,n)===!1)return!1;let u=!0;const c=a.length,d=this.dataSource;for(let f=0;f<c;f++)u&&o[0]!==o[f]-f&&(u=!1);if(u)for(let f=0,C=this.hot.countSourceRows();f<C;f++)d[f].splice(o[0],t),f===0&&this.metaManager.removeColumn(o[0],t);else for(let f=0,C=this.hot.countSourceRows();f<C;f++)for(let m=0;m<c;m++)d[f].splice(a[m],1),f===0&&this.metaManager.removeColumn(a[m],1);return s<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",s,t,o,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const s=this.hot.getDataAtCol(e),o=s.slice(t,t+n),a=s.slice(t+n);for(var l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,a);let d=0;for(;d<n;)u.push(null),d+=1;return to2dArray(u),this.hot.populateFromArray(t,e,u,null,null,"spliceCol"),o}spliceRow(e,t,n){const s=this.hot.getSourceDataAtRow(e),o=s.slice(t,t+n),a=s.slice(t+n);for(var l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,a);let d=0;for(;d<n;)u.push(null),d+=1;return this.hot.populateFromArray(e,t,[u],null,null,"spliceRow"),o}spliceData(e,t,n){if(this.hot.runHooks("beforeDataSplice",e,t,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(a=>this.dataSource.push(a))}}filterData(e,t,n){let s=this.hot.runHooks("filterData",e,t,n);Array.isArray(s)===!1&&(s=this.dataSource.filter((o,a)=>n.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,t){const n=this.hot.toPhysicalRow(e);let s=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);s=isNaN(o)?o:s;const{dataDotNotation:a}=this.hot.getSettings();let l=null;if(s&&s.hasOwnProperty&&hasOwnProperty(s,t))l=s[t];else if(a&&typeof t=="string"&&t.indexOf(".")>-1){let u=s;if(!u)return null;const c=t.split(".");for(let d=0,f=c.length;d<f;d++)if(u=u[c[d]],typeof u>"u")return null;l=u}else typeof t=="function"&&(l=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const u=createObjectPropListener(l);this.hot.runHooks("modifyData",n,this.propToCol(t),u,"get"),u.isTouched()&&(l=u.value)}return l}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const s=this.hot.toPhysicalRow(e);let o=n,a=this.dataSource[s];const l=this.hot.runHooks("modifyRowData",s);if(a=isNaN(l)?l:a,this.hot.hasHook("modifyData")){const c=createObjectPropListener(o);this.hot.runHooks("modifyData",s,this.propToCol(t),c,"set"),c.isTouched()&&(o=c.value)}const{dataDotNotation:u}=this.hot.getSettings();if(a&&a.hasOwnProperty&&hasOwnProperty(a,t))a[t]=o;else if(u&&typeof t=="string"&&t.indexOf(".")>-1){let c=a,d=0,f;const C=t.split(".");for(d=0,f=C.length-1;d<f;d++)typeof c[C[d]]>"u"&&(c[C[d]]={}),c=c[C[d]];c[C[d]]=o}else typeof t=="function"?t(this.dataSource.slice(s,s+1)[0],o):a[t]=o}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),s=[];let o=(n+e)%n,a=t,l;for(;o<n&&a;)l=this.hot.toPhysicalRow(o),s.push(l),a-=1,o+=1;return s}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),s=[];let o=(n+e)%n,a=t;for(;o<n&&a;){const l=this.hot.toPhysicalColumn(o);s.push(l),a-=1,o+=1}return s}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,DataMap.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const s=[];let o,a,l;const u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];const d=n===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(u-1,0),Math.max(e.row,t.row)),C=Math.min(Math.max(c-1,0),Math.max(e.col,t.col));for(o=Math.min(e.row,t.row);o<=f;o++){l=[];const m=o>=0?this.hot.toPhysicalRow(o):o;for(a=Math.min(e.col,t.col);a<=C&&m!==null;a++)l.push(d.call(this,o,this.colToProp(a)));m!==null&&s.push(l)}return s}getText(e,t){return stringify(this.getRange(e,t,DataMap.DESTINATION_RENDERER))}getCopyableText(e,t){return stringify(this.getRange(e,t,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}function canBeOverwritten(r,e){var t;return r==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(r))||!hasOwnProperty(e,r)}function extendByMetaType(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const n=typeof e.type=="string"?_getItem(e.type):e.type;if(r._automaticallyAssignedMetaProps&&objectEach(e,(o,a)=>void r._automaticallyAssignedMetaProps.delete(a)),!isObject$1(n))return;t===r&&!r._automaticallyAssignedMetaProps&&(r._automaticallyAssignedMetaProps=new Set);const s={};objectEach(n,(o,a)=>{if(canBeOverwritten(a,t)){var l;s[a]=o,(l=r._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),extend$1(r,s)}function columnFactory(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}inherit(t,r);for(let n=0;n<e.length;n++)t.prototype[e[n]]=void 0;return t}function isUnsignedNumber(r){return Number.isInteger(r)&&r>=0}function assert(r,e){if(!r())throw new Error(`Assertion failed: ${e}`)}function isNullish(r){return r==null}const metaSchemaFactory=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(r){let e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,r),isEmpty$1(n)===!1)return!1;return!0},isEmptyRow(r){let e,t,n,s;for(e=0,t=this.countCols();e<t;e++)if(n=this.getDataAtCell(r,e),isEmpty$1(n)===!1)return typeof n=="object"?(s=this.getCellMeta(r,e),isObjectEqual(this.getSchema()[s.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function _defineProperty$7(r,e,t){return(e=_toPropertyKey$7(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$7(r){var e=_toPrimitive$7(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$7(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function createTableMetaEmptyClass(){return class{}}class GlobalMeta{constructor(e){_defineProperty$7(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty$7(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend$1(this.meta,metaSchemaFactory()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;extend$1(this.meta,e),extendByMetaType(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function _defineProperty$6(r,e,t){return(e=_toPropertyKey$6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$6(r){var e=_toPrimitive$6(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TableMeta{constructor(e){_defineProperty$6(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){extend$1(this.meta,e),extendByMetaType(this.meta,e,e)}}function _defineProperty$5(r,e,t){return(e=_toPropertyKey$5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$5(r){var e=_toPrimitive$5(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class LazyFactoryMap{constructor(e){_defineProperty$5(this,"valueFactory",void 0),_defineProperty$5(this,"data",[]),_defineProperty$5(this,"index",[]),_defineProperty$5(this,"holes",new Set),this.valueFactory=e}obtain(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],n===void 0&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=n,this.index[e]=s}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const n=[],s=this.data.length;for(let a=0;a<t;a++)n.push(s+a),this.data.push(void 0);const o=isNullish(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(isNullish(e)?this.index.length-t:e,t);for(let s=0;s<n.length;s++){const o=n[s];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return arrayFilter(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const s=this._getKeyByStorageIndex(n);s!==-1&&e.push([s,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function _defineProperty$4(r,e,t){return(e=_toPropertyKey$4(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$4(r){var e=_toPrimitive$4(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$4(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const COLUMNS_PROPS_CONFLICTS=["data","width"];class ColumnMeta{constructor(e){_defineProperty$4(this,"globalMeta",void 0),_defineProperty$4(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=e,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);extend$1(n,t),extendByMetaType(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}function _defineProperty$3(r,e,t){return(e=_toPropertyKey$3(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$3(r){var e=_toPrimitive$3(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$3(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CellMeta{constructor(e){_defineProperty$3(this,"columnMeta",void 0),_defineProperty$3(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const s=this.getMeta(e,t);extend$1(s,n),extendByMetaType(s,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);return n===void 0?s:s[n]}setMeta(e,t,n,s){var o;const a=this.metas.obtain(e).obtain(t);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),a[n]=s}removeMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);delete s[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)isDefined(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class MetaManager{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GlobalMeta(e),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),n.forEach(s=>new s(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:s,visualColumn:o}=n;const a=this.cellMeta.getMeta(e,t);return a.visualRow=s,a.visualCol=o,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,s){this.cellMeta.setMeta(e,t,n,s)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mixin(MetaManager,localHooks);function replaceData(r,e,t,n){const{hotInstance:s,dataMap:o,dataSource:a,internalSource:l,source:u,metaManager:c,firstRun:d}=n,f=toUpperCaseFirst(l),C=s.getSettings();Array.isArray(C.dataSchema)?s.dataType="array":isFunction$2(C.dataSchema)?s.dataType="function":s.dataType="object",o&&o.destroy(),r=s.runHooks(`before${f}`,r,d,u);const m=new DataMap(s,r,c);if(e(m),typeof r=="object"&&r!==null)r.push&&r.splice||(r=[r]);else if(r===null){const E=m.getSchema();r=[];let v,_=0,T=0;for(_=0,T=C.startRows;_<T;_++)if((s.dataType==="object"||s.dataType==="function")&&C.dataSchema)v=deepClone(E),r.push(v);else if(s.dataType==="array")v=deepClone(E[0]),r.push(v);else{v=[];for(let R=0,O=C.startCols;R<O;R++)v.push(null);r.push(v)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof r} given)`);Array.isArray(r[0])&&(s.dataType="array"),C.data=r,m.dataSource=r,a.data=r,a.dataType=s.dataType,a.colToProp=m.colToProp.bind(m),a.propToCol=m.propToCol.bind(m),a.countCachedColumns=m.countCachedColumns.bind(m),t(m),s.runHooks(`after${f}`,r,d,u),d||(s.runHooks("afterChange",null,l),s.render()),s.getSettings().ariaTags&&setAttribute(s.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(s.countCols()+(s.view?s.countRowHeaders():0))])}function _defineProperty$2(r,e,t){return(e=_toPropertyKey$2(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$2(r){var e=_toPrimitive$2(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$2(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DynamicCellMetaMod{constructor(e){_defineProperty$2(this,"metaManager",void 0),_defineProperty$2(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Hooks.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:s}=e;if((t=this.metaSyncMemo.get(n))!==null&&t!==void 0&&t.has(s))return;const{visualRow:o,visualCol:a}=e,l=this.metaManager.hot,u=l.colToProp(a);e.prop=u,l.runHooks("beforeGetCellMeta",o,a,e);const c=hasOwnProperty(e,"type")?e.type:null;let d=isFunction$2(e.cells)?e.cells(n,s,u):null;if(c)if(d){var f;d.type=(f=d.type)!==null&&f!==void 0?f:c}else d={type:c};d&&this.metaManager.updateCellMeta(n,s,d),l.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(s)}}function _classPrivateFieldInitSpec(r,e,t){_checkPrivateRedeclaration(r,e),e.set(r,t)}function _checkPrivateRedeclaration(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1(r,e,t){return(e=_toPropertyKey$1(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1(r){var e=_toPrimitive$1(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet(r,e){return r.get(_assertClassBrand(r,e))}function _assertClassBrand(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap;class ExtendMetaPropertiesMod{constructor(e){_defineProperty$1(this,"metaManager",void 0),_defineProperty$1(this,"usageTracker",new Set),_defineProperty$1(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec(this,_initOnlyCallback,(t,n,s)=>{if(!s)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:n,target:s,onChange:o}=e,a=typeof s=="string",l=a?s:t,u=`_${l}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[l],o?(this.installPropWatcher(t,u,o),a&&this.installPropWatcher(s,u,o)):n&&(this.installPropWatcher(t,u,_classPrivateFieldGet(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,n){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const a=!s.usageTracker.has(e);s.usageTracker.add(e),n.call(s,e,o,a),this[t]=o},enumerable:!0,configurable:!0})}}function installFocusDetector(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=r.rootElement,n=createInputElement(r),s=createInputElement(r);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(n),t.lastChild.after(s),{activate(){r._registerTimeout(()=>{n.tabIndex=0,s.tabIndex=0},10)},deactivate(){r._registerTimeout(()=>{n.tabIndex=-1,s.tabIndex=-1},10)}}}function createInputElement(r){const t=r.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),r.getSettings().ariaTags&&setAttribute(t,[A11Y_PRESENTATION(),A11Y_HIDDEN()]),t}function installFocusCatcher(r){const e=normalizeCoordsIfNeeded(r);let t;const{activate:n,deactivate:s}=installFocusDetector(r,{onFocusFromTop(){var f;const C=(f=e(t))!==null&&f!==void 0?f:getMostTopStartPosition(r);C&&(r.runHooks("modifyFocusOnTabNavigation","from_above",C),r.selectCell(C.row,C.col)),r.listen()},onFocusFromBottom(){var f;const C=(f=e(t))!==null&&f!==void 0?f:getMostBottomEndPosition(r);C&&(r.runHooks("modifyFocusOnTabNavigation","from_below",C),r.selectCell(C.row,C.col)),r.listen()}}),o={wrapped:!1,flipped:!1};let a=!0,l=!1,u=!1;r.addHook("afterListen",()=>s()),r.addHook("afterUnlisten",()=>n()),r.addHook("afterSelection",(f,C,m,E,v)=>{if(l&&(o.wrapped&&o.flipped||u)&&(u=!1,v.value=!0),a){var _;t=(_=r.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight}}),r.addHook("beforeRowWrap",(f,C,m)=>{o.wrapped=!0,o.flipped=m});function c(){o.wrapped=!1,o.flipped=!1,r.deselectCell(),r.unlisten()}const d={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:"focusCatcher"};r.getShortcutManager().getContext("grid").addShortcuts([{...d,callback:()=>{const{tabNavigation:f}=r.getSettings();l=!0,r.getSelectedRangeLast()&&!f&&(a=!1),f||(u=!0)},position:"before"},{...d,callback:f=>{const{tabNavigation:C,autoWrapRow:m}=r.getSettings();if(l=!1,a=!0,!C||!r.selection.isSelected()||m&&o.wrapped&&o.flipped||!m&&o.wrapped)return m&&o.wrapped&&o.flipped&&(t=f.shiftKey?getMostTopStartPosition(r):getMostBottomEndPosition(r)),c(),!1;f.preventDefault()},position:"after"}])}function getMostTopStartPosition(r){const{rowIndexMapper:e,columnIndexMapper:t}=r,{navigableHeaders:n}=r.getSettings();let s=n&&r.countColHeaders()>0?-r.countColHeaders():0,o=n&&r.countRowHeaders()>0?-r.countRowHeaders():0;return s===0&&(s=e.getVisualFromRenderableIndex(s)),o===0&&(o=t.getVisualFromRenderableIndex(o)),s===null||o===null?null:r._createCellCoords(s,o)}function getMostBottomEndPosition(r){var e,t;const{rowIndexMapper:n,columnIndexMapper:s}=r,{navigableHeaders:o}=r.getSettings();let a=n.getRenderableIndexesLength()-1,l=s.getRenderableIndexesLength()-1;if(a<0){if(!o||r.countColHeaders()===0)return null;a=-1}if(l<0){if(!o||r.countColHeaders()===0)return null;l=-1}return r._createCellCoords((e=n.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(t=s.getVisualFromRenderableIndex(l))!==null&&t!==void 0?t:l)}function normalizeCoordsIfNeeded(r){return e=>{if(!e)return null;const t=getMostTopStartPosition(r),n=getMostBottomEndPosition(r);return e.col<t.col&&(e.col=t.col),e.col>n.col&&(e.col=n.col),e.row<t.row&&(e.row=t.row),e.row>n.row&&(e.row=n.row),e}}function columnHeaderScrollStrategy(r){return e=>{let{col:t}=e;r.scrollViewportTo({col:t})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function multipleScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function noncontiguousScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function rowHeaderScrollStrategy(r){return e=>{let{row:t}=e;r.scrollViewportTo({row:t})}}function singleScrollStrategy(r){return e=>{const t=r.selection.getSelectionSource(),{row:n,col:s}=e;if(n<0&&s>=0)r.scrollViewportTo({col:s});else if(s<0&&n>=0)r.scrollViewportTo({row:n});else{if(t==="mouse"&&(s===r.view.getLastPartiallyVisibleColumn()||n===r.view.getLastPartiallyVisibleRow()))return;r.scrollViewportTo({row:n,col:s})}}}function createViewportScroller(r){const{selection:e}=r;let t=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){t=!0},scrollTo(s){var o;if(t||n){t=!1;return}let a;e.isFocusSelectionChanged()?a=focusScrollStrategy(r):e.isSelectedByCorner()?a=cornerHeaderScrollStrategy():e.isSelectedByRowHeader()?a=rowHeaderScrollStrategy(r):e.isSelectedByColumnHeader()?a=columnHeaderScrollStrategy(r):e.getSelectedRange().size()===1&&e.isMultiple()?a=multipleScrollStrategy(r):e.getSelectedRange().size()===1&&!e.isMultiple()?a=singleScrollStrategy(r):e.getSelectedRange().size()>1&&(a=noncontiguousScrollStrategy(r)),(o=a)===null||o===void 0||o(s)}}}const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=r=>r.map(e=>{const t=e.toLowerCase();return mappings.has(t)?mappings.get(t):t}).sort().join("+"),getKeysList=r=>r.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=r=>{let{which:e,key:t}=r;if(specialCharactersSet.has(e))return specialCharactersSet.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:t.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(r){return isObject$1(r)&&r.__kindOf===__kindOf}const createContext=r=>{const e=createUniqueMap({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${r}" context.`}),t=function(){let{keys:u,callback:c,group:d,runOnlyIf:f=()=>!0,captureCtrl:C=!1,preventDefault:m=!0,stopPropagation:E=!1,relativeToGroup:v,position:_,forwardToContext:T}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined$1(d))throw new Error("You need to define the shortcut's group.");if(isFunction$2(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:c,group:d,runOnlyIf:f,captureCtrl:C,preventDefault:m,stopPropagation:E};isDefined(v)&&(R.relativeToGroup=v,R.position=_),isContextObject(T)&&(R.forwardToContext=T),u.forEach(O=>{const N=normalizeKeys(O);if(e.hasItem(N)){const D=e.getItem(N);let k=D.findIndex(z=>z.group===v);k!==-1?_==="before"?k-=1:k+=1:k=D.length,D.splice(k,0,R)}else e.addItem(N,[R])})},n=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(d=>{objectEach(c,(f,C)=>{Object.prototype.hasOwnProperty.call(d,C)===!1&&(d[C]=c[C])}),t(d)})},s=u=>{const c=normalizeKeys(u);e.removeItem(c)};return{__kindOf,addShortcut:t,addShortcuts:n,getShortcuts:u=>{const c=normalizeKeys(u),d=e.getItem(c);return isDefined(d)?d.slice():[]},hasShortcut:u=>{const c=normalizeKeys(u);return e.hasItem(c)},removeShortcutsByKeys:s,removeShortcutsByGroup:u=>{e.getItems().forEach(d=>{let[f,C]=d;const m=C.filter(E=>E.group!==u);m.length===0?s(getKeysList(f)):(C.length=0,C.push(...m))})}}};function createKeysObserver(){const r=new Set;return{press(e){r.add(e)},release(e){r.delete(e)},releaseAll(){r.clear()},isPressed(e){return r.has(e)}}}const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[];let instanceCounter=0;function useRecorder(r,e,t,n,s){const o=m=>MODIFIER_KEYS.includes(m),a=function(m){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return m.altKey&&v.push("alt"),E&&(m.ctrlKey||m.metaKey)?v.push("control/meta"):(m.ctrlKey&&v.push("control"),m.metaKey&&v.push("meta")),m.shiftKey&&v.push("shift"),v},l=m=>{if(e(m)===!1||t(m)===!1||m.keyCode===229||typeof m.key!="string"||isImmediatePropagationStopped(m))return;const v=normalizeEventKey(m);let _=[];o(v)||(_=a(m));const T=[v].concat(_);!s(m,T)&&(isMacOS$1()&&_.includes("meta")||!isMacOS$1()&&_.includes("control"))&&s(m,[v].concat(a(m,!0))),n(m)},u=m=>{if(typeof m.key=="string"){const E=normalizeEventKey(m);o(E)&&modifierKeysObserver.press(E)}},c=m=>{if(typeof m.key=="string"){const E=normalizeEventKey(m);o(E)&&modifierKeysObserver.release(E)}},d=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let m=r;for(instanceCounter+=1;m;)instanceCounter===1&&(m.document.documentElement.addEventListener("keydown",u),modKeyListeners.push({event:"keydown",listener:u}),m.document.documentElement.addEventListener("keyup",c),modKeyListeners.push({event:"keyup",listener:c})),m.document.documentElement.addEventListener("keydown",l),m.document.documentElement.addEventListener("blur",d),m=getParentWindow(m)},unmount:()=>{let m=r;for(instanceCounter-=1;m;){if(instanceCounter===0){for(let E=0;E<modKeyListeners.length;E++){const{event:v,listener:_}=modKeyListeners[E];m.document.documentElement.removeEventListener(v,_)}modKeyListeners.length=0}m.document.documentElement.removeEventListener("keydown",l),m.document.documentElement.removeEventListener("blur",d),m=getParentWindow(m)}},isPressed:m=>modifierKeysObserver.isPressed(m),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}const createShortcutManager=r=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:s}=r;const o=createUniqueMap({errorIdExists:E=>`The "${E}" context name is already registered.`});let a="grid";const l=E=>{const v=createContext(E);return o.addItem(E,v),v},u=()=>a,c=E=>o.getItem(E),d=E=>{if(!o.hasItem(E))throw new Error(toSingleLine`You've tried to activate the "${E}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=E};let f=!1;const C=function(E,v){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u();const T=isContextObject(_)?_:c(_);let R=!1;if(!T.hasShortcut(v))return R;const O=T.getShortcuts(v);for(let N=0;N<O.length;N++){const{callback:G,runOnlyIf:D,preventDefault:k,stopPropagation:z,captureCtrl:ne,forwardToContext:Z}=O[N];if(D(E)===!0){if(f=ne,R=G(E,v)===!1,f=!1,k&&E.preventDefault(),z&&(stopImmediatePropagation(E),E.stopPropagation()),R)break;Z&&C(E,v,Z)}}return R},m=useRecorder(e,t,n,s,C);return m.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:d,isCtrlPressed:()=>!f&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function getThemeClassName(r){const{classNames:e}=findFirstParentWithClass(r,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let activeGuid=null;const foreignHotInstances=new Map;function Core(r,e){var t,n=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new EventManager(o);let l,u,c,d,f,C,m=!0;hasValidParameter(s)&&registerAsRootInstance(this),this.rootElement=r,this.rootDocument=r.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const E=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",v=["rtl","ltr"].includes(E)?E:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=getValidLanguageCode(e.language);const _=new MetaManager(o,e,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),T=_.getTableMeta(),R=_.getGlobalMeta(),O=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,r.insertBefore(this.container,r.firstChild),isRootInstance(this)&&(_injectProductInfo(e.licenseKey,r),addClass$1(r,"ht-wrapper")),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",U=>{o.runHooks("afterColumnSequenceChange",U)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",U=>{o.runHooks("afterRowSequenceChange",U)}),u=new DataSource(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const N=U=>{const{row:te,col:V}=U;return o._createCellCoords(te>=0?o.rowIndexMapper.getRenderableFromVisualIndex(te):te,V>=0?o.columnIndexMapper.getRenderableFromVisualIndex(V):V)},G=U=>{const{row:te,col:V}=U;return o._createCellCoords(te>=0?o.rowIndexMapper.getVisualFromRenderableIndex(te):te,V>=0?o.columnIndexMapper.getVisualFromRenderableIndex(V):V)},D=(U,te)=>{const V=te>U?1:-1,ue=Math.min(U,te),Ne=Math.max(U,te),Ge=o.rowIndexMapper.getNearestNotHiddenIndex(U,V);return Ge===null||V===1&&Ge>Ne||V===-1&&Ge<ue?null:Ge>=0?o.rowIndexMapper.getRenderableFromVisualIndex(Ge):Ge},k=(U,te)=>{const V=te>U?1:-1,ue=Math.min(U,te),Ne=Math.max(U,te),Ge=o.columnIndexMapper.getNearestNotHiddenIndex(U,V);return Ge===null||V===1&&Ge>Ne||V===-1&&Ge<ue?null:Ge>=0?o.columnIndexMapper.getRenderableFromVisualIndex(Ge):Ge};let z=new Selection$1(T,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:U=>l.propToCol(U),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(U,te)=>o._createCellCoords(U,te),createCellRange:(U,te,V)=>o._createCellRange(U,te,V),visualToRenderableCoords:N,renderableToVisualCoords:G,findFirstNonHiddenRenderableRow:D,findFirstNonHiddenRenderableColumn:k,isDisabledCellSelection:(U,te)=>U<0||te<0?o.getSettings().disableVisualSelection:o.getCellMeta(U,te).disableVisualSelection});this.selection=z;const ne=U=>{let{hiddenIndexesChanged:te}=U;te&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ne),this.rowIndexMapper.addLocalHook("cacheUpdated",ne),this.selection.addLocalHook("afterSetRangeEnd",(U,te)=>{const V=createObjectPropListener(!1),ue=this.selection.getSelectedRange(),{from:Ne,to:Ge}=ue.current(),Ue=ue.size()-1;this.runHooks("afterSelection",Ne.row,Ne.col,Ge.row,Ge.col,V,Ue),this.runHooks("afterSelectionByProp",Ne.row,o.colToProp(Ne.col),Ge.row,o.colToProp(Ge.col),V,Ue),te&&(!V.isTouched()||V.isTouched()&&!V.value)&&C.scrollTo(U);const Ie=z.isSelectedByRowHeader(),Ke=z.isSelectedByColumnHeader();Ie&&Ke?addClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Ie?(removeClass$1(this.rootElement,"ht__selection--columns"),addClass$1(this.rootElement,"ht__selection--rows")):Ke?(removeClass$1(this.rootElement,"ht__selection--rows"),addClass$1(this.rootElement,"ht__selection--columns")):removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),z.getSelectionSource()!=="shift"&&d.closeEditor(null),o.view.render(),d.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",U=>{this.runHooks("beforeSelectionFocusSet",U.row,U.col)}),this.selection.addLocalHook("afterSetFocus",U=>{const te=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",U.row,U.col,te),(!te.isTouched()||te.isTouched()&&!te.value)&&C.scrollTo(U),d.closeEditor(),o.view.render(),d.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",U=>{const te=U.length-1,{from:V,to:ue}=U[te];this.runHooks("afterSelectionEnd",V.row,V.col,ue.row,ue.col,te),this.runHooks("afterSelectionEndByProp",V.row,o.colToProp(V.col),ue.row,o.colToProp(ue.col),te)}),this.selection.addLocalHook("afterIsMultipleSelection",U=>{const te=this.runHooks("afterIsMultipleSelection",U.value);U.value&&(U.value=te)}),this.selection.addLocalHook("afterDeselect",()=>{d.closeEditor(),o.view.render(),removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeStart",...te)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeStartOnly",...te)}).addLocalHook("beforeSetRangeEnd",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeEnd",...te)}).addLocalHook("beforeSelectColumns",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeSelectColumns",...te)}).addLocalHook("afterSelectColumns",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("afterSelectColumns",...te)}).addLocalHook("beforeSelectRows",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeSelectRows",...te)}).addLocalHook("afterSelectRows",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("afterSelectRows",...te)}).addLocalHook("beforeModifyTransformStart",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("modifyTransformStart",...te)}).addLocalHook("afterModifyTransformStart",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformStart",...te)}).addLocalHook("beforeModifyTransformFocus",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("modifyTransformFocus",...te)}).addLocalHook("afterModifyTransformFocus",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformFocus",...te)}).addLocalHook("beforeModifyTransformEnd",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("modifyTransformEnd",...te)}).addLocalHook("afterModifyTransformEnd",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformEnd",...te)}).addLocalHook("beforeRowWrap",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeRowWrap",...te)}).addLocalHook("beforeColumnWrap",function(){for(var U=arguments.length,te=new Array(U),V=0;V<U;V++)te[V]=arguments[V];return n.runHooks("beforeColumnWrap",...te)}).addLocalHook("insertRowRequire",U=>this.alter("insert_row_above",U,1,"auto")).addLocalHook("insertColRequire",U=>this.alter("insert_col_start",U,1,"auto")),c={alter(U,te){var V,ue;let Ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Ge=arguments.length>3?arguments[3]:void 0,Ue=arguments.length>4?arguments[4]:void 0;const Ie=Ke=>{if(Ke.length===0)return[];const le=[...Ke];return le.sort((we,qe)=>{let[$e]=we,[ze]=qe;return $e===ze?0:$e>ze?1:-1}),arrayReduce(le,(we,qe)=>{let[$e,ze]=qe;const it=we[we.length-1],[Ve,Qe]=it,nt=Ve+Qe;if($e<=nt){const Ze=Math.max(ze-(nt-$e),0);it[1]+=Ze}else we.push([$e,ze]);return we},[le[0]])};switch(U){case"insert_row_below":case"insert_row_above":const Ke=o.countSourceRows();if(T.maxRows===Ke)return;const le=U==="insert_row_below"?"below":"above";te=(V=te)!==null&&V!==void 0?V:le==="below"?Ke:0;const{delta:ge,startPhysicalIndex:we}=l.createRow(te,Ne,{source:Ge,mode:le});z.shiftRows(o.toVisualRow(we),ge);break;case"insert_col_start":case"insert_col_end":const qe=U==="insert_col_end"?"end":"start";te=(ue=te)!==null&&ue!==void 0?ue:qe==="end"?o.countSourceCols():0;const{delta:$e,startPhysicalIndex:ze}=l.createCol(te,Ne,{source:Ge,mode:qe});if($e){if(Array.isArray(T.colHeaders)){const Qe=[o.toVisualColumn(ze),0];Qe.length+=$e,Array.prototype.splice.apply(T.colHeaders,Qe)}z.shiftColumns(o.toVisualColumn(ze),$e)}break;case"remove_row":const it=Qe=>{let nt=0;arrayEach(Qe,Ze=>{let[at,St]=Ze;const bt=isEmpty$1(at)?o.countRows()-1:Math.max(at-nt,0);if(Number.isInteger(at)&&(at=Math.max(at-nt,0)),!l.removeRow(at,St,Ge))return;if(z.isSelected()){const{row:ce}=o.getSelectedRangeLast().highlight;ce>=at&&ce<=at+St-1&&d.closeEditor(!0)}const X=o.countRows();X===0?z.deselect():Ge==="ContextMenu.removeRow"?z.refresh():z.shiftRows(at,-St);const F=T.fixedRowsTop;F>=bt+1&&(T.fixedRowsTop-=Math.min(St,F-bt));const b=T.fixedRowsBottom;b&&bt>=X-b&&(T.fixedRowsBottom-=Math.min(St,b)),nt+=St})};Array.isArray(te)?it(Ie(te)):it([[te,Ne]]);break;case"remove_col":const Ve=Qe=>{let nt=0;arrayEach(Qe,Ze=>{let[at,St]=Ze;const bt=isEmpty$1(at)?o.countCols()-1:Math.max(at-nt,0);let q=o.toPhysicalColumn(bt);if(Number.isInteger(at)&&(at=Math.max(at-nt,0)),!l.removeCol(at,St,Ge))return;if(z.isSelected()){const{col:ce}=o.getSelectedRangeLast().highlight;ce>=at&&ce<=at+St-1&&d.closeEditor(!0)}o.countCols()===0?z.deselect():Ge==="ContextMenu.removeColumn"?z.refresh():z.shiftColumns(at,-St);const b=T.fixedColumnsStart;b>=bt+1&&(T.fixedColumnsStart-=Math.min(St,b-bt)),Array.isArray(T.colHeaders)&&(typeof q>"u"&&(q=-1),T.colHeaders.splice(q,St)),nt+=St})};Array.isArray(te)?Ve(Ie(te)):Ve([[te,Ne]]);break;default:throw new Error(`There is no such action "${U}"`)}o.view.render(),Ue||c.adjustRowsAndCols()},adjustRowsAndCols(){const U=T.minRows,te=T.minSpareRows,V=T.minCols,ue=T.minSpareCols;if(U){const Ne=o.countRows();Ne<U&&l.createRow(Ne,U-Ne,{source:"auto"})}if(te){const Ne=o.countEmptyRows(!0);if(Ne<te){const Ge=te-Ne,Ue=Math.min(Ge,T.maxRows-o.countSourceRows());l.createRow(o.countRows(),Ue,{source:"auto"})}}{let Ne;(V||ue)&&(Ne=o.countEmptyCols(!0));let Ge=o.countCols();if(V&&!T.columns&&Ge<V){const Ue=V-Ge;Ne+=Ue,l.createCol(Ge,Ue,{source:"auto"})}if(ue&&!T.columns&&o.dataType==="array"&&Ne<ue){Ge=o.countCols();const Ue=ue-Ne,Ie=Math.min(Ue,T.maxCols-Ge);l.createCol(Ge,Ie,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(U,te,V,ue,Ne){let Ge,Ue,Ie,Ke;const le=[],ge={},we=[],qe=U.row,$e=U.col;if(Ue=te.length,Ue===0)return!1;let ze=0,it=0;switch(isObject$1(V)&&(ze=V.col-$e+1,it=V.row-qe+1),Ne){case"shift_down":const Ve=pivot(te),Qe=Ve.length,nt=Math.max(Qe,ze),Ze=o.getData().slice(qe),at=pivot(Ze).slice($e,$e+nt);for(Ie=0;Ie<nt;Ie+=1)if(Ie<Qe){for(Ge=0,Ue=Ve[Ie].length;Ge<it-Ue;Ge+=1)Ve[Ie].push(Ve[Ie][Ge%Ue]);Ie<at.length?we.push(Ve[Ie].concat(at[Ie])):we.push(Ve[Ie].concat(new Array(Ze.length).fill(null)))}else we.push(Ve[Ie%Qe].concat(at[Ie]));o.populateFromArray(qe,$e,pivot(we));break;case"shift_right":const St=te.length,bt=Math.max(St,it),q=o.getData().slice(qe).map(re=>re.slice($e));for(Ge=0;Ge<bt;Ge+=1)if(Ge<St){for(Ie=0,Ke=te[Ge].length;Ie<ze-Ke;Ie+=1)te[Ge].push(te[Ge][Ie%Ke]);if(Ge<q.length)for(let re=0;re<q[Ge].length;re+=1)te[Ge].push(q[Ge][re]);else te[Ge].push(...new Array(q[0].length).fill(null))}else te.push(te[Ge%Ue].slice(0,bt).concat(q[Ge]));o.populateFromArray(qe,$e,te);break;case"overwrite":default:ge.row=U.row,ge.col=U.col;let X=0,F=0,b=!0,ce;const Fe=function(me){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ae=te[me%te.length];return he!==null?Ae[he%Ae.length]:Ae},Le=te.length,ae=V?V.row-U.row+1:0;for(V?Ue=ae:Ue=Math.max(Le,ae),Ge=0;Ge<Ue&&!(V&&ge.row>V.row&&ae>Le||!T.allowInsertRow&&ge.row>o.countRows()-1||ge.row>=T.maxRows);Ge++){const re=Ge-X,me=Fe(re).length,he=V?V.col-U.col+1:0;if(V?Ke=he:Ke=Math.max(me,he),ge.col=U.col,ce=o.getCellMeta(ge.row,ge.col),(ue==="CopyPaste.paste"||ue==="Autofill.fill")&&ce.skipRowOnPaste){X+=1,ge.row+=1,Ue+=1;continue}for(F=0,Ie=0;Ie<Ke&&!(V&&ge.col>V.col&&he>me||!T.allowInsertColumn&&ge.col>o.countCols()-1||ge.col>=T.maxCols);Ie++){if(ce=o.getCellMeta(ge.row,ge.col),(ue==="CopyPaste.paste"||ue==="Autofill.fill")&&ce.skipColumnOnPaste){F+=1,ge.col+=1,Ke+=1;continue}if(ce.readOnly&&ue!=="UndoRedo.undo"){ge.col+=1;continue}const Ae=Ie-F;let je=Fe(re,Ae),ke=o.getDataAtCell(ge.row,ge.col);if(je!==null&&typeof je=="object")if(Array.isArray(je)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")b=!1;else{const et=duckSchema(Array.isArray(ke)?ke:ke[0]||ke),pt=duckSchema(Array.isArray(je)?je:je[0]||je);isObjectEqual(et,pt)||Array.isArray(et)&&Array.isArray(pt)?je=deepClone(je):b=!1}else ke!==null&&typeof ke=="object"&&(b=!1);b&&le.push([ge.row,ge.col,je]),b=!0,ge.col+=1}ge.row+=1}o.setDataAtCell(le,null,null,ue||"populateFromArray");break}}};function Z(U){const te=normalizeLanguageCode(U);hasLanguageDictionary(te)?(o.runHooks("beforeLanguageChange",te),R.language=te,o.runHooks("afterLanguageChange",te)):warnUserAboutLanguageRegistration(U)}function ve(U,te){const V=U==="className"?o.rootElement:o.table;if(m)addClass$1(V,te);else{let ue=[],Ne=[];R[U]&&(ue=Array.isArray(R[U])?R[U]:stringToArray(R[U])),te&&(Ne=Array.isArray(te)?te:stringToArray(te));const Ge=getDifferenceOfArrays(ue,Ne),Ue=getDifferenceOfArrays(Ne,ue);Ge.length&&removeClass$1(V,Ge),Ue.length&&addClass$1(V,Ue)}R[U]=te}this.init=function(){u.setData(T.data),o.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass$1(o.rootElement,"mobile"),this.updateSettings(T,!0),this.view=new TableView(this);const U=T.themeName||getThemeClassName(o.rootElement);o.useTheme(U),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),d=EditorManager.getInstance(o,T,z),C=createViewportScroller(o),f=new FocusManager(o),isRootInstance(this)&&installFocusCatcher(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&o.rootElement.offsetParent===null&&observeVisibilityChangeOnce(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof m=="object"&&(o.runHooks("afterChange",m[0],m[1]),m=!1),o.runHooks("afterInit")};function xe(){let U=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,U=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&U===!1&&(U=!0,this.onQueueEmpty(this.valid))}}}function de(U){const te=U.replace(",",".");return isNaN(parseFloat(te))===!1?parseFloat(te):U}function Se(U,te,V){if(!U.length){V();return}const ue=o.getActiveEditor(),Ne=new xe;let Ge=!0;Ne.onQueueEmpty=()=>{ue&&Ge&&ue.cancelChanges(),V()};for(let Ue=U.length-1;Ue>=0;Ue--){const[Ie,Ke,,le]=U[Ue],ge=l.propToCol(Ke);let we;Number.isInteger(ge)?we=o.getCellMeta(Ie,ge):we={...Object.getPrototypeOf(T),...T},we.type==="numeric"&&typeof le=="string"&&isNumericLike(le)&&(U[Ue][3]=de(le)),o.getCellValidator(we)&&(Ne.addValidatorToQueue(),o.validateCell(U[Ue][3],we,function(qe,$e){return function(ze){if(typeof ze!="boolean")throw new Error("Validation error: result is not boolean");ze===!1&&$e.allowInvalid===!1&&(Ge=!1,U.splice(qe,1),$e.valid=!0),Ne.removeValidatorFormQueue()}}(Ue,we),te))}Ne.checkIfQueueIsEmpty()}function Me(U,te){for(let ue=U.length-1;ue>=0;ue--){let Ne=!1;if(U[ue]===null){U.splice(ue,1);continue}if(!((U[ue][2]===null||U[ue][2]===void 0)&&(U[ue][3]===null||U[ue][3]===void 0))){if(T.allowInsertRow)for(;U[ue][0]>o.countRows()-1;){const{delta:Ge}=l.createRow(void 0,void 0,{source:te});if(Ge===0){Ne=!0;break}}if(o.dataType==="array"&&(!T.columns||T.columns.length===0)&&T.allowInsertColumn)for(;l.propToCol(U[ue][1])>o.countCols()-1;){const{delta:Ge}=l.createCol(void 0,void 0,{source:te});if(Ge===0){Ne=!0;break}}Ne||l.set(U[ue][0],U[ue][1],U[ue][3])}}const V=U.length>0;if(o.forceFullRender=!0,V){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",U,te),d.closeEditor(),o.view.render(),d.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",U,te||"edit");const ue=o.getActiveEditor();ue&&isDefined(ue.refreshValue)&&ue.refreshValue()}else o.view.render()}this._createCellCoords=function(U,te){return o.view._wt.createCellCoords(U,te)},this._createCellRange=function(U,te,V){return o.view._wt.createCellRange(U,te,V)},this.validateCell=function(U,te,V,ue){let Ne=o.getCellValidator(te);function Ge(Ue){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||te.hidden===!0){V(Ue);return}const Ke=te.visualCol,le=te.visualRow,ge=o.getCell(le,Ke,!0);if(ge&&ge.nodeName!=="TH"){const we=o.rowIndexMapper.getRenderableFromVisualIndex(le),qe=o.columnIndexMapper.getRenderableFromVisualIndex(Ke);o.view._wt.getSetting("cellRenderer",we,qe,ge)}V(Ue)}isRegExp$2(Ne)&&(Ne=function(Ue){return function(Ie,Ke){Ke(Ue.test(Ie))}}(Ne)),isFunction$2(Ne)?(U=o.runHooks("beforeValidate",U,te.visualRow,te.prop,ue),o._registerImmediate(()=>{Ne.call(te,U,Ue=>{o&&(Ue=o.runHooks("afterValidate",Ue,U,te.visualRow,te.prop,ue),te.valid=Ue,Ge(Ue),o.runHooks("postAfterValidate",Ue,U,te.visualRow,te.prop,ue))})})):o._registerImmediate(()=>{te.valid=!0,Ge(te.valid,!1)})};function Pe(U,te,V){return Array.isArray(U)?U:[[U,te,V]]}function _e(U,te){const V=o.getActiveEditor(),ue=o.runHooks("beforeChange",U,te||"edit"),Ne=U.filter(Ge=>Ge!==null);return ue===!1||Ne.length===0?(V&&V.cancelChanges(),[]):Ne}this.setDataAtCell=function(U,te,V,ue){const Ne=Pe(U,te,V),Ge=[];let Ue=ue,Ie,Ke,le;for(Ie=0,Ke=Ne.length;Ie<Ke;Ie++){if(typeof Ne[Ie]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Ne[Ie][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Ne[Ie][1]>=this.countCols()?le=Ne[Ie][1]:le=l.colToProp(Ne[Ie][1]),Ge.push([Ne[Ie][0],le,u.getAtCell(this.toPhysicalRow(Ne[Ie][0]),Ne[Ie][1]),Ne[Ie][2]])}!Ue&&typeof U=="object"&&(Ue=te);const ge=_e(Ge,Ue);o.runHooks("afterSetDataAtCell",ge,Ue),Se(ge,Ue,()=>{Me(ge,Ue)})},this.setDataAtRowProp=function(U,te,V,ue){const Ne=Pe(U,te,V),Ge=[];let Ue=ue,Ie,Ke;for(Ie=0,Ke=Ne.length;Ie<Ke;Ie++)Ge.push([Ne[Ie][0],Ne[Ie][1],u.getAtCell(this.toPhysicalRow(Ne[Ie][0]),Ne[Ie][1]),Ne[Ie][2]]);!Ue&&typeof U=="object"&&(Ue=te);const le=_e(Ge,ue);o.runHooks("afterSetDataAtRowProp",le,Ue),Se(le,Ue,()=>{Me(le,Ue)})},this.listen=function(){o&&!o.isListening()&&(foreignHotInstances.forEach(U=>{o!==U&&U.unlisten()}),activeGuid=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===o.guid},this.destroyEditor=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.closeEditor(U),o.view.render(),te&&z.isSelected()&&d.prepareEditor()},this.populateFromArray=function(U,te,V,ue,Ne,Ge,Ue){if(!(typeof V=="object"&&typeof V[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const Ie=typeof ue=="number"?o._createCellCoords(ue,Ne):null;return c.populateFromArray(o._createCellCoords(U,te),V,Ie,Ge,Ue)},this.spliceCol=function(U,te,V){for(var ue=arguments.length,Ne=new Array(ue>3?ue-3:0),Ge=3;Ge<ue;Ge++)Ne[Ge-3]=arguments[Ge];return l.spliceCol(U,te,V,...Ne)},this.spliceRow=function(U,te,V){for(var ue=arguments.length,Ne=new Array(ue>3?ue-3:0),Ge=3;Ge<ue;Ge++)Ne[Ge-3]=arguments[Ge];return l.spliceRow(U,te,V,...Ne)},this.getSelected=function(){if(z.isSelected())return arrayMap(z.getSelectedRange(),U=>{let{from:te,to:V}=U;return[te.row,te.col,V.row,V.col]})},this.getSelectedLast=function(){const U=this.getSelected();let te;return U&&U.length>0&&(te=U[U.length-1]),te},this.getSelectedRange=function(){if(z.isSelected())return Array.from(z.getSelectedRange())},this.getSelectedRangeLast=function(){const U=this.getSelectedRange();let te;return U&&U.length>0&&(te=U[U.length-1]),te},this.emptySelectedCells=function(U){if(!z.isSelected()||this.countRows()===0||this.countCols()===0)return;const te=[];arrayEach(z.getSelectedRange(),V=>{if(V.isSingleHeader())return;const ue=V.getTopStartCorner(),Ne=V.getBottomEndCorner();rangeEach(ue.row,Ne.row,Ge=>{rangeEach(ue.col,Ne.col,Ue=>{this.getCellMeta(Ge,Ue).readOnly||te.push([Ge,Ue,null])})})}),te.length>0&&this.setDataAtCell(te,U)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const U=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(U,0),!this.isRenderSuspended()&&U===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(U){this.suspendRender();const te=U();return this.resumeRender(),te},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const te=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(te,0),(!this.isExecutionSuspended()&&te===this.executionSuspendedCounter||U)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const V=U();return this.resumeExecution(te),V},this.batch=function(U){this.suspendRender(),this.suspendExecution();const te=U();return this.resumeExecution(),this.resumeRender(),te},this.refreshDimensions=function(){if(!o.view)return;const{width:U,height:te}=o.view.getLastSize(),{width:V,height:ue}=o.rootElement.getBoundingClientRect(),Ne=V!==U||ue!==te;o.runHooks("beforeRefreshDimensions",{width:U,height:te},{width:V,height:ue},Ne)!==!1&&((Ne||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(V,ue),o.render()),o.runHooks("afterRefreshDimensions",{width:U,height:te},{width:V,height:ue},Ne))},this.updateData=function(U,te){replaceData(U,V=>{l=V},V=>{l=V,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),z.refresh()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:te,metaManager:_,firstRun:m})},this.loadData=function(U,te){replaceData(U,V=>{l=V},()=>{_.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),z.refresh(),m&&(m=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:te,metaManager:_,firstRun:m})},this.getInitialColumnCount=function(){const U=T.columns;let te=0;if(Array.isArray(U))te=U.length;else if(isFunction$2(U))if(o.dataType==="array"){const V=this.countSourceCols();for(let ue=0;ue<V;ue+=1)U(ue)&&(te+=1)}else(o.dataType==="object"||o.dataType==="function")&&(te=l.colToPropCache.length);else if(isDefined(T.dataSchema)){const V=l.getSchema();te=Array.isArray(V)?V.length:deepObjectSize(V)}else te=this.countSourceCols();return te},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(U,te,V,ue){return isUndefined$1(U)?l.getAll():l.getRange(o._createCellCoords(U,te),o._createCellCoords(V,ue),l.DESTINATION_RENDERER)},this.getCopyableText=function(U,te,V,ue){return l.getCopyableText(o._createCellCoords(U,te),o._createCellCoords(V,ue))},this.getCopyableData=function(U,te){return l.getCopyable(U,l.colToProp(te))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const V=(m?o.loadData:o.updateData).bind(this);let ue=!1,Ne,Ge;if(isDefined(U.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(U.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(U.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(Ne in U)Ne==="data"||(Ne==="language"?Z(U.language):Ne==="className"?ve("className",U.className):Ne==="tableClassName"&&o.table?(ve("tableClassName",U.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Hooks.getSingleton().isRegistered(Ne)||Hooks.getSingleton().isDeprecated(Ne)?isFunction$2(U[Ne])?Hooks.getSingleton().addAsFixed(Ne,U[Ne],o):Array.isArray(U[Ne])&&Hooks.getSingleton().add(Ne,U[Ne],o):!te&&hasOwnProperty(U,Ne)&&(R[Ne]=U[Ne]));U.data===void 0&&T.data===void 0?V(null,"updateSettings"):U.data!==void 0?V(U.data,"updateSettings"):U.columns!==void 0&&(l.createMap(),o.initIndexMappers());const Ue=o.countCols(),Ie=T.columns;if(Ie&&isFunction$2(Ie)&&(ue=!0),(U.cell!==void 0||U.cells!==void 0||U.columns!==void 0)&&_.clearCache(),Ue>0)for(Ne=0,Ge=0;Ne<Ue;Ne++){if(Ie){const ge=ue?Ie(Ne):Ie[Ge];ge&&_.updateColumnMeta(Ge,ge)}Ge+=1}isDefined(U.cell)&&objectEach(U.cell,ge=>{o.setCellMetaObject(ge.row,ge.col,ge)}),o.runHooks("afterCellMetaReset");let Ke=o.rootElement.style.height;Ke!==""&&(Ke=parseInt(o.rootElement.style.height,10));let le=U.height;if(isFunction$2(le)&&(le=le()),te&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),le===null){const ge=o.rootElement.getAttribute("data-initialstyle");ge&&(ge.indexOf("height")>-1||ge.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",ge):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else le!==void 0&&(o.rootElement.style.height=isNaN(le)?`${le}`:`${le}px`,o.rootElement.style.overflow="hidden");if(typeof U.width<"u"){let ge=U.width;isFunction$2(ge)&&(ge=ge()),o.rootElement.style.width=isNaN(ge)?`${ge}`:`${ge}px`}if(!te){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const ge=o.getCurrentThemeName(),we=hasOwnProperty(U,"themeName");ge&&we&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(ge));const qe=we&&U.themeName||getThemeClassName(o.rootElement);o.useTheme(qe),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",U)}c.adjustRowsAndCols(),o.view&&!m&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!te&&o.view&&(Ke===""||le===""||le===void 0)&&Ke!==le&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const U=o.getSelectedLast();if(T.getValue){if(isFunction$2(T.getValue))return T.getValue.call(o);if(U)return o.getData()[U[0][0]][T.getValue]}else if(U)return o.getDataAtCell(U[0],U[1])},this.getSettings=function(){return T},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(U,te,V,ue,Ne){c.alter(U,te,V,ue,Ne)},this.getCell=function(U,te){let V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ue=te,Ne=U;if(te>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(te)))return null;ue=this.columnIndexMapper.getRenderableFromVisualIndex(te)}if(U>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(U)))return null;Ne=this.rowIndexMapper.getRenderableFromVisualIndex(U)}return Ne===null||ue===null||Ne===void 0||ue===void 0?null:o.view.getCellAtCoords(o._createCellCoords(Ne,ue),V)},this.getCoords=function(U){const te=this.view._wt.wtTable.getCoords(U);if(te===null)return null;const{row:V,col:ue}=te;let Ne=V,Ge=ue;return V>=0&&(Ne=this.rowIndexMapper.getVisualFromRenderableIndex(V)),ue>=0&&(Ge=this.columnIndexMapper.getVisualFromRenderableIndex(ue)),o._createCellCoords(Ne,Ge)},this.colToProp=function(U){return l.colToProp(U)},this.propToCol=function(U){return l.propToCol(U)},this.toVisualRow=U=>this.rowIndexMapper.getVisualFromPhysicalIndex(U),this.toVisualColumn=U=>this.columnIndexMapper.getVisualFromPhysicalIndex(U),this.toPhysicalRow=U=>this.rowIndexMapper.getPhysicalFromVisualIndex(U),this.toPhysicalColumn=U=>this.columnIndexMapper.getPhysicalFromVisualIndex(U),this.getDataAtCell=function(U,te){return l.get(U,l.colToProp(te))},this.getDataAtRowProp=function(U,te){return l.get(U,te)},this.getDataAtCol=function(U){const te=[],V=l.getRange(o._createCellCoords(0,U),o._createCellCoords(T.data.length-1,U),l.DESTINATION_RENDERER);for(let ue=0;ue<V.length;ue+=1)for(let Ne=0;Ne<V[ue].length;Ne+=1)te.push(V[ue][Ne]);return te},this.getDataAtProp=function(U){const te=[],V=l.getRange(o._createCellCoords(0,l.propToCol(U)),o._createCellCoords(T.data.length-1,l.propToCol(U)),l.DESTINATION_RENDERER);for(let ue=0;ue<V.length;ue+=1)for(let Ne=0;Ne<V[ue].length;Ne+=1)te.push(V[ue][Ne]);return te},this.getSourceData=function(U,te,V,ue){let Ne;return U===void 0?Ne=u.getData():Ne=u.getByRange(o._createCellCoords(U,te),o._createCellCoords(V,ue)),Ne},this.getSourceDataArray=function(U,te,V,ue){let Ne;return U===void 0?Ne=u.getData(!0):Ne=u.getByRange(o._createCellCoords(U,te),o._createCellCoords(V,ue),!0),Ne},this.getSourceDataAtCol=function(U){return u.getAtColumn(U)},this.setSourceDataAtCell=function(U,te,V,ue){const Ne=Pe(U,te,V),Ge=this.hasHook("afterSetSourceDataAtCell"),Ue=[];Ge&&arrayEach(Ne,Ke=>{let[le,ge,we]=Ke;Ue.push([le,ge,u.getAtCell(le,ge),we])}),arrayEach(Ne,Ke=>{let[le,ge,we]=Ke;u.setAtCell(le,ge,we)}),Ge&&this.runHooks("afterSetSourceDataAtCell",Ue,ue),this.render();const Ie=o.getActiveEditor();Ie&&isDefined(Ie.refreshValue)&&Ie.refreshValue()},this.getSourceDataAtRow=function(U){return u.getAtRow(U)},this.getSourceDataAtCell=function(U,te){return u.getAtCell(U,te)},this.getDataAtRow=function(U){return l.getRange(o._createCellCoords(U,0),o._createCellCoords(U,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(U,te,V,ue){const Ne=U===void 0?[0,0,this.countRows(),this.countCols()]:[U,te,V,ue],[Ge,Ue]=Ne;let[,,Ie,Ke]=Ne,le=null,ge=null;Ie===void 0&&(Ie=Ge),Ke===void 0&&(Ke=Ue);let we="mixed";return rangeEach(Math.max(Math.min(Ge,Ie),0),Math.max(Ge,Ie),qe=>{let $e=!0;return rangeEach(Math.max(Math.min(Ue,Ke),0),Math.max(Ue,Ke),ze=>(ge=this.getCellMeta(qe,ze).type,le?$e=le===ge:le=ge,$e)),we=$e?ge:"mixed",$e}),we},this.removeCellMeta=function(U,te,V){const[ue,Ne]=[this.toPhysicalRow(U),this.toPhysicalColumn(te)];let Ge=_.getCellMetaKeyValue(ue,Ne,V);o.runHooks("beforeRemoveCellMeta",U,te,V,Ge)!==!1&&(_.removeCellMeta(ue,Ne,V),o.runHooks("afterRemoveCellMeta",U,te,V,Ge)),Ge=null},this.spliceCellsMeta=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var V=arguments.length,ue=new Array(V>2?V-2:0),Ne=2;Ne<V;Ne++)ue[Ne-2]=arguments[Ne];if(ue.length>0&&!Array.isArray(ue[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");te>0&&_.removeRow(this.toPhysicalRow(U),te),ue.length>0&&arrayEach(ue.reverse(),Ge=>{_.createRow(this.toPhysicalRow(U)),arrayEach(Ge,(Ue,Ie)=>this.setCellMetaObject(U,Ie,Ue))}),o.render()},this.setCellMetaObject=function(U,te,V){typeof V=="object"&&objectEach(V,(ue,Ne)=>{this.setCellMeta(U,te,Ne,ue)})},this.setCellMeta=function(U,te,V,ue){if(o.runHooks("beforeSetCellMeta",U,te,V,ue)===!1)return;let Ge=U,Ue=te;U<this.countRows()&&(Ge=this.toPhysicalRow(U)),te<this.countCols()&&(Ue=this.toPhysicalColumn(te)),_.setCellMeta(Ge,Ue,V,ue),o.runHooks("afterSetCellMeta",U,te,V,ue)},this.getCellsMeta=function(){return _.getCellsMeta()},this.getCellMeta=function(U,te){let V=this.toPhysicalRow(U),ue=this.toPhysicalColumn(te);return V===null&&(V=U),ue===null&&(ue=te),_.getCellMeta(V,ue,{visualRow:U,visualColumn:te})},this.getColumnMeta=function(U){return _.getColumnMeta(this.toPhysicalColumn(U))},this.getCellMetaAtRow=function(U){return _.getCellsMetaAtRow(U)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||T.columns)},this.getCellRenderer=function(U,te){const V=typeof U=="number"?o.getCellMeta(U,te).renderer:U.renderer;return typeof V=="string"?_getItem$2(V):isUndefined$1(V)?_getItem$2("text"):V},this.getCellEditor=function(U,te){const V=typeof U=="number"?o.getCellMeta(U,te).editor:U.editor;return typeof V=="string"?_getItem$3(V):isUndefined$1(V)?_getItem$3("text"):V},this.getCellValidator=function(U,te){const V=typeof U=="number"?o.getCellMeta(U,te).validator:U.validator;return typeof V=="string"?_getItem$1(V):V},this.validateCells=function(U){this._validateCells(U)},this.validateRows=function(U,te){if(!Array.isArray(U))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(te,U)},this.validateColumns=function(U,te){if(!Array.isArray(U))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(te,void 0,U)},this._validateCells=function(U,te,V){const ue=new xe;U&&(ue.onQueueEmpty=U);let Ne=o.countRows()-1;for(;Ne>=0;){if(te!==void 0&&te.indexOf(Ne)===-1){Ne-=1;continue}let Ge=o.countCols()-1;for(;Ge>=0;){if(V!==void 0&&V.indexOf(Ge)===-1){Ge-=1;continue}ue.addValidatorToQueue(),o.validateCell(o.getDataAtCell(Ne,Ge),o.getCellMeta(Ne,Ge),Ue=>{if(typeof Ue!="boolean")throw new Error("Validation error: result is not boolean");Ue===!1&&(ue.valid=!1),ue.removeValidatorFormQueue()},"validateCells"),Ge-=1}Ne-=1}ue.checkIfQueueIsEmpty()},this.getRowHeader=function(U){let te=T.rowHeaders,V=U;return V!==void 0&&(V=o.runHooks("modifyRowHeader",V)),V===void 0?(te=[],rangeEach(o.countRows()-1,ue=>{te.push(o.getRowHeader(ue))})):Array.isArray(te)&&te[V]!==void 0?te=te[V]:isFunction$2(te)?te=te(V):te&&typeof te!="string"&&typeof te!="number"&&(te=V+1),te},this.hasRowHeaders=function(){return!!T.rowHeaders},this.hasColHeaders=function(){if(T.colHeaders!==void 0&&T.colHeaders!==null)return!!T.colHeaders;for(let U=0,te=o.countCols();U<te;U++)if(o.getColHeader(U))return!0;return!1},this.getColHeader=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const V=o.runHooks("modifyColHeader",U);if(V===void 0){const Ie=[],Ke=o.countCols();for(let le=0;le<Ke;le++)Ie.push(o.getColHeader(le));return Ie}let ue=T.colHeaders;const Ne=function(Ie){const Ke=[],le=o.countCols();let ge=0;for(;ge<le;ge++)isFunction$2(T.columns)&&T.columns(ge)&&Ke.push(ge);return Ke[Ie]},Ge=o.toPhysicalColumn(V),Ue=Ne(Ge);return T.colHeaders===!1?ue=null:T.columns&&isFunction$2(T.columns)&&T.columns(Ue)&&T.columns(Ue).title?ue=T.columns(Ue).title:T.columns&&T.columns[Ge]&&T.columns[Ge].title?ue=T.columns[Ge].title:Array.isArray(T.colHeaders)&&T.colHeaders[Ge]!==void 0?ue=T.colHeaders[Ge]:isFunction$2(T.colHeaders)?ue=T.colHeaders(Ge):T.colHeaders&&typeof T.colHeaders!="string"&&typeof T.colHeaders!="number"&&(ue=spreadsheetColumnLabel(V)),ue=o.runHooks("modifyColumnHeaderValue",ue,U,te),ue},this._getColWidthFromSettings=function(U){let te;if(U>=0&&(te=o.getCellMeta(0,U).width),(te===void 0||te===T.width)&&(te=T.colWidths),te!=null){switch(typeof te){case"object":te=te[U];break;case"function":te=te(U);break}typeof te=="string"&&(te=parseInt(te,10))}return te},this.getColWidth=function(U,te){let V=o._getColWidthFromSettings(U);return V=o.runHooks("modifyColWidth",V,U,te),V===void 0&&(V=DEFAULT_WIDTH),V},this._getRowHeightFromSettings=function(U){let te=T.rowHeights;if(te!=null){switch(typeof te){case"object":te=te[U];break;case"function":te=te(U);break}typeof te=="string"&&(te=parseInt(te,10))}return te},this.getRowHeight=function(U,te){let V=o._getRowHeightFromSettings(U);return V=o.runHooks("modifyRowHeight",V,U,te),V},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const U=T.maxCols,te=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(U,te)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=0;return rangeEachReverse(o.countRows()-1,V=>{if(o.isEmptyRow(V))te+=1;else if(U===!0)return!1}),te},this.countEmptyCols=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=0;return rangeEachReverse(o.countCols()-1,V=>{if(o.isEmptyCol(V))te+=1;else if(U===!0)return!1}),te},this.isEmptyRow=function(U){return T.isEmptyRow.call(o,U)},this.isEmptyCol=function(U){return T.isEmptyCol.call(o,U)},this.selectCell=function(U,te,V,ue){let Ne=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,Ge=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined$1(U)||isUndefined$1(te)?!1:this.selectCells([[U,te,V,ue]],Ne,Ge)},this.selectCells=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;te===!1&&C.suspend();const ue=z.selectCells(U);return ue&&V&&o.listen(),C.resume(),ue},this.selectColumns=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,V=arguments.length>2?arguments[2]:void 0;return z.selectColumns(U,te,V)},this.selectRows=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,V=arguments.length>2?arguments[2]:void 0;return z.selectRows(U,te,V)},this.deselectCell=function(){z.deselect()},this.selectAll=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,V=arguments.length>2?arguments[2]:void 0;C.skipNextScrollCycle(),z.selectAll(U,te,V)};const Oe=(U,te)=>U.getNearestNotHiddenIndex(te,1,!0);this.scrollViewportTo=function(U){var te;if(typeof U=="number"){var V;U={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(V=arguments[4])!==null&&V!==void 0?V:!0}}const{row:ue,col:Ne,considerHiddenIndexes:Ge}=(te=U)!==null&&te!==void 0?te:{};let Ue=ue,Ie=Ne;if(Ge===void 0||Ge){const ge=Number.isInteger(ue)&&ue>=0,we=Number.isInteger(Ne)&&Ne>=0,qe=ge?Oe(this.rowIndexMapper,ue):void 0,$e=we?Oe(this.columnIndexMapper,Ne):void 0;if(qe===null||$e===null)return!1;Ue=ge?o.rowIndexMapper.getRenderableFromVisualIndex(qe):ue,Ie=we?o.columnIndexMapper.getRenderableFromVisualIndex($e):Ne}const Ke=Number.isInteger(Ue),le=Number.isInteger(Ie);return Ke&&Ue>=0&&le&&Ie>=0?o.view.scrollViewport(o._createCellCoords(Ue,Ie),U.horizontalSnap,U.verticalSnap):Ke&&Ue>=0&&(le&&Ie<0||!le)?o.view.scrollViewportVertically(Ue,U.verticalSnap):le&&Ie>=0&&(Ke&&Ue<0||!Ke)?o.view.scrollViewportHorizontally(Ie,U.horizontalSnap):!1},this.scrollToFocusedCell=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",U);const{highlight:te}=this.getSelectedRangeLast();this.scrollViewportTo(te.toObject())?this.view.render():(this.removeHook("afterScroll",U),this._registerImmediate(()=>U()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),_.clearCache(),foreignHotInstances.delete(this.guid),isRootInstance(o)){const U=this.rootDocument.querySelector(".hot-display-license-info");U&&U.parentNode.removeChild(U)}empty$2(o.rootElement),a.destroy(),d&&d.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),O.getItems().forEach(U=>{let[,te]=U;te.destroy()}),O.clear(),o.runHooks("afterDestroy")},!0),Hooks.getSingleton().destroy(o),objectEach(o,(U,te,V)=>{isFunction$2(U)?V[te]=st(te):te!=="guid"&&(V[te]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,c=null,z=null,d=null,o=null};function st(U){return()=>{throw new Error(`The "${U}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(U){const te=toUpperCaseFirst(U);return te==="UndoRedo"?this.undoRedo:O.getItem(te)},this.getPluginName=function(U){return U===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(U)},this.getInstance=function(){return o},this.addHook=function(U,te,V){Hooks.getSingleton().add(U,te,o,V)},this.hasHook=function(U){return Hooks.getSingleton().has(U,o)||Hooks.getSingleton().has(U)},this.addHookOnce=function(U,te,V){Hooks.getSingleton().once(U,te,o,V)},this.removeHook=function(U,te){Hooks.getSingleton().remove(U,te,o)},this.runHooks=function(U,te,V,ue,Ne,Ge,Ue){return Hooks.getSingleton().run(o,U,te,V,ue,Ne,Ge,Ue)},this.getTranslatedPhrase=function(U,te){return getTranslatedPhrase(T.language,U,te)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const U=this.rootDocument.createElement("div");return U.insertAdjacentHTML("afterbegin",instanceToHTML(this)),U.firstElementChild},this.timeouts=[],this.useTheme=U=>{this.view.getStylesHandler().useTheme(U),this.runHooks("afterSetTheme",U,!!m)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(U){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,V=U;typeof V=="function"&&(V=setTimeout(V,te)),this.timeouts.push(V)},this._clearTimeouts=function(){arrayEach(this.timeouts,U=>{clearTimeout(U)})},this.immediates=[],this._registerImmediate=function(U){this.immediates.push(setImmediate(U))},this._clearImmediates=function(){arrayEach(this.immediates,U=>{clearImmediate(U)})},this._getEditorManager=function(){return d},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const rt=createShortcutManager({handleEvent(){return o.isListening()},beforeKeyDown:U=>this.runHooks("beforeKeyDown",U),afterKeyDown:U=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",U)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",U=>{U.ctrlKey===!1&&U.metaKey===!1&&rt.releasePressedKeys()}),this.getShortcutManager=function(){return rt},this.getFocusManager=function(){return f},getPluginsNames().forEach(U=>{const te=getPlugin(U);O.addItem(U,new te(this))}),registerAllShortcutContexts(o),rt.setActiveContextName("grid"),Hooks.getSingleton().run(o,"construct")}_register(TextCellType);Handsontable$1.editors={BaseEditor};function Handsontable$1(r,e){const t=new Core(r,e||{},rootInstanceSymbol);return t.init(),t}Handsontable$1.Core=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(r,e,rootInstanceSymbol)};Handsontable$1.DefaultSettings=metaSchemaFactory();Handsontable$1.hooks=Hooks.getSingleton();Handsontable$1.CellCoords=CellCoords;Handsontable$1.CellRange=CellRange;Handsontable$1.packageName="handsontable";Handsontable$1.buildDate="16/12/2024 13:19:38";Handsontable$1.version="15.0.0";Handsontable$1.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};var bulkComponentContainer=null,AUTOSIZE_WARNING="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",OBSOLETE_HOTRENDERER_WARNING="Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead.",OBSOLETE_HOTEDITOR_WARNING="Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead.",UNEXPECTED_HOTTABLE_CHILDREN_WARNING="Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.",UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING="Unexpected children nodes found in HotColumn component. HotColumn components do not support any children.",HOT_DESTROYED_WARNING="The Handsontable instance bound to this component was destroyed and cannot be used properly.",DEFAULT_CLASSNAME="hot-wrapper-editor-container";function warn(){if(typeof console<"u"){var r;(r=console).warn.apply(r,arguments)}}function displayObsoleteRenderersEditorsWarning(r){return hasChildElementOfType(r,"hot-renderer")?(warn(OBSOLETE_HOTRENDERER_WARNING),!0):hasChildElementOfType(r,"hot-editor")?(warn(OBSOLETE_HOTEDITOR_WARNING),!0):!1}function displayChildrenOfTypeWarning(r,e){var t=React.Children.toArray(r);return t.some(function(n){return n.type!==e})?(warn(UNEXPECTED_HOTTABLE_CHILDREN_WARNING),!0):!1}function displayAnyChildrenWarning(r){var e=React.Children.toArray(r);return e.length?(warn(UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING),!0):!1}function hasChildElementOfType(r,e){var t=React.Children.toArray(r);return t.some(function(n){return n.props[e]!==void 0})}function createEditorPortal(r,e){if(!r||!e)return null;var t=React.createElement(e,null),n=getContainerAttributesProps({},!1);return n.className="".concat(DEFAULT_CLASSNAME," ").concat(n.className),ReactDOM.createPortal(React.createElement("div",Object.assign({},n),t),r.body)}function createPortal(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;e||(e=document),bulkComponentContainer||(bulkComponentContainer=e.createDocumentFragment());var s=n??e.createElement("DIV");return bulkComponentContainer.appendChild(s),{portal:ReactDOM.createPortal(r,s,t),portalContainer:s}}function getContainerAttributesProps(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:r.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:r.className||"",style:r.style||{}}}function isCSR(){return typeof window<"u"}function useUpdateEffect(r,e){var t=React.useRef(!1);reactExports.useEffect(function(){if(t.current)return r();t.current=!0},e)}function _arrayLikeToArray(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _assertThisInitialized(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _callSuper(r,e,t){return e=_getPrototypeOf(e),_possibleConstructorReturn(r,_isNativeReflectConstruct()?Reflect.construct(e,t,_getPrototypeOf(r).constructor):e.apply(r,t))}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,_toPropertyKey(n.key),n)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function _defineProperty(r,e,t){return(e=_toPropertyKey(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _getPrototypeOf(r){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(r)}function _inherits(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&_setPrototypeOf(r,e)}function _isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!r})()}function _iterableToArray(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function _iterableToArrayLimit(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,s,o,a,l=[],u=!0,c=!1;try{if(o=(t=t.call(r)).next,e!==0)for(;!(u=(n=o.call(t)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(d){c=!0,s=d}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw s}}return l}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function _objectSpread2(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(n){_defineProperty(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function _objectWithoutProperties(r,e){if(r==null)return{};var t,n,s=_objectWithoutPropertiesLoose$1(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)t=o[n],e.includes(t)||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function _objectWithoutPropertiesLoose$1(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}function _possibleConstructorReturn(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(r)}function _setPrototypeOf(r,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},_setPrototypeOf(r,e)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _toPrimitive(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function _toPropertyKey(r){var e=_toPrimitive(r,"string");return typeof e=="symbol"?e:e+""}function _unsupportedIterableToArray(r,e){if(r){if(typeof r=="string")return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}var SettingsMapper=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"getSettings",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.prevProps,o=s===void 0?{}:s,a=n.isInit,l=a===void 0?!1:a,u=n.initOnlySettingKeys,c=u===void 0?[]:u,d=function(E){return!l&&c.includes(E)?o[E]===t[E]:!1},f={};for(var C in t)C!=="children"&&!d(C)&&t.hasOwnProperty(C)&&(f[C]=t[C]);return f}}])}(),HotTableContext=reactExports.createContext(void 0),HotTableContextProvider=function(e){var t=e.children,n=reactExports.useRef([]),s=reactExports.useCallback(function(_,T){n.current[T]=_},[]),o=reactExports.useRef(new Map),a=reactExports.useRef(new Map),l=reactExports.useCallback(function(){return a.current.clear()},[]),u=reactExports.useRef(new Map),c=reactExports.useCallback(function(){return u.current.clear()},[]),d=reactExports.useRef(new Map),f=reactExports.useCallback(function(_){return function(R,O,N,G,D,k,z){var ne="".concat(N,"-").concat(G),Z=R.guid,ve="".concat(Z,"-").concat(ne),xe="".concat(ne,"-").concat(Z);if(a.current.has(ne)&&(O.innerHTML=a.current.get(ne).innerHTML),O&&!O.getAttribute("ghost-table")){for(var de=u.current.get(xe),Se=d.current.get(ve);O.firstChild;)O.removeChild(O.firstChild);if(de&&Se)O.appendChild(Se);else{var Me=React.createElement(_,{instance:R,TD:O,row:N,col:G,prop:D,value:k,cellProperties:z}),Pe=createPortal(Me,O.ownerDocument,xe,Se),_e=Pe.portal,Oe=Pe.portalContainer;d.current.set(ve,Oe),O.appendChild(Oe),u.current.set(xe,_e)}}return a.current.set("".concat(N,"-").concat(G),O),O}},[]),C=reactExports.useRef(function(){}),m=reactExports.useCallback(function(_){C.current=_},[]),E=reactExports.useCallback(function(){C.current(_toConsumableArray(u.current.values()))},[]),v=reactExports.useMemo(function(){return{componentRendererColumns:o.current,columnsSettings:n.current,emitColumnSettings:s,getRendererWrapper:f,clearPortalCache:c,clearRenderedCellCache:l,setRenderersPortalManagerRef:m,pushCellPortalsIntoPortalManager:E}},[s,f,l,m,E]);return React.createElement(HotTableContext.Provider,{value:v},t)};function useHotTableContext(){return reactExports.useContext(HotTableContext)}var HotColumnContext=reactExports.createContext(void 0),HotColumnContextProvider=function(e){var t=e.columnIndex,n=e.getOwnerDocument,s=e.children,o=reactExports.useMemo(function(){return{columnIndex:t,getOwnerDocument:n}},[t,n]);return React.createElement(HotColumnContext.Provider,{value:o},s)},useHotColumnContext=function(){return reactExports.useContext(HotColumnContext)},AbstractMethods=["close","focus","open"],ExcludedMethods=["getValue","setValue"],MethodsMap={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function makeEditorClass(r,e){return function(t){function n(s){var o;return _classCallCheck(this,n),o=_callSuper(this,n,[s]),e.current=o,Object.getOwnPropertyNames(Handsontable$1.editors.BaseEditor.prototype).forEach(function(a){if(!(a==="constructor"||ExcludedMethods.includes(a))){var l=Handsontable$1.editors.BaseEditor.prototype[a];n.prototype[a]=(function(){for(var u,c,d=arguments.length,f=new Array(d),C=0;C<d;C++)f[C]=arguments[C];if(AbstractMethods.includes(a)||(c=l.call.apply(l,[this].concat(f))),MethodsMap[a]&&(u=r.current)!==null&&u!==void 0&&u[MethodsMap[a]]){var m;c=(m=r.current[MethodsMap[a]]).call.apply(m,[this].concat(f))}return c}).bind(o)}}),o}return _inherits(n,t),_createClass(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(o){this.value=o}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Handsontable$1.editors.BaseEditor)}var EditorContext$1=reactExports.createContext(void 0),EditorContextProvider=function(e){var t=e.hooksRef,n=e.hotCustomEditorInstanceRef,s=e.children;return React.createElement(EditorContext$1.Provider,{value:{hooksRef:t,hotCustomEditorInstanceRef:n}},s)};function useHotEditor(r,e){var t=reactExports.useContext(EditorContext$1),n=t.hooksRef,s=t.hotCustomEditorInstanceRef,o=reactExports.useState(0),a=_slicedToArray(o,2),l=a[0],u=a[1],c=reactExports.useState(),d=_slicedToArray(c,2),f=d[0],C=d[1],m=reactExports.useDeferredValue(f);return reactExports.useImperativeHandle(n,function(){return _objectSpread2(_objectSpread2({},r),{},{onOpen:function(){var v,_;C((v=s.current)===null||v===void 0?void 0:v.getValue()),r==null||(_=r.onOpen)===null||_===void 0||_.call(r),u(function(T){return T+1})}})},e),reactExports.useMemo(function(){return{get value(){return m},setValue:function(v){var _;C(v),(_=s.current)===null||_===void 0||_.setValue(v)},get isOpen(){var E,v;return(E=(v=s.current)===null||v===void 0?void 0:v.isOpened())!==null&&E!==void 0?E:!1},finishEditing:function(){var v;(v=s.current)===null||v===void 0||v.finishEditing()},get row(){var E;return(E=s.current)===null||E===void 0?void 0:E.row},get col(){var E;return(E=s.current)===null||E===void 0?void 0:E.col}}},[l,s,m])}var isHotColumn=function(e){return e.type===HotColumn},internalProps=["_columnIndex","_getOwnerDocument","children"],HotColumn=function(e){var t=useHotTableContext(),n=t.componentRendererColumns,s=t.emitColumnSettings,o=t.getRendererWrapper,a=useHotColumnContext(),l=a.columnIndex,u=a.getOwnerDocument,c=reactExports.useRef(null),d=reactExports.useRef(null);reactExports.useEffect(function(){var C=function(){return Object.keys(e).filter(function(_){return!internalProps.includes(_)}).reduce(function(_,T){return _[T]=e[T],_},{})},m=function(){var _=SettingsMapper.getSettings(C());return e.renderer?(_.renderer=o(e.renderer),n.set(l,!0)):e.hotRenderer&&(_.renderer=e.hotRenderer),e.editor?_.editor=makeEditorClass(c,d):e.hotEditor&&(_.editor=e.hotEditor),_},E=m();s(E,l),displayObsoleteRenderersEditorsWarning(e.children)||displayAnyChildrenWarning(e.children)});var f=createEditorPortal(u(),e.editor);return React.createElement(EditorContextProvider,{hooksRef:c,hotCustomEditorInstanceRef:d},f)},version="15.0.0",RenderersPortalManager=reactExports.forwardRef(function(r,e){var t=reactExports.useState([]),n=_slicedToArray(t,2),s=n[0],o=n[1];return reactExports.useImperativeHandle(e,function(){return o}),React.createElement(reactExports.Fragment,null,s)});function getDefaultExportFromCjs$1(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=r,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var r=requireReactPropTypesSecret();function e(){}function t(){}return t.resetWarningCache=e,factoryWithThrowingShims=function(){function s(l,u,c,d,f,C){if(C!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}s.isRequired=s;function o(){return s}var a={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:o,element:s,elementType:s,instanceOf:o,node:s,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},factoryWithThrowingShims}propTypes.exports=requireFactoryWithThrowingShims()();var propTypesExports=propTypes.exports,PropTypes=getDefaultExportFromCjs$1(propTypesExports),HotTableInner=reactExports.forwardRef(function(r,e){var t=reactExports.useRef(null),n=reactExports.useRef(null),s=reactExports.useRef(null),o=reactExports.useRef(null),a=reactExports.useRef(),l=useHotTableContext(),u=reactExports.useCallback(function(){return!t.current||!t.current.isDestroyed?t.current:(console.warn(HOT_DESTROYED_WARNING),null)},[t]),c=reactExports.useCallback(function(){return!t.current||t.current.isDestroyed},[t]),d=reactExports.useCallback(function(){l.clearRenderedCellCache(),l.componentRendererColumns.clear()},[l]),f=reactExports.useCallback(function(){return isCSR()?n.current?n.current.ownerDocument:document:null},[n]),C=function(){var R,O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},G=c()?[]:((R=u())===null||R===void 0||(R=R.getSettings())===null||R===void 0?void 0:R._initOnlySettings)||[],D=SettingsMapper.getSettings(r,{prevProps:N,isInit:O,initOnlySettingKeys:G});return D.columns=l.columnsSettings.length?l.columnsSettings:D.columns,r.renderer?(D.renderer=l.getRendererWrapper(r.renderer),l.componentRendererColumns.set("global",!0)):D.renderer=r.hotRenderer||_getItem$2("text"),r.editor?D.editor=makeEditorClass(s,o):D.editor=r.hotEditor||_getItem$3("text"),D},m=function(R){var O,N;R&&((O=R.getPlugin("autoRowSize"))!==null&&O!==void 0&&O.enabled||(N=R.getPlugin("autoColumnSize"))!==null&&N!==void 0&&N.enabled)&&l.componentRendererColumns.size>0&&warn(AUTOSIZE_WARNING)};reactExports.useEffect(function(){var T=C(!0);return a.current=r,t.current=new Handsontable$1.Core(n.current,T),t.current.addHook("beforeViewRender",function(){l.clearPortalCache(),l.clearRenderedCellCache()}),t.current.addHook("afterViewRender",function(){l.pushCellPortalsIntoPortalManager()}),t.current.init(),m(t.current),displayObsoleteRenderersEditorsWarning(r.children)||displayChildrenOfTypeWarning(r.children,HotColumn),function(){var R;d(),(R=u())===null||R===void 0||R.destroy()}},[]),useUpdateEffect(function(){d();var T=u(),R=C(!1,a.current);a.current=r,T==null||T.updateSettings(R,!1),m(T),displayObsoleteRenderersEditorsWarning(r.children)}),reactExports.useImperativeHandle(e,function(){return{get hotElementRef(){return n.current},get hotInstance(){return u()}}});var E=reactExports.Children.toArray(r.children).filter(isHotColumn).map(function(T,R){return React.createElement(HotColumnContextProvider,{columnIndex:R,getOwnerDocument:f,key:R},T)}),v=getContainerAttributesProps(r),_=createEditorPortal(f(),r.editor);return React.createElement(reactExports.Fragment,null,React.createElement("div",Object.assign({ref:n},v),E),React.createElement(RenderersPortalManager,{ref:l.setRenderersPortalManagerRef}),React.createElement(EditorContextProvider,{hooksRef:s,hotCustomEditorInstanceRef:o},_))});HotTableInner.propTypes={style:PropTypes.object,id:PropTypes.string,className:PropTypes.string};var _excluded=["children"],HotTable=reactExports.forwardRef(function(r,e){var t,n=r.children,s=_objectWithoutProperties(r,_excluded),o=(t=s.id)!==null&&t!==void 0?t:reactExports.useId();return React.createElement(HotTableContextProvider,null,React.createElement(HotTableInner,Object.assign({id:o},s,{ref:e}),n))});HotTable.version=version;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ReferenceType;(function(r){r.RELATIVE="RELATIVE",r.ABSOLUTE="ABSOLUTE"})(ReferenceType||(ReferenceType={}));class ColumnAddress{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new ColumnAddress(ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new ColumnAddress(ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===ReferenceType.ABSOLUTE}isColumnRelative(){return this.type===ReferenceType.RELATIVE}isAbsolute(){return this.type===ReferenceType.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new ColumnAddress(this.type,this.col+t,s)}shiftedByColumns(e){return new ColumnAddress(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=absoluteSheetReference(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),simpleColumnAddress(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new ColumnAddress(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new ColumnAddress(this.type,n,this.sheet)}withSheet(e){return new ColumnAddress(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case ReferenceType.RELATIVE:return`${t}#COLR${this.col}`;case ReferenceType.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(invalidSimpleColumnAddress(t))return;const n=columnIndexToLabel(t.col);return`${this.type===ReferenceType.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowAddress{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new RowAddress(ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new RowAddress(ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===ReferenceType.ABSOLUTE}isRowRelative(){return this.type===ReferenceType.RELATIVE}isAbsolute(){return this.type===ReferenceType.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new RowAddress(this.type,this.row+n,s)}shiftedByRows(e){return new RowAddress(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=absoluteSheetReference(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),simpleRowAddress(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new RowAddress(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new RowAddress(this.type,n,this.sheet)}withSheet(e){return new RowAddress(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case ReferenceType.RELATIVE:return`${t}#ROWR${this.row}`;case ReferenceType.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return invalidSimpleRowAddress(t)?void 0:`${this.type===ReferenceType.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CellReferenceType;(function(r){r.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",r.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",r.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",r.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(CellReferenceType||(CellReferenceType={}));class CellAddress{constructor(e,t,n,s){this.col=e,this.row=t,this.type=n,this.sheet=s}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?CellAddress.absolute.bind(this):e.isColumnAbsolute()?CellAddress.absoluteCol.bind(this):t.isRowAbsolute()?CellAddress.absoluteRow.bind(this):CellAddress.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=absoluteSheetReference(this,e);return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE?simpleCellAddress(t,this.col,this.row):this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW?simpleCellAddress(t,e.col+this.col,this.row):this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL?simpleCellAddress(t,this.col,e.row+this.row):simpleCellAddress(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?ReferenceType.RELATIVE:ReferenceType.ABSOLUTE;return new ColumnAddress(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?ReferenceType.RELATIVE:ReferenceType.ABSOLUTE;return new RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=absoluteSheetReference(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),simpleColumnAddress(t,n)}toSimpleRowAddress(e){const t=absoluteSheetReference(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),simpleRowAddress(t,n)}isRowAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new CellAddress(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new CellAddress(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new CellAddress(this.col+t,this.row+n,this.type,s)}withSheet(e){return new CellAddress(this.col,this.row,this.type,e)}isInvalid(e){return invalidSimpleCellAddress(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,s=this.isRowAbsolute()?this.row:this.row+t;return new CellAddress(n,s,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,s=this.isRowRelative()?this.row:this.row+t;return new CellAddress(n,s,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case CellReferenceType.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(invalidSimpleCellAddress(t))return;const n=columnIndexToLabel(t.col),s=this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${s}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const RANGE_OPERATOR=":",ABSOLUTE_OPERATOR="$",ALL_WHITESPACE_PATTERN="\\s+",ODFF_WHITESPACE_PATTERN="[ \\t\\n\\r]+",UNICODE_LETTER_PATTERN="A-Za-z-",NON_RESERVED_CHARACTER_PATTERN=`${UNICODE_LETTER_PATTERN}0-9_.`,UNQUOTED_SHEET_NAME_PATTERN=`[${UNICODE_LETTER_PATTERN}0-9_]+`,QUOTED_SHEET_NAME_PATTERN="'(((?!').|'')*)'",SHEET_NAME_PATTERN=`(${UNQUOTED_SHEET_NAME_PATTERN}|${QUOTED_SHEET_NAME_PATTERN})!`,CELL_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[A-Za-z]+\\${ABSOLUTE_OPERATOR}?[0-9]+`,COLUMN_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[A-Za-z]+`,ROW_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[0-9]+`,R1C1_CELL_REFERENCE_PATTERN="[rR][0-9]*[cC][0-9]*",CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=`(${CELL_REFERENCE_PATTERN})[^${NON_RESERVED_CHARACTER_PATTERN}]`,NAMED_EXPRESSION_PATTERN=`[${UNICODE_LETTER_PATTERN}_][${NON_RESERVED_CHARACTER_PATTERN}]*`,ALL_DIGITS_ARRAY=["0","1","2","3","4","5","6","7","8","9"],ALL_UNICODE_LETTERS_ARRAY=[...Array.from(Array(26)).map((r,e)=>e+65),...Array.from(Array(26)).map((r,e)=>e+97),...Array.from(Array(496)).map((r,e)=>e+192)].map(r=>String.fromCharCode(r));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const addressRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${ABSOLUTE_OPERATOR}?)([0-9]+)$`),columnRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),rowRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([0-9]+)$`),simpleSheetNameRegex=new RegExp(`^${UNQUOTED_SHEET_NAME_PATTERN}$`),cellAddressFromString=(r,e,t)=>{const n=addressRegex.exec(e),s=columnLabelToIndex(n[6]);let o=extractSheetNumber(n,r);if(o===void 0)return;o===null&&(o=void 0);const a=Number(n[8])-1;return n[5]===ABSOLUTE_OPERATOR&&n[7]===ABSOLUTE_OPERATOR?CellAddress.absolute(s,a,o):n[5]===ABSOLUTE_OPERATOR?CellAddress.absoluteCol(s,a-t.row,o):n[7]===ABSOLUTE_OPERATOR?CellAddress.absoluteRow(s-t.col,a,o):CellAddress.relative(s-t.col,a-t.row,o)},columnAddressFromString=(r,e,t)=>{const n=columnRegex.exec(e);let s=extractSheetNumber(n,r);if(s===void 0)return;s===null&&(s=void 0);const o=columnLabelToIndex(n[6]);return n[5]===ABSOLUTE_OPERATOR?ColumnAddress.absolute(o,s):ColumnAddress.relative(o-t.col,s)},rowAddressFromString=(r,e,t)=>{const n=rowRegex.exec(e);let s=extractSheetNumber(n,r);if(s===void 0)return;s===null&&(s=void 0);const o=Number(n[6])-1;return n[5]===ABSOLUTE_OPERATOR?RowAddress.absolute(o,s):RowAddress.relative(o-t.row,s)},simpleCellAddressFromString=(r,e,t)=>{const n=addressRegex.exec(e);if(!n)return;const s=columnLabelToIndex(n[6]);let o=extractSheetNumber(n,r);if(o===void 0)return;o===null&&(o=t);const a=Number(n[8])-1;return simpleCellAddress(o,s,a)},simpleCellRangeFromString=(r,e,t)=>{const n=e.split(RANGE_OPERATOR);if(n.length!==2)return;const[s,o]=n,a=simpleCellAddressFromString(r,s,t);if(a===void 0)return;const l=simpleCellAddressFromString(r,o,a.sheet);if(l!==void 0&&a.sheet===l.sheet)return simpleCellRange(a,l)},simpleCellAddressToString=(r,e,t)=>{const n=columnIndexToLabel(e.col),s=sheetIndexToString(e.sheet,r);if(s!==void 0)return t!==e.sheet?`${s}!${n}${e.row+1}`:`${n}${e.row+1}`},simpleCellRangeToString=(r,e,t)=>{const n=simpleCellAddressToString(r,e.start,t),s=simpleCellAddressToString(r,e.end,e.start.sheet);if(!(n===void 0||s===void 0))return`${n}${RANGE_OPERATOR}${s}`};function columnLabelToIndex(r){return r.length===1?r.toUpperCase().charCodeAt(0)-65:r.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function columnIndexToLabel(r){let e="";for(;r>=0;)e=String.fromCharCode(r%26+97)+e,r=Math.floor(r/26)-1;return e.toUpperCase()}function sheetIndexToString(r,e){let t=e(r);if(t!==void 0)return simpleSheetNameRegex.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function extractSheetNumber(r,e){var t;let n=(t=r[3])!==null&&t!==void 0?t:r[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function isEmpty(r){return r&&r.length===0}function keys$1(r){return r==null?[]:Object.keys(r)}function values(r){for(var e=[],t=Object.keys(r),n=0;n<t.length;n++)e.push(r[t[n]]);return e}function mapValues(r,e){for(var t=[],n=keys$1(r),s=0;s<n.length;s++){var o=n[s];t.push(e.call(null,r[o],o))}return t}function map(r,e){for(var t=[],n=0;n<r.length;n++)t.push(e.call(null,r[n],n));return t}function flatten(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];Array.isArray(n)?e=e.concat(flatten(n)):e.push(n)}return e}function first$2(r){return isEmpty(r)?void 0:r[0]}function last(r){var e=r&&r.length;return e?r[e-1]:void 0}function forEach$1(r,e){if(Array.isArray(r))for(var t=0;t<r.length;t++)e.call(null,r[t],t);else if(isObject(r))for(var n=keys$1(r),t=0;t<n.length;t++){var s=n[t],o=r[s];e.call(null,o,s)}else throw Error("non exhaustive match")}function isString(r){return typeof r=="string"}function isUndefined(r){return r===void 0}function isFunction$1(r){return r instanceof Function}function drop(r,e){return e===void 0&&(e=1),r.slice(e,r.length)}function dropRight(r,e){return e===void 0&&(e=1),r.slice(0,r.length-e)}function filter(r,e){var t=[];if(Array.isArray(r))for(var n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function reject(r,e){return filter(r,function(t){return!e(t)})}function pick(r,e){for(var t=Object.keys(r),n={},s=0;s<t.length;s++){var o=t[s],a=r[o];e(a)&&(n[o]=a)}return n}function has(r,e){return isObject(r)?r.hasOwnProperty(e):!1}function contains$1(r,e){return find(r,function(t){return t===e})!==void 0}function cloneArr(r){for(var e=[],t=0;t<r.length;t++)e.push(r[t]);return e}function cloneObj(r){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}function find(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(e.call(null,n))return n}}function findAll(r,e){for(var t=[],n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function reduce(r,e,t){for(var n=Array.isArray(r),s=n?r:values(r),o=n?[]:keys$1(r),a=t,l=0;l<s.length;l++)a=e.call(null,a,s[l],n?l:o[l]);return a}function compact(r){return reject(r,function(e){return e==null})}function uniq(r,e){e===void 0&&(e=function(n){return n});var t=[];return reduce(r,function(n,s){var o=e(s);return contains$1(t,o)?n:(t.push(o),n.concat(s))},[])}function isArray(r){return Array.isArray(r)}function isRegExp$1(r){return r instanceof RegExp}function isObject(r){return r instanceof Object}function every(r,e){for(var t=0;t<r.length;t++)if(!e(r[t],t))return!1;return!0}function difference(r,e){return reject(r,function(t){return contains$1(e,t)})}function some(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return!0;return!1}function indexOf(r,e){for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function assign(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++)for(var s=e[n],o=keys$1(s),a=0;a<o.length;a++){var l=o[a];r[l]=s[l]}return r}function assignNoOverwrite(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++){var s=e[n];if(!isUndefined(s))for(var o=keys$1(s),a=0;a<o.length;a++){var l=o[a];has(r,l)||(r[l]=s[l])}}return r}function defaults(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return assignNoOverwrite.apply(null,[{}].concat(r))}function groupBy(r,e){var t={};return forEach$1(r,function(n){var s=e(n),o=t[s];o?o.push(n):t[s]=[n]}),t}function merge(r,e){for(var t=cloneObj(r),n=keys$1(e),s=0;s<n.length;s++){var o=n[s],a=e[o];t[o]=a}return t}function NOOP(){}function IDENTITY(r){return r}function packArray(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];e.push(n!==void 0?n:void 0)}return e}function PRINT_ERROR(r){console&&console.error&&console.error("Error: "+r)}function PRINT_WARNING(r){console&&console.warn&&console.warn("Warning: "+r)}function isES2015MapSupported(){return typeof Map=="function"}function applyMixins(r,e){e.forEach(function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(s){if(s!=="constructor"){var o=Object.getOwnPropertyDescriptor(n,s);o&&(o.get||o.set)?Object.defineProperty(r.prototype,s,o):r.prototype[s]=t.prototype[s]}})})}function toFastProperties(r){function e(){}e.prototype=r;var t=new e;function n(){return typeof t.bar}return n(),n(),r}function peek(r){return r[r.length-1]}function timer(r){var e=new Date().getTime(),t=r(),n=new Date().getTime(),s=n-e;return{time:s,value:t}}var regexpToAst$1={exports:{}},regexpToAst=regexpToAst$1.exports,hasRequiredRegexpToAst;function requireRegexpToAst(){return hasRequiredRegexpToAst||(hasRequiredRegexpToAst=1,function(r){(function(e,t){r.exports?r.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:regexpToAst,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(v){this.idx=v.idx,this.input=v.input,this.groupIdx=v.groupIdx},e.prototype.pattern=function(v){this.idx=0,this.input=v,this.groupIdx=0,this.consumeChar("/");var _=this.disjunction();this.consumeChar("/");for(var T={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":l(T,"global");break;case"i":l(T,"ignoreCase");break;case"m":l(T,"multiLine");break;case"u":l(T,"unicode");break;case"y":l(T,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:T,value:_}},e.prototype.disjunction=function(){var v=[];for(v.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),v.push(this.alternative());return{type:"Disjunction",value:v}},e.prototype.alternative=function(){for(var v=[];this.isTerm();)v.push(this.term());return{type:"Alternative",value:v}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var v;switch(this.popChar()){case"=":v="Lookahead";break;case"!":v="NegativeLookahead";break}u(v);var _=this.disjunction();return this.consumeChar(")"),{type:v,value:_}}c()},e.prototype.quantifier=function(v){var _;switch(this.popChar()){case"*":_={atLeast:0,atMost:1/0};break;case"+":_={atLeast:1,atMost:1/0};break;case"?":_={atLeast:0,atMost:1};break;case"{":var T=this.integerIncludingZero();switch(this.popChar()){case"}":_={atLeast:T,atMost:T};break;case",":var R;this.isDigit()?(R=this.integerIncludingZero(),_={atLeast:T,atMost:R}):_={atLeast:T,atMost:1/0},this.consumeChar("}");break}if(v===!0&&_===void 0)return;u(_);break}if(!(v===!0&&_===void 0))return u(_),this.peekChar(0)==="?"?(this.consumeChar("?"),_.greedy=!1):_.greedy=!0,_.type="Quantifier",_},e.prototype.atom=function(){var v;switch(this.peekChar()){case".":v=this.dotAll();break;case"\\":v=this.atomEscape();break;case"[":v=this.characterClass();break;case"(":v=this.group();break}return v===void 0&&this.isPatternCharacter()&&(v=this.patternCharacter()),u(v),this.isQuantifier()&&(v.quantifier=this.quantifier()),v},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o(`
`),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var v=this.positiveInteger();return{type:"GroupBackReference",value:v}},e.prototype.characterClassEscape=function(){var v,_=!1;switch(this.popChar()){case"d":v=f;break;case"D":v=f,_=!0;break;case"s":v=m;break;case"S":v=m,_=!0;break;case"w":v=C;break;case"W":v=C,_=!0;break}return u(v),{type:"Set",value:v,complement:_}},e.prototype.controlEscapeAtom=function(){var v;switch(this.popChar()){case"f":v=o("\f");break;case"n":v=o(`
`);break;case"r":v=o("\r");break;case"t":v=o("	");break;case"v":v=o("\v");break}return u(v),{type:"Character",value:v}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var v=this.popChar();if(/[a-zA-Z]/.test(v)===!1)throw Error("Invalid ");var _=v.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:_}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var v=this.popChar();return{type:"Character",value:o(v)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var v=this.popChar();return{type:"Character",value:o(v)}}},e.prototype.characterClass=function(){var v=[],_=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),_=!0);this.isClassAtom();){var T=this.classAtom(),R=T.type==="Character";if(R&&this.isRangeDash()){this.consumeChar("-");var O=this.classAtom(),N=O.type==="Character";if(N){if(O.value<T.value)throw Error("Range out of order in character class");v.push({from:T.value,to:O.value})}else a(T.value,v),v.push(o("-")),a(O.value,v)}else a(T.value,v)}return this.consumeChar("]"),{type:"Set",complement:_,value:v}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var v=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),v=!1;break;default:this.groupIdx++;break}var _=this.disjunction();this.consumeChar(")");var T={type:"Group",capturing:v,value:_};return v&&(T.idx=this.groupIdx),T},e.prototype.positiveInteger=function(){var v=this.popChar();if(s.test(v)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},e.prototype.integerIncludingZero=function(){var v=this.popChar();if(n.test(v)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},e.prototype.patternCharacter=function(){var v=this.popChar();switch(v){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(v)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(v){switch(v===void 0&&(v=0),this.peekChar(v)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var v=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(v)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(v){for(var _="",T=0;T<v;T++){var R=this.popChar();if(t.test(R)===!1)throw Error("Expecting a HexDecimal digits");_+=R}var O=parseInt(_,16);return{type:"Character",value:O}},e.prototype.peekChar=function(v){return v===void 0&&(v=0),this.input[this.idx+v]},e.prototype.popChar=function(){var v=this.peekChar(0);return this.consumeChar(),v},e.prototype.consumeChar=function(v){if(v!==void 0&&this.input[this.idx]!==v)throw Error("Expected: '"+v+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,n=/[0-9]/,s=/[1-9]/;function o(v){return v.charCodeAt(0)}function a(v,_){v.length!==void 0?v.forEach(function(T){_.push(T)}):_.push(v)}function l(v,_){if(v[_]===!0)throw"duplicate flag "+_;v[_]=!0}function u(v){if(v===void 0)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}var d,f=[];for(d=o("0");d<=o("9");d++)f.push(d);var C=[o("_")].concat(f);for(d=o("a");d<=o("z");d++)C.push(d);for(d=o("A");d<=o("Z");d++)C.push(d);var m=[o(" "),o("\f"),o(`
`),o("\r"),o("	"),o("\v"),o("	"),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o("\u2028"),o("\u2029"),o(""),o(""),o(""),o("\uFEFF")];function E(){}return E.prototype.visitChildren=function(v){for(var _ in v){var T=v[_];v.hasOwnProperty(_)&&(T.type!==void 0?this.visit(T):Array.isArray(T)&&T.forEach(function(R){this.visit(R)},this))}},E.prototype.visit=function(v){switch(v.type){case"Pattern":this.visitPattern(v);break;case"Flags":this.visitFlags(v);break;case"Disjunction":this.visitDisjunction(v);break;case"Alternative":this.visitAlternative(v);break;case"StartAnchor":this.visitStartAnchor(v);break;case"EndAnchor":this.visitEndAnchor(v);break;case"WordBoundary":this.visitWordBoundary(v);break;case"NonWordBoundary":this.visitNonWordBoundary(v);break;case"Lookahead":this.visitLookahead(v);break;case"NegativeLookahead":this.visitNegativeLookahead(v);break;case"Character":this.visitCharacter(v);break;case"Set":this.visitSet(v);break;case"Group":this.visitGroup(v);break;case"GroupBackReference":this.visitGroupBackReference(v);break;case"Quantifier":this.visitQuantifier(v);break}this.visitChildren(v)},E.prototype.visitPattern=function(v){},E.prototype.visitFlags=function(v){},E.prototype.visitDisjunction=function(v){},E.prototype.visitAlternative=function(v){},E.prototype.visitStartAnchor=function(v){},E.prototype.visitEndAnchor=function(v){},E.prototype.visitWordBoundary=function(v){},E.prototype.visitNonWordBoundary=function(v){},E.prototype.visitLookahead=function(v){},E.prototype.visitNegativeLookahead=function(v){},E.prototype.visitCharacter=function(v){},E.prototype.visitSet=function(v){},E.prototype.visitGroup=function(v){},E.prototype.visitGroupBackReference=function(v){},E.prototype.visitQuantifier=function(v){},{RegExpParser:e,BaseRegExpVisitor:E,VERSION:"0.4.0"}})}(regexpToAst$1)),regexpToAst$1.exports}var regexpToAstExports=requireRegexpToAst(),regExpAstCache={},regExpParser=new regexpToAstExports.RegExpParser;function getRegExpAst(r){var e=r.toString();if(regExpAstCache.hasOwnProperty(e))return regExpAstCache[e];var t=regExpParser.pattern(e);return regExpAstCache[e]=t,t}function clearRegExpParserCache(){regExpAstCache={}}var __extends$a=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),complementErrorMessage="Complement Sets are not supported for first char optimization",failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function getOptimizedStartCodesIndices(r,e){e===void 0&&(e=!1);try{var t=getRegExpAst(r),n=firstCharOptimizedIndices(t.value,{},t.flags.ignoreCase);return n}catch(o){if(o.message===complementErrorMessage)e&&PRINT_WARNING(""+failedOptimizationPrefixMsg+("	Unable to optimize: < "+r.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var s="";e&&(s=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),PRINT_ERROR(failedOptimizationPrefixMsg+`
`+("	Failed parsing: < "+r.toString()+` >
`)+("	Using the regexp-to-ast library version: "+regexpToAstExports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+s)}}return[]}function firstCharOptimizedIndices(r,e,t){switch(r.type){case"Disjunction":for(var n=0;n<r.value.length;n++)firstCharOptimizedIndices(r.value[n],e,t);break;case"Alternative":for(var s=r.value,n=0;n<s.length;n++){var o=s[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=o;switch(a.type){case"Character":addOptimizedIdxToResult(a.value,e,t);break;case"Set":if(a.complement===!0)throw Error(complementErrorMessage);forEach$1(a.value,function(c){if(typeof c=="number")addOptimizedIdxToResult(c,e,t);else{var d=c;if(t===!0)for(var f=d.from;f<=d.to;f++)addOptimizedIdxToResult(f,e,t);else{for(var f=d.from;f<=d.to&&f<minOptimizationVal;f++)addOptimizedIdxToResult(f,e,t);if(d.to>=minOptimizationVal)for(var C=d.from>=minOptimizationVal?d.from:minOptimizationVal,m=d.to,E=charCodeToOptimizedIndex(C),v=charCodeToOptimizedIndex(m),_=E;_<=v;_++)e[_]=_}}});break;case"Group":firstCharOptimizedIndices(a.value,e,t);break;default:throw Error("Non Exhaustive Match")}var l=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&isWholeOptional(a)===!1||a.type!=="Group"&&l===!1)break}break;default:throw Error("non exhaustive match!")}return values(e)}function addOptimizedIdxToResult(r,e,t){var n=charCodeToOptimizedIndex(r);e[n]=n,t===!0&&handleIgnoreCase(r,e)}function handleIgnoreCase(r,e){var t=String.fromCharCode(r),n=t.toUpperCase();if(n!==t){var s=charCodeToOptimizedIndex(n.charCodeAt(0));e[s]=s}else{var o=t.toLowerCase();if(o!==t){var s=charCodeToOptimizedIndex(o.charCodeAt(0));e[s]=s}}}function findCode(r,e){return find(r.value,function(t){if(typeof t=="number")return contains$1(e,t);var n=t;return find(e,function(s){return n.from<=s&&s<=n.to})!==void 0})}function isWholeOptional(r){return r.quantifier&&r.quantifier.atLeast===0?!0:r.value?isArray(r.value)?every(r.value,isWholeOptional):isWholeOptional(r.value):!1}var CharCodeFinder=function(r){__extends$a(e,r);function e(t){var n=r.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}r.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){contains$1(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?findCode(t,this.targetCharCodes)===void 0&&(this.found=!0):findCode(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(regexpToAstExports.BaseRegExpVisitor);function canMatchCharCode(r,e){if(e instanceof RegExp){var t=getRegExpAst(e),n=new CharCodeFinder(r);return n.visit(t),n.found}else return find(e,function(s){return contains$1(r,s.charCodeAt(0))})!==void 0}var __extends$9=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),PATTERN="PATTERN",DEFAULT_MODE="defaultMode",MODES="modes",SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function analyzeTokenTypes(r,e){e=defaults(e,{useSticky:SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(R,O){return O()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){initCharCodeToOptimizedIndexMap()});var n;t("Reject Lexer.NA",function(){n=reject(r,function(R){return R[PATTERN]===Lexer.NA})});var s=!1,o;t("Transform Patterns",function(){s=!1,o=map(n,function(R){var O=R[PATTERN];if(isRegExp$1(O)){var N=O.source;return N.length===1&&N!=="^"&&N!=="$"&&N!=="."?N:N.length===2&&N[0]==="\\"&&!contains$1(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],N[1])?N[1]:e.useSticky?addStickyFlag(O):addStartOfInput(O)}else{if(isFunction$1(O))return s=!0,{exec:O};if(has(O,"exec"))return s=!0,O;if(typeof O=="string"){if(O.length===1)return O;var G=O.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),D=new RegExp(G);return e.useSticky?addStickyFlag(D):addStartOfInput(D)}else throw Error("non exhaustive match")}})});var a,l,u,c,d;t("misc mapping",function(){a=map(n,function(R){return R.tokenTypeIdx}),l=map(n,function(R){var O=R.GROUP;if(O!==Lexer.SKIPPED){if(isString(O))return O;if(isUndefined(O))return!1;throw Error("non exhaustive match")}}),u=map(n,function(R){var O=R.LONGER_ALT;if(O){var N=indexOf(n,O);return N}}),c=map(n,function(R){return R.PUSH_MODE}),d=map(n,function(R){return has(R,"POP_MODE")})});var f;t("Line Terminator Handling",function(){var R=getCharCodes(e.lineTerminatorCharacters);f=map(n,function(O){return!1}),e.positionTracking!=="onlyOffset"&&(f=map(n,function(O){if(has(O,"LINE_BREAKS"))return O.LINE_BREAKS;if(checkLineBreaksIssues(O,R)===!1)return canMatchCharCode(R,O.PATTERN)}))});var C,m,E,v;t("Misc Mapping #2",function(){C=map(n,isCustomPattern),m=map(o,isShortPattern),E=reduce(n,function(R,O){var N=O.GROUP;return isString(N)&&N!==Lexer.SKIPPED&&(R[N]=[]),R},{}),v=map(o,function(R,O){return{pattern:o[O],longerAlt:u[O],canLineTerminator:f[O],isCustom:C[O],short:m[O],group:l[O],push:c[O],pop:d[O],tokenTypeIdx:a[O],tokenType:n[O]}})});var _=!0,T=[];return e.safeMode||t("First Char Optimization",function(){T=reduce(n,function(R,O,N){if(typeof O.PATTERN=="string"){var G=O.PATTERN.charCodeAt(0),D=charCodeToOptimizedIndex(G);addToMapOfArrays(R,D,v[N])}else if(isArray(O.START_CHARS_HINT)){var k;forEach$1(O.START_CHARS_HINT,function(ne){var Z=typeof ne=="string"?ne.charCodeAt(0):ne,ve=charCodeToOptimizedIndex(Z);k!==ve&&(k=ve,addToMapOfArrays(R,ve,v[N]))})}else if(isRegExp$1(O.PATTERN))if(O.PATTERN.unicode)_=!1,e.ensureOptimizations&&PRINT_ERROR(""+failedOptimizationPrefixMsg+("	Unable to analyze < "+O.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var z=getOptimizedStartCodesIndices(O.PATTERN,e.ensureOptimizations);isEmpty(z)&&(_=!1),forEach$1(z,function(ne){addToMapOfArrays(R,ne,v[N])})}else e.ensureOptimizations&&PRINT_ERROR(""+failedOptimizationPrefixMsg+("	TokenType: <"+O.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),_=!1;return R},[])}),t("ArrayPacking",function(){T=packArray(T)}),{emptyGroups:E,patternIdxToConfig:v,charCodeToPatternIdxToConfig:T,hasCustom:s,canBeOptimized:_}}function validatePatterns(r,e){var t=[],n=findMissingPatterns(r);t=t.concat(n.errors);var s=findInvalidPatterns(n.valid),o=s.valid;return t=t.concat(s.errors),t=t.concat(validateRegExpPattern(o)),t=t.concat(findInvalidGroupType(o)),t=t.concat(findModesThatDoNotExist(o,e)),t=t.concat(findUnreachablePatterns(o)),t}function validateRegExpPattern(r){var e=[],t=filter(r,function(n){return isRegExp$1(n[PATTERN])});return e=e.concat(findEndOfInputAnchor(t)),e=e.concat(findStartOfInputAnchor(t)),e=e.concat(findUnsupportedFlags(t)),e=e.concat(findDuplicatePatterns(t)),e=e.concat(findEmptyMatchRegExps(t)),e}function findMissingPatterns(r){var e=filter(r,function(s){return!has(s,PATTERN)}),t=map(e,function(s){return{message:"Token Type: ->"+s.name+"<- missing static 'PATTERN' property",type:LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[s]}}),n=difference(r,e);return{errors:t,valid:n}}function findInvalidPatterns(r){var e=filter(r,function(s){var o=s[PATTERN];return!isRegExp$1(o)&&!isFunction$1(o)&&!has(o,"exec")&&!isString(o)}),t=map(e,function(s){return{message:"Token Type: ->"+s.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[s]}}),n=difference(r,e);return{errors:t,valid:n}}var end_of_input=/[^\\][\$]/;function findEndOfInputAnchor(r){var e=function(s){__extends$9(o,s);function o(){var a=s!==null&&s.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitEndAnchor=function(a){this.found=!0},o}(regexpToAstExports.BaseRegExpVisitor),t=filter(r,function(s){var o=s[PATTERN];try{var a=getRegExpAst(o),l=new e;return l.visit(a),l.found}catch{return end_of_input.test(o.source)}}),n=map(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function findEmptyMatchRegExps(r){var e=filter(r,function(n){var s=n[PATTERN];return s.test("")}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return t}var start_of_input=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(r){var e=function(s){__extends$9(o,s);function o(){var a=s!==null&&s.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitStartAnchor=function(a){this.found=!0},o}(regexpToAstExports.BaseRegExpVisitor),t=filter(r,function(s){var o=s[PATTERN];try{var a=getRegExpAst(o),l=new e;return l.visit(a),l.found}catch{return start_of_input.test(o.source)}}),n=map(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function findUnsupportedFlags(r){var e=filter(r,function(n){var s=n[PATTERN];return s instanceof RegExp&&(s.multiline||s.global)}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return t}function findDuplicatePatterns(r){var e=[],t=map(r,function(o){return reduce(r,function(a,l){return o.PATTERN.source===l.PATTERN.source&&!contains$1(e,l)&&l.PATTERN!==Lexer.NA&&(e.push(l),a.push(l)),a},[])});t=compact(t);var n=filter(t,function(o){return o.length>1}),s=map(n,function(o){var a=map(o,function(u){return u.name}),l=first$2(o).PATTERN;return{message:"The same RegExp pattern ->"+l+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}});return s}function findInvalidGroupType(r){var e=filter(r,function(n){if(!has(n,"GROUP"))return!1;var s=n.GROUP;return s!==Lexer.SKIPPED&&s!==Lexer.NA&&!isString(s)}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return t}function findModesThatDoNotExist(r,e){var t=filter(r,function(s){return s.PUSH_MODE!==void 0&&!contains$1(e,s.PUSH_MODE)}),n=map(t,function(s){var o="Token Type: ->"+s.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+s.PUSH_MODE+"<-which does not exist";return{message:o,type:LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[s]}});return n}function findUnreachablePatterns(r){var e=[],t=reduce(r,function(n,s,o){var a=s.PATTERN;return a===Lexer.NA||(isString(a)?n.push({str:a,idx:o,tokenType:s}):isRegExp$1(a)&&noMetaChar(a)&&n.push({str:a.source,idx:o,tokenType:s})),n},[]);return forEach$1(r,function(n,s){forEach$1(t,function(o){var a=o.str,l=o.idx,u=o.tokenType;if(s<l&&testTokenType(a,n.PATTERN)){var c="Token: ->"+u.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[n,u]})}})}),e}function testTokenType(r,e){if(isRegExp$1(e)){var t=e.exec(r);return t!==null&&t.index===0}else{if(isFunction$1(e))return e(r,0,[],{});if(has(e,"exec"))return e.exec(r,0,[],{});if(typeof e=="string")return e===r;throw Error("non exhaustive match")}}function noMetaChar(r){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return find(e,function(t){return r.source.indexOf(t)!==-1})===void 0}function addStartOfInput(r){var e=r.ignoreCase?"i":"";return new RegExp("^(?:"+r.source+")",e)}function addStickyFlag(r){var e=r.ignoreCase?"iy":"y";return new RegExp(""+r.source,e)}function performRuntimeChecks(r,e,t){var n=[];return has(r,DEFAULT_MODE)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+DEFAULT_MODE+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),has(r,MODES)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+MODES+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),has(r,MODES)&&has(r,DEFAULT_MODE)&&!has(r.modes,r.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+DEFAULT_MODE+": <"+r.defaultMode+`>which does not exist
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),has(r,MODES)&&forEach$1(r.modes,function(s,o){forEach$1(s,function(a,l){isUndefined(a)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+o+"> at index: <"+l+`>
`),type:LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function performWarningRuntimeChecks(r,e,t){var n=[],s=!1,o=compact(flatten(mapValues(r.modes,function(u){return u}))),a=reject(o,function(u){return u[PATTERN]===Lexer.NA}),l=getCharCodes(t);return e&&forEach$1(a,function(u){var c=checkLineBreaksIssues(u,l);if(c!==!1){var d=buildLineBreakIssueMessage(u,c),f={message:d,type:c.issue,tokenType:u};n.push(f)}else has(u,"LINE_BREAKS")?u.LINE_BREAKS===!0&&(s=!0):canMatchCharCode(l,u.PATTERN)&&(s=!0)}),e&&!s&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function cloneEmptyGroups(r){var e={},t=keys$1(r);return forEach$1(t,function(n){var s=r[n];if(isArray(s))e[n]=[];else throw Error("non exhaustive match")}),e}function isCustomPattern(r){var e=r.PATTERN;if(isRegExp$1(e))return!1;if(isFunction$1(e))return!0;if(has(e,"exec"))return!0;if(isString(e))return!1;throw Error("non exhaustive match")}function isShortPattern(r){return isString(r)&&r.length===1?r.charCodeAt(0):!1}var LineTerminatorOptimizedTester={test:function(r){for(var e=r.length,t=this.lastIndex;t<e;t++){var n=r.charCodeAt(t);if(n===10)return this.lastIndex=t+1,!0;if(n===13)return r.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function checkLineBreaksIssues(r,e){if(has(r,"LINE_BREAKS"))return!1;if(isRegExp$1(r.PATTERN)){try{canMatchCharCode(e,r.PATTERN)}catch(t){return{issue:LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(isString(r.PATTERN))return!1;if(isCustomPattern(r))return{issue:LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function buildLineBreakIssueMessage(r,e){if(e.issue===LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+r.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+r.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function getCharCodes(r){var e=map(r,function(t){return isString(t)&&t.length>0?t.charCodeAt(0):t});return e}function addToMapOfArrays(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}var minOptimizationVal=256;function charCodeToOptimizedIndex(r){return r<minOptimizationVal?r:charCodeToOptimizedIdxMap[r]}var charCodeToOptimizedIdxMap=[];function initCharCodeToOptimizedIndexMap(){if(isEmpty(charCodeToOptimizedIdxMap)){charCodeToOptimizedIdxMap=new Array(65536);for(var r=0;r<65536;r++)charCodeToOptimizedIdxMap[r]=r>255?255+~~(r/255):r}}function tokenStructuredMatcher(r,e){var t=r.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function tokenStructuredMatcherNoCategories(r,e){return r.tokenTypeIdx===e.tokenTypeIdx}var tokenShortNameIdx=1,tokenIdxToClass={};function augmentTokenTypes(r){var e=expandCategories(r);assignTokenDefaultProps(e),assignCategoriesMapProp(e),assignCategoriesTokensProp(e),forEach$1(e,function(t){t.isParent=t.categoryMatches.length>0})}function expandCategories(r){for(var e=cloneArr(r),t=r,n=!0;n;){t=compact(flatten(map(t,function(o){return o.CATEGORIES})));var s=difference(t,e);e=e.concat(s),isEmpty(s)?n=!1:t=s}return e}function assignTokenDefaultProps(r){forEach$1(r,function(e){hasShortKeyProperty(e)||(tokenIdxToClass[tokenShortNameIdx]=e,e.tokenTypeIdx=tokenShortNameIdx++),hasCategoriesProperty(e)&&!isArray(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),hasCategoriesProperty(e)||(e.CATEGORIES=[]),hasExtendingTokensTypesProperty(e)||(e.categoryMatches=[]),hasExtendingTokensTypesMapProperty(e)||(e.categoryMatchesMap={})})}function assignCategoriesTokensProp(r){forEach$1(r,function(e){e.categoryMatches=[],forEach$1(e.categoryMatchesMap,function(t,n){e.categoryMatches.push(tokenIdxToClass[n].tokenTypeIdx)})})}function assignCategoriesMapProp(r){forEach$1(r,function(e){singleAssignCategoriesToksMap([],e)})}function singleAssignCategoriesToksMap(r,e){forEach$1(r,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),forEach$1(e.CATEGORIES,function(t){var n=r.concat(e);contains$1(n,t)||singleAssignCategoriesToksMap(n,t)})}function hasShortKeyProperty(r){return has(r,"tokenTypeIdx")}function hasCategoriesProperty(r){return has(r,"CATEGORIES")}function hasExtendingTokensTypesProperty(r){return has(r,"categoryMatches")}function hasExtendingTokensTypesMapProperty(r){return has(r,"categoryMatchesMap")}function isTokenType(r){return has(r,"tokenTypeIdx")}var defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->"+r.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(r,e,t,n,s){return"unexpected character: ->"+r.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},LexerDefinitionErrorType;(function(r){r[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(LexerDefinitionErrorType||(LexerDefinitionErrorType={}));var DEFAULT_LEXER_CONFIG={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(DEFAULT_LEXER_CONFIG);var Lexer=function(){function r(e,t){var n=this;if(t===void 0&&(t=DEFAULT_LEXER_CONFIG),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=merge(DEFAULT_LEXER_CONFIG,t);var s=this.config.traceInitPerf;s===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof s=="number"&&(this.traceInitMaxIdent=s,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===DEFAULT_LEXER_CONFIG.lineTerminatorsPattern)n.config.lineTerminatorsPattern=LineTerminatorOptimizedTester;else if(n.config.lineTerminatorCharacters===DEFAULT_LEXER_CONFIG.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),isArray(e)?(o={modes:{}},o.modes[DEFAULT_MODE]=cloneArr(e),o[DEFAULT_MODE]=DEFAULT_MODE):(a=!1,o=cloneObj(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(performRuntimeChecks(o,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(performWarningRuntimeChecks(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),o.modes=o.modes?o.modes:{},forEach$1(o.modes,function(d,f){o.modes[f]=reject(d,function(C){return isUndefined(C)})});var l=keys$1(o.modes);if(forEach$1(o.modes,function(d,f){n.TRACE_INIT("Mode: <"+f+"> processing",function(){if(n.modes.push(f),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(validatePatterns(d,l))}),isEmpty(n.lexerDefinitionErrors)){augmentTokenTypes(d);var C;n.TRACE_INIT("analyzeTokenTypes",function(){C=analyzeTokenTypes(d,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[f]=C.patternIdxToConfig,n.charCodeToPatternIdxToConfig[f]=C.charCodeToPatternIdxToConfig,n.emptyGroups=merge(n.emptyGroups,C.emptyGroups),n.hasCustom=C.hasCustom||n.hasCustom,n.canModeBeOptimized[f]=C.canBeOptimized}})}),n.defaultMode=o.defaultMode,!isEmpty(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var u=map(n.lexerDefinitionErrors,function(d){return d.message}),c=u.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}forEach$1(n.lexerDefinitionWarning,function(d){PRINT_WARNING(d.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(SUPPORT_STICKY?(n.chopInput=IDENTITY,n.match=n.matchWithTest):(n.updateLastIndex=NOOP,n.match=n.matchWithExec),a&&(n.handleModes=NOOP),n.trackStartLines===!1&&(n.computeNewColumn=IDENTITY),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=NOOP),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var d=reduce(n.canModeBeOptimized,function(f,C,m){return C===!1&&f.push(m),f},[]);if(t.ensureOptimizations&&!isEmpty(d))throw Error("Lexer Modes: < "+d.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){clearRegExpParserCache()}),n.TRACE_INIT("toFastProperties",function(){toFastProperties(n)})})}return r.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!isEmpty(this.lexerDefinitionErrors)){var n=map(this.lexerDefinitionErrors,function(a){return a.message}),s=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+s)}var o=this.tokenizeInternal(e,t);return o},r.prototype.tokenizeInternal=function(e,t){var n=this,s,o,a,l,u,c,d,f,C,m,E,v,_,T,R=e,O=R.length,N=0,G=0,D=this.hasCustom?0:Math.floor(e.length/10),k=new Array(D),z=[],ne=this.trackStartLines?1:void 0,Z=this.trackStartLines?1:void 0,ve=cloneEmptyGroups(this.emptyGroups),xe=this.trackStartLines,de=this.config.lineTerminatorsPattern,Se=0,Me=[],Pe=[],_e=[],Oe=[];Object.freeze(Oe);var st=void 0;function rt(){return Me}function U(Ze){var at=charCodeToOptimizedIndex(Ze),St=Pe[at];return St===void 0?Oe:St}var te=function(Ze){if(_e.length===1&&Ze.tokenType.PUSH_MODE===void 0){var at=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Ze);z.push({offset:Ze.startOffset,line:Ze.startLine!==void 0?Ze.startLine:void 0,column:Ze.startColumn!==void 0?Ze.startColumn:void 0,length:Ze.image.length,message:at})}else{_e.pop();var St=last(_e);Me=n.patternIdxToConfig[St],Pe=n.charCodeToPatternIdxToConfig[St],Se=Me.length;var bt=n.canModeBeOptimized[St]&&n.config.safeMode===!1;Pe&&bt?st=U:st=rt}};function V(Ze){_e.push(Ze),Pe=this.charCodeToPatternIdxToConfig[Ze],Me=this.patternIdxToConfig[Ze],Se=Me.length,Se=Me.length;var at=this.canModeBeOptimized[Ze]&&this.config.safeMode===!1;Pe&&at?st=U:st=rt}V.call(this,t);for(var ue;N<O;){u=null;var Ne=R.charCodeAt(N),Ge=st(Ne),Ue=Ge.length;for(s=0;s<Ue;s++){ue=Ge[s];var Ie=ue.pattern;c=null;var Ke=ue.short;if(Ke!==!1?Ne===Ke&&(u=Ie):ue.isCustom===!0?(T=Ie.exec(R,N,k,ve),T!==null?(u=T[0],T.payload!==void 0&&(c=T.payload)):u=null):(this.updateLastIndex(Ie,N),u=this.match(Ie,e,N)),u!==null){if(l=ue.longerAlt,l!==void 0){var le=Me[l],ge=le.pattern;d=null,le.isCustom===!0?(T=ge.exec(R,N,k,ve),T!==null?(a=T[0],T.payload!==void 0&&(d=T.payload)):a=null):(this.updateLastIndex(ge,N),a=this.match(ge,e,N)),a&&a.length>u.length&&(u=a,c=d,ue=le)}break}}if(u!==null){if(f=u.length,C=ue.group,C!==void 0&&(m=ue.tokenTypeIdx,E=this.createTokenInstance(u,N,m,ue.tokenType,ne,Z,f),this.handlePayload(E,c),C===!1?G=this.addToken(k,G,E):ve[C].push(E)),e=this.chopInput(e,f),N=N+f,Z=this.computeNewColumn(Z,f),xe===!0&&ue.canLineTerminator===!0){var we=0,qe=void 0,$e=void 0;de.lastIndex=0;do qe=de.test(u),qe===!0&&($e=de.lastIndex-1,we++);while(qe===!0);we!==0&&(ne=ne+we,Z=f-$e,this.updateTokenEndLineColumnLocation(E,C,$e,we,ne,Z,f))}this.handleModes(ue,te,V,E)}else{for(var ze=N,it=ne,Ve=Z,Qe=!1;!Qe&&N<O;)for(R.charCodeAt(N),e=this.chopInput(e,1),N++,o=0;o<Se;o++){var nt=Me[o],Ie=nt.pattern,Ke=nt.short;if(Ke!==!1?R.charCodeAt(N)===Ke&&(Qe=!0):nt.isCustom===!0?Qe=Ie.exec(R,N,k,ve)!==null:(this.updateLastIndex(Ie,N),Qe=Ie.exec(e)!==null),Qe===!0)break}v=N-ze,_=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(R,ze,v,it,Ve),z.push({offset:ze,line:it,column:Ve,length:v,message:_})}}return this.hasCustom||(k.length=G),{tokens:k,groups:ve,errors:z}},r.prototype.handleModes=function(e,t,n,s){if(e.pop===!0){var o=e.push;t(s),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)},r.prototype.chopInput=function(e,t){return e.substring(t)},r.prototype.updateLastIndex=function(e,t){e.lastIndex=t},r.prototype.updateTokenEndLineColumnLocation=function(e,t,n,s,o,a,l){var u,c;t!==void 0&&(u=n===l-1,c=u?-1:0,s===1&&u===!0||(e.endLine=o+c,e.endColumn=a-1+-c))},r.prototype.computeNewColumn=function(e,t){return e+t},r.prototype.createTokenInstance=function(){return null},r.prototype.createOffsetOnlyToken=function(e,t,n,s){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:s}},r.prototype.createStartOnlyToken=function(e,t,n,s,o,a){return{image:e,startOffset:t,startLine:o,startColumn:a,tokenTypeIdx:n,tokenType:s}},r.prototype.createFullToken=function(e,t,n,s,o,a,l){return{image:e,startOffset:t,endOffset:t+l-1,startLine:o,endLine:o,startColumn:a,endColumn:a+l-1,tokenTypeIdx:n,tokenType:s}},r.prototype.addToken=function(e,t,n){return 666},r.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},r.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,t++,t},r.prototype.handlePayload=function(e,t){},r.prototype.handlePayloadNoCustom=function(e,t){},r.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},r.prototype.match=function(e,t,n){return null},r.prototype.matchWithTest=function(e,t,n){var s=e.test(t);return s===!0?t.substring(n,e.lastIndex):null},r.prototype.matchWithExec=function(e,t){var n=e.exec(t);return n!==null?n[0]:n},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=timer(t),o=s.time,a=s.value,l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return t()},r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",r.NA=/NOT_APPLICABLE/,r}();function tokenLabel(r){return hasTokenLabel(r)?r.LABEL:r.name}function hasTokenLabel(r){return isString(r.LABEL)&&r.LABEL!==""}var PARENT="parent",CATEGORIES="categories",LABEL="label",GROUP="group",PUSH_MODE="push_mode",POP_MODE="pop_mode",LONGER_ALT="longer_alt",LINE_BREAKS="line_breaks",START_CHARS_HINT="start_chars_hint";function createToken(r){return createTokenInternal(r)}function createTokenInternal(r){var e=r.pattern,t={};if(t.name=r.name,isUndefined(e)||(t.PATTERN=e),has(r,PARENT))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return has(r,CATEGORIES)&&(t.CATEGORIES=r[CATEGORIES]),augmentTokenTypes([t]),has(r,LABEL)&&(t.LABEL=r[LABEL]),has(r,GROUP)&&(t.GROUP=r[GROUP]),has(r,POP_MODE)&&(t.POP_MODE=r[POP_MODE]),has(r,PUSH_MODE)&&(t.PUSH_MODE=r[PUSH_MODE]),has(r,LONGER_ALT)&&(t.LONGER_ALT=r[LONGER_ALT]),has(r,LINE_BREAKS)&&(t.LINE_BREAKS=r[LINE_BREAKS]),has(r,START_CHARS_HINT)&&(t.START_CHARS_HINT=r[START_CHARS_HINT]),t}var EOF=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([EOF]);function createTokenInstance(r,e,t,n,s,o,a,l){return{image:e,startOffset:t,endOffset:n,startLine:s,endLine:o,startColumn:a,endColumn:l,tokenTypeIdx:r.tokenTypeIdx,tokenType:r}}function tokenMatcher(r,e){return tokenStructuredMatcher(r,e)}var __extends$8=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AbstractProduction=function(){function r(e){this.definition=e}return r.prototype.accept=function(e){e.visit(this),forEach$1(this.definition,function(t){t.accept(e)})},r}(),NonTerminal=function(r){__extends$8(e,r);function e(t){var n=r.call(this,[])||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(AbstractProduction),Rule=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.orgText="",assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Flat=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Option$1=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionMandatory=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionMandatoryWithSeparator=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Repetition=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionWithSeparator=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Alternation=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Terminal=function(){function r(e){this.idx=1,assign(this,pick(e,function(t){return t!==void 0}))}return r.prototype.accept=function(e){e.visit(this)},r}();function serializeGrammar(r){return map(r,serializeProduction)}function serializeProduction(r){function e(s){return map(s,serializeProduction)}if(r instanceof NonTerminal)return{type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};if(r instanceof Flat)return{type:"Flat",definition:e(r.definition)};if(r instanceof Option$1)return{type:"Option",idx:r.idx,definition:e(r.definition)};if(r instanceof RepetitionMandatory)return{type:"RepetitionMandatory",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof RepetitionMandatoryWithSeparator)return{type:"RepetitionMandatoryWithSeparator",name:r.name,idx:r.idx,separator:serializeProduction(new Terminal({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof RepetitionWithSeparator)return{type:"RepetitionWithSeparator",name:r.name,idx:r.idx,separator:serializeProduction(new Terminal({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof Repetition)return{type:"Repetition",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Alternation)return{type:"Alternation",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Terminal){var t={type:"Terminal",name:r.terminalType.name,label:tokenLabel(r.terminalType),idx:r.idx},n=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(t.pattern=isRegExp$1(n)?n.source:n),t}else{if(r instanceof Rule)return{type:"Rule",name:r.name,orgText:r.orgText,definition:e(r.definition)};throw Error("non exhaustive match")}}var RestWalker=function(){function r(){}return r.prototype.walk=function(e,t){var n=this;t===void 0&&(t=[]),forEach$1(e.definition,function(s,o){var a=drop(e.definition,o+1);if(s instanceof NonTerminal)n.walkProdRef(s,a,t);else if(s instanceof Terminal)n.walkTerminal(s,a,t);else if(s instanceof Flat)n.walkFlat(s,a,t);else if(s instanceof Option$1)n.walkOption(s,a,t);else if(s instanceof RepetitionMandatory)n.walkAtLeastOne(s,a,t);else if(s instanceof RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(s,a,t);else if(s instanceof RepetitionWithSeparator)n.walkManySep(s,a,t);else if(s instanceof Repetition)n.walkMany(s,a,t);else if(s instanceof Alternation)n.walkOr(s,a,t);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(e,t,n){},r.prototype.walkProdRef=function(e,t,n){},r.prototype.walkFlat=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkOption=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkAtLeastOne=function(e,t,n){var s=[new Option$1({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkAtLeastOneSep=function(e,t,n){var s=restForRepetitionWithSeparator(e,t,n);this.walk(e,s)},r.prototype.walkMany=function(e,t,n){var s=[new Option$1({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkManySep=function(e,t,n){var s=restForRepetitionWithSeparator(e,t,n);this.walk(e,s)},r.prototype.walkOr=function(e,t,n){var s=this,o=t.concat(n);forEach$1(e.definition,function(a){var l=new Flat({definition:[a]});s.walk(l,o)})},r}();function restForRepetitionWithSeparator(r,e,t){var n=[new Option$1({definition:[new Terminal({terminalType:r.separator})].concat(r.definition)})],s=n.concat(e,t);return s}var GAstVisitor=function(){function r(){}return r.prototype.visit=function(e){var t=e;switch(t.constructor){case NonTerminal:return this.visitNonTerminal(t);case Flat:return this.visitFlat(t);case Option$1:return this.visitOption(t);case RepetitionMandatory:return this.visitRepetitionMandatory(t);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case Repetition:return this.visitRepetition(t);case Alternation:return this.visitAlternation(t);case Terminal:return this.visitTerminal(t);case Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(e){},r.prototype.visitFlat=function(e){},r.prototype.visitOption=function(e){},r.prototype.visitRepetition=function(e){},r.prototype.visitRepetitionMandatory=function(e){},r.prototype.visitRepetitionMandatoryWithSeparator=function(e){},r.prototype.visitRepetitionWithSeparator=function(e){},r.prototype.visitAlternation=function(e){},r.prototype.visitTerminal=function(e){},r.prototype.visitRule=function(e){},r}(),__extends$7=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function isSequenceProd(r){return r instanceof Flat||r instanceof Option$1||r instanceof Repetition||r instanceof RepetitionMandatory||r instanceof RepetitionMandatoryWithSeparator||r instanceof RepetitionWithSeparator||r instanceof Terminal||r instanceof Rule}function isOptionalProd(r,e){e===void 0&&(e=[]);var t=r instanceof Option$1||r instanceof Repetition||r instanceof RepetitionWithSeparator;return t?!0:r instanceof Alternation?some(r.definition,function(n){return isOptionalProd(n,e)}):r instanceof NonTerminal&&contains$1(e,r)?!1:r instanceof AbstractProduction?(r instanceof NonTerminal&&e.push(r),every(r.definition,function(n){return isOptionalProd(n,e)})):!1}function isBranchingProd(r){return r instanceof Alternation}function getProductionDslName(r){if(r instanceof NonTerminal)return"SUBRULE";if(r instanceof Option$1)return"OPTION";if(r instanceof Alternation)return"OR";if(r instanceof RepetitionMandatory)return"AT_LEAST_ONE";if(r instanceof RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(r instanceof RepetitionWithSeparator)return"MANY_SEP";if(r instanceof Repetition)return"MANY";if(r instanceof Terminal)return"CONSUME";throw Error("non exhaustive match")}var DslMethodsCollectorVisitor=function(r){__extends$7(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var n=t.terminalType.name+this.separator+"Terminal";has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitNonTerminal=function(t){var n=t.nonTerminalName+this.separator+"Terminal";has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(GAstVisitor),collectorVisitor=new DslMethodsCollectorVisitor;function collectMethods(r){collectorVisitor.reset(),r.accept(collectorVisitor);var e=collectorVisitor.dslMethods;return collectorVisitor.reset(),e}function first$1(r){if(r instanceof NonTerminal)return first$1(r.referencedRule);if(r instanceof Terminal)return firstForTerminal(r);if(isSequenceProd(r))return firstForSequence(r);if(isBranchingProd(r))return firstForBranching(r);throw Error("non exhaustive match")}function firstForSequence(r){for(var e=[],t=r.definition,n=0,s=t.length>n,o,a=!0;s&&a;)o=t[n],a=isOptionalProd(o),e=e.concat(first$1(o)),n=n+1,s=t.length>n;return uniq(e)}function firstForBranching(r){var e=map(r.definition,function(t){return first$1(t)});return uniq(flatten(e))}function firstForTerminal(r){return[r.terminalType]}var IN="_~IN~_",__extends$6=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ResyncFollowsWalker=function(r){__extends$6(e,r);function e(t){var n=r.call(this)||this;return n.topProd=t,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,n,s){},e.prototype.walkProdRef=function(t,n,s){var o=buildBetweenProdsFollowPrefix(t.referencedRule,t.idx)+this.topProd.name,a=n.concat(s),l=new Flat({definition:a}),u=first$1(l);this.follows[o]=u},e}(RestWalker);function computeAllProdsFollows(r){var e={};return forEach$1(r,function(t){var n=new ResyncFollowsWalker(t).startWalking();assign(e,n)}),e}function buildBetweenProdsFollowPrefix(r,e){return r.name+e+IN}var BITS_FOR_METHOD_TYPE=4,BITS_FOR_OCCURRENCE_IDX=8,BITS_FOR_ALT_IDX=8,OR_IDX=1<<BITS_FOR_OCCURRENCE_IDX,OPTION_IDX=2<<BITS_FOR_OCCURRENCE_IDX,MANY_IDX=3<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_IDX=4<<BITS_FOR_OCCURRENCE_IDX,MANY_SEP_IDX=5<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_SEP_IDX=6<<BITS_FOR_OCCURRENCE_IDX;function getKeyForAutomaticLookahead(r,e,t){return t|e|r}var BITS_START_FOR_ALT_IDX=32-BITS_FOR_ALT_IDX;function getKeyForAltIndex(r,e,t,n){var s=n+1<<BITS_START_FOR_ALT_IDX;return getKeyForAutomaticLookahead(r,e,t)|s}var __extends$5=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function setNodeLocationOnlyOffset(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.endOffset=e.endOffset):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset)}function setNodeLocationFull(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.startColumn=e.startColumn,r.startLine=e.startLine,r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine)}function addTerminalToCst(r,e,t){r.children[t]===void 0?r.children[t]=[e]:r.children[t].push(e)}function addNoneTerminalToCst(r,e,t){r.children[e]===void 0?r.children[e]=[t]:r.children[e].push(t)}var NamedDSLMethodsCollectorVisitor=function(r){__extends$5(e,r);function e(t){var n=r.call(this)||this;return n.result=[],n.ruleIdx=t,n}return e.prototype.collectNamedDSLMethod=function(t,n,s){if(!isUndefined(t.name)){var o=void 0;if(t instanceof Option$1||t instanceof Repetition||t instanceof RepetitionMandatory||t instanceof Alternation)o=new n({definition:t.definition,idx:t.idx});else if(t instanceof RepetitionMandatoryWithSeparator||t instanceof RepetitionWithSeparator)o=new n({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var a=[o],l=getKeyForAutomaticLookahead(this.ruleIdx,s,t.idx);this.result.push({def:a,key:l,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Option$1,OPTION_IDX)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Repetition,MANY_IDX)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,RepetitionMandatory,AT_LEAST_ONE_IDX)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,RepetitionMandatoryWithSeparator,AT_LEAST_ONE_SEP_IDX)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,RepetitionWithSeparator,MANY_SEP_IDX)},e.prototype.visitAlternation=function(t){var n=this;this.collectNamedDSLMethod(t,Alternation,OR_IDX);var s=t.definition.length>1;forEach$1(t.definition,function(o,a){if(!isUndefined(o.name)){var l=o.definition;s?l=[new Option$1({definition:o.definition})]:l=o.definition;var u=getKeyForAltIndex(n.ruleIdx,OR_IDX,t.idx,a);n.result.push({def:l,key:u,name:o.name,orgProd:o})}})},e}(GAstVisitor);function expandAllNestedRuleNames(r,e){var t={allRuleNames:[]};return forEach$1(r,function(n){var s=e[n.name];t.allRuleNames.push(n.name);var o=new NamedDSLMethodsCollectorVisitor(s);n.accept(o),forEach$1(o.result,function(a){a.def,a.key;var l=a.name;t.allRuleNames.push(n.name+l)})}),t}var __extends$4=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AbstractNextPossibleTokensWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this)||this;return s.topProd=t,s.path=n,s.possibleTokTypes=[],s.nextProductionName="",s.nextProductionOccurrence=0,s.found=!1,s.isAtEndOfPath=!1,s}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,n){n===void 0&&(n=[]),this.found||r.prototype.walk.call(this,t,n)},e.prototype.walkProdRef=function(t,n,s){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var o=n.concat(s);this.updateExpectedNext(),this.walk(t.referencedRule,o)}},e.prototype.updateExpectedNext=function(){isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(RestWalker),NextAfterTokenWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.path=n,s.nextTerminalName="",s.nextTerminalOccurrence=0,s.nextTerminalName=s.path.lastTok.name,s.nextTerminalOccurrence=s.path.lastTokOccurrence,s}return e.prototype.walkTerminal=function(t,n,s){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var o=n.concat(s),a=new Flat({definition:o});this.possibleTokTypes=first$1(a),this.found=!0}},e}(AbstractNextPossibleTokensWalker),AbstractNextTerminalAfterProductionWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this)||this;return s.topRule=t,s.occurrence=n,s.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},s}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(RestWalker),NextTerminalAfterManyWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkMany=function(t,n,s){if(t.idx===this.occurrence){var o=first$2(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkMany.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterManySepWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,n,s){if(t.idx===this.occurrence){var o=first$2(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkManySep.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterAtLeastOneWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,n,s){if(t.idx===this.occurrence){var o=first$2(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkAtLeastOne.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterAtLeastOneSepWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,n,s){if(t.idx===this.occurrence){var o=first$2(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkAtLeastOneSep.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker);function possiblePathsFrom(r,e,t){t===void 0&&(t=[]),t=cloneArr(t);var n=[],s=0;function o(c){return c.concat(drop(r,s+1))}function a(c){var d=possiblePathsFrom(o(c),e,t);return n.concat(d)}for(;t.length<e&&s<r.length;){var l=r[s];if(l instanceof Flat)return a(l.definition);if(l instanceof NonTerminal)return a(l.definition);if(l instanceof Option$1)n=a(l.definition);else if(l instanceof RepetitionMandatory){var u=l.definition.concat([new Repetition({definition:l.definition})]);return a(u)}else if(l instanceof RepetitionMandatoryWithSeparator){var u=[new Flat({definition:l.definition}),new Repetition({definition:[new Terminal({terminalType:l.separator})].concat(l.definition)})];return a(u)}else if(l instanceof RepetitionWithSeparator){var u=l.definition.concat([new Repetition({definition:[new Terminal({terminalType:l.separator})].concat(l.definition)})]);n=a(u)}else if(l instanceof Repetition){var u=l.definition.concat([new Repetition({definition:l.definition})]);n=a(u)}else{if(l instanceof Alternation)return forEach$1(l.definition,function(c){n=a(c.definition)}),n;if(l instanceof Terminal)t.push(l.terminalType);else throw Error("non exhaustive match")}s++}return n.push({partialPath:t,suffixDef:drop(r,s)}),n}function nextPossibleTokensAfter(r,e,t,n){var s="EXIT_NONE_TERMINAL",o=[s],a="EXIT_ALTERNATIVE",l=!1,u=e.length,c=u-n-1,d=[],f=[];for(f.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!isEmpty(f);){var C=f.pop();if(C===a){l&&last(f).idx<=c&&f.pop();continue}var m=C.def,E=C.idx,v=C.ruleStack,_=C.occurrenceStack;if(!isEmpty(m)){var T=m[0];if(T===s){var R={idx:E,def:drop(m),ruleStack:dropRight(v),occurrenceStack:dropRight(_)};f.push(R)}else if(T instanceof Terminal)if(E<u-1){var O=E+1,N=e[O];if(t(N,T.terminalType)){var R={idx:O,def:drop(m),ruleStack:v,occurrenceStack:_};f.push(R)}}else if(E===u-1)d.push({nextTokenType:T.terminalType,nextTokenOccurrence:T.idx,ruleStack:v,occurrenceStack:_}),l=!0;else throw Error("non exhaustive match");else if(T instanceof NonTerminal){var G=cloneArr(v);G.push(T.nonTerminalName);var D=cloneArr(_);D.push(T.idx);var R={idx:E,def:T.definition.concat(o,drop(m)),ruleStack:G,occurrenceStack:D};f.push(R)}else if(T instanceof Option$1){var k={idx:E,def:drop(m),ruleStack:v,occurrenceStack:_};f.push(k),f.push(a);var z={idx:E,def:T.definition.concat(drop(m)),ruleStack:v,occurrenceStack:_};f.push(z)}else if(T instanceof RepetitionMandatory){var ne=new Repetition({definition:T.definition,idx:T.idx}),Z=T.definition.concat([ne],drop(m)),R={idx:E,def:Z,ruleStack:v,occurrenceStack:_};f.push(R)}else if(T instanceof RepetitionMandatoryWithSeparator){var ve=new Terminal({terminalType:T.separator}),ne=new Repetition({definition:[ve].concat(T.definition),idx:T.idx}),Z=T.definition.concat([ne],drop(m)),R={idx:E,def:Z,ruleStack:v,occurrenceStack:_};f.push(R)}else if(T instanceof RepetitionWithSeparator){var k={idx:E,def:drop(m),ruleStack:v,occurrenceStack:_};f.push(k),f.push(a);var ve=new Terminal({terminalType:T.separator}),xe=new Repetition({definition:[ve].concat(T.definition),idx:T.idx}),Z=T.definition.concat([xe],drop(m)),z={idx:E,def:Z,ruleStack:v,occurrenceStack:_};f.push(z)}else if(T instanceof Repetition){var k={idx:E,def:drop(m),ruleStack:v,occurrenceStack:_};f.push(k),f.push(a);var xe=new Repetition({definition:T.definition,idx:T.idx}),Z=T.definition.concat([xe],drop(m)),z={idx:E,def:Z,ruleStack:v,occurrenceStack:_};f.push(z)}else if(T instanceof Alternation)for(var de=T.definition.length-1;de>=0;de--){var Se=T.definition[de],Me={idx:E,def:Se.definition.concat(drop(m)),ruleStack:v,occurrenceStack:_};f.push(Me),f.push(a)}else if(T instanceof Flat)f.push({idx:E,def:T.definition.concat(drop(m)),ruleStack:v,occurrenceStack:_});else if(T instanceof Rule)f.push(expandTopLevelRule(T,E,v,_));else throw Error("non exhaustive match")}}return d}function expandTopLevelRule(r,e,t,n){var s=cloneArr(t);s.push(r.name);var o=cloneArr(n);return o.push(1),{idx:e,def:r.definition,ruleStack:s,occurrenceStack:o}}var __extends$3=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),PROD_TYPE;(function(r){r[r.OPTION=0]="OPTION",r[r.REPETITION=1]="REPETITION",r[r.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",r[r.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",r[r.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",r[r.ALTERNATION=5]="ALTERNATION"})(PROD_TYPE||(PROD_TYPE={}));function getProdType(r){if(r instanceof Option$1)return PROD_TYPE.OPTION;if(r instanceof Repetition)return PROD_TYPE.REPETITION;if(r instanceof RepetitionMandatory)return PROD_TYPE.REPETITION_MANDATORY;if(r instanceof RepetitionMandatoryWithSeparator)return PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR;if(r instanceof RepetitionWithSeparator)return PROD_TYPE.REPETITION_WITH_SEPARATOR;if(r instanceof Alternation)return PROD_TYPE.ALTERNATION;throw Error("non exhaustive match")}function buildLookaheadFuncForOr(r,e,t,n,s,o){var a=getLookaheadPathsForOr(r,e,t),l=areTokenCategoriesNotUsed(a)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return o(a,n,l,s)}function buildLookaheadFuncForOptionalProd(r,e,t,n,s,o){var a=getLookaheadPathsForOptionalProd(r,e,s,t),l=areTokenCategoriesNotUsed(a)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return o(a[0],l,n)}function buildAlternativesLookAheadFunc(r,e,t,n){var s=r.length,o=every(r,function(u){return every(u,function(c){return c.length===1})});if(e)return function(u){for(var c=map(u,function(O){return O.GATE}),d=0;d<s;d++){var f=r[d],C=f.length,m=c[d];if(!(m!==void 0&&m.call(this)===!1))e:for(var E=0;E<C;E++){for(var v=f[E],_=v.length,T=0;T<_;T++){var R=this.LA(T+1);if(t(R,v[T])===!1)continue e}return d}}};if(o&&!n){var a=map(r,function(u){return flatten(u)}),l=reduce(a,function(u,c,d){return forEach$1(c,function(f){has(u,f.tokenTypeIdx)||(u[f.tokenTypeIdx]=d),forEach$1(f.categoryMatches,function(C){has(u,C)||(u[C]=d)})}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]}}else return function(){for(var u=0;u<s;u++){var c=r[u],d=c.length;e:for(var f=0;f<d;f++){for(var C=c[f],m=C.length,E=0;E<m;E++){var v=this.LA(E+1);if(t(v,C[E])===!1)continue e}return u}}}}function buildSingleAlternativeLookaheadFunction(r,e,t){var n=every(r,function(c){return c.length===1}),s=r.length;if(n&&!t){var o=flatten(r);if(o.length===1&&isEmpty(o[0].categoryMatches)){var a=o[0],l=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===l}}else{var u=reduce(o,function(c,d,f){return c[d.tokenTypeIdx]=!0,forEach$1(d.categoryMatches,function(C){c[C]=!0}),c},[]);return function(){var c=this.LA(1);return u[c.tokenTypeIdx]===!0}}}else return function(){e:for(var c=0;c<s;c++){for(var d=r[c],f=d.length,C=0;C<f;C++){var m=this.LA(C+1);if(e(m,d[C])===!1)continue e}return!0}return!1}}var RestDefinitionFinderWalker=function(r){__extends$3(e,r);function e(t,n,s){var o=r.call(this)||this;return o.topProd=t,o.targetOccurrence=n,o.targetProdType=s,o}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,n,s,o){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=s.concat(o),!0):!1},e.prototype.walkOption=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.OPTION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOne=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOneSep=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkMany=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkManySep=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e}(RestWalker),InsideDefinitionFinderVisitor=function(r){__extends$3(e,r);function e(t,n,s){var o=r.call(this)||this;return o.targetOccurrence=t,o.targetProdType=n,o.targetRef=s,o.result=[],o}return e.prototype.checkIsTarget=function(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,PROD_TYPE.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,PROD_TYPE.ALTERNATION)},e}(GAstVisitor);function initializeArrayOfArrays(r){for(var e=new Array(r),t=0;t<r;t++)e[t]=[];return e}function pathToHashKeys(r){for(var e=[""],t=0;t<r.length;t++){for(var n=r[t],s=[],o=0;o<e.length;o++){var a=e[o];s.push(a+"_"+n.tokenTypeIdx);for(var l=0;l<n.categoryMatches.length;l++){var u="_"+n.categoryMatches[l];s.push(a+u)}}e=s}return e}function isUniquePrefixHash(r,e,t){for(var n=0;n<r.length;n++)if(n!==t)for(var s=r[n],o=0;o<e.length;o++){var a=e[o];if(s[a]===!0)return!1}return!0}function lookAheadSequenceFromAlternatives(r,e){for(var t=map(r,function(d){return possiblePathsFrom([d],1)}),n=initializeArrayOfArrays(t.length),s=map(t,function(d){var f={};return forEach$1(d,function(C){var m=pathToHashKeys(C.partialPath);forEach$1(m,function(E){f[E]=!0})}),f}),o=t,a=1;a<=e;a++){var l=o;o=initializeArrayOfArrays(l.length);for(var u=function(d){for(var f=l[d],C=0;C<f.length;C++){var m=f[C].partialPath,E=f[C].suffixDef,v=pathToHashKeys(m),_=isUniquePrefixHash(s,v,d);if(_||isEmpty(E)||m.length===e){var T=n[d];if(containsPath(T,m)===!1){T.push(m);for(var R=0;R<v.length;R++){var O=v[R];s[d][O]=!0}}}else{var N=possiblePathsFrom(E,a+1,m);o[d]=o[d].concat(N),forEach$1(N,function(G){var D=pathToHashKeys(G.partialPath);forEach$1(D,function(k){s[d][k]=!0})})}}},c=0;c<l.length;c++)u(c)}return n}function getLookaheadPathsForOr(r,e,t,n){var s=new InsideDefinitionFinderVisitor(r,PROD_TYPE.ALTERNATION,n);return e.accept(s),lookAheadSequenceFromAlternatives(s.result,t)}function getLookaheadPathsForOptionalProd(r,e,t,n){var s=new InsideDefinitionFinderVisitor(r,t);e.accept(s);var o=s.result,a=new RestDefinitionFinderWalker(e,r,t),l=a.startWalking(),u=new Flat({definition:o}),c=new Flat({definition:l});return lookAheadSequenceFromAlternatives([u,c],n)}function containsPath(r,e){e:for(var t=0;t<r.length;t++){var n=r[t];if(n.length===e.length){for(var s=0;s<n.length;s++){var o=e[s],a=n[s],l=o===a||a.categoryMatchesMap[o.tokenTypeIdx]!==void 0;if(l===!1)continue e}return!0}}return!1}function isStrictPrefixOfPath(r,e){return r.length<e.length&&every(r,function(t,n){var s=e[n];return t===s||s.categoryMatchesMap[t.tokenTypeIdx]})}function areTokenCategoriesNotUsed(r){return every(r,function(e){return every(e,function(t){return every(t,function(n){return isEmpty(n.categoryMatches)})})})}var __extends$2=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function validateGrammar$1(r,e,t,n,s,o){var a=map(r,function(R){return validateDuplicateProductions(R,s)}),l=map(r,function(R){return validateNoLeftRecursion(R,R,s)}),u=[],c=[],d=[];every(l,isEmpty)&&(u=map(r,function(R){return validateEmptyOrAlternative(R,s)}),c=map(r,function(R){return validateAmbiguousAlternationAlternatives(R,e,n,s)}),d=validateSomeNonEmptyLookaheadPath(r,e,s));var f=checkTerminalAndNoneTerminalsNameSpace(r,t,s),C=map(t,function(R){return validateTokenName(R,s)}),m=validateNestedRulesNames(r,s),E=validateDuplicateNestedRules(r,s),v=map(r,function(R){return validateTooManyAlts(R,s)}),_=map(r,function(R){return validateRuleName(R,s)}),T=map(r,function(R){return validateRuleDoesNotAlreadyExist(R,r,o,s)});return flatten(a.concat(C,m,E,d,l,u,c,f,v,_,T))}function validateNestedRulesNames(r,e){var t=[];return forEach$1(r,function(n){var s=new NamedDSLMethodsCollectorVisitor("");n.accept(s);var o=map(s.result,function(a){return a.orgProd});t.push(map(o,function(a){return validateNestedRuleName(n,a,e)}))}),flatten(t)}function validateDuplicateProductions(r,e){var t=new OccurrenceValidationCollector;r.accept(t);var n=t.allProductions,s=groupBy(n,identifyProductionForDuplicates),o=pick(s,function(l){return l.length>1}),a=map(values(o),function(l){var u=first$2(l),c=e.buildDuplicateFoundError(r,l),d=getProductionDslName(u),f={message:c,type:ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:d,occurrence:u.idx},C=getExtraProductionArgument(u);return C&&(f.parameter=C),f});return a}function identifyProductionForDuplicates(r){return getProductionDslName(r)+"_#_"+r.idx+"_#_"+getExtraProductionArgument(r)}function getExtraProductionArgument(r){return r instanceof Terminal?r.terminalType.name:r instanceof NonTerminal?r.nonTerminalName:""}var OccurrenceValidationCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(GAstVisitor),validTermsPattern=/^[a-zA-Z_]\w*$/,validNestedRuleName=new RegExp(validTermsPattern.source.replace("^","^\\$"));function validateRuleName(r,e){var t=[],n=r.name;return n.match(validTermsPattern)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:r,expectedPattern:validTermsPattern}),type:ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),t}function validateNestedRuleName(r,e,t){var n=[],s;return e.name.match(validNestedRuleName)||(s=t.buildInvalidNestedRuleNameError(r,e),n.push({message:s,type:ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:r.name})),n}function validateTokenName(r,e){var t=[],n=r.name;return n.match(validTermsPattern)||t.push({message:e.buildTokenNameError({tokenType:r,expectedPattern:validTermsPattern}),type:ParserDefinitionErrorType.INVALID_TOKEN_NAME}),t}function validateRuleDoesNotAlreadyExist(r,e,t,n){var s=[],o=reduce(e,function(l,u){return u.name===r.name?l+1:l},0);if(o>1){var a=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:t});s.push({message:a,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:r.name})}return s}function validateRuleIsOverridden(r,e,t){var n=[],s;return contains$1(e,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",n.push({message:s,type:ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:r})),n}function validateNoLeftRecursion(r,e,t,n){n===void 0&&(n=[]);var s=[],o=getFirstNoneTerminal(e.definition);if(isEmpty(o))return[];var a=r.name,l=contains$1(o,r);l&&s.push({message:t.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:n}),type:ParserDefinitionErrorType.LEFT_RECURSION,ruleName:a});var u=difference(o,n.concat([r])),c=map(u,function(d){var f=cloneArr(n);return f.push(d),validateNoLeftRecursion(r,d,t,f)});return s.concat(flatten(c))}function getFirstNoneTerminal(r){var e=[];if(isEmpty(r))return e;var t=first$2(r);if(t instanceof NonTerminal)e.push(t.referencedRule);else if(t instanceof Flat||t instanceof Option$1||t instanceof RepetitionMandatory||t instanceof RepetitionMandatoryWithSeparator||t instanceof RepetitionWithSeparator||t instanceof Repetition)e=e.concat(getFirstNoneTerminal(t.definition));else if(t instanceof Alternation)e=flatten(map(t.definition,function(a){return getFirstNoneTerminal(a.definition)}));else if(!(t instanceof Terminal))throw Error("non exhaustive match");var n=isOptionalProd(t),s=r.length>1;if(n&&s){var o=drop(r);return e.concat(getFirstNoneTerminal(o))}else return e}var OrCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(GAstVisitor);function validateEmptyOrAlternative(r,e){var t=new OrCollector;r.accept(t);var n=t.alternations,s=reduce(n,function(o,a){var l=dropRight(a.definition),u=map(l,function(c,d){var f=nextPossibleTokensAfter([c],[],null,1);return isEmpty(f)?{message:e.buildEmptyAlternationError({topLevelRule:r,alternation:a,emptyChoiceIdx:d}),type:ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:a.idx,alternative:d+1}:null});return o.concat(compact(u))},[]);return s}function validateAmbiguousAlternationAlternatives(r,e,t,n){var s=new OrCollector;r.accept(s);var o=s.alternations,a=t[r.name];a&&(o=reject(o,function(u){return a[getProductionDslName(u)+(u.idx===0?"":u.idx)]})),o=reject(o,function(u){return u.ignoreAmbiguities===!0});var l=reduce(o,function(u,c){var d=c.idx,f=c.maxLookahead||e,C=getLookaheadPathsForOr(d,r,f,c),m=checkAlternativesAmbiguities(C,c,r,n),E=checkPrefixAlternativesAmbiguities(C,c,r,n);return u.concat(m,E)},[]);return l}var RepetionCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(GAstVisitor);function validateTooManyAlts(r,e){var t=new OrCollector;r.accept(t);var n=t.alternations,s=reduce(n,function(o,a){return a.definition.length>255&&o.push({message:e.buildTooManyAlternativesError({topLevelRule:r,alternation:a}),type:ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:r.name,occurrence:a.idx}),o},[]);return s}function validateSomeNonEmptyLookaheadPath(r,e,t){var n=[];return forEach$1(r,function(s){var o=new RepetionCollector;s.accept(o);var a=o.allProductions;forEach$1(a,function(l){var u=getProdType(l),c=l.maxLookahead||e,d=l.idx,f=getLookaheadPathsForOptionalProd(d,s,u,c),C=f[0];if(isEmpty(flatten(C))){var m=t.buildEmptyRepetitionError({topLevelRule:s,repetition:l});n.push({message:m,type:ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:s.name})}})}),n}function checkAlternativesAmbiguities(r,e,t,n){var s=[],o=reduce(r,function(l,u,c){return e.definition[c].ignoreAmbiguities===!0||forEach$1(u,function(d){var f=[c];forEach$1(r,function(C,m){c!==m&&containsPath(C,d)&&e.definition[m].ignoreAmbiguities!==!0&&f.push(m)}),f.length>1&&!containsPath(s,d)&&(s.push(d),l.push({alts:f,path:d}))}),l},[]),a=map(o,function(l){var u=map(l.alts,function(d){return d+1}),c=n.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:u,prefixPath:l.path});return{message:c,type:ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[l.alts]}});return a}function checkPrefixAlternativesAmbiguities(r,e,t,n){var s=[],o=reduce(r,function(a,l,u){var c=map(l,function(d){return{idx:u,path:d}});return a.concat(c)},[]);return forEach$1(o,function(a){var l=e.definition[a.idx];if(l.ignoreAmbiguities!==!0){var u=a.idx,c=a.path,d=findAll(o,function(C){return e.definition[C.idx].ignoreAmbiguities!==!0&&C.idx<u&&isStrictPrefixOfPath(C.path,c)}),f=map(d,function(C){var m=[C.idx+1,u+1],E=e.idx===0?"":e.idx,v=n.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:m,prefixPath:C.path});return{message:v,type:ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:E,alternatives:m}});s=s.concat(f)}}),s}function checkTerminalAndNoneTerminalsNameSpace(r,e,t){var n=[],s=map(e,function(o){return o.name});return forEach$1(r,function(o){var a=o.name;if(contains$1(s,a)){var l=t.buildNamespaceConflictError(o);n.push({message:l,type:ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),n}function validateDuplicateNestedRules(r,e){var t=[];return forEach$1(r,function(n){var s=new NamedDSLMethodsCollectorVisitor("");n.accept(s);var o=groupBy(s.result,function(l){return l.name}),a=pick(o,function(l){return l.length>1});forEach$1(values(a),function(l){var u=map(l,function(d){return d.orgProd}),c=e.buildDuplicateNestedRuleNameError(n,u);t.push({message:c,type:ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),t}var defaultParserErrorProvider={buildMismatchTokenMessage:function(r){var e=r.expected,t=r.actual;r.previous,r.ruleName;var n=hasTokenLabel(e),s=n?"--> "+tokenLabel(e)+" <--":"token of type --> "+e.name+" <--",o="Expecting "+s+" but found --> '"+t.image+"' <--";return o},buildNotAllInputParsedMessage:function(r){var e=r.firstRedundant;return r.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(r){var e=r.expectedPathsPerAlt,t=r.actual;r.previous;var n=r.customUserDescription;r.ruleName;var s="Expecting: ",o=first$2(t).image,a=`
but found: '`+o+"'";if(n)return s+n+a;var l=reduce(e,function(f,C){return f.concat(C)},[]),u=map(l,function(f){return"["+map(f,function(C){return tokenLabel(C)}).join(", ")+"]"}),c=map(u,function(f,C){return"  "+(C+1)+". "+f}),d=`one of these possible Token sequences:
`+c.join(`
`);return s+d+a},buildEarlyExitMessage:function(r){var e=r.expectedIterationPaths,t=r.actual,n=r.customUserDescription;r.ruleName;var s="Expecting: ",o=first$2(t).image,a=`
but found: '`+o+"'";if(n)return s+n+a;var l=map(e,function(c){return"["+map(c,function(d){return tokenLabel(d)}).join(",")+"]"}),u=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+l.join(" ,")+">");return s+u+a}};Object.freeze(defaultParserErrorProvider);var defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(r,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+r.name+"<-";return t}},defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(r,e){function t(d){return d instanceof Terminal?d.terminalType.name:d instanceof NonTerminal?d.nonTerminalName:""}var n=r.name,s=first$2(e),o=s.idx,a=getProductionDslName(s),l=t(s),u=o>0,c="->"+a+(u?o:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildInvalidNestedRuleNameError:function(r,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+r.name+`<-
`+("it must match the pattern: ->"+validNestedRuleName.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(r,e){var t=first$2(e).name,n="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+r.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(r){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+r.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(r){var e=map(r.prefixPath,function(s){return tokenLabel(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous alternatives: <"+r.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(r){var e=map(r.prefixPath,function(s){return tokenLabel(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous Alternatives Detected: <"+r.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(r){var e=getProductionDslName(r.repetition);r.repetition.idx!==0&&(e+=r.repetition.idx);var t="The repetition <"+e+"> within Rule <"+r.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(r){var e=r.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+r.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(r){var e="Ambiguous empty alternative: <"+(r.emptyChoiceIdx+1)+">"+(" in <OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(r){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
 has `+(r.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(r){var e=r.topLevelRule.name,t=map(r.leftRecursionPath,function(o){return o.name}),n=e+" --> "+t.concat([e]).join(" --> "),s=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return s},buildInvalidRuleNameError:function(r){var e=r.topLevelRule.name,t=r.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return n},buildDuplicateRuleNameError:function(r){var e;r.topLevelRule instanceof Rule?e=r.topLevelRule.name:e=r.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+r.grammarName+"<-";return t}},__extends$1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function resolveGrammar$1(r,e){var t=new GastRefResolverVisitor(r,e);return t.resolveRefs(),t.errors}var GastRefResolverVisitor=function(r){__extends$1(e,r);function e(t,n){var s=r.call(this)||this;return s.nameToTopRule=t,s.errMsgProvider=n,s.errors=[],s}return e.prototype.resolveRefs=function(){var t=this;forEach$1(values(this.nameToTopRule),function(n){t.currTopLevel=n,n.accept(t)})},e.prototype.visitNonTerminal=function(t){var n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{var s=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:s,type:ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(GAstVisitor);function resolveGrammar(r){r=defaults(r,{errMsgProvider:defaultGrammarResolverErrorProvider});var e={};return forEach$1(r.rules,function(t){e[t.name]=t}),resolveGrammar$1(e,r.errMsgProvider)}function validateGrammar(r){return r=defaults(r,{errMsgProvider:defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),validateGrammar$1(r.rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName)}var MISMATCHED_TOKEN_EXCEPTION="MismatchedTokenException",NO_VIABLE_ALT_EXCEPTION="NoViableAltException",EARLY_EXIT_EXCEPTION="EarlyExitException",NOT_ALL_INPUT_PARSED_EXCEPTION="NotAllInputParsedException",RECOGNITION_EXCEPTION_NAMES=[MISMATCHED_TOKEN_EXCEPTION,NO_VIABLE_ALT_EXCEPTION,EARLY_EXIT_EXCEPTION,NOT_ALL_INPUT_PARSED_EXCEPTION];Object.freeze(RECOGNITION_EXCEPTION_NAMES);function isRecognitionException(r){return contains$1(RECOGNITION_EXCEPTION_NAMES,r.name)}function MismatchedTokenException(r,e,t){this.name=MISMATCHED_TOKEN_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}MismatchedTokenException.prototype=Error.prototype;function NoViableAltException(r,e,t){this.name=NO_VIABLE_ALT_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}NoViableAltException.prototype=Error.prototype;function NotAllInputParsedException(r,e){this.name=NOT_ALL_INPUT_PARSED_EXCEPTION,this.message=r,this.token=e,this.resyncedTokens=[]}NotAllInputParsedException.prototype=Error.prototype;function EarlyExitException(r,e,t){this.name=EARLY_EXIT_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}EarlyExitException.prototype=Error.prototype;var EOF_FOLLOW_KEY={},IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";function InRuleRecoveryException(r){this.name=IN_RULE_RECOVERY_EXCEPTION,this.message=r}InRuleRecoveryException.prototype=Error.prototype;var Recoverable=function(){function r(){}return r.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=has(e,"recoveryEnabled")?e.recoveryEnabled:DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=attemptInRepetitionRecovery)},r.prototype.getTokenToInsert=function(e){var t=createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},r.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},r.prototype.tryInRepetitionRecovery=function(e,t,n,s){for(var o=this,a=this.findReSyncTokenType(),l=this.exportLexerState(),u=[],c=!1,d=this.LA(1),f=this.LA(1),C=function(){var m=o.LA(0),E=o.errorMessageProvider.buildMismatchTokenMessage({expected:s,actual:d,previous:m,ruleName:o.getCurrRuleFullName()}),v=new MismatchedTokenException(E,d,o.LA(0));v.resyncedTokens=dropRight(u),o.SAVE_ERROR(v)};!c;)if(this.tokenMatcher(f,s)){C();return}else if(n.call(this)){C(),e.apply(this,t);return}else this.tokenMatcher(f,a)?c=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,u));this.importLexerState(l)},r.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!(n===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},r.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t),s=this.getNextPossibleTokenTypes(n);return s},r.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var s=this.SKIP_TOKEN();return this.consumeToken(),s}throw new InRuleRecoveryException("sad sad panda")},r.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},r.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||isEmpty(t))return!1;var s=this.LA(1),o=find(t,function(a){return n.tokenMatcher(s,a)})!==void 0;return o},r.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},r.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return contains$1(n,e)},r.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var s=t.tokenType;if(contains$1(e,s))return s;t=this.LA(n),n++}},r.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return EOF_FOLLOW_KEY;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},r.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return isEmpty(this.LAST_EXPLICIT_RULE_STACK)||(t=map(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_STACK[s]}),n=map(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_OCCURRENCE_STACK[s]})),map(t,function(s,o){return o===0?EOF_FOLLOW_KEY:{ruleName:e.shortRuleNameToFullName(s),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(t[o-1])}})},r.prototype.flattenFollowSet=function(){var e=this,t=map(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return flatten(t)},r.prototype.getFollowSetFromFollowKey=function(e){if(e===EOF_FOLLOW_KEY)return[EOF];var t=e.ruleName+e.idxInCallingRule+IN+e.inRule;return this.resyncFollows[t]},r.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,EOF)||t.push(e),t},r.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return dropRight(t)},r.prototype.attemptInRepetitionRecovery=function(e,t,n,s,o,a,l){},r.prototype.getCurrentGrammarPath=function(e,t){var n=this.getHumanReadableRuleStack(),s=cloneArr(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:s,lastTok:e,lastTokOccurrence:t};return o},r.prototype.getHumanReadableRuleStack=function(){var e=this;return isEmpty(this.LAST_EXPLICIT_RULE_STACK)?map(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):map(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},r}();function attemptInRepetitionRecovery(r,e,t,n,s,o,a){var l=this.getKeyForAutomaticLookahead(n,s),u=this.firstAfterRepMap[l];if(u===void 0){var c=this.getCurrRuleFullName(),d=this.getGAstProductions()[c],f=new o(d,s);u=f.startWalking(),this.firstAfterRepMap[l]=u}var C=u.token,m=u.occurrence,E=u.isEndOfRule;this.RULE_STACK.length===1&&E&&C===void 0&&(C=EOF,m=1),this.shouldInRepetitionRecoveryBeTried(C,m,a)&&this.tryInRepetitionRecovery(r,e,t,C)}var LooksAhead=function(){function r(){}return r.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=has(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=has(e,"maxLookahead")?e.maxLookahead:DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=isES2015MapSupported()?new Map:[],isES2015MapSupported()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},r.prototype.preComputeLookaheadFunctions=function(e){var t=this;forEach$1(e,function(n){t.TRACE_INIT(n.name+" Rule Lookahead",function(){var s=collectMethods(n),o=s.alternation,a=s.repetition,l=s.option,u=s.repetitionMandatory,c=s.repetitionMandatoryWithSeparator,d=s.repetitionWithSeparator;forEach$1(o,function(f){var C=f.idx===0?"":f.idx;t.TRACE_INIT(""+getProductionDslName(f)+C,function(){var m=buildLookaheadFuncForOr(f.idx,n,f.maxLookahead||t.maxLookahead,f.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),E=getKeyForAutomaticLookahead(t.fullRuleNameToShort[n.name],OR_IDX,f.idx);t.setLaFuncCache(E,m)})}),forEach$1(a,function(f){t.computeLookaheadFunc(n,f.idx,MANY_IDX,PROD_TYPE.REPETITION,f.maxLookahead,getProductionDslName(f))}),forEach$1(l,function(f){t.computeLookaheadFunc(n,f.idx,OPTION_IDX,PROD_TYPE.OPTION,f.maxLookahead,getProductionDslName(f))}),forEach$1(u,function(f){t.computeLookaheadFunc(n,f.idx,AT_LEAST_ONE_IDX,PROD_TYPE.REPETITION_MANDATORY,f.maxLookahead,getProductionDslName(f))}),forEach$1(c,function(f){t.computeLookaheadFunc(n,f.idx,AT_LEAST_ONE_SEP_IDX,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,f.maxLookahead,getProductionDslName(f))}),forEach$1(d,function(f){t.computeLookaheadFunc(n,f.idx,MANY_SEP_IDX,PROD_TYPE.REPETITION_WITH_SEPARATOR,f.maxLookahead,getProductionDslName(f))})})})},r.prototype.computeLookaheadFunc=function(e,t,n,s,o,a){var l=this;this.TRACE_INIT(""+a+(t===0?"":t),function(){var u=buildLookaheadFuncForOptionalProd(t,e,o||l.maxLookahead,l.dynamicTokensEnabled,s,l.lookAheadBuilderForOptional),c=getKeyForAutomaticLookahead(l.fullRuleNameToShort[e.name],n,t);l.setLaFuncCache(c,u)})},r.prototype.lookAheadBuilderForOptional=function(e,t,n){return buildSingleAlternativeLookaheadFunction(e,t,n)},r.prototype.lookAheadBuilderForAlternatives=function(e,t,n,s){return buildAlternativesLookAheadFunc(e,t,n,s)},r.prototype.getKeyForAutomaticLookahead=function(e,t){var n=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(n,e,t)},r.prototype.getLaFuncFromCache=function(e){},r.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},r.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},r.prototype.setLaFuncCache=function(e,t){},r.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},r.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},r}();function classNameFromInstance(r){return functionName(r.constructor)}var FUNC_NAME_REGEXP=/^\s*function\s*(\S*)\s*\(/,NAME="name";function functionName(r){var e=r.name;if(e)return e;var t=r.toString().match(FUNC_NAME_REGEXP)[1];return t}function defineNameProp(r,e){var t=Object.getOwnPropertyDescriptor(r,NAME);return isUndefined(t)||t.configurable?(Object.defineProperty(r,NAME,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function defaultVisit(r,e){for(var t=keys$1(r),n=t.length,s=0;s<n;s++)for(var o=t[s],a=r[o],l=a.length,u=0;u<l;u++){var c=a[u];c.tokenTypeIdx===void 0&&(c.fullName!==void 0?this[c.fullName](c.children,e):this[c.name](c.children,e))}}function createBaseSemanticVisitorConstructor(r,e){var t=function(){};defineNameProp(t,r+"BaseSemantics");var n={visit:function(s,o){if(isArray(s)&&(s=s[0]),!isUndefined(s))return s.fullName!==void 0?this[s.fullName](s.children,o):this[s.name](s.children,o)},validateVisitor:function(){var s=validateVisitor(this,e);if(!isEmpty(s)){var o=map(s,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+functionName(this.constructor)+`>:
	`+(""+o.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=n,t.prototype.constructor=t,t._RULE_NAMES=e,t}function createBaseVisitorConstructorWithDefaults(r,e,t){var n=function(){};defineNameProp(n,r+"BaseSemanticsWithDefaults");var s=Object.create(t.prototype);return forEach$1(e,function(o){s[o]=defaultVisit}),n.prototype=s,n.prototype.constructor=n,n}var CstVisitorDefinitionError;(function(r){r[r.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",r[r.MISSING_METHOD=1]="MISSING_METHOD"})(CstVisitorDefinitionError||(CstVisitorDefinitionError={}));function validateVisitor(r,e){var t=validateMissingCstMethods(r,e),n=validateRedundantMethods(r,e);return t.concat(n)}function validateMissingCstMethods(r,e){var t=map(e,function(n){if(!isFunction$1(r[n]))return{msg:"Missing visitor method: <"+n+"> on "+functionName(r.constructor)+" CST Visitor.",type:CstVisitorDefinitionError.MISSING_METHOD,methodName:n}});return compact(t)}var VALID_PROP_NAMES=["constructor","visit","validateVisitor"];function validateRedundantMethods(r,e){var t=[];for(var n in r)validTermsPattern.test(n)&&isFunction$1(r[n])&&!contains$1(VALID_PROP_NAMES,n)&&!contains$1(e,n)&&t.push({msg:"Redundant visitor method: <"+n+"> on "+functionName(r.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+validTermsPattern.source+"/."),type:CstVisitorDefinitionError.REDUNDANT_METHOD,methodName:n});return t}var TreeBuilder=function(){function r(){}return r.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=has(e,"outputCst")?e.outputCst:DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=has(e,"nodeLocationTracking")?e.nodeLocationTracking:DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=NOOP,this.cstFinallyStateUpdate=NOOP,this.cstPostTerminal=NOOP,this.cstPostNonTerminal=NOOP,this.cstPostRule=NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationFull,this.setNodeLocationFromNode=setNodeLocationFull,this.cstPostRule=NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationOnlyOffset,this.setNodeLocationFromNode=setNodeLocationOnlyOffset,this.cstPostRule=NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=NOOP,this.setInitialNodeLocation=NOOP;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},r.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},r.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?n.endOffset=t.endOffset:n.startOffset=NaN},r.prototype.cstPostTerminal=function(e,t){var n=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(n,t,e),this.setNodeLocationFromToken(n.location,t)},r.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},r.prototype.getBaseCstVisitorConstructor=function(){if(isUndefined(this.baseCstVisitorConstructor)){var e=createBaseSemanticVisitorConstructor(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(isUndefined(this.baseCstVisitorWithDefaultsConstructor)){var e=createBaseVisitorConstructorWithDefaults(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.nestedRuleBeforeClause=function(e,t){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n},r.prototype.nestedAltBeforeClause=function(e,t,n,s){var o=this.getLastExplicitRuleShortName(),a=getKeyForAltIndex(o,n,t,s),l;if(e.NAME!==void 0)return l=e.NAME,this.nestedRuleInvocationStateUpdate(l,a),{shortName:a,nestedName:l}},r.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,s=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];addNoneTerminalToCst(o,t,s),this.setNodeLocationFromNode(o.location,s.location)},r.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},r.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},r.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},r.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},r.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},r.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},r}(),LexerAdapter=function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):END_OF_FILE},r.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?END_OF_FILE:this.tokVector[t]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(e){this.currIdx=e},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r}(),RecognizerApi=function(){function r(){}return r.prototype.ACTION=function(e){return e.call(this)},r.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},r.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},r.prototype.option=function(e,t){return this.optionInternal(t,e)},r.prototype.or=function(e,t){return this.orInternal(t,e)},r.prototype.many=function(e,t){return this.manyInternal(e,t)},r.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},r.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},r.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},r.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},r.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},r.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},r.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},r.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},r.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},r.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},r.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},r.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},r.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},r.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},r.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},r.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},r.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},r.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},r.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},r.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},r.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},r.prototype.OPTION=function(e){return this.optionInternal(e,0)},r.prototype.OPTION1=function(e){return this.optionInternal(e,1)},r.prototype.OPTION2=function(e){return this.optionInternal(e,2)},r.prototype.OPTION3=function(e){return this.optionInternal(e,3)},r.prototype.OPTION4=function(e){return this.optionInternal(e,4)},r.prototype.OPTION5=function(e){return this.optionInternal(e,5)},r.prototype.OPTION6=function(e){return this.optionInternal(e,6)},r.prototype.OPTION7=function(e){return this.optionInternal(e,7)},r.prototype.OPTION8=function(e){return this.optionInternal(e,8)},r.prototype.OPTION9=function(e){return this.optionInternal(e,9)},r.prototype.OR=function(e){return this.orInternal(e,0)},r.prototype.OR1=function(e){return this.orInternal(e,1)},r.prototype.OR2=function(e){return this.orInternal(e,2)},r.prototype.OR3=function(e){return this.orInternal(e,3)},r.prototype.OR4=function(e){return this.orInternal(e,4)},r.prototype.OR5=function(e){return this.orInternal(e,5)},r.prototype.OR6=function(e){return this.orInternal(e,6)},r.prototype.OR7=function(e){return this.orInternal(e,7)},r.prototype.OR8=function(e){return this.orInternal(e,8)},r.prototype.OR9=function(e){return this.orInternal(e,9)},r.prototype.MANY=function(e){this.manyInternal(0,e)},r.prototype.MANY1=function(e){this.manyInternal(1,e)},r.prototype.MANY2=function(e){this.manyInternal(2,e)},r.prototype.MANY3=function(e){this.manyInternal(3,e)},r.prototype.MANY4=function(e){this.manyInternal(4,e)},r.prototype.MANY5=function(e){this.manyInternal(5,e)},r.prototype.MANY6=function(e){this.manyInternal(6,e)},r.prototype.MANY7=function(e){this.manyInternal(7,e)},r.prototype.MANY8=function(e){this.manyInternal(8,e)},r.prototype.MANY9=function(e){this.manyInternal(9,e)},r.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},r.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},r.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},r.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},r.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},r.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},r.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},r.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},r.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},r.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},r.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},r.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},r.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},r.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},r.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},r.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},r.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},r.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},r.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},r.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},r.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},r.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},r.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},r.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},r.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},r.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},r.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},r.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},r.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},r.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},r.prototype.RULE=function(e,t,n){if(n===void 0&&(n=DEFAULT_RULE_CONFIG),contains$1(this.definedRulesNames,e)){var s=defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),o={message:s,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,t,n);return this[e]=a,a},r.prototype.OVERRIDE_RULE=function(e,t,n){n===void 0&&(n=DEFAULT_RULE_CONFIG);var s=[];s=s.concat(validateRuleIsOverridden(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,s);var o=this.defineRule(e,t,n);return this[e]=o,o},r.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(s){if(isRecognitionException(s))return!1;throw s}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return serializeGrammar(values(this.gastProductionsCache))},r}(),RecognizerEngine=function(){function r(){}return r.prototype.initRecognizerEngine=function(e,t){if(this.className=classNameFromInstance(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},has(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(isArray(e)){if(isEmpty(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(isArray(e))this.tokensMap=reduce(e,function(a,l){return a[l.name]=l,a},{});else if(has(e,"modes")&&every(flatten(values(e.modes)),isTokenType)){var n=flatten(values(e.modes)),s=uniq(n);this.tokensMap=reduce(s,function(a,l){return a[l.name]=l,a},{})}else if(isObject(e))this.tokensMap=cloneObj(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=EOF;var o=every(values(e),function(a){return isEmpty(a.categoryMatches)});this.tokenMatcher=o?tokenStructuredMatcherNoCategories:tokenStructuredMatcher,augmentTokenTypes(values(this.tokensMap))},r.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var s=has(n,"resyncEnabled")?n.resyncEnabled:DEFAULT_RULE_CONFIG.resyncEnabled,o=has(n,"recoveryValueFunc")?n.recoveryValueFunc:DEFAULT_RULE_CONFIG.recoveryValueFunc,a=this.ruleShortNameIdx<<BITS_FOR_METHOD_TYPE+BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function l(d){try{if(this.outputCst===!0){t.apply(this,d);var f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}else return t.apply(this,d)}catch(C){return this.invokeRuleCatch(C,s,o)}finally{this.ruleFinallyStateUpdate()}}var u;u=function(d,f){return d===void 0&&(d=0),this.ruleInvocationStateUpdate(a,e,d),l.call(this,f)};var c="ruleName";return u[c]=e,u.originalGrammarAction=t,u},r.prototype.invokeRuleCatch=function(e,t,n){var s=this.RULE_STACK.length===1,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(e)){var a=e;if(o){var l=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(l))if(a.resyncedTokens=this.reSyncTo(l),this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];return u.recoveredNode=!0,u}else return n();else{if(this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];u.recoveredNode=!0,a.partialCstResult=u}throw a}}else{if(s)return this.moveToTerminatedState(),n();throw a}}else throw e},r.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(OPTION_IDX,t),s=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(OPTION_IDX,t);return this.optionInternalLogic(e,t,n)},r.prototype.optionInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(e.DEF!==void 0){if(a=e.DEF,l=e.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=e;if(o.call(this)===!0)return a.call(this)},r.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,n)},r.prototype.atLeastOneInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(t.DEF!==void 0){if(a=t.DEF,l=t.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=t;if(o.call(this)===!0)for(var c=this.doSingleRepetition(a);o.call(this)===!0&&c===!0;)c=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],o,AT_LEAST_ONE_IDX,e,NextTerminalAfterAtLeastOneWalker)},r.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},r.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var s=this,o=t.DEF,a=t.SEP,l=this.getLaFuncFromCache(n);if(l.call(this)===!0){o.call(this);for(var u=function(){return s.tokenMatcher(s.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,o,NextTerminalAfterAtLeastOneSepWalker],u,AT_LEAST_ONE_SEP_IDX,e,NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},r.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_IDX,e);return this.manyInternalLogic(e,t,n)},r.prototype.manyInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(t.DEF!==void 0){if(a=t.DEF,l=t.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=t;for(var c=!0;o.call(this)===!0&&c===!0;)c=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],o,MANY_IDX,e,NextTerminalAfterManyWalker,c)},r.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,n)},r.prototype.manySepFirstInternalLogic=function(e,t,n){var s=this,o=t.DEF,a=t.SEP,l=this.getLaFuncFromCache(n);if(l.call(this)===!0){o.call(this);for(var u=function(){return s.tokenMatcher(s.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,o,NextTerminalAfterManySepWalker],u,MANY_SEP_IDX,e,NextTerminalAfterManySepWalker)}},r.prototype.repetitionSepSecondInternal=function(e,t,n,s,o){for(;n();)this.CONSUME(t),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,s,o],n,AT_LEAST_ONE_SEP_IDX,e,o)},r.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>t},r.prototype.orInternalNoCst=function(e,t){var n=isArray(e)?e:e.DEF,s=this.getKeyForAutomaticLookahead(OR_IDX,t),o=this.getLaFuncFromCache(s),a=o.call(this,n);if(a!==void 0){var l=n[a];return l.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},r.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(OR_IDX,t),s=this.nestedRuleBeforeClause(e,n);try{var o=isArray(e)?e:e.DEF,a=this.getLaFuncFromCache(n),l=a.call(this,o);if(l!==void 0){var u=o[l],c=this.nestedAltBeforeClause(u,t,OR_IDX,l);try{return u.ALT.call(this)}finally{c!==void 0&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(t,e))}},r.prototype.subruleInternal=function(e,t,n){var s;try{var o=n!==void 0?n.ARGS:void 0;return s=e.call(this,t,o),this.cstPostNonTerminal(s,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),s}catch(a){this.subruleInternalError(a,n,e.ruleName)}},r.prototype.subruleInternalError=function(e,t,n){throw isRecognitionException(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:n),delete e.partialCstResult),e},r.prototype.consumeInternal=function(e,t,n){var s;try{var o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),s=o):this.consumeInternalError(e,o,n)}catch(a){s=this.consumeInternalRecovery(e,t,a)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,s),s},r.prototype.consumeInternalError=function(e,t,n){var s,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?s=n.ERR_MSG:s=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new MismatchedTokenException(s,t,o))},r.prototype.consumeInternalRecovery=function(e,t,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var s=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,s)}catch(o){throw o.name===IN_RULE_RECOVERY_EXCEPTION?n:o}}else throw n},r.prototype.saveRecogState=function(){var e=this.errors,t=cloneArr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},r.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},r.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),EOF)},r.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r}(),ErrorHandler=function(){function r(){}return r.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=defaults(e.errorMessageProvider,DEFAULT_PARSER_CONFIG.errorMessageProvider)},r.prototype.SAVE_ERROR=function(e){if(isRecognitionException(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return cloneArr(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),r.prototype.raiseEarlyExitException=function(e,t,n){for(var s=this.getCurrRuleFullName(),o=this.getGAstProductions()[s],a=getLookaheadPathsForOptionalProd(e,o,t,this.maxLookahead),l=a[0],u=[],c=1;c<=this.maxLookahead;c++)u.push(this.LA(c));var d=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:l,actual:u,previous:this.LA(0),customUserDescription:n,ruleName:s});throw this.SAVE_ERROR(new EarlyExitException(d,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),s=this.getGAstProductions()[n],o=getLookaheadPathsForOr(e,s,this.maxLookahead),a=[],l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));var u=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:a,previous:u,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(c,this.LA(1),u))},r}(),ContentAssist=function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(isUndefined(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return nextPossibleTokensAfter([n],t,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(e){var t=first$2(e.ruleStack),n=this.getGAstProductions(),s=n[t],o=new NextAfterTokenWalker(s,e).startWalking();return o},r}(),RECORDING_NULL_OBJECT={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(RECORDING_NULL_OBJECT);var HANDLE_SEPARATOR=!0,MAX_METHOD_IDX=Math.pow(2,BITS_FOR_OCCURRENCE_IDX)-1,RFT=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([RFT]);var RECORDING_PHASE_TOKEN=createTokenInstance(RFT,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(RECORDING_PHASE_TOKEN);var RECORDING_PHASE_CSTNODE={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},GastRecorder=function(){function r(){}return r.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(s){var o=s>0?s:"";e["CONSUME"+o]=function(a,l){return this.consumeInternalRecord(a,s,l)},e["SUBRULE"+o]=function(a,l){return this.subruleInternalRecord(a,s,l)},e["OPTION"+o]=function(a){return this.optionInternalRecord(a,s)},e["OR"+o]=function(a){return this.orInternalRecord(a,s)},e["MANY"+o]=function(a){this.manyInternalRecord(s,a)},e["MANY_SEP"+o]=function(a){this.manySepFirstInternalRecord(s,a)},e["AT_LEAST_ONE"+o]=function(a){this.atLeastOneInternalRecord(s,a)},e["AT_LEAST_ONE_SEP"+o]=function(a){this.atLeastOneSepFirstInternalRecord(s,a)}},n=0;n<10;n++)t(n);e.consume=function(s,o,a){return this.consumeInternalRecord(o,s,a)},e.subrule=function(s,o,a){return this.subruleInternalRecord(o,s,a)},e.option=function(s,o){return this.optionInternalRecord(o,s)},e.or=function(s,o){return this.orInternalRecord(o,s)},e.many=function(s,o){this.manyInternalRecord(s,o)},e.atLeastOne=function(s,o){this.atLeastOneInternalRecord(s,o)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},r.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},r.prototype.ACTION_RECORD=function(e){},r.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},r.prototype.LA_RECORD=function(e){return END_OF_FILE},r.prototype.topLevelRuleRecord=function(e,t){try{var n=new Rule({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(s){if(s.KNOWN_RECORDER_ERROR!==!0)try{s.message=s.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw s}throw s}},r.prototype.optionInternalRecord=function(e,t){return recordProd.call(this,Option$1,e,t)},r.prototype.atLeastOneInternalRecord=function(e,t){recordProd.call(this,RepetitionMandatory,t,e)},r.prototype.atLeastOneSepFirstInternalRecord=function(e,t){recordProd.call(this,RepetitionMandatoryWithSeparator,t,e,HANDLE_SEPARATOR)},r.prototype.manyInternalRecord=function(e,t){recordProd.call(this,Repetition,t,e)},r.prototype.manySepFirstInternalRecord=function(e,t){recordProd.call(this,RepetitionWithSeparator,t,e,HANDLE_SEPARATOR)},r.prototype.orInternalRecord=function(e,t){return recordOrProd.call(this,e,t)},r.prototype.subruleInternalRecord=function(e,t,n){if(assertMethodIdxIsValid(t),!e||has(e,"ruleName")===!1){var s=new Error("<SUBRULE"+getIdxSuffix(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var o=peek(this.recordingProdStack),a=e.ruleName,l=new NonTerminal({idx:t,nonTerminalName:a,referencedRule:void 0});return o.definition.push(l),this.outputCst?RECORDING_PHASE_CSTNODE:RECORDING_NULL_OBJECT},r.prototype.consumeInternalRecord=function(e,t,n){if(assertMethodIdxIsValid(t),!hasShortKeyProperty(e)){var s=new Error("<CONSUME"+getIdxSuffix(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var o=peek(this.recordingProdStack),a=new Terminal({idx:t,terminalType:e});return o.definition.push(a),RECORDING_PHASE_TOKEN},r}();function recordProd(r,e,t,n){n===void 0&&(n=!1),assertMethodIdxIsValid(t);var s=peek(this.recordingProdStack),o=isFunction$1(e)?e:e.DEF,a=new r({definition:[],idx:t});return has(e,"NAME")&&(a.name=e.NAME),n&&(a.separator=e.SEP),has(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),o.call(this),s.definition.push(a),this.recordingProdStack.pop(),RECORDING_NULL_OBJECT}function recordOrProd(r,e){var t=this;assertMethodIdxIsValid(e);var n=peek(this.recordingProdStack),s=isArray(r)===!1,o=s===!1?r:r.DEF,a=new Alternation({definition:[],idx:e,ignoreAmbiguities:s&&r.IGNORE_AMBIGUITIES===!0});has(r,"NAME")&&(a.name=r.NAME),has(r,"MAX_LOOKAHEAD")&&(a.maxLookahead=r.MAX_LOOKAHEAD);var l=some(o,function(u){return isFunction$1(u.GATE)});return a.hasPredicates=l,n.definition.push(a),forEach$1(o,function(u){var c=new Flat({definition:[]});a.definition.push(c),has(u,"NAME")&&(c.name=u.NAME),has(u,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=u.IGNORE_AMBIGUITIES:has(u,"GATE")&&(c.ignoreAmbiguities=!0),t.recordingProdStack.push(c),u.ALT.call(t),t.recordingProdStack.pop()}),RECORDING_NULL_OBJECT}function getIdxSuffix(r){return r===0?"":""+r}function assertMethodIdxIsValid(r){if(r<0||r>MAX_METHOD_IDX){var e=new Error("Invalid DSL Method idx value: <"+r+`>
	`+("Idx value must be a none negative value smaller than "+(MAX_METHOD_IDX+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var PerformanceTracer=function(){function r(){}return r.prototype.initPerformanceTracer=function(e){if(has(e,"traceInitPerf")){var t=e.traceInitPerf,n=typeof t=="number";this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=timer(t),o=s.time,a=s.value,l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return t()},r}(),__extends=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),END_OF_FILE=createTokenInstance(EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(END_OF_FILE);var DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),ParserDefinitionErrorType;(function(r){r[r.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",r[r.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",r[r.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",r[r.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",r[r.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",r[r.LEFT_RECURSION=5]="LEFT_RECURSION",r[r.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",r[r.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",r[r.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",r[r.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",r[r.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",r[r.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",r[r.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",r[r.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",r[r.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(ParserDefinitionErrorType||(ParserDefinitionErrorType={}));function EMPTY_ALT(r){return r===void 0&&(r=void 0),function(){return r}}var Parser=function(){function r(e,t){t===void 0&&(t=DEFAULT_PARSER_CONFIG),this.ignoredIssues=DEFAULT_PARSER_CONFIG.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),has(t,"ignoredIssues")&&t.ignoredIssues!==DEFAULT_PARSER_CONFIG.ignoredIssues&&PRINT_WARNING(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=has(t,"ignoredIssues")?t.ignoredIssues:DEFAULT_PARSER_CONFIG.ignoredIssues,this.skipValidations=has(t,"skipValidations")?t.skipValidations:DEFAULT_PARSER_CONFIG.skipValidations}return r.performSelfAnalysis=function(e){e.performSelfAnalysis()},r.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){toFastProperties(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),forEach$1(e.definedRulesNames,function(o){var a=e[o],l=a.originalGrammarAction,u=void 0;e.TRACE_INIT(o+" Rule",function(){u=e.topLevelRuleRecord(o,l)}),e.gastProductionsCache[o]=u})}finally{e.disableRecording()}});var s=[];if(e.TRACE_INIT("Grammar Resolving",function(){s=resolveGrammar({rules:values(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,s)}),e.TRACE_INIT("Grammar Validations",function(){if(isEmpty(s)&&e.skipValidations===!1){var o=validateGrammar({rules:values(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:values(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:defaultGrammarValidatorErrorProvider,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,o)}}),isEmpty(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var o=computeAllProdsFollows(values(e.gastProductionsCache));e.resyncFollows=o}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(values(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var o=expandAllNestedRuleNames(values(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=o.allRuleNames}),!r.DEFER_DEFINITION_ERRORS_HANDLING&&!isEmpty(e.definitionErrors))throw t=map(e.definitionErrors,function(o){return o.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},r.DEFER_DEFINITION_ERRORS_HANDLING=!1,r}();applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);(function(r){__extends(e,r);function e(t,n){n===void 0&&(n=DEFAULT_PARSER_CONFIG);var s=this,o=cloneObj(n);return o.outputCst=!0,s=r.call(this,t,o)||this,s}return e})(Parser);var EmbeddedActionsParser=function(r){__extends(e,r);function e(t,n){n===void 0&&(n=DEFAULT_PARSER_CONFIG);var s=this,o=cloneObj(n);return o.outputCst=!1,s=r.call(this,t,o)||this,s}return e}(Parser);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const parsingError=(r,e)=>({type:r,message:e});var ParsingErrorType;(function(r){r.LexingError="LexingError",r.ParserError="ParsingError",r.StaticOffsetError="StaticOffsetError",r.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",r.RangeOffsetNotAllowed="RangeOffsetNotAllowed",r.InvalidRangeSize="InvalidRangeSize"})(ParsingErrorType||(ParsingErrorType={}));var AstNodeType;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.MINUS_UNARY_OP="MINUS_UNARY_OP",r.PLUS_UNARY_OP="PLUS_UNARY_OP",r.PERCENT_OP="PERCENT_OP",r.CONCATENATE_OP="CONCATENATE_OP",r.EQUALS_OP="EQUALS_OP",r.NOT_EQUAL_OP="NOT_EQUAL_OP",r.GREATER_THAN_OP="GREATER_THAN_OP",r.LESS_THAN_OP="LESS_THAN_OP",r.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",r.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",r.PLUS_OP="PLUS_OP",r.MINUS_OP="MINUS_OP",r.TIMES_OP="TIMES_OP",r.DIV_OP="DIV_OP",r.POWER_OP="POWER_OP",r.FUNCTION_CALL="FUNCTION_CALL",r.NAMED_EXPRESSION="NAMED_EXPRESSION",r.PARENTHESIS="PARENTHESES",r.CELL_REFERENCE="CELL_REFERENCE",r.CELL_RANGE="CELL_RANGE",r.COLUMN_RANGE="COLUMN_RANGE",r.ROW_RANGE="ROW_RANGE",r.ERROR="ERROR",r.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",r.ARRAY="ARRAY"})(AstNodeType||(AstNodeType={}));var RangeSheetReferenceType;(function(r){r[r.RELATIVE=0]="RELATIVE",r[r.START_ABSOLUTE=1]="START_ABSOLUTE",r[r.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(RangeSheetReferenceType||(RangeSheetReferenceType={}));const buildEmptyArgAst=r=>({type:AstNodeType.EMPTY,leadingWhitespace:r==null?void 0:r.image}),buildNumberAst=(r,e)=>({type:AstNodeType.NUMBER,value:r,leadingWhitespace:e==null?void 0:e.image}),buildStringAst=r=>{var e;return{type:AstNodeType.STRING,value:r.image.slice(1,-1),leadingWhitespace:(e=r.leadingWhitespace)===null||e===void 0?void 0:e.image}},buildCellReferenceAst=(r,e)=>({type:AstNodeType.CELL_REFERENCE,reference:r,leadingWhitespace:e==null?void 0:e.image}),buildCellRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.CELL_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n}),buildColumnRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.COLUMN_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),buildRowRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.ROW_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),buildConcatenateOpAst=(r,e,t)=>({type:AstNodeType.CONCATENATE_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildEqualsOpAst=(r,e,t)=>({type:AstNodeType.EQUALS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildNotEqualOpAst=(r,e,t)=>({type:AstNodeType.NOT_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildGreaterThanOpAst=(r,e,t)=>({type:AstNodeType.GREATER_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildLessThanOpAst=(r,e,t)=>({type:AstNodeType.LESS_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildGreaterThanOrEqualOpAst=(r,e,t)=>({type:AstNodeType.GREATER_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildLessThanOrEqualOpAst=(r,e,t)=>({type:AstNodeType.LESS_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildPlusOpAst=(r,e,t)=>({type:AstNodeType.PLUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildMinusOpAst=(r,e,t)=>({type:AstNodeType.MINUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildTimesOpAst=(r,e,t)=>({type:AstNodeType.TIMES_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildDivOpAst=(r,e,t)=>({type:AstNodeType.DIV_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildPowerOpAst=(r,e,t)=>({type:AstNodeType.POWER_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildMinusUnaryOpAst=(r,e)=>({type:AstNodeType.MINUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildPlusUnaryOpAst=(r,e)=>({type:AstNodeType.PLUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildPercentOpAst=(r,e)=>({type:AstNodeType.PERCENT_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildProcedureAst=(r,e,t,n,s)=>({type:AstNodeType.FUNCTION_CALL,procedureName:r,args:e,leadingWhitespace:t==null?void 0:t.image,internalWhitespace:n==null?void 0:n.image,hyperlink:s}),buildArrayAst=(r,e,t)=>({type:AstNodeType.ARRAY,args:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),buildNamedExpressionAst=(r,e)=>({type:AstNodeType.NAMED_EXPRESSION,expressionName:r,leadingWhitespace:e==null?void 0:e.image}),buildParenthesisAst=(r,e,t)=>({type:AstNodeType.PARENTHESIS,expression:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),buildCellErrorAst=(r,e)=>({type:AstNodeType.ERROR,error:r,leadingWhitespace:e==null?void 0:e.image}),buildErrorWithRawInputAst=(r,e,t)=>({type:AstNodeType.ERROR_WITH_RAW_INPUT,error:e,rawInput:r,leadingWhitespace:t==null?void 0:t.image}),buildParsingErrorAst=()=>({type:AstNodeType.ERROR,error:CellError.parsingError()});function assertRangeConsistency(r,e,t){if(r.sheet!==void 0&&e.sheet===void 0||r.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(r.sheet===void 0&&t!==RangeSheetReferenceType.RELATIVE||r.sheet!==void 0&&t===RangeSheetReferenceType.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function imageWithWhitespace(r,e){return(e??"")+r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const binaryOpTokenMap={[AstNodeType.PLUS_OP]:"+",[AstNodeType.MINUS_OP]:"-",[AstNodeType.TIMES_OP]:"*",[AstNodeType.DIV_OP]:"/",[AstNodeType.CONCATENATE_OP]:"&",[AstNodeType.POWER_OP]:"^",[AstNodeType.EQUALS_OP]:"=",[AstNodeType.NOT_EQUAL_OP]:"<>",[AstNodeType.GREATER_THAN_OP]:">",[AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[AstNodeType.LESS_THAN_OP]:"<",[AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const buildCacheEntry=(r,e,t,n)=>({ast:r,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:n});class Cache{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=collectDependencies(t,this.functionRegistry),s=buildCacheEntry(t,n,doesContainFunctions(t,this.functionRegistry.isFunctionVolatile),doesContainFunctions(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,s),s}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,t),t)}}const doesContainFunctions=(r,e)=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.CELL_REFERENCE:case AstNodeType.CELL_RANGE:case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.NAMED_EXPRESSION:return!1;case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:return doesContainFunctions(r.value,e);case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:return doesContainFunctions(r.left,e)||doesContainFunctions(r.right,e);case AstNodeType.PARENTHESIS:return doesContainFunctions(r.expression,e);case AstNodeType.FUNCTION_CALL:return e(r.procedureName)?!0:r.args.some(t=>doesContainFunctions(t,e));case AstNodeType.ARRAY:return r.args.some(t=>t.some(n=>doesContainFunctions(n,e)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ErrorMessage{}ErrorMessage.DistinctSigns="Distinct signs.";ErrorMessage.WrongArgNumber="Wrong number of arguments.";ErrorMessage.EmptyArg="Empty function argument.";ErrorMessage.EmptyArray="Empty array not allowed.";ErrorMessage.ArrayDimensions="Array dimensions are not compatible.";ErrorMessage.NoSpaceForArrayResult="No space for array result.";ErrorMessage.ValueSmall="Value too small.";ErrorMessage.ValueLarge="Value too large.";ErrorMessage.BadCriterion="Incorrect criterion.";ErrorMessage.RangeManySheets="Range spans more than one sheet.";ErrorMessage.CellRangeExpected="Cell range expected.";ErrorMessage.WrongDimension="Wrong range dimension.";ErrorMessage.ScalarExpected="Cell range not allowed.";ErrorMessage.NumberCoercion="Value cannot be coerced to number.";ErrorMessage.NumberExpected="Number argument expected.";ErrorMessage.IntegerExpected="Value needs to be an integer.";ErrorMessage.BadMode="Mode not recognized.";ErrorMessage.DateBounds="Date outside of bounds.";ErrorMessage.OutOfSheet="Resulting reference is out of the sheet.";ErrorMessage.WrongType="Wrong type of argument.";ErrorMessage.NaN="NaN or infinite value encountered.";ErrorMessage.EqualLength="Ranges need to be of equal length.";ErrorMessage.Negative="Value cannot be negative.";ErrorMessage.NotBinary="String does not represent a binary number.";ErrorMessage.NotOctal="String does not represent an octal number.";ErrorMessage.NotHex="String does not represent a hexadecimal number.";ErrorMessage.EndStartPeriod="End period needs to be at least start period.";ErrorMessage.CellRefExpected="Cell reference expected.";ErrorMessage.EmptyRange="Empty range not allowed.";ErrorMessage.BadRef="Address is not correct.";ErrorMessage.NumberRange="Number-only range expected.";ErrorMessage.ValueNotFound="Value not found.";ErrorMessage.ValueBaseLarge="Value in base too large.";ErrorMessage.ValueBaseSmall="Value in base too small.";ErrorMessage.ValueBaseLong="Value in base too long.";ErrorMessage.NegativeLength="Length cannot be negative.";ErrorMessage.PatternNotFound="Pattern not found.";ErrorMessage.OneValue="Needs at least one value.";ErrorMessage.TwoValues="Range needs to contain at least two elements.";ErrorMessage.ThreeValues="Range needs to contain at least three elements.";ErrorMessage.IndexBounds="Index out of bounds.";ErrorMessage.IndexLarge="Index too large.";ErrorMessage.Formula="Expected formula.";ErrorMessage.NegativeCount="Count cannot be negative.";ErrorMessage.ParseError="Parsing error.";ErrorMessage.SheetRef="Sheet does not exist.";ErrorMessage.PeriodLong="Period number cannot exceed life length.";ErrorMessage.InvalidDate="Invalid date.";ErrorMessage.BitshiftLong="Result of bitshift is too long.";ErrorMessage.EmptyString="Empty-string argument not allowed.";ErrorMessage.LengthBounds="Length out of bounds.";ErrorMessage.NegativeTime="Time cannot be negative.";ErrorMessage.NoDefault="No default option.";ErrorMessage.NoConditionMet="None of the conditions were met.";ErrorMessage.Selector="Selector cannot exceed the number of arguments.";ErrorMessage.StartEndDate="Start date needs to be earlier than end date.";ErrorMessage.IncorrectDateTime="String does not represent correct DateTime.";ErrorMessage.CharacterCodeBounds="Character code out of bounds.";ErrorMessage.NonZero="Argument cannot be 0.";ErrorMessage.LessThanOne="Argument cannot be less than 1.";ErrorMessage.WeekendString="Incorrect weekend bitmask string.";ErrorMessage.InvalidRoman="Invalid roman numeral.";ErrorMessage.WrongOrder="Wrong order of values.";ErrorMessage.ComplexNumberExpected="Complex number expected.";ErrorMessage.ShouldBeIorJ="Should be 'i' or 'j'.";ErrorMessage.SizeMismatch="Array dimensions mismatched.";ErrorMessage.FunctionName=r=>`Function name ${r} not recognized.`;ErrorMessage.NamedExpressionName=r=>`Named expression ${r} not recognized.`;ErrorMessage.LicenseKey=r=>`License key is ${r}.`;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CellReferenceMatcher{constructor(){this.POSSIBLE_START_CHARACTERS=[...ALL_UNICODE_LETTERS_ARRAY,...ALL_DIGITS_ARRAY,ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=new RegExp(CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NamedExpressionMatcher{constructor(){this.POSSIBLE_START_CHARACTERS=[...ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=new RegExp(NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const AdditionOp=createToken({name:"AdditionOp",pattern:Lexer.NA}),PlusOp=createToken({name:"PlusOp",pattern:/\+/,categories:AdditionOp}),MinusOp=createToken({name:"MinusOp",pattern:/-/,categories:AdditionOp}),MultiplicationOp=createToken({name:"MultiplicationOp",pattern:Lexer.NA}),TimesOp=createToken({name:"TimesOp",pattern:/\*/,categories:MultiplicationOp}),DivOp=createToken({name:"DivOp",pattern:/\//,categories:MultiplicationOp}),PowerOp=createToken({name:"PowerOp",pattern:/\^/}),PercentOp=createToken({name:"PercentOp",pattern:/%/}),BooleanOp=createToken({name:"BooleanOp",pattern:Lexer.NA}),EqualsOp=createToken({name:"EqualsOp",pattern:/=/,categories:BooleanOp}),NotEqualOp=createToken({name:"NotEqualOp",pattern:/<>/,categories:BooleanOp}),GreaterThanOp=createToken({name:"GreaterThanOp",pattern:/>/,categories:BooleanOp}),LessThanOp=createToken({name:"LessThanOp",pattern:/</,categories:BooleanOp}),GreaterThanOrEqualOp=createToken({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:BooleanOp}),LessThanOrEqualOp=createToken({name:"LessThanOrEqualOp",pattern:/<=/,categories:BooleanOp}),ConcatenateOp=createToken({name:"ConcatenateOp",pattern:/&/}),LParen=createToken({name:"LParen",pattern:/\(/}),RParen=createToken({name:"RParen",pattern:/\)/}),ArrayLParen=createToken({name:"ArrayLParen",pattern:/{/}),ArrayRParen=createToken({name:"ArrayRParen",pattern:/}/}),StringLiteral=createToken({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),ErrorLiteral=createToken({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),RangeSeparator=createToken({name:"RangeSeparator",pattern:new RegExp(RANGE_OPERATOR)}),ColumnRange=createToken({name:"ColumnRange",pattern:new RegExp(`${COLUMN_REFERENCE_PATTERN}${RANGE_OPERATOR}${COLUMN_REFERENCE_PATTERN}`)}),RowRange=createToken({name:"RowRange",pattern:new RegExp(`${ROW_REFERENCE_PATTERN}${RANGE_OPERATOR}${ROW_REFERENCE_PATTERN}`)}),ProcedureName=createToken({name:"ProcedureName",pattern:new RegExp(`([${UNICODE_LETTER_PATTERN}][${NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)}),cellReferenceMatcher=new CellReferenceMatcher,CellReference=createToken({name:"CellReference",pattern:cellReferenceMatcher.match.bind(cellReferenceMatcher),start_chars_hint:cellReferenceMatcher.POSSIBLE_START_CHARACTERS,line_breaks:!1}),namedExpressionMatcher=new NamedExpressionMatcher,NamedExpression=createToken({name:"NamedExpression",pattern:namedExpressionMatcher.match.bind(namedExpressionMatcher),start_chars_hint:namedExpressionMatcher.POSSIBLE_START_CHARACTERS,line_breaks:!1}),buildLexerConfig=r=>{const e=r.translationPackage.getFunctionTranslation("OFFSET"),t=r.errorMapping,n=r.translationPackage.buildFunctionMapping(),s=new RegExp(r.ignoreWhiteSpace==="standard"?ODFF_WHITESPACE_PATTERN:ALL_WHITESPACE_PATTERN),o=createToken({name:"WhiteSpace",pattern:s}),a=createToken({name:"ArrayRowSep",pattern:r.arrayRowSeparator}),l=createToken({name:"ArrayColSep",pattern:r.arrayColumnSeparator}),u=createToken({name:"NumberLiteral",pattern:new RegExp(`(([${r.decimalSeparator}]\\d+)|(\\d+([${r.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),c=createToken({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let d,f;r.functionArgSeparator===r.arrayColumnSeparator?(d=l,f=[]):r.functionArgSeparator===r.arrayRowSeparator?(d=a,f=[]):(d=createToken({name:"ArgSeparator",pattern:r.functionArgSeparator}),f=[d]);const C=[o,PlusOp,MinusOp,TimesOp,DivOp,PowerOp,EqualsOp,NotEqualOp,PercentOp,GreaterThanOrEqualOp,LessThanOrEqualOp,GreaterThanOp,LessThanOp,LParen,RParen,ArrayLParen,ArrayRParen,c,ProcedureName,RangeSeparator,...f,ColumnRange,RowRange,u,StringLiteral,ErrorLiteral,ConcatenateOp,BooleanOp,AdditionOp,MultiplicationOp,CellReference,NamedExpression,a,l];return{ArgSeparator:d,NumberLiteral:u,OffsetProcedureName:c,ArrayRowSeparator:a,ArrayColSeparator:l,WhiteSpace:o,allTokens:C,errorMapping:t,functionMapping:n,decimalSeparator:r.decimalSeparator,maxColumns:r.maxColumns,maxRows:r.maxRows}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaParser extends EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:EMPTY_ALT(buildEmptyArgAst())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const s=this.CONSUME(ProcedureName),o=s.image.toUpperCase().slice(0,-1),a=(n=this.lexerConfig.functionMapping[o])!==null&&n!==void 0?n:o,l=[];let u=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var d;const f=this.CONSUME(this.lexerConfig.ArgSeparator);u.type===AstNodeType.EMPTY&&(u.leadingWhitespace=(d=f.leadingWhitespace)===null||d===void 0?void 0:d.image),l.push(u),u=this.SUBRULE2(this.booleanExpressionOrEmpty)}),l.push(u),l.length===1&&l[0].type===AstNodeType.EMPTY&&(l.length=0);const c=this.CONSUME(RParen);return buildProcedureAst(a,l,s.leadingWhitespace,c.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(NamedExpression);return buildNamedExpressionAst(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(RParen),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(ColumnRange),[s,o]=n.image.split(":"),a=this.ACTION(()=>columnAddressFromString(this.sheetMapping,s,this.formulaAddress)),l=this.ACTION(()=>columnAddressFromString(this.sheetMapping,o,this.formulaAddress));if(a===void 0||l===void 0)return buildCellErrorAst(new CellError(ErrorType.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||l.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace);if(a.sheet===void 0&&l.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:c,sheetRefType:d}=FormulaParser.fixSheetIdsForRangeEnds(a,l);return buildColumnRangeAst(u,c,d,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(RowRange),[s,o]=n.image.split(":"),a=this.ACTION(()=>rowAddressFromString(this.sheetMapping,s,this.formulaAddress)),l=this.ACTION(()=>rowAddressFromString(this.sheetMapping,o,this.formulaAddress));if(a===void 0||l===void 0)return buildCellErrorAst(new CellError(ErrorType.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||l.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace);if(a.sheet===void 0&&l.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:c,sheetRefType:d}=FormulaParser.fixSheetIdsForRangeEnds(a,l);return buildRowRangeAst(u,c,d,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(CellReference),s=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress));return s===void 0?buildErrorWithRawInputAst(n.image,new CellError(ErrorType.REF),n.leadingWhitespace):s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace):buildCellReferenceAst(s,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var s;const o=this.CONSUME(CellReference),a=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress)),l=this.ACTION(()=>cellAddressFromString(this.sheetMapping,o.image,this.formulaAddress));return a===void 0||l===void 0?this.ACTION(()=>buildErrorWithRawInputAst(`${n.image}:${o.image}`,new CellError(ErrorType.REF),n.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||l.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>buildErrorWithRawInputAst(`${n.image}:${o.image}`,new CellError(ErrorType.NAME),n.leadingWhitespace)):this.buildCellRange(a,l,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var s;const o=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress));return a===void 0?buildCellErrorAst(new CellError(ErrorType.REF)):o.type===AstNodeType.CELL_REFERENCE?this.buildCellRange(a,o.reference,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image):this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(CellReference);return this.CONSUME2(RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const s=this.CONSUME(CellReference),o=this.ACTION(()=>cellAddressFromString(this.sheetMapping,s.image,this.formulaAddress));return o===void 0?this.ACTION(()=>buildCellErrorAst(new CellError(ErrorType.REF))):this.buildCellRange(n.reference,o,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const s=this.SUBRULE(this.offsetProcedureExpression);return s.type===AstNodeType.CELL_REFERENCE?this.buildCellRange(n.reference,s.reference,n.leadingWhitespace):this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let s;return this.OPTION(()=>{this.CONSUME(RangeSeparator),n.type===AstNodeType.CELL_RANGE?s=this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):s=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),s!==void 0?s:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),buildArrayAst(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(LParen),s=this.SUBRULE(this.booleanExpression),o=this.CONSUME(RParen);return buildParenthesisAst(s,n.leadingWhitespace,o.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(ArrayLParen),s=this.SUBRULE(this.insideArrayExpression),o=this.CONSUME(ArrayRParen);return buildArrayAst(s.args,n.leadingWhitespace,o.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const s=n.replace(this.lexerConfig.decimalSeparator,".");return Number(s)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const s=this.CONSUME(this.lexerConfig.NumberLiteral);return buildNumberAst(this.numericStringToNumber(s.image),s.leadingWhitespace)}},{ALT:()=>{const s=this.CONSUME(StringLiteral);return buildStringAst(s)}},{ALT:()=>{const s=this.CONSUME(ErrorLiteral),o=s.image.toUpperCase(),a=this.lexerConfig.errorMapping[o];return a?buildCellErrorAst(new CellError(a),s.leadingWhitespace):this.parsingError(ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),s=this.OPTION(()=>this.CONSUME(PercentOp));return s?buildPercentOpAst(n,s.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(AdditionOp),s=this.SUBRULE(this.atomicExpression);return tokenMatcher(n,PlusOp)?buildPlusUnaryOpAst(s,n.leadingWhitespace):tokenMatcher(n,MinusOp)?buildMinusUnaryOpAst(s,n.leadingWhitespace):(this.customParsingError=parsingError(ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const s=this.CONSUME(PowerOp),o=this.SUBRULE2(this.atomicExpression);tokenMatcher(s,PowerOp)?n=buildPowerOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const s=this.CONSUME(MultiplicationOp),o=this.SUBRULE2(this.powerExpression);tokenMatcher(s,TimesOp)?n=buildTimesOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,DivOp)?n=buildDivOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const s=this.CONSUME(AdditionOp),o=this.SUBRULE2(this.multiplicationExpression);tokenMatcher(s,PlusOp)?n=buildPlusOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,MinusOp)?n=buildMinusOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const s=this.CONSUME(ConcatenateOp),o=this.SUBRULE2(this.additionExpression);n=buildConcatenateOpAst(n,o,s.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const s=this.CONSUME(BooleanOp),o=this.SUBRULE2(this.concatenateExpression);tokenMatcher(s,EqualsOp)?n=buildEqualsOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,NotEqualOp)?n=buildNotEqualOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,GreaterThanOp)?n=buildGreaterThanOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,LessThanOp)?n=buildLessThanOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,GreaterThanOrEqualOp)?n=buildGreaterThanOrEqualOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,LessThanOrEqualOp)?n=buildLessThanOrEqualOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=simpleCellAddress(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),s=[];return this.customParsingError&&s.push(this.customParsingError),s=s.concat(this.errors.map(o=>({type:ParsingErrorType.ParserError,message:o.message}))),s.length>0&&(n=buildParsingErrorAst()),{ast:n,errors:s}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:s,secondEnd:o,sheetRefType:a}=FormulaParser.fixSheetIdsForRangeEnds(e,t);return buildCellRangeAst(s,o,a,n)}static fixSheetIdsForRangeEnds(e,t){const n=FormulaParser.rangeSheetReferenceType(e.sheet,t.sheet),s=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:s,sheetRefType:n}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==AstNodeType.CELL_REFERENCE)return this.parsingError(ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let s;if(n.type===AstNodeType.NUMBER&&Number.isInteger(n.value))s=n.value;else if(n.type===AstNodeType.PLUS_UNARY_OP&&n.value.type===AstNodeType.NUMBER&&Number.isInteger(n.value.value))s=n.value.value;else if(n.type===AstNodeType.MINUS_UNARY_OP&&n.value.type===AstNodeType.NUMBER&&Number.isInteger(n.value.value))s=-n.value.value;else return this.parsingError(ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===AstNodeType.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===AstNodeType.PLUS_UNARY_OP&&o.value.type===AstNodeType.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===AstNodeType.MINUS_UNARY_OP&&o.value.type===AstNodeType.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");const l=e[3];let u;if(l===void 0)u=1;else if(l.type===AstNodeType.NUMBER){if(u=l.value,u<1)return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const c=e[4];let d;if(c===void 0)d=1;else if(c.type===AstNodeType.NUMBER){if(d=c.value,d<1)return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(d))return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const f=new CellAddress(t.reference.col+a,t.reference.row+s,t.reference.type);let C=f.col,m=f.row;if((t.reference.type===CellReferenceType.CELL_REFERENCE_RELATIVE||t.reference.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL)&&(m=m+this.formulaAddress.row),(t.reference.type===CellReferenceType.CELL_REFERENCE_RELATIVE||t.reference.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW)&&(C=C+this.formulaAddress.col),C<0||m<0)return buildCellErrorAst(new CellError(ErrorType.REF,ErrorMessage.OutOfSheet));if(d===1&&u===1)return buildCellReferenceAst(f);{const E=new CellAddress(f.col+d-1,f.row+u-1,f.type);return buildCellRangeAst(f,E,RangeSheetReferenceType.RELATIVE)}}parsingError(e,t){return this.customParsingError=parsingError(e,t),buildParsingErrorAst()}static rangeSheetReferenceType(e,t){return e===void 0?RangeSheetReferenceType.RELATIVE:t===void 0?RangeSheetReferenceType.START_ABSOLUTE:RangeSheetReferenceType.BOTH_ABSOLUTE}}class FormulaLexer{constructor(e){this.lexerConfig=e,this.lexer=new Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return FormulaLexer.filterTokensByNeighbors(e,(t,n,s)=>(tokenMatcher(t,CellReference)||tokenMatcher(t,RangeSeparator))&&tokenMatcher(n,this.lexerConfig.WhiteSpace)&&(tokenMatcher(s,CellReference)||tokenMatcher(s,RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return FormulaLexer.filterTokensByNeighbors(e,(t,n,s)=>!tokenMatcher(t,this.lexerConfig.ArgSeparator)&&tokenMatcher(n,this.lexerConfig.WhiteSpace)&&tokenMatcher(s,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const s=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||s.push(e[n]),++n;return s.push(e[n]),s}trimTrailingWhitespaces(e){return e.length>0&&tokenMatcher(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Unparser{constructor(e,t,n,s){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=s}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,s;switch(e.type){case AstNodeType.EMPTY:return imageWithWhitespace("",e.leadingWhitespace);case AstNodeType.NUMBER:return imageWithWhitespace(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case AstNodeType.STRING:return imageWithWhitespace('"'+e.value+'"',e.leadingWhitespace);case AstNodeType.FUNCTION_CALL:{const o=e.args.map(u=>u!==void 0?this.unparseAst(u,t):"").join(this.config.functionArgSeparator),l=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+o+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(l,e.leadingWhitespace)}case AstNodeType.NAMED_EXPRESSION:{const o=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||n===void 0?void 0:n.displayName;return imageWithWhitespace(o||e.expressionName,e.leadingWhitespace)}case AstNodeType.CELL_REFERENCE:{let o;return e.reference.sheet!==void 0?o=this.unparseSheetName(e.reference.sheet)+"!":o="",o+=(s=e.reference.unparse(t))!==null&&s!==void 0?s:this.config.translationPackage.getErrorTranslation(ErrorType.REF),imageWithWhitespace(o,e.leadingWhitespace)}case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:return imageWithWhitespace(this.formatRange(e,t),e.leadingWhitespace);case AstNodeType.PLUS_UNARY_OP:{const o=this.unparseAst(e.value,t);return imageWithWhitespace("+",e.leadingWhitespace)+o}case AstNodeType.MINUS_UNARY_OP:{const o=this.unparseAst(e.value,t);return imageWithWhitespace("-",e.leadingWhitespace)+o}case AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+imageWithWhitespace("%",e.leadingWhitespace);case AstNodeType.ERROR:{const o=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:ErrorType.ERROR);return imageWithWhitespace(o,e.leadingWhitespace)}case AstNodeType.ERROR_WITH_RAW_INPUT:return imageWithWhitespace(e.rawInput,e.leadingWhitespace);case AstNodeType.PARENTHESIS:{const a="("+this.unparseAst(e.expression,t)+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(a,e.leadingWhitespace)}case AstNodeType.ARRAY:{const o="{"+e.args.map(a=>a.map(l=>this.unparseAst(l,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+imageWithWhitespace("}",e.internalWhitespace);return imageWithWhitespace(o,e.leadingWhitespace)}default:{const o=this.unparseAst(e.left,t),a=this.unparseAst(e.right,t);return o+imageWithWhitespace(binaryOpTokenMap[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const t=sheetIndexToString(e,this.sheetMappingFn);if(t===void 0)throw new NoSheetWithIdError(e);return t}formatRange(e,t){let n="",s="";e.start.sheet!==void 0&&e.sheetReferenceType!==RangeSheetReferenceType.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===RangeSheetReferenceType.BOTH_ABSOLUTE&&(s=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(t),a=e.end.unparse(t);return o===void 0||a===void 0?this.config.translationPackage.getErrorTranslation(ErrorType.REF):`${n}${o}:${s}${a}`}}function formatNumber(r,e){return r.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ParserWithCaching{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=buildLexerConfig(e),this.lexer=new FormulaLexer(this.lexerConfig),this.formulaParser=new FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const f=n.errors.map(C=>({type:ParsingErrorType.LexingError,message:C.message}));return{ast:buildParsingErrorAst(),errors:f,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const s=this.computeHashFromTokens(n.tokens,t);let o=this.cache.get(s);if(o!==void 0)++this.statsCacheUsed;else{const f=this.bindWhitespacesToTokens(n.tokens),C=this.formulaParser.parseFromTokens(f,t);if(C.errors.length>0)return Object.assign(Object.assign({},C),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(s,C.ast)}const{ast:a,hasVolatileFunction:l,hasStructuralChangeFunction:u}=o,c=this.convertReversedRangesToRegularRanges(a),d=collectDependencies(c,this.functionRegistry);return{ast:c,errors:[],hasVolatileFunction:l,hasStructuralChangeFunction:u,dependencies:d}}convertReversedRangesToRegularRanges(e){switch(e.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.CELL_REFERENCE:case AstNodeType.NAMED_EXPRESSION:return e;case AstNodeType.CELL_RANGE:{const{start:t,end:n}=e,s=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.COLUMN_RANGE:{const{start:t,end:n}=e,s=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.ROW_RANGE:{const{start:t,end:n}=e,s=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case AstNodeType.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case AstNodeType.FUNCTION_CALL:{const t=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:t})}case AstNodeType.ARRAY:{const t=e.args.map(n=>n.map(s=>this.convertReversedRangesToRegularRanges(s)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[s,o]=n.map(d=>d.toColumnAddress()).sort(ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(d=>d.toRowAddress()).sort(RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[u,c]=n.map(d=>d.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:CellAddress.fromColAndRow(s,a,u),end:CellAddress.fromColAndRow(o,l,c)}}orderColumnRangeEnds(e,t){const n=[e,t],[s,o]=n.sort(ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(u=>u.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:new ColumnAddress(s.type,s.col,a),end:new ColumnAddress(o.type,o.col,l)}}orderRowRangeEnds(e,t){const n=[e,t],[s,o]=n.sort(RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(u=>u.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:new RowAddress(s.type,s.row,a),end:new RowAddress(o.type,o.row,l)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,relativeDependencies:a}=t;return{ast:n,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}}}computeHashFromTokens(e,t){var n;let s="",o=0;for(;o<e.length;){const a=e[o];if(tokenMatcher(a,CellReference)){const l=cellAddressFromString(this.sheetMapping,a.image,t);l===void 0?s=s.concat(a.image):s=s.concat(l.hash(!0))}else if(tokenMatcher(a,ProcedureName)){const l=a.image.toUpperCase().slice(0,-1),u=(n=this.lexerConfig.functionMapping[l])!==null&&n!==void 0?n:l;s=s.concat(u,"(")}else if(tokenMatcher(a,ColumnRange)){const[l,u]=a.image.split(":"),c=columnAddressFromString(this.sheetMapping,l,t),d=columnAddressFromString(this.sheetMapping,u,t);c===void 0||d===void 0?s=s.concat("!REF"):s=s.concat(c.hash(!0),":",d.hash(!0))}else if(tokenMatcher(a,RowRange)){const[l,u]=a.image.split(":"),c=rowAddressFromString(this.sheetMapping,l,t),d=rowAddressFromString(this.sheetMapping,u,t);c===void 0||d===void 0?s=s.concat("!REF"):s=s.concat(c.hash(!0),":",d.hash(!0))}else s=s.concat(a.image);o++}return s}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case AstNodeType.EMPTY:return e.leadingWhitespace||"";case AstNodeType.NUMBER:return imageWithWhitespace(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case AstNodeType.STRING:return imageWithWhitespace('"'+e.value+'"',e.leadingWhitespace);case AstNodeType.NAMED_EXPRESSION:return imageWithWhitespace(e.expressionName,e.leadingWhitespace);case AstNodeType.FUNCTION_CALL:{const t=e.args.map(s=>this.computeHashOfAstNode(s)).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(n,e.leadingWhitespace)}case AstNodeType.CELL_REFERENCE:return imageWithWhitespace(e.reference.hash(!0),e.leadingWhitespace);case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==RangeSheetReferenceType.RELATIVE),n=e.end.hash(e.sheetReferenceType===RangeSheetReferenceType.BOTH_ABSOLUTE);return imageWithWhitespace(t+":"+n,e.leadingWhitespace)}case AstNodeType.MINUS_UNARY_OP:return imageWithWhitespace("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case AstNodeType.PLUS_UNARY_OP:return imageWithWhitespace("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+imageWithWhitespace("%",e.leadingWhitespace);case AstNodeType.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:ErrorType.ERROR);return imageWithWhitespace(t,e.leadingWhitespace)}case AstNodeType.ERROR_WITH_RAW_INPUT:return imageWithWhitespace(e.rawInput,e.leadingWhitespace);case AstNodeType.ARRAY:{const t=e.args.map(n=>n.map(s=>this.computeHashOfAstNode(s)).join(",")).join(";");return imageWithWhitespace("{"+t+imageWithWhitespace("}",e.internalWhitespace),e.leadingWhitespace)}case AstNodeType.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+imageWithWhitespace(binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];tokenMatcher(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let s=1;s<e.length;++s){const o=e[s];if(tokenMatcher(o,this.lexerConfig.WhiteSpace))continue;const a=e[s-1];tokenMatcher(a,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=a),t.push(o)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const collectDependenciesFn=(r,e,t,n)=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:return;case AstNodeType.NAMED_EXPRESSION:{n&&t.push(new NamedExpressionDependency(r.expressionName));return}case AstNodeType.CELL_REFERENCE:{n&&t.push(new AddressDependency(r.reference));return}case AstNodeType.CELL_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new CellRangeDependency(r.start,r.end));return}case AstNodeType.COLUMN_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new ColumnRangeDependency(r.start,r.end));return}case AstNodeType.ROW_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new RowRangeDependency(r.start,r.end));return}case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:{collectDependenciesFn(r.value,e,t,!0);return}case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:collectDependenciesFn(r.left,e,t,!0),collectDependenciesFn(r.right,e,t,!0);return;case AstNodeType.PARENTHESIS:collectDependenciesFn(r.expression,e,t,n);return;case AstNodeType.FUNCTION_CALL:{const s=!e.doesFunctionNeedArgumentToBeComputed(r.procedureName);r.args.forEach(o=>collectDependenciesFn(o,e,t,s));return}}},collectDependencies=(r,e)=>{const t=new Array;return collectDependenciesFn(r,e,t,!0),t};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddressDependency{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class CellRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class ColumnRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new AbsoluteColumnRange(t.sheet,t.col,n.col)}}class RowRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new AbsoluteRowRange(t.sheet,t.row,n.row)}}class NamedExpressionDependency{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const absolutizeDependencies=(r,e)=>r.map(t=>t.absolutize(e)),filterDependenciesOutOfScope=r=>r.filter(e=>e instanceof NamedExpressionDependency?!0:e instanceof AbsoluteCellRange?!(invalidSimpleCellAddress(e.start)||invalidSimpleCellAddress(e.end)):!invalidSimpleCellAddress(e));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const EmptyValue=Symbol("Empty value");function getRawValue(r){return r instanceof RichNumber?r.val:r}class RichNumber{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function cloneNumber(r,e){if(typeof r=="number")return e;{const t=r.fromNumber(e);return t.format=r.format,t}}class DateNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_DATE}}class CurrencyNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_CURRENCY}}class TimeNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_TIME}}class DateTimeNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_DATETIME}}class PercentNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_PERCENT}}function isExtendedNumber(r){return typeof r=="number"||r instanceof RichNumber}var NumberType;(function(r){r.NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"})(NumberType||(NumberType={}));function getTypeOfExtendedNumber(r){return r instanceof RichNumber?r.getDetailedType():NumberType.NUMBER_RAW}function getFormatOfExtendedNumber(r){if(r instanceof RichNumber)return r.format}function getTypeFormatOfExtendedNumber(r){return r instanceof RichNumber?{type:r.getDetailedType(),format:r.format}:{type:NumberType.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SimpleRangeValue{constructor(e,t,n,s){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=s,this.size=e===void 0?new ArraySize(t.effectiveWidth(n),t.effectiveHeight(n)):new ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new SimpleRangeValue(e,t,n,!0)}static onlyNumbers(e){return new SimpleRangeValue(e,void 0,void 0,!0)}static onlyValues(e){return new SimpleRangeValue(e,void 0,void 0,void 0)}static onlyRange(e,t){return new SimpleRangeValue(void 0,e,t,void 0)}static fromScalar(e){return new SimpleRangeValue([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let s=0;s<n.length;++s)yield simpleCellAddress(e.sheet,e.col+s,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],simpleCellAddress(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof SimpleRangeValue?(this._hasOnlyNumbers=!1,new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)):(isExtendedNumber(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ContentChanges{constructor(){this.changes=new Map}static empty(){return new ContentChanges}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach(n=>{const s=e.exportChange(n);Array.isArray(s)?t=t.concat(s):t.push(s)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const n=t.value;if(n instanceof SimpleRangeValue)for(const s of n.effectiveAddressesFromData(e))this.changes.delete(addressKey(s));this.changes.set(addressKey(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowsSpan{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new RowsSpan(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new RowsSpan(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new RowsSpan(this.sheet,t,n)}firstRow(){return new RowsSpan(this.sheet,this.rowStart,this.rowStart)}}class ColumnsSpan{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new ColumnsSpan(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new ColumnsSpan(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new ColumnsSpan(this.sheet,t,n)}firstColumn(){return new ColumnsSpan(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var StatType;(function(r){r.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(StatType||(StatType={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Statistics{constructor(){this.stats=new Map([[StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(StatType.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(StatType.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),s=this.startTimes.get(e);if(s){let o=(t=this.stats.get(e))!==null&&t!==void 0?t:0;o+=n-s,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class EmptyStatistics extends Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NoSheetWithIdError extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class NoSheetWithNameError extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class SheetNameAlreadyTakenError extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class SheetSizeLimitExceededError extends Error{constructor(){super("Sheet size limit exceeded")}}class NotAFormulaError extends Error{constructor(){super("This is not a formula")}}class InvalidAddressError extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class InvalidArgumentsError extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class SheetsNotEqual extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class NamedExpressionNameIsAlreadyTakenError extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class NamedExpressionNameIsInvalidError extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class NamedExpressionDoesNotExistError extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class NoOperationToUndoError extends Error{constructor(){super("There is no operation to undo")}}class NoOperationToRedoError extends Error{constructor(){super("There is no operation to redo")}}class NothingToPasteError extends Error{constructor(){super("There is nothing to paste")}}function replacer(r,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class UnableToParseError extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,replacer,4)}`)}}class ExpectedValueOfTypeError extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class ConfigValueEmpty extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class ConfigValueTooSmallError extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class ConfigValueTooBigError extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class ExpectedOneOfValuesError extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class EvaluationSuspendedError extends Error{constructor(){super("Computations are suspended")}}class MissingTranslationError extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class ProtectedFunctionTranslationError extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class LanguageNotRegisteredError extends Error{constructor(){super("Language not registered.")}}class LanguageAlreadyRegisteredError extends Error{constructor(){super("Language already registered.")}}class FunctionPluginValidationError extends Error{static functionNotDeclaredInPlugin(e,t){return new FunctionPluginValidationError(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new FunctionPluginValidationError(`Function method ${e} not found in plugin ${t}`)}}class ProtectedFunctionError extends Error{static cannotRegisterFunctionWithId(e){return new ProtectedFunctionError(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new ProtectedFunctionError(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new ProtectedFunctionError("Cannot unregister protected plugin")}}class SourceLocationHasArrayError extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class TargetLocationHasArrayError extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class NoRelativeAddressesAllowedError extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class AliasAlreadyExisting extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddressMapping{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:n,width:s,fill:o}=t,a=this.policy.call(o);this.addSheet(e,new a(s,n))}getCellValue(e){const t=this.getCell(e);return t===void 0?EmptyValue:t instanceof ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof ValueCellVertex?t.getValues().rawValue:t instanceof ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");const s=n.getCell(e);if(s===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,s),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new NoSheetWithIdError(e);return t.getWidth()}addRows(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new NoSheetWithIdError(e);s.addRows(t,n)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new NoSheetWithIdError(e);s.addColumns(t,n)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new NoSheetWithIdError(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArrayMapping{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t!=null&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(addressKey(e))}setArray(e,t){this.arrayMapping.set(addressKey(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(addressKey(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,(s,o)=>{const a=o.getRange();return t<=a.start.row?[a.shifted(0,n),o]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,(s,o)=>{const a=o.getRange();return t<=a.start.col?[a.shifted(n,0),o]:void 0})}updateArrayVerticesInSheet(e,t){const n=Array();for(const[s,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const a=t(s,o);a!==void 0&&(this.removeArray(s),n.push(a))}n.forEach(([s,o])=>{this.setArray(s,o)})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NotComputedArray{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class ArrayValue{constructor(e){if(this.size=new ArraySize(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof SimpleRangeValue?new ArrayValue(e.data):new ArrayValue([[e]])}simpleRangeValue(){return SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(EmptyValue));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const s of this.array)s.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let s=0;s<e;++s)n.push(new Array(t).fill(EmptyValue));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class ErroredArray{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaVertex{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,s){return n.isScalar()?new FormulaCellVertex(e,t,s):new ArrayVertex(e,t,n,s)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,s]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=s}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class ArrayVertex extends FormulaVertex{constructor(e,t,n,s=0){super(e,t,s),n.isRef?this.array=new ErroredArray(new CellError(ErrorType.REF,ErrorMessage.NoSpaceForArrayResult),ArraySize.error()):this.array=new NotComputedArray(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof CellError)return this.setErrorValue(e),e;const t=ArrayValue.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch{return new CellError(ErrorType.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof CellError||t===EmptyValue))return getRawValue(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,s=e.row-this.cellAddress.row;this.array instanceof ArrayValue&&this.array.set(n,s,t)}setNoSpace(){return this.array=new ErroredArray(new CellError(ErrorType.SPILL,ErrorMessage.NoSpaceForArrayResult),ArraySize.error()),this.getCellValue()}getRange(){return AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof NotComputedArray)}columnsFromArray(){return ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return equalSimpleCellAddress(this.cellAddress,e)}setErrorValue(e){this.array=new ErroredArray(e,this.array.size)}}class FormulaCellVertex extends FormulaVertex{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RangeVertex{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return(n=this.getCriterionFunctionValues(e).get(t))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const collectAddressesDependentToRange=(r,e,t,n,s)=>{if(e instanceof RangeVertex){const l=e.range.intersectionWith(t);return l!==void 0?Array.from(l.addresses(s)):[]}let o,a;if(e instanceof FormulaVertex)o=e.getFormula(n),a=e.getAddress(n);else return[];return collectDependencies(o,r).filter(l=>l instanceof AddressDependency).map(l=>l.dependency.toSimpleCellAddress(a)).filter(l=>t.addressInRange(l))};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var NodeVisitStatus;(function(r){r[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED"})(NodeVisitStatus||(NodeVisitStatus={}));class TopSort{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const s=e.reverse();return s.forEach(o=>this.runDFS(o)),this.postprocess(s,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=NodeVisitStatus.ON_STACK;const t=[e],n=[];for(;t.length>0;){const s=t[t.length-1];switch(this.nodeStatus[s]){case NodeVisitStatus.ON_STACK:{this.handleOnStack(s,n,t);break}case NodeVisitStatus.PROCESSED:{this.handleProcessed(s,n,t);break}case NodeVisitStatus.POPPED:{t.pop();break}}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(s=>{this.entranceTime[s]===void 0&&(n.push(s),this.parent[s]=e,this.nodeStatus[s]=NodeVisitStatus.ON_STACK)}),this.nodeStatus[e]=NodeVisitStatus.PROCESSED}handleProcessed(e,t,n){let s=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(o=>{this.inSCC[o]||(s=this.parent[o]===e?Math.min(s,this.low[o]):Math.min(s,this.entranceTime[o]))}),this.low[e]=s,s===this.entranceTime[e]){const o=[];do o.push(t[t.length-1]),t.pop();while(o[o.length-1]!==e);o.forEach(a=>{this.inSCC[a]=!0}),this.order.push(...o),o.length>1&&o.forEach(a=>{this.sccNonSingletons[a]=!0})}n.pop(),this.nodeStatus[e]=NodeVisitStatus.POPPED}postprocess(e,t,n){const s=[];e.forEach(l=>{s[l]=!0});const o=[],a=[];return this.order.reverse(),this.order.forEach(l=>{const u=this.getAdjacentNodeIds(l);this.sccNonSingletons[l]||u.includes(l)?(a.push(this.nodesSparseArray[l]),t(this.nodesSparseArray[l]),u.forEach(c=>s[c]=!0)):(o.push(this.nodesSparseArray[l]),s[l]&&n(this.nodesSparseArray[l])&&u.forEach(c=>s[c]=!0))}),{sorted:o,cycled:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ProcessableValue{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Graph{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new ProcessableValue({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);return n===void 0||s===void 0?!1:this.edgesSparseArray[n].includes(s)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(n=>n!==void 0).map(n=>this.nodesSparseArray[n]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(s)||this.edgesSparseArray[n].push(s)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(s=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(s)),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);const o=this.edgesSparseArray[n].indexOf(s);if(o===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][o]}removeEdgeIfExists(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);if(n===void 0||s===void 0)return;const o=this.edgesSparseArray[n].indexOf(s);o!==-1&&delete this.edgesSparseArray[n][o]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,n){const s=new TopSort(this.nodesSparseArray,this.edgesSparseArray),o=e.map(a=>this.getNodeId(a)).filter(a=>a!==void 0);return s.getTopSortedWithSccSubgraphFrom(o,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(n=>n!==void 0&&this.nodesSparseArray[n]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([n,s])=>{this.removeEdgeIfExists(s,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(n=>this.nodesSparseArray[n]).filter(n=>n!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RangeMapping{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,n;return(n=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&n!==void 0?n:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const n=keyFromAddresses(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){const t=e.getStart().sheet,n=this.rangeMapping.get(t);if(n===void 0)return;const s=keyFromAddresses(e.getStart(),e.getEnd());n.delete(s),n.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const n=this.rangeMapping.get(e.sheet),s=keyFromAddresses(e,t);return n==null?void 0:n.get(s)}fetchRange(e,t){const n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),s=Array(),o=Array(),a=e.sheet;for(const[u,c]of this.entriesFromSheet(e.sheet)){const d=c.range;e.start<=t(c.range.end)&&(d.removeSpan(e),d.shouldBeRemoved()?(this.removeByKey(a,u),n.push(c)):s.push([u,c]),o.push(c))}const l=[];s.sort((u,c)=>compareBy(u[1],c[1],t));for(const[u,c]of s){const d=keyFromRange(c.range);if(d===u)continue;const f=this.getByKey(a,d);this.removeByKey(a,u),f!==void 0&&c!=f?l.push([f,c]):this.setRange(c)}return{verticesToRemove:n,verticesToMerge:l,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,t,n){return this.updateVerticesFromSheet(e,(s,o)=>t<=o.start.row?(o.range.shiftByRows(n),{changedSize:!1,vertex:o}):t>o.start.row&&t<=o.end.row?(o.range.expandByRows(n),{changedSize:!0,vertex:o}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,n){return this.updateVerticesFromSheet(e,(s,o)=>t<=o.start.col?(o.range.shiftByColumns(n),{changedSize:!1,vertex:o}):t>o.start.col&&t<=o.end.col?(o.range.expandByColumns(n),{changedSize:!0,vertex:o}):void 0)}moveRangesInsideSourceRange(e,t,n,s){this.updateVerticesFromSheet(e.sheet,(o,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(t),a.range.shiftByRows(n),a.range.moveToSheet(s),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=simpleCellAddress(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(n!==void 0){const s=AbsoluteCellRange.fromSimpleCellAddresses(simpleCellAddress(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:s}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[s,o]of this.entriesFromSheet(e)){const a=t(s,o);a!==void 0&&(this.removeByKey(e,s),n.push(a))}return n.forEach(s=>{this.setRange(s.vertex)}),{verticesWithChangedSize:n.filter(s=>s.changedSize).map(s=>s.vertex)}}}function keyFromAddresses(r,e){return`${r.col},${r.row},${e.col},${e.row}`}function keyFromRange(r){return keyFromAddresses(r.start,r.end)}const compareBy=(r,e,t)=>{const n=t(r.range.start),s=t(r.range.start);if(n===s){const o=t(r.range.end),a=t(e.range.end);return o-a}else return n-s};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TranslationPackage{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new MissingTranslationError(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===ErrorType.LIC)return`#${ErrorType.LIC}!`;const t=this.errors[e];if(t===void 0)throw new MissingTranslationError(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new MissingTranslationError(`ui.${e}`);return t}checkUI(){for(const e of Object.values(UIElement))if(!(e in this.ui))throw new MissingTranslationError(`ui.${e}`)}checkErrors(){for(const e of Object.values(ErrorType))if(!(e in this.errors)&&e!==ErrorType.LIC)throw new MissingTranslationError(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new ProtectedFunctionTranslationError(n)}}function buildTranslationPackage(r){return new TranslationPackage(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var UIElement;(function(r){r.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(UIElement||(UIElement={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function canonicalize(r){return r.toLowerCase()}class Sheet{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return canonicalize(this.displayName)}}class SheetMapping{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const n=this.mappingFromCanonicalName.get(canonicalize(t));if(n===void 0)throw new NoSheetWithNameError(t);return n.id},this.get=t=>{var n;return(n=this.mappingFromCanonicalName.get(canonicalize(t)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(UIElement.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=canonicalize(e);if(this.mappingFromCanonicalName.has(t))throw new SheetNameAlreadyTakenError(e);this.lastSheetId++;const n=new Sheet(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(canonicalize(e))}renameSheet(e,t){const n=this.fetchSheetById(e),s=n.displayName;if(s===t)return;const o=this.mappingFromCanonicalName.get(canonicalize(t));if(o!==void 0&&o.id!==n.id)throw new SheetNameAlreadyTakenError(t);const a=n.canonicalName;return this.mappingFromCanonicalName.delete(a),n.displayName=t,this.store(n),s}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DependencyGraph{constructor(e,t,n,s,o,a,l,u){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=s,this.stats=o,this.lazilyTransformingAstService=a,this.functionRegistry=l,this.namedExpressions=u,this.changes=ContentChanges.empty(),this.dependencyQueryAddresses=c=>{if(c instanceof RangeVertex)return this.rangeDependencyQuery(c).map(([d,f])=>d);{const d=this.formulaDependencyQuery(c);if(d!==void 0){const[f,C]=d;return C.map(m=>m instanceof NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(m.name,f.sheet).address:isSimpleCellAddress(m)?m:simpleCellRange(m.start,m.end))}else return[]}},this.dependencyQueryVertices=c=>{if(c instanceof RangeVertex)return this.rangeDependencyQuery(c);{const d=this.formulaDependencyQuery(c);if(d!==void 0){const[f,C]=d;return C.map(m=>{if(m instanceof AbsoluteCellRange)return[m.start,this.rangeMapping.fetchRange(m.start,m.end)];if(m instanceof NamedExpressionDependency){const E=this.namedExpressions.namedExpressionOrPlaceholder(m.name,f.sheet);return[E.address,this.addressMapping.fetchCell(E.address)]}else return[m,this.addressMapping.fetchCell(m)]})}else return[]}},this.rangeDependencyQuery=c=>{const d=[],{smallerRangeVertex:f,restRange:C}=this.rangeMapping.findSmallerRange(c.range);let m;f!==void 0&&this.graph.adjacentNodes(f).has(c)?(m=C,d.push([new AbsoluteCellRange(f.start,f.end),f])):m=c.range;for(const E of m.addresses(this)){const v=this.addressMapping.getCell(E);v!==void 0&&d.push([E,v])}return d},this.formulaDependencyQuery=c=>{let d,f;if(c instanceof FormulaVertex)f=c.getAddress(this.lazilyTransformingAstService),d=c.getFormula(this.lazilyTransformingAstService);else return;const C=collectDependencies(d,this.functionRegistry);return[f,absolutizeDependencies(C,f)]},this.graph=new Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,n,s,o){return new DependencyGraph(new AddressMapping(t.chooseAddressMappingPolicy),new RangeMapping,new SheetMapping(t.translationPackage),new ArrayMapping,o,e,n,s)}setFormulaToCell(e,t,n,s,o,a){const l=FormulaVertex.fromAst(t,e,s,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(l),this.processCellDependencies(n,l),this.graph.markNodeAsDirty(l),o&&this.markAsVolatile(l),a&&this.markAsDependentOnStructureChange(l),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof ArrayVertex&&this.arrayMapping.removeArray(n.getRange()),n instanceof ValueCellVertex)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n));else{const s=new ValueCellVertex(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,s),this.addressMapping.setCell(e,s),this.graph.markNodeAsDirty(s)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return ContentChanges.empty();if(this.graph.adjacentNodes(t).size>0){const n=new EmptyCellVertex;this.exchangeGraphNode(t,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);e.forEach(s=>{if(s instanceof AbsoluteCellRange){const o=s;let a=this.getRange(o.start,o.end);a===void 0&&(a=new RangeVertex(o),this.rangeMapping.setRange(a)),this.graph.addNodeAndReturnId(a);const l=this.graph.getNodeId(a);o.isFinite()||this.graph.markNodeAsInfiniteRange(l);const{smallerRangeVertex:u,restRange:c}=this.rangeMapping.findSmallerRange(o);if(u!==void 0){if(this.graph.addEdge(u,l),a.bruteForce){a.bruteForce=!1;for(const f of o.addresses(this))this.graph.removeEdge(this.fetchCell(f),l)}}else a.bruteForce=!0;const d=this.arrayMapping.getArray(c);if(d!==void 0)this.graph.addEdge(d,l);else for(const f of c.addresses(this)){const{vertex:C,id:m}=this.fetchCellOrCreateEmpty(f);this.graph.addEdge(m??C,l)}this.graph.addEdge(l,n),o.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(a)}else if(s instanceof NamedExpressionDependency){const o=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:a,id:l}=this.fetchNamedExpressionVertex(s.name,o);this.graph.addEdge(l??a,n)}else{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,n)}})}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,s=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,s)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const n=new EmptyCellVertex,s=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:s}}removeRows(e){this.stats.measure(StatType.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromRowsSpan(e)){for(const o of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(o);if(s instanceof ArrayVertex)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,n]of this.addressMapping.sheetEntries(e)){for(const s of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(s);this.removeVertex(n),this.addressMapping.removeCell(t)}this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const n of t)this.removeVertex(n);this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[n,s]of this.addressMapping.sheetEntries(e))s instanceof ArrayVertex?t.add(s):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(StatType.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromColumnsSpan(e)){for(const o of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(o);if(s instanceof ArrayVertex)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const n of t.addresses(this)){const s=this.addressMapping.getCell(n);if(s!==void 0&&!(s instanceof EmptyCellVertex)&&s!==e)return!1}return!0}moveCells(e,t,n,s){for(const o of e.addressesWithDirection(t,n,this)){const a=simpleCellAddress(s,o.col+t,o.row+n);let l=this.addressMapping.getCell(o);const u=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(o),l!==void 0){this.graph.markNodeAsDirty(l),this.addressMapping.setCell(a,l);let c;for(const d of this.graph.adjacentNodes(l))d instanceof RangeVertex&&!e.containsRange(d.range)&&(c=c??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(c,d),this.graph.removeEdge(l,d));c&&(this.graph.markNodeAsDirty(c),this.addressMapping.setCell(o,c))}if(u!==void 0){l===void 0&&this.addressMapping.removeCell(a);for(const c of this.graph.adjacentNodes(u))l=l??this.fetchCellOrCreateEmpty(a).vertex,this.graph.addEdge(l,c),this.graph.markNodeAsDirty(l);this.removeVertex(u)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(o))if(a instanceof RangeVertex&&!e.containsRange(a.range)){this.graph.removeEdge(o,a);for(const l of o.range.addresses(this)){const{vertex:u,id:c}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(c??u,a),this.addressMapping.setCell(l,u),this.graph.markNodeAsDirty(u)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,s)}setArrayEmpty(e){const t=AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const s of t.addresses(this))this.addressMapping.removeCell(s);for(const s of n.values()){const o=collectAddressesDependentToRange(this.functionRegistry,s,e.getRange(),this.lazilyTransformingAstService,this);for(const a of o){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}o.length>0&&this.graph.markNodeAsDirty(s)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const n=this.getScalarValue(t);n!==EmptyValue&&(yield[getRawValue(n),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const s=this.getScalarValue(n);t.push(s)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;t instanceof FormulaVertex?n=this.formulaDirectDependenciesToArray(t,e):n=this.rangeDirectDependenciesToArray(t,e);let s=!1;for(const[o,a]of n)e.isLeftCorner(o)&&(s=!0),this.graph.addEdge(a,t),this.graph.markNodeAsDirty(a);s||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=ContentChanges.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach(s=>{const o=s;o instanceof RangeVertex?n.push(simpleCellRange(o.start,o.end)):n.push(o.getAddress(this.lazilyTransformingAstService))}),n}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(t,s)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:a})=>a.range.addressInRange(e));if(t.length<=0)return;const{vertex:n,id:s}=this.fetchCellOrCreateEmpty(e),o=s??this.graph.getNodeId(n);t.forEach(({id:a})=>{this.graph.addEdge(o,a)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(n=>{this.graph.hasNode(n)&&this.graph.adjacentNodes(n).forEach(s=>{s instanceof ArrayVertex&&t.add(s)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:n})=>{const s=e.range.intersectionWith(n.range);s!==void 0&&s.addresses(this).forEach(o=>{const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const s=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new CellError(ErrorType.REF),n,s):(this.addressMapping.removeCell(n),this.changes.addChange(EmptyValue,n,s)):this.changes.addChange(EmptyValue,n,s)}}*formulaDirectDependenciesToArray(e,t){var n;const[,s]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(s!==void 0){for(const o of s)if(!(o instanceof NamedExpressionDependency||o instanceof AbsoluteCellRange)&&t.getRange().addressInRange(o)){const a=this.fetchCellOrCreateEmpty(o).vertex;yield[o,a]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const s of n.addresses(this))if(t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof FormulaVertex||n instanceof RangeVertex)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const s=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of s)if(o.range.includesRow(t+n))if(o.bruteForce){const a=o.range.rangeWithSameWidth(t,n);for(const l of a.addresses(this)){const{vertex:u,id:c}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(c??u,o)}}else{let a=o,l=this.rangeMapping.findSmallerRange(a.range);if(l.smallerRangeVertex!==void 0)continue;for(;l.smallerRangeVertex===void 0;){const u=new RangeVertex(AbsoluteCellRange.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(u),this.graph.addNodeAndReturnId(u);const c=new AbsoluteCellRange(simpleCellAddress(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(c,a),this.graph.addEdge(u,a),a=u,l=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(l.smallerRangeVertex,a),this.addAllFromRange(l.restRange,a),this.graph.removeEdge(l.smallerRangeVertex,o)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(o??s,t)}}fixRangesWhenAddingColumns(e,t,n){for(const s of this.rangeMapping.rangesInSheet(e))if(s.range.includesColumn(t+n)){let o;s.bruteForce?o=s.range.rangeWithSameHeight(t,n):o=AbsoluteCellRange.spanFrom(simpleCellAddress(e,t,s.range.end.row),n,1);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=AbsoluteCellRange.spanFrom(t,e.width,e.height),s=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof ArrayVertex&&this.setArray(n,e),this.exchangeOrAddGraphNode(s,e),this.addressMapping.setCell(t,e),e instanceof ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this)){if(e.isLeftCorner(o))continue;const a=this.getCell(o);this.exchangeOrAddGraphNode(a,e)}}for(const o of n.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof ArrayVertex))return;const n=AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const s of n.addresses(this))this.addressMapping.setCell(s,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,t);for(const[a,l]of s)this.mergeRangeVertices(a,l);for(const a of n)this.removeVertexAndCleanupDependencies(a);return o}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(RowsSpan.fromRowStartAndEnd(e,t-1,t-1))){const o=s.getRange();for(let a=o.start.col;a<=o.end.col;++a)for(let l=t;l<=o.end.row;++l){const u=simpleCellAddress(e,a,l),c=simpleCellAddress(e,a,l+n),d=s.getArrayCellValue(u);this.addressMapping.moveCell(c,u),this.changes.addChange(EmptyValue,c,d)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const o of s.getRange().addresses(this))this.addressMapping.setCell(o,s);else this.setNoSpaceIfArray(s)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1))){const o=s.getRange();for(let a=o.start.row;a<=o.end.row;++a)for(let l=t;l<=o.end.col;++l){const u=simpleCellAddress(e,l,a),c=simpleCellAddress(e,l+n,a),d=s.getArrayCellValue(u);this.addressMapping.moveCell(c,u),this.changes.addChange(EmptyValue,c,d)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const o of s.getRange().addresses(this))this.addressMapping.setCell(o,s);else this.setNoSpaceIfArray(s)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(e,s)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const n=t.values().next().value;t.delete(n);const[s,o]=n;this.graph.hasNode(o)&&this.graph.adjacentNodesCount(o)===0&&((o instanceof RangeVertex||o instanceof EmptyCellVertex)&&this.graph.removeNode(o).forEach(a=>t.add(a)),o instanceof RangeVertex?this.rangeMapping.removeRange(o):o instanceof EmptyCellVertex&&this.addressMapping.removeCell(s))}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class EmptyCellVertex{constructor(){}getCellValue(){return EmptyValue}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ValueCellVertex{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ParsingErrorVertex{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return CellError.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SparseStrategy{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(n=>{const s=new Map;n.forEach((o,a)=>{a>=e&&(s.set(a+t,o),n.delete(a))}),s.forEach((o,a)=>{n.set(a,o)})}),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach((s,o)=>{o>=e&&(n.set(o+t,s),this.mapping.delete(o))}),n.forEach((s,o)=>{this.mapping.set(o,s)}),this.width+=t}removeRows(e){this.mapping.forEach(s=>{const o=new Map;s.forEach((a,l)=>{l>=e.rowStart&&(s.delete(l),l>e.rowEnd&&o.set(l-e.numberOfRows,a))}),o.forEach((a,l)=>{s.set(l,a)})});const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach((o,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&t.set(a-e.numberOfColumns,o))}),t.forEach((o,a)=>{this.mapping.set(a,o)});const n=Math.min(this.width-1,e.columnEnd),s=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-s)}*getEntries(e){for(const[t,n]of this.mapping)for(const[s,o]of n)yield[simpleCellAddress(e,t,s),o]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[n,s]of t)yield s}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,o]of n)yield o}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const s=t.get(n);s!==void 0&&(yield s)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const s of e.rows()){const o=n.get(s);o!==void 0&&(yield[simpleCellAddress(e.sheet,t,s),o])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,o]of n.entries())yield[simpleCellAddress(e.sheet,t,s),o]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,s]of t)s!==void 0&&(yield s)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DenseStrategy{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let s=0;s<t;s++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)this.mapping[n]!==void 0&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let s=0;s<this.height;s++)this.mapping[s]!==void 0&&this.mapping[s].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const s=this.getCellVertex(n,t);s&&(yield[simpleCellAddress(e,n,t),s])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield[simpleCellAddress(e.sheet,t,n),s])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield[simpleCellAddress(e.sheet,t,n),s])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return(n=this.mapping[t])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ErrorType;(function(r){r.DIV_BY_ZERO="DIV_BY_ZERO",r.NAME="NAME",r.VALUE="VALUE",r.NUM="NUM",r.NA="NA",r.CYCLE="CYCLE",r.REF="REF",r.SPILL="SPILL",r.LIC="LIC",r.ERROR="ERROR"})(ErrorType||(ErrorType={}));var CellType;(function(r){r.FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA"})(CellType||(CellType={}));const getCellType=(r,e)=>r instanceof ArrayVertex?r.isLeftCorner(e)?CellType.ARRAYFORMULA:CellType.ARRAY:r instanceof FormulaCellVertex||r instanceof ParsingErrorVertex?CellType.FORMULA:r instanceof ValueCellVertex?CellType.VALUE:CellType.EMPTY;var CellValueNoNumber;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.ERROR="ERROR"})(CellValueNoNumber||(CellValueNoNumber={}));var CellValueJustNumber;(function(r){r.NUMBER="NUMBER"})(CellValueJustNumber||(CellValueJustNumber={}));const CellValueType=Object.assign(Object.assign({},CellValueNoNumber),CellValueJustNumber),CellValueDetailedType=Object.assign(Object.assign({},CellValueNoNumber),NumberType),CellValueTypeOrd=r=>{switch(r){case CellValueType.EMPTY:return 0;case CellValueType.NUMBER:return 1;case CellValueType.STRING:return 2;case CellValueType.BOOLEAN:return 3;case CellValueType.ERROR:return 4}throw new Error("Cell value not computed")},getCellValueType=r=>{if(r===EmptyValue)return CellValueType.EMPTY;if(r instanceof CellError||r instanceof SimpleRangeValue)return CellValueType.ERROR;if(typeof r=="string")return CellValueType.STRING;if(isExtendedNumber(r))return CellValueType.NUMBER;if(typeof r=="boolean")return CellValueType.BOOLEAN;throw new Error("Cell value not computed")},getCellValueDetailedType=r=>isExtendedNumber(r)?getTypeOfExtendedNumber(r):getCellValueType(r),getCellValueFormat=r=>{if(isExtendedNumber(r))return getFormatOfExtendedNumber(r)};class CellError{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new CellError(ErrorType.ERROR,`${ErrorMessage.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new CellError(this.type,this.message,e):this}}const simpleRowAddress=(r,e)=>({sheet:r,row:e}),invalidSimpleRowAddress=r=>r.row<0,simpleColumnAddress=(r,e)=>({sheet:r,col:e}),invalidSimpleColumnAddress=r=>r.col<0,simpleCellAddress=(r,e,t)=>({sheet:r,col:e,row:t}),invalidSimpleCellAddress=r=>r.col<0||r.row<0,movedSimpleCellAddress=(r,e,t,n)=>simpleCellAddress(e,r.col+t,r.row+n),addressKey=r=>`${r.sheet},${r.row},${r.col}`;function isSimpleCellAddress(r){var e,t,n;return r&&(typeof r=="object"||typeof r=="function")&&typeof((e=r)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=r)===null||t===void 0?void 0:t.col)=="number"&&typeof((n=r)===null||n===void 0?void 0:n.row)=="number"}const absoluteSheetReference=(r,e)=>{var t;return(t=r.sheet)!==null&&t!==void 0?t:e.sheet},equalSimpleCellAddress=(r,e)=>r.sheet===e.sheet&&r.col===e.col&&r.row===e.row;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";function isSimpleCellRange(r){return r&&(typeof r=="object"||typeof r=="function")?"start"in r&&isSimpleCellAddress(r.start)&&"end"in r&&isSimpleCellAddress(r.end):!1}const simpleCellRange=(r,e)=>({start:r,end:e});class AbsoluteCellRange{constructor(e,t){if(e.sheet!==t.sheet)throw new SheetsNotEqual(e.sheet,t.sheet);this.start=simpleCellAddress(e.sheet,e.col,e.row),this.end=simpleCellAddress(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new SheetsNotEqual(e.sheet,t.sheet);const n=t.col-e.col,s=t.row-e.row;return Number.isFinite(s)&&Number.isFinite(n)?new AbsoluteCellRange(e,t):Number.isFinite(s)?new AbsoluteRowRange(e.sheet,e.row,t.row):new AbsoluteColumnRange(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===AstNodeType.CELL_RANGE?AbsoluteCellRange.fromCellRange(e,t):e.type===AstNodeType.COLUMN_RANGE?AbsoluteColumnRange.fromColumnRange(e,t):AbsoluteRowRange.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return AbsoluteCellRange.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new AbsoluteCellRange(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const s=AbsoluteCellRange.spanFromOrUndef(e,t,n);if(s===void 0)throw new Error(WRONG_RANGE_SIZE);return s}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n))return e.col!==0?void 0:new AbsoluteRowRange(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(t))return e.row!==0?void 0:new AbsoluteColumnRange(e.sheet,e.col,e.col+t-1);if(Number.isFinite(n)&&Number.isFinite(t))return new AbsoluteCellRange(e,simpleCellAddress(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,s,o){return new AbsoluteCellRange(simpleCellAddress(e,t,n),simpleCellAddress(e,s,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),s=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(t>n||s>o))return new AbsoluteCellRange(simpleCellAddress(this.sheet,s,t),simpleCellAddress(this.sheet,o,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const s=simpleCellAddress(this.sheet,this.start.col+n,this.start.row+t);e[t].push(s)}}return e}withStart(e){return new AbsoluteCellRange(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return equalSimpleCellAddress(this.start,e.start)&&equalSimpleCellAddress(this.end,e.end)}addressesArrayMap(e,t){const n=[];let s=this.start.row;for(;s<=this.effectiveEndRow(e);){let o=this.start.col;const a=[];for(;o<=this.effectiveEndColumn(e);)a.push(t(simpleCellAddress(this.start.sheet,o,s))),o++;n.push(a),s++}return n}addresses(e){const t=[];let n=this.start.row;const s=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;n<=s;){let a=this.start.col;for(;a<=o;)t.push(simpleCellAddress(this.start.sheet,a,n)),a++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield simpleCellAddress(this.start.sheet,o,s),o-=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield simpleCellAddress(this.start.sheet,o,s),o-=1;s+=1}}else if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield simpleCellAddress(this.start.sheet,o,s),o+=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield simpleCellAddress(this.start.sheet,o,s),o+=1;s+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return simpleCellAddress(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class AbsoluteColumnRange extends AbsoluteCellRange{constructor(e,t,n){super(simpleCellAddress(e,t,0),simpleCellAddress(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),s=e.end.toSimpleColumnAddress(t);if(n.sheet!==s.sheet)throw new SheetsNotEqual(n.sheet,s.sheet);return new AbsoluteColumnRange(n.sheet,n.col,s.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new AbsoluteColumnRange(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new AbsoluteColumnRange(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class AbsoluteRowRange extends AbsoluteCellRange{constructor(e,t,n){super(simpleCellAddress(e,0,t),simpleCellAddress(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),s=e.end.toSimpleRowAddress(t);if(n.sheet!==s.sheet)throw new SheetsNotEqual(n.sheet,s.sheet);return new AbsoluteRowRange(n.sheet,n.row,s.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new AbsoluteRowRange(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new AbsoluteRowRange(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InterpreterState{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function collatorFromConfig(r){const e=r.caseSensitive?r.accentSensitive?"variant":"case":r.accentSensitive?"accent":"base",t=r.caseFirst,n=r.ignorePunctuation;return new Intl.Collator(r.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const COMPLEX_NUMBER_SYMBOL="i",complexParsingRegexp=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class ArithmeticHelper{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(s,o)=>this.compare(s,o)<0,this.leq=(s,o)=>this.compare(s,o)<=0,this.gt=(s,o)=>this.compare(s,o)>0,this.geq=(s,o)=>this.compare(s,o)>=0,this.eq=(s,o)=>this.compare(s,o)===0,this.neq=(s,o)=>this.compare(s,o)!==0,this.pow=(s,o)=>Math.pow(getRawValue(s),getRawValue(o)),this.addWithEpsilonRaw=(s,o)=>{const a=s+o;return Math.abs(a)<this.actualEps*Math.abs(s)?0:a},this.addWithEpsilon=(s,o)=>{const a=inferExtendedNumberTypeAdditive(s,o);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(getRawValue(s),getRawValue(o)),a)},this.unaryMinus=s=>cloneNumber(s,-getRawValue(s)),this.unaryPlus=s=>s,this.unaryPercent=s=>new PercentNumber(getRawValue(s)/100),this.concat=(s,o)=>s.concat(o),this.nonstrictadd=(s,o)=>s instanceof CellError?s:o instanceof CellError?o:typeof s=="number"?typeof o=="number"?this.addWithEpsilonRaw(s,o):s:typeof o=="number"?o:0,this.subtract=(s,o)=>{const a=inferExtendedNumberTypeAdditive(s,o),l=getRawValue(s),u=getRawValue(o);let c=l-u;return Math.abs(c)<this.actualEps*Math.abs(l)&&(c=0),this.ExtendedNumberFactory(c,a)},this.divide=(s,o)=>{const a=getRawValue(s),l=getRawValue(o);if(l===0)return new CellError(ErrorType.DIV_BY_ZERO);{const u=inferExtendedNumberTypeMultiplicative(s,o);return this.ExtendedNumberFactory(a/l,u)}},this.multiply=(s,o)=>{const a=inferExtendedNumberTypeMultiplicative(s,o);return this.ExtendedNumberFactory(getRawValue(s)*getRawValue(o),a)},this.manyToExactComplex=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(isExtendedNumber(a)||typeof a=="string"){const l=this.coerceScalarToComplex(a);l instanceof CellError||o.push(l)}}return o},this.coerceNumbersExactRanges=s=>this.manyToNumbers(s,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=s=>this.manyToNumbers(s,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;isExtendedNumber(a)&&o.push(getRawValue(a))}return o},this.manyToOnlyNumbersDropNulls=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(isExtendedNumber(a))o.push(getRawValue(a));else if(a!==EmptyValue)return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected)}return o},this.manyToCoercedNumbersDropNulls=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(a===EmptyValue)continue;const l=this.coerceScalarToNumberOrError(a);isExtendedNumber(l)&&o.push(getRawValue(l))}return o},this.collator=collatorFromConfig(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n=="string"&&t.test(this.normalizeString(n))}neqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n!="string"||!t.test(this.normalizeString(n))}searchString(e,t){var n;const o=this.buildRegex(e,!1).exec(t);return(n=o==null?void 0:o.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(isWildcard(n)||this.config.useRegularExpressions&&needsEscape(n))return!0}return!1}floatCmp(e,t){const n=getRawValue(e),s=getRawValue(t),o=1+this.actualEps;return s>=0&&n*o>=s&&n<=s*o||s<=0&&n*o<=s&&n>=s*o?0:n>s?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof CellError?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new CellError(ErrorType.VALUE,ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===EmptyValue)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return isExtendedNumber(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const n=t.slice(0,t.length-1).trim(),s=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(s!==void 0)return new PercentNumber(s/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[n,s]=t,o=this.numberLiteralsHelper.numericStringToMaybeNumber(s);if(o!==void 0)return new CurrencyNumber(o,n)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const s of e)if(s instanceof SimpleRangeValue)t.push(s);else if(s!==EmptyValue){const o=this.coerceScalarToComplex(s);if(o instanceof CellError)return o;t.push(o)}const n=[];for(const s of t)if(s instanceof SimpleRangeValue){const o=this.manyToExactComplex(s.valuesFromTopLeftCorner());if(o instanceof CellError)return o;n.push(...o)}else n.push(s);return n}coerceScalarToComplex(e){return e instanceof CellError?e:e===EmptyValue?[0,0]:isExtendedNumber(e)?[getRawValue(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:s}=t;switch(n){case NumberType.NUMBER_RAW:return e;case NumberType.NUMBER_CURRENCY:return new CurrencyNumber(e,s??this.config.currencySymbol[0]);case NumberType.NUMBER_DATE:return new DateNumber(e,s);case NumberType.NUMBER_DATETIME:return new DateTimeNumber(e,s);case NumberType.NUMBER_TIME:return new TimeNumber(e,s);case NumberType.NUMBER_PERCENT:return new PercentNumber(e,s)}}buildRegex(e,t=!0){e=this.normalizeString(e);let n,s=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,s=!1}return o?n=escapeNoCharacters(e,this.config.caseSensitive):s?n=escapeNonWildcards(e,this.config.caseSensitive):n=escapeAllCharacters(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=normalizeString(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,s=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(isExtendedNumber(n)&&isExtendedNumber(s))return this.floatCmp(n,s)}return e===EmptyValue?e=coerceEmptyToValue(t):t===EmptyValue&&(t=coerceEmptyToValue(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?numberCmp(coerceBooleanToNumber(e),coerceBooleanToNumber(t)):isExtendedNumber(e)&&isExtendedNumber(t)?this.floatCmp(e,t):e===EmptyValue&&t===EmptyValue?0:numberCmp(CellValueTypeOrd(getCellValueType(e)),CellValueTypeOrd(getCellValueType(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const o of e)if(o instanceof SimpleRangeValue)n.push(o);else{const a=getRawValue(this.coerceScalarToNumberOrError(o));if(a instanceof CellError)return a;n.push(a)}const s=[];for(const o of n)if(o instanceof SimpleRangeValue){const a=t(o.valuesFromTopLeftCorner());if(a instanceof CellError)return a;s.push(...a)}else s.push(o);return s}coerceStringToComplex(e){const t=complexParsingRegexp.exec(e);if(t===null)return new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected);let n;if(t[6]!==void 0?n=t[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(t[1]+t[3],t[5]),n instanceof CellError||t[8]===void 0)return n;let s;return t[14]!==void 0?s=t[9]==="-"?[0,-1]:[0,1]:s=this.parseComplexToken(t[9]+t[11],t[13]),s instanceof CellError?s:t[5]!==""||t[13]===""?new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected):t[8]==="+"?[n[0]+s[0],n[1]+s[1]]:[n[0]-s[0],n[1]-s[1]]}parseComplexToken(e,t){const n=getRawValue(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected):t===""?[n,0]:[0,n]}}function coerceComplexToString([r,e],t){if(!isFinite(r)||!isFinite(e))return new CellError(ErrorType.NUM,ErrorMessage.NaN);if(t=t??COMPLEX_NUMBER_SYMBOL,e===0)return`${r}`;const n=`${e===-1||e===1?"":Math.abs(e)}${t}`;return r===0?`${e<0?"-":""}${n}`:`${r}${e<0?"-":"+"}${n}`}function coerceToRange(r){return r instanceof SimpleRangeValue?r:SimpleRangeValue.fromScalar(r)}function coerceBooleanToNumber(r){return Number(r)}function coerceEmptyToValue(r){return typeof r=="string"?"":isExtendedNumber(r)?0:typeof r=="boolean"?!1:EmptyValue}function coerceScalarToBoolean(r){if(r instanceof CellError||typeof r=="boolean")return r;if(r===EmptyValue)return!1;if(isExtendedNumber(r))return getRawValue(r)!==0;{const e=r.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function coerceScalarToString(r){return r instanceof CellError||typeof r=="string"?r:r===EmptyValue?"":isExtendedNumber(r)?getRawValue(r).toString():r?"TRUE":"FALSE"}function zeroIfEmpty(r){return r===EmptyValue?0:r}function numberCmp(r,e){const t=getRawValue(r),n=getRawValue(e);return t>n?1:t<n?-1:0}function isNumberOverflow(r){return isNaN(r)||r===1/0||r===-1/0}function fixNegativeZero(r){return r===0?0:r}function isWildcard(r){return["*","?"].includes(r)}const escapedCharacters=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function needsEscape(r){return escapedCharacters.includes(r)}function escapeNonWildcards(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);if(s==="~"){if(n==r.length-1){t+="~";continue}const o=r.charAt(n+1);isWildcard(o)||needsEscape(o)?(t+="\\"+o,n++):(t+=o,n++)}else isWildcard(s)?t+="."+s:needsEscape(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function escapeAllCharacters(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);isWildcard(s)||needsEscape(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function escapeNoCharacters(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);isWildcard(s)||needsEscape(s)||e?t+=s:t+=s.toLowerCase()}return t}function inferExtendedNumberTypeAdditive(r,e){const{type:t,format:n}=getTypeFormatOfExtendedNumber(r),{type:s,format:o}=getTypeFormatOfExtendedNumber(e);if(t===NumberType.NUMBER_RAW)return{type:s,format:o};if(s===NumberType.NUMBER_RAW)return{type:t,format:n};if((t===NumberType.NUMBER_DATETIME||t===NumberType.NUMBER_DATE)&&(s===NumberType.NUMBER_DATETIME||s===NumberType.NUMBER_DATE))return{type:NumberType.NUMBER_RAW};if(t===NumberType.NUMBER_TIME){if(s===NumberType.NUMBER_DATE)return{type:NumberType.NUMBER_DATETIME,format:`${o} ${n}`};if(s===NumberType.NUMBER_DATETIME)return{type:NumberType.NUMBER_DATETIME,format:o}}if(s===NumberType.NUMBER_TIME){if(t===NumberType.NUMBER_DATE)return{type:NumberType.NUMBER_DATETIME,format:`${n} ${o}`};if(t===NumberType.NUMBER_DATETIME)return{type:NumberType.NUMBER_DATETIME,format:n}}return{type:t,format:n}}function inferExtendedNumberTypeMultiplicative(r,e){let{type:t,format:n}=getTypeFormatOfExtendedNumber(r),{type:s,format:o}=getTypeFormatOfExtendedNumber(e);return t===NumberType.NUMBER_PERCENT&&(t=NumberType.NUMBER_RAW,n=void 0),s===NumberType.NUMBER_PERCENT&&(s=NumberType.NUMBER_RAW,o=void 0),t===NumberType.NUMBER_RAW?{type:s,format:o}:s===NumberType.NUMBER_RAW?{type:t,format:n}:{type:NumberType.NUMBER_RAW}}function forceNormalizeString(r){return normalizeString(r.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function coerceRangeToScalar(r,e){var t;if(r.isAdHoc())return(t=r.data[0])===null||t===void 0?void 0:t[0];const n=r.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const s=e.formulaAddress.row-n.start.row;if(s>=0&&s<n.height())return r.data[s][0]}else if(n.height()===1){const s=e.formulaAddress.col-n.start.col;if(s>=0&&s<n.width())return r.data[0][s]}}}function normalizeString(r,e){return r.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var FunctionArgumentType;(function(r){r.STRING="STRING",r.NUMBER="NUMBER",r.BOOLEAN="BOOLEAN",r.SCALAR="SCALAR",r.NOERROR="NOERROR",r.RANGE="RANGE",r.INTEGER="INTEGER",r.COMPLEX="COMPLEX",r.ANY="ANY"})(FunctionArgumentType||(FunctionArgumentType={}));class FunctionPlugin{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,n,s,o)=>{const a=this.evaluateArguments(t,n,s),l=a.map(([E,v])=>E),u=a.map(([E,v])=>v),c=this.buildMetadataForEachArgumentValue(l.length,s),d=n.arraysFlag&&!s.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(c,l.length))return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);const[f,C]=d?this.calculateSizeOfVectorizedResultArray(l,c):[1,1];if(f===1&&C===1){const E=this.vectorizeAndBroadcastArgumentsIfNecessary(d,l,c,0,0);return this.calculateSingleCellOfResultArray(n,E,c,u,o,s.returnNumberType)}const m=[...Array(f).keys()].map(E=>[...Array(C).keys()].map(v=>{const _=this.vectorizeAndBroadcastArgumentsIfNecessary(d,l,c,E,v),T=this.calculateSingleCellOfResultArray(n,_,c,u,o,s.returnNumberType);if(T instanceof SimpleRangeValue)throw new Error("Function returning array cannot be vectorized.");return T}));return SimpleRangeValue.onlyValues(m)},this.runFunctionWithReferenceArgument=(t,n,s,o,a,l=()=>new CellError(ErrorType.NA,ErrorMessage.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(o(),s.returnNumberType);if(t.length>1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);let u=t[0];for(;u.type===AstNodeType.PARENTHESIS;)u=u.expression;let c;if(u.type===AstNodeType.CELL_REFERENCE)c=u.reference.toSimpleCellAddress(n.formulaAddress);else if(u.type===AstNodeType.CELL_RANGE||u.type===AstNodeType.COLUMN_RANGE||u.type===AstNodeType.ROW_RANGE)try{c=AbsoluteCellRange.fromAst(u,n.formulaAddress).start}catch{return new CellError(ErrorType.REF,ErrorMessage.CellRefExpected)}return c!==void 0?this.returnNumberWrapper(a(c),s.returnNumberType):this.runFunction(t,n,s,l)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const s of e){const o=this.evaluateAst(s,t);if(o instanceof SimpleRangeValue)for(const a of o.valuesFromTopLeftCorner())n.push([a,!0]);else n.push([o,!1])}return n}coerceToType(e,t,n){let s;if(e instanceof SimpleRangeValue)switch(t.argumentType){case FunctionArgumentType.RANGE:case FunctionArgumentType.ANY:s=e;break;default:{const o=coerceRangeToScalar(e,n);if(o===void 0)return;e=o}}if(!(e instanceof SimpleRangeValue))switch(t.argumentType){case FunctionArgumentType.INTEGER:case FunctionArgumentType.NUMBER:const o=this.coerceScalarToNumberOrError(e);if(!isExtendedNumber(o)){s=o;break}const a=getRawValue(o);if(t.maxValue!==void 0&&a>t.maxValue)return new CellError(ErrorType.NUM,ErrorMessage.ValueLarge);if(t.minValue!==void 0&&a<t.minValue)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);if(t.lessThan!==void 0&&a>=t.lessThan)return new CellError(ErrorType.NUM,ErrorMessage.ValueLarge);if(t.greaterThan!==void 0&&a<=t.greaterThan)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);if(t.argumentType===FunctionArgumentType.INTEGER&&!Number.isInteger(a))return new CellError(ErrorType.NUM,ErrorMessage.IntegerExpected);s=o;break;case FunctionArgumentType.STRING:s=coerceScalarToString(e);break;case FunctionArgumentType.BOOLEAN:s=coerceScalarToBoolean(e);break;case FunctionArgumentType.SCALAR:case FunctionArgumentType.NOERROR:case FunctionArgumentType.ANY:s=e;break;case FunctionArgumentType.RANGE:if(e instanceof CellError)return e;s=coerceToRange(e);break;case FunctionArgumentType.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(getRawValue(e))}return t.passSubtype||s===void 0?s:getRawValue(s)}calculateSingleCellOfResultArray(e,t,n,s,o,a){const l=this.coerceArgumentsToRequiredTypes(e,t,n,s);if(l instanceof CellError)return l;const u=o(...l);return this.returnNumberWrapper(u,a)}coerceArgumentsToRequiredTypes(e,t,n,s){const o=[];for(let a=0;a<n.length;a++){const l=n[a],u=t[a]!==void 0?t[a]:l==null?void 0:l.defaultValue;if(u===void 0){o.push(void 0);continue}const c=this.coerceToType(u,l,e);if(c===void 0&&!s[a])return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(c instanceof CellError&&l.argumentType!==FunctionArgumentType.SCALAR)return c;o.push(c)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,s,o){return t.map((a,l)=>e&&this.isRangePassedAsAScalarArgument(a,n[l])?this.vectorizeAndBroadcastRangeArgument(a,s,o):a)}vectorizeAndBroadcastRangeArgument(e,t,n){var s;const o=e.height()===1?0:t,a=e.width()===1?0:n;return(s=e.data[o])===null||s===void 0?void 0:s[a]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map(s=>[this.evaluateAst(s,t),!1])}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(o=>(o==null?void 0:o.optionalArg)||(o==null?void 0:o.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter((a,l)=>this.isRangePassedAsAScalarArgument(a,t[l])),s=Math.max(1,...n.map(a=>a.height())),o=Math.max(1,...n.map(a=>a.width()));return[s,o]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof SimpleRangeValue&&![FunctionArgumentType.RANGE,FunctionArgumentType.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return t!==void 0&&isExtendedNumber(e)?this.arithmeticHelper.ExtendedNumberFactory(getRawValue(e),{type:t,format:n}):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArraySize{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new ArraySize(1,1,!0)}static scalar(){return new ArraySize(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function arraySizeForBinaryOp(r,e){return new ArraySize(Math.max(r.width,e.width),Math.max(r.height,e.height))}function arraySizeForUnaryOp(r){return new ArraySize(r.width,r.height)}class ArraySizePredictor{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:{const n=AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return n===void 0?ArraySize.error():new ArraySize(n.width(),n.height(),!0)}case AstNodeType.ARRAY:{const n=[],s=[];for(const l of e.args){const u=l.map(f=>this.checkArraySizeForAst(f,t)),c=Math.min(...u.map(f=>f.height)),d=u.reduce((f,C)=>f+C.width,0);n.push(c),s.push(d)}const o=n.reduce((l,u)=>l+u,0),a=Math.min(...s);return new ArraySize(a,o)}case AstNodeType.STRING:case AstNodeType.NUMBER:return ArraySize.scalar();case AstNodeType.CELL_REFERENCE:return new ArraySize(1,1,!0);case AstNodeType.DIV_OP:case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.PLUS_OP:case AstNodeType.POWER_OP:case AstNodeType.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),s=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||s.height>1||s.width>1)?ArraySize.error():arraySizeForBinaryOp(n,s)}case AstNodeType.MINUS_UNARY_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?ArraySize.error():arraySizeForUnaryOp(n)}case AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case AstNodeType.EMPTY:return ArraySize.error();default:return ArraySize.error()}}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(n!==void 0)return n(e,t);const s=this.functionRegistry.getMetadata(e.procedureName);if(s===void 0||s.expandRanges||!t.arraysFlag||s.vectorizationForbidden||s.parameters===void 0)return new ArraySize(1,1);const o=e.args.map(c=>{var d;return this.checkArraySizeForAst(c,new InterpreterState(t.formulaAddress,t.arraysFlag||((d=s==null?void 0:s.arrayFunction)!==null&&d!==void 0?d:!1)))}),a=[...s.parameters];if(s.repeatLastArgs!==void 0&&a.length<o.length&&(o.length-a.length)%s.repeatLastArgs!==0)return ArraySize.error();for(;a.length<o.length;){if(s.repeatLastArgs===void 0)return ArraySize.error();a.push(...a.slice(a.length-s.repeatLastArgs))}let l=1,u=1;for(let c=0;c<o.length;c++)a[c].argumentType!==FunctionArgumentType.RANGE&&a[c].argumentType!==FunctionArgumentType.ANY&&(u=Math.max(u,o[c].height),l=Math.max(l,o[c].width));return new ArraySize(l,u)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DetailedCellError{constructor(e,t,n){var s;this.value=t,this.address=n,this.type=e.type,this.message=(s=e.message)!==null&&s!==void 0?s:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function configValueFromParam(r,e,t){if(typeof r>"u")return Config.defaultConfig[t];if(typeof e=="string"){if(typeof r===e)return r;throw new ExpectedValueOfTypeError(e,t)}else{if(e.includes(r))return r;throw new ExpectedOneOfValuesError(e.map(n=>`'${n}'`).join(" "),t)}}function validateNumberToBeAtLeast(r,e,t){if(r<t)throw new ConfigValueTooSmallError(e,t)}function validateNumberToBeAtMost(r,e,t){if(r>t)throw new ConfigValueTooBigError(e,t)}function configValueFromParamCheck(r,e,t,n){if(e(r))return r;if(typeof r>"u")return Config.defaultConfig[n];throw new ExpectedValueOfTypeError(t,n)}function configCheckIfParametersNotInConflict(...r){const e=new Map;r.forEach(n=>{const s=e.get(n.value)||[];s.push(n.name),e.set(n.value,s)});const t=[];for(const n of e.values())n.length>1&&t.push(n);if(t.length>0){t.forEach(s=>s.sort());const n=t.map(s=>`[${s}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function validateArgToType(r,e,t){if(typeof r!==e)throw new ExpectedValueOfTypeError(e,t)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const TIME_FORMAT_SECONDS_ITEM_REGEXP=new RegExp("^ss(\\.(s+|0+))?$"),QUICK_CHECK_REGEXP=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),WHITESPACE_REGEXP=new RegExp("\\s+"),DATE_SEPARATOR_REGEXP=new RegExp("[ /.-]"),TIME_SEPARATOR=":",SECONDS_PRECISION=1e3,memoizedParseTimeFormat=memoize(parseTimeFormat),memoizedParseDateFormat=memoize(parseDateFormat);function defaultParseToDateTime(r,e,t){if(e===void 0&&t===void 0)return;let n=r.replace(WHITESPACE_REGEXP," ").trim().toLowerCase();if(!doesItLookLikeADateTimeQuickCheck(n))return;let s=n.substring(n.length-2);s==="am"||s==="pm"?n=n.substring(0,n.length-2).trim():(s=n.substring(n.length-1),s==="a"||s==="p"?n=n.substring(0,n.length-1).trim():s=void 0);const o=n.split(DATE_SEPARATOR_REGEXP);o.length>=2&&o[o.length-2].includes(TIME_SEPARATOR)&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());const a=o[o.length-1].split(TIME_SEPARATOR);if(s!==void 0&&a.push(s),o.length===1)return defaultParseToTime(a,t);if(a.length===1)return defaultParseToDate(o,e);const l=defaultParseToDate(o.slice(0,o.length-1),e),u=defaultParseToTime(a,t);if(l!==void 0)return u===void 0?void 0:Object.assign(Object.assign({},l),u)}function defaultParseToTime(r,e){var t,n,s;if(e===void 0)return;const{itemsCount:o,hourItem:a,minuteItem:l,secondItem:u}=memoizedParseTimeFormat(e);let c;if(r[r.length-1]==="am"||r[r.length-1]==="a"?(c=!1,r.pop()):(r[r.length-1]==="pm"||r[r.length-1]==="p")&&(c=!0,r.pop()),r.length!==o)return;const d=Number((t=r[u])!==null&&t!==void 0?t:"0");if(!Number.isFinite(d))return;const f=Math.round(d*SECONDS_PRECISION)/SECONDS_PRECISION,C=Number((n=r[l])!==null&&n!==void 0?n:"0");if(!(Number.isFinite(C)&&Number.isInteger(C)))return;const m=Number((s=r[a])!==null&&s!==void 0?s:"0");return!(Number.isFinite(m)&&Number.isInteger(m))||c!==void 0&&(m<0||m>12)?void 0:{hours:c!==void 0?m%12+(c?12:0):m,minutes:C,seconds:f}}function defaultParseToDate(r,e){var t;if(e===void 0)return;const{itemsCount:n,dayItem:s,monthItem:o,shortYearItem:a,longYearItem:l}=memoizedParseDateFormat(e);if(r.length!==n)return;const u=Number(r[s]);if(!(Number.isFinite(u)&&Number.isInteger(u)))return;const c=Number(r[o]);if(!(Number.isFinite(c)&&Number.isInteger(c))||r[l]&&r[a])return;const d=Number((t=r[l])!==null&&t!==void 0?t:r[a]);if(Number.isFinite(d)&&Number.isInteger(d)&&!(r[l]&&(d<1e3||d>9999))&&!(r[a]&&(d<0||d>99)))return{year:d,month:c,day:u}}function parseTimeFormat(r){const e=r.toLowerCase().trim(),n=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,r.length-3):e).trim().split(TIME_SEPARATOR);return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex(s=>TIME_FORMAT_SECONDS_ITEM_REGEXP.test(s))}}function parseDateFormat(r){const e=r.toLowerCase().trim().split(DATE_SEPARATOR_REGEXP);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function doesItLookLikeADateTimeQuickCheck(r){return QUICK_CHECK_REGEXP.test(r)}function memoize(r){const e={};return t=>{const n=e[t];if(n!==void 0)return n;const s=r(t);return e[t]=s,s}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const numDays=[31,28,31,30,31,30,31,31,30,31,30,31],prefSumDays=[0,31,59,90,120,151,181,212,243,273,304,334],SECONDS_PER_MINUTE=60,MINUTES_PER_HOUR=60,HOURS_PER_DAY=24;function instanceOfSimpleDate(r){return r&&(typeof r=="object"||typeof r=="function")?"year"in r&&typeof r.year=="number"&&"month"in r&&typeof r.month=="number"&&"day"in r&&typeof r.day=="number":!1}function instanceOfSimpleTime(r){return r&&(typeof r=="object"||typeof r=="function")?"hours"in r&&typeof r.hours=="number"&&"minutes"in r&&typeof r.minutes=="number"&&"seconds"in r&&typeof r.seconds=="number":!1}const maxDate={year:9999,month:12,day:31};class DateTimeHelper{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(maxDate),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:s=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return instanceOfSimpleTime(t)?instanceOfSimpleDate(t)?new DateTimeNumber(timeToNumber(t)+this.dateToNumber(t),n+" "+s):new TimeNumber(timeToNumber(t),s):instanceOfSimpleDate(t)?new DateNumber(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=numDays[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const s=t-this.dateToNumberFromZero({year:n,month:1,day:1}),o=dayToMonth(s-(this.isLeapYear(n)&&s>=59?1:0)),a=s-prefSumDays[o]-(this.isLeapYear(n)&&o>1?1:0);return{year:n,month:o+1,day:a+1}}numberToSimpleDateTime(e){const t=numberToSimpleTime(e%1),n=Math.floor(t.hours/HOURS_PER_DAY);t.hours=t.hours%HOURS_PER_DAY;const s=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},s),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:numDays[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const s=this.parseDateTime(e,t,n);if(!(instanceOfSimpleDate(s)&&(s.year>=0&&s.year<100&&(s.year<this.getNullYear()?s.year+=2e3:s.year+=1900),!this.isValidDate(s))))return s}parseDateTimeFromFormats(e,t,n){const s=t.length===0?[void 0]:t,o=n.length===0?[void 0]:n;for(const a of s)for(const l of o){const u=this.parseSingleFormat(e,a,l);if(u!==void 0)return{dateTime:u,timeFormat:l,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+prefSumDays[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function dayToMonth(r){let e=0;return prefSumDays[e+6]<=r&&(e+=6),prefSumDays[e+3]<=r&&(e+=3),prefSumDays[e+2]<=r?e+=2:prefSumDays[e+1]<=r&&(e+=1),e}function offsetMonth(r,e){const t=12*r.year+r.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:r.day}}function truncateDayInMonth(r){return{year:r.year,month:r.month,day:Math.min(r.day,numDays[r.month-1])}}function roundToNearestSecond(r){return Math.round(r*3600*24)/(3600*24)}function roundToEpsilon(r,e=1){return Math.round(r*e)/e}function numberToSimpleTime(r){const e=r*HOURS_PER_DAY*MINUTES_PER_HOUR*SECONDS_PER_MINUTE,t=roundToEpsilon(e%SECONDS_PER_MINUTE,1e5)%SECONDS_PER_MINUTE,n=(e-t)/SECONDS_PER_MINUTE,s=Math.round(n%MINUTES_PER_HOUR)%MINUTES_PER_HOUR,o=(n-s)/MINUTES_PER_HOUR;return{hours:Math.round(o),minutes:s,seconds:t}}function timeToNumber(r){return((r.seconds/60+r.minutes)/60+r.hours)/24}function toBasisEU(r){return{year:r.year,month:r.month,day:Math.min(30,r.day)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AlwaysDense{call(){return DenseStrategy}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const dateFormatRegex=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,numberFormatRegex=/(\\.|[#0]+(\.[#0]*)?)/g;var TokenType;(function(r){r.FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT"})(TokenType||(TokenType={}));function formatToken(r,e){return{type:r,value:e}}var FormatExpressionType;(function(r){r.DATE="DATE",r.NUMBER="NUMBER",r.STRING="STRING"})(FormatExpressionType||(FormatExpressionType={}));function matchDateFormat(r){dateFormatRegex.lastIndex=0;const e=[];let t;do t=dateFormatRegex.exec(r),t!==null&&e.push(t);while(t);return e}function matchNumberFormat(r){numberFormatRegex.lastIndex=0;const e=numberFormatRegex.exec(r);return e!==null?[e]:[]}function createTokens(r,e){const t=[];let n=0;for(let o=0;o<r.length;++o){const a=r[o];if(a.index!==n){const l=e.substr(n,a.index-n);t.push(formatToken(TokenType.FREE_TEXT,l))}a[0].startsWith("\\")?t.push(formatToken(TokenType.FREE_TEXT,a[0])):t.push(formatToken(TokenType.FORMAT,a[0])),n=a.index+a[0].length}const s=r[r.length-1];if(s.index+s[0].length<e.length){const o=e.substr(s.index+s[0].length,e.length);t.push(formatToken(TokenType.FREE_TEXT,o))}return t}function parseForDateTimeFormat(r){const e=matchDateFormat(r);if(!e.every(t=>isEscapeToken(t)))return{type:FormatExpressionType.DATE,tokens:createTokens(e,r)}}function parseForNumberFormat(r){const e=matchNumberFormat(r);if(!e.every(t=>isEscapeToken(t)))return{type:FormatExpressionType.NUMBER,tokens:createTokens(e,r)}}function isEscapeToken(r){return r[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function format(r,e,t,n){const s=t.stringifyDateTime(n.numberToSimpleDateTime(r),e);if(s!==void 0)return s;const o=t.stringifyDuration(numberToSimpleTime(r),e);if(o!==void 0)return o;const a=parseForNumberFormat(e);return a!==void 0?numberFormat(a.tokens,r):e}function padLeft(r,e){let t=`${r}`;for(;t.length<e;)t="0"+t;return t}function padRight(r,e){let t=`${r}`;for(;t.length<e;)t=t+"0";return t}function countChars(r,e){return r.split(e).length-1}function numberFormat(r,e){let t="";for(let n=0;n<r.length;++n){const s=r[n];if(s.type===TokenType.FREE_TEXT){t+=s.value;continue}const o=s.value.split("."),a=o[0],l=o[1]||"",u=o[1]?".":"",c=Number(e.toFixed(l.length)).toString().split(".");let d=c[0]||"",f=c[1]||"";if(a.length>d.length){const m=countChars(a.substr(0,a.length-d.length),"0");d=padLeft(d,m+d.length)}const C=countChars(l.substr(f.length,l.length-f.length),"0");f=padRight(f,C+f.length),t+=d+u+f}return t}function defaultStringifyDuration(r,e){const t=parseForDateTimeFormat(e);if(t===void 0)return;const n=t.tokens;let s="";for(const o of n){if(o.type===TokenType.FREE_TEXT){s+=o.value;continue}switch(o.value.toLowerCase()){case"h":case"hh":{s+=padLeft(r.hours,o.value.length),r.hours=0;break}case"[hh]":{s+=padLeft(r.hours,o.value.length-2),r.hours=0;break}case"m":case"mm":{s+=padLeft(r.minutes,o.value.length),r.minutes=0;break}case"[mm]":{s+=padLeft(r.minutes+60*r.hours,o.value.length-2),r.minutes=0,r.hours=0;break}case"s":case"ss":{s+=padLeft(Math.floor(r.seconds),o.value.length);break}default:{if(TIME_FORMAT_SECONDS_ITEM_REGEXP.test(o.value)){const a=Math.max(o.value.length-3,0);s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,a))/Math.pow(10,a)}`;continue}return}}}return s}function defaultStringifyDateTime(r,e){const t=parseForDateTimeFormat(e);if(t===void 0)return;const n=t.tokens;let s="",o=!1;const a=n.some(l=>l.type===TokenType.FORMAT&&(l.value==="a/p"||l.value==="A/P"||l.value==="am/pm"||l.value==="AM/PM"));for(let l=0;l<n.length;l++){const u=n[l];if(u.type===TokenType.FREE_TEXT){s+=u.value;continue}switch(u.value.toLowerCase()){case"h":case"hh":{o=!0,s+=padLeft(a?(r.hours+11)%12+1:r.hours,u.value.length);break}case"d":case"dd":{s+=padLeft(r.day,u.value.length);break}case"s":case"ss":{s+=padLeft(Math.floor(r.seconds),u.value.length);break}case"m":case"mm":{l+1<n.length&&n[l+1].value.startsWith(":")&&(o=!0),o?s+=padLeft(r.minutes,u.value.length):s+=padLeft(r.month,u.value.length),o=!0;break}case"yy":{s+=padLeft(r.year%100,u.value.length);break}case"yyyy":{s+=r.year;break}case"am/pm":case"a/p":{const[c,d]=u.value.split("/");s+=r.hours<12?c:d;break}default:{if(TIME_FORMAT_SECONDS_ITEM_REGEXP.test(u.value)){const c=u.value.length-3;s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,c))/Math.pow(10,c)}`;continue}return}}}return s}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const _rl="length",_hd=r=>parseInt(r,16),_pi=r=>parseInt(r,10),_nm=r=>(r+"").replace(/\-/g,""),_ss=(r,e,t)=>r.substr(e,t),_cp=r=>r.codePointAt(0)-65;function extractTime(r){return _nm(r)[_rl]===25?_hd(_ss(_nm(r),_hd("12"),_cp("F")))/(_hd(_ss(_nm(r),_cp("C"),_cp("Y")>>4))||(~~![][_rl]<<3)+1):0}function checkKeySchema(r){if(r=(r+"").replace(/\-/g,""),r[_rl]!==_cp("Z"))return!1;let e=0;return[[0,_cp("G")+1],[_cp("H"),_cp("H")-1],[_cp("G")+_cp("H"),_cp("G")]].reduce((t,[n,s],o)=>(t|=(_pi(`${_pi(_hd(_ss(r,e+n-(o===0?0:2),s+(o?2:0)))+(_hd(_ss(r,e+n+s,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),_cp("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const consoleMessages={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:r})=>`The license key for HyperFormula expired on ${r}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let _notified=!1;function checkLicenseKeyValidity(r){const e={template:"missing",vars:{}};if(r==="gpl-v3"||r==="internal-use-in-handsontable")e.template="valid";else if(typeof r=="string"&&checkKeySchema(r)){const[t,n,s]="14/01/2025".split("/"),o=Math.floor(new Date(`${n}/${t}/${s}`).getTime()/864e5),a=extractTime(r);e.vars.keyValidityDate=formatDate(new Date((a+1)*864e5)),o>a?e.template="expired":e.template="valid"}else r!==""&&(e.template="invalid");return!_notified&&e.template!=="valid"&&(console.warn(consoleMessages[e.template](e.vars)),_notified=!0),e.template}function formatDate(r){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()],n=r.getDate(),s=r.getFullYear();return`${t} ${n}, ${s}`}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CellContent;(function(r){class e{constructor(u){this.value=u,this.value=cloneNumber(this.value,fixNegativeZero(getRawValue(this.value)))}}r.Number=e;class t{constructor(u){this.value=u}}r.String=t;class n{constructor(u){this.value=u}}r.Boolean=n;class s{static getSingletonInstance(){return s.instance||(s.instance=new s),s.instance}}r.Empty=s;class o{constructor(u){this.formula=u}}r.Formula=o;class a{constructor(u,c){this.value=new CellError(u,c)}}r.Error=a})(CellContent||(CellContent={}));function isFormula(r){return r.startsWith("=")}function isBoolean(r){const e=r.toLowerCase();return e==="true"||e==="false"}function isError(r,e){const t=r.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class CellContentParser{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(e==null)return CellContent.Empty.getSingletonInstance();if(typeof e=="number")return isNumberOverflow(e)?new CellContent.Error(ErrorType.NUM,ErrorMessage.ValueLarge):new CellContent.Number(e);if(typeof e=="boolean")return new CellContent.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=timeToNumber({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),s=t+n;return s<0?new CellContent.Error(ErrorType.NUM,ErrorMessage.DateBounds):s%1===0?new CellContent.Number(new DateNumber(s,"Date()")):s<1?new CellContent.Number(new TimeNumber(s,"Date()")):new CellContent.Number(new DateTimeNumber(s,"Date()"))}else if(typeof e=="string"){if(isBoolean(e))return new CellContent.Boolean(e.toLowerCase()==="true");if(isFormula(e))return new CellContent.Formula(e);if(isError(e,this.config.errorMapping))return new CellContent.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),n=0,s;if(t.endsWith("%"))n=1,t=t.slice(0,t.length-1);else{const l=this.currencyMatcher(t);l!==void 0&&(n=2,[s,t]=l)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(o!==void 0){let l;return n===1?l=new PercentNumber(o/100):n===2?l=new CurrencyNumber(o,s):l=o,new CellContent.Number(l)}const a=this.dateHelper.dateStringToDateNumber(t);return a!==void 0?new CellContent.Number(a):new CellContent.String(e.startsWith("'")?e.slice(1):e)}}else throw new UnableToParseError(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ClipboardOperationType;(function(r){r[r.COPY=0]="COPY",r[r.CUT=1]="CUT"})(ClipboardOperationType||(ClipboardOperationType={}));var ClipboardCellType;(function(r){r[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR"})(ClipboardCellType||(ClipboardCellType={}));class Clipboard{constructor(e,t,n,s,o){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=s,this.content=o}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[simpleCellAddress(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class ClipboardOperations{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new Clipboard(e,t,n,ClipboardOperationType.CUT)}copy(e,t,n){const s=[];for(let o=0;o<n;++o){s[o]=[];for(let a=0;a<t;++a){const l=this.operations.getClipboardCell(simpleCellAddress(e.sheet,e.col+a,e.row+o));s[o].push(l)}}this.clipboard=new Clipboard(e,t,n,ClipboardOperationType.COPY,s)}abortCut(){this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(invalidSimpleCellAddress(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new InvalidArgumentsError("a valid target address.");const t=AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===ClipboardOperationType.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===ClipboardOperationType.COPY}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InternalNamedExpression{constructor(e,t,n,s){this.displayName=e,this.address=t,this.added=n,this.options=s}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new InternalNamedExpression(this.displayName,this.address,this.added,this.options)}}class WorkbookStore{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class WorksheetStore{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class NamedExpressions{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new WorkbookStore,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,s;return t===void 0?this.workbookStore.isNameAvailable(e):(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&s!==void 0?s:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var n;return t===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e))!==null&&s!==void 0?s:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.has(e))!==null&&s!==void 0?s:!1}isNameValid(e){const t=new RegExp(`^${CELL_REFERENCE_PATTERN}$`),n=new RegExp(`^${R1C1_CELL_REFERENCE_PATTERN}$`),s=new RegExp(`^${NAMED_EXPRESSION_PATTERN}$`);return t.test(e)||n.test(e)?!1:s.test(e)}addNamedExpression(e,t,n){const s=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let o=s.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=n):(o=new InternalNamedExpression(e,this.nextAddress(),!0,n),s.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,t){const n=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return(n=this.worksheetStoreOrCreate(t).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new InternalNamedExpression(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;t===void 0?n=this.workbookStore:n=this.worksheetStore(t);const s=n==null?void 0:n.get(e);if(n===void 0||s===void 0||!s.added)throw Error("Named expression does not exist");n.remove(e),n instanceof WorksheetStore&&n.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(s.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,n)=>{t.getAllNamedExpressions().forEach(s=>{e.push({expression:s,scope:n})})}),e}getAllNamedExpressionsForScope(e){var t,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new WorksheetStore,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return simpleCellAddress(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const doesContainRelativeReferences=r=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case AstNodeType.CELL_REFERENCE:return!r.reference.isAbsolute();case AstNodeType.CELL_RANGE:case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:return!r.start.isAbsolute();case AstNodeType.NAMED_EXPRESSION:return!1;case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:return doesContainRelativeReferences(r.value);case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:return doesContainRelativeReferences(r.left)||doesContainRelativeReferences(r.right);case AstNodeType.PARENTHESIS:return doesContainRelativeReferences(r.expression);case AstNodeType.FUNCTION_CALL:return r.args.some(e=>doesContainRelativeReferences(e));case AstNodeType.ARRAY:return r.args.some(e=>e.some(t=>doesContainRelativeReferences(t)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Transformer{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s,o]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),a=t.rememberNewAst(s);n.setFormula(a),n.setAddress(o)}}transformSingleAst(e,t){const n=this.transformAst(e,t),s=this.fixNodeAddress(t);return[n,s]}transformAst(e,t){switch(e.type){case AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case AstNodeType.EMPTY:case AstNodeType.ERROR:case AstNodeType.NUMBER:case AstNodeType.NAMED_EXPRESSION:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.STRING:return e;case AstNodeType.PERCENT_OP:case AstNodeType.MINUS_UNARY_OP:case AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,t))});case AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(s=>this.transformAst(s,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof CellAddress?Object.assign(Object.assign({},e),{reference:n}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddColumnsTransformer extends Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const s=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=s.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s===ErrorType.REF||o===ErrorType.REF?ErrorType.REF:s||o?[s||e,o||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddRowsTransformer extends Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const s=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=s.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):s.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s===ErrorType.REF||o===ErrorType.REF?ErrorType.REF:s||o?[s||e,o||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CleanOutOfScopeDependenciesTransformer extends Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?ErrorType.REF:!1}transformCellRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}transformColumnRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}transformRowRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MoveCellsTransformer extends Transformer{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s,this.dependentFormulaTransformer=new DependentFormulaTransformer(e,t,n,s)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return simpleCellAddress(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof CellAddress){const s=e.toSimpleCellAddress(t);if(n.addressInRange(s))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const s=this.sourceRange;if(e instanceof CellAddress&&t instanceof CellAddress){const o=e.toSimpleCellAddress(n),a=t.toSimpleCellAddress(n);if(s.addressInRange(o)&&s.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class DependentFormulaTransformer extends Transformer{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s&&o?[s,o]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveColumnsTransformer extends Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart)return!1;if(s.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(s.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=absoluteSheetReference(e,n);let o=e,a=t;if(this.columnsSpan.sheet===s){const c=e.toSimpleColumnAddress(n),d=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=c.col&&this.columnsSpan.columnEnd>=d.col)return ErrorType.REF;c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-c.col+1)),d.col>=this.columnsSpan.columnStart&&d.col<=this.columnsSpan.columnEnd&&(a=t.shiftedByColumns(-(d.col-this.columnsSpan.columnStart+1)))}const l=this.transformCellAddress(o,n),u=this.transformCellAddress(a,n);if(l===!1&&u===!1)return[o,a];if(l===ErrorType.REF||u===ErrorType.REF)throw Error("Cannot happen");return[l||o,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveRowsTransformer extends Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart)return!1;if(s.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(s.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return ErrorType.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=absoluteSheetReference(e,n);let o=e,a=t;if(this.rowsSpan.sheet===s){const c=e.toSimpleRowAddress(n),d=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=c.row&&this.rowsSpan.rowEnd>=d.row)return ErrorType.REF;c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-c.row+1)),d.row>=this.rowsSpan.rowStart&&d.row<=this.rowsSpan.rowEnd&&(a=t.shiftedByRows(-(d.row-this.rowsSpan.rowStart+1)))}const l=this.transformCellAddress(o,n),u=this.transformCellAddress(a,n);return l===!1&&u===!1?[o,a]:l===ErrorType.REF||u===ErrorType.REF?ErrorType.REF:[l||o,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveSheetTransformer extends Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(s)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?ErrorType.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function validateAsSheet(r){if(!Array.isArray(r))throw new InvalidArgumentsError("an array of arrays.");for(let e=0;e<r.length;e++)if(!Array.isArray(r[e]))throw new InvalidArgumentsError("an array of arrays.")}function findBoundaries(r){let e=0,t=0,n=0;for(let o=0;o<r.length;o++){let a=0;for(let l=0;l<r[o].length;l++){const u=r[o][l];u!=null&&(a=l+1,++n)}e=Math.max(e,a),a>0&&(t=o+1)}const s=e*t;return{height:t,width:e,fill:s===0?0:n/s}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveRowsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class AddRowsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class AddColumnsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class RemoveColumnsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Operations{constructor(e,t,n,s,o,a,l,u,c){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=s,this.parser=o,this.stats=a,this.lazilyTransformingAstService=l,this.namedExpressions=u,this.arraySizePredictor=c,this.changes=ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const s=this.doRemoveRows(n);s&&t.push(s)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const s=this.doRemoveColumns(n);s&&t.push(s)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const s=new RemoveSheetTransformer(e);s.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(s)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(s=>this.removeNamedExpression(s.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:n}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,findBoundaries(n)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,s){const o=RowsSpan.fromNumberOfRows(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),s<t&&(t+=n);const a=simpleCellAddress(e,0,t),l=simpleCellAddress(e,0,s);this.moveCells(a,Number.POSITIVE_INFINITY,n,l);const u=RowsSpan.fromNumberOfRows(e,t,n);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,s){const o=ColumnsSpan.fromNumberOfColumns(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),s<t&&(t+=n);const a=simpleCellAddress(e,t,0),l=simpleCellAddress(e,s,0);this.moveCells(a,n,Number.POSITIVE_INFINITY,l);const u=ColumnsSpan.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,s){this.ensureItIsPossibleToMoveCells(e,t,n,s);const o=AbsoluteCellRange.spanFrom(e,t,n),a=AbsoluteCellRange.spanFrom(s,t,n),l=s.col-e.col,u=s.row-e.row,c=s.sheet,d=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);const C=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(C,l,u,c);let m=0;this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const v=new MoveCellsTransformer(o,l,u,c);v.performEagerTransformations(this.dependencyGraph,this.parser),m=this.lazilyTransformingAstService.addTransformation(v)}),this.dependencyGraph.moveCells(o,l,u,c);const E=this.updateNamedExpressionsForMovedCells(e,t,n,s);return{version:m,overwrittenCellsData:d,addedGlobalNamedExpressions:E}}setRowOrder(e,t){const n=[];let s=[];for(const[o,a]of t)if(o!==a){const l=AbsoluteCellRange.spanFrom({sheet:e,col:0,row:o},1/0,1),u=this.getRangeClipboardCells(l);s=s.concat(u),n.push(u.map(([{sheet:c,col:d},f])=>[{sheet:c,col:d,row:a},f]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),s}setColumnOrder(e,t){const n=[];let s=[];for(const[o,a]of t)if(o!==a){const l=AbsoluteCellRange.spanFrom({sheet:e,col:o,row:0},1,1/0),u=this.getRangeClipboardCells(l);s=s.concat(u),n.push(u.map(([{sheet:c,col:d,row:f},C])=>[{sheet:c,col:a,row:f},C]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),s}addNamedExpression(e,t,n,s){const o=this.namedExpressions.addNamedExpression(e,n,s);this.storeNamedExpressionInCell(o.address,t),this.adjustNamedExpressionEdges(o,e,n)}restoreNamedExpression(e,t,n){const s=e.displayName;this.restoreCell(e.address,t);const o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,s,n)}changeNamedExpressionExpression(e,t,n,s){const o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new NamedExpressionDoesNotExistError(e);const a=o.copy();o.options=s;const l=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[a,l]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(n.displayName,t);const s=this.getClipboardCell(n.address);if(t!==void 0){const o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,s]}ensureItIsPossibleToMoveCells(e,t,n,s){if(invalidSimpleCellAddress(e)||!(isPositiveInteger$1(t)&&isPositiveInteger$1(n)||isRowOrColumnRange(e,t,n))||invalidSimpleCellAddress(s)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(s.sheet))throw new InvalidArgumentsError("a valid range of cells to move.");const o=AbsoluteCellRange.spanFrom(e,t,n),a=AbsoluteCellRange.spanFrom(s,t,n);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new TargetLocationHasArrayError}restoreClipboardCells(e,t){const n=[];for(const[s,o]of t)if(this.restoreCell(s,o),o.type===ClipboardCellType.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(o.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,s,a))}return n}restoreCell(e,t){switch(t.type){case ClipboardCellType.VALUE:{this.setValueToCell(t,e);break}case ClipboardCellType.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case ClipboardCellType.EMPTY:{this.setCellEmpty(e);break}case ClipboardCellType.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof EmptyCellVertex)return[e,{type:ClipboardCellType.EMPTY}];if(t instanceof ValueCellVertex)return[e,Object.assign({type:ClipboardCellType.VALUE},t.getValues())];if(t instanceof FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof ParsingErrorVertex)return[e,{type:ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof EmptyCellVertex)return{type:ClipboardCellType.EMPTY};if(t instanceof ValueCellVertex)return Object.assign({type:ClipboardCellType.VALUE},t.getValues());if(t instanceof ArrayVertex){const n=t.getArrayCellValue(e);return n===EmptyValue?{type:ClipboardCellType.EMPTY}:{type:ClipboardCellType.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof FormulaCellVertex)return{type:ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof ParsingErrorVertex)return{type:ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),s=new Array(t);for(let o=0;o<t;o++){s[o]=new Array(n);for(let a=0;a<n;a++){const l=simpleCellAddress(e,a,o);s[o][a]=this.getClipboardCell(l)}}return s}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),s=this.getOldContent(e);if(n instanceof CellContent.Formula){const o=this.parser.parse(n.formula,e),{ast:a,errors:l}=o;if(l.length>0)this.setParsingErrorToCell(n.formula,l,e);else try{const u=this.arraySizePredictor.checkArraySize(a,e);if(u.width<=0||u.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,u,o)}catch(u){if(!u.message)throw u;const c={type:ParsingErrorType.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[c],e)}}else n instanceof CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return s}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let s=0;s<t[n].length;s++){const o=simpleCellAddress(e,s,n);this.setCellContent(o,t[n][s])}}setParsingErrorToCell(e,t,n){const s=this.dependencyGraph.getCellValue(n),o=new ParsingErrorVertex(t,e),a=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(getRawValue(s),n),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(o.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}){const l=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,n,absolutizeDependencies(a,e),t,s,o);this.columnSearch.remove(getRawValue(l),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}setValueToCell(e,t){const n=this.dependencyGraph.getCellValue(t),s=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(getRawValue(n),getRawValue(e.parsedValue),t),this.columnSearch.applyChanges(s.getChanges().filter(o=>!equalSimpleCellAddress(o.address,t))),this.changes.addAll(s),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(getRawValue(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(EmptyValue,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}=this.parser.fetchCachedResult(e),l=absolutizeDependencies(a,t),[u]=new CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(u);const c=filterDependenciesOutOfScope(l),d=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,u,c,d,s,o)}rowEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getHeight(t);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(s.getChanges());let o=0;return this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const a=new RemoveRowsTransformer(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(s.getChanges()),this.columnSearch.removeColumns(e);let o=0;return this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const a=new RemoveColumnsTransformer(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const n=new AddRowsTransformer(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const n=t.getFormula(this.lazilyTransformingAstService),s=t.getAddress(this.lazilyTransformingAstService),o=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(o,s)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const s=new AddColumnsTransformer(e);s.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(s)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getWidth(t);return e>=n}adjustNamedExpressionEdges(e,t,n){if(n===void 0)return;const{vertex:s,id:o}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=o??this.dependencyGraph.graph.getNodeId(s),l=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:u,id:c}=this.dependencyGraph.fetchCellOrCreateEmpty(l.address),d=c??this.dependencyGraph.graph.getNodeId(u);for(const f of this.dependencyGraph.graph.adjacentNodes(u))if(f instanceof FormulaCellVertex&&f.getAddress(this.lazilyTransformingAstService).sheet===n){const C=f.getFormula(this.lazilyTransformingAstService),m=f.getAddress(this.lazilyTransformingAstService),{dependencies:E}=this.parser.fetchCachedResultForAst(C);for(const v of absolutizeDependencies(E,m))v instanceof NamedExpressionDependency&&v.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(d,f),this.dependencyGraph.graph.addEdge(a,f))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof CellContent.Formula){const s=this.parser.parse(n.formula,simpleCellAddress(-1,0,0));if(doesContainRelativeReferences(s.ast))throw new NoRelativeAddressesAllowedError;const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(e,o,absolutizeDependencies(u,e),ArraySize.scalar(),a,l)}else n instanceof CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,s){if(e.sheet===s.sheet)return[];const o=[],a=AbsoluteCellRange.spanFrom(s,t,n);for(const l of a.addresses(this.dependencyGraph)){const u=this.addressMapping.fetchCell(l);if(u instanceof FormulaCellVertex&&l.sheet!==e.sheet){const c=u.getFormula(this.lazilyTransformingAstService),{dependencies:d}=this.parser.fetchCachedResultForAst(c);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,l,d))}}return o}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const s=[],o=this.addressMapping.fetchCell(t);for(const a of absolutizeDependencies(n,t)){if(!(a instanceof NamedExpressionDependency))continue;const l=a.name,u=this.dependencyGraph.fetchNamedExpressionVertex(l,e).vertex,d=this.namedExpressions.isExpressionInScope(l,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(l,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(l,u,s);d!==u&&(this.dependencyGraph.graph.removeEdgeIfExists(u,o),this.dependencyGraph.graph.addEdge(d,o))}return s}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let s=this.namedExpressions.namedExpressionForScope(e);if(s===void 0)if(s=this.namedExpressions.addNamedExpression(e),n.push(s.normalizeExpressionName()),t instanceof FormulaCellVertex){const o=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:l,hasStructuralChangeFunction:u,dependencies:c}=o;this.dependencyGraph.setFormulaToCell(s.address,a,absolutizeDependencies(c,s.address),ArraySize.scalar(),l,u)}else t instanceof EmptyCellVertex?this.setCellEmpty(s.address):t instanceof ValueCellVertex&&this.setValueToCell(t.getValues(),s.address);return this.dependencyGraph.fetchCellOrCreateEmpty(s.address).vertex}}function normalizeRemovedIndexes(r){if(r.length<=1)return r;const e=[...r].sort(([s],[o])=>s-o),t=e.reduce((s,[o,a])=>{const l=s[s.length-1],u=l[0]+l[1];return o<=u?l[1]+=Math.max(0,a-(u-o)):s.push([o,a]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]-=n,n+=t[s][1];return t}function normalizeAddedIndexes(r){if(r.length<=1)return r;const e=[...r].sort(([s],[o])=>s-o),t=e.reduce((s,[o,a])=>{const l=s[s.length-1];return o===l[0]?l[1]=Math.max(l[1],a):s.push([o,a]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]+=n,n+=t[s][1];return t}function isPositiveInteger$1(r){return Number.isInteger(r)&&r>0}function isRowOrColumnRange(r,e,t){return r.row===0&&isPositiveInteger$1(e)&&t===Number.POSITIVE_INFINITY||r.col===0&&isPositiveInteger$1(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BaseUndoEntry{}class RemoveRowsUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class MoveCellsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o,a,l){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=s,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=a,this.version=l}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class AddRowsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class SetRowOrderUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class SetColumnOrderUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class SetSheetContentUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class MoveRowsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=s,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class MoveColumnsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=s,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class AddColumnsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class RemoveColumnsUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class AddSheetUndoEntry extends BaseUndoEntry{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class RemoveSheetUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=s,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class RenameSheetUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class ClearSheetUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class SetCellContentsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class PasteUndoEntry extends BaseUndoEntry{constructor(e,t,n,s){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=s}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class AddNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n,s){super(),this.name=e,this.newContent=t,this.scope=n,this.options=s}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class RemoveNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class ChangeNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=s,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class BatchUndoEntry extends BaseUndoEntry{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class UndoRedo{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new BatchUndoEntry}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const o=n[s];this.operations.addRows(new AddRowsCommand(t,[[o.rowFrom,o.rowCount]]));for(const{address:a,cellType:l}of o.removedCells)this.operations.restoreCell(a,l);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const o=n[s];this.operations.addColumns(new AddColumnsCommand(t,[[o.columnFrom,o.columnCount]]));for(const{address:a,cellType:l}of o.removedCells)this.operations.restoreCell(a,l);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeRows(new RemoveRowsCommand(e.command.sheet,[[s.rowStart,s.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeColumns(new RemoveColumnsCommand(e.command.sheet,[[s.columnStart,s.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const n=t.address,[s,o]=t.oldContent;equalSimpleCellAddress(n,s)||this.operations.setCellEmpty(n),this.operations.restoreCell(s,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}for(const[s,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(s,o,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,s=n.length,o=n[0].length;for(let a=0;a<s;++a)for(let l=0;l<o;++l){const u=simpleCellAddress(t.sheet,t.col+l,t.row+a);this.operations.restoreCell(u,n[a][l])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[s,o]=n;this.operations.setFormulaToCellFromCache(o,s)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CrudOperations{constructor(e,t,n,s,o,a,l,u,c,d){this.operations=t,this.undoRedo=n,this.clipboardOperations=s,this.dependencyGraph=o,this.columnSearch=a,this.parser=l,this.cellContentParser=u,this.lazilyTransformingAstService=c,this.namedExpressions=d,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new AddRowsUndoEntry(n))}removeRows(e,...t){const n=new RemoveRowsCommand(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeRows(n);this.undoRedo.saveOperation(new RemoveRowsUndoEntry(n,s))}addColumns(e,...t){const n=new AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new AddColumnsUndoEntry(n))}removeColumns(e,...t){const n=new RemoveColumnsCommand(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeColumns(n);this.undoRedo.saveOperation(new RemoveColumnsUndoEntry(n,s))}moveCells(e,t,n,s){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:a,addedGlobalNamedExpressions:l}=this.operations.moveCells(e,t,n,s);this.undoRedo.saveOperation(new MoveCellsUndoEntry(e,t,n,s,a,l,o))}moveRows(e,t,n,s){this.ensureItIsPossibleToMoveRows(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,t,n,s);this.undoRedo.saveOperation(new MoveRowsUndoEntry(e,t,n,s,o))}moveColumns(e,t,n,s){this.ensureItIsPossibleToMoveColumns(e,t,n,s),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,t,n,s);this.undoRedo.saveOperation(new MoveColumnsUndoEntry(e,t,n,s,o))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!isPositiveInteger(t))throw new InvalidArgumentsError("width to be positive integer.");if(!isPositiveInteger(n))throw new InvalidArgumentsError("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=AbsoluteCellRange.spanFrom(e,t.width,t.height),s=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new PasteUndoEntry(e,s,t.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new AddSheetUndoEntry(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:s,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new RemoveSheetUndoEntry(t,e,n,o,s))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const n=this.operations.renameSheet(e,t);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new RenameSheetUndoEntry(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new ClearSheetUndoEntry(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let s=0;s<t.length;s++)if(!(t[s]instanceof Array))throw new InvalidArgumentsError("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let s=0;s<t.length;s++)for(let o=0;o<t[s].length;o++){const a={sheet:e.sheet,row:e.row+s,col:e.col+o},l=t[s][o];this.clipboardOperations.abortCut();const u=this.operations.setCellContent(a,l);n.push({address:a,newContent:l,oldContent:u})}this.undoRedo.saveOperation(new SetCellContentsUndoEntry(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),validateAsSheet(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new SetSheetContentUndoEntry(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new SetRowOrderUndoEntry(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const o=AbsoluteCellRange.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new SetColumnOrderUndoEntry(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const o=AbsoluteCellRange.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==s)throw new InvalidArgumentsError(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const o=[];for(let a=0;a<s;a++)t[a]!==a&&o.push([a,t[a]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,s){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new AddNamedExpressionUndoEntry(e,t,n,s))}changeNamedExpressionExpression(e,t,n,s){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[o,a]=this.operations.changeNamedExpressionExpression(e,n,t,s);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new ChangeNamedExpressionUndoEntry(o,n,a,t,s))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,s]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new RemoveNamedExpressionUndoEntry(n,s,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.dependencyGraph.getSheetHeight(e),s=t.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+s>this.maxRows)throw new SheetSizeLimitExceededError;for(const[o,a]of t)if(!isNonnegativeInteger(o)||!isPositiveInteger(a))throw new InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,s]of t){const o=n+s-1;if(!isNonnegativeInteger(n)||!isNonnegativeInteger(o))throw new InvalidArgumentsError("starting and ending row to be nonnegative.");if(o<n)throw new InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.dependencyGraph.getSheetWidth(e),s=t.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+s>this.maxColumns)throw new SheetSizeLimitExceededError;for(const[o,a]of t)if(!isNonnegativeInteger(o)||!isPositiveInteger(a))throw new InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,s]of t){const o=n+s-1;if(!isNonnegativeInteger(n)||!isNonnegativeInteger(o))throw new InvalidArgumentsError("starting and ending column to be nonnegative.");if(o<n)throw new InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,n,s){this.ensureItIsPossibleToAddRows(e,[s,n]);const o=simpleCellAddress(e,0,t),a=simpleCellAddress(e,0,s);if(!this.sheetMapping.hasSheetWithId(e)||invalidSimpleCellAddress(o)||invalidSimpleCellAddress(a)||!isPositiveInteger(n)||s<=t+n&&s>=t)throw new InvalidArgumentsError("a valid range of rows to move.");const l=this.dependencyGraph.getSheetWidth(e),u=AbsoluteCellRange.spanFrom(o,l,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(RowsSpan.fromNumberOfRows(e,s-1,2)))throw new TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,n,s){this.ensureItIsPossibleToAddColumns(e,[s,n]);const o=simpleCellAddress(e,t,0),a=simpleCellAddress(e,s,0);if(!this.sheetMapping.hasSheetWithId(e)||invalidSimpleCellAddress(o)||invalidSimpleCellAddress(a)||!isPositiveInteger(n)||s<=t+n&&s>=t)throw new InvalidArgumentsError("a valid range of columns to move.");const l=this.dependencyGraph.getSheetHeight(e),u=AbsoluteCellRange.spanFrom(o,n,l);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(ColumnsSpan.fromNumberOfColumns(e,s-1,2)))throw new TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.sheetMapping.get(t);if(n!==void 0&&n!==e)throw new SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if(invalidSimpleCellAddress(e))throw new InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=findBoundaries(t),s=AbsoluteCellRange.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(s);for(const o of s.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,t){const n=findBoundaries(t),s=AbsoluteCellRange.spanFrom(simpleCellAddress(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(s)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,n){const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map(([l,u])=>l).sort((l,u)=>l-u),a=t.map(([l,u])=>u).sort((l,u)=>l-u);for(let l=0;l<o.length;l++){if(!isNonnegativeInteger(o[l])||o[l]>=s)throw new InvalidArgumentsError(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(o[l]===o[l+1])throw new InvalidArgumentsError(`source ${n} numbers to be unique.`);if(o[l]!==a[l])throw new InvalidArgumentsError(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof CellContent.Formula){const n=this.parser.parse(t.formula,simpleCellAddress(-1,0,0));if(doesContainRelativeReferences(n.ast))throw new NoRelativeAddressesAllowedError}}}function isPositiveInteger(r){return Number.isInteger(r)&&r>0}function isNonnegativeInteger(r){return Number.isInteger(r)&&r>=0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Evaluator{constructor(e,t,n,s,o,a){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=s,this.dependencyGraph=o,this.columnSearch=a}run(){this.stats.start(StatType.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(StatType.TOP_SORT),this.stats.measure(StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=ContentChanges.empty();return this.stats.measure(StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof FormulaVertex){const s=n.isComputed()?n.getCellValue():void 0,o=this.recomputeFormulaVertexValue(n);if(o!==s){const a=n.getAddress(this.lazilyTransformingAstService);return t.addChange(o,a),this.columnSearch.change(getRawValue(s),getRawValue(o),a),!0}return!1}else return n instanceof RangeVertex&&n.clearCache(),!0},n=>{if(n instanceof RangeVertex)n.clearCache();else if(n instanceof FormulaVertex){const s=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(getRawValue(n.valueOrUndef()),s);const o=new CellError(ErrorType.CYCLE,void 0,n);n.setCellValue(o),t.addChange(o,s)}})}),t}runAndForget(e,t,n){const s=[];for(const a of absolutizeDependencies(n,t))if(a instanceof AbsoluteCellRange){const l=a;if(this.dependencyGraph.getRange(l.start,l.end)===void 0){const u=new RangeVertex(l);this.dependencyGraph.rangeMapping.setRange(u),s.push(u)}}const o=this.evaluateAstToCellValue(e,new InterpreterState(t,this.config.useArrayArithmetic));return s.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),o}recomputeFormulas(e,t){e.forEach(n=>{n instanceof FormulaVertex&&n.setCellValue(new CellError(ErrorType.CYCLE,void 0,n))}),t.forEach(n=>{if(n instanceof FormulaVertex){const s=this.recomputeFormulaVertexValue(n),o=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(getRawValue(s),o)}else n instanceof RangeVertex&&n.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),s=this.evaluateAstToCellValue(n,new InterpreterState(t,this.config.useArrayArithmetic,e));return e.setCellValue(s)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof SimpleRangeValue?n:n===EmptyValue&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ExportedCellChange{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class ExportedNamedExpressionChange{constructor(e,t){this.name=e,this.newValue=t}}class Exporter{constructor(e,t,n,s){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=s}exportChange(e){const t=e.value,n=e.address;if(n.sheet===NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){const s=this.namedExpressions.namedExpressionInAddress(n.row);if(!s)throw new Error("Missing named expression");return new ExportedNamedExpressionChange(s.displayName,this.exportScalarOrRange(t))}else if(t instanceof SimpleRangeValue){const s=[];for(const[o,a]of t.entriesFromTopLeftCorner(n))s.push(new ExportedCellChange(a,this.exportValue(o)));return s}else return new ExportedCellChange(n,this.exportValue(t))}exportValue(e){return e instanceof SimpleRangeValue?this.detailedError(new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)):this.config.smartRounding&&isExtendedNumber(e)?this.cellValueRounding(getRawValue(e)):e instanceof CellError?this.detailedError(e):e===EmptyValue?null:getRawValue(e)}exportScalarOrRange(e){return e instanceof SimpleRangeValue?e.rawData().map(t=>t.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var t,n;let s;const o=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?s=(n=this.namedExpressions.namedExpressionInAddress(o.row))===null||n===void 0?void 0:n.displayName:s=simpleCellAddressToString(this.sheetIndexMapping,o,-1)),new DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),s)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class GraphBuilder{constructor(e,t,n,s,o,a){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=s,this.stats=o,this.arraySizePredictor=a,this.buildStrategy=new SimpleStrategy(e,t,n,o,s,a)}buildGraph(e,t){const n=t.measure(StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((t,n)=>{this.dependencyGraph.processCellDependencies(t,n)})}}class SimpleStrategy{constructor(e,t,n,s,o,a){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=s,this.cellContentParser=o,this.arraySizePredictor=a}run(e){const t=new Map;for(const n in e){const s=this.dependencyGraph.getSheetId(n),o=e[n];for(let a=0;a<o.length;++a){const l=o[a];for(let u=0;u<l.length;++u){const c=l[u],d=simpleCellAddress(s,u,a),f=this.cellContentParser.parse(c);if(f instanceof CellContent.Formula){const C=this.stats.measure(StatType.PARSER,()=>this.parser.parse(f.formula,d));if(C.errors.length>0){this.shrinkArrayIfNeeded(d);const m=new ParsingErrorVertex(C.errors,f.formula);this.dependencyGraph.addVertex(d,m)}else{this.shrinkArrayIfNeeded(d);const m=this.arraySizePredictor.checkArraySize(C.ast,d);if(m.isScalar()){const E=new FormulaCellVertex(C.ast,d,0);t.set(E,absolutizeDependencies(C.dependencies,d)),this.dependencyGraph.addVertex(d,E),C.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(E),C.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(E)}else{const E=new ArrayVertex(C.ast,d,new ArraySize(m.width,m.height));t.set(E,absolutizeDependencies(C.dependencies,d)),this.dependencyGraph.addArrayVertex(d,E)}}}else if(!(f instanceof CellContent.Empty)){this.shrinkArrayIfNeeded(d);const C=new ValueCellVertex(f.value,c);this.columnIndex.add(getRawValue(f.value),d),this.dependencyGraph.addVertex(d,C)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const LICENSE_STATUS_MAP=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class VersionPlugin extends FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:s}=this.config;let o;return LICENSE_STATUS_MAP.has(s)?o=LICENSE_STATUS_MAP.get(s):LICENSE_STATUS_MAP.has(n)?o=LICENSE_STATUS_MAP.get(n):n==="valid"&&(o=s.slice(-5)),`HyperFormula v${HyperFormula.version}, ${o}`})}}VersionPlugin.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function validateAndReturnMetadataFromName(r,e){var t;let n=e.implementedFunctions[r];const s=(t=e.aliases)===null||t===void 0?void 0:t[r];if(s!==void 0){if(n!==void 0)throw new AliasAlreadyExisting(r,e.name);n=e.implementedFunctions[s]}if(n===void 0)throw FunctionPluginValidationError.functionNotDeclaredInPlugin(r,e.name);return n}class FunctionRegistry{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)FunctionRegistry.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(FunctionRegistry.plugins);for(const[t,n]of FunctionRegistry.protectedFunctions())FunctionRegistry.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,validateAndReturnMetadataFromName(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{t.has(n)&&HyperFormula.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,t)})}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){const s=validateAndReturnMetadataFromName(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,s))n.set(t,e);else throw FunctionPluginValidationError.functionMethodNotFound(s,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[n,s]of this.instancePlugins.entries()){let o=t.find(c=>c instanceof s);o===void 0&&(o=new s(e),t.push(o));const a=validateAndReturnMetadataFromName(n,s),l=a.method;this.functions.set(n,[l,o]);const u=a.arraySizeMethod;u!==void 0&&this.arraySizeFunctions.set(n,[u,o])}}getFunctionPlugin(e){if(!FunctionRegistry.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(o,a)=>s[n](o,a)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(o,a)=>s[n](o,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)FunctionRegistry.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}FunctionRegistry.plugins=new Map;FunctionRegistry._protectedPlugins=new Map([["VERSION",VersionPlugin],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CriterionType;(function(r){r.GREATER_THAN="GREATER_THAN",r.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",r.LESS_THAN="LESS_THAN",r.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",r.NOT_EQUAL="NOT_EQUAL",r.EQUAL="EQUAL"})(CriterionType||(CriterionType={}));const buildCriterion=(r,e)=>({operator:r,value:e});class CriterionBuilder{constructor(e){var t,n,s,o;this.trueString=(n=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(o=(s=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||s===void 0?void 0:s.toLowerCase())!==null&&o!==void 0?o:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,t);if(n!==void 0)return{raw:e,lambda:buildCriterionLambda(n,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return buildCriterion(CriterionType.EQUAL,e);if(typeof e=="string"){const n=ANY_CRITERION_REGEX.exec(e);let s,o;n?(o=StrToCriterionType(n[1]),s=n[2]):(o=CriterionType.EQUAL,s=e);const a=t.coerceToMaybeNumber(s),l=s.toLowerCase()===this.trueString?!0:s.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(s==="")return buildCriterion(o,null);if(a===void 0){if(o===CriterionType.EQUAL||o===CriterionType.NOT_EQUAL)return buildCriterion(o,l??s)}else return buildCriterion(o,getRawValue(a))}}}const ANY_CRITERION_REGEX=/([<>=]+)(.*)/;function StrToCriterionType(r){switch(r){case">":return CriterionType.GREATER_THAN;case">=":return CriterionType.GREATER_THAN_OR_EQUAL;case"<":return CriterionType.LESS_THAN;case"<=":return CriterionType.LESS_THAN_OR_EQUAL;case"<>":return CriterionType.NOT_EQUAL;case"=":return CriterionType.EQUAL;default:return}}const buildCriterionLambda=(r,e)=>{switch(r.operator){case CriterionType.GREATER_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>0:t=>!1;case CriterionType.GREATER_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>=0:t=>!1;case CriterionType.LESS_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<0:t=>!1;case CriterionType.LESS_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<=0:t=>!1;case CriterionType.EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)===0;if(typeof t=="string"){if(t==="")return!1;const n=e.coerceToMaybeNumber(t);return n===void 0?!1:e.floatCmp(n,r.value)===0}else return!1}:typeof r.value=="string"?e.eqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t=="boolean"&&t===r.value:t=>t===EmptyValue;case CriterionType.NOT_EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)!==0;if(typeof t=="string"){if(t==="")return!0;const n=e.coerceToMaybeNumber(t);return n===void 0?!0:e.floatCmp(n,r.value)!==0}else return!0}:typeof r.value=="string"?e.neqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t!="boolean"||t!==r.value:t=>t!==EmptyValue}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Interpreter{constructor(e,t,n,s,o,a,l,u,c,d){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=s,this.arithmeticHelper=o,this.functionRegistry=a,this.namedExpressions=l,this.serialization=u,this.arraySizePredictor=c,this.dateTimeHelper=d,this.equalOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.eq,f,C),this.notEqualOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.neq,f,C),this.greaterThanOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.gt,f,C),this.lessThanOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.lt,f,C),this.greaterThanOrEqualOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.geq,f,C),this.lessThanOrEqualOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.leq,f,C),this.concatOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.concat,coerceScalarToString(f),coerceScalarToString(C)),this.plusOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(C)),this.minusOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(C)),this.timesOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(C)),this.powerOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(C)),this.divOp=(f,C)=>binaryErrorWrapper(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(C)),this.unaryMinusOp=f=>unaryErrorWrapper(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.percentOp=f=>unaryErrorWrapper(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.unaryPlusOp=f=>this.arithmeticHelper.unaryPlus(f),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new CriterionBuilder(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(isExtendedNumber(n)){if(isNumberOverflow(getRawValue(n)))return new CellError(ErrorType.NUM,ErrorMessage.NaN);n=cloneNumber(n,fixNegativeZero(getRawValue(n)))}return n instanceof SimpleRangeValue&&n.height()===1&&n.width()===1&&([[n]]=n.data),wrapperForRootVertex(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case AstNodeType.EMPTY:return EmptyValue;case AstNodeType.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return invalidSimpleCellAddress(n)?new CellError(ErrorType.REF,ErrorMessage.BadRef):this.dependencyGraph.getCellValue(n)}case AstNodeType.NUMBER:case AstNodeType.STRING:return e.value;case AstNodeType.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,s,t)}case AstNodeType.EQUALS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,s,t)}case AstNodeType.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,s,t)}case AstNodeType.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,s,t)}case AstNodeType.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,s,t)}case AstNodeType.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,s,t)}case AstNodeType.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,s,t)}case AstNodeType.PLUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,s,t)}case AstNodeType.MINUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,s,t)}case AstNodeType.TIMES_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,s,t)}case AstNodeType.POWER_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,s,t)}case AstNodeType.DIV_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,s,t)}case AstNodeType.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case AstNodeType.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case AstNodeType.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case AstNodeType.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!FunctionRegistry.functionIsProtected(e.procedureName))return new CellError(ErrorType.LIC,ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new InterpreterState(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new CellError(ErrorType.NAME,ErrorMessage.FunctionName(e.procedureName))}case AstNodeType.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new CellError(ErrorType.NAME,ErrorMessage.NamedExpressionName(e.expressionName))}case AstNodeType.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteCellRange.fromCellRange(e,t.formulaAddress),s=this.dependencyGraph.getArray(n);if(s){const o=s.array;if(o instanceof NotComputedArray)throw new Error("Array should be already computed");if(o instanceof CellError)return o;if(o instanceof ArrayValue)return SimpleRangeValue.fromRange(o.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteColumnRange.fromColumnRange(e,t.formulaAddress);return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteRowRange.fromRowRangeAst(e,t.formulaAddress);return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case AstNodeType.ARRAY:{let n;const s=[];for(const o of e.args){let a;const l=[];for(const c of o){const d=coerceToRange(this.evaluateAst(c,t)),f=d.height();if(a===void 0)a=f,l.push(...d.data);else if(a===f)for(let C=0;C<f;C++)l[C].push(...d.data[C]);else return new CellError(ErrorType.REF,ErrorMessage.SizeMismatch)}const u=l[0].length;if(n===void 0)n=u,s.push(...l);else if(n===u)s.push(...l);else return new CellError(ErrorType.REF,ErrorMessage.SizeMismatch)}return SimpleRangeValue.onlyValues(s)}case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var s;if(t instanceof SimpleRangeValue&&!n.arraysFlag&&(t=(s=coerceRangeToScalar(t,n))!==null&&s!==void 0?s:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),t instanceof CellError)return t;if(t instanceof SimpleRangeValue){const o=t.data.map(a=>a.map(e));return SimpleRangeValue.onlyValues(o)}return e(t)}binaryRangeWrapper(e,t,n,s){var o,a;if(t instanceof SimpleRangeValue&&!s.arraysFlag&&(t=(o=coerceRangeToScalar(t,s))!==null&&o!==void 0?o:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),t instanceof CellError)return t;if(n instanceof SimpleRangeValue&&!s.arraysFlag&&(n=(a=coerceRangeToScalar(n,s))!==null&&a!==void 0?a:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),n instanceof CellError)return n;if(t instanceof SimpleRangeValue||n instanceof SimpleRangeValue){if(!(t instanceof SimpleRangeValue))if(n.isAdHoc()){const d=n.data;for(let f=0;f<d.length;f++)for(let C=0;C<d[0].length;C++)d[f][C]=e(t,d[f][C]);return SimpleRangeValue.onlyValues(d)}else t=SimpleRangeValue.fromScalar(t);if(!(n instanceof SimpleRangeValue))if(t.isAdHoc()){const d=t.data;for(let f=0;f<d.length;f++)for(let C=0;C<d[0].length;C++)d[f][C]=e(d[f][C],n);return SimpleRangeValue.onlyValues(d)}else n=SimpleRangeValue.fromScalar(n);if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const d=t.data,f=n.data;for(let C=0;C<d.length;C++)for(let m=0;m<d[0].length;m++)d[C][m]=e(d[C][m],f[C][m]);return SimpleRangeValue.onlyValues(d)}if(n.isAdHoc()){const d=t.data,f=n.data;for(let C=0;C<d.length;C++)for(let m=0;m<d[0].length;m++)f[C][m]=e(d[C][m],f[C][m]);return SimpleRangeValue.onlyValues(f)}}const l=Math.max(t.width(),n.width()),u=Math.max(t.height(),n.height()),c=Array(u);for(let d=0;d<u;d++)c[d]=Array(l);for(let d=0;d<u;d++){const f=t.height()!==1?d:0,C=n.height()!==1?d:0;for(let m=0;m<l;m++){const E=t.width()!==1?m:0,v=n.width()!==1?m:0;f<t.height()&&C<n.height()&&E<t.width()&&v<n.width()?c[d][m]=e(t.data[f][E],n.data[C][v]):c[d][m]=new CellError(ErrorType.NA)}}return SimpleRangeValue.onlyValues(c)}return e(t,n)}}function unaryErrorWrapper(r,e){return e instanceof CellError?e:r(e)}function binaryErrorWrapper(r,e,t){return e instanceof CellError?e:t instanceof CellError?t:r(e,t)}function wrapperForRootVertex(r,e){return r instanceof CellError&&e!==void 0?r.attachRootVertex(e):r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CombinedTransformer{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(n=>n.performEagerTransformations(e,t))}transformSingleAst(e,t){let[n,s]=[e,t];return this.transformations.forEach(o=>{[n,s]=o.transformSingleAst(n,s)}),[n,s]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LazilyTransformingAstService{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new CombinedTransformer(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(StatType.TRANSFORM_ASTS_POSTPONED);for(let o=n;o<this.transformations.length;o++){const a=this.transformations[o];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[l,u]=a.transformSingleAst(e,t);e=l,t=u}const s=this.parser.rememberNewAst(e);return this.stats.end(StatType.TRANSFORM_ASTS_POSTPONED),[s,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const s=this.transformations[n];(!t||t(s))&&(yield s)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NOT_FOUND$1=-1;function findLastOccurrenceInOrderedRange(r,e,{searchCoordinate:t,orderingDirection:n,ifNoMatch:s},o){const a=e.start[t],l=t==="col"?e.effectiveEndColumn(o):e.effectiveEndRow(o),u=t==="col"?C=>getRawValue(o.getCellValue(simpleCellAddress(e.sheet,C,e.start.row))):C=>getRawValue(o.getCellValue(simpleCellAddress(e.sheet,e.start.col,C))),c=n==="asc"?(C,m)=>compare(C,m):(C,m)=>-compare(C,m),d=findLastMatchingIndex(C=>c(r,u(C))>=0,a,l),f=u(d);if(f===r)return d-a;if(s==="returnLowerBound"){if(d===NOT_FOUND$1)return n==="asc"?NOT_FOUND$1:0;if(typeof f!=typeof r)return NOT_FOUND$1;if(n==="asc")return d-a;const C=d+1;return C<=l?C-a:NOT_FOUND$1}if(s==="returnUpperBound"){if(d===NOT_FOUND$1)return n==="asc"?0:NOT_FOUND$1;if(typeof f!=typeof r)return NOT_FOUND$1;if(n==="desc")return d-a;const C=d+1;return C<=l?C-a:NOT_FOUND$1}return NOT_FOUND$1}function findLastMatchingIndex(r,e,t){let n=e,s=t;for(;n<s;){const o=Math.ceil((n+s)/2);r(o)?n=o:s=o-1}return n===s&&r(n)?n:NOT_FOUND$1}function compare(r,e){return typeof r==typeof e?r===EmptyValue?0:r<e?-1:r>e?1:0:r===EmptyValue?-1:e===EmptyValue?1:e instanceof CellError||typeof r=="number"&&typeof e=="string"||typeof r=="number"&&typeof e=="boolean"?-1:typeof r=="string"&&typeof e=="number"?1:typeof r=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NOT_FOUND=-1;class AdvancedFind{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:n}={returnOccurrence:"first"}){const s=t.range,o=s===void 0?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(s),a=n==="first"?0:o.length-1,l=n==="first"?c=>c<o.length:c=>c>=0,u=n==="first"?c=>c+1:c=>c-1;for(let c=a;l(c);c=u(c))if(e(getRawValue(o[c])))return c;return NOT_FOUND}basicFind(e,t,n,{ordering:s,ifNoMatch:o,returnOccurrence:a}){const l=typeof e=="string"?forceNormalizeString(e):e,u=t.range;return u===void 0?this.findNormalizedValue(l,t.valuesFromTopLeftCorner(),o,a):s==="none"?this.findNormalizedValue(l,this.dependencyGraph.computeListOfValuesInRange(u),o,a):findLastOccurrenceInOrderedRange(l,u,{searchCoordinate:n,orderingDirection:s,ifNoMatch:o},this.dependencyGraph)}findNormalizedValue(e,t,n="returnNotFound",s="first"){const o=t.map(getRawValue).map(C=>typeof C=="string"?forceNormalizeString(C):C);if(n==="returnNotFound")return s==="first"?o.indexOf(e):o.lastIndexOf(e);const a=n==="returnLowerBound"?(C,m)=>compare(C,m):(C,m)=>-compare(C,m);let l=n==="returnLowerBound"?-1/0:1/0,u=NOT_FOUND;const c=s==="first"?0:o.length-1,d=s==="first"?C=>C<o.length:C=>C>=0,f=s==="first"?C=>C+1:C=>C-1;for(let C=c;d(C);C=f(C)){const m=o[C];if(m===e)return C;a(m,e)>0||a(l,m)<0&&(l=m,u=C)}return u}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ColumnBinarySearch extends AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,s){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ColumnIndex{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new ColumnBinarySearch(e)}add(e,t){if(!(e===EmptyValue||e instanceof CellError))if(e instanceof SimpleRangeValue)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(getRawValue(n),s);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof SimpleRangeValue)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(getRawValue(n),s);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(getRawValue(t.oldValue),getRawValue(t.value),t.address)}moveValues(e,t,n,s){for(const[o,a]of e){const l=movedSimpleCellAddress(a,s,t,n);this.remove(o,a),this.add(o,l)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,ifNoMatch:s,returnOccurrence:o}){o==null&&(o=n==="none"?"first":"last");const a=this.findUsingColumnIndex(e,t,o);return a!==void 0?a:this.binarySearchStrategy.find(e,t,{ordering:n,ifNoMatch:s,returnOccurrence:o})}findUsingColumnIndex(e,t,n){const s=t.range;if(s===void 0)return;this.ensureRecentData(s.sheet,s.start.col,e);const o=this.getColumnMap(s.sheet,s.start.col);if(!o)return-1;const a=typeof e=="string"?forceNormalizeString(e):e,l=o.get(a);if(!l||!l.index||l.index.length===0)return;const u=ColumnIndex.findRowBelongingToRange(l,s,n);return u!==void 0?u-s.start.row:void 0}static findRowBelongingToRange(e,t,n){const s=t.start.row,o=t.end.row,a=n==="first"?findInOrderedArray(s,e.index,"upperBound"):findInOrderedArray(o,e.index,"lowerBound");if(a===-1)return;const l=e.index[a];return l>=s&&l<=o?l:void 0}advancedFind(e,t,n={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,n)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let s=n[t];return s||(s=new Map,n[t]=s),s}getValueIndex(e,t,n){const s=this.getColumnMap(e,t);let o=this.getColumnMap(e,t).get(n);return o||(o={version:this.transformingService.version(),index:[]},s.set(n,o)),o}ensureRecentData(e,t,n){const s=this.getValueIndex(e,t,n),o=this.transformingService.version();if(s.version===o)return;const a=this.transformingService.getTransformationsFrom(s.version,l=>l.sheet===e&&(l instanceof AddRowsTransformer||l instanceof RemoveRowsTransformer));for(const l of a)l instanceof AddRowsTransformer?this.addRows(t,l.rowsSpan,n):l instanceof RemoveRowsTransformer&&this.removeRows(t,l.rowsSpan,n);s.version=o}addSingleCellValue(e,t){this.stats.measure(StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=forceNormalizeString(e));const n=this.getValueIndex(t.sheet,t.col,e);ColumnIndex.addValue(n,t.row)})}removeSingleValue(e,t){this.stats.measure(StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=forceNormalizeString(e));const s=n.get(e);if(!s)return;const o=findInOrderedArray(t.row,s.index);o>-1&&s.index.splice(o,1),s.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);ColumnIndex.shiftRows(s,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);ColumnIndex.removeRowsFromValues(s,t),ColumnIndex.shiftRows(s,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=findInOrderedArray(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=findInOrderedArray(t.rowStart,e.index,"upperBound"),s=findInOrderedArray(t.rowEnd,e.index,"lowerBound");n>-1&&s>-1&&n<=s&&e.index[n]<=t.rowEnd&&e.index.splice(n,s-n+1)}static shiftRows(e,t,n){const s=findInOrderedArray(t,e.index,"upperBound");if(s!==-1)for(let o=s;o<e.index.length;++o)e.index[o]+=n}}function findInOrderedArray(r,e,t="upperBound"){let n=0,s=e.length-1;for(;n<=s;){const l=Math.floor((n+s)/2);if(r>e[l])n=l+1;else if(r<e[l])s=l-1;else return l}const o=t==="lowerBound"?s:n;return o>=0&&o<=e.length?o:-1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function buildColumnSearchStrategy(r,e,t){return e.useColumnIndex?new ColumnIndex(r,e,t):new ColumnBinarySearch(r)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NumberLiteralHelper{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Serialization{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof FormulaCellVertex){const n=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(n.procedureName==="HYPERLINK")return n.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof FormulaCellVertex){const s=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(s,t)}else if(n instanceof ArrayVertex){const s=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(s.row!==e.row||s.col!==e.col||s.sheet!==e.sheet)return;t=t??e;const o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,t)}else if(n instanceof ParsingErrorVertex)return n.getFormula()}getCellSerialized(e,t){var n;return(n=this.getCellFormula(e,t))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),s=this.dependencyGraph.getSheetWidth(e),o=new Array(n);for(let a=0;a<n;a++){o[a]=new Array(s);for(let l=0;l<s;l++){const u=simpleCellAddress(e,l,a);o[a][l]=t(u)}for(let l=s-1;l>=0&&(o[a][l]===null||o[a][l]===void 0);l--)o[a].pop()}for(let a=n-1;a>=0&&o[a].length===0;a--)o.pop();return o}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(s)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);e[s]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,t){const n=new Unparser(e,buildLexerConfig(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new Serialization(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BuildEngineFactory{static buildFromSheets(e,t={},n=[]){const s=new Config(t);return this.buildEngine(s,e,n)}static buildFromSheet(e,t={},n=[]){const s=new Config(t),o=s.translationPackage.getUITranslation(UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(s,{[o]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new Config(e),{},t)}static rebuildWithConfig(e,t,n,s){return this.buildEngine(e,t,n,s)}static buildEngine(e,t={},n=[],s=e.useStats?new Statistics:new EmptyStatistics){s.start(StatType.BUILD_ENGINE_TOTAL);const o=new NamedExpressions,a=new FunctionRegistry(e),l=new LazilyTransformingAstService(s),u=DependencyGraph.buildEmpty(l,e,a,o,s),c=buildColumnSearchStrategy(u,e,s),d=u.sheetMapping,f=u.addressMapping;for(const ve in t)if(Object.prototype.hasOwnProperty.call(t,ve)){const xe=t[ve];validateAsSheet(xe);const de=findBoundaries(xe);if(de.height>e.maxRows||de.width>e.maxColumns)throw new SheetSizeLimitExceededError;const Se=d.addSheet(ve);f.autoAddSheet(Se,de)}const C=new ParserWithCaching(e,a,d.get);l.parser=C;const m=new Unparser(e,buildLexerConfig(e),d.fetchDisplayName,o),E=new DateTimeHelper(e),v=new NumberLiteralHelper(e),_=new ArithmeticHelper(e,E,v),T=new CellContentParser(e,E,v),R=new ArraySizePredictor(e,a),O=new Operations(e,u,c,T,C,s,l,o,R),N=new UndoRedo(e,O);l.undoRedo=N;const G=new ClipboardOperations(e,u,O),D=new CrudOperations(e,O,N,G,u,c,C,T,l,o);n.forEach(ve=>{D.ensureItIsPossibleToAddNamedExpression(ve.name,ve.expression,ve.scope),D.operations.addNamedExpression(ve.name,ve.expression,ve.scope,ve.options)});const k=new Exporter(e,o,d.fetchDisplayName,l),z=new Serialization(u,m,k),ne=new Interpreter(e,u,c,s,_,a,o,z,R,E);s.measure(StatType.GRAPH_BUILD,()=>{new GraphBuilder(u,c,C,T,s,R).buildGraph(t,s)});const Z=new Evaluator(e,s,ne,l,u,c);return Z.run(),s.end(StatType.BUILD_ENGINE_TOTAL),{config:e,stats:s,dependencyGraph:u,columnSearch:c,parser:C,unparser:m,cellContentParser:T,evaluator:Z,lazilyTransformingAstService:l,crudOperations:D,exporter:k,namedExpressions:o,serialization:z,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function objectDestroy(r){for(const[e,t]of Object.entries(r))t instanceof Function?r[e]=postMortem(t):delete r[e]}function postMortem(r){return()=>{throw new Error(`The "${r}" method cannot be called because this HyperFormula instance has been destroyed`)}}var tinyEmitter={exports:{}},hasRequiredTinyEmitter;function requireTinyEmitter(){if(hasRequiredTinyEmitter)return tinyEmitter.exports;hasRequiredTinyEmitter=1;function r(){}return r.prototype={on:function(e,t,n){var s=this.e||(this.e={});return(s[e]||(s[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var s=this;function o(){s.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),s=0,o=n.length;for(s;s<o;s++)n[s].fn.apply(n[s].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),s=n[e],o=[];if(s&&t)for(var a=0,l=s.length;a<l;a++)s[a].fn!==t&&s[a].fn._!==t&&o.push(s[a]);return o.length?n[e]=o:delete n[e],this}},tinyEmitter.exports=r,tinyEmitter.exports.TinyEmitter=r,tinyEmitter.exports}var tinyEmitterExports=requireTinyEmitter();/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Events;(function(r){r.SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed"})(Events||(Events={}));class Emitter extends tinyEmitterExports.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperFormula{constructor(e,t,n,s,o,a,l,u,c,d,f,C,m,E){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=s,this._parser=o,this._unparser=a,this._cellContentParser=l,this._evaluator=u,this._lazilyTransformingAstService=c,this._crudOperations=d,this._exporter=f,this._namedExpressions=C,this._serialization=m,this._functionRegistry=E,this._emitter=new Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return getDefaultConfig()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(BuildEngineFactory.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(BuildEngineFactory.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){validateArgToType(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new LanguageNotRegisteredError;return t}static registerLanguage(e,t){if(validateArgToType(e,"string","languageCode"),this.registeredLanguages.has(e))throw new LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,buildTranslationPackage(t))}static unregisterLanguage(e){if(validateArgToType(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new LanguageNotRegisteredError}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){validateArgToType(e,"string","functionId"),FunctionRegistry.registerFunction(e,t,n)}static unregisterFunction(e){validateArgToType(e,"string","functionId"),FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){validateArgToType(e,"string","code");const t=FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return validateArgToType(e,"string","functionId"),FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new HyperFormula(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return validateArgToType(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return validateArgToType(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return validateArgToType(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return validateArgToType(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([n,s])=>this._config[n]===s)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(isSimpleCellAddress(e))t=new AbsoluteCellRange(e,e);else if(isSimpleCellRange(e))t=new AbsoluteCellRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const n of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){validateArgToType(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){validateArgToType(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){validateArgToType(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){validateArgToType(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeAddedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeRemovedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeAddedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeRemovedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!isSimpleCellAddress(t))throw new ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");try{const n=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch{return!1}}moveCells(e,t){if(!isSimpleCellAddress(t))throw new ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const n=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,s){validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startRow"),validateArgToType(n,"number","numberOfRows"),validateArgToType(s,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,s),!0}catch{return!1}}moveRows(e,t,n,s){return validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startRow"),validateArgToType(n,"number","numberOfRows"),validateArgToType(s,"number","targetRow"),this._crudOperations.moveRows(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,s){validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startColumn"),validateArgToType(n,"number","numberOfColumns"),validateArgToType(s,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,s),!0}catch{return!1}}moveColumns(e,t,n,s){return validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startColumn"),validateArgToType(n,"number","numberOfColumns"),validateArgToType(s,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const t=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const t=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellValue(s)))}getRangeFormulas(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellFormula(s)))}getRangeSerialized(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellSerialized(s)))}getFillRangeData(e,t,n=!1){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");if(!isSimpleCellRange(t))throw new ExpectedValueOfTypeError("SimpleCellRange","target");const s=new AbsoluteCellRange(e.start,e.end),o=new AbsoluteCellRange(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(a=>a.map(l=>{const u=((l.row-(n?t:e).start.row)%s.height()+s.height())%s.height()+e.start.row,c=((l.col-(n?t:e).start.col)%s.width()+s.width())%s.width()+e.start.col;return this._serialization.getCellSerialized({row:u,col:c,sheet:s.sheet},l)}))}isItPossibleToAddSheet(e){validateArgToType(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&validateArgToType(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Events.SheetAdded,t),t}isItPossibleToRemoveSheet(e){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){validateArgToType(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return validateArgToType(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return validateArgToType(e,"string","cellAddress"),validateArgToType(t,"number","sheetId"),simpleCellAddressFromString(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return validateArgToType(e,"string","cellRange"),validateArgToType(t,"number","sheetId"),simpleCellRangeFromString(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const n=typeof t=="number"?t:t.includeSheetName?e.sheet+1:e.sheet;return simpleCellAddressToString(this.sheetMapping.fetchDisplayName,e,n)}simpleCellRangeToString(e,t={}){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","cellRange");const n=typeof t=="number"?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return simpleCellRangeToString(this.sheetMapping.fetchDisplayName,e,n)}getCellDependents(e){let t;if(isSimpleCellAddress(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(isSimpleCellRange(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(isSimpleCellAddress(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(isSimpleCellRange(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return validateArgToType(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return validateArgToType(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return validateArgToType(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return getCellType(t,e)}doesCellHaveSimpleValue(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===CellType.VALUE}doesCellHaveFormula(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===CellType.FORMULA||t===CellType.ARRAYFORMULA}isCellEmpty(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===CellType.EMPTY}isCellPartOfArray(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===CellType.ARRAY||t===CellType.ARRAYFORMULA}getCellValueType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueType(t)}getCellValueDetailedType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueDetailedType(t)}getCellValueFormat(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueFormat(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){validateArgToType(e,"number","sheetId"),validateArgToType(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){validateArgToType(e,"number","sheetId"),validateArgToType(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);n!==void 0&&this._emitter.emit(Events.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch{return!1}}addNamedExpression(e,t,n,s){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,s);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(n===void 0)return;const s=this._serialization.getCellFormula(n.address);return{name:e,scope:t,expression:s,options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch{return!1}}changeNamedExpression(e,t,n,s){return validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.NamedExpressionRemoved,n.displayName,s),s}else return[]}listNamedExpressions(e){return e!==void 0&&validateArgToType(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){validateArgToType(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new NotAFormulaError;return this._unparser.unparse(t,n)}calculateFormula(e,t){validateArgToType(e,"string","formulaString"),validateArgToType(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:s,dependencies:o}=this.extractTemporaryFormula(e,t);if(n===void 0)throw new NotAFormulaError;const a=this.evaluator.runAndForget(n,s,o);return this._exporter.exportScalarOrRange(a)}getNamedExpressionsFromFormula(e){validateArgToType(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new NotAFormulaError;const s=n.filter(a=>a instanceof NamedExpressionDependency).map(a=>a.name);return[...new Set(s)]}validateFormula(e){validateArgToType(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return HyperFormula.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return validateArgToType(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return validateArgToType(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return validateArgToType(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return validateArgToType(e,"number","val"),numberToSimpleTime(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){objectDestroy(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new EvaluationSuspendedError}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),s={sheet:t,col:0,row:0};if(!(n instanceof CellContent.Formula))return{address:s,dependencies:[]};const{ast:o,errors:a,dependencies:l}=this._parser.parse(n.formula,s);return a.length>0?{address:s,dependencies:[]}:{ast:o,address:s,dependencies:l}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),s=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),a=BuildEngineFactory.rebuildWithConfig(t,s,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Events.ValuesUpdated,n),n}}}HyperFormula.version="3.0.0";HyperFormula.buildDate="14/01/2025 11:44:17";HyperFormula.releaseDate="14/01/2025";HyperFormula.languages={};HyperFormula.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const privatePool=new WeakMap;class Config{constructor(e={},t=!0){const{accentSensitive:n,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:c,decimalSeparator:d,evaluateNullToZero:f,functionArgSeparator:C,functionPlugins:m,ignorePunctuation:E,leapYear1900:v,localeLang:_,language:T,ignoreWhiteSpace:R,licenseKey:O,matchWholeCell:N,arrayColumnSeparator:G,arrayRowSeparator:D,maxRows:k,maxColumns:z,nullYear:ne,nullDate:Z,parseDateTime:ve,precisionEpsilon:xe,precisionRounding:de,stringifyDateTime:Se,stringifyDuration:Me,smartRounding:Pe,timeFormats:_e,thousandSeparator:Oe,useArrayArithmetic:st,useStats:rt,undoLimit:U,useColumnIndex:te,useRegularExpressions:V,useWildcards:ue}=e;this.useArrayArithmetic=configValueFromParam(st,"boolean","useArrayArithmetic"),this.accentSensitive=configValueFromParam(n,"boolean","accentSensitive"),this.caseSensitive=configValueFromParam(s,"boolean","caseSensitive"),this.caseFirst=configValueFromParam(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=configValueFromParam(E,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??Config.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...configValueFromParamCheck(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...configValueFromParamCheck(_e,Array.isArray,"array","timeFormats")],this.functionArgSeparator=configValueFromParam(C,"string","functionArgSeparator"),this.decimalSeparator=configValueFromParam(d,[".",","],"decimalSeparator"),this.language=configValueFromParam(T,"string","language"),this.ignoreWhiteSpace=configValueFromParam(R,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=configValueFromParam(O,"string","licenseKey"),this.thousandSeparator=configValueFromParam(Oe,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=configValueFromParam(G,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=configValueFromParam(D,[";","|"],"arrayRowSeparator"),this.localeLang=configValueFromParam(_,"string","localeLang"),this.functionPlugins=[...m??Config.defaultConfig.functionPlugins],this.smartRounding=configValueFromParam(Pe,"boolean","smartRounding"),this.evaluateNullToZero=configValueFromParam(f,"boolean","evaluateNullToZero"),this.nullYear=configValueFromParam(ne,"number","nullYear"),validateNumberToBeAtLeast(this.nullYear,"nullYear",0),validateNumberToBeAtMost(this.nullYear,"nullYear",100),this.precisionRounding=configValueFromParam(de,"number","precisionRounding"),validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=configValueFromParam(xe,"number","precisionEpsilon"),validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=configValueFromParam(te,"boolean","useColumnIndex"),this.useStats=configValueFromParam(rt,"boolean","useStats"),this.parseDateTime=configValueFromParam(ve,"function","parseDateTime"),this.stringifyDateTime=configValueFromParam(Se,"function","stringifyDateTime"),this.stringifyDuration=configValueFromParam(Me,"function","stringifyDuration"),this.translationPackage=HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=configValueFromParamCheck(Z,instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=configValueFromParam(v,"boolean","leapYear1900"),this.undoLimit=configValueFromParam(U,"number","undoLimit"),this.useRegularExpressions=configValueFromParam(V,"boolean","useRegularExpressions"),this.useWildcards=configValueFromParam(ue,"boolean","useWildcards"),this.matchWholeCell=configValueFromParam(N,"boolean","matchWholeCell"),validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0),this.maxRows=configValueFromParam(k,"number","maxRows"),validateNumberToBeAtLeast(this.maxRows,"maxRows",1),this.maxColumns=configValueFromParam(z,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1),this.context=l,privatePool.set(this,{licenseKeyValidityState:checkLicenseKeyValidity(this.licenseKey)}),configCheckIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),configCheckIfParametersNotInConflict({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...configValueFromParamCheck(e,Array.isArray,"array","currencySymbol")];return t.forEach(n=>{if(typeof n!="string")throw new ExpectedValueOfTypeError("string[]","currencySymbol");if(n==="")throw new ConfigValueEmpty("currencySymbol")}),t}get licenseKeyValidityState(){return privatePool.get(this).licenseKeyValidityState}getConfig(){return getFullConfigFromPartial(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new Config(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,n,s){e!==void 0&&console.warn(s===void 0?`${t} option is deprecated since ${n}`:`${t} option is deprecated since ${n}, please use ${s}`)}}Config.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:defaultStringifyDateTime,stringifyDuration:defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function getFullConfigFromPartial(r){var e;const t={};for(const n in Config.defaultConfig){const s=(e=r[n])!==null&&e!==void 0?e:Config.defaultConfig[n];Array.isArray(s)?t[n]=[...s]:t[n]=s}return t}function getDefaultConfig(){return getFullConfigFromPartial({})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const dictionary={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var AbsStyle;(function(r){r[r.FullyAbsolute=1]="FullyAbsolute",r[r.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",r[r.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",r[r.FullyRelative=4]="FullyRelative"})(AbsStyle||(AbsStyle={}));class AddressPlugin extends FunctionPlugin{verifyAddressArguments(e,t,n,s){if(s){if(e<1||t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.FullyAbsolute==n){if(e<1||t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.RowAbsoluteColRelative==n){if(e<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.RowRelativeColAbsolute==n&&t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(n,s,o,a,l)=>{const u=this.verifyAddressArguments(n,s,o,a);if(u!==void 0)return u;const c=columnIndexToLabel(s-1);let d="";l!=null&&(d=`${l}!`);const f=s==0?"C":`C[${s}]`,C=n==0?"R":`R[${n}]`;return AbsStyle.FullyRelative==o?a?`${d}${c}${n}`:`${d}${C}${f}`:AbsStyle.RowRelativeColAbsolute==o?a?`${d}$${c}${n}`:`${d}${C}C${s}`:AbsStyle.RowAbsoluteColRelative==o?a?`${d}${c}$${n}`:`${d}R${n}${f}`:a?`${d}$${c}$${n}`:`${d}R${n}C${s}`})}}AddressPlugin.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:FunctionArgumentType.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArrayPlugin extends FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,t){if(e.args.length!==1)return ArraySize.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(o=>{var a;return this.arraySizeForAst(o,new InterpreterState(t.formulaAddress,t.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(n,s,o)=>{s=Math.min(s,n.height()),o=Math.min(o,n.width());const a=n.data,l=[];for(let u=0;u<s;u++)l.push(a[u].slice(0,o));return SimpleRangeValue.onlyValues(l)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return ArraySize.error();const n=this.metadata("ARRAY_CONSTRAIN"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))});let{height:o,width:a}=s[0];return e.args[1].type===AstNodeType.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===AstNodeType.NUMBER&&(a=Math.min(a,e.args[2].value)),o<1||a<1||!Number.isInteger(o)||!Number.isInteger(a)?ArraySize.error():new ArraySize(a,o)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(n,...s)=>{for(const l of s)if(n.width()!==l.width()||n.height()!==l.height())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);if(n.width()>1&&n.height()>1)return new CellError(ErrorType.NA,ErrorMessage.WrongDimension);const o=n.data,a=[];for(let l=0;l<n.height();l++){const u=[];for(let c=0;c<n.width();c++){let d=!0;for(const f of s)if(coerceScalarToBoolean(f.data[l][c])!==!0){d=!1;break}d&&u.push(o[l][c])}u.length>0&&a.push(u)}return a.length>0?SimpleRangeValue.onlyValues(a):new CellError(ErrorType.NA,ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return ArraySize.error();const n=this.metadata("FILTER"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))}),o=Math.max(...s.map(l=>l.width)),a=Math.max(...s.map(l=>l.height));return new ArraySize(o,a)}}ArrayPlugin.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AbsPlugin extends FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}AbsPlugin.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const MAX_48BIT_INTEGER=0xffffffffffff,SHIFT_MIN_POSITIONS=-53,SHIFT_MAX_POSITIONS=53;class BitShiftPlugin extends FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),shiftLeft)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),shiftRight)}}BitShiftPlugin.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:SHIFT_MIN_POSITIONS,maxValue:SHIFT_MAX_POSITIONS}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:SHIFT_MIN_POSITIONS,maxValue:SHIFT_MAX_POSITIONS}]}};function shiftLeft(r,e){return e<0?shiftRight(r,-e):validate(r*Math.pow(2,e))}function shiftRight(r,e){return e<0?shiftLeft(r,-e):validate(Math.floor(r/Math.pow(2,e)))}function validate(r){return r>MAX_48BIT_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.BitshiftLong):r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BitwiseLogicOperationsPlugin extends FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(n,s)=>n&s)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(n,s)=>n|s)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(n,s)=>n^s)}}BitwiseLogicOperationsPlugin.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BooleanPlugin extends FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(n,s,o)=>n?s:o)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...n)=>{for(let s=0;s<n.length;s+=2)if(n[s])return n[s+1];return new CellError(ErrorType.NA,ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...n)=>n.filter(s=>s!==void 0).every(s=>!!s))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...n)=>n.filter(s=>s!==void 0).some(s=>s))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),n=>!n)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...n)=>{let s=0;return n.filter(o=>o!==void 0).forEach(o=>{o&&s++}),s%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(n,...s)=>{const o=s.length;let a=0;for(;a+1<o;a+=2)if(!(s[a]instanceof CellError)&&this.arithmeticHelper.eq(n,s[a]))return s[a+1];return a<o?s[a]:new CellError(ErrorType.NA,ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(n,s)=>n instanceof CellError?s:n)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(n,s)=>n instanceof CellError&&n.type===ErrorType.NA?s:n)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(n,...s)=>n>s.length?new CellError(ErrorType.NUM,ErrorMessage.Selector):s[n-1])}}BooleanPlugin.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CharPlugin extends FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=256?new CellError(ErrorType.VALUE,ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=1114112?new CellError(ErrorType.VALUE,ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}CharPlugin.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CodePlugin extends FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),n=>n.length===0?new CellError(ErrorType.VALUE,ErrorMessage.EmptyString):n.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),n=>{var s;return(s=n.codePointAt(0))!==null&&s!==void 0?s:new CellError(ErrorType.VALUE,ErrorMessage.EmptyString)})}}CodePlugin.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:FunctionArgumentType.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CountBlankPlugin extends FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...n)=>{let s=0;return n.forEach(o=>{o===EmptyValue&&s++}),s})}}CountBlankPlugin.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CountUniquePlugin extends FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...n)=>{const s=new Set,o=new Set;for(const a of n)a instanceof CellError?o.add(a.type):a!==""&&s.add(a);return s.size+o.size})}}CountUniquePlugin.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DateTimePlugin extends FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s),a=o+((4-o)%7+7)%7,l=Math.floor((t-1)/7)-Math.floor((a-1)/7)+1;return l===0?this.isoweeknumCore(e-7)+1:l},this.days360Core=(e,t,n)=>{const s=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);let a,l;return n?(a=toBasisEU(s),l=toBasisEU(o)):[a,l]=this.dateTimeHelper.toBasisUS(s,o),360*(l.year-a.year)+30*(l.month-a.month)+l.day-a.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(n,s,o)=>{const a=Math.trunc(o);let l=Math.trunc(s),u=Math.trunc(n);u<this.dateTimeHelper.getEpochYearZero()&&(u+=this.dateTimeHelper.getEpochYearZero());const c=Math.floor((l-1)/12);u+=c,l-=c*12;const d={year:u,month:l,day:1};if(this.dateTimeHelper.isValidDate(d)){let f=this.dateTimeHelper.dateToNumber(d)+(a-1);return f=this.dateTimeHelper.getWithinBounds(f),f===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):f}return new CellError(ErrorType.VALUE,ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(n,s,o)=>{const a=timeToNumber({hours:Math.trunc(n),minutes:Math.trunc(s),seconds:Math.trunc(o)});return a<0?new CellError(ErrorType.NUM,ErrorMessage.NegativeTime):a%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(n,s)=>{const o=this.dateTimeHelper.numberToSimpleDate(n);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(offsetMonth(o,s)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):a})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(n,s)=>Math.trunc(n)-Math.trunc(s))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(n,s)=>format(n,s,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(n,s)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(s===3)return(o-1)%7;const a=weekdayOffsets.get(s);return a===void 0?new CellError(ErrorType.NUM,ErrorMessage.BadMode):(o-a)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(n,s)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),u=this.dateTimeHelper.relativeNumberToAbsoluteNumber(l);if(s===21)return this.isoweeknumCore(n);const c=weekdayOffsets.get(s);return c===void 0?new CellError(ErrorType.NUM,ErrorMessage.BadMode):Math.floor((o-c)/7)-Math.floor((u-c)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),n=>{const{dateTime:s}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return s===void 0?new CellError(ErrorType.VALUE,ErrorMessage.IncorrectDateTime):instanceOfSimpleDate(s)?(instanceOfSimpleTime(s)?Math.trunc(timeToNumber(s)):0)+this.dateTimeHelper.dateToNumber(s):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),n=>{const s=this.dateTimeHelper.dateStringToDateNumber(n);return s===void 0?new CellError(ErrorType.VALUE,ErrorMessage.IncorrectDateTime):getRawValue(s)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const n=new Date(Date.now());return timeToNumber({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(n,s)=>{const o=this.dateTimeHelper.numberToSimpleDate(n),a=truncateDayInMonth(offsetMonth(o,s));let l=this.dateTimeHelper.dateToNumber(a);return l=this.dateTimeHelper.getWithinBounds(l),l===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):l})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(n,s,o)=>{if(n>s)return new CellError(ErrorType.NUM,ErrorMessage.StartEndDate);if(o==="D")return Math.floor(s)-Math.floor(n);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);switch(o){case"M":return(l.year-a.year)*12+(l.month-a.month)-(l.day<a.day?1:0);case"YM":return(12+(l.month-a.month)-(l.day<a.day?1:0))%12;case"Y":return l.month>a.month||l.month===a.month&&l.day>=a.day?l.year-a.year:l.year-a.year-1;case"MD":if(l.day>=a.day)return l.day-a.day;{const u=l.month===1?12:l.month-1,c=l.month===1?l.year-1:l.year;return this.dateTimeHelper.daysInMonth(c,u)+l.day-a.day}case"YD":return l.month>a.month||l.month===a.month&&l.day>=a.day?Math.floor(s)-this.dateTimeHelper.dateToNumber({year:l.year,month:a.month,day:a.day}):Math.floor(s)-Math.floor(n)-365*(l.year-a.year-1)-this.dateTimeHelper.leapYearsCount(l.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new CellError(ErrorType.NUM,ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(n,s,o)=>{switch(n=Math.trunc(n),s=Math.trunc(s),n>s&&([n,s]=[s,n]),o){case 0:return this.days360Core(n,s,!1)/360;case 1:return(s-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(s));case 2:return(s-n)/360;case 3:return(s-n)/365;case 4:return this.days360Core(n,s,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const s=n%60;n=Math.trunc(n/60);const o=n%60;n=Math.trunc(n/60);const a=n%24;n=Math.trunc(n/24);const l=n%30;n=Math.trunc(n/30);const u=n%12,c=Math.trunc(n/12);return"P"+(c>0?`${c}Y`:"")+(u>0?`${u}M`:"")+(l>0?`${l}D`:"")+"T"+(a>0?`${a}H`:"")+(o>0?`${o}M`:"")+(s>0?`${s}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(n,s,o)=>this.networkdayscore(n,s,1,o))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(n,s,o,a)=>this.networkdayscore(n,s,o,a))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(n,s,o)=>this.workdaycore(n,s,1,o))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(n,s,o,a)=>this.workdaycore(n,s,o,a))}networkdayscore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);let o=1;e>t&&([e,t]=[t,e],o=-1);const a=computeWeekendPattern(n);if(a instanceof CellError)return a;const l=this.simpleRangeToFilteredHolidays(a,s);return l instanceof CellError?l:o*this.countWorkdays(e,t,a,l)}workdaycore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);const o=computeWeekendPattern(n);if(o instanceof CellError)return o;const a=this.simpleRangeToFilteredHolidays(o,s);if(a instanceof CellError)return a;if(t>0){let l=1;for(;this.countWorkdays(e+1,e+l,o,a)<t;)l*=2;let u=1;for(;u+1<l;){const c=Math.trunc((u+l)/2);this.countWorkdays(e+1,e+c,o,a)<t?u=c:l=c}return e+l}else if(t<0){t*=-1;let l=1;for(;this.countWorkdays(e-l,e-1,o,a)<t;)l*=2;let u=1;for(;u+1<l;){const c=Math.trunc((u+l)/2);this.countWorkdays(e-c,e-1,o,a)<t?u=c:l=c}return e-l}else return e}countWorkdays(e,t,n,s){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let l=0;for(let u=0;u<7;u++)n.charAt(u)==="0"&&(l+=Math.floor((o+6-u)/7),l-=Math.floor((a-1+6-u)/7));return l-=lowerBound(t+1,s)-lowerBound(e,s),l}simpleRangeToFilteredHolidays(e,t){var n;const s=(n=t==null?void 0:t.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const a of s)if(a instanceof CellError)return a;const o=[];for(const a of s)if(a!==EmptyValue)if(isExtendedNumber(a))o.push(Math.trunc(getRawValue(a)));else return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);return[...new Set(o)].sort((a,l)=>a-l).filter(a=>{const u=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(u)==="0"})}}DateTimePlugin.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:FunctionArgumentType.STRING}],returnNumberType:NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:FunctionArgumentType.STRING}],returnNumberType:NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]}};function lowerBound(r,e){if(e.length===0||r<=e[0])return 0;if(e[e.length-1]<r)return e.length;let t=0,n=e.length-1;for(;t+1<n;){const s=Math.floor((n+t)/2);e[s]>=r?n=s:t=s}return n}function computeWeekendPattern(r){var e;return typeof r!="number"&&typeof r!="string"?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):typeof r=="string"?r.length!==7||!/^(0|1)*$/.test(r)||r==="1111111"?new CellError(ErrorType.NUM,ErrorMessage.WeekendString):r:(e=workdayPatterns.get(r))!==null&&e!==void 0?e:new CellError(ErrorType.NUM,ErrorMessage.BadMode)}const weekdayOffsets=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),workdayPatterns=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DegreesPlugin extends FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}DegreesPlugin.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DeltaPlugin extends FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(n,s)=>n===s?1:0)}}DeltaPlugin.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ExpPlugin extends FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}ExpPlugin.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FinancialPlugin extends FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),pmtCore)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),ipmtCore)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),ppmtCore)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),fvCore)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(n,s,o,a,l,u)=>{if(a>l)return new CellError(ErrorType.NUM,ErrorMessage.EndStartPeriod);let c=0;for(let d=a;d<=l;d++)c+=ipmtCore(n,d,s,o,0,u);return c})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(n,s,o,a,l,u)=>{if(a>l)return new CellError(ErrorType.NUM,ErrorMessage.EndStartPeriod);let c=0;for(let d=a;d<=l;d++)c+=ppmtCore(n,d,s,o,0,u);return c})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(n,s,o,a,l)=>{if(l===12&&a>o||a>o+1)return new CellError(ErrorType.NUM,ErrorMessage.PeriodLong);if(s>=n)return 0;const u=Math.round((1-Math.pow(s/n,1/o))*1e3)/1e3,c=n*u*l/12;if(a===1)return c;let d=c;for(let f=0;f<a-2;f++)d+=(n-d)*u;return a===o+1?(n-d)*u*(12-l)/12:(n-d)*u})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(n,s,o,a,l)=>{if(a>o)return new CellError(ErrorType.NUM);let u=l/o,c;u>=1?(u=1,a===1?c=n:c=0):c=n*Math.pow(1-u,a-1);const d=n*Math.pow(1-u,a);return Math.max(c-Math.max(s,d),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(n,s)=>{if(s<1)return new CellError(ErrorType.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/s})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(n,s)=>{if(s<1)return new CellError(ErrorType.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*s/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(n,s)=>(s=Math.trunc(s),Math.pow(1+n/s,s)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(n,s,o,a)=>o===0?new CellError(ErrorType.DIV_BY_ZERO):a*n*(s/o-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(n,s)=>(s=Math.trunc(s),(Math.pow(n+1,1/s)-1)*s))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(n,s,o,a,l)=>n===0?s===0?new CellError(ErrorType.DIV_BY_ZERO):(-o-a)/s:(l&&(s*=1+n),Math.log((s-a*n)/(o*n+s))/Math.log(1+n)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(n,s,o,a,l,u)=>{if(u<=-1)return new CellError(ErrorType.VALUE);const c=1e-7,d=50;let f=u;l=l?1:0;for(let C=0;C<d;C++){if(f<=-1)return new CellError(ErrorType.NUM);let m;if(Math.abs(f)<c)m=o*(1+n*f)+s*(1+f*l)*n+a;else{const v=Math.pow(1+f,n);m=o*v+s*(1/f+l)*(v-1)+a}if(Math.abs(m)<c)return f;let E;if(Math.abs(f)<c)E=o*n+s*l*n;else{const v=Math.pow(1+f,n),_=n*Math.pow(1+f,n-1);E=o*_+s*(1/f+l)*_+s*(-1/(f*f))*(v-1)}f-=m/E}return new CellError(ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(n,s,o,a,l)=>(l=l?1:0,n===-1?s===0?new CellError(ErrorType.NUM):new CellError(ErrorType.DIV_BY_ZERO):n===0?-o*s-a:((1-Math.pow(1+n,s))*o*(1+n*l)/n-a)/Math.pow(1+n,s)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(n,s,o)=>s===0||o<0&&s>0||o>0&&s<0?new CellError(ErrorType.NUM):Math.pow(o/s,1/n)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(n,s,o)=>o===0?new CellError(ErrorType.DIV_BY_ZERO):(n-s)/o)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(n,s,o,a)=>a>o?new CellError(ErrorType.NUM):(n-s)*(o-a+1)*2/(o*(o+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);if(l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day))return new CellError(ErrorType.NUM);const u=360-o*(s-n);return u===0?0:u<0?new CellError(ErrorType.NUM):365*o/u})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);if(l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day))return new CellError(ErrorType.NUM);const u=360-o*(s-n);return u===0?0:u<0?new CellError(ErrorType.NUM):100*(1-o*(s-n)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);return l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day)?new CellError(ErrorType.NUM):(100-o)*360/(o*(s-n))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(n,s)=>{const o=s.valuesFromTopLeftCorner();for(const a of o)if(a instanceof CellError)return a;for(const a of o)if(isExtendedNumber(a))n*=1+getRawValue(a);else if(a!==EmptyValue)return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);return n})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(n,...s)=>{const o=this.arithmeticHelper.coerceNumbersExactRanges(s);return o instanceof CellError?o:npvCore(n,o)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(n,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof CellError)return a;let l=!1,u=!1;const c=[],d=[];for(const E of a)E>0?(l=!0,c.push(E),d.push(0)):E<0?(u=!0,d.push(E),c.push(0)):(d.push(0),c.push(0));if(!l||!u)return new CellError(ErrorType.DIV_BY_ZERO);const f=a.length,C=npvCore(o,c);if(C instanceof CellError)return C;const m=npvCore(s,d);return m instanceof CellError?m:Math.pow(-C*Math.pow(1+o,f)/m/(1+s),1/(f-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(n,s,o)=>(Math.log(o)-Math.log(s))/Math.log(1+n))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(n,s,o)=>{const a=s.valuesFromTopLeftCorner();for(const C of a)if(typeof C!="number")return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);const l=a,u=o.valuesFromTopLeftCorner();for(const C of u)if(typeof C!="number")return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);const c=u;if(c.length!==l.length)return new CellError(ErrorType.NUM,ErrorMessage.EqualLength);const d=c.length;let f=0;if(c[0]<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);for(let C=0;C<d;C++){if(c[C]=Math.floor(c[C]),c[C]<c[0])return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);f+=l[C]/Math.pow(1+n,(c[C]-c[0])/365)}return f})}}FinancialPlugin.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE}],returnNumberType:NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]}};function pmtCore(r,e,t,n,s){if(r===0)return(-t-n)/e;{const o=Math.pow(1+r,e);return(n*r+t*r*o)*(s?1/(1+r):1)/(1-o)}}function ipmtCore(r,e,t,n,s,o){const a=pmtCore(r,t,n,s,o);return e===1?r*(o?0:-n):r*(o?fvCore(r,e-2,a,n,o)-a:fvCore(r,e-1,a,n,o))}function fvCore(r,e,t,n,s){if(r===0)return-n-t*e;{const o=Math.pow(1+r,e);return t*(s?1+r:1)*(1-o)/r-n*o}}function ppmtCore(r,e,t,n,s,o){return pmtCore(r,t,n,s,o)-ipmtCore(r,e,t,n,s,o)}function npvCore(r,e){let t=0;for(let n=e.length-1;n>=0;n--){if(t+=e[n],r===-1){if(t===0)continue;return new CellError(ErrorType.DIV_BY_ZERO)}t/=1+r}return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaTextPlugin extends FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber),n=>{var s;return(s=this.serialization.getCellFormula(n))!==null&&s!==void 0?s:new CellError(ErrorType.NA,ErrorMessage.Formula)})}}FormulaTextPlugin.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperlinkPlugin extends FunctionPlugin{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(n,s)=>(e.hyperlink=n,s??n))}}HyperlinkPlugin.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InformationPlugin extends FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),n=>n instanceof CellError&&n.type!==ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),n=>n instanceof CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof FormulaVertex)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),n=>n===EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),n=>n instanceof CellError&&n.type==ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),n=>n instanceof CellError&&(n.type==ErrorType.REF||n.type==ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,n=>n.col+1)}columns(e,t){if(e.args.length!==1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);if(e.args.some(s=>s.type===AstNodeType.EMPTY))return new CellError(ErrorType.NUM,ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===AstNodeType.PARENTHESIS;)n=n.expression;if(n.type===AstNodeType.CELL_RANGE||n.type===AstNodeType.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===AstNodeType.CELL_REFERENCE)return 1;if(n.type===AstNodeType.ROW_RANGE)return this.config.maxColumns;{const s=this.evaluateAst(n,t);return s instanceof SimpleRangeValue?s.width():s instanceof CellError?s:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,n=>n.row+1)}rows(e,t){if(e.args.length!==1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);if(e.args.some(s=>s.type===AstNodeType.EMPTY))return new CellError(ErrorType.NUM,ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===AstNodeType.PARENTHESIS;)n=n.expression;if(n.type===AstNodeType.CELL_RANGE||n.type===AstNodeType.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===AstNodeType.CELL_REFERENCE)return 1;if(n.type===AstNodeType.COLUMN_RANGE)return this.config.maxRows;{const s=this.evaluateAst(n,t);return s instanceof SimpleRangeValue?s.height():s instanceof CellError?s:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(n,s,o)=>{var a,l,u,c,d,f;return o<1||s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o>n.width()||s>n.height()?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(f=(u=(l=(a=n==null?void 0:n.data)===null||a===void 0?void 0:a[s-1])===null||l===void 0?void 0:l[o-1])!==null&&u!==void 0?u:(d=(c=n==null?void 0:n.data)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d[0])!==null&&f!==void 0?f:new CellError(ErrorType.VALUE,ErrorMessage.CellRangeExpected)})}na(e,t){return new CellError(ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const s=this.dependencyGraph.sheetMapping.get(n);return s!==void 0?s+1:new CellError(ErrorType.NA,ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new CellError(ErrorType.VALUE,ErrorMessage.CellRefExpected))}}InformationPlugin.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class IsEvenPlugin extends FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),n=>n%2===0)}}IsEvenPlugin.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class IsOddPlugin extends FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),n=>n%2===1)}}IsOddPlugin.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LogarithmPlugin extends FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(n,s)=>Math.log(n)/Math.log(s))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}LogarithmPlugin.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const PI=parseFloat(Math.PI.toFixed(14));class MathConstantsPlugin extends FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>PI)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),n=>Math.sqrt(PI*n))}}MathConstantsPlugin.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function arraySizeForMultiplication(r,e){return new ArraySize(e.width,r.height)}function arraySizeForPoolFunction(r,e,t){return new ArraySize(1+(r.width-e)/t,1+(r.height-e)/t)}class MatrixPlugin extends FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(n,s)=>{if(!n.hasOnlyNumbers()||!s.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);if(s.height()!==n.width())return new CellError(ErrorType.VALUE,ErrorMessage.ArrayDimensions);const o=arraySizeForMultiplication(n.size,s.size),a=this.createKernel(function(l,u,c){let d=0;for(let f=0;f<c;++f)d+=l[this.thread.y][f]*u[f][this.thread.x];return d},o)(n.rawNumbers(),s.rawNumbers(),n.width());return SimpleRangeValue.onlyNumbers(a)})}mmultArraySize(e,t){if(e.args.length!==2)return ArraySize.error();const n=this.metadata("MMULT"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))}),[o,a]=s;return arraySizeForMultiplication(o,a)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(n,s,o=s)=>{if(!n.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);const a=arraySizeForPoolFunction(n.size,s,o),l=this.createKernel(function(u,c,d){const f=this.thread.x*d,C=this.thread.y*d;let m=u[C][f];for(let E=0;E<c;E++)for(let v=0;v<c;v++)m=Math.max(m,u[C+E][f+v]);return m},a)(n.rawNumbers(),s,o);return SimpleRangeValue.onlyNumbers(l)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(n,s,o=s)=>{if(!n.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);const a=arraySizeForPoolFunction(n.size,s,o),l=this.createKernel(function(u,c,d){const f=this.thread.x*d,C=this.thread.y*d;let m=u[C][f];for(let O=0;O<c;O++)for(let N=0;N<c;N++)m=Math.max(m,u[C+O][f+N]);let E=u[C][f];for(let O=0;O<c;O++)for(let N=0;N<c;N++)E=Math.min(E,u[C+O][f+N]);const v=c*c;let _=E,T=m,R=42;for(let O=0;O<32;O++){const N=(_+T)/2;let G=0;for(let D=0;D<c;D++)for(let k=0;k<c;k++)u[C+D][f+k]>N&&G++;if(c%2===0)if(G===v/2){R=N;break}else G>v/2?_=N:T=N;else if(G===(v-1)/2){R=N;break}else G>(v-1)/2?_=N:T=N}return R},a)(n.rawNumbers(),s,o);return SimpleRangeValue.onlyNumbers(l)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return ArraySize.error();const n=this.metadata("MAXPOOL"),o=e.args.map(c=>{var d;return this.arraySizeForAst(c,new InterpreterState(t.formulaAddress,t.arraysFlag||((d=n==null?void 0:n.arrayFunction)!==null&&d!==void 0?d:!1)))})[0],a=e.args[1];let l;a.type===AstNodeType.NUMBER?l=a.value:l=1;let u=l;if(e.args.length===3){const c=e.args[2];c.type===AstNodeType.NUMBER?u=c.value:u=1}return l>o.width||l>o.height||u>l||(o.width-l)%u!==0||(o.height-l)%u!==0?ArraySize.error():arraySizeForPoolFunction(o,l,u)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),n=>{const s=n.rawData(),o=n.size,a=[];for(let l=0;l<o.width;++l){a[l]=[];for(let u=0;u<o.height;++u)a[l][u]=s[u][l]}return SimpleRangeValue.onlyValues(a)})}transposeArraySize(e,t){if(e.args.length!==1)return ArraySize.error();const n=this.metadata("TRANSPOSE"),s=e.args.map(a=>{var l;return this.arraySizeForAst(a,new InterpreterState(t.formulaAddress,t.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[o]=s;return new ArraySize(o.height,o.width)}createKernel(e,t){return function(...n){const s=[];for(let o=0;o<t.height;++o){s.push([]);for(let a=0;a<t.width;++a)s[o][a]=e.apply({thread:{x:a,y:o}},n)}return s}}}MatrixPlugin.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MedianPlugin extends FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof CellError?s:s.length===0?new CellError(ErrorType.NUM,ErrorMessage.OneValue):(s.sort((o,a)=>o-a),s.length%2===0?(s[s.length/2-1]+s[s.length/2])/2:s[Math.floor(s.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof CellError?o:(o.sort((a,l)=>a-l),s=Math.trunc(s),s>o.length?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o[o.length-s])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof CellError?o:(o.sort((a,l)=>a-l),s=Math.trunc(s),s>o.length?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o[s-1])})}}MedianPlugin.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ModuloPlugin extends FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(n,s)=>s===0?new CellError(ErrorType.DIV_BY_ZERO):n%s)}}ModuloPlugin.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function zeroForInfinite$1(r){return isExtendedNumber(r)&&!Number.isFinite(getRawValue(r))?0:r}class MomentsAggregate{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new MomentsAggregate(e*e,e,1)}compose(e){return new MomentsAggregate(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}MomentsAggregate.empty=new MomentsAggregate(0,0,0);class NumericAggregationPlugin extends FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(getRawValue(n),2),strictlyNumbers)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(s,o)=>Math.max(s,o),getRawValue,numbersBooleans);return zeroForInfinite$1(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(s,o)=>Math.min(s,o),getRawValue,numbersBooleans);return zeroForInfinite$1(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const s=this.reduce(e.args,t,MomentsAggregate.empty,"_AGGREGATE_A",(o,a)=>o.compose(a),o=>MomentsAggregate.single(getRawValue(o)),numbersBooleans);return s instanceof CellError?s:(n=s.averageValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof CellError?s:(n=s.varSValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}varpa(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof CellError?s:(n=s.varPValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof CellError)return n;{const s=n.varSValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof CellError)return n;{const s=n.varPValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:FunctionArgumentType.NUMBER},t),s=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(s,t);case 2:case 102:return this.doCount(s,t);case 3:case 103:return this.doCounta(s,t);case 4:case 104:return this.doMax(s,t);case 5:case 105:return this.doMin(s,t);case 6:case 106:return this.doProduct(s,t);case 7:case 107:return this.doStdevS(s,t);case 8:case 108:return this.doStdevP(s,t);case 9:case 109:return this.doSum(s,t);case 10:case 110:return this.doVarS(s,t);case 11:case 111:return this.doVarP(s,t);default:return new CellError(ErrorType.VALUE,ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,MomentsAggregate.empty,"_AGGREGATE",(n,s)=>n.compose(s),n=>MomentsAggregate.single(getRawValue(n)),strictlyNumbers)}reduceAggregateA(e,t){return this.reduce(e,t,MomentsAggregate.empty,"_AGGREGATE_A",(n,s)=>n.compose(s),n=>MomentsAggregate.single(getRawValue(n)),numbersBooleans)}doAverage(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.averageValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doVarS(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.varSValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doVarP(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.varPValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof CellError)return n;{const s=n.varSValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof CellError)return n;{const s=n.varPValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(n,s)=>n+s,getRawValue,n=>isExtendedNumber(n)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(n,s)=>n+s,getRawValue,n=>n===EmptyValue?0:1)}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(s,o)=>Math.max(s,o),getRawValue,strictlyNumbers);return zeroForInfinite$1(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(s,o)=>Math.min(s,o),getRawValue,strictlyNumbers);return zeroForInfinite$1(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,getRawValue,strictlyNumbers)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(n,s)=>n*s,getRawValue,strictlyNumbers)}reduce(e,t,n,s,o,a,l){return e.length<1?new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber):e.reduce((u,c)=>{if(u instanceof CellError)return u;if(c.type===AstNodeType.CELL_RANGE||c.type===AstNodeType.COLUMN_RANGE||c.type===AstNodeType.ROW_RANGE){const f=this.evaluateRange(c,t,n,s,o,a,l);return f instanceof CellError?f:o(f,u)}let d;if(d=this.evaluateAst(c,t),d instanceof SimpleRangeValue)return Array.from(d.valuesFromTopLeftCorner()).map(l).filter(C=>C!==void 0).map(C=>C instanceof CellError?C:a(C)).reduce((C,m)=>C instanceof CellError?C:m instanceof CellError?m:o(C,m),u);if(c.type===AstNodeType.CELL_REFERENCE){if(d=l(d),d===void 0)return u}else if(d=this.coerceScalarToNumberOrError(d),d=l(d),d===void 0)return u;return d instanceof CellError?d:o(u,a(d))},n)}evaluateRange(e,t,n,s,o,a,l){let u;try{u=AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(f){if(f instanceof SheetsNotEqual)return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);throw f}const c=this.dependencyGraph.getRange(u.start,u.end);if(c===void 0)throw new Error("Range does not exists in graph");let d=c.getFunctionValue(s);return d===void 0&&(d=this.getRangeValues(s,u,c,a,l).reduce((C,m)=>C instanceof CellError?C:m instanceof CellError?m:o(C,m),n),c.setFunctionValue(s,d)),d}getRangeValues(e,t,n,s,o){const a=[],{smallerRangeVertex:l,restRange:u}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let c;if(l!==void 0&&this.dependencyGraph.existsEdge(l,n)){const d=l.getFunctionValue(e);if(d!==void 0)a.push(d);else for(const f of l.range.addresses(this.dependencyGraph)){const C=o(this.dependencyGraph.getScalarValue(f));C instanceof CellError?a.push(C):C!==void 0&&a.push(s(C))}c=u}else c=t;for(const d of c.addresses(this.dependencyGraph)){const f=o(this.dependencyGraph.getScalarValue(d));f instanceof CellError?a.push(f):f!==void 0&&a.push(s(f))}return a}}NumericAggregationPlugin.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1}};NumericAggregationPlugin.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function strictlyNumbers(r){if(isExtendedNumber(r)||r instanceof CellError)return r}function numbersBooleans(r){return typeof r=="boolean"?coerceBooleanToNumber(r):isExtendedNumber(r)||r instanceof CellError?r:typeof r=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class PowerPlugin extends FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}PowerPlugin.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RadiansPlugin extends FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}RadiansPlugin.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const MAX_LENGTH=10,DECIMAL_NUMBER_OF_BITS=255,MIN_BASE=2,MAX_BASE=36,ALPHABET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class RadixConversionPlugin extends FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(n,s)=>decimalToBaseWithExactPadding(n,2,s))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(n,s)=>decimalToBaseWithExactPadding(n,8,s))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(n,s)=>decimalToBaseWithExactPadding(n,16,s))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),n=>{const s=coerceStringToBase(n,2,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):twoComplementToDecimal(s,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(n,s)=>{const o=coerceStringToBase(n,2,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):decimalToBaseWithExactPadding(twoComplementToDecimal(o,2),8,s)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(n,s)=>{const o=coerceStringToBase(n,2,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):decimalToBaseWithExactPadding(twoComplementToDecimal(o,2),16,s)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),n=>{const s=coerceStringToBase(n,8,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):twoComplementToDecimal(s,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(n,s)=>{const o=coerceStringToBase(n,8,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):decimalToBaseWithExactPadding(twoComplementToDecimal(o,8),2,s)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(n,s)=>{const o=coerceStringToBase(n,8,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):decimalToBaseWithExactPadding(twoComplementToDecimal(o,8),16,s)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),n=>{const s=coerceStringToBase(n,16,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):twoComplementToDecimal(s,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(n,s)=>{const o=coerceStringToBase(n,16,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):decimalToBaseWithExactPadding(twoComplementToDecimal(o,16),2,s)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(n,s)=>{const o=coerceStringToBase(n,16,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):decimalToBaseWithExactPadding(twoComplementToDecimal(o,16),8,s)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),decimalToBaseWithMinimumPadding)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(n,s)=>{const o=coerceStringToBase(n,s,DECIMAL_NUMBER_OF_BITS);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):parseInt(o,s)})}}RadixConversionPlugin.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},DECIMAL:{method:"decimal",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,minValue:MIN_BASE,maxValue:MAX_BASE}]},BASE:{method:"base",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:MIN_BASE,maxValue:MAX_BASE},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:DECIMAL_NUMBER_OF_BITS}]}};function coerceStringToBase(r,e,t){const n=ALPHABET.substr(0,e),s=new RegExp(`^[${n}]+$`);if(!(r.length>t||!s.test(r)))return r}function decimalToBaseWithExactPadding(r,e,t){if(r>maxValFromBase(e))return new CellError(ErrorType.NUM,ErrorMessage.ValueBaseLarge);if(r<minValFromBase(e))return new CellError(ErrorType.NUM,ErrorMessage.ValueBaseSmall);const n=decimalToRadixComplement(r,e);return t===void 0||r<0?n:n.length>t?new CellError(ErrorType.NUM,ErrorMessage.ValueBaseLong):padLeft(n,t)}function minValFromBase(r){return-Math.pow(r,MAX_LENGTH)/2}function maxValFromBase(r){return-minValFromBase(r)-1}function decimalToBaseWithMinimumPadding(r,e,t){const n=decimalToRadixComplement(r,e);return t!==void 0&&t>n.length?padLeft(n,t):n}function decimalToRadixComplement(r,e){const t=r<0?Math.pow(e,MAX_LENGTH):0;return(r+t).toString(e).toUpperCase()}function twoComplementToDecimal(r,e){const t=parseInt(r,e),n=Math.pow(e,MAX_LENGTH);return t>=n/2?t-n:t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RandomPlugin extends FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(n,s)=>s<n?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.ceil(n),s=Math.floor(s)+1,n===s&&(s+=1),n+Math.floor(Math.random()*(s-n))))}}RandomPlugin.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function findNextOddNumber(r){const e=Math.ceil(r);return e%2===1?e:e+1}function findNextEvenNumber(r){const e=Math.ceil(r);return e%2===0?e:e+1}class RoundingPlugin extends FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),n=>n<0?-findNextEvenNumber(-n):findNextEvenNumber(n))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),n=>n<0?-findNextOddNumber(-n):findNextOddNumber(n))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(n,s,o)=>s===0||n===0?0:(s=Math.abs(s),o===1&&n<0&&(s=-s),Math.ceil(n/s)*s))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(n,s)=>n===0?0:s===0?new CellError(ErrorType.DIV_BY_ZERO):n>0&&s<0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.ceil(n/s)*s)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.ceil(n/s)*s))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(n,s,o)=>s===0||n===0?0:(s=Math.abs(s),o===1&&n<0&&(s*=-1),Math.floor(n/s)*s))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(n,s)=>n===0?0:s===0?new CellError(ErrorType.DIV_BY_ZERO):n>0&&s<0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.floor(n/s)*s)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.floor(n/s)*s))}}RoundingPlugin.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]}};RoundingPlugin.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SqrtPlugin extends FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}SqrtPlugin.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function*empty$1(){}function split$1(r){const e=r[Symbol.iterator](),{done:t,value:n}=e.next();return t?{rest:empty$1()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const findSmallerRangeForMany=(r,e,t)=>{if(t.end.row>t.start.row){const n=simpleCellAddress(t.end.sheet,t.end.col,t.end.row-1),s=r.getRange(t.start,n);if(s!==void 0)return{smallerRangeVertex:s,restValuesRange:t.withStart(simpleCellAddress(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(o=>o.withStart(simpleCellAddress(o.start.sheet,o.start.col,o.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class CriterionFunctionCompute{constructor(e,t,n,s,o){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=s,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const o of t)if(!o.conditionRange.sameDimensionsAs(e))return new CellError(ErrorType.VALUE,ErrorMessage.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),s=t.map(o=>this.tryToGetRangeVertexForRangeValue(o.conditionRange));if(n&&s.every(o=>o!==void 0)){const o=t.map(u=>u.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),o);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const l=this.buildNewCriterionCache(this.cacheKey(t),t.map(u=>u.conditionRange.range),e.range);return l.has(o)||l.set(o,[this.evaluateRangeValue(e,t),t.map(u=>u.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(t),l),s.forEach(u=>{u!==void 0&&u.addDependentCacheRange(n)}),l.get(o)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map(l=>l.criterionPackage.lambda),s=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=t.map(l=>l.conditionRange.iterateValuesFromTopLeftCorner()),a=ifFilter(n,o,s);return this.reduceFunction(a)}buildNewCriterionCache(e,t,n){const s=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:o,restConditionRanges:a,restValuesRange:l}=findSmallerRangeForMany(this.dependencyGraph,t,n);let u;o!==void 0&&this.dependencyGraph.existsEdge(o,s)?u=o.getCriterionFunctionValues(e):u=new Map;const c=new Map;return u.forEach(([d,f],C)=>{const m=ifFilter(f,a.map(v=>getRangeValues(this.dependencyGraph,v)),Array.from(getRangeValues(this.dependencyGraph,l)).map(this.mapFunction)[Symbol.iterator]()),E=this.composeFunction(d,this.reduceFunction(m));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),c.set(C,[E,f])}),c}}class Condition{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*getRangeValues(r,e){for(const t of e.addresses(r))yield getRawValue(r.getScalarValue(t))}function*ifFilter(r,e,t){for(const n of t){const s=e.map(a=>split$1(a));if(!s.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const o=s.map(a=>getRawValue(a.value));zip(o,r).every(([a,l])=>l(a))&&(yield n),e=s.map(a=>a.rest)}}function zip(r,e){const t=[];for(let n=0;n<Math.min(r.length,e.length);n++)t.push([r[n],e[n]]);return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AverageResult{constructor(e,t){this.sum=e,this.count=t}static single(e){return new AverageResult(e,1)}compose(e){return new AverageResult(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}AverageResult.empty=new AverageResult(0,0);function conditionalAggregationFunctionCacheKey(r){return e=>{const t=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[r,...t].join(",")}}function zeroForInfinite(r){return isExtendedNumber(r)&&!Number.isFinite(getRawValue(r))?0:r}function mapToRawScalarValue(r){if(r instanceof CellError)return r;if(isExtendedNumber(r))return getRawValue(r)}class ConditionalAggregationPlugin extends FunctionPlugin{sumif(e,t){const n="SUMIF",s=(o,a,l)=>this.computeConditionalAggregationFunction(l??o,[o,a],n,0,(u,c)=>this.arithmeticHelper.nonstrictadd(u,c),mapToRawScalarValue);return this.runFunction(e.args,t,this.metadata(n),s)}sumifs(e,t){const n="SUMIFS",s=(o,...a)=>this.computeConditionalAggregationFunction(o,a,n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),mapToRawScalarValue);return this.runFunction(e.args,t,this.metadata(n),s)}averageif(e,t){const n="AVERAGEIF",s=(o,a,l)=>{const u=this.computeConditionalAggregationFunction(l??o,[o,a],n,AverageResult.empty,(c,d)=>c.compose(d),c=>isExtendedNumber(c)?AverageResult.single(getRawValue(c)):AverageResult.empty);return u instanceof CellError?u:u.averageValue()||new CellError(ErrorType.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(n),s)}countif(e,t){const n="COUNTIF",s=(o,a)=>this.computeConditionalAggregationFunction(o,[o,a],n,0,(l,u)=>l+u,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}countifs(e,t){const n="COUNTIFS",s=(...o)=>this.computeConditionalAggregationFunction(o[0],o,n,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}minifs(e,t){const n="MINIFS",s=(a,l)=>l===void 0||a===void 0?l===void 0?a:l:Math.min(a,l),o=(a,...l)=>{const u=this.computeConditionalAggregationFunction(a,l,n,Number.POSITIVE_INFINITY,s,mapToRawScalarValue);return zeroForInfinite(u)};return this.runFunction(e.args,t,this.metadata(n),o)}maxifs(e,t){const n="MAXIFS",s=(a,l)=>l===void 0||a===void 0?l===void 0?a:l:Math.max(a,l),o=(a,...l)=>{const u=this.computeConditionalAggregationFunction(a,l,n,Number.NEGATIVE_INFINITY,s,mapToRawScalarValue);return zeroForInfinite(u)};return this.runFunction(e.args,t,this.metadata(n),o)}computeConditionalAggregationFunction(e,t,n,s,o,a){const l=[];for(let u=0;u<t.length;u+=2){const c=t[u],d=this.interpreter.criterionBuilder.fromCellValue(t[u+1],this.arithmeticHelper);if(d===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.BadCriterion);l.push(new Condition(c,d))}return new CriterionFunctionCompute(this.interpreter,conditionalAggregationFunctionCacheKey(n),s,o,a).compute(e,l)}}ConditionalAggregationPlugin.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SumprodPlugin extends FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...n)=>{const s=n[0].width(),o=n[0].height();for(const u of n)if(u.width()!==s||u.height()!==o)return new CellError(ErrorType.VALUE,ErrorMessage.EqualLength);let a=0;const l=n.map(u=>u.iterateValuesFromTopLeftCorner());for(let u=0;u<s*o;u++){let c=1;for(const d of l){const f=d.next().value;if(f instanceof CellError)return f;const C=this.coerceScalarToNumberOrError(f);isExtendedNumber(C)?c*=getRawValue(C):c=0}a+=c}return a})}}SumprodPlugin.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:FunctionArgumentType.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TextPlugin extends FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(n,s)=>{const o=n.split(" ");return s>=o.length||s<0?new CellError(ErrorType.VALUE,ErrorMessage.IndexBounds):o[s]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),n=>n.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),n=>n.replace(new RegExp("\\p{L}+","gu"),s=>s.charAt(0).toUpperCase()+s.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(n,s)=>n===s)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeCount):n.repeat(s))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):s===0?"":n.slice(-s))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.slice(0,s))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(n,s,o)=>s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.substring(s-1,s+o-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(n,s,o,a)=>s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.substring(0,s-1)+a+n.substring(s+o-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(n,s,o)=>{if(o<1||o>s.length)return new CellError(ErrorType.VALUE,ErrorMessage.LengthBounds);const a=n.toLowerCase(),l=s.substring(o-1).toLowerCase(),u=this.arithmeticHelper.requiresRegex(a)?this.arithmeticHelper.searchString(a,l):l.indexOf(a);return u>-1?u+o:new CellError(ErrorType.VALUE,ErrorMessage.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(n,s,o,a)=>{const l=this.escapeRegExpSpecialCharacters(s),u=new RegExp(l,"g");if(a===void 0)return n.replace(u,o);if(a<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);let c,d=0;for(;(c=u.exec(n))!==null;)if(a===++d)return n.substring(0,c.index)+o+n.substring(u.lastIndex);return n})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(n,s,o)=>{if(o<1||o>s.length)return new CellError(ErrorType.VALUE,ErrorMessage.IndexBounds);const l=s.substring(o-1).indexOf(n)+o;return l>0?l:new CellError(ErrorType.VALUE,ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),n=>n instanceof CellError||typeof n=="string"?n:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),n=>n.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}TextPlugin.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:FunctionArgumentType.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TrigonometryPlugin extends FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(n,s)=>n===0&&s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.atan2(s,n))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.tan(n))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),n=>n===0?PI/2:Math.atan(1/n))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),n=>n===0?new CellError(ErrorType.NUM,ErrorMessage.NonZero):Math.atanh(1/n))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.sinh(n))}}TrigonometryPlugin.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowSearchStrategy extends AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LookupPlugin extends FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(n,s,o,a)=>{const l=s.range;if(l===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(o<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);if(o>l.width())return new CellError(ErrorType.REF,ErrorMessage.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doVlookup(zeroIfEmpty(n),s,o-1,u)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(n,s,o,a)=>{const l=s.range;if(l===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(o<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);if(o>l.height())return new CellError(ErrorType.REF,ErrorMessage.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doHlookup(zeroIfEmpty(n),s,o-1,u)})}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),(n,s,o,a,l,u)=>{if(![0,-1,1,2].includes(l))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);if(![1,-1,2,-2].includes(u))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);const c=s instanceof SimpleRangeValue?s:SimpleRangeValue.fromScalar(s),d=o instanceof SimpleRangeValue?o:SimpleRangeValue.fromScalar(o),f=l===2,C={ordering:u===2?"asc":u===-2?"desc":"none",returnOccurrence:u===-1?"last":"first",ifNoMatch:l===-1?"returnLowerBound":l===1?"returnUpperBound":"returnNotFound"};return this.doXlookup(zeroIfEmpty(n),c,d,a,f,C)})}xlookupArraySize(e){var t,n;const s=(t=e==null?void 0:e.args)===null||t===void 0?void 0:t[1],o=(n=e==null?void 0:e.args)===null||n===void 0?void 0:n[2];if((s==null?void 0:s.start)==null||(s==null?void 0:s.end)==null||(o==null?void 0:o.start)==null||(o==null?void 0:o.end)==null)return ArraySize.error();const a=s.end.row-s.start.row+1,l=s.end.col-s.start.col+1,u=o.end.row-o.start.row+1,c=o.end.col-o.start.col+1,d=l===1&&u===a;return!d&&!(a===1&&c===l)?ArraySize.error():d?new ArraySize(c,1):new ArraySize(1,u)}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(n,s,o)=>this.doMatch(zeroIfEmpty(n),s,o))}searchInRange(e,t,n,s,o){return n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e)?o.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:s.returnOccurrence}):o.find(e,t,s)}doVlookup(e,t,n,s){this.dependencyGraph.stats.start(StatType.VLOOKUP);const o=t.range;let a;o===void 0?a=SimpleRangeValue.onlyValues(t.data.map(c=>[c[0]])):a=SimpleRangeValue.onlyRange(AbsoluteCellRange.spanFrom(o.start,1,o.height()),this.dependencyGraph);const l=this.searchInRange(e,a,s.ordering==="none",s,this.columnSearch);if(this.dependencyGraph.stats.end(StatType.VLOOKUP),l===-1)return new CellError(ErrorType.NA,ErrorMessage.ValueNotFound);let u;if(o===void 0)u=t.data[l][n];else{const c=simpleCellAddress(o.sheet,o.start.col+n,o.start.row+l);u=this.dependencyGraph.getCellValue(c)}return u instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):u}doHlookup(e,t,n,s){const o=t.range;let a;o===void 0?a=SimpleRangeValue.onlyValues([t.data[0]]):a=SimpleRangeValue.onlyRange(AbsoluteCellRange.spanFrom(o.start,o.width(),1),this.dependencyGraph);const l=this.searchInRange(e,a,s.ordering==="none",s,this.rowSearch);if(l===-1)return new CellError(ErrorType.NA,ErrorMessage.ValueNotFound);let u;if(o===void 0)u=t.data[n][l];else{const c=simpleCellAddress(o.sheet,o.start.col+l,o.start.row+n);u=this.dependencyGraph.getCellValue(c)}return u instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):u}doXlookup(e,t,n,s,o,a){const l=t.width()===1&&n.height()===t.height(),u=t.height()===1&&n.width()===t.width();if(!l&&!u)return new CellError(ErrorType.VALUE,ErrorMessage.WrongDimension);const c=l?this.columnSearch:this.rowSearch,d=this.searchInRange(e,t,o,a,c);if(d===-1)return s==ErrorType.NA?new CellError(ErrorType.NA,ErrorMessage.ValueNotFound):s;const f=l?[n.data[d]]:n.data.map(C=>[C[d]]);return SimpleRangeValue.onlyValues(f)}doMatch(e,t,n){if(![-1,0,1].includes(n))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);if(t.width()>1&&t.height()>1)return new CellError(ErrorType.NA);const s=t.width()===1?this.columnSearch:this.rowSearch,o=n===0?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:n===-1?"desc":"asc",ifNoMatch:n===-1?"returnUpperBound":"returnLowerBound"},a=s.find(e,t,o);return a===-1?new CellError(ErrorType.NA,ErrorMessage.ValueNotFound):a+1}}LookupPlugin.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",arraySizeMethod:"xlookupArraySize",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.SCALAR,optionalArg:!0,defaultValue:ErrorType.NA},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RomanPlugin extends FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(n,s)=>(n=Math.trunc(n),s===!1?s=4:s===!0&&(s=0),s=getRawValue(this.coerceScalarToNumberOrError(s)),s instanceof CellError?s:(s=Math.trunc(s),s<0?new CellError(ErrorType.VALUE,ErrorMessage.ValueSmall):s>4?new CellError(ErrorType.VALUE,ErrorMessage.ValueLarge):romanMode(n,s))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let s=!1;if(n.startsWith("-")&&(n=n.slice(1),s=!0,n===""))return new CellError(ErrorType.VALUE,ErrorMessage.InvalidRoman);const o={input:n,acc:0};return eatToken(o,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),eatToken(o,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),eatToken(o,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),eatToken(o,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),eatToken(o,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),eatToken(o,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),eatToken(o,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),eatToken(o,{token:"IX",val:9}),eatToken(o,{token:"V",val:5},{token:"IV",val:4}),eatToken(o,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),o.input!==""?new CellError(ErrorType.VALUE,ErrorMessage.InvalidRoman):s?-o.acc:o.acc})}}RomanPlugin.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:FunctionArgumentType.STRING}]}};function eatToken(r,...e){for(const t of e)if(r.input.startsWith(t.token)){r.input=r.input.slice(t.token.length),r.acc+=t.val;break}}function romanMode(r,e){const t={val:r%1e3,acc:"M".repeat(Math.floor(r/1e3))};return e===4&&(absorb(t,"IM",999,1e3),absorb(t,"ID",499,500)),e>=3&&(absorb(t,"VM",995,1e3),absorb(t,"VD",495,500)),e>=2&&(absorb(t,"XM",990,1e3),absorb(t,"XD",490,500)),e>=1&&(absorb(t,"LM",950,1e3),absorb(t,"LD",450,500)),absorb(t,"CM",900,1e3),absorb(t,"CD",400,500),absorb(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(absorb(t,"IC",99,100),absorb(t,"IL",49,50)),e>=1&&(absorb(t,"VC",95,100),absorb(t,"VL",45,50)),absorb(t,"XC",90,100),absorb(t,"XL",40,50),absorb(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,absorb(t,"IX",9,10),absorb(t,"IV",4,5),absorb(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function absorb(r,e,t,n){r.val>=t&&r.val<n&&(r.val-=t,r.acc+=e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SimpleArithmerticPlugin extends FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}SimpleArithmerticPlugin.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:FunctionArgumentType.STRING,passSubtype:!0},{argumentType:FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var M=Math;function _horner(r,e){for(var t=0,n=0;t<r.length;++t)n=e*n+r[t];return n}function _bessel_iter(r,e,t,n,s){if(e===0)return t;if(e===1)return n;for(var o=2/r,a=n,l=1;l<e;++l)a=n*l*o+s*t,t=n,n=a;return a}function _bessel_wrap(r,e,t,n,s){return function(a,l){if(n){if(a===0)return n==1?-1/0:1/0;if(a<0)return NaN}if(l===0)return r(a);if(l===1)return e(a);if(l<0)return NaN;l|=0;var u=r(a),c=e(a);return _bessel_iter(a,l,u,c,s)}}var besselj=function(){var r=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function o(f){var C=0,m=0,E=0,v=f*f;if(f<8)m=_horner(e,v),E=_horner(t,v),C=m/E;else{var _=f-.785398164;v=64/v,m=_horner(n,v),E=_horner(s,v),C=M.sqrt(r/f)*(M.cos(_)*m-M.sin(_)*E*8/f)}return C}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function d(f){var C=0,m=0,E=0,v=f*f,_=M.abs(f)-2.356194491;return Math.abs(f)<8?(m=f*_horner(a,v),E=_horner(l,v),C=m/E):(v=64/v,m=_horner(u,v),E=_horner(c,v),C=M.sqrt(r/M.abs(f))*(M.cos(_)*m-M.sin(_)*E*8/M.abs(f)),f<0&&(C=-C)),C}return function f(C,m){if(m=Math.round(m),!isFinite(C))return isNaN(C)?C:0;if(m<0)return(m%2?-1:1)*f(C,-m);if(C<0)return(m%2?-1:1)*f(-C,m);if(m===0)return o(C);if(m===1)return d(C);if(C===0)return 0;var E=0;if(C>m)E=_bessel_iter(C,m,o(C),d(C),-1);else{for(var v=2*M.floor((m+M.floor(M.sqrt(40*m)))/2),_=!1,T=0,R=0,O=1,N=0,G=2/C,D=v;D>0;D--)N=D*G*O-T,T=O,O=N,M.abs(O)>1e10&&(O*=1e-10,T*=1e-10,E*=1e-10,R*=1e-10),_&&(R+=O),_=!_,D==m&&(E=T);R=2*R-O,E/=R}return E}}(),bessely=function(){var r=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function o(f){var C=0,m=0,E=0,v=f*f,_=f-.785398164;return f<8?(m=_horner(e,v),E=_horner(t,v),C=m/E+r*besselj(f,0)*M.log(f)):(v=64/v,m=_horner(n,v),E=_horner(s,v),C=M.sqrt(r/f)*(M.sin(_)*m+M.cos(_)*E*8/f)),C}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function d(f){var C=0,m=0,E=0,v=f*f,_=f-2.356194491;return f<8?(m=f*_horner(a,v),E=_horner(l,v),C=m/E+r*(besselj(f,1)*M.log(f)-1/f)):(v=64/v,m=_horner(u,v),E=_horner(c,v),C=M.sqrt(r/f)*(M.sin(_)*m+M.cos(_)*E*8/f)),C}return _bessel_wrap(o,d,"BESSELY",1,-1)}(),besseli=function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(a){return a<=3.75?_horner(r,a*a/(3.75*3.75)):M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(e,3.75/M.abs(a))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),s=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function o(a){return a<3.75?a*_horner(n,a*a/(3.75*3.75)):(a<0?-1:1)*M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(s,3.75/M.abs(a))}return function a(l,u){if(u=Math.round(u),u===0)return t(l);if(u===1)return o(l);if(u<0)return NaN;if(M.abs(l)===0)return 0;if(l==1/0)return 1/0;var c=0,d,f=2/M.abs(l),C=0,m=1,E=0,v=2*M.round((u+M.round(M.sqrt(40*u)))/2);for(d=v;d>0;d--)E=d*f*m+C,C=m,m=E,M.abs(m)>1e10&&(m*=1e-10,C*=1e-10,c*=1e-10),d==u&&(c=C);return c*=a(l,0)/m,l<0&&u%2?-c:c}}(),besselk=function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(a){return a<=2?-M.log(a/2)*besseli(a,0)+_horner(r,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(e,2/a)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function o(a){return a<=2?M.log(a/2)*besseli(a,1)+1/a*_horner(n,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(s,2/a)}return _bessel_wrap(t,o,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function erf(r){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,n=!1,s=0,o=0,a,l,u,c;if(r===0)return 0;for(r<0&&(r=-r,n=!0),a=2/(2+r),l=4*a-2;t>0;t--)u=s,s=l*s-o+e[t],o=u;return c=a*Math.exp(-r*r+.5*(e[0]+l*s)-o),n?c-1:1-c}function erfc(r){return 1-erf(r)}function erfcinv(r){let e=0,t,n,s,o;if(r>=2)return-100;if(r<=0)return 100;for(o=r<1?r:2-r,s=Math.sqrt(-2*Math.log(o/2)),t=-.70711*((2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s);e<2;e++)n=erfc(t)-o,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return r<1?t:-t}const exponential={pdf:(r,e)=>r<0?0:e*Math.exp(-e*r),cdf:(r,e)=>r<0?0:1-Math.exp(-e*r)};function gammafn(r){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,s=0,o=0,a=0,l=r,u,c,d,f;if(r>171.6243769536076)return 1/0;if(l<=0)if(f=l%1,f)n=(l&1?-1:1)*Math.PI/Math.sin(Math.PI*f),l=1-l;else return 1/0;for(d=l,l<1?c=l++:c=(l-=s=(l|0)-1)-1,u=0;u<8;++u)a=(a+e[u])*c,o=o*c+t[u];if(f=a/o+1,d<l)f/=d;else if(d>l)for(u=0;u<s;++u)f*=l,l++;return n&&(f=n/f),f}const gamma={pdf:function(e,t,n){return e<0?0:e===0&&t===1?1/n:Math.exp((t-1)*Math.log(e)-e/n-gammaln(t)-t*Math.log(n))},cdf:function(e,t,n){return e<0?0:lowRegGamma(t,e/n)},inv:function(r,e,t){return gammapinv(r,e)*t}};function gammaln(r){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,s,o,a;for(a=(o=s=r)+5.5,a-=(s+.5)*Math.log(a);e<6;e++)n+=t[e]/++o;return Math.log(2.5066282746310007*n/s)-a}function lowRegGamma(r,e){const t=gammaln(r);let n=r,s=1/r,o=s,a=e+1-r,l=1/1e-30,u=1/a,c=u,d=1;const f=-~(Math.log(r>=1?r:1/r)*8.5+r*.4+17);let C;if(e<0||r<=0)return NaN;if(e<r+1){for(;d<=f;d++)s+=o*=e/++n;return s*Math.exp(-e+r*Math.log(e)-t)}for(;d<=f;d++)C=-d*(d-r),a+=2,u=C*u+a,l=a+C/l,u=1/u,c*=u*l;return 1-c*Math.exp(-e+r*Math.log(e)-t)}function gammapinv(r,e){let t=0;const n=e-1,s=1e-8,o=gammaln(e);let a,l,u,c,d,f,C;if(r>=1)return Math.max(100,e+100*Math.sqrt(e));if(r<=0)return 0;for(e>1?(f=Math.log(n),C=Math.exp(n*(f-1)-o),d=r<.5?r:1-r,u=Math.sqrt(-2*Math.log(d)),a=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,r<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(u=1-e*(.253+e*.12),r<u?a=Math.pow(r/u,1/e):a=1-Math.log(1-(r-u)/(1-u)));t<12;t++){if(a<=0)return 0;if(l=lowRegGamma(e,a)-r,e>1?u=C*Math.exp(-(a-n)+n*(Math.log(a)-f)):u=Math.exp(-a+n*Math.log(a)-o),c=l/u,a-=u=c/(1-.5*Math.min(1,c*((e-1)/a-1))),a<=0&&(a=.5*(a+u)),Math.abs(u)<s*a)break}return a}const normal={pdf:function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return .5*(1+erf((e-t)/Math.sqrt(2*n*n)))},inv:function(r,e,t){return-1.4142135623730951*t*erfcinv(2*r)+e}},beta={pdf:function(e,t,n){return e>1||e<0?0:t==1&&n==1?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/betafn(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-betaln(t,n))},cdf:function(e,t,n){return e>1||e<0?+(e>1):ibeta(e,t,n)},inv:function(e,t,n){return ibetainv(e,t,n)}};function betafn(r,e){if(!(r<=0||e<=0))return r+e>170?Math.exp(betaln(r,e)):gammafn(r)*gammafn(e)/gammafn(r+e)}function betaln(r,e){return gammaln(r)+gammaln(e)-gammaln(r+e)}function ibetainv(r,e,t){var n=1e-8,s=e-1,o=t-1,a=0,l,u,c,d,f,C,m,E,v,_,T;if(r<=0)return 0;if(r>=1)return 1;for(e>=1&&t>=1?(c=r<.5?r:1-r,d=Math.sqrt(-2*Math.log(c)),m=(2.30753+d*.27061)/(1+d*(.99229+d*.04481))-d,r<.5&&(m=-m),E=(m*m-3)/6,v=2/(1/(2*e-1)+1/(2*t-1)),_=m*Math.sqrt(E+v)/v-(1/(2*t-1)-1/(2*e-1))*(E+5/6-2/(3*v)),m=e/(e+t*Math.exp(2*_))):(l=Math.log(e/(e+t)),u=Math.log(t/(e+t)),d=Math.exp(e*l)/e,f=Math.exp(t*u)/t,_=d+f,r<d/_?m=Math.pow(e*_*r,1/e):m=1-Math.pow(t*_*(1-r),1/t)),T=-gammaln(e)-gammaln(t)+gammaln(e+t);a<10;a++){if(m===0||m===1)return m;if(C=ibeta(m,e,t)-r,d=Math.exp(s*Math.log(m)+o*Math.log(1-m)+T),f=C/d,m-=d=f/(1-.5*Math.min(1,f*(s/m-o/(1-m)))),m<=0&&(m=.5*(m+d)),m>=1&&(m=.5*(m+d+1)),Math.abs(d)<n*m&&a>0)break}return m}function ibeta(r,e,t){var n=r===0||r===1?0:Math.exp(gammaln(e+t)-gammaln(e)-gammaln(t)+e*Math.log(r)+t*Math.log(1-r));return r<0||r>1?!1:r<(e+1)/(e+t+2)?n*betacf(r,e,t)/e:1-n*betacf(1-r,t,e)/t}function betacf(r,e,t){var n=1e-30,s=1,o=e+t,a=e+1,l=e-1,u=1,c=1-o*r/a,d,f,C,m;for(Math.abs(c)<n&&(c=n),c=1/c,m=c;s<=100&&(d=2*s,f=s*(t-s)*r/((l+d)*(e+d)),c=1+f*c,Math.abs(c)<n&&(c=n),u=1+f/u,Math.abs(u)<n&&(u=n),c=1/c,m*=c*u,f=-(e+s)*(o+s)*r/((e+d)*(a+d)),c=1+f*c,Math.abs(c)<n&&(c=n),u=1+f/u,Math.abs(u)<n&&(u=n),c=1/c,C=c*u,m*=C,!(Math.abs(C-1)<3e-7));s++);return m}const binomial={pdf:function(r,e,t){return t===0||t===1?e*t===r?1:0:combination(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r)},cdf:function(r,e,t){var n,s=1e-10;if(r<0)return 0;if(r>=e)return 1;if(t<0||t>1||e<=0)return NaN;r=Math.floor(r);var o=t,a=r+1,l=e-r,u=a+l,c=Math.exp(gammaln(u)-gammaln(l)-gammaln(a)+a*Math.log(o)+l*Math.log(1-o));return o<(a+1)/(u+2)?n=c*betinc(o,a,l,s):n=1-c*betinc(1-o,l,a,s),Math.round((1-n)*(1/s))/(1/s)}};function betinc(r,e,t,n){for(var s=0,o=1,a=1,l=1,u=0,c=0,d;Math.abs((a-c)/a)>n;)c=a,d=-(e+u)*(e+t+u)*r/(e+2*u)/(e+2*u+1),s=a+d*s,o=l+d*o,u=u+1,d=u*(t-u)*r/(e+2*u-1)/(e+2*u),a=s+d*a,l=o+d*l,s=s/l,o=o/l,a=a/l,l=1;return a/e}function combination(r,e){return r>170||e>170?Math.exp(combinationln(r,e)):factorial(r)/factorial(e)/factorial(r-e)}function combinationln(r,e){return factorialln(r)-factorialln(e)-factorialln(r-e)}function factorialln(r){return r<0?NaN:gammaln(r+1)}function factorial(r){return r<0?NaN:gammafn(r+1)}const chisquare={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-gammaln(t/2))},cdf:function(e,t){return e<0?0:lowRegGamma(t/2,e/2)},inv:function(r,e){return 2*gammapinv(r,.5*e)}},centralF={pdf:function(e,t,n){var s,o,a;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/betafn(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):(s=t*e/(n+e*t),o=n/(n+e*t),a=t*o/2,a*binomial.pdf((t-2)/2,(t+n-2)/2,s))},cdf:function(e,t,n){return e<0?0:ibeta(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/ibetainv(e,t/2,n/2)-1))}},weibull={pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}},poisson={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/factorial(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var s=0;n<=e;n++)s+=poisson.pdf(n,t);return s}},hypgeom={pdf:function(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>s||e>n)return 0;if(n*2>t)return s*2>t?hypgeom.pdf(t-n-s+e,t,t-n,t-s):hypgeom.pdf(s-e,t,t-n,s);if(s*2>t)return hypgeom.pdf(n-e,t,n,t-s);if(n<s)return hypgeom.pdf(e,t,s,n);for(var o=1,a=0,l=0;l<e;l++){for(;o>1&&a<s;)o*=1-n/(t-a),a++;o*=(s-l)*(n-l)/((l+1)*(t-n-s+l+1))}for(;a<s;a++)o*=1-n/(t-a);return Math.min(1,Math.max(0,o))},cdf:function r(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>=s||e>=n)return 1;if(n*2>t)return s*2>t?r(t-n-s+e,t,t-n,t-s):1-hypgeom.cdf(s-e-1,t,t-n,s);if(s*2>t)return 1-hypgeom.cdf(n-e-1,t,n,t-s);if(n<s)return hypgeom.cdf(e,t,s,n);for(var o=1,a=1,l=0,u=0;u<e;u++){for(;o>1&&l<s;){var c=1-n/(t-l);a*=c,o*=c,l++}a*=(s-u)*(n-u)/((u+1)*(t-n-s+u+1)),o+=a}for(;l<s;l++)o*=1-n/(t-l);return Math.min(1,Math.max(0,o))}},studentt={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*betafn(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var n=t/2;return ibeta((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},inv:function(r,e){var t=ibetainv(2*Math.min(r,1-r),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),r>.5?t:-t}},lognormal={pdf:function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*erf((Math.log(e)-t)/Math.sqrt(2*n*n))},inv:function(r,e,t){return Math.exp(-1.4142135623730951*t*erfcinv(2*r)+e)}},negbin={pdf:function(e,t,n){return e!==e>>>0?!1:e<0?0:combination(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t)},cdf:function(e,t,n){var s=0,o=0;if(e<0)return 0;for(;o<=e;o++)s+=negbin.pdf(o,t,n);return s}};function sum(r){for(var e=0,t=r.length;--t>=0;)e+=r[t];return e}function mean(r){return sum(r)/r.length}function sumsqerr(r){for(var e=mean(r),t=0,n=r.length,s;--n>=0;)s=r[n]-e,t+=s*s;return t}function variance(r,e){return sumsqerr(r)/(r.length-(e?1:0))}function stdev(r,e){return Math.sqrt(variance(r,e))}function normalci(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(normal.inv(r[1]/2,0,1)*r[2]/Math.sqrt(r[3])):t=Math.abs(normal.inv(r[1]/2,0,1)*stdev(r[2])/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function tci(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(studentt.inv(r[1]/2,r[3]-1)*r[2]/Math.sqrt(r[3])):t=Math.abs(studentt.inv(r[1]/2,r[2].length-1)*stdev(r[2],!0)/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function product(r){for(var e=1,t=r.length;--t>=0;)e*=r[t];return e}function geomean(r){return Math.pow(product(r),1/r.length)}function covariance(r,e){var t=mean(r),n=mean(e),s=r.length,o=new Array(s),a;for(a=0;a<s;a++)o[a]=(r[a]-t)*(e[a]-n);return sum(o)/(s-1)}function corrcoeff(r,e){return covariance(r,e)/stdev(r,1)/stdev(e,1)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class StatisticalPlugin extends FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(n,s)=>s===void 0?erf(n):erf(s)-erf(n))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(n,s,o)=>o?exponential.cdf(n,s):exponential.pdf(n,s))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(n,s,o,a)=>a?gamma.cdf(n,s,o):gamma.pdf(n,s,o))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),n=>normal.cdf(n,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(n,s,o,a,l,u)=>n<=l?new CellError(ErrorType.NUM,ErrorMessage.ValueSmall):n>=u?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(n=(n-l)/(u-l),a?beta.cdf(n,s,o):beta.pdf(n,s,o)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(n,s,o,a,l)=>a>=l?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):beta.inv(n,s,o)*(l-a)+a)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(n,s,o,a)=>n>s?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),a?binomial.cdf(n,s,o):binomial.pdf(n,s,o)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(n,s,o)=>{n=Math.trunc(n);let a=-1,l=n;for(;l>a+1;){const u=Math.trunc((a+l)/2);binomial.cdf(u,n,s)>=o?l=u:a=u}return l})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(n,s)=>besseli(n,Math.trunc(s)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(n,s)=>besselj(n,Math.trunc(s)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(n,s)=>besselk(n,Math.trunc(s)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(n,s)=>bessely(n,Math.trunc(s)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(n,s,o)=>(s=Math.trunc(s),o?chisquare.cdf(n,s):chisquare.pdf(n,s)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(n,s)=>1-chisquare.cdf(n,Math.trunc(s)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(n,s)=>chisquare.inv(n,Math.trunc(s)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(n,s)=>chisquare.inv(1-n,Math.trunc(s)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(n,s,o,a)=>(s=Math.trunc(s),o=Math.trunc(o),a?centralF.cdf(n,s,o):centralF.pdf(n,s,o)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(n,s,o)=>1-centralF.cdf(n,Math.trunc(s),Math.trunc(o)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(n,s,o)=>centralF.inv(n,Math.trunc(s),Math.trunc(o)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(n,s,o)=>centralF.inv(1-n,Math.trunc(s),Math.trunc(o)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(n,s,o,a)=>a?weibull.cdf(n,o,s):weibull.pdf(n,o,s))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(n,s,o)=>(n=Math.trunc(n),o?poisson.cdf(n,s):poisson.pdf(n,s)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(n,s,o,a,l)=>n>s||n>o||s>a||o>a?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):n+a<o+s?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(n=Math.trunc(n),s=Math.trunc(s),o=Math.trunc(o),a=Math.trunc(a),l?hypgeom.cdf(n,a,o,s):hypgeom.pdf(n,a,o,s)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(n,s,o)=>(s=Math.trunc(s),o?studentt.cdf(n,s):studentt.pdf(n,s)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(n,s)=>(1-studentt.cdf(n,Math.trunc(s)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(n,s)=>1-studentt.cdf(n,Math.trunc(s)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(n,s,o)=>o*(1-studentt.cdf(n,Math.trunc(s))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(n,s)=>studentt.inv(n,Math.trunc(s)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(n,s)=>studentt.inv(1-n/2,Math.trunc(s)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(n,s,o,a)=>a?lognormal.cdf(n,s,o):lognormal.pdf(n,s,o))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(n,s,o)=>lognormal.inv(n,s,o))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(n,s,o,a)=>a?normal.cdf(n,s,o):normal.pdf(n,s,o))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(n,s,o)=>normal.inv(n,s,o))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(n,s)=>s?normal.cdf(n,0,1):normal.pdf(n,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),n=>normal.inv(n,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),n=>normal.pdf(n,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(n,s,o,a)=>(n=Math.trunc(n),s=Math.trunc(s),a?negbin.cdf(n,s,o):negbin.pdf(n,s,o)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(n,s,o)=>normalci(1,n,s,Math.trunc(o))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(n,s,o)=>(o=Math.trunc(o),o===1?new CellError(ErrorType.DIV_BY_ZERO):tci(1,n,s,o)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(n,s,o)=>(n-s)/o)}}StatisticalPlugin.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]}};StatisticalPlugin.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MathPlugin extends FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),n=>{n=Math.trunc(n);let s=1;for(let o=1;o<=n;o++)s*=o;return s})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let s=1;for(let o=n;o>=1;o-=2)s*=o;return s})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(n,s)=>s>n?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),combin(n,s)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(n,s)=>(n=Math.trunc(n),s=Math.trunc(s),n+s-1>=1030?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):n===0&&s===0?1:combin(n+s-1,s)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof CellError)return s;let o=0;for(const a of s){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);o=binaryGCD(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof CellError)return s;let o=1;for(const a of s){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);o=binaryLCM(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(n,s)=>s===0?0:n>0&&s<0||n<0&&s>0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.round(n/s)*s)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...n)=>{let s=0,o=1;for(let a of n){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);a=Math.trunc(a);for(let l=1;l<=a;l++)o*=(s+l)/l;s+=a}return Math.round(o)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(n,s)=>s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.trunc(n/s))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(n,s,o,a)=>{const l=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(l instanceof CellError)return l;let u=0;l.reverse();for(const c of l)u*=Math.pow(n,o),u+=c;return u*Math.pow(n,s)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const d=o[c],f=a[c];if(d instanceof CellError)return d;if(f instanceof CellError)return f;typeof d=="number"&&typeof f=="number"&&(u+=Math.pow(d,2)-Math.pow(f,2))}return u})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const d=o[c],f=a[c];if(d instanceof CellError)return d;if(f instanceof CellError)return f;typeof d=="number"&&typeof f=="number"&&(u+=Math.pow(d,2)+Math.pow(f,2))}return u})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const d=o[c],f=a[c];if(d instanceof CellError)return d;if(f instanceof CellError)return f;typeof d=="number"&&typeof f=="number"&&(u+=Math.pow(d-f,2))}return u})}}MathPlugin.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]}};function combin(r,e){2*e>r&&(e=r-e);let t=1;for(let n=1;n<=e;n++)t*=(r-e+n)/n;return Math.round(t)}function binaryGCD(r,e){for(r<e&&([r,e]=[e,r]);e>0;)[r,e]=[e,r%e];return r}function binaryLCM(r,e){return r===0||e===0?0:r*(e/binaryGCD(r,e))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ComplexPlugin extends FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(n,s,o)=>o!=="i"&&o!=="j"?new CellError(ErrorType.VALUE,ErrorMessage.ShouldBeIorJ):coerceComplexToString([n,s],o))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),abs)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([n,s])=>s)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([n,s])=>n)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([n,s])=>n===0&&s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.atan2(s,n))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([n,s])=>coerceComplexToString([n,-s]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),n=>coerceComplexToString(cos(n)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),n=>coerceComplexToString(cosh(n)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),n=>coerceComplexToString(div$1(cos(n),sin(n))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),n=>coerceComplexToString(div$1([1,0],sin(n))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),n=>coerceComplexToString(div$1([1,0],sinh(n))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),n=>coerceComplexToString(div$1([1,0],cos(n))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),n=>coerceComplexToString(div$1([1,0],cosh(n))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),n=>coerceComplexToString(sin(n)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),n=>coerceComplexToString(sinh(n)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),n=>coerceComplexToString(div$1(sin(n),cos(n))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(n,s)=>coerceComplexToString(div$1(n,s)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof CellError)return s;let o=[1,0];for(const a of s)o=mul(o,a);return coerceComplexToString(o)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof CellError)return s;let o=[0,0];for(const a of s)o=add(o,a);return coerceComplexToString(o)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(n,s)=>coerceComplexToString(sub(n,s)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),n=>coerceComplexToString(exp(n)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),n=>coerceComplexToString(ln(n)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),n=>{const[s,o]=ln(n),a=Math.log(10);return coerceComplexToString([s/a,o/a])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),n=>{const[s,o]=ln(n),a=Math.log(2);return coerceComplexToString([s/a,o/a])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(n,s)=>coerceComplexToString(power(n,s)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),n=>coerceComplexToString(power(n,.5)))}}ComplexPlugin.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]}};function add([r,e],[t,n]){return[r+t,e+n]}function sub([r,e],[t,n]){return[r-t,e-n]}function mul([r,e],[t,n]){return[r*t-e*n,r*n+t*e]}function div$1([r,e],[t,n]){const s=Math.pow(t,2)+Math.pow(n,2),[o,a]=mul([r,e],[t,-n]);return[o/s,a/s]}function cos([r,e]){return[Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e)]}function cosh([r,e]){return[Math.cosh(r)*Math.cos(e),Math.sinh(r)*Math.sin(e)]}function sin([r,e]){return[Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e)]}function sinh([r,e]){return[Math.sinh(r)*Math.cos(e),Math.cosh(r)*Math.sin(e)]}function exp([r,e]){return[Math.exp(r)*Math.cos(e),Math.exp(r)*Math.sin(e)]}function abs([r,e]){return Math.sqrt(r*r+e*e)}function ln([r,e]){return[Math.log(abs([r,e])),Math.atan2(e,r)]}function power(r,e){const[t,n]=ln(r);return exp([e*t,e*n])}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class StatisticalAggregationPlugin extends FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.DIV_BY_ZERO);const o=mean(s);return s.reduce((a,l)=>a+Math.abs(l-o),0)/s.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof CellError?s:s.length===0?0:sumsqerr(s)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.NUM,ErrorMessage.OneValue);for(const o of s)if(o<=0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);return geomean(s)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.NUM,ErrorMessage.OneValue);for(const o of s)if(o<=0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);return s.length/s.reduce((o,a)=>o+1/a,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):corrcoeff(o[0],o[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):Math.pow(corrcoeff(o[0],o[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.OneValue):a===1?0:covariance(o[0],o[1])*(a-1)/a})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):covariance(o[0],o[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(n,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof CellError)return a;const l=a.length;if(o===void 0){if(l<2)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);o=stdev(a,!0)}return l<1?new CellError(ErrorType.NA,ErrorMessage.OneValue):o===0?new CellError(ErrorType.DIV_BY_ZERO):1-normal.cdf((mean(a)-s)/(o/Math.sqrt(l)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(o instanceof CellError)return o;if(a instanceof CellError)return a;if(o.length<=1||a.length<=1)return new CellError(ErrorType.DIV_BY_ZERO);const l=variance(o,!0),u=variance(a,!0);if(l===0||u===0)return new CellError(ErrorType.DIV_BY_ZERO);const c=l/u,d=centralF.cdf(c,o.length-1,a.length-1);return 2*Math.min(d,1-d)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<=2?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues):Math.sqrt((sumsqerr(o[0])-Math.pow(covariance(o[0],o[1])*(a-1),2)/sumsqerr(o[1]))/(a-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):covariance(o[0],o[1])*(a-1)/sumsqerr(o[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(n,s)=>{const o=n.height(),a=n.width();if(s.height()!==o||s.width()!==a)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=parseTwoArrays(n,s);if(l instanceof CellError)return l;if(l[0].length<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);let u=0;for(let c=0;c<l[0].length;c++){if(l[1][c]===0)return new CellError(ErrorType.DIV_BY_ZERO);u+=Math.pow(l[0][c]-l[1][c],2)/l[1][c]}return u<0?new CellError(ErrorType.NUM,ErrorMessage.NaN):1-chisquare.cdf(u,o>1&&a>1?(o-1)*(a-1):o*a-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(n,s,o,a)=>{const l=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),u=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(l instanceof CellError)return l;if(u instanceof CellError)return u;const c=l.length,d=u.length;if(a===1){if(d!==c)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);if(c<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const f=Array(c);for(let E=0;E<c;E++)f[E]=l[E]-u[E];const C=stdev(f,!0);if(C===0)return new CellError(ErrorType.DIV_BY_ZERO);const m=Math.abs(Math.sqrt(c)*mean(f)/C);return o*(1-studentt.cdf(m,c-1))}else if(a===2){if(c<=1||d<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const f=(sumsqerr(l)+sumsqerr(u))/(c+d-2);if(f===0)return new CellError(ErrorType.DIV_BY_ZERO);const C=Math.abs((mean(l)-mean(u))/Math.sqrt(f*(1/c+1/d)));return o*(1-studentt.cdf(C,c+d-2))}else{if(c<=1||d<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const f=variance(l,!0),C=variance(u,!0);if(f===0&&C===0)return new CellError(ErrorType.DIV_BY_ZERO);const m=Math.abs((mean(l)-mean(u))/Math.sqrt(f/c+C/d)),E=Math.pow(f/c+C/d,2)/(Math.pow(f/c,2)/(c-1)+Math.pow(C/d,2)/(d-1));return o*(1-studentt.cdf(m,E))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;const o=s.length;if(o<3)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues);const a=mean(s),l=stdev(s,!0);return l===0?new CellError(ErrorType.DIV_BY_ZERO):s.reduce((u,c)=>u+Math.pow((c-a)/l,3),0)*o/(o-1)/(o-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;const o=s.length;if(o<3)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues);const a=mean(s),l=stdev(s,!1);return l===0?new CellError(ErrorType.DIV_BY_ZERO):s.reduce((u,c)=>u+Math.pow((c-a)/l,3),0)/o})}}StatisticalAggregationPlugin.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1}};StatisticalAggregationPlugin.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function parseTwoArrays(r,e){const t=r.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let s,o;const a=[],l=[];for(;s=t.next(),o=n.next(),!s.done&&!o.done;){const u=s.value,c=o.value;if(u instanceof CellError)return u;if(c instanceof CellError)return c;isExtendedNumber(u)&&isExtendedNumber(c)&&(a.push(getRawValue(u)),l.push(getRawValue(c)))}return[a,l]}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const plugins=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin,AddressPlugin,ArrayPlugin,BitShiftPlugin,BitwiseLogicOperationsPlugin,BooleanPlugin,CharPlugin,CodePlugin,ComplexPlugin,ConditionalAggregationPlugin,CountBlankPlugin,CountUniquePlugin,DateTimePlugin,DegreesPlugin,DeltaPlugin,ExpPlugin,FinancialPlugin,FormulaTextPlugin,HyperlinkPlugin,InformationPlugin,IsEvenPlugin,IsOddPlugin,LogarithmPlugin,LookupPlugin,MathConstantsPlugin,MathPlugin,MatrixPlugin,MedianPlugin,ModuloPlugin,NumericAggregationPlugin,PowerPlugin,RadiansPlugin,RadixConversionPlugin,RandomPlugin,RomanPlugin,RoundingPlugin,SimpleArithmerticPlugin,SqrtPlugin,StatisticalAggregationPlugin,StatisticalPlugin,SumprodPlugin,TextPlugin,TrigonometryPlugin},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperFormulaNS extends HyperFormula{}HyperFormulaNS.HyperFormula=HyperFormula;HyperFormulaNS.ErrorType=ErrorType;HyperFormulaNS.CellError=CellError;HyperFormulaNS.CellType=CellType;HyperFormulaNS.CellValueType=CellValueType;HyperFormulaNS.CellValueDetailedType=CellValueDetailedType;HyperFormulaNS.DetailedCellError=DetailedCellError;HyperFormulaNS.ExportedCellChange=ExportedCellChange;HyperFormulaNS.ExportedNamedExpressionChange=ExportedNamedExpressionChange;HyperFormulaNS.ConfigValueTooBigError=ConfigValueTooBigError;HyperFormulaNS.ConfigValueTooSmallError=ConfigValueTooSmallError;HyperFormulaNS.EvaluationSuspendedError=EvaluationSuspendedError;HyperFormulaNS.ExpectedOneOfValuesError=ExpectedOneOfValuesError;HyperFormulaNS.ExpectedValueOfTypeError=ExpectedValueOfTypeError;HyperFormulaNS.ArraySize=ArraySize;HyperFormulaNS.SimpleRangeValue=SimpleRangeValue;HyperFormulaNS.EmptyValue=EmptyValue;HyperFormulaNS.FunctionPlugin=FunctionPlugin;HyperFormulaNS.FunctionArgumentType=FunctionArgumentType;HyperFormulaNS.FunctionPluginValidationError=FunctionPluginValidationError;HyperFormulaNS.InvalidAddressError=InvalidAddressError;HyperFormulaNS.InvalidArgumentsError=InvalidArgumentsError;HyperFormulaNS.LanguageNotRegisteredError=LanguageNotRegisteredError;HyperFormulaNS.LanguageAlreadyRegisteredError=LanguageAlreadyRegisteredError;HyperFormulaNS.MissingTranslationError=MissingTranslationError;HyperFormulaNS.NamedExpressionDoesNotExistError=NamedExpressionDoesNotExistError;HyperFormulaNS.NamedExpressionNameIsAlreadyTakenError=NamedExpressionNameIsAlreadyTakenError;HyperFormulaNS.NamedExpressionNameIsInvalidError=NamedExpressionNameIsInvalidError;HyperFormulaNS.NoOperationToRedoError=NoOperationToRedoError;HyperFormulaNS.NoOperationToUndoError=NoOperationToUndoError;HyperFormulaNS.NoRelativeAddressesAllowedError=NoRelativeAddressesAllowedError;HyperFormulaNS.NoSheetWithIdError=NoSheetWithIdError;HyperFormulaNS.NoSheetWithNameError=NoSheetWithNameError;HyperFormulaNS.NotAFormulaError=NotAFormulaError;HyperFormulaNS.NothingToPasteError=NothingToPasteError;HyperFormulaNS.ProtectedFunctionTranslationError=ProtectedFunctionTranslationError;HyperFormulaNS.SheetNameAlreadyTakenError=SheetNameAlreadyTakenError;HyperFormulaNS.SheetSizeLimitExceededError=SheetSizeLimitExceededError;HyperFormulaNS.SourceLocationHasArrayError=SourceLocationHasArrayError;HyperFormulaNS.TargetLocationHasArrayError=TargetLocationHasArrayError;HyperFormulaNS.UnableToParseError=UnableToParseError;const defaultLanguage=Config.defaultConfig.language;HyperFormula.registerLanguage(defaultLanguage,dictionary);HyperFormula.languages[dictionary.langCode]=dictionary;for(const r of Object.getOwnPropertyNames(plugins))r.startsWith("_")||HyperFormula.registerFunctionPlugin(plugins[r]);function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$3={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(r,e){(function(t,n){r.exports=n()})(jsuites,function(){var t;return function(){var n={195:function(l){(function(u,c){l.exports=c()})(this,function(){return function(ue){function c(Ue,Ie){this.highOrder=Ue,this.lowOrder=Ie}var d=[new c(1779033703,4089235720),new c(3144134277,2227873595),new c(1013904242,4271175723),new c(2773480762,1595750129),new c(1359893119,2917565137),new c(2600822924,725511199),new c(528734635,4215389547),new c(1541459225,327033209)],f=[new c(1116352408,3609767458),new c(1899447441,602891725),new c(3049323471,3964484399),new c(3921009573,2173295548),new c(961987163,4081628472),new c(1508970993,3053834265),new c(2453635748,2937671579),new c(2870763221,3664609560),new c(3624381080,2734883394),new c(310598401,1164996542),new c(607225278,1323610764),new c(1426881987,3590304994),new c(1925078388,4068182383),new c(2162078206,991336113),new c(2614888103,633803317),new c(3248222580,3479774868),new c(3835390401,2666613458),new c(4022224774,944711139),new c(264347078,2341262773),new c(604807628,2007800933),new c(770255983,1495990901),new c(1249150122,1856431235),new c(1555081692,3175218132),new c(1996064986,2198950837),new c(2554220882,3999719339),new c(2821834349,766784016),new c(2952996808,2566594879),new c(3210313671,3203337956),new c(3336571891,1034457026),new c(3584528711,2466948901),new c(113926993,3758326383),new c(338241895,168717936),new c(666307205,1188179964),new c(773529912,1546045734),new c(1294757372,1522805485),new c(1396182291,2643833823),new c(1695183700,2343527390),new c(1986661051,1014477480),new c(2177026350,1206759142),new c(2456956037,344077627),new c(2730485921,1290863460),new c(2820302411,3158454273),new c(3259730800,3505952657),new c(3345764771,106217008),new c(3516065817,3606008344),new c(3600352804,1432725776),new c(4094571909,1467031594),new c(275423344,851169720),new c(430227734,3100823752),new c(506948616,1363258195),new c(659060556,3750685593),new c(883997877,3785050280),new c(958139571,3318307427),new c(1322822218,3812723403),new c(1537002063,2003034995),new c(1747873779,3602036899),new c(1955562222,1575990012),new c(2024104815,1125592928),new c(2227730452,2716904306),new c(2361852424,442776044),new c(2428436474,593698344),new c(2756734187,3733110249),new c(3204031479,2999351573),new c(3329325298,3815920427),new c(3391569614,3928383900),new c(3515267271,566280711),new c(3940187606,3454069534),new c(4118630271,4000239992),new c(116418474,1914138554),new c(174292421,2731055270),new c(289380356,3203993006),new c(460393269,320620315),new c(685471733,587496836),new c(852142971,1086792851),new c(1017036298,365543100),new c(1126000580,2618297676),new c(1288033470,3409855158),new c(1501505948,4234509866),new c(1607167915,987167468),new c(1816402316,1246189591)],C=new Array(64),m,E,v,_,T,R,O,N,G,D,k,z,ne=8;function Z(Ue){return unescape(encodeURIComponent(Ue))}function ve(Ue){for(var Ie=[],Ke=(1<<ne)-1,le=Ue.length*ne,ge=0;ge<le;ge+=ne)Ie[ge>>5]|=(Ue.charCodeAt(ge/ne)&Ke)<<32-ne-ge%32;return Ie}function xe(Ue){for(var Ie="0123456789abcdef",Ke="",le=Ue.length*4,ge,we=0;we<le;we+=1)ge=Ue[we>>2]>>(3-we%4)*8,Ke+=Ie.charAt(ge>>4&15)+Ie.charAt(ge&15);return Ke}function de(Ue,Ie){var Ke,le,ge,we;return Ke=(Ue.lowOrder&65535)+(Ie.lowOrder&65535),le=(Ue.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Ke>>>16),ge=(le&65535)<<16|Ke&65535,Ke=(Ue.highOrder&65535)+(Ie.highOrder&65535)+(le>>>16),le=(Ue.highOrder>>>16)+(Ie.highOrder>>>16)+(Ke>>>16),we=(le&65535)<<16|Ke&65535,new c(we,ge)}function Se(Ue,Ie,Ke,le){var ge,we,qe,$e;return ge=(Ue.lowOrder&65535)+(Ie.lowOrder&65535)+(Ke.lowOrder&65535)+(le.lowOrder&65535),we=(Ue.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Ke.lowOrder>>>16)+(le.lowOrder>>>16)+(ge>>>16),qe=(we&65535)<<16|ge&65535,ge=(Ue.highOrder&65535)+(Ie.highOrder&65535)+(Ke.highOrder&65535)+(le.highOrder&65535)+(we>>>16),we=(Ue.highOrder>>>16)+(Ie.highOrder>>>16)+(Ke.highOrder>>>16)+(le.highOrder>>>16)+(ge>>>16),$e=(we&65535)<<16|ge&65535,new c($e,qe)}function Me(Ue,Ie,Ke,le,ge){var we,qe,$e,ze;return we=(Ue.lowOrder&65535)+(Ie.lowOrder&65535)+(Ke.lowOrder&65535)+(le.lowOrder&65535)+(ge.lowOrder&65535),qe=(Ue.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Ke.lowOrder>>>16)+(le.lowOrder>>>16)+(ge.lowOrder>>>16)+(we>>>16),$e=(qe&65535)<<16|we&65535,we=(Ue.highOrder&65535)+(Ie.highOrder&65535)+(Ke.highOrder&65535)+(le.highOrder&65535)+(ge.highOrder&65535)+(qe>>>16),qe=(Ue.highOrder>>>16)+(Ie.highOrder>>>16)+(Ke.highOrder>>>16)+(le.highOrder>>>16)+(ge.highOrder>>>16)+(we>>>16),ze=(qe&65535)<<16|we&65535,new c(ze,$e)}function Pe(Ue,Ie,Ke){return new c(Ue.highOrder&Ie.highOrder^Ue.highOrder&Ke.highOrder^Ie.highOrder&Ke.highOrder,Ue.lowOrder&Ie.lowOrder^Ue.lowOrder&Ke.lowOrder^Ie.lowOrder&Ke.lowOrder)}function _e(Ue,Ie,Ke){return new c(Ue.highOrder&Ie.highOrder^~Ue.highOrder&Ke.highOrder,Ue.lowOrder&Ie.lowOrder^~Ue.lowOrder&Ke.lowOrder)}function Oe(Ue,Ie){return Ie<=32?new c(Ue.highOrder>>>Ie|Ue.lowOrder<<32-Ie,Ue.lowOrder>>>Ie|Ue.highOrder<<32-Ie):new c(Ue.lowOrder>>>Ie|Ue.highOrder<<32-Ie,Ue.highOrder>>>Ie|Ue.lowOrder<<32-Ie)}function st(Ue){var Ie=Oe(Ue,28),Ke=Oe(Ue,34),le=Oe(Ue,39);return new c(Ie.highOrder^Ke.highOrder^le.highOrder,Ie.lowOrder^Ke.lowOrder^le.lowOrder)}function rt(Ue){var Ie=Oe(Ue,14),Ke=Oe(Ue,18),le=Oe(Ue,41);return new c(Ie.highOrder^Ke.highOrder^le.highOrder,Ie.lowOrder^Ke.lowOrder^le.lowOrder)}function U(Ue){var Ie=Oe(Ue,1),Ke=Oe(Ue,8),le=V(Ue,7);return new c(Ie.highOrder^Ke.highOrder^le.highOrder,Ie.lowOrder^Ke.lowOrder^le.lowOrder)}function te(Ue){var Ie=Oe(Ue,19),Ke=Oe(Ue,61),le=V(Ue,6);return new c(Ie.highOrder^Ke.highOrder^le.highOrder,Ie.lowOrder^Ke.lowOrder^le.lowOrder)}function V(Ue,Ie){return Ie<=32?new c(Ue.highOrder>>>Ie,Ue.lowOrder>>>Ie|Ue.highOrder<<32-Ie):new c(0,Ue.highOrder<<32-Ie)}var ue=Z(ue),Ne=ue.length*ne;ue=ve(ue),ue[Ne>>5]|=128<<24-Ne%32,ue[(Ne+128>>10<<5)+31]=Ne;for(var G=0;G<ue.length;G+=32){m=d[0],E=d[1],v=d[2],_=d[3],T=d[4],R=d[5],O=d[6],N=d[7];for(var D=0;D<80;D++)D<16?C[D]=new c(ue[D*2+G],ue[D*2+G+1]):C[D]=Se(te(C[D-2]),C[D-7],U(C[D-15]),C[D-16]),k=Me(N,rt(T),_e(T,R,O),f[D],C[D]),z=de(st(m),Pe(m,E,v)),N=O,O=R,R=T,T=de(_,k),_=v,v=E,E=m,m=de(k,z);d[0]=de(m,d[0]),d[1]=de(E,d[1]),d[2]=de(v,d[2]),d[3]=de(_,d[3]),d[4]=de(T,d[4]),d[5]=de(R,d[5]),d[6]=de(O,d[6]),d[7]=de(N,d[7])}for(var Ge=[],G=0;G<d.length;G++)Ge.push(d[G].highOrder),Ge.push(d[G].lowOrder);return xe(Ge)}})}},s={};function o(l){var u=s[l];if(u!==void 0)return u.exports;var c=s[l]={exports:{}};return n[l].call(c.exports,c,c.exports,o),c.exports}(function(){o.n=function(l){var u=l&&l.__esModule?function(){return l.default}:function(){return l};return o.d(u,{a:u}),u}})(),function(){o.d=function(l,u){for(var c in u)o.o(u,c)&&!o.o(l,c)&&Object.defineProperty(l,c,{enumerable:!0,get:u[c]})}}(),function(){o.o=function(l,u){return Object.prototype.hasOwnProperty.call(l,u)}}();var a={};(function(){o.d(a,{default:function(){return bt}});var l=function(q){document.dictionary||(document.dictionary={});var X=null,F=Object.keys(q);for(X=0;X<F.length;X++)document.dictionary[F[X]]=q[F[X]]},u=function(q){return typeof document<"u"&&document.dictionary&&document.dictionary[q]||q},c={setDictionary:l,translate:u},f=function(q,X){if(X===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(b){return b!==null}),setTimeout(function(){window.jSuitesStateControl.push(q)},0);else{var F=window.jSuitesStateControl.indexOf(q);F>=0&&window.jSuitesStateControl.splice(F,1)}},C={};C.two=function(q){return q=""+q,q.length==1&&(q="0"+q),q},C.focus=function(q){if(q.innerText.length){var X=document.createRange(),F=window.getSelection(),b=q.childNodes[q.childNodes.length-1];X.setStart(b,b.length),X.collapse(!0),F.removeAllRanges(),F.addRange(X),q.scrollLeft=q.scrollWidth}},C.isNumeric=function(q){return typeof q=="string"&&(q=q.trim()),!isNaN(q)&&q!==null&&q!==""},C.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(q){var X=Math.random()*16|0,F=q=="x"?X:X&3|8;return F.toString(16)})},C.getNode=function(){var q=document.getSelection().anchorNode;return q?q.nodeType==3?q.parentNode:q:null},C.hash=function(q){var X=0,F,b;if(q.length===0)return X;for(F=0;F<q.length;F++)b=q.charCodeAt(F),b>32&&(X=(X<<5)-X+b,X|=0);return X},C.randomColor=function(q){var X=-.25,F=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");F.length<6&&(F=F[0]+F[0]+F[1]+F[1]+F[2]+F[2]);var b=[],ce,Fe;for(Fe=0;Fe<3;Fe++)ce=parseInt(F.substr(Fe*2,2),16),ce=Math.round(Math.min(Math.max(0,ce+ce*X),255)).toString(16),b.push(("00"+ce).substr(ce.length));return q==!0?"#"+C.two(b[0].toString(16))+C.two(b[1].toString(16))+C.two(b[2].toString(16)):b},C.getWindowWidth=function(){var q=window,X=document,F=X.documentElement,b=X.getElementsByTagName("body")[0],ce=q.innerWidth||F.clientWidth||b.clientWidth;return ce},C.getWindowHeight=function(){var q=window,X=document,F=X.documentElement,b=X.getElementsByTagName("body")[0],ce=q.innerHeight||F.clientHeight||b.clientHeight;return ce},C.getPosition=function(q){if(q.changedTouches&&q.changedTouches[0])var X=q.changedTouches[0].pageX,F=q.changedTouches[0].pageY;else var X=window.Event?q.pageX:q.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),F=window.Event?q.pageY:q.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[X,F]},C.click=function(q){if(q.click)q.click();else{var X=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});q.dispatchEvent(X)}},C.findElement=function(q,X){var F=!1;function b(ce){ce&&!F&&(typeof X=="function"?F=X(ce):typeof X=="string"&&ce.classList&&ce.classList.contains(X)&&(F=ce)),ce.parentNode&&!F&&b(ce.parentNode)}return b(q),F};var m=C;function E(q,X,F){if(q=q.split("."),q.length){let b=this,ce=null;for(;q.length>1;)if(ce=q.shift(),b.hasOwnProperty(ce))b=b[ce];else{if(typeof X>"u")return;b[ce]={},b=b[ce]}if(ce=q.shift(),typeof X<"u")return F===!0?delete b[ce]:b[ce]=X,!0;if(b)return b[ce]}return!1}function v(q,X){var F={};F.options={};var b={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},ce=null;for(var Fe in b)X&&X.hasOwnProperty(Fe)?F.options[Fe]=X[Fe]:F.options[Fe]=b[Fe];q.classList.add("jsorting"),q.addEventListener("dragstart",function(re){let me=re.target;if(me.nodeType===3)if(me.parentNode.getAttribute("draggable")==="true")me=me.parentNode;else{re.preventDefault(),re.stopPropagation();return}if(me.getAttribute("draggable")==="true"){let he=Array.prototype.indexOf.call(me.parentNode.children,me);ce={element:me,o:he,d:he},me.style.opacity="0.25",typeof F.options.ondragstart=="function"&&F.options.ondragstart(q,me,re),re.dataTransfer.setDragImage(me,0,0)}}),q.addEventListener("dragover",function(re){if(re.preventDefault(),ce&&Le(re.target)&&re.target.getAttribute("draggable")=="true"&&ce.element!=re.target){if(F.options.direction)var me=re.target.clientWidth/2>re.offsetX;else var me=re.target.clientHeight/2>re.offsetY;me?re.target.parentNode.insertBefore(ce.element,re.target):re.target.parentNode.insertBefore(ce.element,re.target.nextSibling),ce.d=Array.prototype.indexOf.call(re.target.parentNode.children,ce.element)}}),q.addEventListener("dragleave",function(re){re.preventDefault()}),q.addEventListener("dragend",function(re){re.preventDefault(),ce&&(typeof F.options.ondragend=="function"&&F.options.ondragend(q,ce.element,re),ce.o<ce.d?re.target.parentNode.insertBefore(ce.element,re.target.parentNode.children[ce.o]):re.target.parentNode.insertBefore(ce.element,re.target.parentNode.children[ce.o].nextSibling),ce.element.style.opacity="",ce=null)}),q.addEventListener("drop",function(re){re.preventDefault(),ce&&(ce.o!==ce.d&&typeof F.options.ondrop=="function"&&F.options.ondrop(q,ce.o,ce.d,ce.element,re.target,re),ce.element.style.opacity="",ce=null)});for(var Le=function(re){var me=!1;function he(Ae){Ae.className&&Ae.classList.contains("jsorting")&&(me=!0),me||he(Ae.parentNode)}return he(re),me},ae=0;ae<q.children.length;ae++)q.children[ae].hasAttribute("draggable")||q.children[ae].setAttribute("draggable","true");return q.val=function(){for(var re=null,me=[],he=0;he<q.children.length;he++)(re=q.children[he].getAttribute("data-id"))&&me.push(re);return me},q}function _(q,X){var F={};(!X.loadUp||typeof X.loadUp!="function")&&(X.loadUp=function(){return!1}),(!X.loadDown||typeof X.loadDown!="function")&&(X.loadDown=function(){return!1}),X.timer||(X.timer=100);var b=null,ce=function(Fe){if(b==null){var Le=!1,ae=q.scrollTop;q.scrollTop+q.clientHeight*2>=q.scrollHeight?X.loadDown()&&(ae==q.scrollTop&&(q.scrollTop=q.scrollTop-q.clientHeight),Le=!0):q.scrollTop<=q.clientHeight&&X.loadUp()&&(ae==q.scrollTop&&(q.scrollTop=q.scrollTop+q.clientHeight),Le=!0),b=setTimeout(function(){b=null},X.timer),Le&&typeof X.onupdate=="function"&&X.onupdate()}};return q.onscroll=function(Fe){ce()},q.onwheel=function(Fe){ce()},F}function T(){var q=function(X,F){if(Array.isArray(X)){var b={instance:[],complete:F};if(X.length>0)for(var ce=0;ce<X.length;ce++)X[ce].multiple=b,b.instance.push(q(X[ce]));return b}if(X.data||(X.data={}),X.type&&(X.method=X.type),X.method||(X.method="GET"),X.dataType||(X.dataType="json"),X.data){var Fe=function(Ae,je){var ke=[];if(Ae){var et=Object.keys(Ae);if(et.length)for(var pt=0;pt<et.length;pt++){if(je)var A=je+"["+et[pt]+"]";else var A=et[pt];if(Ae[A]instanceof FileList)ke[A]=Ae[et[pt]];else if(Ae[et[pt]]===null||Ae[et[pt]]===void 0)ke[A]="";else if(typeof Ae[et[pt]]=="object")for(var K=Fe(Ae[et[pt]],A),L=Object.keys(K),j=0;j<L.length;j++)ke[L[j]]=K[L[j]];else ke[A]=Ae[et[pt]]}}return ke},Le=Fe(X.data),ae=Object.keys(Le);if(X.method=="GET"){if(ae.length){for(var re=[],ce=0;ce<ae.length;ce++)re.push(ae[ce]+"="+encodeURIComponent(Le[ae[ce]]));X.url.indexOf("?")<0&&(X.url+="?"),X.url+=re.join("&")}}else for(var re=new FormData,ce=0;ce<ae.length;ce++)if(Le[ae[ce]]instanceof FileList){if(Le[ae[ce]].length)for(var me=0;me<Le[ae[ce]].length;me++)re.append(ae[ce],Le[ae[ce]][me],Le[ae[ce]][me].name)}else re.append(ae[ce],Le[ae[ce]])}var he=new XMLHttpRequest;return he.open(X.method,X.url,!0),X.requestedWith?he.setRequestHeader("X-Requested-With",X.requestedWith):X.requestedWith!==!1&&he.setRequestHeader("X-Requested-With","XMLHttpRequest"),X.contentType&&he.setRequestHeader("Content-Type",X.contentType),X.method==="POST"?he.setRequestHeader("Accept","application/json"):X.dataType==="blob"?he.responseType="blob":X.contentType||(X.dataType==="json"?he.setRequestHeader("Content-Type","text/json"):X.dataType==="html"&&he.setRequestHeader("Content-Type","text/html")),X.cache!==!0&&(he.setRequestHeader("pragma","no-cache"),he.setRequestHeader("cache-control","no-cache")),X.withCredentials===!0&&(he.withCredentials=!0),typeof X.beforeSend=="function"&&X.beforeSend(he),typeof q.beforeSend=="function"&&q.beforeSend(he),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(he),he.onerror=function(){X.error&&typeof X.error=="function"&&X.error({message:"Network error: Unable to reach the server.",status:0})},he.ontimeout=function(){X.error&&typeof X.error=="function"&&X.error({message:"Request timed out after "+he.timeout+"ms.",status:0})},he.onload=function(){if(he.status>=200&&he.status<300)if(X.dataType==="json")try{var Ae=JSON.parse(he.responseText);X.success&&typeof X.success=="function"&&X.success(Ae)}catch(ke){X.error&&typeof X.error=="function"&&X.error(ke,Ae)}else{if(X.dataType==="blob")var Ae=he.response;else var Ae=he.responseText;X.success&&typeof X.success=="function"&&X.success(Ae)}else X.error&&typeof X.error=="function"&&X.error(he.responseText,he.status);if(q.queue&&q.queue.length>0&&q.send(q.queue.shift()),q.requests&&q.requests.length){var je=q.requests.indexOf(he);if(q.requests.splice(je,1),q.requests.length||X.complete&&typeof X.complete=="function"&&X.complete(Ae),X.group&&q.oncomplete&&typeof q.oncomplete[X.group]=="function"&&(q.pending(X.group)||(q.oncomplete[X.group](),q.oncomplete[X.group]=null)),X.multiple&&X.multiple.instance){var je=X.multiple.instance.indexOf(he);X.multiple.instance.splice(je,1),X.multiple.instance.length||X.multiple.complete&&typeof X.multiple.complete=="function"&&X.multiple.complete(Ae)}}},he.options=X,he.data=re,X.queue===!0&&q.requests.length>0?q.queue.push(he):q.send(he),he};return q.send=function(X){X.data?Array.isArray(X.data)?X.send(X.data.join("&")):X.send(X.data):X.send(),q.requests.push(X)},q.exists=function(X,F){var b=new XMLHttpRequest;b.open("HEAD",X,!1),b.send(),b.status&&F(b.status)},q.pending=function(X){var F=0,b=q.requests;if(b&&b.length)for(var ce=0;ce<b.length;ce++)(!X||X==b[ce].options.group)&&F++;return F},q.oncomplete={},q.requests=[],q.queue=[],q}var R=T();function O(){const q={loading:{}};return q.loading.show=function(X){q.loading.element||(q.loading.element=document.createElement("div"),q.loading.element.className="jloading"),document.body.appendChild(q.loading.element),X>0&&setTimeout(function(){q.loading.hide()},X*1e3)},q.loading.hide=function(){q.loading.element&&q.loading.element.parentNode&&document.body.removeChild(q.loading.element)},q.slideLeft=function(X,F,b){F==!0?(X.classList.add("jslide-left-in"),setTimeout(function(){X.classList.remove("jslide-left-in"),typeof b=="function"&&b()},400)):(X.classList.add("jslide-left-out"),setTimeout(function(){X.classList.remove("jslide-left-out"),typeof b=="function"&&b()},400))},q.slideRight=function(X,F,b){F===!0?(X.classList.add("jslide-right-in"),setTimeout(function(){X.classList.remove("jslide-right-in"),typeof b=="function"&&b()},400)):(X.classList.add("jslide-right-out"),setTimeout(function(){X.classList.remove("jslide-right-out"),typeof b=="function"&&b()},400))},q.slideTop=function(X,F,b){F===!0?(X.classList.add("jslide-top-in"),setTimeout(function(){X.classList.remove("jslide-top-in"),typeof b=="function"&&b()},400)):(X.classList.add("jslide-top-out"),setTimeout(function(){X.classList.remove("jslide-top-out"),typeof b=="function"&&b()},400))},q.slideBottom=function(X,F,b){F===!0?(X.classList.add("jslide-bottom-in"),setTimeout(function(){X.classList.remove("jslide-bottom-in"),typeof b=="function"&&b()},400)):(X.classList.add("jslide-bottom-out"),setTimeout(function(){X.classList.remove("jslide-bottom-out"),typeof b=="function"&&b()},100))},q.fadeIn=function(X,F){X.style.display="",X.classList.add("jfade-in"),setTimeout(function(){X.classList.remove("jfade-in"),typeof F=="function"&&F()},2e3)},q.fadeOut=function(X,F){X.classList.add("jfade-out"),setTimeout(function(){X.style.display="none",X.classList.remove("jfade-out"),typeof F=="function"&&F()},1e3)},q}var N=O();function G(){var q={};q.now=function(Le,ae){var re=null,me=null,he=null,Ae=null,je=null,ke=null;return Array.isArray(Le)?(re=Le[0],me=Le[1],he=Le[2],Ae=Le[3],je=Le[4],ke=Le[5]):(Le||(Le=new Date),re=Le.getFullYear(),me=Le.getMonth()+1,he=Le.getDate(),Ae=Le.getHours(),je=Le.getMinutes(),ke=Le.getSeconds()),ae==!0?m.two(re)+"-"+m.two(me)+"-"+m.two(he):m.two(re)+"-"+m.two(me)+"-"+m.two(he)+" "+m.two(Ae)+":"+m.two(je)+":"+m.two(ke)},q.toArray=function(Le){var re=Le.split(Le.indexOf("T")!==-1?"T":" "),ae=re[1],re=re[0].split("-"),me=parseInt(re[0]),he=parseInt(re[1]),Ae=parseInt(re[2]),je=0,ke=0;return ae&&(ae=ae.split(":"),je=parseInt(ae[0]),ke=parseInt(ae[1])),[me,he,Ae,je,ke,0]};var X=Date.UTC(1900,0,0),F=Date.UTC(1900,1,29),b=864e5;q.dateToNum=function(Le){typeof Le=="string"&&(Le=new Date(Le+"  GMT+0"));var ae=Le.getTime();return ae>=F&&(ae+=b),ae-=X,ae/b},q.numToDate=function(Le){var ae=X+Le*b;ae>=F&&(ae-=b);const re=new Date(ae);var me=[re.getUTCFullYear(),re.getUTCMonth()+1,re.getUTCDate(),re.getUTCHours(),re.getUTCMinutes(),re.getUTCSeconds()];return q.now(me)};let ce=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Fe=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(q,"weekdays",{get:function(){return ce.map(function(Le){return c.translate(Le)})}}),Object.defineProperty(q,"weekdaysShort",{get:function(){return ce.map(function(Le){return c.translate(Le).substring(0,3)})}}),Object.defineProperty(q,"months",{get:function(){return Fe.map(function(Le){return c.translate(Le)})}}),Object.defineProperty(q,"monthsShort",{get:function(){return Fe.map(function(Le){return c.translate(Le).substring(0,3)})}}),q}var D=G();function k(){var q={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},X=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var H=0;this.date[4]&&(H=parseFloat(this.date[4]/60));var Q=parseInt(this.date[3])+H;Q/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?Q=m.two(this.date[3])+":"+m.two(this.date[4])+":"+m.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),Q=m.two(this.date[0])+"-"+m.two(this.date[1])+"-"+m.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(Q+=" "+m.two(this.date[3])+":"+m.two(this.date[4])+":"+m.two(this.date[5])));return Q},F=function(){var H="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)H=parseInt(this.date[3]);else{let pe=parseInt(this.date[3]);pe<13&&this.values.indexOf("PM")!==-1?H=(pe+12)%24:H=pe%24}this.date[4]&&(H+=parseFloat(this.date[4]/60)),this.date[5]&&(H+=parseFloat(this.date[5]/3600)),H/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var Q=D.now(this.date);H=D.dateToNum(Q)}return isNaN(H)&&(H=""),H},b=function(H){return H===null||H===""||H===void 0},ce=function(H){var Q=(""+H)[0];return Q=="="},Fe=function(H){return H==="currency"||H==="percentage"||H==="scientific"||H==="numeric"},Le=function(H){if(H&&Number(H)==H)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var Q=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=Q[1]}else{H||(H=this.mask);var pe=new RegExp("0{1}(.{1})0+","ig"),Q=pe.exec(H);if(Q&&Q[1]&&Q[1].length==1)return this.options.decimal=Q[1],Q[1];var pe=new RegExp("#{1}(.{1})#+","ig"),Q=pe.exec(H);Q&&Q[1]&&Q[1].length==1?Q[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},ae=function(H,Q){if(H=="")return"";Q||(Q=Le.call(this)),H=(""+H).split(Q);var pe=H[0].match(/[-]+/g);if(pe&&pe.length?pe=!0:pe=!1,H[0]=H[0].match(/[0-9]+/g),H[0]?(pe&&H[0].unshift("-"),H[0]=H[0].join("")):pe&&(H[0]="-"),H[0]||H[1])H[1]!==void 0&&(H[1]=H[1].match(/[0-9]+/g),H[1]?H[1]=H[1].join(""):H[1]="");else return"";return H},re=function(H,Q){if(H==="")return"";var pe=Le.call(this),Re=this.options;if(H=ae.call(this,H),H==="")return"";var Ce=null;if(H[0]&&(Re.style==="percent"?Ce=parseFloat(H[0])/100:Ce=parseFloat(H[0]+".1")),(H[0]==="-"||H[0]==="-00")&&!H[1]&&Q&&Q.inputType=="deleteContentBackward")return"";var We=new Intl.NumberFormat(this.locale,Re).format(Ce);if(We=We.split(pe),Re.style==="percent"&&We[0].indexOf("%")!==-1&&(We[0]=We[0].replace("%",""),We[2]="%"),typeof We[1]<"u"){var ot=We[1].replace(/[0-9]*/g,"");ot&&(We[2]=ot)}return H[1]!==void 0?We[1]=pe+H[1]:We[1]="",We.join("")},me=function(H,Q){var pe=je.call(H);if(pe){var Re=re.call(this,pe,Q),Ce=Re.length-pe.length,We=Ae.call(H)+Ce;je.call(H,Re,We,!0)}},he=function(H){var Q=ae.call(this,H);return Q?(Q[0]==="-"&&(Q[0]="-0"),parseFloat(Q.join("."))):null},Ae=function(H,Q){if(H===void 0)if(this.tagName=="DIV"){var pe=0,Re=window.getSelection();if(Re&&Re.rangeCount!==0){var Ce=Re.getRangeAt(0),We=Ce.cloneRange();We.selectNodeContents(this),We.setEnd(Ce.endContainer,Ce.endOffset),pe=We.toString().length}return pe}else return this.selectionStart;else{var ot=je.call(this);if(Q){for(var We=null,mt=0;mt<ot.length;mt++)(ot[mt].match(/[\-0-9]/g)||ot[mt]==="."||ot[mt]===",")&&(We=mt);We===null&&(We=ot.indexOf(" ")),H>=We&&(H=We+1)}if(H>ot.length&&(H=ot.length),H)if(this.tagName=="DIV"){var Re=window.getSelection(),Ce=document.createRange();this.childNodes[0]&&(Ce.setStart(this.childNodes[0],H),Re.removeAllRanges(),Re.addRange(Ce))}else this.selectionStart=H,this.selectionEnd=H}},je=function(H,Q,pe){if(this.tagName=="DIV")if(H===void 0){var H=this.innerText;return this.value&&this.value.length>H.length&&(H=this.value),H}else this.innerText!==H&&(this.innerText=H,Q&&Ae.call(this,Q,pe));else{if(H===void 0)return this.value;this.value!==H&&(this.value=H,Q&&Ae.call(this,Q,pe))}},ke=D.weekdays,et=D.weekdaysShort,pt=D.months,A=D.monthsShort,K={YEAR:function(H,Q){var pe=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(H)>=0&&parseInt(H)<=10&&this.values[this.index].length<Q&&(this.values[this.index]+=H),this.values[this.index].length==Q){if(Q==2)var pe=pe.substr(0,2)+this.values[this.index];else if(Q==3)var pe=pe.substr(0,1)+this.values[this.index];else if(Q==4)var pe=this.values[this.index];this.date[0]=pe,this.index++}},YYYY:function(H){K.YEAR.call(this,H,4)},YYY:function(H){K.YEAR.call(this,H,3)},YY:function(H){K.YEAR.call(this,H,2)},FIND:function(H,Q){if(b(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=H;return}for(var pe=0,Re=0,Ce=(this.values[this.index]+H).toLowerCase(),We=0;We<Q.length;We++)Q[We].toLowerCase().indexOf(Ce)==0&&(pe=We,Re++);if(Re>1)this.values[this.index]+=H;else if(Re==1){var ot=Q[pe].length-this.values[this.index].length-1;return this.position+=ot,this.values[this.index]=Q[pe],this.index++,pe}},MMM:function(H){var Q=K.FIND.call(this,H,A);Q!==void 0&&(this.date[1]=Q+1)},MON:function(H){K.MMM.call(this,H)},MMMM:function(H){var Q=K.FIND.call(this,H,pt);Q!==void 0&&(this.date[1]=Q+1)},MONTH:function(H){K.MMMM.call(this,H)},MMMMM:function(H){b(this.values[this.index])&&(this.values[this.index]="");for(var Q=(this.values[this.index]+H).toLowerCase(),pe=0;pe<pt.length;pe++)if(pt[pe][0].toLowerCase().indexOf(Q)==0){this.values[this.index]=pt[pe][0],this.date[1]=pe+1,this.index++;break}},MM:function(H){b(this.values[this.index])?parseInt(H)>1&&parseInt(H)<10?(this.date[1]=this.values[this.index]="0"+H,this.index++):parseInt(H)<2&&(this.values[this.index]=H):this.values[this.index]==1&&parseInt(H)<3?(this.date[1]=this.values[this.index]+=H,this.index++):this.values[this.index]==0&&parseInt(H)>0&&parseInt(H)<10&&(this.date[1]=this.values[this.index]+=H,this.index++)},M:function(H){var Q=!1;if(parseInt(H)>=0&&parseInt(H)<10)if(b(this.values[this.index]))this.values[this.index]=H,H>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(H)<3)this.date[1]=this.values[this.index]+=H,this.index++;else if(this.values[this.index]==0&&parseInt(H)>0)this.date[1]=this.values[this.index]+=H,this.index++;else var Q=!0;else var Q=!0;if(Q==!0){var pe=parseInt(this.values[this.index]);pe>0&&pe<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(H){var Q=!1;if(parseInt(H)>=0&&parseInt(H)<10)if(b(this.values[this.index]))this.values[this.index]=H,parseInt(H)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(H)<2)this.date[2]=this.values[this.index]+=H,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=H,this.index++;else if(this.values[this.index]==0&&parseInt(H)>0)this.date[2]=this.values[this.index]+=H,this.index++;else var Q=!0;else var Q=!0;if(Q==!0){var pe=parseInt(this.values[this.index]);pe>0&&pe<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(H){b(this.values[this.index])?parseInt(H)>3&&parseInt(H)<10?(this.date[2]=this.values[this.index]="0"+H,this.index++):parseInt(H)<10&&(this.values[this.index]=H):this.values[this.index]==3&&parseInt(H)<2?(this.date[2]=this.values[this.index]+=H,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(H)<10?(this.date[2]=this.values[this.index]+=H,this.index++):this.values[this.index]==0&&parseInt(H)>0&&parseInt(H)<10&&(this.date[2]=this.values[this.index]+=H,this.index++)},DDD:function(H){K.FIND.call(this,H,et)},DY:function(H){K.DDD.call(this,H)},DDDD:function(H){K.FIND.call(this,H,ke)},DAY:function(H){K.DDDD.call(this,H)},HH12:function(H,Q){b(this.values[this.index])?parseInt(H)>1&&parseInt(H)<10?(Q&&(H=0+H),this.date[3]=this.values[this.index]=H,this.index++):parseInt(H)<10&&(this.values[this.index]=H):this.values[this.index]==1&&parseInt(H)<3?(this.date[3]=this.values[this.index]+=H,this.index++):this.values[this.index]<1&&parseInt(H)<10&&(this.date[3]=this.values[this.index]+=H,this.index++)},HH24:function(H,Q){parseInt(H)>=0&&parseInt(H)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(H)>2&&parseInt(H)<10?(Q&&(H=0+H),this.date[3]=this.values[this.index]=H,this.index++):parseInt(H)<10&&(this.values[this.index]=H):this.values[this.index]==2&&parseInt(H)<4?(!Q&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=H,this.index++):this.values[this.index]<2&&parseInt(H)<10&&(!Q&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=H,this.index++))},HH:function(H){K.HH24.call(this,H,1)},H:function(H){K.HH24.call(this,H,0)},"\\[H\\]":function(H){this.values[this.index]==null&&(this.values[this.index]=""),H.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=H:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(H,Q){this.values[this.index]==null||this.values[this.index]==""?parseInt(H)>5&&parseInt(H)<10?(this.date[Q]=this.values[this.index]="0"+H,this.index++):parseInt(H)<10&&(this.values[this.index]=H):parseInt(H)<10&&(this.date[Q]=this.values[this.index]+=H,this.index++)},MI:function(H){K.N60.call(this,H,4)},SS:function(H){K.N60.call(this,H,5)},"AM/PM":function(H){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?H.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":H.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(H){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(H)>=0&&parseInt(H)<7&&(this.values[this.index]=H),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(H){var Q=Le.call(this),pe=!1;b(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(pe=!0);var Re=ae.call(this,this.values[this.index],Q);Re&&(this.values[this.index]=Re.join(Q)),parseInt(H)>=0&&parseInt(H)<10?(this.values[this.index]=="0"&&H>0?this.values[this.index]="":this.values[this.index]=="-0"&&H>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||H==Q)&&(this.values[this.index]+=H)):Q&&H==Q?this.values[this.index].indexOf(Q)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=H):H=="-"&&(pe=!0),pe===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(H){K["0{1}(.{1}0+)?"].call(this,H)},"0{1}(.{1}0+)?%":function(H){K["0{1}(.{1}0+)?"].call(this,H),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(H){K["0{1}(.{1}0+)?"].call(this,H);var Q=Le.call(this),pe=this.tokens[this.index].substr(1,1),Re=this.values[this.index][0]==="-",Ce=ae.call(this,this.values[this.index],Q);if(Ce!==""){var We=Ce[0].match(/[0-9]/g);if(We){We=We.join("");for(var ot=[],mt=0,Ye=We.length-1;Ye>=0;Ye--)ot.push(We[Ye]),mt++,mt%3||ot.push(pe);ot=ot.reverse(),Ce[0]=ot.join(""),Ce[0].substr(0,1)==pe&&(Ce[0]=Ce[0].substr(1))}else Ce[0]="";this.values[this.index]=Ce.join(Q),Re&&(this.values[this.index]="-"+this.values[this.index])}},0:function(H){H.match(/[0-9]/g)&&(this.values[this.index]=H,this.index++)},"[0-9a-zA-Z$]+":function(H){b(this.values[this.index])&&(this.values[this.index]="");var Q=this.tokens[this.index],pe=this.values[this.index],Re=pe.length;Q[Re]==H?(this.values[this.index]+=H,this.values[this.index]==Q&&this.index++):(this.values[this.index]=Q,this.index++,H.match(/[\-0-9]/g)&&this.position--)},A:function(H){H.match(/[a-zA-Z]/gi)&&(this.values[this.index]=H,this.index++)},".":function(H){K["[0-9a-zA-Z$]+"].call(this,H)},"@":function(H){b(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=H}},L=function(H){if(this.type=="general")var Q=[].concat(q.general);else var Q=[].concat(q.currency,q.datetime,q.percentage,q.scientific,q.numeric,q.text,q.general);var pe=new RegExp(Q.join("|"),"gi");return H.match(pe)},j=function(H){if(this.type)if(this.type=="text")var Q=["text"];else if(this.type=="general")var Q=["general"];else if(this.type=="datetime")var Q=["numeric","datetime","general"];else var Q=["currency","percentage","scientific","numeric","general"];else var Q=Object.keys(q);for(var pe=0;pe<Q.length;pe++)for(var Re=Q[pe],Ce=0;Ce<q[Re].length;Ce++){var We=new RegExp(q[Re][Ce],"gi"),ot=H.match(We);if(ot)return{type:Re,method:q[Re][Ce]}}},Y=function(H){for(var Q=[],pe=0;pe<H.length;pe++){var Re=j.call(this,H[pe]);Re?Q.push(Re.method):Q.push(null)}for(var pe=0;pe<Q.length;pe++)Q[pe]=="MM"&&(Q[pe-1]&&Q[pe-1].indexOf("H")>=0||Q[pe-2]&&Q[pe-2].indexOf("H")>=0||Q[pe+1]&&Q[pe+1].indexOf("S")>=0||Q[pe+2]&&Q[pe+2].indexOf("S")>=0)&&(Q[pe]="MI");return Q},oe=function(H){var Q=j.call(this,H);if(Q)var pe=Q.type;if(pe){for(var Re=0,Ce=L.call(this,H),We=0;We<Ce.length;We++)Q=j.call(this,Ce[We]),Q&&Fe(Q.type)&&Re++;Re>1&&(pe="general")}return pe},Te=function(){typeof K[this.methods[this.index]]=="function"?(K[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},ee=function(H){return(""+ +H).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(Q,pe,Re,Ce,We){return We<0?pe+"0."+Array(1-We-Re.length).join(0)+Re+Ce:pe+Re+Ce+Array(We-Ce.length+1).join(0)})},ye=function(H,Q,pe){var Re=null,Ce={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof H=="object"){if(Ce.input=H.target,Ce.value=je.call(H.target),Ce.caret=Ae.call(H.target),(Re=H.target.getAttribute("data-mask"))&&(Ce.mask=Re),(Re=H.target.getAttribute("data-type"))&&(Ce.type=Re),H.target.mask?(H.target.mask.options&&(Ce.options=H.target.mask.options),H.target.mask.locale&&(Ce.locale=H.target.mask.locale)):(Re=H.target.getAttribute("data-locale"))&&(Ce.locale=Re,Ce.mask&&(Ce.options.style=Ce.mask)),H.target.attributes&&H.target.attributes.length)for(var We=0;We<H.target.attributes.length;We++){var ot=H.target.attributes[We].name,mt=H.target.attributes[We].value;ot.substr(0,4)=="data"&&(Ce.options[ot.substr(5)]=mt)}}else{if(typeof Q=="string")Ce.mask=Q;else for(var ot=Object.keys(Q),We=0;We<ot.length;We++)Ce[ot[We]]=Q[ot[We]];typeof H=="number"&&(Le.call(Ce,Ce.mask),H=(""+H).replace(".",Ce.options.decimal)),Ce.value=H,Ce.input&&(je.call(Ce.input,H),m.focus(Ce.input),Ce.caret=Ae.call(Ce.input))}if(!ce(Ce.value)&&(Ce.mask||Ce.locale)){if(Ce.mask){if(Ce.mask=Ce.mask.replace(new RegExp(/\[h]/),"|h|"),Ce.mask=Ce.mask.replace(new RegExp(/\[.*?\]/),""),Ce.mask=Ce.mask.replace(new RegExp(/\|h\|/),"[h]"),Ce.mask.indexOf(";")!==-1){var Re=Ce.mask.split(";");Ce.mask=Re[0]}if(Ce.mask.indexOf("##")!==-1){var Ye=Ce.mask.split(";");Ye[0]&&(typeof H=="object"&&(Ye[0]=Ye[0].replace(new RegExp(/_\)/g),""),Ye[0]=Ye[0].replace(new RegExp(/_\(/g),"")),Ye[0]=Ye[0].replace("*","	"),Ye[0]=Ye[0].replace(new RegExp(/_-/g),""),Ye[0]=Ye[0].replace(new RegExp(/_/g),""),Ye[0]=Ye[0].replace(new RegExp(/"/g),""),Ye[0]=Ye[0].replace("##0.###","##0.000"),Ye[0]=Ye[0].replace("##0.##","##0.00"),Ye[0]=Ye[0].replace("##0.#","##0.0"),Ye[0]=Ye[0].replace("##0,###","##0,000"),Ye[0]=Ye[0].replace("##0,##","##0,00"),Ye[0]=Ye[0].replace("##0,#","##0,0")),Ce.mask=Ye[0]}if(Ce.mask.indexOf("\\")!==-1){var Ye=Ce.mask.split(";");Ye[0]=Ye[0].replace(new RegExp(/\\/g),""),Ce.mask=Ye[0]}Ce.type||(Ce.type=oe.call(Ce,Ce.mask)),Ce.tokens=L.call(Ce,Ce.mask)}if(typeof H!="object"||!H.inputType||!H.inputType.indexOf("insert")||!H.inputType.indexOf("delete"))if(Ce.locale)if(Ce.input)me.call(Ce,Ce.input,H);else var Et=re.call(Ce,Ce.value);else{for(Ce.methods=Y.call(Ce,Ce.tokens),Ce.event=H;Ce.position<Ce.value.length&&typeof Ce.tokens[Ce.index]<"u";)Te.call(Ce);var Et=Ce.values.join("");if(Fe(Ce.type)&&Et!==""){for(;typeof Ce.tokens[Ce.index]<"u";){var Re=j.call(Ce,Ce.tokens[Ce.index]);Re&&Re.type=="general"&&(Ce.values[Ce.index]=Ce.tokens[Ce.index]),Ce.index++}var vt=!0}else var vt=!1;if(Et=Ce.values.join(""),Ce.input){if(Re=Et.length-Ce.value.length,Re>0)var xt=Ce.caret+Re;else var xt=Ce.caret;je.call(Ce.input,Et,xt,vt)}}if(Ce.input){var He=null;if(Fe(Ce.type)){let ft=je.call(Ce.input);Ce.number=he.call(Ce,ft),Ce.type=="percentage"&&(""+ft).indexOf("%")!==-1?He=ye.adjustPrecision(Ce.number/100):He=Ce.number}else Ce.type=="datetime"&&(He=X.call(Ce),Ce.date[0]&&Ce.date[1]&&Ce.date[2]&&Ce.input.setAttribute("data-completed",!0));He&&Ce.input.setAttribute("data-value",He)}if(Et!==void 0)return pe?Ce:Et}};return ye.adjustPrecision=function(H){if(typeof H=="number"&&!Number.isInteger(H)){const Q=H.toString().split(".");if(Q[1]&&Q[1].length>10){let pe=0;const Re=Q[1][Q[1].length-2];if(Re==0||Re==9){for(let Ce=Q[1].length-2;Ce>0;Ce--)if(pe>=0&&Q[1][Ce]==Re){if(pe++,pe>6)break}else{pe=0;break}if(pe)return parseFloat(parseFloat(H).toFixed(Q[1].length-1))}}}return H},ye.getType=oe,ye.prepare=function(H,Q){return Q||(Q={}),L.call(Q,H)},ye.apply=function(H){var Q=je.call(H.target);H.key.length==1&&(Q+=H.key),je.call(H.target,ye(Q,H.target.getAttribute("data-mask")))},ye.run=function(H,Q,pe){return ye(H,{mask:Q,decimal:pe})},ye.extract=function(H,Q,pe){if(b(H)||typeof Q!="object")return H;if(Q=Object.assign({},Q),Q.options||(Q.options={}),!Q.mask&&Q.format&&(Q.mask=Q.format),Q.mask){if(Q.mask.indexOf(";")!==-1){var Re=Q.mask.split(";");Q.mask=Re[0]}Q.mask=Q.mask.replace(new RegExp(/\[h]/),"|h|"),Q.mask=Q.mask.replace(new RegExp(/\[.*?\]/),""),Q.mask=Q.mask.replace(new RegExp(/\|h\|/),"[h]")}Le.call(Q,Q.mask);var Ce=null,We=null;if(Q.type=="percent"||Q.options.style=="percent"?Ce="percentage":Q.mask&&(Ce=oe.call(Q,Q.mask)),Ce==="text"){var ot={};We=H}else if(Ce==="general"){var ot=ye(H,Q,!0);We=H}else if(Ce==="datetime"){H instanceof Date&&(H=ye.getDateString(H,Q.mask));var ot=ye(H,Q,!0);m.isNumeric(H)?We=H:We=F.call(ot)}else if(Ce==="scientific"){We=H,typeof H=="string"&&(We=Number(We));var ot=Q}else{We=he.call(Q,H),Ce==="percentage"&&(""+H).indexOf("%")!==-1&&(We/=100);var ot=Q}return ot.value=We,!ot.type&&Ce&&(ot.type=Ce),pe?ot:We},ye.render=function(H,Q,pe,Re){if(b(H)||typeof Q!="object")return H;if(Q=Object.assign({},Q),Q.options||(Q.options={}),!Q.mask&&Q.format&&(Q.mask=Q.format),Q.mask){if(Q.mask.indexOf(";")!==-1){var Ce=Q.mask.split(";");pe||(Ce[0]=Ce[0].replace(new RegExp(/_\)/g),""),Ce[0]=Ce[0].replace(new RegExp(/_\(/g),"")),Q.mask=Ce[0]}Q.mask=Q.mask.replace(new RegExp(/\[h]/),"|h|"),Q.mask=Q.mask.replace(new RegExp(/\[.*?\]/),""),Q.mask=Q.mask.replace(new RegExp(/\|h\|/),"[h]")}var We=null;Q.type=="percent"||Q.options.style=="percent"?We="percentage":Q.mask?We=oe.call(Q,Q.mask):H instanceof Date&&(We="datetime");var ot=!1;if(We=="datetime"||Q.type=="calendar"){var Ce=ye.getDateString(H,Q.mask);Ce&&(H=Ce),Q.mask&&pe&&(ot=!0)}else if(We!=="text")if(typeof H=="string"&&t.isNumeric(H)&&(H=Number(H)),We==="percentage"&&(H=ye.adjustPrecision(H*100)),typeof H=="number"){var Ce=null;if(Q.mask&&pe){var mt=Le.call(Q,Q.mask);if(We==="scientific")if(Q.mask.indexOf(mt)!==-1){let yt=Q.mask.split("E");yt=yt[0].split(mt),yt=""+yt[1].match(/[0-9]+/g),yt=yt.length,Ce=H.toExponential(yt)}else Ce=H.toExponential(0);else{if(Q.mask.indexOf(mt)!==-1){mt=Q.mask.split(mt),mt=""+mt[1].match(/[0-9]+/g),mt=mt.length,Ce=H.toFixed(mt);let yt=H.toString().split("."),It=yt[1];It&&It.length>mt&&It[It.length-1]==="5"&&(Ce=parseFloat(yt[0]+"."+It+"1").toFixed(mt))}else H.toString().indexOf(mt)!==-1&&(Ce=H.toFixed(0));(""+Ce).indexOf("e")!==-1&&(Ce=ee(Ce))}}else if(Q.locale&&pe){var mt=(""+H).split(".");if(Q.options){typeof mt[1]>"u"&&(mt[1]="");var Et=mt[1].length;if(Q.options.minimumFractionDigits>Et)for(var Ye=0;Ye<Q.options.minimumFractionDigits-Et;Ye++)mt[1]+="0"}mt[1].length?Ce=mt.join("."):Ce=mt[0];var Et=mt[1].length;Q.options&&Q.options.maximumFractionDigits<Et&&(Ce=parseFloat(Ce).toFixed(Q.options.maximumFractionDigits))}else Ce=ee(H);Ce!==null&&(H=Ce,Le.call(Q,Q.mask),Q.options.decimal&&(H=H.replace(".",Q.options.decimal)))}else Q.mask&&pe&&(ot=!0);if(ot){var vt=Q.mask.length-H.length;if(vt>0)for(var Ye=0;Ye<vt;Ye++)H+=" "}if(We==="scientific")if(!pe)H=ee(H);else return H;if(We==="numeric"&&Re===!1&&typeof H=="string")return H;if(H=ye(H,Q),pe&&We==="numeric"){var xt=Q.mask.match(new RegExp(/^[0]+$/gm));if(xt&&xt.length===1){var He=xt[0].length;if(He>3)for(H=""+H;H.length<He;)H="0"+H}}return H},ye.set=function(H,Q){if(Q){H.setAttribute("data-mask",Q);var pe=new Event("input",{bubbles:!0,cancelable:!0});H.dispatchEvent(pe)}},ye.extractDateFromString=function(H,Q){var pe=ye(H,{mask:Q},!0);if(H>0&&Number(H)==H&&(pe.values.join("")!==pe.value||pe.type=="numeric")){var Re=new Date(Math.round((H-25569)*86400*1e3));return Re.getFullYear()+"-"+m.two(Re.getMonth())+"-"+m.two(Re.getDate())+" 00:00:00"}var Ce=!1;return pe.values&&pe.values.length===pe.tokens.length&&pe.values[pe.values.length-1].length>=pe.tokens[pe.tokens.length-1].length&&(Ce=!0),pe.date[0]&&pe.date[1]&&(pe.date[2]||Ce)?(pe.date[2]||(pe.date[2]=1),pe.date[0]+"-"+m.two(pe.date[1])+"-"+m.two(pe.date[2])+" "+m.two(pe.date[3])+":"+m.two(pe.date[4])+":"+m.two(pe.date[5])):""},ye.getDateString=function(H,Q){if(!Q)var Q={};if(Q&&typeof Q=="object"){if(Q.format)var pe=Q.format;else if(Q.mask)var pe=Q.mask}else var pe=Q;if(pe||(pe="YYYY-MM-DD"),pe.indexOf("[h]")>=0){var Re=0;if(H&&m.isNumeric(H)&&(Re=parseFloat(24*Number(H)),pe.indexOf("mm")>=0)){var Ce=(""+Re).split(".");if(Ce[1]){var We=60*parseFloat("0."+Ce[1]);We=parseFloat(We.toFixed(2))}else var We=0;Re=parseInt(Ce[0])+":"+m.two(We)}return Re}H instanceof Date?H=D.now(H):H&&m.isNumeric(H)&&(H=D.numToDate(H));for(var ot=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],mt=new RegExp(ot.join("|"),"gi"),Ye=pe.match(mt),Et=0;Et<Ye.length;Et++)Ye[Et].toUpperCase()=="MM"&&(Ye[Et-1]&&Ye[Et-1].toUpperCase().indexOf("H")>=0||Ye[Et-2]&&Ye[Et-2].toUpperCase().indexOf("H")>=0||Ye[Et+1]&&Ye[Et+1].toUpperCase().indexOf("S")>=0||Ye[Et+2]&&Ye[Et+2].toUpperCase().indexOf("S")>=0)&&(Ye[Et]="mi");var vt={tokens:Ye};if(H){var We=""+H,xt=We.indexOf("T")!==-1?"T":" ";We=We.split(xt);var Ce=0,He=0,ft=0;We[1]&&(Ce=We[1].split(":"),He=Ce[1]?Ce[1]:0,ft=Ce[2]?Ce[2]:0,Ce=Ce[0]?Ce[0]:0),We=We[0].split("-");let ht=new Date(We[0],We[1],0).getDate();if(We[0]&&We[1]&&We[2]&&We[0]>0&&We[1]>0&&We[1]<13&&We[2]>0&&We[2]<=ht){vt.data=[We[0],We[1],We[2],Ce,He,ft],vt.value=[];for(var yt=new Date(vt.data[0],vt.data[1]-1,vt.data[2],vt.data[3],vt.data[4],vt.data[5]),It=function(Rt){var Pt=this.tokens[Rt],Vt=Pt.toUpperCase(),Nt=null;Vt==="YYYY"?Nt=this.data[0]:Vt==="YYY"?Nt=this.data[0].substring(1,4):Vt==="YY"?Nt=this.data[0].substring(2,4):Vt==="Y"?Nt=this.data[0].substring(3,4):Pt==="MON"?Nt=D.months[yt.getMonth()].substr(0,3).toUpperCase():Pt==="mon"?Nt=D.months[yt.getMonth()].substr(0,3).toLowerCase():Pt==="MONTH"?Nt=D.months[yt.getMonth()].toUpperCase():Pt==="month"?Nt=D.months[yt.getMonth()].toLowerCase():Vt==="MMMMM"?Nt=D.months[yt.getMonth()].substr(0,1):Vt==="MMMM"||Pt==="Month"?Nt=D.months[yt.getMonth()]:Vt==="MMM"||Pt=="Mon"?Nt=D.months[yt.getMonth()].substr(0,3):Vt==="MM"?Nt=m.two(this.data[1]):Vt==="M"?Nt=yt.getMonth()+1:Pt==="DAY"?Nt=D.weekdays[yt.getDay()].toUpperCase():Pt==="day"?Nt=D.weekdays[yt.getDay()].toLowerCase():Vt==="DDDD"||Pt=="Day"?Nt=D.weekdays[yt.getDay()]:Vt==="DDD"?Nt=D.weekdays[yt.getDay()].substr(0,3):Vt==="DD"?Nt=m.two(this.data[2]):Vt==="D"?Nt=parseInt(this.data[2]):Vt==="Q"?Nt=Math.floor((yt.getMonth()+3)/3):Vt==="HH24"||Vt==="HH"?(Nt=this.data[3],Nt>12&&this.tokens.indexOf("am/pm")!==-1&&(Nt-=12),Nt=m.two(Nt)):Vt==="HH12"?this.data[3]>12?Nt=m.two(this.data[3]-12):Nt=m.two(this.data[3]):Vt==="H"?(Nt=this.data[3],Nt>12&&this.tokens.indexOf("am/pm")!==-1&&(Nt-=12,Nt=m.two(Nt))):Vt==="MI"?Nt=m.two(this.data[4]):Vt==="SS"?Nt=m.two(this.data[5]):Vt==="MS"?Nt=yt.getMilliseconds():Vt==="AM/PM"?this.data[3]>=12?Nt="PM":Nt="AM":Vt==="WD"&&(Nt=D.weekdays[yt.getDay()]),Nt===null?this.value[Rt]=this.tokens[Rt]:this.value[Rt]=Nt},Et=0;Et<vt.tokens.length;Et++)It.call(vt,Et);H=vt.value.join("")}else H=""}return H},ye}var z=k();function ne(){var q=function(X,F){if(X.calendar)return X.calendar.setOptions(F,!0);var b={type:"calendar"};b.options={},b.date=null,b.setOptions=function(ee,ye){var H={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:D.monthsShort,monthsFull:D.months,weekdays:D.weekdays,textDone:c.translate("Done"),textReset:c.translate("Reset"),textUpdate:c.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var Q in H)ee&&ee.hasOwnProperty(Q)?b.options[Q]=ee[Q]:(typeof b.options[Q]>"u"||ye===!0)&&(b.options[Q]=H[Q]);if(b.options.resetButton==!1?re.style.display="none":re.style.display="",b.options.readonly?X.setAttribute("readonly","readonly"):X.removeAttribute("readonly"),b.options.placeholder?X.setAttribute("placeholder",b.options.placeholder):X.removeAttribute("placeholder"),m.isNumeric(b.options.value)&&b.options.value>0&&(b.options.value=q.numToDate(b.options.value),b.options.dataType="numeric"),re.innerHTML=b.options.textReset,me.innerHTML=b.options.textDone,j.innerHTML=b.options.textUpdate,b.options.format&&X.setAttribute("data-mask",b.options.format.toLowerCase()),!b.options.value&&b.options.today)var pe=q.now();else var pe=b.options.value;return pe&&(b.options.value=null,b.setValue(pe)),b},b.open=function(ee){if(!ae.classList.contains("jcalendar-focus")&&!ae.classList.contains("jcalendar-inline")){if(q.current=b,f(b,!0),b.getDays(),b.options.type=="year-month-picker"&&b.getMonths(),b.options.time&&(Y.value=b.date[3],oe.value=b.date[4]),ae.classList.add("jcalendar-focus"),m.getWindowWidth()<800||b.options.fullscreen)ae.classList.add("jcalendar-fullsize"),N.slideBottom(Ae,1);else{ae.classList.remove("jcalendar-fullsize");var ye=X.getBoundingClientRect(),H=Ae.getBoundingClientRect();if(b.options.position)he.style.position="fixed",window.innerHeight<ye.bottom+H.height?he.style.top=ye.top-(H.height+2)+"px":he.style.top=ye.top+ye.height+2+"px",he.style.left=ye.left+"px";else{if(window.innerHeight<ye.bottom+H.height){var Q=-1*(ye.height+H.height+2);Q+ye.top<0&&(Q=-1*(ye.top+ye.height)),he.style.top=Q+"px"}else he.style.top="2px";if(window.innerWidth<ye.left+H.width){var Q=window.innerWidth-(ye.left+H.width+20);he.style.left=Q+"px"}else he.style.left="0px"}}typeof b.options.onopen=="function"&&b.options.onopen(X)}},b.close=function(ee,ye){if(b.options.autoSelect!==!0&&typeof ye>"u"&&(ye=!1),ae.classList.contains("jcalendar-focus")){if(ye!==!1){var H=ae.querySelector(".jcalendar-selected");if(typeof ye=="string")var Q=ye;else if(!H||H.classList.contains("jcalendar-disabled"))var Q=b.options.value;else var Q=b.getValue();b.setValue(Q)}else{let pe=b.options.value||"";b.options.value=null,b.setValue(pe)}!ee&&typeof b.options.onclose=="function"&&b.options.onclose(X),ae.classList.remove("jcalendar-focus"),f(b,!1),q.current=null}return b.options.value},b.prev=function(){b.options.mode=="years"?(b.date[0]=b.date[0]-12,b.getYears()):b.options.mode=="months"?(b.date[0]=parseInt(b.date[0])-1,b.getMonths()):(b.date[1]<2?(b.date[0]=b.date[0]-1,b.date[1]=12):b.date[1]=b.date[1]-1,b.getDays())},b.next=function(){b.options.mode=="years"?(b.date[0]=parseInt(b.date[0])+12,b.getYears()):b.options.mode=="months"?(b.date[0]=parseInt(b.date[0])+1,b.getMonths()):(b.date[1]>11?(b.date[0]=parseInt(b.date[0])+1,b.date[1]=1):b.date[1]=parseInt(b.date[1])+1,b.getDays())},b.setToday=function(){var ee=new Date().toISOString().substr(0,10);return b.setValue(ee),ee},b.setValue=function(ee){ee||(ee=""+ee);var ye=ee,H=b.options.value;if(H!=ye){if(ye){b.setLabel(ye,b.options);var pe=ye.split(" ");pe[1]||(pe[1]="00:00:00");var Q=pe[1].split(":"),pe=pe[0].split("-"),Re=parseInt(pe[0]),Ce=parseInt(pe[1]),We=parseInt(pe[2]),ot=parseInt(Q[0]),mt=parseInt(Q[1]);b.date=[Re,Ce,We,ot,mt,0];var ee=b.setLabel(ye,b.options),Ye=q.now(new Date(Re,Ce-1,We),!0);if(b.options.validRange){if(!b.options.validRange[0]||Ye>=b.options.validRange[0])var Et=!0;else var Et=!1;if(!b.options.validRange[1]||Ye<=b.options.validRange[1])var vt=!0;else var vt=!1;Et&&vt?(X.classList.remove("jcalendar_warning"),X.title=""):(X.classList.add("jcalendar_warning"),X.title=c.translate("Date outside the valid range"))}else X.classList.remove("jcalendar_warning"),X.title=""}else{b.date=null;var ee="";X.classList.remove("jcalendar_warning"),X.title=""}b.options.value=ye,typeof b.options.onchange=="function"&&b.options.onchange(X,ye,H),X.value!=ee&&(X.value=ee,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value}))}b.date&&(b.getDays(),b.options.type=="year-month-picker"&&b.getMonths())},b.getValue=function(){return b.date?b.options.time?m.two(b.date[0])+"-"+m.two(b.date[1])+"-"+m.two(b.date[2])+" "+m.two(b.date[3])+":"+m.two(b.date[4])+":"+m.two(0):m.two(b.date[0])+"-"+m.two(b.date[1])+"-"+m.two(b.date[2])+" "+m.two(0)+":"+m.two(0)+":"+m.two(0):""},b.update=function(ee,ye){if(!ee.classList.contains("jcalendar-disabled")){var H=ae.querySelector(".jcalendar-selected");H&&H.classList.remove("jcalendar-selected"),ee.classList.add("jcalendar-selected"),ee.classList.contains("jcalendar-set-month")?(b.date[1]=ye,b.date[2]=1):b.date[2]=ee.innerText,b.options.time?(b.date[3]=Y.value,b.date[4]=oe.value):b.close(null,!0)}Le()},b.reset=function(){b.setValue(""),b.date=null,b.close(!1,!1)},b.getDays=function(){b.options.mode="days";var ot=new Date,ee=b.date&&m.isNumeric(b.date[0])?b.date[0]:parseInt(ot.getFullYear()),ye=b.date&&m.isNumeric(b.date[1])?b.date[1]:parseInt(ot.getMonth())+1,H=b.date&&m.isNumeric(b.date[2])?b.date[2]:parseInt(ot.getDate()),Q=b.date&&m.isNumeric(b.date[3])?b.date[3]:parseInt(ot.getHours()),pe=b.date&&m.isNumeric(b.date[4])?b.date[4]:parseInt(ot.getMinutes());b.date=[ee,ye,H,Q,pe,0],je.innerHTML=ee,ke.innerHTML=b.options.months[ye-1];var Re=ot.getMonth()==ye-1&&ot.getFullYear()==ee,Ce=ot.getDate(),ot=new Date(ee,ye,0,0,0),We=ot.getDate(),ot=new Date(ee,ye-1,0,0,0),mt=ot.getDay()+1,xt=b.options.startingDay||0;mt=mt-xt,pt.innerHTML="";var Ye=document.createElement("tr");Ye.setAttribute("align","center"),pt.appendChild(Ye);for(var Et=0;Et<7;Et++){var vt=document.createElement("td");vt.classList.add("jcalendar-weekday"),vt.innerHTML=b.options.weekdays[xt].substr(0,1),Ye.appendChild(vt),xt++,xt>6&&(xt=0)}for(var xt=0,He=0,ft=0;ft<6;ft++){var Ye=document.createElement("tr");Ye.setAttribute("align","center"),Ye.style.height="34px";for(var Et=0;Et<7;Et++){var vt=document.createElement("td");if(vt.classList.add("jcalendar-set-day"),xt>=mt&&xt<mt+We){He++,vt.innerHTML=He,He==H&&vt.classList.add("jcalendar-selected"),Re&&Ce==He&&(vt.style.fontWeight="bold");var yt=q.now(new Date(ee,ye-1,He),!0);if(b.options.validRange){if(!b.options.validRange[0]||yt>=b.options.validRange[0])var It=!0;else var It=!1;if(!b.options.validRange[1]||yt<=b.options.validRange[1])var gt=!0;else var gt=!1;It&&gt||vt.classList.add("jcalendar-disabled")}}Ye.appendChild(vt),xt++}pt.appendChild(Ye)}b.options.time?K.style.display="":K.style.display="none",Le()},b.getMonths=function(){b.options.mode="months";var ee=b.options.months;b.options.value;var ye=new Date,H=parseInt(ye.getFullYear()),Q=parseInt(ye.getMonth())+1,pe=b.date&&m.isNumeric(b.date[0])?b.date[0]:H,Re=b.date&&m.isNumeric(b.date[1])?b.date[1]:Q;je.innerHTML=b.date[0],ke.innerHTML=ee[Re-1];var Ce=document.createElement("table");Ce.setAttribute("width","100%");for(var We=null,ot=0;ot<12;ot++){if(!(ot%4)){var We=document.createElement("tr");We.setAttribute("align","center"),Ce.appendChild(We)}var mt=document.createElement("td");if(mt.classList.add("jcalendar-set-month"),mt.setAttribute("data-value",ot+1),mt.innerText=ee[ot],b.options.validRange){var Ye=pe+"-"+m.two(ot+1);if(!b.options.validRange[0]||Ye>=b.options.validRange[0].substr(0,7))var Et=!0;else var Et=!1;if(!b.options.validRange[1]||Ye<=b.options.validRange[1].substr(0,7))var vt=!0;else var vt=!1;Et&&vt||mt.classList.add("jcalendar-disabled")}ot+1==Re&&mt.classList.add("jcalendar-selected"),H==pe&&ot+1==Q&&(mt.style.fontWeight="bold"),We.appendChild(mt)}pt.innerHTML='<tr><td colspan="7"></td></tr>',pt.children[0].children[0].appendChild(Ce),Le()},b.getYears=function(){b.options.mode="years";for(var ee=new Date,ye=ee.getFullYear(),H=b.date&&m.isNumeric(b.date[0])?b.date[0]:parseInt(ee.getFullYear()),Q=[],pe=0;pe<25;pe++)Q[pe]=parseInt(b.date[0])+(pe-12);var Re=document.createElement("table");Re.setAttribute("width","100%");for(var pe=0;pe<25;pe++){if(!(pe%5)){var Ce=document.createElement("tr");Ce.setAttribute("align","center"),Re.appendChild(Ce)}var We=document.createElement("td");We.classList.add("jcalendar-set-year"),We.innerText=Q[pe],H==Q[pe]&&We.classList.add("jcalendar-selected"),ye==Q[pe]&&(We.style.fontWeight="bold"),Ce.appendChild(We)}pt.innerHTML='<tr><td colspan="7"></td></tr>',pt.firstChild.firstChild.appendChild(Re),Le()},b.setLabel=function(ee,ye){return q.getDateString(ee,ye)},b.fromFormatted=function(ee,ye){return q.extractDateFromString(ee,ye)};var ce=function(ee){var ye=m.findElement(ee.target,"jcalendar-container");if(ye){var H=ee.target.className;if(H=="jcalendar-prev")b.prev();else if(H=="jcalendar-next")b.next();else if(H=="jcalendar-month")b.getMonths();else if(H=="jcalendar-year")b.getYears();else if(H=="jcalendar-set-year")b.date[0]=ee.target.innerText,b.options.type=="year-month-picker"?b.getMonths():b.getDays();else if(ee.target.classList.contains("jcalendar-set-month")){var Q=parseInt(ee.target.getAttribute("data-value"));b.options.type=="year-month-picker"?b.update(ee.target,Q):(b.date[1]=Q,b.getDays())}else H=="jcalendar-confirm"||H=="jcalendar-update"||H=="jcalendar-close"?b.close(null,!0):H=="jcalendar-backdrop"?b.close(!1,!1):H=="jcalendar-reset"?b.reset():ee.target.classList.contains("jcalendar-set-day")&&ee.target.innerText&&b.update(ee.target)}else b.close(!1,!1)},Fe=function(ee){if(ee.target.value&&ee.target.value.length>3){var ye=q.extractDateFromString(ee.target.value,b.options.format);ye&&b.setValue(ye)}},Le=function(){var ee=ae.querySelector(".jcalendar-selected");ee&&ee.classList.contains("jcalendar-disabled")?(j.setAttribute("disabled","disabled"),Y.setAttribute("disabled","disabled"),oe.setAttribute("disabled","disabled")):(j.removeAttribute("disabled"),Y.removeAttribute("disabled"),oe.removeAttribute("disabled")),typeof b.options.onupdate=="function"&&b.options.onupdate(X,b.getValue())},ae=null,re=null,me=null,he=null,Ae=null,je=null,ke=null,et=null,pt=null,A=null,K=null,L=null,j=null,Y=null,oe=null,Te=function(){X.tagName=="INPUT"&&X.value&&(F.value=X.value),re=document.createElement("div"),re.className="jcalendar-reset",me=document.createElement("div"),me.className="jcalendar-confirm",A=document.createElement("div"),A.className="jcalendar-controls",A.style.borderBottom="1px solid #ddd",A.appendChild(re),A.appendChild(me),he=document.createElement("div"),he.className="jcalendar-container",Ae=document.createElement("div"),Ae.className="jcalendar-content",he.appendChild(Ae),X.tagName=="DIV"?(ae=X,ae.classList.add("jcalendar-inline")):(Ae.appendChild(A),ae=document.createElement("div"),ae.className="jcalendar"),ae.classList.add("jcalendar-container"),ae.appendChild(he);var ee=document.createElement("div");ee.className="jcalendar-table",Ae.appendChild(ee);var ye=document.createElement("td");ye.setAttribute("colspan","2"),ye.className="jcalendar-prev",je=document.createElement("span"),je.className="jcalendar-year",ke=document.createElement("span"),ke.className="jcalendar-month";var H=document.createElement("td");H.className="jcalendar-header",H.setAttribute("colspan","3"),H.appendChild(ke),H.appendChild(je);var Q=document.createElement("td");Q.setAttribute("colspan","2"),Q.className="jcalendar-next";var pe=document.createElement("thead"),Re=document.createElement("tr");Re.appendChild(ye),Re.appendChild(H),Re.appendChild(Q),pe.appendChild(Re),et=document.createElement("table"),pt=document.createElement("tbody"),et.setAttribute("cellpadding","0"),et.setAttribute("cellspacing","0"),et.appendChild(pe),et.appendChild(pt),ee.appendChild(et),Y=document.createElement("select"),Y.className="jcalendar-select",Y.onchange=function(){b.date[3]=this.value,typeof b.options.onupdate=="function"&&b.options.onupdate(X,b.getValue())};for(var Ce=0;Ce<24;Ce++){var We=document.createElement("option");We.value=Ce,We.innerHTML=m.two(Ce),Y.appendChild(We)}oe=document.createElement("select"),oe.className="jcalendar-select",oe.onchange=function(){b.date[4]=this.value,typeof b.options.onupdate=="function"&&b.options.onupdate(X,b.getValue())};for(var Ce=0;Ce<60;Ce++){var We=document.createElement("option");We.value=Ce,We.innerHTML=m.two(Ce),oe.appendChild(We)}var ot=document.createElement("div");ot.className="jcalendar-controls",K=document.createElement("div"),K.className="jcalendar-time",K.style.maxWidth="140px",K.appendChild(Y),K.appendChild(oe),j=document.createElement("button"),j.setAttribute("type","button"),j.className="jcalendar-update",L=document.createElement("div"),L.style.flexGrow="10",L.appendChild(j),ot.appendChild(K),X.tagName=="INPUT"&&ot.appendChild(L),Ae.appendChild(ot);var mt=document.createElement("div");mt.className="jcalendar-backdrop",ae.appendChild(mt),X.addEventListener("keyup",Fe),ae.addEventListener("swipeleft",function(Ye){N.slideLeft(et,0,function(){b.next(),N.slideRight(et,1)}),Ye.preventDefault(),Ye.stopPropagation()}),ae.addEventListener("swiperight",function(Ye){N.slideRight(et,0,function(){b.prev(),N.slideLeft(et,1)}),Ye.preventDefault(),Ye.stopPropagation()}),"ontouchend"in document.documentElement?(ae.addEventListener("touchend",ce),X.addEventListener("touchend",b.open)):(ae.addEventListener("mouseup",ce),X.addEventListener("mouseup",b.open)),q.hasEvents||(q.hasEvents=!0,document.addEventListener("keydown",q.keydown)),b.setOptions(F),X.tagName=="INPUT"?(X.parentNode.insertBefore(ae,X.nextSibling),X.setAttribute("autocomplete","off"),X.classList.add("jcalendar-input"),X.value=b.setLabel(b.getValue(),b.options)):(b.getDays(),b.options.time&&(Y.value=b.date[3],oe.value=b.date[4])),b.options.opened==!0&&b.open(),b.options.controls==!1&&he.classList.add("jcalendar-hide-controls"),X.change=b.setValue,X.val=function(Ye){if(Ye===void 0)return b.getValue();b.setValue(Ye)},X.calendar=ae.calendar=b};return Te(),b};return q.keydown=function(X){var F=null;(F=q.current)&&(X.which==13?F.close(!1,!0):X.which==27&&F.close(!1,!1))},q.prettify=function(X,F){if(!F)var F={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};X.indexOf("GMT")===-1&&X.indexOf("Z")===-1&&(X+=" GMT");var b=new Date,ce=new Date(X),Fe=parseInt((b-ce)/1e3/60);if(String.prototype.format=function(ae){return this.replace("{0}",ae)},Fe==0)var Le=F.justNow;else if(Fe<90)var Le=F.xMinutesAgo.format(Fe);else if(Fe<1440)var Le=F.xHoursAgo.format(Math.round(Fe/60));else if(Fe<20160)var Le=F.xDaysAgo.format(Math.round(Fe/1440));else if(Fe<43200)var Le=F.xWeeksAgo.format(Math.round(Fe/10080));else if(Fe<1036800)var Le=F.xMonthsAgo.format(Math.round(Fe/43200));else var Le=F.xYearsAgo.format(Math.round(Fe/525600));return Le},q.prettifyAll=function(){for(var X=document.querySelectorAll(".prettydate"),F=0;F<X.length;F++)X[F].getAttribute("data-date")?X[F].innerHTML=q.prettify(X[F].getAttribute("data-date")):X[F].innerHTML&&(X[F].setAttribute("title",X[F].innerHTML),X[F].setAttribute("data-date",X[F].innerHTML),X[F].innerHTML=q.prettify(X[F].innerHTML))},q.now=D.now,q.toArray=D.toArray,q.dateToNum=D.dateToNum,q.numToDate=D.numToDate,q.weekdays=D.weekdays,q.months=D.months,q.weekdaysShort=D.weekdaysShort,q.monthsShort=D.monthsShort,q.extractDateFromString=z.extractDateFromString,q.getDateString=z.getDateString,q}var Z=ne();function ve(){var q={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},X=function(F){return q[F]?q[F]:q.material};return X.get=function(F){return q[F]?q[F]:q},X.set=function(F,b){q[F]=b},X}var xe=ve();function de(q,X){var F={};F.options={};var b={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var ce in b)X&&X.hasOwnProperty(ce)?F.options[ce]=X[ce]:F.options[ce]=b[ce];q.classList.add("jtabs");var Fe=null,Le=null,ae=null;const re=function(ke){F.options.animation&&setTimeout(function(){let et=F.headers.children[ke].getBoundingClientRect();F.options.palette==="modern"?(ae.style.width=et.width-4+"px",ae.style.left=F.headers.children[ke].offsetLeft+2+"px"):(ae.style.width=et.width+"px",ae.style.left=F.headers.children[ke].offsetLeft+"px"),F.options.position==="bottom"?ae.style.top="0px":ae.style.bottom="0px"},50)};var me=function(ke){typeof F.headers.scrollTo=="function"?F.headers.scrollTo({left:ke,behavior:"smooth"}):F.headers.scrollLeft=ke,ke<=1?Fe.classList.add("disabled"):Fe.classList.remove("disabled"),ke>=F.headers.scrollWidth-F.headers.offsetWidth?Le.classList.add("disabled"):Le.classList.remove("disabled"),F.headers.scrollWidth<=F.headers.offsetWidth?(Fe.style.display="none",Le.style.display="none"):(Fe.style.display="",Le.style.display="")};if(F.setBorder=re,F.open=function(ke){if(Array.from(F.content.children),!!F.content.children[ke]){for(var et=null,pt=0;pt<F.headers.children.length;pt++)F.headers.children[pt].classList.contains("jtabs-selected")&&(et=pt),F.headers.children[pt].classList.remove("jtabs-selected"),F.content.children[pt]&&F.content.children[pt].classList.remove("jtabs-selected");if(F.headers.children[ke].classList.add("jtabs-selected"),F.content.children[ke]&&F.content.children[ke].classList.add("jtabs-selected"),et!=ke&&typeof F.options.onchange=="function"&&F.content.children[ke]&&F.options.onchange(q,F,ke,F.headers.children[ke],F.content.children[ke]),F.options.hideHeaders==!0&&F.headers.children.length<3&&F.options.allowCreate==!1)F.headers.parentNode.style.display="none";else{F.headers.parentNode.style.display="";var A=F.headers.children[ke].offsetLeft,K=A+F.headers.children[ke].offsetWidth,L=F.headers.scrollLeft,j=L+F.headers.offsetWidth;L<=A&&j>=K||me(A-1),re(ke)}}},F.selectIndex=function(ke){var et=Array.prototype.indexOf.call(F.headers.children,ke);return et>=0&&F.open(et),et},F.rename=function(ke,et){et||(et=prompt("New title",F.headers.children[ke].innerText)),F.headers.children[ke].innerText=et,re(F.getActive())},F.create=function(ke,et){if(typeof F.options.onbeforecreate=="function"){var pt=F.options.onbeforecreate(q,ke);if(pt===!1)return!1;ke=pt}var A=F.appendElement(ke);return typeof F.options.oncreate=="function"&&F.options.oncreate(q,A),re(F.getActive()),A},F.remove=function(ke){return F.deleteElement(ke)},F.nextNumber=function(){for(var ke=0,et=0;et<F.headers.children.length;et++){var pt=F.headers.children[et].innerText.match(/[0-9].*/);pt>ke&&(ke=parseInt(pt))}return ke?ke++:ke=1,ke},F.deleteElement=function(ke){let et=F.getActive();if(F.headers.children[ke])F.headers.removeChild(F.headers.children[ke]),F.content.removeChild(F.content.children[ke]);else return!1;if(et===ke)F.open(0);else{let pt=F.getActive()||0;re(pt)}typeof F.options.ondelete=="function"&&F.options.ondelete(q,ke)},F.appendElement=function(ke,et,pt,A){if(!ke)var ke=prompt("Title?","");if(ke){var K=document.createElement("div"),L=document.createElement("div");if(L.innerHTML=ke,L.content=K,typeof A>"u")F.content.appendChild(K),F.headers.insertBefore(L,F.headers.lastChild);else{let j=F.content.children[A];j?F.content.insertBefore(K,j):F.content.appendChild(K),j=F.headers.children[A]||F.headers.lastChild,F.headers.insertBefore(L,j)}return F.options.allowChangePosition&&L.setAttribute("draggable","true"),pt!==!1&&F.selectIndex(L),typeof et=="function"&&et(K,L),K}},F.getActive=function(){for(var ke=0;ke<F.headers.children.length;ke++)if(F.headers.children[ke].classList.contains("jtabs-selected"))return ke;return!1},F.updateContent=function(ke,et){if(typeof et!="string")var pt=et;else{var pt=document.createElement("div");pt.innerHTML=et}F.content.children[ke].classList.contains("jtabs-selected")&&et.classList.add("jtabs-selected"),F.content.replaceChild(et,F.content.children[ke]),re()},F.updatePosition=function(ke,et,pt,A){if(ke>et?F.content.insertBefore(F.content.children[ke],F.content.children[et]):F.content.insertBefore(F.content.children[ke],F.content.children[et].nextSibling),A!==!1)F.open(et);else{const K=F.getActive();et<K&&F.setBorder(K)}!pt&&typeof F.options.onchangeposition=="function"&&F.options.onchangeposition(F.headers,ke,et)},F.move=function(ke,et,pt,A){ke>et?F.headers.insertBefore(F.headers.children[ke],F.headers.children[et]):F.headers.insertBefore(F.headers.children[ke],F.headers.children[et].nextSibling),F.updatePosition(ke,et,pt,A)},F.setBorder=re,F.init=function(){q.innerHTML="",F.headers=document.createElement("div"),F.content=document.createElement("div"),F.headers.classList.add("jtabs-headers"),F.content.classList.add("jtabs-content"),F.options.palette?q.classList.add("jtabs-modern"):q.classList.remove("jtabs-modern"),F.options.padding&&(F.content.style.padding=parseInt(F.options.padding)+"px");var ke=document.createElement("div");ke.className="jtabs-headers-container",ke.appendChild(F.headers),F.options.maxWidth&&(ke.style.maxWidth=parseInt(F.options.maxWidth)+"px");var et=document.createElement("div");if(et.className="jtabs-controls",et.setAttribute("draggable","false"),ke.appendChild(et),F.options.position=="bottom"?(q.appendChild(F.content),q.appendChild(ke)):(q.appendChild(ke),q.appendChild(F.content)),F.options.allowCreate==!0){var pt=document.createElement("div");pt.className="jtabs-add",pt.onclick=function(){F.create()},et.appendChild(pt)}Fe=document.createElement("div"),Fe.className="jtabs-prev",Fe.onclick=function(){me(F.headers.scrollLeft-F.headers.offsetWidth)},et.appendChild(Fe),Le=document.createElement("div"),Le.className="jtabs-next",Le.onclick=function(){me(F.headers.scrollLeft+F.headers.offsetWidth)},et.appendChild(Le);for(var A=0;A<F.options.data.length;A++){if(F.options.data[A].titleElement)var K=F.options.data[A].titleElement;else var K=document.createElement("div");if(F.options.data[A].icon){var L=document.createElement("div"),j=document.createElement("i");j.classList.add("material-icons"),j.innerHTML=F.options.data[A].icon,L.appendChild(j),K.appendChild(L)}if(F.options.data[A].title){var Y=document.createTextNode(F.options.data[A].title);K.appendChild(Y)}if(F.options.data[A].width&&(K.style.width=F.options.data[A].width),F.options.data[A].contentElement)var oe=F.options.data[A].contentElement;else{var oe=document.createElement("div");oe.innerHTML=F.options.data[A].content}F.headers.appendChild(K),F.content.appendChild(oe)}ae=document.createElement("div"),ae.className="jtabs-border",F.headers.appendChild(ae),F.options.animation&&q.classList.add("jtabs-animation"),F.headers.addEventListener("click",function(Te){if(Te.target.parentNode.classList.contains("jtabs-headers"))var ee=Te.target;else if(Te.target.tagName=="I")var ee=Te.target.parentNode.parentNode;else var ee=Te.target.parentNode;var ye=F.selectIndex(ee);typeof F.options.onclick=="function"&&F.options.onclick(q,F,ye,F.headers.children[ye],F.content.children[ye])}),F.headers.addEventListener("contextmenu",function(Te){F.selectIndex(Te.target)}),F.headers.children.length&&F.open(0),me(0),F.options.allowChangePosition==!0&&v(F.headers,{direction:1,ondrop:function(Te,ee,ye){F.updatePosition(ee,ye)}}),typeof F.options.onload=="function"&&F.options.onload(q,F)},q.children[0]&&q.children[0].children.length)for(var he=0;he<q.children[0].children.length;he++){var Ae=F.options.data&&F.options.data[he]?F.options.data[he]:{};q.children[1]&&q.children[1].children[he]?(Ae.titleElement=q.children[0].children[he],Ae.contentElement=q.children[1].children[he]):Ae.contentElement=q.children[0].children[he],F.options.data[he]=Ae}var je=!1;if(F.options.data)for(var he=0;he<F.options.data.length;he++)F.options.data[he].url&&(R({url:F.options.data[he].url,type:"GET",dataType:"text/html",index:he,success:function(et){F.options.data[this.index].content=et},complete:function(){F.init()}}),je=!0);return je||F.init(),q.tabs=F,F}function Se(q,X){if(q.color)return q.color.setOptions(X,!0);var F={type:"color"};F.options={};var b=null,ce=null,Fe=null,Le=null,ae=null,re=null,me=null;F.setOptions=function(H,Q){var pe={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};H||(H={}),H&&!H.palette&&(H.palette=xe());for(var Re in pe)H&&H.hasOwnProperty(Re)?F.options[Re]=H[Re]:(typeof F.options[Re]>"u"||Q===!0)&&(F.options[Re]=pe[Re]);return Le&&(Le.innerHTML=F.options.resetLabel),ae&&(ae.innerHTML=F.options.doneLabel),F.options.palette&&me&&me.updateContent(0,et()),typeof F.options.value=="string"&&(q.value=F.options.value,q.tagName==="INPUT"&&(q.style.color=q.value,q.style.backgroundColor=q.value)),F.options.placeholder?q.setAttribute("placeholder",F.options.placeholder):q.getAttribute("placeholder")&&q.removeAttribute("placeholder"),F},F.select=function(H){var Q=b.querySelector(".jcolor-selected");Q&&Q.classList.remove("jcolor-selected"),F.values[H]&&F.values[H].classList.add("jcolor-selected"),F.options.value=H},F.open=function(){if(!b.classList.contains("jcolor-focus")){f(F,!0),b.classList.add("jcolor-focus"),F.options.value&&F.select(F.options.value),Fe.style.marginTop="",Fe.style.marginLeft="";var H=Fe.getBoundingClientRect(),Q=m.getWindowWidth(),pe=m.getWindowHeight();if(Q<800||F.options.fullscreen==!0?(Fe.classList.add("jcolor-fullscreen"),N.slideBottom(Fe,1),ce.style.display="block"):(Fe.classList.contains("jcolor-fullscreen")&&(Fe.classList.remove("jcolor-fullscreen"),ce.style.display=""),F.options.position?Fe.style.position="fixed":Fe.style.position="",H.left+H.width>Q&&(Fe.style.marginLeft=-1*(H.left+H.width-(Q-20))+"px"),H.top+H.height>pe&&(Fe.style.marginTop=-1*(H.top+H.height-(pe-20))+"px")),typeof F.options.onopen=="function"&&F.options.onopen(q,F),me.setBorder(me.getActive()),F.options.value){var Re=ke(F.options.value);oe.forEach(function(Ce,We){Ce.value=Re[We],Ce.dispatchEvent(new Event("input"))})}}},F.close=function(H){return b.classList.contains("jcolor-focus")&&(b.classList.remove("jcolor-focus"),ce.style.display="",!H&&typeof F.options.onclose=="function"&&F.options.onclose(q,F),f(F,!1)),F.options.value},F.setValue=function(H){H||(H=""),H!=F.options.value&&(F.options.value=H,Y=H,F.select(H),typeof F.options.onchange=="function"&&F.options.onchange(q,H,F),q.value!=F.options.value&&(q.value=F.options.value,q.tagName==="INPUT"&&(q.style.color=q.value,q.style.backgroundColor=q.value),typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value})),F.options.closeOnChange==!0&&F.close())},F.getValue=function(){return F.options.value};var he=function(H){var Q=H.toString(16);return Q.length===1?"0"+Q:Q},Ae=function(H,Q,pe){return"#"+he(H)+he(Q)+he(pe)},je=function(H){return parseInt("0x"+H)},ke=function(H){return[je(H.substr(1,2)),je(H.substr(3,2)),je(H.substr(5,2))]},et=function(){var H=document.createElement("div");H.className="jcolor-grid",F.values=[];var Q=document.createElement("table");Q.setAttribute("cellpadding","7"),Q.setAttribute("cellspacing","0");for(var pe=0;pe<F.options.palette.length;pe++){for(var Re=document.createElement("tr"),Ce=0;Ce<F.options.palette[pe].length;Ce++){var We=document.createElement("td"),ot=F.options.palette[pe][Ce];ot.length<7&&ot.substr(0,1)!=="#"&&(ot="#"+ot),We.style.backgroundColor=ot,We.setAttribute("data-value",ot),We.innerHTML="",Re.appendChild(We),F.options.value==ot&&We.classList.add("jcolor-selected"),F.values[ot]=We}Q.appendChild(Re)}return H.appendChild(Q),H},pt=document.createElement("canvas");pt.width=200,pt.height=160;var A=pt.getContext("2d"),K=function(){var H=re.firstChild.getBoundingClientRect();pt.width=H.width-14,L()},L=function(){var H=A.createLinearGradient(0,0,pt.width,0);H.addColorStop(0,"rgb(255,0,0)"),H.addColorStop(.15,"rgb(255,0,255)"),H.addColorStop(.33,"rgb(0,0,255)"),H.addColorStop(.49,"rgb(0,255,255)"),H.addColorStop(.67,"rgb(0,255,0)"),H.addColorStop(.84,"rgb(255,255,0)"),H.addColorStop(1,"rgb(255,0,0)"),A.fillStyle=H,A.fillRect(0,0,pt.width,pt.height),H=A.createLinearGradient(0,0,0,pt.height),H.addColorStop(0,"rgba(255,255,255,1)"),H.addColorStop(.5,"rgba(255,255,255,0)"),H.addColorStop(.5,"rgba(0,0,0,0)"),H.addColorStop(1,"rgba(0,0,0,1)"),A.fillStyle=H,A.fillRect(0,0,pt.width,pt.height)},j=function(){var H=document.createElement("div");H.className="jcolor-hsl";var Q=document.createElement("div");Q.className="jcolor-point";var pe=document.createElement("div");pe.appendChild(pt),pe.appendChild(Q),H.appendChild(pe);var Re=function(Ce,We,ot){if(Ce===1){var mt=H.getBoundingClientRect(),Ye=We-mt.left,Et=ot-mt.top;Ye<0&&(Ye=0),Et<0&&(Et=0),Ye>mt.width&&(Ye=mt.width),Et>mt.height&&(Et=mt.height),Q.style.left=Ye+"px",Q.style.top=Et+"px";var vt=A.getImageData(Ye,Et,1,1).data;Y=Ae(vt[0],vt[1],vt[2])}};return H.addEventListener("mousedown",function(Ce){Re(Ce.buttons,Ce.clientX,Ce.clientY)}),H.addEventListener("mousemove",function(Ce){Re(Ce.buttons,Ce.clientX,Ce.clientY)}),H.addEventListener("touchmove",function(Ce){Re(1,Ce.changedTouches[0].clientX,Ce.changedTouches[0].clientY)}),H},Y="",oe=[],Te=function(){if(Y!=="")for(var H=0;H<oe.length;H++){var Q=ke(Y);Q[H]=0;var pe="linear-gradient(90deg, rgb(";pe+=Q.join(", "),pe+="), rgb(",Q[H]=255,pe+=Q.join(", "),pe+="))",oe[H].style.backgroundImage=pe}},ee=function(){var H=document.createElement("div");H.className="jcolor-sliders";var Q=document.createElement("div"),pe=function(ot){var mt=document.createElement("div");mt.className="jcolor-sliders-input-container";var Ye=document.createElement("label");Ye.innerText=ot;var Et=document.createElement("div");Et.className="jcolor-sliders-input-subcontainer";var vt=document.createElement("input");vt.type="range",vt.min=0,vt.max=255,vt.value=0,mt.appendChild(Ye),Et.appendChild(vt);var xt=document.createElement("div");return xt.innerText=vt.value,vt.addEventListener("input",function(){xt.innerText=vt.value}),Et.appendChild(xt),mt.appendChild(Et),Q.appendChild(mt),vt};oe=[pe("Red"),pe("Green"),pe("Blue")],H.appendChild(Q);var Re=document.createElement("div");Re.className="jcolor-sliders-final-color";var Ce=document.createElement("div");Ce.style.visibility="hidden",Ce.innerText="a",Re.appendChild(Ce);var We=function(){var ot=Ae(parseInt(oe[0].value),parseInt(oe[1].value),parseInt(oe[2].value));Ce.innerText=ot,Ce.style.color=ot,Ce.style.removeProperty("visibility"),Y=ot};return oe.forEach(function(ot){ot.addEventListener("input",function(){We(),Te()})}),H.appendChild(Re),H},ye=function(){F.setOptions(X),q.tagName=="INPUT"&&(q.classList.add("jcolor-input"),q.readOnly=!0),b=document.createElement("div"),b.className="jcolor",ce=document.createElement("div"),ce.className="jcolor-backdrop",b.appendChild(ce),Fe=document.createElement("div"),Fe.className="jcolor-content";var H=document.createElement("div");H.className="jcolor-controls",Fe.appendChild(H),Le=document.createElement("div"),Le.className="jcolor-reset",Le.innerHTML=F.options.resetLabel,H.appendChild(Le),ae=document.createElement("div"),ae.className="jcolor-close",ae.innerHTML=F.options.doneLabel,H.appendChild(ae),re=document.createElement("div"),Fe.appendChild(re),me=de(re,{animation:!0,data:[{title:"Grid",contentElement:et()},{title:"Spectrum",contentElement:j()},{title:"Sliders",contentElement:ee()}],onchange:function(Q,pe,Re){if(Re===1)K();else{var Ce=Y!==""?Y:F.getValue();if(Re===2&&Ce){var We=ke(Ce);oe.forEach(function(ot,mt){ot.value=We[mt],ot.dispatchEvent(new Event("input"))})}}},palette:"modern"}),b.appendChild(Fe),q.tagName=="INPUT"?q.parentNode.insertBefore(b,q.nextSibling):q.appendChild(b),b.addEventListener("click",function(Q){if(Q.target.tagName=="TD"){var pe=Q.target.getAttribute("data-value");pe&&F.setValue(pe)}else Q.target.classList.contains("jcolor-reset")?(F.setValue(""),F.close()):Q.target.classList.contains("jcolor-close")?(me.getActive()>0&&F.setValue(Y),F.close()):Q.target.classList.contains("jcolor-backdrop")?F.close():F.open()}),q.addEventListener("mouseup",function(Q){F.open()}),window.addEventListener("resize",function(){b.classList.contains("jcolor-focus")&&me.getActive()==1&&K()}),F.options.opened==!0&&F.open(),q.change=F.setValue,q.val=function(Q){if(Q===void 0)return F.getValue();F.setValue(Q)},q.color=F,b.color=F};return F.toHex=function(H){var Q=function(pe){return("0"+parseInt(pe).toString(16)).slice(-2)};if(H)return/^#[0-9A-F]{6}$/i.test(H)?H:(H=H.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),H&&H.length?"#"+Q(H[1])+Q(H[2])+Q(H[3]):"")},ye(),F}function Me(){var q=function(X,F){var b={type:"contextmenu"};b.options={};var ce={items:null,onclick:null};for(var Fe in ce)F&&F.hasOwnProperty(Fe)?b.options[Fe]=F[Fe]:b.options[Fe]=ce[Fe];X.classList.add("jcontextmenu"),b.open=function(re,me){if(me&&(b.options.items=me,b.create(me)),q.current&&q.current.close(),f(b,!0),X.classList.add("jcontextmenu-focus"),q.current=b,b.options.items&&b.options.items.length>0||X.children.length){if(re.target)if(re.changedTouches&&re.changedTouches[0])he=re.changedTouches[0].clientX,Ae=re.changedTouches[0].clientY;else var he=re.clientX,Ae=re.clientY;else var he=re.x,Ae=re.y;var je=X.getBoundingClientRect();if(window.innerHeight<Ae+je.height){var ke=Ae-je.height;ke<0&&(ke=0),X.style.top=ke+"px"}else X.style.top=Ae+"px";window.innerWidth<he+je.width?he-je.width>0?X.style.left=he-je.width+"px":X.style.left="10px":X.style.left=he+"px"}},b.isOpened=function(){return!!X.classList.contains("jcontextmenu-focus")},b.close=function(){X.classList.contains("jcontextmenu-focus")&&X.classList.remove("jcontextmenu-focus"),f(b,!1)},b.create=function(re){X.innerHTML="";var me=Le();X.appendChild(me);for(var he=0;he<re.length;he++){var Ae=ae(re[he]);X.appendChild(Ae)}};function Le(){var re=document.createElement("div");re.classList.add("header"),re.addEventListener("click",function(Ae){Ae.preventDefault(),Ae.stopPropagation()});var me=document.createElement("a");me.classList.add("title"),me.innerHTML=c.translate("Menu"),re.appendChild(me);var he=document.createElement("a");return he.classList.add("close"),he.innerHTML=c.translate("close"),he.addEventListener("click",function(Ae){b.close()}),re.appendChild(he),re}function ae(re){if(re.type&&(re.type=="line"||re.type=="divisor"))var me=document.createElement("hr");else{var me=document.createElement("div"),he=document.createElement("a");if(he.innerHTML=re.title,re.tooltip&&me.setAttribute("title",re.tooltip),re.icon&&me.setAttribute("data-icon",re.icon),re.id&&(me.id=re.id),re.disabled?me.className="jcontextmenu-disabled":re.onclick&&(me.method=re.onclick,me.addEventListener("mousedown",function(L){L.preventDefault()}),me.addEventListener("mouseup",function(L){this.method(this,L)})),me.appendChild(he),re.submenu){var Ae=document.createElement("span");Ae.innerHTML="&#9658;",me.appendChild(Ae),me.classList.add("jcontexthassubmenu");var je=document.createElement("div");je.classList.add("jcontextmenu"),je.setAttribute("tabindex","900");for(var ke=re.submenu,et=0;et<ke.length;et++){var pt=ae(ke[et]);je.appendChild(pt)}me.appendChild(je)}else if(re.shortcut){var A=document.createElement("span");A.innerHTML=re.shortcut,me.appendChild(A)}}return me}return typeof b.options.onclick=="function"&&X.addEventListener("click",function(re){b.options.onclick(b,re)}),b.options.items&&b.create(b.options.items),window.addEventListener("mousewheel",function(){b.close()}),X.contextmenu=b,b};return q}var Pe=Me();function _e(){var q=function(X,F){if(X.dropdown)return X.dropdown.setOptions(F,!0);var b={type:"dropdown"};b.options={};var ce=function(ee,ye){ee&&ee.length&&(b.options.sortResults!==!1&&(typeof b.options.sortResults=="function"?ee.sort(b.options.sortResults):ee.sort(Fe)),b.setData(ee)),typeof b.options.onload=="function"&&b.options.onload(X,b,ee,ye),ye&&ae(ye),ye==null&&(b.options.value=""),X.value=b.options.value,b.options.opened==!0&&b.open()},Fe=function(ee,ye){var H,Q;return typeof ee=="string"?H=ee:ee.text?H=ee.text:ee.name&&(H=ee.name),typeof ye=="string"?Q=ye:ye.text?Q=ye.text:ye.name&&(Q=ye.name),typeof H=="string"||typeof Q=="string"?(typeof H!="string"&&(H=""+H),typeof Q!="string"&&(Q=""+Q),H.localeCompare(Q)):H-Q},Le=function(){b.value={};for(var ee=0;ee<b.items.length;ee++)b.items[ee].selected==!0&&(b.items[ee].element&&b.items[ee].element.classList.remove("jdropdown-selected"),b.items[ee].selected=null);b.options.value="",X.value=""},ae=function(ee){if(Le(),ee!==null)if(!ee)typeof b.value[""]<"u"&&(b.value[""]="");else{Array.isArray(ee)||(ee=(""+ee).split(";"));for(var ye=0;ye<ee.length;ye++)b.value[ee[ye]]=""}for(var ye=0;ye<b.items.length;ye++)typeof b.value[re(ye)]<"u"&&(b.items[ye].element&&b.items[ye].element.classList.add("jdropdown-selected"),b.items[ye].selected=!0,b.value[re(ye)]=me(ye));b.options.value=Object.keys(b.value).join(";"),b.header.value=b.getText()},re=function(ee,ye){if(b.options.format)var H="id";else var H="value";return b.items[ee]?b.items[ee].data[H]:""},me=function(ee,ye){if(b.options.format)var H="name";else var H="text";return b.items[ee]?b.items[ee].data[H]:""},he=function(){return Object.keys(b.value)},Ae=function(){for(var ee=[],ye=Object.keys(b.value),H=0;H<ye.length;H++)ee.push(b.value[ye[H]]);return ee};b.setOptions=function(ee,ye){ee||(ee={});var H={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var Q in H)ee&&ee.hasOwnProperty(Q)?b.options[Q]=ee[Q]:(typeof b.options[Q]>"u"||ye===!0)&&(b.options[Q]=H[Q]);return(b.options.remoteSearch==!0||b.options.type==="searchbar")&&(b.options.autocomplete=!0),b.options.newOptions==!0?b.header.classList.add("jdropdown-add"):b.header.classList.remove("jdropdown-add"),b.options.autocomplete==!0?b.header.removeAttribute("readonly"):b.header.setAttribute("readonly","readonly"),b.options.placeholder?b.header.setAttribute("placeholder",b.options.placeholder):b.header.removeAttribute("placeholder"),X.classList.remove("jdropdown-searchbar"),X.classList.remove("jdropdown-picker"),X.classList.remove("jdropdown-list"),b.options.type=="searchbar"?X.classList.add("jdropdown-searchbar"):b.options.type=="list"?X.classList.add("jdropdown-list"):b.options.type=="picker"?X.classList.add("jdropdown-picker"):m.getWindowWidth()<800?b.options.autocomplete?(X.classList.add("jdropdown-searchbar"),b.options.type="searchbar"):(X.classList.add("jdropdown-picker"),b.options.type="picker"):(b.options.width?(X.style.width=b.options.width,X.style.minWidth=b.options.width):(X.style.removeProperty("width"),X.style.removeProperty("min-width")),X.classList.add("jdropdown-default"),b.options.type="default"),b.options.type=="searchbar"?je.appendChild(pt):ke.insertBefore(pt,ke.firstChild),b.options.url&&!ee.data?R({url:b.options.url,method:"GET",dataType:"json",success:function(pe){pe&&ce(pe,b.options.value)}}):ce(b.options.data,b.options.value),b};var je=null,ke=null,et=null,pt=null,A=null,K=null,L=null,j=function(){if(F||(F={}),X.tagName=="SELECT"){var ee=q.extractFromDom(X,F);X=ee.el,F=ee.options}!F.placeholder&&X.getAttribute("placeholder")&&(F.placeholder=X.getAttribute("placeholder")),b.value={},b.items=[],b.groups=[],b.search="",b.results=null,X.classList.add("jdropdown"),je=document.createElement("div"),je.className="jdropdown-container-header",b.header=document.createElement("input"),b.header.className="jdropdown-header jss_object",b.header.type="text",b.header.setAttribute("autocomplete","off"),b.header.onfocus=function(){typeof b.options.onfocus=="function"&&b.options.onfocus(X)},b.header.onblur=function(){typeof b.options.onblur=="function"&&b.options.onblur(X)},b.header.onkeyup=function(ye){b.options.autocomplete==!0&&!L?(b.search!=b.header.value.trim()&&(L=setTimeout(function(){b.find(b.header.value.trim()),L=null},400)),X.classList.contains("jdropdown-focus")||b.open()):b.options.autocomplete||b.next(ye.key)},q.hasEvents||(q.hasEvents=!0,document.addEventListener("keydown",q.keydown)),ke=document.createElement("div"),ke.className="jdropdown-container",et=document.createElement("div"),et.className="jdropdown-content",pt=document.createElement("div"),pt.className="jdropdown-close",pt.textContent="Done",A=document.createElement("div"),A.className="jdropdown-reset",A.textContent="x",A.onclick=function(){b.reset(),b.close()},K=document.createElement("div"),K.className="jdropdown-backdrop",je.appendChild(b.header),ke.appendChild(et),X.appendChild(je),X.appendChild(ke),X.appendChild(K),b.setOptions(F),"ontouchsend"in document.documentElement?X.addEventListener("touchsend",q.mouseup):X.addEventListener("mouseup",q.mouseup),b.options.lazyLoading==!0&&_(et,{loadUp:b.loadUp,loadDown:b.loadDown}),et.onwheel=function(ye){ye.stopPropagation()},X.change=b.setValue,X.val=function(ye){if(ye===void 0)return b.getValue(!!b.options.multiple);b.setValue(ye)},X.dropdown=b};b.getUrl=function(){return b.options.url},b.setUrl=function(ee,ye){b.options.url=ee,R({url:b.options.url,method:"GET",dataType:"json",success:function(H){b.setData(H),typeof ye=="function"&&ye(b)}})},b.setId=function(ee,ye){if(b.options.format)var H="id";else var H="value";typeof ee=="object"?ee[H]=ye:b.items[ee].data[H]=ye};const Y=function(ee,ye){if(!ee){let pe=b.options.autocomplete==!0?b.header.value:"";if(ee=prompt(c.translate("Add A New Option"),pe),!ee)return!1}if(ye||(ye=m.guid()),b.options.format)var H={id:ye,name:ee};else var H={value:ye,text:ee};if(typeof b.options.onbeforeinsert=="function"){let pe=b.options.onbeforeinsert(b,H);if(pe===!1)return!1;pe&&(H=pe)}b.options.data.push(H);var Q=b.createItem(H);return et.appendChild(Q.element),typeof b.options.oninsert=="function"&&b.options.oninsert(b,H,Q),et.style.display=="none"&&(et.style.display=""),b.results&&b.results.push(Q),H};b.add=function(ee,ye){return typeof b.options.prompt=="function"?b.options.prompt.call(b,Y):Y(ee,ye)},b.createItem=function(ee,ye,H){b.options.format?(!ee.id&&ee.value!==void 0&&(ee.id=ee.value),!ee.name&&ee.text!==void 0&&(ee.name=ee.text)):(!ee.value&&ee.id!==void 0&&(ee.value=ee.id),!ee.text&&ee.name!==void 0&&(ee.text=ee.name));var Q={};if(Q.element=document.createElement("div"),Q.element.className="jdropdown-item",Q.element.indexValue=b.items.length,Q.data=ee,ye&&(Q.group=ye),ee.id&&Q.element.setAttribute("id",ee.id),ee.disabled==!0&&Q.element.setAttribute("data-disabled",!0),ee.tooltip&&Q.element.setAttribute("title",ee.tooltip),ee.image){var pe=document.createElement("img");pe.className="jdropdown-image",pe.src=ee.image,ee.title||pe.classList.add("jdropdown-image-small"),Q.element.appendChild(pe)}else if(ee.icon){var Re=document.createElement("span");Re.className="jdropdown-icon material-icons",Re.innerText=ee.icon,ee.title||Re.classList.add("jdropdown-icon-small"),ee.color&&(Re.style.color=ee.color),Q.element.appendChild(Re)}else if(ee.color){var Ce=document.createElement("div");Ce.className="jdropdown-color",Ce.style.backgroundColor=ee.color,Q.element.appendChild(Ce)}if(b.options.format)var We=ee.name;else var We=ee.text;var ot=document.createElement("div");if(ot.className="jdropdown-description",ot.textContent=We||"&nbsp;",ee.title){var mt=document.createElement("div");mt.className="jdropdown-title",mt.innerText=ee.title,ot.appendChild(mt)}if(b.options.format)var Ye=ee.id;else var Ye=ee.value;return b.value[Ye]&&(Q.element.classList.add("jdropdown-selected"),Q.selected=!0),b.items.push(Q),Q.element.appendChild(ot),Q},b.appendData=function(ee){if(ee.length){for(var ye=[],H=[],Q=0;Q<ee.length;Q++)ee[Q].group?(H[ee[Q].group]||(H[ee[Q].group]=[]),H[ee[Q].group].push(Q)):ye.push(Q);var pe=0,Re=Object.keys(H);if(Re.length>0)for(var Q=0;Q<Re.length;Q++){var Ce=document.createElement("div");Ce.className="jdropdown-group";var We=document.createElement("div");We.className="jdropdown-group-name",We.textContent=Re[Q];var ot=document.createElement("i");ot.className="jdropdown-group-arrow jdropdown-group-arrow-down",We.appendChild(ot);var mt=document.createElement("div");mt.className="jdropdown-group-items";for(var Ye=0;Ye<H[Re[Q]].length;Ye++){var Et=b.createItem(ee[H[Re[Q]][Ye]],Ce,Re[Q]);(b.options.lazyLoading==!1||pe<200)&&(mt.appendChild(Et.element),pe++)}Ce.appendChild(We),Ce.appendChild(mt),b.groups.push(Ce),mt.children.length>0&&et.appendChild(Ce)}if(ye.length)for(var Q=0;Q<ye.length;Q++){var Et=b.createItem(ee[ye[Q]]);(b.options.lazyLoading==!1||pe<200)&&(et.appendChild(Et.element),pe++)}}},b.setData=function(ee){if(Le(),et.textContent="",b.header.value="",b.items=[],ee&&ee.length){for(var ye=0;ye<ee.length;ye++)typeof ee[ye]!="object"&&(b.options.format?ee[ye]={id:ee[ye],name:ee[ye]}:ee[ye]={value:ee[ye],text:ee[ye]});b.appendData(ee),b.options.data=ee}else b.options.data=[];b.close()},b.getData=function(){return b.options.data},b.getPosition=function(ee){for(var ye=0;ye<b.items.length;ye++)if(re(ye)==ee)return ye;return!1},b.getText=function(ee){var ye=Ae();return ee?ye:ye.join("; ")},b.getValue=function(ee){var ye=he();return ee?ye:ye.join(";")};var oe=function(ee){X.value!=b.options.value&&(X.value=b.options.value,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value})),typeof b.options.onchange=="function"&&b.options.onchange(X,b,ee,b.options.value)};b.setValue=function(ee){var ye=b.getValue();Array.isArray(ee)&&(ee=ee.join(";")),ye!==ee&&(ae(ee),oe(ye))},b.resetSelected=function(){b.setValue(null)},b.selectIndex=function(H,ye){var H=parseInt(H);if(b.items&&b.items[H]&&(ye===!0||b.items[H].data.disabled!==!0))if(b.setCursor(H,!1),!b.options.multiple)b.items[H].selected?b.options.allowEmpty!==!1&&b.setValue(null):b.setValue(re(H)),b.close();else{var Q=b.options.value;b.items[H].selected?(b.items[H].element.classList.remove("jdropdown-selected"),b.items[H].selected=!1,delete b.value[re(H)]):(b.items[H].element.classList.add("jdropdown-selected"),b.items[H].selected=!0,b.value[re(H)]=me(H)),b.options.value=Object.keys(b.value).join(";"),b.options.autocomplete==!1&&(b.header.value=Ae().join("; ")),oe(Q)}},b.selectItem=function(ee){b.selectIndex(ee.indexValue)};var Te=function(ee,ye){for(var H=0;H<ye.length;H++)if(b.options.format){if(ye[H].id==ee)return!0}else if(ye[H].value==ee)return!0;return!1};return b.find=function(ee){if(b.search==ee.trim())return!1;if(b.search=ee,b.setCursor(),b.groups.length)for(var ye=0;ye<b.groups.length;ye++)b.groups[ye].lastChild.textContent="";if(et.textContent="",b.options.remoteSearch==!0){b.results=null;var H=b.options.url;let mt={url:H,method:"GET",data:{q:ee},dataType:"json",success:function(Ye){b.items=[];var Et=Object.keys(b.value);if(Et.length)for(var vt=0;vt<Et.length;vt++)Te(Et[vt],Ye)||(b.options.format?Ye.unshift({id:Et[vt],name:b.value[Et[vt]]}):Ye.unshift({value:Et[vt],text:b.value[Et[vt]]}));b.appendData(Ye),Ye.length?et.style.display="":et.style.display="none",typeof b.options.onsearch=="function"&&b.options.onsearch(b,Ye)}};if(typeof b.options.onbeforesearch=="function"){let Ye=b.options.onbeforesearch(b,mt);if(Ye===!1)return;typeof Ye=="object"&&(mt=Ye)}R(mt)}else{ee=new RegExp(ee,"gi");for(var Q=[],ye=0;ye<b.items.length;ye++){var pe=me(ye),Re=b.items[ye].data.title||"",Ce=b.items[ye].data.group||"",We=b.items[ye].data.synonym||"";We&&(We=We.join(" ")),(ee==null||b.items[ye].selected==!0||pe.toString().match(ee)||Re.match(ee)||Ce.match(ee)||We.match(ee))&&Q.push(b.items[ye])}if(!Q.length)et.style.display="none",b.results=null;else{et.style.display="",b.results=Q;var ot=Q.length||0;b.options.lazyLoading==!0&&ot>200&&(ot=200);for(var ye=0;ye<ot;ye++)b.results[ye].group?(b.results[ye].group.parentNode||et.appendChild(b.results[ye].group),b.results[ye].group.lastChild.appendChild(b.results[ye].element)):et.appendChild(b.results[ye].element)}}b.options.autofocus==!0&&b.first()},b.open=function(){if(!X.classList.contains("jdropdown-focus")){q.current=b,f(b,!0),X.classList.add("jdropdown-focus"),m.getWindowWidth()<800&&(b.options.type==null||b.options.type=="picker")&&N.slideBottom(ke,1),b.options.autocomplete==!0&&(b.header.value=b.search,b.header.focus());var ee=he();if(ee[0]){var ye=b.getPosition(ee[0]);ye!==!1&&b.setCursor(ye)}if(!b.options.type||b.options.type=="default"){var H=X.getBoundingClientRect(),Q=ke.getBoundingClientRect();b.options.position?(ke.style.position="fixed",window.innerHeight<H.bottom+Q.height?(ke.style.top="",ke.style.bottom=window.innerHeight-H.top+1+"px"):(ke.style.top=H.bottom+"px",ke.style.bottom=""),ke.style.left=H.left+"px"):window.innerHeight<H.bottom+Q.height?(ke.style.top="",ke.style.bottom=H.height+1+"px"):(ke.style.top="",ke.style.bottom=""),ke.style.minWidth=H.width+"px",b.options.maxWidth&&(ke.style.maxWidth=b.options.maxWidth),!b.items.length&&b.options.autocomplete==!0?et.style.display="none":et.style.display=""}}typeof b.options.onopen=="function"&&b.options.onopen(X)},b.close=function(ee){return X.classList.contains("jdropdown-focus")&&(b.header.value=b.getText(),b.setCursor(),!ee&&typeof b.options.onclose=="function"&&b.options.onclose(X),b.header.blur&&b.header.blur(),X.classList.remove("jdropdown-focus"),f(b,!1),q.current=null),b.getValue()},b.setCursor=function(ee,ye){if(b.currentIndex!=null&&b.items&&b.items[b.currentIndex]&&b.items[b.currentIndex].element.classList.remove("jdropdown-cursor"),ee==null)b.currentIndex=null;else if(ee=parseInt(ee),b.items[ee].element.parentNode&&(b.items[ee].element.classList.add("jdropdown-cursor"),b.currentIndex=ee,ye!==!1&&b.items[b.currentIndex].element)){et.scrollTop;var H=b.items[b.currentIndex].element;et.scrollTop=H.offsetTop-H.scrollTop+H.clientTop-95}},b.resetCursor=b.setCursor,b.updateCursor=b.setCursor,b.reset=function(){b.setCursor(),b.setValue(null)},b.first=function(){b.options.lazyLoading===!0&&b.loadFirst();var ee=et.querySelectorAll(".jdropdown-item");if(ee.length){var ye=ee[0].indexValue;b.setCursor(ye)}},b.last=function(){b.options.lazyLoading===!0&&b.loadLast();var ee=et.querySelectorAll(".jdropdown-item");if(ee.length){var ye=ee[ee.length-1].indexValue;b.setCursor(ye)}},b.next=function(ee){var ye=null;if(ee){if(ee.length==1){var H=b.currentIndex||-1;ee=ee.toLowerCase();var Q=null,pe=null,Re=et.querySelectorAll(".jdropdown-item");if(Re.length){for(var Ce=0;Ce<Re.length;Ce++)if(Re[Ce].indexValue>H&&(Q=b.items[Re[Ce].indexValue])&&(pe=Q.element.innerText[0])&&(pe=pe.toLowerCase(),ee==pe)){ye=Re[Ce].indexValue;break}b.setCursor(ye)}}}else if(b.currentIndex==null||b.currentIndex==null)b.first();else{var We=b.items[b.currentIndex].element,ot=We.nextElementSibling;ot?(ot.classList.contains("jdropdown-group")&&(ot=ot.lastChild.firstChild),ye=ot.indexValue):We.parentNode.classList.contains("jdropdown-group-items")&&((ot=We.parentNode.parentNode.nextElementSibling)&&(ot.classList.contains("jdropdown-group")?ot=ot.lastChild.firstChild:ot.classList.contains("jdropdown-item")?ye=ot.indexValue:ot=null),ot&&(ye=ot.indexValue)),ye!==null&&b.setCursor(ye)}},b.prev=function(){var ee=null;if(b.currentIndex===null)b.first();else{var ye=b.items[b.currentIndex].element,H=ye.previousElementSibling;H?(H.classList.contains("jdropdown-group")&&(H=H.lastChild.lastChild),ee=H.indexValue):ye.parentNode.classList.contains("jdropdown-group-items")&&((H=ye.parentNode.parentNode.previousElementSibling)&&(H.classList.contains("jdropdown-group")?H=H.lastChild.lastChild:H.classList.contains("jdropdown-item")?ee=H.indexValue:H=null),H&&(ee=H.indexValue))}ee!==null&&b.setCursor(ee)},b.loadFirst=function(){if(b.results)var ee=b.results;else var ee=b.items;var ye=ee.length||0;b.options.lazyLoading==!0&&ye>200&&(ye=200),et.textContent="";for(var H=0;H<ye;H++)ee[H].group?(ee[H].group.parentNode||et.appendChild(ee[H].group),ee[H].group.lastChild.appendChild(ee[H].element)):et.appendChild(ee[H].element);et.scrollTop=0},b.loadLast=function(){if(b.results)var ee=b.results;else var ee=b.items;var ye=ee.length;if(ye>200){ye=ye-200,et.textContent="";for(var H=ye;H<ee.length;H++)ee[H].group?(ee[H].group.parentNode||et.appendChild(ee[H].group),ee[H].group.lastChild.appendChild(ee[H].element)):et.appendChild(ee[H].element);et.scrollTop=et.scrollHeight}},b.loadUp=function(){var ee=!1;if(b.results)var ye=b.results;else var ye=b.items;var H=et.querySelectorAll(".jdropdown-item"),Q=H[0].indexValue;Q=b.items[Q];var pe=ye.indexOf(Q)-1;if(pe>0){for(var Re=0;pe>0&&ye[pe]&&Re<200;)ye[pe].group?(ye[pe].group.parentNode||et.insertBefore(ye[pe].group,et.firstChild),ye[pe].group.lastChild.insertBefore(ye[pe].element,ye[pe].group.lastChild.firstChild)):et.insertBefore(ye[pe].element,et.firstChild),pe--,Re++;ee=!0}return ee},b.loadDown=function(){var ee=!1;if(b.results)var ye=b.results;else var ye=b.items;var H=et.querySelectorAll(".jdropdown-item"),Q=H[H.length-1].indexValue;Q=b.items[Q];var pe=ye.indexOf(Q)+1;if(pe<ye.length){for(var Re=0;pe<ye.length&&ye[pe]&&Re<200;)ye[pe].group?(ye[pe].group.parentNode||et.appendChild(ye[pe].group),ye[pe].group.lastChild.appendChild(ye[pe].element)):et.appendChild(ye[pe].element),pe++,Re++;ee=!0}return ee},j(),b};return q.keydown=function(X){var F=null;if(F=q.current){if(X.which==13||X.which==9)F.header.value&&F.currentIndex==null&&F.options.newOptions?F.add():(F.currentIndex==null&&F.options.autocomplete==!0&&F.header.value!=""&&F.find(F.header.value),F.selectIndex(F.currentIndex));else if(X.which==38)F.currentIndex==null?F.first():F.currentIndex>0&&F.prev(),X.preventDefault();else if(X.which==40)F.currentIndex==null?F.first():F.currentIndex+1<F.items.length&&F.next(),X.preventDefault();else if(X.which==36)F.first(),X.target.classList.contains("jdropdown-header")||X.preventDefault();else if(X.which==35)F.last(),X.target.classList.contains("jdropdown-header")||X.preventDefault();else if(X.which==27)F.close();else if(X.which==33){if(F.currentIndex==null)F.first();else if(F.currentIndex>0)for(var b=0;b<7;b++)F.prev();X.preventDefault()}else if(X.which==34){if(F.currentIndex==null)F.first();else if(F.currentIndex+1<F.items.length)for(var b=0;b<7;b++)F.next();X.preventDefault()}}},q.mouseup=function(X){var F=m.findElement(X.target,"jdropdown");if(F){var b=F.dropdown;if(X.target.classList.contains("jdropdown-header"))if(F.classList.contains("jdropdown-focus")&&F.classList.contains("jdropdown-default")){var ce=F.getBoundingClientRect();if(X.changedTouches&&X.changedTouches[0]){var Fe=X.changedTouches[0].clientX;X.changedTouches[0].clientY}else{var Fe=X.clientX;X.clientY}ce.width-(Fe-ce.left)<30?X.target.classList.contains("jdropdown-add")?b.add():b.close():b.options.autocomplete==!1&&b.close()}else b.open();else if(X.target.classList.contains("jdropdown-group-name")){var Le=X.target.nextSibling.children;if(X.target.nextSibling.style.display!="none")for(var ae=0;ae<Le.length;ae++)Le[ae].style.display!="none"&&b.selectItem(Le[ae])}else X.target.classList.contains("jdropdown-group-arrow")?X.target.classList.contains("jdropdown-group-arrow-down")?(X.target.classList.remove("jdropdown-group-arrow-down"),X.target.classList.add("jdropdown-group-arrow-up"),X.target.parentNode.nextSibling.style.display="none"):(X.target.classList.remove("jdropdown-group-arrow-up"),X.target.classList.add("jdropdown-group-arrow-down"),X.target.parentNode.nextSibling.style.display=""):X.target.classList.contains("jdropdown-item")?b.selectItem(X.target):X.target.classList.contains("jdropdown-image")||X.target.classList.contains("jdropdown-description")?b.selectItem(X.target.parentNode):X.target.classList.contains("jdropdown-title")?b.selectItem(X.target.parentNode.parentNode):(X.target.classList.contains("jdropdown-close")||X.target.classList.contains("jdropdown-backdrop"))&&b.close()}},q.extractFromDom=function(X,F){var b=X;if(F||(F={}),X.getAttribute("multiple")&&(!F||F.multiple==null)&&(F.multiple=!0),X.getAttribute("placeholder")&&(!F||F.placeholder==null)&&(F.placeholder=X.getAttribute("placeholder")),X.getAttribute("data-autocomplete")&&(!F||F.autocomplete==null)&&(F.autocomplete=!0),(!F||F.width==null)&&(F.width=X.offsetWidth),X.value&&(!F||F.value==null)&&(F.value=X.value),!F||F.data==null){F.data=[];for(var ce=0;ce<X.children.length;ce++)if(X.children[ce].tagName=="OPTGROUP")for(var Fe=0;Fe<X.children[ce].children.length;Fe++)F.data.push({value:X.children[ce].children[Fe].value,text:X.children[ce].children[Fe].textContent,group:X.children[ce].getAttribute("label")});else F.data.push({value:X.children[ce].value,text:X.children[ce].textContent})}(!F||F.onchange==null)&&(F.onchange=function(ae,re,me,he){F.multiple==!0?obj.items[re].classList.contains("jdropdown-selected")?b.options[re].setAttribute("selected","selected"):b.options[re].removeAttribute("selected"):b.value=he});var Le=document.createElement("div");return X.parentNode.insertBefore(Le,X),X.style.display="none",X=Le,{el:X,options:F}},q}var Oe=_e();function st(q,X){if(q.picker)return q.picker.setOptions(X,!0);var F={type:"picker"};F.options={};var b=null,ce=null,Fe=function(re){return re instanceof Element||re instanceof HTMLDocument},Le=function(){ce.innerHTML="";for(var re=Object.keys(F.options.data),me=0;me<re.length;me++){var he=document.createElement("div");he.classList.add("jpicker-item"),he.k=re[me],he.v=F.options.data[re[me]];var Ae=F.getLabel(re[me],he);Fe(Ae)?he.appendChild(Ae):he.innerHTML=Ae,ce.appendChild(he)}};F.setOptions=function(re,me){var he={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};re&&re.options&&(re.data=re.options);for(var Ae in he)re&&re.hasOwnProperty(Ae)?F.options[Ae]=re[Ae]:(typeof F.options[Ae]>"u"||me===!0)&&(F.options[Ae]=he[Ae]);return F.options.header===!1?b.style.display="none":b.style.display="",F.options.width?b.style.width=parseInt(F.options.width)+"px":b.style.width="",F.options.height?(ce.style.maxHeight=F.options.height+"px",ce.style.overflow="scroll"):ce.style.overflow="",F.options.columns>0&&(F.options.grid?(ce.classList.add("jpicker-grid"),ce.style.gridTemplateColumns="repeat("+F.options.grid+", 1fr)"):(ce.classList.add("jpicker-columns"),ce.style.width=F.options.width?F.options.width:36*F.options.columns+"px")),isNaN(parseInt(F.options.value))&&(F.options.value=0),Le(),F.setValue(F.options.value),F},F.getValue=function(){return F.options.value},F.setValue=function(re,me){if(F.setLabel(re),F.options.value=String(re),q.value!=F.options.value&&(q.value=F.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value})),ce.children[re]&&ce.children[re].getAttribute("type")!=="generic"&&F.close(),me&&typeof F.options.onchange=="function"){var he=F.options.data[re];F.options.onchange(q,F,he,he,re,me)}},F.getLabel=function(re,me){var he=F.options.data[re]||null;return typeof F.options.render=="function"&&(he=F.options.render(he,me)),he},F.setLabel=function(re){var me;F.options.content?me='<i class="material-icons">'+F.options.content+"</i>":me=F.getLabel(re,null),Fe(me)?(b.innerHTML="",b.appendChild(me)):b.innerHTML=me},F.open=function(){if(!q.classList.contains("jpicker-focus")){f(F,!0),q.classList.add("jpicker-focus"),q.focus();var re=0,me=0;ce.style.marginLeft="";var he=b.getBoundingClientRect(),Ae=ce.getBoundingClientRect();window.innerHeight<he.bottom+Ae.height||F.options.bottom?re=-1*(Ae.height+4):re=he.height+4,F.options.right===!0&&(me=-1*Ae.width+he.width),Ae.left+me<0&&(me=me+Ae.left+10),Ae.left+Ae.width>window.innerWidth&&(me=-1*(10+Ae.left+Ae.width-window.innerWidth)),ce.style.marginTop=parseInt(re)+"px",ce.style.marginLeft=parseInt(me)+"px",typeof F.options.onopen=="function"&&F.options.onopen(q,F)}},F.close=function(){q.classList.contains("jpicker-focus")&&(q.classList.remove("jpicker-focus"),f(F,!1),typeof F.options.onclose=="function"&&F.options.onclose(q,F))};var ae=function(){q.classList.add("jpicker"),q.setAttribute("tabindex","0"),q.onmousedown=function(re){q.classList.contains("jpicker-focus")||F.open()},b=document.createElement("div"),b.classList.add("jpicker-header"),ce=document.createElement("div"),ce.classList.add("jpicker-content"),ce.onclick=function(re){var me=m.findElement(re.target,"jpicker-item");me&&me.parentNode===ce&&F.setValue(me.k,re)},q.appendChild(b),q.appendChild(ce),q.value=X.value||0,F.setOptions(X),typeof F.options.onload=="function"&&F.options.onload(q,F),q.change=F.setValue,q.val=function(re){if(re===void 0)return F.getValue();F.setValue(re)},q.picker=F};return ae(),F}function rt(q,X){var F={type:"toolbar"};F.options={};var b={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var ce in b)X&&X.hasOwnProperty(ce)?F.options[ce]=X[ce]:F.options[ce]=b[ce];!q&&X.app&&X.app.el&&(q=document.createElement("div"),X.app.el.appendChild(q));var Fe=document.createElement("div");Fe.classList.add("jtoolbar-item"),Fe.classList.add("jtoolbar-arrow");var Le=document.createElement("div");Le.classList.add("jtoolbar-floating"),Fe.appendChild(Le),F.selectItem=function(re){for(var me=ae.children,he=0;he<me.length;he++)re!=me[he]&&me[he].classList.remove("jtoolbar-selected");re.classList.add("jtoolbar-selected")},F.hide=function(){N.slideBottom(q,0,function(){q.style.display="none"})},F.show=function(){q.style.display="",N.slideBottom(q,1)},F.get=function(){return q},F.setBadge=function(re,me){ae.children[re].children[1].firstChild.innerHTML=me},F.destroy=function(){toolbar.remove(),q.innerHTML=""},F.update=function(re,me){for(var he=0;he<ae.children.length;he++){var Ae=ae.children[he];typeof Ae.updateState=="function"&&Ae.updateState(q,F,Ae,re,me)}for(var he=0;he<Le.children.length;he++){var Ae=Le.children[he];typeof Ae.updateState=="function"&&Ae.updateState(q,F,Ae,re,me)}},F.create=function(re){ae.innerHTML="";for(var me=0;me<re.length;me++){var he=document.createElement("div");if(he.classList.add("jtoolbar-item"),re[me].width&&(he.style.width=parseInt(re[me].width)+"px"),re[me].k&&(he.k=re[me].k),re[me].tooltip&&he.setAttribute("title",re[me].tooltip),re[me].id&&he.setAttribute("id",re[me].id),re[me].updateState&&(he.updateState=re[me].updateState),re[me].active&&he.classList.add("jtoolbar-active"),re[me].disabled&&he.classList.add("jtoolbar-disabled"),re[me].type=="select"||re[me].type=="dropdown")st(he,re[me]);else if(re[me].type=="divisor")he.classList.add("jtoolbar-divisor");else if(re[me].type=="label")he.classList.add("jtoolbar-label"),he.innerHTML=re[me].content;else{var Ae=document.createElement("i");if(typeof re[me].class>"u")Ae.classList.add("material-icons");else for(var je=re[me].class.split(" "),ke=0;ke<je.length;ke++)Ae.classList.add(je[ke]);if(Ae.innerHTML=re[me].content?re[me].content:"",he.appendChild(Ae),F.options.badge==!0){var et=document.createElement("div");et.classList.add("jbadge");var pt=document.createElement("div");pt.innerHTML=re[me].badge?re[me].badge:"",et.appendChild(pt),he.appendChild(et)}if(re[me].title)if(F.options.title==!0){var A=document.createElement("span");A.innerHTML=re[me].title,he.appendChild(A)}else he.setAttribute("title",re[me].title);F.options.app&&re[me].route&&(he.route=re[me].route,he.onclick=function(){F.options.app.pages(this.route)},F.options.app.pages(re[me].route,{toolbarItem:he,closed:!0})),typeof re[me].render=="function"&&re[me].render(he,re[me])}re[me].onclick&&(he.onclick=re[me].onclick.bind(re[me],q,F,he)),ae.appendChild(he)}setTimeout(function(){F.refresh()},0)},F.open=function(){Fe.classList.add("jtoolbar-arrow-selected"),q.getBoundingClientRect();var re=Le.getBoundingClientRect();re.bottom>window.innerHeight||F.options.bottom?Le.style.bottom="0":Le.style.removeProperty("bottom"),Le.style.right="0",Fe.children[0].focus(),f(F,!0)},F.close=function(){Fe.classList.remove("jtoolbar-arrow-selected"),f(F,!1)},F.refresh=function(){if(F.options.responsive==!0){var re=q.parentNode.getBoundingClientRect();F.options.maxWidth||(F.options.maxWidth=re.width);var me=parseInt(F.options.maxWidth);for(Fe.parentNode&&Fe.parentNode.removeChild(Fe);Le.firstChild;)ae.appendChild(Le.firstChild);if(me<ae.offsetWidth)for(me-=50;ae.lastChild&&me<ae.offsetWidth;)Le.insertBefore(ae.lastChild,Le.firstChild);Le.children.length>0&&ae.appendChild(Fe)}},F.setReadonly=function(re){re=re?"add":"remove",q.classList[re]("jtoolbar-disabled")},q.onclick=function(re){var me=m.findElement(re.target,"jtoolbar-item");me&&F.selectItem(me),re.target.classList.contains("jtoolbar-arrow")&&F.open()},window.addEventListener("resize",function(){F.refresh()}),q.classList.add("jtoolbar"),q.innerHTML="",F.options.container==!0&&q.classList.add("jtoolbar-container");var ae=document.createElement("div");return q.appendChild(ae),F.options.app&&q.classList.add("jtoolbar-mobile"),F.create(F.options.items),q.toolbar=F,F}function U(){var q=function(X,F){var b={type:"editor"};b.options={};var ce={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Fe in ce)F&&F.hasOwnProperty(Fe)?b.options[Fe]=F[Fe]:b.options[Fe]=ce[Fe];var Le=null,ae=null,re=[];b.el=X,typeof b.options.onclick=="function"&&(X.onclick=function(He){b.options.onclick(X,b,He)}),X.classList.add("jeditor-container");var me=document.createElement("div");me.className="jsnippet",me.setAttribute("contenteditable",!1);var he=document.createElement("div");if(he.className="jeditor-toolbar",b.editor=document.createElement("div"),b.editor.setAttribute("contenteditable",!0),b.editor.setAttribute("spellcheck",!1),b.editor.classList.add("jeditor"),b.options.placeholder&&b.editor.setAttribute("data-placeholder",b.options.placeholder),(b.options.maxHeight||b.options.height)&&(b.editor.style.overflowY="auto",b.options.maxHeight&&(b.editor.style.maxHeight=b.options.maxHeight),b.options.height&&(b.editor.style.height=b.options.height)),b.options.url)R({url:b.options.url,dataType:"html",success:function(He){b.editor.innerHTML=He,q.setCursor(b.editor,b.options.focus=="initial")}});else if(b.options.value)b.editor.innerHTML=b.options.value;else for(var Ae=0;Ae<X.children.length;Ae++)b.editor.appendChild(X.children[Ae]);X.innerHTML="";var je=function(He){typeof b.options.onchange=="function"&&b.options.onchange(X,b,He),b.options.value=b.getData(),X.value!=b.options.value&&(X.value=b.options.value,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value}))},ke=function(He){var ft=document.createElement("div");ft.innerHTML=He;var yt=ft.querySelectorAll("img");if(yt.length)for(var It=0;It<yt.length;It++)b.addImage(yt[It].src)},et=function(){var He=null;if(He=me.children[0]){He.classList.contains("jslider-grid")||He.classList.add("jslider-grid");var ft=He.children.length;He.setAttribute("data-number",ft>4?4:ft),ft>4?He.setAttribute("data-total",ft-4):He.removeAttribute("data-total")}},pt=function(He){me.innerHTML||b.appendSnippet({}),me.children[0].appendChild(He),et()};b.appendSnippet=function(He){me.innerHTML="";for(var ft=["image","title","description","host","url"],yt=0;yt<ft.length;yt++){var It=document.createElement("div");if(It.className="jsnippet-"+ft[yt],It.setAttribute("data-k",ft[yt]),me.appendChild(It),He[ft[yt]])if(ft[yt]=="image"){Array.isArray(He.image)||(He.image=[He.image]);for(var gt=0;gt<He.image.length;gt++){var De=document.createElement("img");De.src=He.image[gt],It.appendChild(De)}}else It.innerHTML=He[ft[yt]]}b.editor.appendChild(document.createElement("br")),b.editor.appendChild(me)},b.setData=function(He){typeof He=="object"?b.editor.innerHTML=He.content:b.editor.innerHTML=He,b.options.focus&&q.setCursor(b.editor,!0),re=[]},b.getFiles=function(){for(var He=b.editor.querySelectorAll(".jfile"),ft=[],yt=0;yt<He.length;yt++)re[He[yt].src]&&ft.push(re[He[yt].src]);return ft},b.getText=function(){return b.editor.innerText},b.getData=function(He){if(He){var ft={content:""};if(me.innerHTML){ft.snippet={};for(var yt=0;yt<me.children.length;yt++){var It=me.children[yt].getAttribute("data-k");if(It)if(It=="image"){ft.snippet.image||(ft.snippet.image=[]);for(var gt=0;gt<me.children[yt].children.length;gt++)ft.snippet.image.push(me.children[yt].children[gt].getAttribute("src"))}else ft.snippet[It]=me.children[yt].innerHTML}}var De=Object.keys(re);if(De.length){ft.files=[];for(var yt=0;yt<De.length;yt++)ft.files.push(re[De[yt]])}var ht=document.createElement("div");ht.innerHTML=b.editor.innerHTML;var Rt=ht.querySelector(".jsnippet");Rt&&Rt.remove();var Pt=ht.innerHTML;Pt=Pt.replace(/<br>/g,`
`),Pt=Pt.replace(/<\/div>/g,`</div>
`),Pt=Pt.replace(/<(?:.|\n)*?>/gm,""),ft.content=Pt.trim(),Et("getData",ft)}else var ft=b.editor.innerHTML;return ft},b.reset=function(){b.editor.innerHTML="",me.innerHTML="",re=[]},b.addPdf=function(He){if(He.result.substr(0,4)!="data")console.error("Invalid source");else{var ft=document.createElement("canvas");ft.width=60,ft.height=60;var yt=new Image,It=ft.getContext("2d");It.drawImage(yt,0,0,ft.width,ft.height),ft.toBlob(function(gt){var De=document.createElement("img");De.src=window.URL.createObjectURL(gt),De.title=He.name,De.className="jfile pdf",re[De.src]={file:De.src,extension:"pdf",content:He.result},document.execCommand("insertHtml",!1,De.outerHTML)})}},b.addImage=function(He,ft){if(b.options.acceptImages)if(He||(He=""),He.substr(0,4)!="data"&&!b.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(He.substr(0,4)=="data"){var yt=He.split(";");yt=yt[0].split("/"),yt=yt[1]}else{var yt=He.substr(He.lastIndexOf(".")+1);He=b.options.remoteParser+He}var It=new Image;It.onload=function(){var De=document.createElement("canvas");De.width=It.width,De.height=It.height;var ht=De.getContext("2d");ht.drawImage(It,0,0,De.width,De.height),De.toBlob(function(Rt){var Pt=document.createElement("img");Pt.src=window.URL.createObjectURL(Rt),Pt.classList.add("jfile"),Pt.setAttribute("tabindex","900"),Pt.setAttribute("width",It.width),Pt.setAttribute("height",It.height),re[Pt.src]={file:Pt.src,extension:yt,content:De.toDataURL()},b.options.dropAsSnippet||ft?(pt(Pt),re[Pt.src].snippet=!0):document.execCommand("insertHtml",!1,Pt.outerHTML),je()})},It.src=He}},b.addFile=function(He){for(var ft=[],yt=0;yt<He.length;yt++)if(He[yt].size>b.options.maxFileSize)alert("The file is too big");else{var It=He[yt].type.split("/");It[0]=="image"?It=1:It[1]=="pdf"?It=2:It=0,It?(ft[yt]=new FileReader,ft[yt].index=yt,ft[yt].type=It,ft[yt].name=He[yt].name,ft[yt].date=He[yt].lastModified,ft[yt].size=He[yt].size,ft[yt].addEventListener("load",function(gt){gt.target.type==2?b.options.acceptFiles==!0&&b.addPdf(gt.target):b.addImage(gt.target.result)},!1),ft[yt].readAsDataURL(He[yt])):alert("The extension is not allowed")}},b.destroy=function(){b.editor.removeEventListener("mouseup",ot),b.editor.removeEventListener("mousedown",mt),b.editor.removeEventListener("mousemove",Ye),b.editor.removeEventListener("keyup",Ce),b.editor.removeEventListener("keydown",We),b.editor.removeEventListener("dragstart",ee),b.editor.removeEventListener("dragenter",ye),b.editor.removeEventListener("dragover",H),b.editor.removeEventListener("drop",Q),b.editor.removeEventListener("paste",Te),b.editor.removeEventListener("blur",pe),b.editor.removeEventListener("focus",Re),X.editor=null,X.classList.remove("jeditor-container"),he.remove(),me.remove(),b.editor.remove()},b.upload=function(){m.click(b.file)};const A=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],K=["width","height","align","border","src","tabindex"],L=["color","font-weight","font-size","background","background-color","margin"],j=function(He){if(He.tagName&&A.indexOf(He.tagName.toLowerCase())===-1&&He.innerText&&(He.innerHTML=He.innerText),He.attributes&&He.attributes.length){let ft=null,yt=He.getAttribute("style");if(yt){ft=[];let gt=yt.split(";");for(let De=0;De<gt.length;De++){let ht=gt[De].trim().split(":");if(L.indexOf(ht[0].trim())>=0){let Rt=ht.shift();ht=ht.join(":"),ft.push(Rt+":"+ht)}}}He.tagName.toUpperCase()==="IMG"&&(!b.options.acceptImages||!He.src?He.parentNode.removeChild(He):(He.setAttribute("tabindex","900"),b.addImage(He.src)));let It=[];for(let gt=0;gt<He.attributes.length;gt++)It.push(He.attributes[gt].name);It.length&&It.forEach(function(gt){K.indexOf(gt)===-1?He.removeAttribute(gt):He.attributes&&He.attributes[Ae]&&He.attributes[Ae].value.indexOf("<")!==-1&&He.attributes[Ae].value.replace("<","&#60;")}),He.style="",ft&&ft.length&&He.setAttribute("style",ft.join(";"))}if(He.children.length)for(let ft=He.children.length;ft>0;ft--)j(He.children[ft-1])};var Y=function(He){var ft=window.getSelection(),yt=document.createRange();yt.selectNode(He),ft.addRange(yt)},oe=function(He){He&&(He=He.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ft=new DOMParser,yt=ft.parseFromString(He,"text/html");j(yt);var It=document.createElement("div");return It.innerHTML=yt.firstChild.innerHTML,It},Te=function(He){if(b.options.filterPaste==!0){if(He.clipboardData||He.originalEvent.clipboardData)var ft=(He.originalEvent||He).clipboardData.getData("text/html"),yt=(He.originalEvent||He).clipboardData.getData("text/plain"),It=(He.originalEvent||He).clipboardData.files;else if(window.clipboardData)var ft=window.clipboardData.getData("Html"),yt=window.clipboardData.getData("Text"),It=window.clipboardData.files;if(It.length)b.addFile(It);else if(!ft)ft=yt.split(`\r
`),He.target.innerText?(ft=ft.map(function(De){return"<div>"+De+"</div>"}),document.execCommand("insertText",!1,ft.join(""))):ft.map(function(De){var ht=document.createElement("div");ht.innerText=De,b.editor.appendChild(ht)});else{var gt=oe(ft);document.execCommand("insertHtml",!1,gt.innerHTML)}He.preventDefault()}},ee=function(He){ae&&ae.e&&He.preventDefault()},ye=function(He){ae||b.options.dropZone==!1||(X.classList.add("jeditor-dragging"),He.preventDefault())},H=function(He){ae||b.options.dropZone==!1||(Le&&clearTimeout(Le),Le=setTimeout(function(){X.classList.remove("jeditor-dragging")},100),He.preventDefault())},Q=function(He){if(!(ae||b.options.dropZone==!1)){var ft=null;document.caretRangeFromPoint?ft=document.caretRangeFromPoint(He.clientX,He.clientY):He.rangeParent&&(ft=document.createRange(),ft.setStart(He.rangeParent,He.rangeOffset));var yt=window.getSelection();yt.removeAllRanges(),yt.addRange(ft),yt.anchorNode.parentNode.focus();var It=(He.originalEvent||He).dataTransfer.getData("text/html"),gt=(He.originalEvent||He).dataTransfer.getData("text/plain"),De=(He.originalEvent||He).dataTransfer.files;De.length?b.addFile(De):gt&&ke(It),X.classList.remove("jeditor-dragging"),He.preventDefault()}},pe=function(He){Et("onevent",He),je(He),typeof b.options.onblur=="function"&&b.options.onblur(X,b,He)},Re=function(He){typeof b.options.onfocus=="function"&&b.options.onfocus(X,b,He)},Ce=function(He){b.editor.innerHTML||(b.editor.innerHTML="<div><br></div>"),typeof b.options.onkeyup=="function"&&b.options.onkeyup(X,b,He)},We=function(He){if(Et("onevent",He),He.key=="Delete"&&He.target.tagName=="IMG"){var ft=He.target.parentNode;Y(He.target),ft.classList.contains("jsnippet-image")&&et()}typeof b.options.onkeydown=="function"&&b.options.onkeydown(X,b,He)},ot=function(He){if(ae&&ae.e&&(ae.e.classList.remove("resizing"),ae.e.changed==!0)){var ft=ae.e.cloneNode();ft.width=parseInt(ae.e.style.width)||ae.e.getAttribute("width"),ft.height=parseInt(ae.e.style.height)||ae.e.getAttribute("height"),ae.e.style.width="",ae.e.style.height="",Y(ae.e),document.execCommand("insertHtml",!1,ft.outerHTML)}ae=!1},mt=function(He){var ft=function(De){var ht=De.getBoundingClientRect();ht.width-(He.clientX-ht.left)<40&&He.clientY-ht.top<40&&(De.innerHTML="",De.remove())};if(He.target.tagName=="IMG")if(He.target.style.cursor){var yt=He.target.getBoundingClientRect();ae={e:He.target,x:He.clientX,y:He.clientY,w:yt.width,h:yt.height,d:He.target.style.cursor},He.target.getAttribute("width")||He.target.setAttribute("width",yt.width),He.target.getAttribute("height")||He.target.setAttribute("height",yt.height);var It=window.getSelection();if(It.rangeCount)for(var gt=0;gt<It.rangeCount;gt++)It.removeRange(It.getRangeAt(gt));He.target.classList.add("resizing")}else ae=!0;else He.target.classList.contains("jsnippet")?ft(He.target):He.target.parentNode.classList.contains("jsnippet")&&ft(He.target.parentNode),ae=!0},Ye=function(He){if(He.target.tagName=="IMG"&&!He.target.parentNode.classList.contains("jsnippet-image")&&b.options.allowImageResize==!0&&He.target.getAttribute("tabindex")){var ft=He.target.getBoundingClientRect();He.clientY-ft.top<5?ft.width-(He.clientX-ft.left)<5?He.target.style.cursor="ne-resize":He.clientX-ft.left<5?He.target.style.cursor="nw-resize":He.target.style.cursor="n-resize":ft.height-(He.clientY-ft.top)<5?ft.width-(He.clientX-ft.left)<5?He.target.style.cursor="se-resize":He.clientX-ft.left<5?He.target.style.cursor="sw-resize":He.target.style.cursor="s-resize":ft.width-(He.clientX-ft.left)<5?He.target.style.cursor="e-resize":He.clientX-ft.left<5?He.target.style.cursor="w-resize":He.target.style.cursor=""}if(He.which==1&&ae&&ae.d){if(ae.d=="e-resize"||ae.d=="ne-resize"||ae.d=="se-resize")if(ae.e.style.width=ae.w+(He.clientX-ae.x),He.shiftKey){var yt=(He.clientX-ae.x)*(ae.h/ae.w);ae.e.style.height=ae.h+yt}else var yt=null;yt||(ae.d=="s-resize"||ae.d=="se-resize"||ae.d=="sw-resize")&&(He.shiftKey||(ae.e.style.height=ae.h+(He.clientY-ae.y))),ae.e.changed=!0}},Et=function(He,ft){if(b.options.extensions){var yt=Object.keys(b.options.extensions);if(yt.length)for(var It=0;It<yt.length;It++)b.options.extensions[yt[It]]&&typeof b.options.extensions[yt[It]][He]=="function"&&b.options.extensions[yt[It]][He].call(b,ft)}},vt=function(){if(b.options.extensions){var He=Object.keys(b.options.extensions);if(He.length)for(var ft=0;ft<He.length;ft++)b.options.extensions[He[ft]]&&typeof b.options.extensions[He[ft]]=="function"&&(b.options.extensions[He[ft]]=b.options.extensions[He[ft]](X,b))}};if(document.addEventListener("mouseup",ot),document.addEventListener("mousemove",Ye),b.editor.addEventListener("mousedown",mt),b.editor.addEventListener("keyup",Ce),b.editor.addEventListener("keydown",We),b.editor.addEventListener("dragstart",ee),b.editor.addEventListener("dragenter",ye),b.editor.addEventListener("dragover",H),b.editor.addEventListener("drop",Q),b.editor.addEventListener("paste",Te),b.editor.addEventListener("focus",Re),b.editor.addEventListener("blur",pe),X.appendChild(b.editor),b.options.snippet&&b.appendSnippet(b.options.snippet),b.options.toolbar){if(Array.isArray(b.options.toolbar))var xt={container:!0,responsive:!0,items:b.options.toolbar};else if(b.options.toolbar===!0)var xt={container:!0,responsive:!0,items:[]};else var xt=b.options.toolbar;xt.items&&xt.items.length||(xt.items=q.getDefaultToolbar(b)),b.options.toolbarOnTop?(X.classList.add("toolbar-on-top"),X.insertBefore(he,X.firstChild)):(b.editor.style.padding="15px",X.appendChild(he)),rt(he,xt),he.addEventListener("click",function(){b.editor.focus()})}return b.file=document.createElement("input"),b.file.style.display="none",b.file.type="file",b.file.setAttribute("accept","image/*"),b.file.onchange=function(){b.addFile(this.files)},X.appendChild(b.file),b.options.focus&&q.setCursor(b.editor,b.options.focus=="initial"),X.change=b.setData,X.val=function(He){if(He===void 0){var ft=X.getAttribute("data-html")!=="true";return b.getData(ft)}else b.setData(He)},vt(),X.editor=b,typeof b.options.onload=="function"&&b.options.onload(X,b,b.editor),b};return q.setCursor=function(X,F){X.focus(),document.execCommand("selectAll");var b=window.getSelection(),ce=b.getRangeAt(0);if(F==!0)var Fe=ce.startContainer,Le=0;else var Fe=ce.endContainer,Le=Fe.length;ce.setStart(Fe,Le),ce.setEnd(Fe,Le),b.removeAllRanges(),b.addRange(ce)},q.getDefaultToolbar=function(X){var F=function(ce,Fe,Le){Le.color||(Se(Le,{onchange:function(ae,re){Le.k==="color"?document.execCommand("foreColor",!1,re):document.execCommand("backColor",!1,re)}}),Le.color.open())},b=[];return b.push({content:"undo",onclick:function(){document.execCommand("undo")}}),b.push({content:"redo",onclick:function(){document.execCommand("redo")}}),b.push({type:"divisor"}),X.options.toolbarOnTop&&(b.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(ce){return'<span style="font-family:'+ce+'">'+ce+"</span>"},onchange:function(ce,Fe,Le,ae,re){document.execCommand("fontName",!1,ae)}}),b.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(ce){return'<span style="font-size:'+ce+'">'+ce+"</span>"},onchange:function(ce,Fe,Le,ae,re){document.execCommand("fontSize",!1,parseInt(re)+1)}}),b.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(ce){return'<i class="material-icons">'+ce+"</i>"},onchange:function(ce,Fe,Le,ae,re){var me=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(me[re])}}),b.push({type:"divisor"}),b.push({content:"format_color_text",k:"color",onclick:F}),b.push({content:"format_color_fill",k:"background-color",onclick:F})),b.push({content:"format_bold",onclick:function(ce,Fe,Le){document.execCommand("bold"),document.queryCommandState("bold")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({content:"format_italic",onclick:function(ce,Fe,Le){document.execCommand("italic"),document.queryCommandState("italic")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({content:"format_underline",onclick:function(ce,Fe,Le){document.execCommand("underline"),document.queryCommandState("underline")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({type:"divisor"}),b.push({content:"format_list_bulleted",onclick:function(ce,Fe,Le){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({content:"format_list_numbered",onclick:function(ce,Fe,Le){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({content:"format_indent_increase",onclick:function(ce,Fe,Le){document.execCommand("indent",!0,null),document.queryCommandState("indent")?Le.classList.add("selected"):Le.classList.remove("selected")}}),b.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),X.options.toolbarOnTop&&(b.push({type:"divisor"}),b.push({content:"photo",onclick:function(){X.upload()}}),b.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(ce,Fe){Fe&&(Fe.onmouseover=this.onmouseover,ce=ce.split("x"),Fe.setAttribute("data-x",ce[0]),Fe.setAttribute("data-y",ce[1]));var Le=document.createElement("div");return Fe.style.margin="1px",Fe.style.border="1px solid #ddd",Le},onmouseover:function(ce){for(var Fe=parseInt(ce.target.getAttribute("data-x")),Le=parseInt(ce.target.getAttribute("data-y")),ae=0;ae<ce.target.parentNode.children.length;ae++){var re=ce.target.parentNode.children[ae],me=parseInt(re.getAttribute("data-x")),he=parseInt(re.getAttribute("data-y"));me<=Fe&&he<=Le?(re.style.backgroundColor="#cae1fc",re.style.borderColor="#2977ff"):(re.style.backgroundColor="",re.style.borderColor="#ddd")}},onchange:function(ce,Fe,Le){Le=Le.split("x");for(var ae=document.createElement("table"),re=document.createElement("tbody"),me=0;me<=Le[1];me++){for(var he=document.createElement("tr"),Ae=0;Ae<=Le[0];Ae++){var je=document.createElement("td");je.innerHTML="",he.appendChild(je)}re.appendChild(he)}ae.appendChild(re),ae.setAttribute("width","100%"),ae.setAttribute("cellpadding","6"),ae.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,ae.outerHTML)}})),b},q}var te=U();function V(){var q=function(X,F){var b={};b.options={};var ce={type:"big",title:"Untitled",width:510,height:472};for(var Fe in ce)F&&F.hasOwnProperty(Fe)?b.options[Fe]=F[Fe]:b.options[Fe]=ce[Fe];var Le=function(){for(var me=document.createElement("div");X.children[0];)me.appendChild(X.children[0]);for(b.content=document.createElement("div"),b.content.className="jfloating_content",b.content.innerHTML=X.innerHTML;me.children[0];)b.content.appendChild(me.children[0]);b.container=document.createElement("div"),b.container.className="jfloating",b.container.appendChild(b.content),b.options.title?b.container.setAttribute("title",b.options.title):b.container.classList.add("no-title"),b.options.width&&(b.container.style.width=parseInt(b.options.width)+"px"),b.options.height&&(b.container.style.height=parseInt(b.options.height)+"px"),X.innerHTML="",X.appendChild(b.container)},ae=function(){b.container&&b.container.addEventListener("click",function(me){var he=me.target.getBoundingClientRect();if(me.target.classList.contains("jfloating")){if(me.changedTouches&&me.changedTouches[0])var Ae=me.changedTouches[0].clientX,je=me.changedTouches[0].clientY;else var Ae=me.clientX,je=me.clientY;he.width-(Ae-he.left)<50&&je-he.top<50?setTimeout(function(){b.close()},100):b.setState()}})},re=function(){b.container.classList.add("jfloating-"+b.options.type)};return b.state={isMinized:!1},b.setState=function(){b.state.isMinized?b.container.classList.remove("jfloating-minimized"):b.container.classList.add("jfloating-minimized"),b.state.isMinized=!b.state.isMinized},b.close=function(){Components.elements.splice(q.elements.indexOf(b.container),1),b.updatePosition(),X.remove()},b.updatePosition=function(){for(var me=0;me<q.elements.length;me++){var he=q.elements[me],Ae=q.elements[me-1];he.style.right=me*(Ae?Ae.offsetWidth:he.offsetWidth)*1.01+"px"}},b.init=function(){Le(),ae(),re(),q.elements.push(b.container),b.updatePosition(),X.floating=b},b.init(),b};return q.elements=[],q}var ue=V();function Ne(){const q=function(ae){return!isNaN(ae)&&ae!==null&&(typeof ae!="string"||ae.trim()!=="")},X={between:function(ae,re){return ae>=re[0]&&ae<=re[1]},"not between":function(ae,re){return ae<re[0]||ae>re[1]},"<":function(ae,re){return ae<re[0]},"<=":function(ae,re){return ae<=re[0]},">":function(ae,re){return ae>re[0]},">=":function(ae,re){return ae>=re[0]},"=":function(ae,re){return ae==re[0]},"!=":function(ae,re){return ae!=re[0]}},F={"valid date":function(){return!0},"=":function(ae,re){return ae===re[0]},"!=":function(ae,re){return ae!==re[0]},"<":function(ae,re){return ae<re[0]},"<=":function(ae,re){return ae<=re[0]},">":function(ae,re){return ae>re[0]},">=":function(ae,re){return ae>=re[0]},between:function(ae,re){return ae>=re[0]&&ae<=re[1]},"not between":function(ae,re){return ae<re[0]||ae>re[1]}},b={contains:function(ae,re){return ae.includes(re[0])},"not contains":function(ae,re){return!ae.includes(re[0])},"begins with":function(ae,re){return ae.startsWith(re[0])},"ends with":function(ae,re){return ae.endsWith(re[0])},"=":function(ae,re){return ae===re[0]},"!=":function(ae,re){return ae!==re[0]},"valid email":function(ae){var re=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return re.test(ae)},"valid url":function(ae){var re=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return re.test(ae)}},ce=function(ae,re){return typeof ce[re.type]=="function"?re.allowBlank&&(typeof ae>"u"||ae===""||ae===null)?!0:ce[re.type].call(this,ae,re):null};ce.url=function(ae){var re=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!re.test(ae)},ce.email=function(ae){var re=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(ae&&re.test(ae))},ce.required=function(ae){return!!(ae&&ae.trim())},ce.empty=function(ae){return typeof ae>"u"||ae===null||typeof ae=="string"&&!ae.toString().trim()},ce["not exist"]=ce.empty,ce.notEmpty=function(ae){return!ce.empty(ae)},ce.exist=ce.notEmpty,ce.number=function(ae,re){if(!q(ae))return!1;if(!re||!re.criteria)return!0;if(!X[re.criteria])return!1;let me=re.value.map(function(he){return parseFloat(he)});return X[re.criteria](ae,me)},ce.login=function(ae){let re=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(ae&&re.test(ae))},ce.list=function(ae,re){let me=typeof ae;if(me!=="string"&&me!=="number")return!1;let he;return typeof re.value[0]=="string"?re.source?he=re.source:he=re.value[0].split(","):he=re.value[0],Array.isArray(he)?he.findIndex(function(je){return je==ae})>-1:!1};const Fe=function(){let ae=new Date;return ae.setHours(0,0,0,0),ae},Le={"one year ago":function(){let ae=Fe();return ae.setFullYear(ae.getFullYear()-1),ae},"one month ago":function(){let ae=Fe();return ae.setMonth(ae.getMonth()-1),ae},"one week ago":function(){let ae=Fe();return ae.setDate(ae.getDate()-7),ae},yesterday:function(){let ae=Fe();return ae.setDate(ae.getDate()-1),ae},today:Fe,tomorrow:function(){let ae=Fe();return ae.setDate(ae.getDate()+1),ae}};return ce.date=function(ae,re){if(q(ae)&&ae>0&&ae<1e6&&(ae=D.numToDate(ae)),new Date(ae)=="Invalid Date")return!1;if(!re||!re.criteria)return!0;if(!F[re.criteria])return!1;let me=re.value.map(function(he){return typeof he=="string"&&Le[he]?Le[he]().getTime():new Date(he).getTime()});return F[re.criteria](new Date(ae).getTime(),me)},ce.text=function(ae,re){if(typeof ae>"u"||ae===null)ae="";else if(typeof ae!="string")return!1;return!re||!re.criteria?!0:b[re.criteria]?b[re.criteria](ae,re.value):!1},ce.textLength=function(ae,re){return ae=ae.toString(),ce.number(ae.length,re)},ce}var Ge=Ne();function Ue(){var q=function(X,F){var b={};b.options={};var ce={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(re,me){alert(me)}};for(var Fe in ce)F&&F.hasOwnProperty(Fe)?b.options[Fe]=F[Fe]:b.options[Fe]=ce[Fe];b.options.validations||(b.options.validations={}),b.options.submitButton||(b.options.submitButton=X.querySelector("input[type=submit]")),b.options.submitButton&&b.options.url&&(b.options.submitButton.onclick=function(){b.save()}),b.options.validations.email||(b.options.validations.email=Ge.email),b.options.validations.length||(b.options.validations.length=Ge.length),b.options.validations.required||(b.options.validations.required=Ge.required),b.setUrl=function(re){b.options.url=re},b.load=function(){R({url:b.options.url,method:"GET",dataType:"json",queue:!0,success:function(re){if(typeof b.options.onbeforeload=="function"){var me=b.options.onbeforeload(X,re);me&&(re=me)}q.setElements(X,re),typeof b.options.onload=="function"&&b.options.onload(X,re)}})},b.save=function(){var re=b.validate();if(re)b.options.onerror(X,re);else{var me=q.getElements(X,!0);if(typeof b.options.onbeforesave=="function"){var me=b.options.onbeforesave(X,me);if(me===!1)return}R({url:b.options.url,method:"POST",dataType:"json",data:me,success:function(he){typeof b.options.onsave=="function"&&b.options.onsave(X,me,he)}})}},b.remove=function(){if(typeof b.options.onbeforeremove=="function"){var re=b.options.onbeforeremove(X,b);if(re===!1)return!1}R({url:b.options.url,method:"DELETE",dataType:"json",success:function(me){typeof b.options.onremove=="function"&&b.options.onremove(X,b,me),b.reset()}})};var Le=function(re){re.classList.add("error"),b.options.submitButton&&b.options.submitButton.setAttribute("disabled",!0);var me=re.getAttribute("data-error")||"There is an error in the form";return re.setAttribute("title",me),me},ae=function(re){var me=!1;re.classList.remove("error"),re.removeAttribute("title");for(var he=X.querySelectorAll("input, select, textarea, div[name]"),Ae=0;Ae<he.length;Ae++)he[Ae].getAttribute("data-validation")&&he[Ae].classList.contains("error")&&(me=!0);b.options.submitButton&&(me?b.options.submitButton.setAttribute("disabled",!0):b.options.submitButton.removeAttribute("disabled"))};return b.validateElement=function(re){var me=!1,he=q.getValue(re),Ae=re.getAttribute("data-validation");return typeof b.options.validations[Ae]=="function"&&!b.options.validations[Ae](he,re)?me=Le(re):re.classList.contains("error")&&ae(re),me},b.reset=function(){for(var re=X.querySelectorAll("input, select, textarea, div[name]"),me=0;me<re.length;me++)re[me].getAttribute("name")&&(re[me].type=="checkbox"||re[me].type=="radio"?re[me].checked=!1:typeof re[me].val=="function"?re[me].val(""):re[me].value="")},b.validate=function(){for(var re=[],me=X.querySelectorAll("input, select, textarea, div[name]"),he=0;he<me.length;he++)if(me[he].getAttribute("data-validation")){var Ae=b.validateElement(me[he]);Ae&&re.push(Ae)}return re.length>0?re.join("<br>"):!1},b.getError=function(){return!!b.validation()},b.setHash=function(){return b.getHash(q.getElements(X))},b.getHash=function(re){var me=0,he,Ae;if(re.length===0)return me;for(he=0;he<re.length;he++)Ae=re.charCodeAt(he),me=(me<<5)-me+Ae,me|=0;return me},b.isChanged=function(){var re=b.setHash();return b.options.currentHash!=re},b.resetTracker=function(){b.options.currentHash=b.setHash(),b.options.ignore=!1},b.setIgnore=function(re){b.options.ignore=!!re},setTimeout(function(){b.options.currentHash=b.setHash()},1e3),X.addEventListener("keyup",function(re){re.target.getAttribute("data-validation")&&b.validateElement(re.target)}),q.hasEvents||(window.addEventListener("beforeunload",function(re){if(b.isChanged()&&b.options.ignore==!1){var me=b.options.message?b.options.message:"o/";return me?(typeof re>"u"&&(re=window.event),re&&(re.returnValue=me),me):void 0}}),q.hasEvents=!0),X.form=b,b};return q.getValue=function(X){var F=null;if(X.type=="checkbox")X.checked==!0&&(F=X.value||!0);else if(X.type=="radio")X.checked==!0&&(F=X.value);else if(X.type=="file")F=X.files;else if(X.tagName=="select"&&X.multiple==!0){F=[];for(var b=X.querySelectorAll("options[selected]"),ce=0;ce<b.length;ce++)F.push(b[ce].value)}else typeof X.val=="function"?F=X.val():F=X.value||"";return F},q.getElements=function(X,F){for(var b={},ce=null,Fe=X.querySelectorAll("input, select, textarea, div[name]"),Le=0;Le<Fe.length;Le++)(ce=Fe[Le].getAttribute("name"))&&(b[ce]=q.getValue(Fe[Le])||"");return F==!0?b:JSON.stringify(b)},q.setElements=function(X,F){for(var b=null,ce=null,Fe=X.querySelectorAll("input, select, textarea, div[name]"),Le=0;Le<Fe.length;Le++){var ae=Fe[Le].getAttribute("type");if(b=Fe[Le].getAttribute("name")){if(b=b.replace(new RegExp(/\[(.*?)\]/ig),".$1"),ce=null,b.match(/\./)){var re=E.call(F,b)||"";typeof re<"u"&&(ce=re)}else typeof F[b]<"u"&&(ce=F[b]);ce!==null&&(ae=="checkbox"||ae=="radio"?Fe[Le].checked=!!ce:ae=="file"||(typeof Fe[Le].val=="function"?Fe[Le].val(ce):Fe[Le].value=ce))}}},q}var Ie=Ue();function Ke(){var q=function(){var F=null,b=function(ae){if(ae.which==27)for(var re=document.querySelectorAll(".jmodal"),me=0;me<re.length;me++)re[me].parentNode.modal.close()},ce=function(ae){let re=ae.composedPath();var me=m.findElement(re[0],"jmodal");if(me){var he=me.getBoundingClientRect();if(ae.changedTouches&&ae.changedTouches[0])var Ae=ae.changedTouches[0].clientX,je=ae.changedTouches[0].clientY;else var Ae=ae.clientX,je=ae.clientY;he.width-(Ae-he.left)<50&&je-he.top<50&&me.parentNode.modal.close()}F&&(F.element.style.cursor="auto",F=null)},Fe=function(ae){let re=ae.composedPath();var me=m.findElement(re[0],"jmodal");if(me){var he=me.getBoundingClientRect();if(ae.changedTouches&&ae.changedTouches[0])var Ae=ae.changedTouches[0].clientX,je=ae.changedTouches[0].clientY;else var Ae=ae.clientX,je=ae.clientY;he.width-(Ae-he.left)<50&&je-he.top<50||je-he.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),F={left:he.left,top:he.top,x:ae.clientX,y:ae.clientY,width:he.width,height:he.height,element:me})}},Le=function(ae){if(F){if(ae=ae||window.event,ae.buttons)var re=ae.buttons;else if(ae.button)var re=ae.button;else var re=ae.which;re?(F.element.style.top=F.top+(ae.clientY-F.y)+F.height/2+"px",F.element.style.left=F.left+(ae.clientX-F.x)+F.width/2+"px",F.element.style.cursor="move"):F.element.style.cursor="auto"}};document.addEventListener("keydown",b),document.addEventListener("mouseup",ce),document.addEventListener("mousedown",Fe),document.addEventListener("mousemove",Le)},X=function(F,b){var ce={};ce.options={};var Fe={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var Le in Fe)b&&b.hasOwnProperty(Le)?ce.options[Le]=b[Le]:ce.options[Le]=Fe[Le];!ce.options.title&&F.getAttribute("title")&&(ce.options.title=F.getAttribute("title"));for(var ae=document.createElement("div");F.children[0];)ae.appendChild(F.children[0]);for(ce.title=document.createElement("div"),ce.title.className="jmodal_title",ce.options.icon&&ce.title.setAttribute("data-icon",ce.options.icon),ce.content=document.createElement("div"),ce.content.className="jmodal_content",ce.content.innerHTML=F.innerHTML;ae.children[0];)ce.content.appendChild(ae.children[0]);if(ce.container=document.createElement("div"),ce.container.className="jmodal",ce.container.appendChild(ce.title),ce.container.appendChild(ce.content),ce.options.padding&&(ce.content.style.padding=ce.options.padding),ce.options.width&&(ce.container.style.width=ce.options.width),ce.options.height&&(ce.container.style.height=ce.options.height),ce.options.title){var re=document.createElement("h4");re.innerText=ce.options.title,ce.title.appendChild(re)}if(F.innerHTML="",F.style.display="none",F.appendChild(ce.container),ce.options.backdrop){var me=document.createElement("div");me.className="jmodal_backdrop",me.onclick=function(){ce.close()},F.appendChild(me)}return ce.open=function(){F.style.display="block";var he=ce.container.getBoundingClientRect();m.getWindowWidth()<he.width?(ce.container.style.top="",ce.container.style.left="",ce.container.classList.add("jmodal_fullscreen"),N.slideBottom(ce.container,1)):ce.options.backdrop&&(me.style.display="block"),typeof ce.options.onopen=="function"&&ce.options.onopen(F,ce)},ce.resetPosition=function(){ce.container.style.top="",ce.container.style.left=""},ce.isOpen=function(){return F.style.display!="none"},ce.close=function(){ce.isOpen()&&(F.style.display="none",ce.options.backdrop&&(me.style.display=""),ce.container.classList.remove("jmodal_fullscreen"),typeof ce.options.onclose=="function"&&ce.options.onclose(F,ce))},ce.options.url?R({url:ce.options.url,method:"GET",dataType:"text/html",success:function(he){ce.content.innerHTML=he,ce.options.closed||ce.open(),typeof ce.options.onload=="function"&&ce.options.onload(ce)}}):(ce.options.closed||ce.open(),typeof ce.options.onload=="function"&&ce.options.onload(ce)),F.modal=ce,q(),q=function(){},ce};return X}var le=Ke();function ge(){var q=function(X){var F={};F.options={};var b={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var ce in b)X&&X.hasOwnProperty(ce)?F.options[ce]=X[ce]:F.options[ce]=b[ce];var Fe=document.createElement("div");Fe.className="jnotification",F.options.error&&Fe.classList.add("jnotification-error");var Le=document.createElement("div");Le.className="jnotification-container",Fe.appendChild(Le);var ae=document.createElement("div");ae.className="jnotification-header",Le.appendChild(ae);var re=document.createElement("div");if(re.className="jnotification-image",ae.appendChild(re),F.options.icon){var me=document.createElement("img");me.src=F.options.icon,re.appendChild(me)}var he=document.createElement("div");if(he.className="jnotification-name",he.innerHTML=F.options.name,ae.appendChild(he),F.options.closeable==!0){var Ae=document.createElement("div");Ae.className="jnotification-close",Ae.onclick=function(){F.hide()},ae.appendChild(Ae)}var je=document.createElement("div");je.className="jnotification-date",ae.appendChild(je);var ke=document.createElement("div");if(ke.className="jnotification-content",Le.appendChild(ke),F.options.title){var et=document.createElement("div");et.className="jnotification-title",et.innerHTML=F.options.title,ke.appendChild(et)}var pt=document.createElement("div");if(pt.className="jnotification-message",pt.innerHTML=F.options.message,ke.appendChild(pt),F.show=function(){document.body.appendChild(Fe),m.getWindowWidth()>800?N.fadeIn(Fe):N.slideTop(Fe,1)},F.hide=function(){m.getWindowWidth()>800?N.fadeOut(Fe,function(){Fe.parentNode&&(Fe.parentNode.removeChild(Fe),A&&clearTimeout(A))}):N.slideTop(Fe,0,function(){Fe.parentNode&&(Fe.parentNode.removeChild(Fe),A&&clearTimeout(A))})},F.show(),F.options.autoHide==!0)var A=setTimeout(function(){F.hide()},F.options.timeout);return m.getWindowWidth()<800&&Fe.addEventListener("swipeup",function(K){F.hide(),K.preventDefault(),K.stopPropagation()}),F};return q.isVisible=function(){var X=document.querySelector(".jnotification");return!!(X&&X.parentNode)},q}var we=ge();function qe(q,X){var F={};F.options={};var b={value:0,onchange:null,width:null};for(var ce in b)X&&X.hasOwnProperty(ce)?F.options[ce]=X[ce]:F.options[ce]=b[ce];q.classList.add("jprogressbar"),q.setAttribute("tabindex",1),q.setAttribute("data-value",F.options.value);var Fe=document.createElement("div");Fe.style.width=F.options.value+"%",Fe.style.color="#fff",q.appendChild(Fe),F.options.width&&(q.style.width=F.options.width),F.setValue=function(ae){ae=parseInt(ae),F.options.value=ae,Fe.style.width=ae+"%",q.setAttribute("data-value",ae+"%"),ae<6?q.style.color="#000":q.style.color="#fff",F.options.value=ae,typeof F.options.onchange=="function"&&F.options.onchange(q,ae),q.value!=F.options.value&&(q.value=F.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value}))},F.getValue=function(){return F.options.value};var Le=function(ae){if(ae.which){var re=q.getBoundingClientRect();if(ae.changedTouches&&ae.changedTouches[0]){var me=ae.changedTouches[0].clientX;ae.changedTouches[0].clientY}else{var me=ae.clientX;ae.clientY}F.setValue(Math.round((me-re.left)/re.width*100))}};return"touchstart"in document.documentElement?(q.addEventListener("touchstart",Le),q.addEventListener("touchend",Le)):(q.addEventListener("mousedown",Le),q.addEventListener("mousemove",Le)),q.change=F.setValue,q.val=function(ae){if(ae===void 0)return F.getValue();F.setValue(ae)},q.progressbar=F,F}function $e(q,X){if(q.rating)return q.rating.setOptions(X,!0);var F={};F.options={},F.setOptions=function(ce,Fe){var Le={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var ae in Le)ce&&ce.hasOwnProperty(ae)?F.options[ae]=ce[ae]:(typeof F.options[ae]>"u"||Fe===!0)&&(F.options[ae]=Le[ae]);q.innerHTML="";for(var re=0;re<F.options.number;re++){var me=document.createElement("div");me.setAttribute("data-index",re+1),me.setAttribute("title",F.options.tooltip[re]),q.appendChild(me)}if(F.options.value)for(var re=0;re<F.options.number;re++)re<F.options.value&&q.children[re].classList.add("jrating-selected");return F},F.setValue=function(ce){for(var Fe=0;Fe<F.options.number;Fe++)Fe<ce?q.children[Fe].classList.add("jrating-selected"):(q.children[Fe].classList.remove("jrating-over"),q.children[Fe].classList.remove("jrating-selected"));F.options.value=ce,typeof F.options.onchange=="function"&&F.options.onchange(q,ce),q.value!=F.options.value&&(q.value=F.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value}))},F.getValue=function(){return F.options.value};var b=function(){F.setOptions(X),q.classList.add("jrating"),q.addEventListener("click",function(ce){var Fe=ce.target.getAttribute("data-index");Fe!=null&&(Fe==F.options.value?F.setValue(0):F.setValue(Fe))}),q.addEventListener("mouseover",function(ce){for(var Fe=ce.target.getAttribute("data-index"),Le=0;Le<F.options.number;Le++)Le<Fe?q.children[Le].classList.add("jrating-over"):q.children[Le].classList.remove("jrating-over")}),q.addEventListener("mouseout",function(ce){for(var Fe=0;Fe<F.options.number;Fe++)q.children[Fe].classList.remove("jrating-over")}),q.change=F.setValue,q.val=function(ce){if(ce===void 0)return F.getValue();F.setValue(ce)},q.rating=F};return b(),F}function ze(q,X){if(q.search)return q.search;var F=null,b=function(me){if(me.target.classList.contains("jsearch_item"))var he=me.target;else var he=me.target.parentNode;ae.selectIndex(he),me.preventDefault()},ce=function(me){if(typeof ae.options.onsearch=="function"){var he=ae.options.onsearch(ae,me);he&&(me=he)}if(re.innerHTML="",!me.length)q.style.display="";else{q.style.display="block";for(var Ae=me.length<11?me.length:10,je=0;je<Ae;je++){if(typeof me[je]=="string")var ke=me[je],et=me[je];else{var ke=me[je].text;!ke&&me[je].name&&(ke=me[je].name);var et=me[je].value;!et&&me[je].id&&(et=me[je].id)}var pt=document.createElement("div");pt.setAttribute("data-value",et),pt.setAttribute("data-text",ke),pt.className="jsearch_item",me[je].id&&pt.setAttribute("id",me[je].id),ae.options.forceSelect&&je==0&&pt.classList.add("selected");var A=document.createElement("img");me[je].image?A.src=me[je].image:A.style.display="none",pt.appendChild(A);var K=document.createElement("div");K.innerHTML=ke,pt.appendChild(K),re.appendChild(pt)}}},Fe=function(me){if(me!=ae.terms)if(ae.terms=me,ae.options.forceSelect?F=0:F=null,Array.isArray(ae.options.data)){var he=function(je){if(typeof je=="string"){if((""+je).toLowerCase().search(me.toLowerCase())>=0)return!0}else for(var ke in je){var et=je[ke];if((""+et).toLowerCase().search(me.toLowerCase())>=0)return!0}return!1},Ae=ae.options.data.filter(function(je){return he(je)});ce(Ae)}else R({url:ae.options.data+me,method:"GET",dataType:"json",success:function(je){ce(je)}})},Le=null,ae=function(me){Le&&clearTimeout(Le),Le=setTimeout(function(){Fe(me)},500)};X.forceSelect===null&&(X.forceSelect=!0),ae.options={data:X.data||null,input:X.input||null,searchByNode:X.searchByNode||null,onselect:X.onselect||null,forceSelect:X.forceSelect,onsearch:X.onsearch||null,onbeforesearch:X.onbeforesearch||null},ae.selectIndex=function(me){var he=me.getAttribute("id"),Ae=me.getAttribute("data-text"),je=me.getAttribute("data-value"),ke=me.children[0].src||"";typeof ae.options.onselect=="function"&&ae.options.onselect(ae,Ae,je,he,ke),ae.close()},ae.open=function(){q.style.display="block"},ae.close=function(){Le&&clearTimeout(Le),ae.terms="",re.innerHTML="",q.style.display=""},ae.isOpened=function(){return!!q.style.display},ae.keydown=function(me){ae.isOpened()&&(me.key=="Enter"?F!==null&&re.children[F]?(ae.selectIndex(re.children[F]),me.preventDefault()):ae.close():me.key==="ArrowUp"?(F!==null&&re.children[0]&&(re.children[F].classList.remove("selected"),!ae.options.forceSelect&&F===0?F=null:(F=Math.max(0,F-1),re.children[F].classList.add("selected"))),me.preventDefault()):me.key==="ArrowDown"&&(F==null?F=-1:re.children[F].classList.remove("selected"),F<9&&re.children[F+1]&&F++,re.children[F].classList.add("selected"),me.preventDefault()))},ae.keyup=function(me){if(!ae.options.searchByNode&&ae.options.input)if(ae.options.input.tagName==="DIV")var he=ae.options.input.innerText;else var he=ae.options.input.value;else{var Ae=m.getNode();if(Ae)var he=Ae.innerText}if(typeof ae.options.onbeforesearch=="function"){var je=ae.options.onbeforesearch(ae,he);if(je)he=je;else if(je===!1)return}ae(he)},ae.blur=function(me){ae.close()},ae.options.input&&(ae.options.input.addEventListener("keyup",ae.keyup),ae.options.input.addEventListener("keydown",ae.keydown),ae.options.input.addEventListener("blur",ae.blur));var re=document.createElement("div");return re.classList.add("jsearch_container"),re.onmousedown=b,q.appendChild(re),q.classList.add("jsearch"),q.search=ae,ae}function it(q,X){var F={};if(F.options={},F.currentImage=null,X&&(F.options=X),q.setAttribute("tabindex","900"),F.options.items=[],!q.classList.contains("jslider")){if(q.classList.add("jslider"),q.classList.add("unselectable"),F.options.height&&(q.style.minHeight=parseInt(F.options.height)+"px"),F.options.width&&(q.style.width=parseInt(F.options.width)+"px"),F.options.grid){q.classList.add("jslider-grid");var b=q.children.length;b>4&&q.setAttribute("data-total",b-4),q.setAttribute("data-number",b>4?4:b)}var ce=document.createElement("div");if(ce.classList.add("jslider-counter"),q.children.length>0)for(var Fe=0;Fe<q.children.length;Fe++){F.options.items.push(q.children[Fe]);var Le=document.createElement("div");Le.onclick=function(){var Ae=Array.prototype.slice.call(ce.children).indexOf(this);F.show(F.currentImage=F.options.items[Ae])},ce.appendChild(Le)}var ae=document.createElement("div");ae.className="jslider-caption";var re=document.createElement("div"),me=document.createElement("div");me.className="jslider-close",me.innerHTML="",me.onclick=function(){F.close()},re.appendChild(ae),re.appendChild(me)}F.updateCounter=function(Ae){for(var je=0;je<ce.children.length;je++)if(ce.children[je].classList.contains("jslider-counter-focus")){ce.children[je].classList.remove("jslider-counter-focus");break}ce.children[Ae].classList.add("jslider-counter-focus")},F.show=function(Ae){if(!Ae)var Ae=q.children[0];q.classList.add("jslider-focus"),q.classList.remove("jslider-grid"),q.appendChild(re),q.appendChild(ce);var je=F.options.items.indexOf(Ae);F.updateCounter(je);for(var ke=0;ke<q.children.length;ke++)q.children[ke].style.display="";Ae.style.display="block",Ae.previousElementSibling?q.classList.add("jslider-left"):q.classList.remove("jslider-left"),Ae.nextElementSibling&&Ae.nextElementSibling.tagName=="IMG"?q.classList.add("jslider-right"):q.classList.remove("jslider-right"),F.currentImage=Ae,F.currentImage.offsetHeight>F.currentImage.offsetWidth&&F.currentImage.classList.add("jslider-vertical"),re.children[0].innerText=F.currentImage.getAttribute("title")},F.open=function(){F.show(),typeof F.options.onopen=="function"&&F.options.onopen(q)},F.close=function(){q.classList.remove("jslider-focus"),q.classList.remove("jslider-left"),q.classList.remove("jslider-right"),F.options.grid&&q.classList.add("jslider-grid");for(var Ae=0;Ae<q.children.length;Ae++)q.children[Ae].style.display="";ce.remove(),re.remove(),F.currentImage=null,typeof F.options.onclose=="function"&&F.options.onclose(q)},F.reset=function(){q.innerHTML=""},F.next=function(){var Ae=F.currentImage.nextElementSibling;Ae&&Ae.tagName==="IMG"&&F.show(F.currentImage.nextElementSibling)},F.prev=function(){F.currentImage.previousElementSibling&&F.show(F.currentImage.previousElementSibling)};var he=function(Ae){if(Ae.target.tagName=="IMG")F.show(Ae.target);else if(!Ae.target.classList.contains("jslider-close")&&!(Ae.target.parentNode.classList.contains("jslider-counter")||Ae.target.classList.contains("jslider-counter"))){var je=Ae.offsetX||Ae.changedTouches[0].clientX;Ae.target.clientWidth-je<40?F.next():je<40&&F.prev()}};return"ontouchend"in document.documentElement?q.addEventListener("touchend",he):q.addEventListener("mouseup",he),q.addEventListener("swipeleft",function(Ae){F.next(),Ae.preventDefault(),Ae.stopPropagation()}),q.addEventListener("swiperight",function(Ae){F.prev(),Ae.preventDefault(),Ae.stopPropagation()}),q.addEventListener("keydown",function(Ae){Ae.which==27&&F.close()}),q.slider=F,F}function Ve(q,X){if(q.tags)return q.tags.setOptions(X,!0);var F={type:"tags"};F.options={};var b=function(){return!!(F.options.limit&&q.children.length>=F.options.limit)},ce=null,Fe=null;F.setOptions=function(Y,oe){var Te={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var ee in Te)Y&&Y.hasOwnProperty(ee)?F.options[ee]=Y[ee]:(typeof F.options[ee]>"u"||oe===!0)&&(F.options[ee]=Te[ee]);return F.options.placeholder?q.setAttribute("data-placeholder",F.options.placeholder):q.removeAttribute("data-placeholder"),q.placeholder=F.options.placeholder,F.setValue(F.options.value),me(),F.options.search?Fe||(Fe=document.createElement("div"),q.parentNode.insertBefore(Fe,q.nextSibling),ce=ze(Fe,{data:F.options.search,onselect:function(ye,H,Q){F.selectIndex(H,Q)}})):Fe&&(ce=null,Fe.remove(),Fe=null),F},F.add=function(Y,oe){if(typeof F.options.onbeforechange=="function"){var Te=F.options.onbeforechange(q,F,F.options.value,Y);if(Te===!1)return!1;Te!=null&&(Y=Te)}if(ce&&ce.close(),b())typeof F.options.onlimit=="function"?F.options.onlimit(F,F.options.limit):alert(c.translate("You reach the limit number of entries")+" "+F.options.limit);else{var ee=m.getNode();if(ee&&ee.parentNode&&ee.parentNode.classList.contains("jtags")&&ee.nextSibling&&!(ee.nextSibling.innerText&&ee.nextSibling.innerText.trim()))ye=ee.nextSibling;else{if(q.lastChild&&(q.lastChild.innerText.trim()||q.removeChild(q.lastChild)),!Y||typeof Y=="string")var ye=ae(Y,Y,ee);else for(var H=0;H<=Y.length;H++)if(!b()){if(!Y[H]||typeof Y[H]=="string")var Q=Y[H]||"",pe=null;else var Q=Y[H].text,pe=Y[H].value;var ye=ae(Q,pe)}re()}oe&&Le(ye)}},F.setLimit=function(Y){for(F.options.limit=Y,q.children.length-Y;q.children.length>Y;)q.removeChild(q.lastChild)},F.remove=function(Y){Y.parentNode.removeChild(Y),q.children.length?re():F.add("",!0),typeof F.options.onremoveitem=="function"&&F.options.onremoveitem(q,F,Y)},F.getData=function(){for(var Y=[],oe=0;oe<q.children.length;oe++){var Te=q.children[oe].innerText.replace(`
`,""),ee=q.children[oe].getAttribute("data-value");ee||(ee=Te),(Te||ee)&&Y.push({text:Te,value:ee})}return Y},F.getValue=function(Y){var oe=null;if(Y!=null)oe=q.children[Y].getAttribute("data-value"),oe||(oe=q.children[Y].innerText.replace(`
`,""));else{for(var Te=[],ee=0;ee<q.children.length;ee++)oe=q.children[ee].innerText.replace(`
`,""),oe&&Te.push(F.getValue(ee));oe=Te.join(",")}return oe},F.setValue=function(Y){if(!Y)F.reset();else if(q.value!=Y)if(Array.isArray(Y))F.add(Y);else{var oe=(""+Y).trim(),Te=Ae(oe);q.innerHTML="",F.add(Te)}},F.reset=function(){q.classList.add("jtags-empty"),q.innerHTML="<div></div>",re()},F.isValid=function(){for(var Y=0,oe=0;oe<q.children.length;oe++)q.children[oe].classList.contains("jtags_error")&&Y++;return Y==0},F.selectIndex=function(Y,oe){var Te=m.getNode();Te&&(Te.innerText=Y,oe&&Te.setAttribute("data-value",oe),Te.classList.remove("jtags_error"),b()||F.add("",!0))},F.search=function(Y){Y.innerText},F.destroy=function(){q.removeEventListener("mouseup",A),q.removeEventListener("keydown",ke),q.removeEventListener("keyup",et),q.removeEventListener("paste",pt),q.removeEventListener("focus",K),q.removeEventListener("blur",L),q.parentNode.removeChild(q)};var Le=function(Y){if(q.children.length){var oe=document.createRange(),Te=window.getSelection();if(!Y)var Y=q.childNodes[q.childNodes.length-1];oe.setStart(Y,Y.length),oe.collapse(!0),Te.removeAllRanges(),Te.addRange(oe),q.scrollLeft=q.scrollWidth}},ae=function(Y,oe,Te){var ee=document.createElement("div");return ee.textContent=Y||"",oe&&ee.setAttribute("data-value",oe),Te&&Te.parentNode.classList.contains("jtags")?q.insertBefore(ee,Te.nextSibling):q.appendChild(ee),ee},re=function(){var Y=F.getValue();Y!=F.options.value&&(F.options.value=Y,typeof F.options.onchange=="function"&&F.options.onchange(q,F,F.options.value),q.value!=F.options.value&&(q.value=F.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value}))),me()},me=function(){for(var Y=0;Y<q.children.length;Y++)q.children[Y].tagName==="DIV"&&(F.getValue(Y)?(q.children[Y].classList.add("jtags_label"),typeof F.options.validation=="function"&&F.getValue(Y)?F.options.validation(q.children[Y],q.children[Y].innerText,q.children[Y].getAttribute("data-value"))?q.children[Y].classList.remove("jtags_error"):q.children[Y].classList.add("jtags_error"):q.children[Y].classList.remove("jtags_error")):q.children[Y].classList.remove("jtags_label"));he()},he=function(){q.innerText.trim()?q.classList.remove("jtags-empty"):(!q.children.length||q.children[0].tagName==="BR")&&(q.innerHTML="",Le(ae()))},Ae=function(Y){var oe=[],Te="";if(Y=Y.trim(),Y){for(var ee=0;ee<Y.length;ee++)Y[ee]==","||Y[ee]==";"||Y[ee]==`
`?Te&&(oe.push(Te.trim()),Te=""):Te+=Y[ee];Te&&oe.push(Te)}return oe},je=0,ke=function(Y){if(je=window.getSelection().anchorOffset,he(),Y.key==="Tab"||Y.key===";"||Y.key===","){var oe=window.getSelection().anchorOffset;oe>1&&(b()?typeof F.options.onlimit=="function"&&F.options.onlimit(F,F.options.limit):F.add("",!0)),Y.preventDefault()}else if(Y.key=="Enter"){if(!ce||!ce.isOpened()){var oe=window.getSelection().anchorOffset;oe>1&&(b()||F.add("",!0)),Y.preventDefault()}}else Y.key=="Backspace"&&q.children.length==1&&window.getSelection().anchorOffset<1&&Y.preventDefault();ce&&ce.keydown(Y),he()},et=function(Y){if(Y.which==39){var oe=window.getSelection().anchorOffset;oe>1&&oe==je&&F.add("",!0)}else Y.which==13||Y.which==38||Y.which==40?Y.preventDefault():ce&&ce.keyup(Y);me()},pt=function(Y){if(Y.clipboardData||Y.originalEvent.clipboardData)var oe=(Y.originalEvent||Y).clipboardData.getData("text/plain");else if(window.clipboardData)var oe=window.clipboardData.getData("Text");var Te=Ae(oe);if(typeof F.options.onbeforepaste=="function"){var ee=F.options.onbeforepaste(q,F,Te);if(ee===!1)return Y.preventDefault(),!1;ee&&(Te=ee)}Te.length>1?(F.add(Te,!0),Y.preventDefault()):Te[0]&&(document.execCommand("insertText",!1,Te[0]),Y.preventDefault())},A=function(Y){if(Y.target.parentNode&&Y.target.parentNode.classList.contains("jtags")&&(Y.target.classList.contains("jtags_label")||Y.target.classList.contains("jtags_error"))){var oe=Y.target.getBoundingClientRect();oe.width-(Y.clientX-oe.left)<16&&F.remove(Y.target)}Y.target==q&&Le()},K=function(){q.classList.contains("jtags-focus")||((!q.children.length||F.getValue(q.children.length-1))&&(b()||ae("")),typeof F.options.onfocus=="function"&&F.options.onfocus(q,F,F.getValue()),q.classList.add("jtags-focus"))},L=function(){if(q.classList.contains("jtags-focus")){ce&&ce.close();for(var Y=0;Y<q.children.length-1;Y++)F.getValue(Y)||q.removeChild(q.children[Y]);re(),q.classList.remove("jtags-focus"),typeof F.options.onblur=="function"&&F.options.onblur(q,F,F.getValue())}},j=function(){"touchend"in document.documentElement?q.addEventListener("touchend",A):q.addEventListener("mouseup",A),q.addEventListener("keydown",ke),q.addEventListener("keyup",et),q.addEventListener("paste",pt),q.addEventListener("focus",K),q.addEventListener("blur",L),q.setAttribute("contenteditable",!0),q.classList.add("jtags"),F.setOptions(X),typeof F.options.onload=="function"&&F.options.onload(q,F),q.change=F.setValue,q.val=function(Y){if(Y===void 0)return F.getValue();F.setValue(Y)},q.tags=F};return j(),F}function Qe(q,X){var F={};F.options={};var b={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var ce in b)X&&X.hasOwnProperty(ce)?F.options[ce]=X[ce]:F.options[ce]=b[ce];F.options.multiple==!0&&q.setAttribute("data-multiple",!0),q.content=[],q.classList.add("jupload"),F.options.input==!0&&q.classList.add("input"),F.add=function(re){if(F.options.multiple==!1&&(q.content=[],q.innerText=""),F.options.type=="image"){var me=document.createElement("img");me.setAttribute("src",re.file),me.setAttribute("tabindex",-1),q.getAttribute("name")||(me.className="jfile",me.content=re),q.appendChild(me)}else{if(re.name)var he=re.name;else var he=re.file;var Ae=document.createElement("div");Ae.innerText=he||F.options.type,Ae.classList.add("jupload-item"),Ae.setAttribute("tabindex",-1),q.appendChild(Ae)}re.content&&(re.file=m.guid()),q.content.push(re),typeof F.options.onchange=="function"&&F.options.onchange(q,re)},F.addFromFile=function(re){var me=re.type.split("/");if(me[0]==F.options.type){var he=new FileReader;he.addEventListener("load",function(Ae){var je={file:Ae.srcElement.result,extension:re.name.substr(re.name.lastIndexOf(".")+1),name:re.name,size:re.size,lastmodified:re.lastModified,content:Ae.srcElement.result};F.add(je)}),he.readAsDataURL(re)}else alert(c.translate("This extension is not allowed"))},F.addFromUrl=function(re){if(re.substr(0,4)!="data"&&!F.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(re.substr(0,4)=="data"){var me=re.split(";");me=me[0].split("/");var he=me[0].replace("data:","");if(he==F.options.type){var Ae={file:re,name:"",extension:me[1],content:re};F.add(Ae)}else alert(F.options.text.extensionNotAllowed)}else{var me=re.substr(re.lastIndexOf(".")+1);re=F.options.remoteParser+re,R({url:re,type:"GET",dataType:"blob",success:function(ke){}})}};var Fe=F.options.type+"/"+F.options.extension,Le=document.createElement("input");Le.type="file",Le.setAttribute("accept",Fe),Le.onchange=function(){for(var re=0;re<this.files.length;re++)F.addFromFile(this.files[re])},F.options.multiple==!0&&Le.setAttribute("multiple",!0);var ae=null;return q.addEventListener("click",function(re){ae=null,!q.children.length||re.target===q?m.click(Le):re.target.parentNode==q&&(ae=re.target)}),q.addEventListener("dblclick",function(re){m.click(Le)}),q.addEventListener("dragenter",function(re){q.style.border="1px dashed #000"}),q.addEventListener("dragleave",function(re){q.style.border="1px solid #eee"}),q.addEventListener("dragstop",function(re){q.style.border="1px solid #eee"}),q.addEventListener("dragover",function(re){re.preventDefault()}),q.addEventListener("keydown",function(re){if(ae&&re.which==46){var me=Array.prototype.indexOf.call(q.children,ae);me>=0&&(q.content.splice(me,1),ae.remove(),ae=null)}}),q.addEventListener("drop",function(re){re.preventDefault(),re.stopPropagation();var me=(re.originalEvent||re).dataTransfer.getData("text/html"),he=(re.originalEvent||re).dataTransfer.files;if(he.length)for(var Ae=0;Ae<re.dataTransfer.files.length;Ae++)F.addFromFile(re.dataTransfer.files[Ae]);else if(me){F.options.multiple==!1&&(q.innerText="");var je=document.createElement("div");je.innerHTML=me;var ke=je.querySelectorAll("img");if(ke.length)for(var Ae=0;Ae<ke.length;Ae++)F.addFromUrl(ke[Ae].src)}return q.style.border="1px solid #eee",!1}),q.val=function(re){if(re===void 0)return q.content&&q.content.length?q.content:null;if(q.innerText="",q.content=[],re)if(Array.isArray(re))for(var me=0;me<re.length;me++)typeof re[me]=="string"?F.add({file:re[me]}):F.add(re[me]);else typeof re=="string"&&F.add({file:re})},q.upload=q.image=F,F}var nt=o(195),Ze=o.n(nt),at={...c,...m,version:"5.8.5",setExtensions:function(q){if(typeof q=="object")for(var X=Object.keys(q),F=0;F<X.length;F++)at[X[F]]=q[X[F]]},tracking:f,path:E,sorting:v,lazyLoading:_,ajax:R,animation:N,calendar:Z,color:Se,contextmenu:Pe,dropdown:Oe,editor:te,floating:ue,form:Ie,mask:z,modal:le,notification:we,palette:xe,picker:st,progressbar:qe,rating:$e,search:ze,slider:it,tabs:de,tags:Ve,toolbar:rt,upload:Qe,validations:Ge};at.image=Qe,at.image.create=function(q){var X=document.createElement("img");return X.setAttribute("src",q.file),X.className="jfile",X.setAttribute("tabindex",-1),X.content=q,X},at.tracker=Ie,at.loading=N.loading,at.sha512=Ze(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const q=function(Y,oe){return Y[oe.type]&&Y[oe.type]==oe||Y.component&&Y.component==oe?!0:Y.parentNode?q(Y.parentNode,oe):!1},X=function(Y){let oe=window.jSuitesStateControl;if(oe&&oe.length>0)for(let Te=0;Te<oe.length;Te++)oe[Te]&&!q(Y,oe[Te])&&oe[Te].close()};let F=15,b=!1,ce={x:null,y:null},Fe=document.createElement("div");Fe.classList.add("jtooltip");const Le=function(Y){return Y&&(Y.shadowRoot||Y.tagName&&Y.tagName.includes("-"))},ae=function(Y){let oe,Te,ee=Y.path||Y.composedPath&&Y.composedPath();return ee?(Te=ee[0],Te&&Le(Te)&&!Te.shadowRoot&&Y.toElement&&(Te=Y.toElement)):(Y.target&&Le(Y.target)?oe=Y.target.shadowRoot:oe=document,Te=oe.elementFromPoint(x,y)),Te},re=function(Y){if(Y.changedTouches&&Y.changedTouches[0])var oe=Y.changedTouches[0].clientX,Te=Y.changedTouches[0].clientY;else var oe=Y.clientX,Te=Y.clientY;let ee=ae(Y),ye=ee&&ee.tagName==="DIV"&&ee.getAttribute("contentEditable"),H=at.findElement(ee,"jpanel");if(H&&!H.classList.contains("readonly")&&!ye){let Q=H.getBoundingClientRect(),pe=0;H.style.rotate&&(pe=parseFloat(H.style.rotate));let Re="move";ee.getAttribute("data-action")?Re=ee.getAttribute("data-action"):H.style.cursor?Re="resize":H.style.cursor="move",b={action:Re,a:pe,e:H,x:oe,y:Te,l:Q.left,t:Q.top,b:Q.bottom,r:Q.right,w:Q.width,h:Q.height,d:H.style.cursor,actioned:!1},H.style.width||(H.style.width=Q.width+"px"),H.style.height||(H.style.height=Q.height+"px")}else b=!1;X(ee),et(Y)},me=function(Y,oe,Te,ee,ye,H){const Q=Te-Y,pe=ee-oe,Re=ye-Y,Ce=H-oe;let We=Math.atan2(pe,Q),mt=Math.atan2(Ce,Re)-We;return mt=mt*(180/Math.PI),mt<0&&(mt+=360),mt},he=function(Y){b&&b.e&&(typeof b.e.refresh=="function"&&ce.actioned&&b.e.refresh(),b.e.style.cursor=""),ce={x:null,y:null},b=!1},Ae=function(Y){if(b){let H=Y.clientX||Y.pageX,Q=Y.clientY||Y.pageY;if(ce.x==null&&ce.y==null&&(ce.x=H,ce.y=Q),b.action==="move"){var oe=H-ce.x,Te=Q-ce.y,ee=b.e.offsetTop+Te,ye=b.e.offsetLeft+oe;b.e.style.top=ee+"px",b.e.style.left=ye+"px",typeof b.e.refresh=="function"&&(ce.actioned=!0,b.e.refresh("position",ee,ye))}else if(b.action==="rotate"){let pe=b.l+b.w/2,Re=b.t+b.h/2,Ce=me(pe,Re,b.x,b.y,H,Q);Ce=Ce+b.a%360,Ce=Math.round(Ce/2)*2,b.e.style.rotate=`${Ce}deg`,typeof b.e.refresh=="function"&&(ce.actioned=!0,b.e.refresh("rotate",Ce))}else if(b.action==="resize"){let pe=null,Re=null,Ce=null,We=null;b.d=="e-resize"||b.d=="ne-resize"||b.d=="se-resize"?(Ce=b.e.offsetWidth+(H-ce.x),Y.shiftKey&&(We=b.e.offsetHeight+(H-ce.x)*(b.e.offsetHeight/b.e.offsetWidth))):(b.d==="w-resize"||b.d=="nw-resize"||b.d=="sw-resize")&&(Re=b.e.offsetLeft+(H-ce.x),Ce=b.e.offsetLeft+b.e.offsetWidth-Re,Y.shiftKey&&(We=b.e.offsetHeight-(H-ce.x)*(b.e.offsetHeight/b.e.offsetWidth))),b.d=="s-resize"||b.d=="se-resize"||b.d=="sw-resize"?We||(We=b.e.offsetHeight+(Q-ce.y)):(b.d==="n-resize"||b.d=="ne-resize"||b.d=="nw-resize")&&(pe=b.e.offsetTop+(Q-ce.y),We=b.e.offsetTop+b.e.offsetHeight-pe),pe&&(b.e.style.top=pe+"px"),Re&&(b.e.style.left=Re+"px"),Ce&&(b.e.style.width=Ce+"px"),We&&(b.e.style.height=We+"px"),typeof b.e.refresh=="function"&&(ce.actioned=!0,b.e.refresh("dimensions",Ce,We))}ce.x=H,ce.y=Q}else{let H=ae(Y),Q=at.findElement(H,"jpanel");if(Q){if(Q.classList.contains("jpanel-controls")){let Re=H.getAttribute("data-position");Re?Q.style.cursor=Re:Q.style.cursor=""}else if(Q.getAttribute("tabindex")){let Re=Q.getBoundingClientRect();Y.clientY-Re.top<F?Re.width-(Y.clientX-Re.left)<F?Q.style.cursor="ne-resize":Y.clientX-Re.left<F?Q.style.cursor="nw-resize":Q.style.cursor="n-resize":Re.height-(Y.clientY-Re.top)<F?Re.width-(Y.clientX-Re.left)<F?Q.style.cursor="se-resize":Y.clientX-Re.left<F?Q.style.cursor="sw-resize":Q.style.cursor="s-resize":Re.width-(Y.clientX-Re.left)<F?Q.style.cursor="e-resize":Y.clientX-Re.left<F?Q.style.cursor="w-resize":Q.style.cursor=""}}}};let je=["n","ne","e","se","s","sw","w","nw","rotate"];je.forEach(function(Y,oe){je[oe]=document.createElement("div"),je[oe].classList.add("jpanel-action"),Y==="rotate"?je[oe].setAttribute("data-action","rotate"):(je[oe].setAttribute("data-action","resize"),je[oe].setAttribute("data-position",Y+"-resize"))});let ke;const et=function(Y){let oe=ae(Y),Te=at.findElement(oe,"jpanel");Te&&!Te.classList.contains("readonly")&&Te.classList.contains("jpanel-controls")?(Te.append(...je),Te.classList.contains("jpanel-rotate")||je[je.length-1].remove(),ke=Te):pt()},pt=function(Y){ke&&(je.forEach(function(oe){oe.remove()}),ke=null)},A=function(Y){var Te=ae(Y).getAttribute("data-tooltip");if(Te){if(Fe.innerText=Te,Y.changedTouches&&Y.changedTouches[0])var ee=Y.changedTouches[0].clientX,ye=Y.changedTouches[0].clientY;else var ee=Y.clientX,ye=Y.clientY;Fe.style.top=ye+"px",Fe.style.left=ee+"px",document.body.appendChild(Fe)}else Fe.innerText&&(Fe.innerText="",document.body.removeChild(Fe))},K=function(Y){var oe=document.activeElement;if(oe&&typeof oe.contextmenu=="function")oe.contextmenu(Y),Y.preventDefault(),Y.stopImmediatePropagation();else if(oe=at.findElement(Y.target,function(ee){return ee.tagName&&ee.getAttribute("aria-contextmenu-id")}),oe){var Te=document.querySelector("#"+oe);Te?(Te.contextmenu.open(Y),Y.preventDefault(),Y.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+oe)}},L=function(Y){let oe=document.activeElement;oe&&Y.key==="Delete"&&typeof oe.delete=="function"&&(oe.delete(),Y.preventDefault(),Y.stopImmediatePropagation());let Te=window.jSuitesStateControl;Te&&Te.length>0&&(oe=Te[Te.length-1],oe&&Y.key==="Escape"&&typeof oe.isOpened=="function"&&typeof oe.close=="function"&&oe.isOpened()&&(oe.close(),Y.preventDefault(),Y.stopImmediatePropagation()))},j=function(Y){(Y.target.getAttribute("data-mask")||Y.target.mask)&&at.mask(Y)};document.addEventListener("focusin",et),document.addEventListener("mouseup",he),document.addEventListener("mousedown",re),document.addEventListener("mousemove",Ae),document.addEventListener("mouseover",A),document.addEventListener("keydown",L),document.addEventListener("contextmenu",K),document.addEventListener("input",j)}();var bt=at})(),t=a.default}(),t})}(jsuites$1)),jsuites$1.exports}var dist$2={exports:{}},dist$1=dist$2.exports,hasRequiredDist$1;function requireDist$1(){return hasRequiredDist$1||(hasRequiredDist$1=1,function(r,e){(function(t,n){r.exports=n()})(dist$1,function(){var t;return function(){var n={765:function(l,u){var c;c=function(d){d.version="1.0.2";var f=Math;function C(Pe,_e){for(var Oe=0,st=0;Oe<Pe.length;++Oe)st=_e*st+Pe[Oe];return st}function m(Pe,_e,Oe,st,rt){if(_e===0)return Oe;if(_e===1)return st;for(var U=2/Pe,te=st,V=1;V<_e;++V)te=st*V*U+rt*Oe,Oe=st,st=te;return te}function E(Pe,_e,Oe,st,rt){return function(U,te){if(st){if(U===0)return st==1?-1/0:1/0;if(U<0)return NaN}return te===0?Pe(U):te===1?_e(U):te<0?NaN:m(U,te|=0,Pe(U),_e(U),rt)}}var v,_,T,R,O,N,G,D,k,z,ne,Z,ve,xe=function(){var Pe=.636619772,_e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Oe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),st=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),rt=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function U(Ue){var Ie=0,Ke=0,le=0,ge=Ue*Ue;if(Ue<8)Ie=(Ke=C(_e,ge))/(le=C(Oe,ge));else{var we=Ue-.785398164;Ke=C(st,ge=64/ge),le=C(rt,ge),Ie=f.sqrt(Pe/Ue)*(f.cos(we)*Ke-f.sin(we)*le*8/Ue)}return Ie}var te=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),V=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),ue=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ne=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Ge(Ue){var Ie=0,Ke=0,le=0,ge=Ue*Ue,we=f.abs(Ue)-2.356194491;return Math.abs(Ue)<8?Ie=(Ke=Ue*C(te,ge))/(le=C(V,ge)):(Ke=C(ue,ge=64/ge),le=C(Ne,ge),Ie=f.sqrt(Pe/f.abs(Ue))*(f.cos(we)*Ke-f.sin(we)*le*8/f.abs(Ue)),Ue<0&&(Ie=-Ie)),Ie}return function Ue(Ie,Ke){if(Ke=Math.round(Ke),!isFinite(Ie))return isNaN(Ie)?Ie:0;if(Ke<0)return(Ke%2?-1:1)*Ue(Ie,-Ke);if(Ie<0)return(Ke%2?-1:1)*Ue(-Ie,Ke);if(Ke===0)return U(Ie);if(Ke===1)return Ge(Ie);if(Ie===0)return 0;var le=0;if(Ie>Ke)le=m(Ie,Ke,U(Ie),Ge(Ie),-1);else{for(var ge=!1,we=0,qe=0,$e=1,ze=0,it=2/Ie,Ve=2*f.floor((Ke+f.floor(f.sqrt(40*Ke)))/2);Ve>0;Ve--)ze=Ve*it*$e-we,we=$e,$e=ze,f.abs($e)>1e10&&($e*=1e-10,we*=1e-10,le*=1e-10,qe*=1e-10),ge&&(qe+=$e),ge=!ge,Ve==Ke&&(le=we);le/=qe=2*qe-$e}return le}}(),de=(v=.636619772,_=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),T=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),R=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),O=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),N=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),G=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),D=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),k=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),E(function(Pe){var _e=0,Oe=0,st=0,rt=Pe*Pe,U=Pe-.785398164;return Pe<8?_e=(Oe=C(_,rt))/(st=C(T,rt))+v*xe(Pe,0)*f.log(Pe):(Oe=C(R,rt=64/rt),st=C(O,rt),_e=f.sqrt(v/Pe)*(f.sin(U)*Oe+f.cos(U)*st*8/Pe)),_e},function(Pe){var _e=0,Oe=0,st=0,rt=Pe*Pe,U=Pe-2.356194491;return Pe<8?_e=(Oe=Pe*C(N,rt))/(st=C(G,rt))+v*(xe(Pe,1)*f.log(Pe)-1/Pe):(Oe=C(D,rt=64/rt),st=C(k,rt),_e=f.sqrt(v/Pe)*(f.sin(U)*Oe+f.cos(U)*st*8/Pe)),_e},0,1,-1)),Se=(z=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),ne=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Z=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ve=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function Pe(_e,Oe){if((Oe=Math.round(Oe))===0)return function(Ne){return Ne<=3.75?C(z,Ne*Ne/14.0625):f.exp(f.abs(Ne))/f.sqrt(f.abs(Ne))*C(ne,3.75/f.abs(Ne))}(_e);if(Oe===1)return function(Ne){return Ne<3.75?Ne*C(Z,Ne*Ne/14.0625):(Ne<0?-1:1)*f.exp(f.abs(Ne))/f.sqrt(f.abs(Ne))*C(ve,3.75/f.abs(Ne))}(_e);if(Oe<0)return NaN;if(f.abs(_e)===0)return 0;if(_e==1/0)return 1/0;var st,rt=0,U=2/f.abs(_e),te=0,V=1,ue=0;for(st=2*f.round((Oe+f.round(f.sqrt(40*Oe)))/2);st>0;st--)ue=st*U*V+te,te=V,V=ue,f.abs(V)>1e10&&(V*=1e-10,te*=1e-10,rt*=1e-10),st==Oe&&(rt=te);return rt*=Pe(_e,0)/V,_e<0&&Oe%2?-rt:rt}),Me=function(){var Pe=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),_e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Oe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),st=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return E(function(rt){return rt<=2?-f.log(rt/2)*Se(rt,0)+C(Pe,rt*rt/4):f.exp(-rt)/f.sqrt(rt)*C(_e,2/rt)},function(rt){return rt<=2?f.log(rt/2)*Se(rt,1)+1/rt*C(Oe,rt*rt/4):f.exp(-rt)/f.sqrt(rt)*C(st,2/rt)},0,2,1)}();d.besselj=xe,d.bessely=de,d.besseli=Se,d.besselk=Me},c(typeof DO_NOT_EXPORT_BESSEL>"u"?u:{})},162:function(l){var u;l.exports=(u=function(c,d){var f=Array.prototype.concat,C=Array.prototype.slice,m=Object.prototype.toString;function E(k,z){var ne=k>z?k:z;return c.pow(10,17-~~(c.log(ne>0?ne:-ne)*c.LOG10E))}var v=Array.isArray||function(k){return m.call(k)==="[object Array]"};function _(k){return m.call(k)==="[object Function]"}function T(k){return typeof k=="number"&&k-k==0}function R(){return new R._init(arguments)}function O(){return 0}function N(){return 1}function G(k,z){return k===z?1:0}R.fn=R.prototype,R._init=function(k){if(v(k[0]))if(v(k[0][0])){_(k[1])&&(k[0]=R.map(k[0],k[1]));for(var z=0;z<k[0].length;z++)this[z]=k[0][z];this.length=k[0].length}else this[0]=_(k[1])?R.map(k[0],k[1]):k[0],this.length=1;else if(T(k[0]))this[0]=R.seq.apply(null,k),this.length=1;else{if(k[0]instanceof R)return R(k[0].toArray());this[0]=[],this.length=1}return this},R._init.prototype=R.prototype,R._init.constructor=R,R.utils={calcRdx:E,isArray:v,isFunction:_,isNumber:T,toVector:function(k){return f.apply([],k)}},R._random_fn=c.random,R.setRandom=function(k){if(typeof k!="function")throw new TypeError("fn is not a function");R._random_fn=k},R.extend=function(k){var z,ne;if(arguments.length===1){for(ne in k)R[ne]=k[ne];return this}for(z=1;z<arguments.length;z++)for(ne in arguments[z])k[ne]=arguments[z][ne];return k},R.rows=function(k){return k.length||1},R.cols=function(k){return k[0].length||1},R.dimensions=function(k){return{rows:R.rows(k),cols:R.cols(k)}},R.row=function(k,z){return v(z)?z.map(function(ne){return R.row(k,ne)}):k[z]},R.rowa=function(k,z){return R.row(k,z)},R.col=function(k,z){if(v(z)){var ne=R.arange(k.length).map(function(){return new Array(z.length)});return z.forEach(function(xe,de){R.arange(k.length).forEach(function(Se){ne[Se][de]=k[Se][xe]})}),ne}for(var Z=new Array(k.length),ve=0;ve<k.length;ve++)Z[ve]=[k[ve][z]];return Z},R.cola=function(k,z){return R.col(k,z).map(function(ne){return ne[0]})},R.diag=function(k){for(var z=R.rows(k),ne=new Array(z),Z=0;Z<z;Z++)ne[Z]=[k[Z][Z]];return ne},R.antidiag=function(k){for(var z=R.rows(k)-1,ne=new Array(z),Z=0;z>=0;z--,Z++)ne[Z]=[k[Z][z]];return ne},R.transpose=function(k){var z,ne,Z,ve,xe,de=[];for(v(k[0])||(k=[k]),ne=k.length,Z=k[0].length,xe=0;xe<Z;xe++){for(z=new Array(ne),ve=0;ve<ne;ve++)z[ve]=k[ve][xe];de.push(z)}return de.length===1?de[0]:de},R.map=function(k,z,ne){var Z,ve,xe,de,Se;for(v(k[0])||(k=[k]),ve=k.length,xe=k[0].length,de=ne?k:new Array(ve),Z=0;Z<ve;Z++)for(de[Z]||(de[Z]=new Array(xe)),Se=0;Se<xe;Se++)de[Z][Se]=z(k[Z][Se],Z,Se);return de.length===1?de[0]:de},R.cumreduce=function(k,z,ne){var Z,ve,xe,de,Se;for(v(k[0])||(k=[k]),ve=k.length,xe=k[0].length,de=ne?k:new Array(ve),Z=0;Z<ve;Z++)for(de[Z]||(de[Z]=new Array(xe)),xe>0&&(de[Z][0]=k[Z][0]),Se=1;Se<xe;Se++)de[Z][Se]=z(de[Z][Se-1],k[Z][Se]);return de.length===1?de[0]:de},R.alter=function(k,z){return R.map(k,z,!0)},R.create=function(k,z,ne){var Z,ve,xe=new Array(k);for(_(z)&&(ne=z,z=k),Z=0;Z<k;Z++)for(xe[Z]=new Array(z),ve=0;ve<z;ve++)xe[Z][ve]=ne(Z,ve);return xe},R.zeros=function(k,z){return T(z)||(z=k),R.create(k,z,O)},R.ones=function(k,z){return T(z)||(z=k),R.create(k,z,N)},R.rand=function(k,z){return T(z)||(z=k),R.create(k,z,R._random_fn)},R.identity=function(k,z){return T(z)||(z=k),R.create(k,z,G)},R.symmetric=function(k){var z,ne,Z=k.length;if(k.length!==k[0].length)return!1;for(z=0;z<Z;z++)for(ne=0;ne<Z;ne++)if(k[ne][z]!==k[z][ne])return!1;return!0},R.clear=function(k){return R.alter(k,O)},R.seq=function(k,z,ne,Z){_(Z)||(Z=!1);var ve,xe=[],de=E(k,z),Se=(z*de-k*de)/((ne-1)*de),Me=k;for(ve=0;Me<=z&&ve<ne;Me=(k*de+Se*de*++ve)/de)xe.push(Z?Z(Me,ve):Me);return xe},R.arange=function(k,z,ne){var Z,ve=[];if(ne=ne||1,z===d&&(z=k,k=0),k===z||ne===0)return[];if(k<z&&ne<0)return[];if(k>z&&ne>0)return[];if(ne>0)for(Z=k;Z<z;Z+=ne)ve.push(Z);else for(Z=k;Z>z;Z+=ne)ve.push(Z);return ve},R.slice=function(){function k(z,ne,Z,ve){var xe,de=[],Se=z.length;if(ne===d&&Z===d&&ve===d)return R.copy(z);if(ve=ve||1,(ne=(ne=ne||0)>=0?ne:Se+ne)===(Z=(Z=Z||z.length)>=0?Z:Se+Z)||ve===0)return[];if(ne<Z&&ve<0)return[];if(ne>Z&&ve>0)return[];if(ve>0)for(xe=ne;xe<Z;xe+=ve)de.push(z[xe]);else for(xe=ne;xe>Z;xe+=ve)de.push(z[xe]);return de}return function(z,ne){var Z,ve;return T((ne=ne||{}).row)?T(ne.col)?z[ne.row][ne.col]:k(R.rowa(z,ne.row),(Z=ne.col||{}).start,Z.end,Z.step):T(ne.col)?k(R.cola(z,ne.col),(ve=ne.row||{}).start,ve.end,ve.step):(ve=ne.row||{},Z=ne.col||{},k(z,ve.start,ve.end,ve.step).map(function(xe){return k(xe,Z.start,Z.end,Z.step)}))}}(),R.sliceAssign=function(k,z,ne){var Z,ve;if(T(z.row)){if(T(z.col))return k[z.row][z.col]=ne;z.col=z.col||{},z.col.start=z.col.start||0,z.col.end=z.col.end||k[0].length,z.col.step=z.col.step||1,Z=R.arange(z.col.start,c.min(k.length,z.col.end),z.col.step);var xe=z.row;return Z.forEach(function(Se,Me){k[xe][Se]=ne[Me]}),k}if(T(z.col)){z.row=z.row||{},z.row.start=z.row.start||0,z.row.end=z.row.end||k.length,z.row.step=z.row.step||1,ve=R.arange(z.row.start,c.min(k[0].length,z.row.end),z.row.step);var de=z.col;return ve.forEach(function(Se,Me){k[Se][de]=ne[Me]}),k}return ne[0].length===d&&(ne=[ne]),z.row.start=z.row.start||0,z.row.end=z.row.end||k.length,z.row.step=z.row.step||1,z.col.start=z.col.start||0,z.col.end=z.col.end||k[0].length,z.col.step=z.col.step||1,ve=R.arange(z.row.start,c.min(k.length,z.row.end),z.row.step),Z=R.arange(z.col.start,c.min(k[0].length,z.col.end),z.col.step),ve.forEach(function(Se,Me){Z.forEach(function(Pe,_e){k[Se][Pe]=ne[Me][_e]})}),k},R.diagonal=function(k){var z=R.zeros(k.length,k.length);return k.forEach(function(ne,Z){z[Z][Z]=ne}),z},R.copy=function(k){return k.map(function(z){return T(z)?z:z.map(function(ne){return ne})})};var D=R.prototype;return D.length=0,D.push=Array.prototype.push,D.sort=Array.prototype.sort,D.splice=Array.prototype.splice,D.slice=Array.prototype.slice,D.toArray=function(){return this.length>1?C.call(this):C.call(this)[0]},D.map=function(k,z){return R(R.map(this,k,z))},D.cumreduce=function(k,z){return R(R.cumreduce(this,k,z))},D.alter=function(k){return R.alter(this,k),this},function(k){for(var z=0;z<k.length;z++)(function(ne){D[ne]=function(Z){var ve,xe=this;return Z?(setTimeout(function(){Z.call(xe,D[ne].call(xe))}),this):(ve=R[ne](this),v(ve)?R(ve):ve)}})(k[z])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(k){for(var z=0;z<k.length;z++)(function(ne){D[ne]=function(Z,ve){var xe=this;return ve?(setTimeout(function(){ve.call(xe,D[ne].call(xe,Z))}),this):R(R[ne](this,Z))}})(k[z])}("row col".split(" ")),function(k){for(var z=0;z<k.length;z++)(function(ne){D[ne]=function(){return R(R[ne].apply(null,arguments))}})(k[z])}("create zeros ones rand identity".split(" ")),R}(Math),function(c,d){var f=c.utils.isFunction;function C(v,_){return v-_}function m(v,_,T){return d.max(_,d.min(v,T))}c.sum=function(v){for(var _=0,T=v.length;--T>=0;)_+=v[T];return _},c.sumsqrd=function(v){for(var _=0,T=v.length;--T>=0;)_+=v[T]*v[T];return _},c.sumsqerr=function(v){for(var _,T=c.mean(v),R=0,O=v.length;--O>=0;)R+=(_=v[O]-T)*_;return R},c.sumrow=function(v){for(var _=0,T=v.length;--T>=0;)_+=v[T];return _},c.product=function(v){for(var _=1,T=v.length;--T>=0;)_*=v[T];return _},c.min=function(v){for(var _=v[0],T=0;++T<v.length;)v[T]<_&&(_=v[T]);return _},c.max=function(v){for(var _=v[0],T=0;++T<v.length;)v[T]>_&&(_=v[T]);return _},c.unique=function(v){for(var _={},T=[],R=0;R<v.length;R++)_[v[R]]||(_[v[R]]=!0,T.push(v[R]));return T},c.mean=function(v){return c.sum(v)/v.length},c.meansqerr=function(v){return c.sumsqerr(v)/v.length},c.geomean=function(v){var _=v.map(d.log),T=c.mean(_);return d.exp(T)},c.median=function(v){var _=v.length,T=v.slice().sort(C);return 1&_?T[_/2|0]:(T[_/2-1]+T[_/2])/2},c.cumsum=function(v){return c.cumreduce(v,function(_,T){return _+T})},c.cumprod=function(v){return c.cumreduce(v,function(_,T){return _*T})},c.diff=function(v){var _,T=[],R=v.length;for(_=1;_<R;_++)T.push(v[_]-v[_-1]);return T},c.rank=function(v){var _,T=[],R={};for(_=0;_<v.length;_++)R[D=v[_]]?R[D]++:(R[D]=1,T.push(D));var O=T.sort(C),N={},G=1;for(_=0;_<O.length;_++){var D,k=R[D=O[_]],z=(G+(G+k-1))/2;N[D]=z,G+=k}return v.map(function(ne){return N[ne]})},c.mode=function(v){var _,T=v.length,R=v.slice().sort(C),O=1,N=0,G=0,D=[];for(_=0;_<T;_++)R[_]===R[_+1]?O++:(O>N?(D=[R[_]],N=O,G=0):O===N&&(D.push(R[_]),G++),O=1);return G===0?D[0]:D},c.range=function(v){return c.max(v)-c.min(v)},c.variance=function(v,_){return c.sumsqerr(v)/(v.length-(_?1:0))},c.pooledvariance=function(v){return v.reduce(function(_,T){return _+c.sumsqerr(T)},0)/(v.reduce(function(_,T){return _+T.length},0)-v.length)},c.deviation=function(v){for(var _=c.mean(v),T=v.length,R=new Array(T),O=0;O<T;O++)R[O]=v[O]-_;return R},c.stdev=function(v,_){return d.sqrt(c.variance(v,_))},c.pooledstdev=function(v){return d.sqrt(c.pooledvariance(v))},c.meandev=function(v){for(var _=c.mean(v),T=[],R=v.length-1;R>=0;R--)T.push(d.abs(v[R]-_));return c.mean(T)},c.meddev=function(v){for(var _=c.median(v),T=[],R=v.length-1;R>=0;R--)T.push(d.abs(v[R]-_));return c.median(T)},c.coeffvar=function(v){return c.stdev(v)/c.mean(v)},c.quartiles=function(v){var _=v.length,T=v.slice().sort(C);return[T[d.round(_/4)-1],T[d.round(_/2)-1],T[d.round(3*_/4)-1]]},c.quantiles=function(v,_,T,R){var O,N,G,D,k,z=v.slice().sort(C),ne=[_.length],Z=v.length;for(T===void 0&&(T=.375),R===void 0&&(R=.375),O=0;O<_.length;O++)G=Z*(N=_[O])+(T+N*(1-T-R)),D=d.floor(m(G,1,Z-1)),k=m(G-D,0,1),ne[O]=(1-k)*z[D-1]+k*z[D];return ne},c.percentile=function(v,_,T){var R=v.slice().sort(C),O=_*(R.length+(T?1:-1))+(T?0:1),N=parseInt(O),G=O-N;return N+1<R.length?R[N-1]+G*(R[N]-R[N-1]):R[N-1]},c.percentileOfScore=function(v,_,T){var R,O,N=0,G=v.length,D=!1;for(T==="strict"&&(D=!0),O=0;O<G;O++)R=v[O],(D&&R<_||!D&&R<=_)&&N++;return N/G},c.histogram=function(v,_){_=_||4;var T,R=c.min(v),O=(c.max(v)-R)/_,N=v.length,G=[];for(T=0;T<_;T++)G[T]=0;for(T=0;T<N;T++)G[d.min(d.floor((v[T]-R)/O),_-1)]+=1;return G},c.covariance=function(v,_){var T,R=c.mean(v),O=c.mean(_),N=v.length,G=new Array(N);for(T=0;T<N;T++)G[T]=(v[T]-R)*(_[T]-O);return c.sum(G)/(N-1)},c.corrcoeff=function(v,_){return c.covariance(v,_)/c.stdev(v,1)/c.stdev(_,1)},c.spearmancoeff=function(v,_){return v=c.rank(v),_=c.rank(_),c.corrcoeff(v,_)},c.stanMoment=function(v,_){for(var T=c.mean(v),R=c.stdev(v),O=v.length,N=0,G=0;G<O;G++)N+=d.pow((v[G]-T)/R,_);return N/v.length},c.skewness=function(v){return c.stanMoment(v,3)},c.kurtosis=function(v){return c.stanMoment(v,4)-3};var E=c.prototype;(function(v){for(var _=0;_<v.length;_++)(function(T){E[T]=function(R,O){var N=[],G=0,D=this;if(f(R)&&(O=R,R=!1),O)return setTimeout(function(){O.call(D,E[T].call(D,R))}),this;if(this.length>1){for(D=R===!0?this:this.transpose();G<D.length;G++)N[G]=c[T](D[G]);return N}return c[T](this[0],R)}})(v[_])})("cumsum cumprod".split(" ")),function(v){for(var _=0;_<v.length;_++)(function(T){E[T]=function(R,O){var N=[],G=0,D=this;if(f(R)&&(O=R,R=!1),O)return setTimeout(function(){O.call(D,E[T].call(D,R))}),this;if(this.length>1){for(T!=="sumrow"&&(D=R===!0?this:this.transpose());G<D.length;G++)N[G]=c[T](D[G]);return R===!0?c[T](c.utils.toVector(N)):N}return c[T](this[0],R)}})(v[_])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(v){for(var _=0;_<v.length;_++)(function(T){E[T]=function(){var R,O=[],N=0,G=this,D=Array.prototype.slice.call(arguments);if(f(D[D.length-1])){R=D[D.length-1];var k=D.slice(0,D.length-1);return setTimeout(function(){R.call(G,E[T].apply(G,k))}),this}R=void 0;var z=function(ne){return c[T].apply(G,[ne].concat(D))};if(this.length>1){for(G=G.transpose();N<G.length;N++)O[N]=z(G[N]);return O}return z(this[0])}})(v[_])}("quantiles percentileOfScore".split(" "))}(u,Math),function(c,d){c.gammaln=function(f){var C,m,E,v=0,_=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],T=1.000000000190015;for(E=(m=C=f)+5.5,E-=(C+.5)*d.log(E);v<6;v++)T+=_[v]/++m;return d.log(2.5066282746310007*T/C)-E},c.loggam=function(f){var C,m,E,v,_,T,R,O=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(C=f,R=0,f==1||f==2)return 0;for(f<=7&&(C=f+(R=d.floor(7-f))),m=1/(C*C),E=2*d.PI,_=O[9],T=8;T>=0;T--)_*=m,_+=O[T];if(v=_/C+.5*d.log(E)+(C-.5)*d.log(C)-C,f<=7)for(T=1;T<=R;T++)v-=d.log(C-1),C-=1;return v},c.gammafn=function(f){var C,m,E,v,_=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],T=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],R=!1,O=0,N=0,G=0,D=f;if(f>171.6243769536076)return 1/0;if(D<=0){if(!(v=D%1+36e-17))return 1/0;R=(1&D?-1:1)*d.PI/d.sin(d.PI*v),D=1-D}for(E=D,m=D<1?D++:(D-=O=(0|D)-1)-1,C=0;C<8;++C)G=(G+_[C])*m,N=N*m+T[C];if(v=G/N+1,E<D)v/=E;else if(E>D)for(C=0;C<O;++C)v*=D,D++;return R&&(v=R/v),v},c.gammap=function(f,C){return c.lowRegGamma(f,C)*c.gammafn(f)},c.lowRegGamma=function(f,C){var m,E=c.gammaln(f),v=f,_=1/f,T=_,R=C+1-f,O=1/1e-30,N=1/R,G=N,D=1,k=-~(8.5*d.log(f>=1?f:1/f)+.4*f+17);if(C<0||f<=0)return NaN;if(C<f+1){for(;D<=k;D++)_+=T*=C/++v;return _*d.exp(-C+f*d.log(C)-E)}for(;D<=k;D++)G*=(N=1/(N=(m=-D*(D-f))*N+(R+=2)))*(O=R+m/O);return 1-G*d.exp(-C+f*d.log(C)-E)},c.factorialln=function(f){return f<0?NaN:c.gammaln(f+1)},c.factorial=function(f){return f<0?NaN:c.gammafn(f+1)},c.combination=function(f,C){return f>170||C>170?d.exp(c.combinationln(f,C)):c.factorial(f)/c.factorial(C)/c.factorial(f-C)},c.combinationln=function(f,C){return c.factorialln(f)-c.factorialln(C)-c.factorialln(f-C)},c.permutation=function(f,C){return c.factorial(f)/c.factorial(f-C)},c.betafn=function(f,C){if(!(f<=0||C<=0))return f+C>170?d.exp(c.betaln(f,C)):c.gammafn(f)*c.gammafn(C)/c.gammafn(f+C)},c.betaln=function(f,C){return c.gammaln(f)+c.gammaln(C)-c.gammaln(f+C)},c.betacf=function(f,C,m){var E,v,_,T,R=1e-30,O=1,N=C+m,G=C+1,D=C-1,k=1,z=1-N*f/G;for(d.abs(z)<R&&(z=R),T=z=1/z;O<=100&&(z=1+(v=O*(m-O)*f/((D+(E=2*O))*(C+E)))*z,d.abs(z)<R&&(z=R),k=1+v/k,d.abs(k)<R&&(k=R),T*=(z=1/z)*k,z=1+(v=-(C+O)*(N+O)*f/((C+E)*(G+E)))*z,d.abs(z)<R&&(z=R),k=1+v/k,d.abs(k)<R&&(k=R),T*=_=(z=1/z)*k,!(d.abs(_-1)<3e-7));O++);return T},c.gammapinv=function(f,C){var m,E,v,_,T,R,O=0,N=C-1,G=c.gammaln(C);if(f>=1)return d.max(100,C+100*d.sqrt(C));if(f<=0)return 0;for(C>1?(T=d.log(N),R=d.exp(N*(T-1)-G),_=f<.5?f:1-f,m=(2.30753+.27061*(E=d.sqrt(-2*d.log(_))))/(1+E*(.99229+.04481*E))-E,f<.5&&(m=-m),m=d.max(.001,C*d.pow(1-1/(9*C)-m/(3*d.sqrt(C)),3))):m=f<(E=1-C*(.253+.12*C))?d.pow(f/E,1/C):1-d.log(1-(f-E)/(1-E));O<12;O++){if(m<=0)return 0;if((m-=E=(v=(c.lowRegGamma(C,m)-f)/(E=C>1?R*d.exp(-(m-N)+N*(d.log(m)-T)):d.exp(-m+N*d.log(m)-G)))/(1-.5*d.min(1,v*((C-1)/m-1))))<=0&&(m=.5*(m+E)),d.abs(E)<1e-8*m)break}return m},c.erf=function(f){var C,m,E,v,_=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],T=_.length-1,R=!1,O=0,N=0;for(f<0&&(f=-f,R=!0),m=4*(C=2/(2+f))-2;T>0;T--)E=O,O=m*O-N+_[T],N=E;return v=C*d.exp(-f*f+.5*(_[0]+m*O)-N),R?v-1:1-v},c.erfc=function(f){return 1-c.erf(f)},c.erfcinv=function(f){var C,m,E,v,_=0;if(f>=2)return-100;if(f<=0)return 100;for(v=f<1?f:2-f,C=-.70711*((2.30753+.27061*(E=d.sqrt(-2*d.log(v/2))))/(1+E*(.99229+.04481*E))-E);_<2;_++)C+=(m=c.erfc(C)-v)/(1.1283791670955126*d.exp(-C*C)-C*m);return f<1?C:-C},c.ibetainv=function(f,C,m){var E,v,_,T,R,O,N,G,D,k,z=C-1,ne=m-1,Z=0;if(f<=0)return 0;if(f>=1)return 1;for(C>=1&&m>=1?(_=f<.5?f:1-f,O=(2.30753+.27061*(T=d.sqrt(-2*d.log(_))))/(1+T*(.99229+.04481*T))-T,f<.5&&(O=-O),N=(O*O-3)/6,G=2/(1/(2*C-1)+1/(2*m-1)),D=O*d.sqrt(N+G)/G-(1/(2*m-1)-1/(2*C-1))*(N+.8333333333333334-2/(3*G)),O=C/(C+m*d.exp(2*D))):(E=d.log(C/(C+m)),v=d.log(m/(C+m)),O=f<(T=d.exp(C*E)/C)/(D=T+(R=d.exp(m*v)/m))?d.pow(C*D*f,1/C):1-d.pow(m*D*(1-f),1/m)),k=-c.gammaln(C)-c.gammaln(m)+c.gammaln(C+m);Z<10;Z++){if(O===0||O===1)return O;if((O-=T=(R=(c.ibeta(O,C,m)-f)/(T=d.exp(z*d.log(O)+ne*d.log(1-O)+k)))/(1-.5*d.min(1,R*(z/O-ne/(1-O)))))<=0&&(O=.5*(O+T)),O>=1&&(O=.5*(O+T+1)),d.abs(T)<1e-8*O&&Z>0)break}return O},c.ibeta=function(f,C,m){var E=f===0||f===1?0:d.exp(c.gammaln(C+m)-c.gammaln(C)-c.gammaln(m)+C*d.log(f)+m*d.log(1-f));return!(f<0||f>1)&&(f<(C+1)/(C+m+2)?E*c.betacf(f,C,m)/C:1-E*c.betacf(1-f,m,C)/m)},c.randn=function(f,C){var m,E,v,_,T;if(C||(C=f),f)return c.create(f,C,function(){return c.randn()});do m=c._random_fn(),E=1.7156*(c._random_fn()-.5),T=(v=m-.449871)*v+(_=d.abs(E)+.386595)*(.196*_-.25472*v);while(T>.27597&&(T>.27846||E*E>-4*d.log(m)*m*m));return E/m},c.randg=function(f,C,m){var E,v,_,T,R,O,N=f;if(m||(m=C),f||(f=1),C)return(O=c.zeros(C,m)).alter(function(){return c.randg(f)}),O;f<1&&(f+=1),E=f-.3333333333333333,v=1/d.sqrt(9*E);do{do T=1+v*(R=c.randn());while(T<=0);T*=T*T,_=c._random_fn()}while(_>1-.331*d.pow(R,4)&&d.log(_)>.5*R*R+E*(1-T+d.log(T)));if(f==N)return E*T;do _=c._random_fn();while(_===0);return d.pow(_,1/N)*E*T},function(f){for(var C=0;C<f.length;C++)(function(m){c.fn[m]=function(){return c(c.map(this,function(E){return c[m](E)}))}})(f[C])}("gammaln gammafn factorial factorialln".split(" ")),function(f){for(var C=0;C<f.length;C++)(function(m){c.fn[m]=function(){return c(c[m].apply(null,arguments))}})(f[C])}("randn".split(" "))}(u,Math),function(c,d){function f(m,E,v,_){for(var T,R=0,O=1,N=1,G=1,D=0,k=0;d.abs((N-k)/N)>_;)k=N,O=G+(T=-(E+D)*(E+v+D)*m/(E+2*D)/(E+2*D+1))*O,N=(R=N+T*R)+(T=(D+=1)*(v-D)*m/(E+2*D-1)/(E+2*D))*N,R/=G=O+T*G,O/=G,N/=G,G=1;return N/E}function C(m,E,v){var _=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],T=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],R=.5*m;if(R>=8)return 1;var O,N=2*c.normal.cdf(R,0,1,1,0)-1;N=N>=d.exp(-50/v)?d.pow(N,v):0;for(var G=R,D=(8-R)/(O=m>3?2:3),k=G+D,z=0,ne=v-1,Z=1;Z<=O;Z++){for(var ve=0,xe=.5*(k+G),de=.5*(k-G),Se=1;Se<=12;Se++){var Me,Pe=xe+de*(6<Se?_[(Me=12-Se+1)-1]:-_[(Me=Se)-1]),_e=Pe*Pe;if(_e>60)break;var Oe=2*c.normal.cdf(Pe,0,1,1,0)*.5-2*c.normal.cdf(Pe,m,1,1,0)*.5;Oe>=d.exp(-30/ne)&&(ve+=Oe=T[Me-1]*d.exp(-.5*_e)*d.pow(Oe,ne))}z+=ve*=2*de*v/d.sqrt(2*d.PI),G=k,k+=D}return(N+=z)<=d.exp(-30/E)?0:(N=d.pow(N,E))>=1?1:N}(function(m){for(var E=0;E<m.length;E++)(function(v){c[v]=function _(T,R,O){return this instanceof _?(this._a=T,this._b=R,this._c=O,this):new _(T,R,O)},c.fn[v]=function(_,T,R){var O=c[v](_,T,R);return O.data=this,O},c[v].prototype.sample=function(_){var T=this._a,R=this._b,O=this._c;return _?c.alter(_,function(){return c[v].sample(T,R,O)}):c[v].sample(T,R,O)},function(_){for(var T=0;T<_.length;T++)(function(R){c[v].prototype[R]=function(O){var N=this._a,G=this._b,D=this._c;return O||O===0||(O=this.data),typeof O!="number"?c.fn.map.call(O,function(k){return c[v][R](k,N,G,D)}):c[v][R](O,N,G,D)}})(_[T])}("pdf cdf inv".split(" ")),function(_){for(var T=0;T<_.length;T++)(function(R){c[v].prototype[R]=function(){return c[v][R](this._a,this._b,this._c)}})(_[T])}("mean median mode variance".split(" "))})(m[E])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),c.extend(c.beta,{pdf:function(m,E,v){return m>1||m<0?0:E==1&&v==1?1:E<512&&v<512?d.pow(m,E-1)*d.pow(1-m,v-1)/c.betafn(E,v):d.exp((E-1)*d.log(m)+(v-1)*d.log(1-m)-c.betaln(E,v))},cdf:function(m,E,v){return m>1||m<0?1*(m>1):c.ibeta(m,E,v)},inv:function(m,E,v){return c.ibetainv(m,E,v)},mean:function(m,E){return m/(m+E)},median:function(m,E){return c.ibetainv(.5,m,E)},mode:function(m,E){return(m-1)/(m+E-2)},sample:function(m,E){var v=c.randg(m);return v/(v+c.randg(E))},variance:function(m,E){return m*E/(d.pow(m+E,2)*(m+E+1))}}),c.extend(c.centralF,{pdf:function(m,E,v){var _;return m<0?0:E<=2?m===0&&E<2?1/0:m===0&&E===2?1:1/c.betafn(E/2,v/2)*d.pow(E/v,E/2)*d.pow(m,E/2-1)*d.pow(1+E/v*m,-(E+v)/2):(_=E*m/(v+m*E),E*(v/(v+m*E))/2*c.binomial.pdf((E-2)/2,(E+v-2)/2,_))},cdf:function(m,E,v){return m<0?0:c.ibeta(E*m/(E*m+v),E/2,v/2)},inv:function(m,E,v){return v/(E*(1/c.ibetainv(m,E/2,v/2)-1))},mean:function(m,E){return E>2?E/(E-2):void 0},mode:function(m,E){return m>2?E*(m-2)/(m*(E+2)):void 0},sample:function(m,E){return 2*c.randg(m/2)/m/(2*c.randg(E/2)/E)},variance:function(m,E){if(!(E<=4))return 2*E*E*(m+E-2)/(m*(E-2)*(E-2)*(E-4))}}),c.extend(c.cauchy,{pdf:function(m,E,v){return v<0?0:v/(d.pow(m-E,2)+d.pow(v,2))/d.PI},cdf:function(m,E,v){return d.atan((m-E)/v)/d.PI+.5},inv:function(m,E,v){return E+v*d.tan(d.PI*(m-.5))},median:function(m){return m},mode:function(m){return m},sample:function(m,E){return c.randn()*d.sqrt(1/(2*c.randg(.5)))*E+m}}),c.extend(c.chisquare,{pdf:function(m,E){return m<0?0:m===0&&E===2?.5:d.exp((E/2-1)*d.log(m)-m/2-E/2*d.log(2)-c.gammaln(E/2))},cdf:function(m,E){return m<0?0:c.lowRegGamma(E/2,m/2)},inv:function(m,E){return 2*c.gammapinv(m,.5*E)},mean:function(m){return m},median:function(m){return m*d.pow(1-2/(9*m),3)},mode:function(m){return m-2>0?m-2:0},sample:function(m){return 2*c.randg(m/2)},variance:function(m){return 2*m}}),c.extend(c.exponential,{pdf:function(m,E){return m<0?0:E*d.exp(-E*m)},cdf:function(m,E){return m<0?0:1-d.exp(-E*m)},inv:function(m,E){return-d.log(1-m)/E},mean:function(m){return 1/m},median:function(m){return 1/m*d.log(2)},mode:function(){return 0},sample:function(m){return-1/m*d.log(c._random_fn())},variance:function(m){return d.pow(m,-2)}}),c.extend(c.gamma,{pdf:function(m,E,v){return m<0?0:m===0&&E===1?1/v:d.exp((E-1)*d.log(m)-m/v-c.gammaln(E)-E*d.log(v))},cdf:function(m,E,v){return m<0?0:c.lowRegGamma(E,m/v)},inv:function(m,E,v){return c.gammapinv(m,E)*v},mean:function(m,E){return m*E},mode:function(m,E){if(m>1)return(m-1)*E},sample:function(m,E){return c.randg(m)*E},variance:function(m,E){return m*E*E}}),c.extend(c.invgamma,{pdf:function(m,E,v){return m<=0?0:d.exp(-(E+1)*d.log(m)-v/m-c.gammaln(E)+E*d.log(v))},cdf:function(m,E,v){return m<=0?0:1-c.lowRegGamma(E,v/m)},inv:function(m,E,v){return v/c.gammapinv(1-m,E)},mean:function(m,E){return m>1?E/(m-1):void 0},mode:function(m,E){return E/(m+1)},sample:function(m,E){return E/c.randg(m)},variance:function(m,E){if(!(m<=2))return E*E/((m-1)*(m-1)*(m-2))}}),c.extend(c.kumaraswamy,{pdf:function(m,E,v){return m===0&&E===1?v:m===1&&v===1?E:d.exp(d.log(E)+d.log(v)+(E-1)*d.log(m)+(v-1)*d.log(1-d.pow(m,E)))},cdf:function(m,E,v){return m<0?0:m>1?1:1-d.pow(1-d.pow(m,E),v)},inv:function(m,E,v){return d.pow(1-d.pow(1-m,1/v),1/E)},mean:function(m,E){return E*c.gammafn(1+1/m)*c.gammafn(E)/c.gammafn(1+1/m+E)},median:function(m,E){return d.pow(1-d.pow(2,-1/E),1/m)},mode:function(m,E){if(m>=1&&E>=1&&m!==1&&E!==1)return d.pow((m-1)/(m*E-1),1/m)},variance:function(){throw new Error("variance not yet implemented")}}),c.extend(c.lognormal,{pdf:function(m,E,v){return m<=0?0:d.exp(-d.log(m)-.5*d.log(2*d.PI)-d.log(v)-d.pow(d.log(m)-E,2)/(2*v*v))},cdf:function(m,E,v){return m<0?0:.5+.5*c.erf((d.log(m)-E)/d.sqrt(2*v*v))},inv:function(m,E,v){return d.exp(-1.4142135623730951*v*c.erfcinv(2*m)+E)},mean:function(m,E){return d.exp(m+E*E/2)},median:function(m){return d.exp(m)},mode:function(m,E){return d.exp(m-E*E)},sample:function(m,E){return d.exp(c.randn()*E+m)},variance:function(m,E){return(d.exp(E*E)-1)*d.exp(2*m+E*E)}}),c.extend(c.noncentralt,{pdf:function(m,E,v){return d.abs(v)<1e-14?c.studentt.pdf(m,E):d.abs(m)<1e-14?d.exp(c.gammaln((E+1)/2)-v*v/2-.5*d.log(d.PI*E)-c.gammaln(E/2)):E/m*(c.noncentralt.cdf(m*d.sqrt(1+2/E),E+2,v)-c.noncentralt.cdf(m,E,v))},cdf:function(m,E,v){var _=1e-14;if(d.abs(v)<_)return c.studentt.cdf(m,E);var T=!1;m<0&&(T=!0,v=-v);for(var R=c.normal.cdf(-v,0,1),O=_+1,N=O,G=m*m/(m*m+E),D=0,k=d.exp(-v*v/2),z=d.exp(-v*v/2-.5*d.log(2)-c.gammaln(1.5))*v;D<200||N>_||O>_;)N=O,D>0&&(k*=v*v/(2*D),z*=v*v/(2*(D+.5))),R+=.5*(O=k*c.beta.cdf(G,D+.5,E/2)+z*c.beta.cdf(G,D+1,E/2)),D++;return T?1-R:R}}),c.extend(c.normal,{pdf:function(m,E,v){return d.exp(-.5*d.log(2*d.PI)-d.log(v)-d.pow(m-E,2)/(2*v*v))},cdf:function(m,E,v){return .5*(1+c.erf((m-E)/d.sqrt(2*v*v)))},inv:function(m,E,v){return-1.4142135623730951*v*c.erfcinv(2*m)+E},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},sample:function(m,E){return c.randn()*E+m},variance:function(m,E){return E*E}}),c.extend(c.pareto,{pdf:function(m,E,v){return m<E?0:v*d.pow(E,v)/d.pow(m,v+1)},cdf:function(m,E,v){return m<E?0:1-d.pow(E/m,v)},inv:function(m,E,v){return E/d.pow(1-m,1/v)},mean:function(m,E){if(!(E<=1))return E*d.pow(m,E)/(E-1)},median:function(m,E){return m*(E*d.SQRT2)},mode:function(m){return m},variance:function(m,E){if(!(E<=2))return m*m*E/(d.pow(E-1,2)*(E-2))}}),c.extend(c.studentt,{pdf:function(m,E){return E=E>1e100?1e100:E,1/(d.sqrt(E)*c.betafn(.5,E/2))*d.pow(1+m*m/E,-(E+1)/2)},cdf:function(m,E){var v=E/2;return c.ibeta((m+d.sqrt(m*m+E))/(2*d.sqrt(m*m+E)),v,v)},inv:function(m,E){var v=c.ibetainv(2*d.min(m,1-m),.5*E,.5);return v=d.sqrt(E*(1-v)/v),m>.5?v:-v},mean:function(m){return m>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(m){return c.randn()*d.sqrt(m/(2*c.randg(m/2)))},variance:function(m){return m>2?m/(m-2):m>1?1/0:void 0}}),c.extend(c.weibull,{pdf:function(m,E,v){return m<0||E<0||v<0?0:v/E*d.pow(m/E,v-1)*d.exp(-d.pow(m/E,v))},cdf:function(m,E,v){return m<0?0:1-d.exp(-d.pow(m/E,v))},inv:function(m,E,v){return E*d.pow(-d.log(1-m),1/v)},mean:function(m,E){return m*c.gammafn(1+1/E)},median:function(m,E){return m*d.pow(d.log(2),1/E)},mode:function(m,E){return E<=1?0:m*d.pow((E-1)/E,1/E)},sample:function(m,E){return m*d.pow(-d.log(c._random_fn()),1/E)},variance:function(m,E){return m*m*c.gammafn(1+2/E)-d.pow(c.weibull.mean(m,E),2)}}),c.extend(c.uniform,{pdf:function(m,E,v){return m<E||m>v?0:1/(v-E)},cdf:function(m,E,v){return m<E?0:m<v?(m-E)/(v-E):1},inv:function(m,E,v){return E+m*(v-E)},mean:function(m,E){return .5*(m+E)},median:function(m,E){return c.mean(m,E)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,E){return m/2+E/2+(E/2-m/2)*(2*c._random_fn()-1)},variance:function(m,E){return d.pow(E-m,2)/12}}),c.extend(c.binomial,{pdf:function(m,E,v){return v===0||v===1?E*v===m?1:0:c.combination(E,m)*d.pow(v,m)*d.pow(1-v,E-m)},cdf:function(m,E,v){var _,T=1e-10;if(m<0)return 0;if(m>=E)return 1;if(v<0||v>1||E<=0)return NaN;var R=v,O=(m=d.floor(m))+1,N=E-m,G=O+N,D=d.exp(c.gammaln(G)-c.gammaln(N)-c.gammaln(O)+O*d.log(R)+N*d.log(1-R));return _=R<(O+1)/(G+2)?D*f(R,O,N,T):1-D*f(1-R,N,O,T),d.round(1/T*(1-_))/(1/T)}}),c.extend(c.negbin,{pdf:function(m,E,v){return m===m>>>0&&(m<0?0:c.combination(m+E-1,E-1)*d.pow(1-v,m)*d.pow(v,E))},cdf:function(m,E,v){var _=0,T=0;if(m<0)return 0;for(;T<=m;T++)_+=c.negbin.pdf(T,E,v);return _}}),c.extend(c.hypgeom,{pdf:function(m,E,v,_){if(m!=m|0)return!1;if(m<0||m<v-(E-_)||m>_||m>v)return 0;if(2*v>E)return 2*_>E?c.hypgeom.pdf(E-v-_+m,E,E-v,E-_):c.hypgeom.pdf(_-m,E,E-v,_);if(2*_>E)return c.hypgeom.pdf(v-m,E,v,E-_);if(v<_)return c.hypgeom.pdf(m,E,_,v);for(var T=1,R=0,O=0;O<m;O++){for(;T>1&&R<_;)T*=1-v/(E-R),R++;T*=(_-O)*(v-O)/((O+1)*(E-v-_+O+1))}for(;R<_;R++)T*=1-v/(E-R);return d.min(1,d.max(0,T))},cdf:function(m,E,v,_){if(m<0||m<v-(E-_))return 0;if(m>=_||m>=v)return 1;if(2*v>E)return 2*_>E?c.hypgeom.cdf(E-v-_+m,E,E-v,E-_):1-c.hypgeom.cdf(_-m-1,E,E-v,_);if(2*_>E)return 1-c.hypgeom.cdf(v-m-1,E,v,E-_);if(v<_)return c.hypgeom.cdf(m,E,_,v);for(var T=1,R=1,O=0,N=0;N<m;N++){for(;T>1&&O<_;){var G=1-v/(E-O);R*=G,T*=G,O++}T+=R*=(_-N)*(v-N)/((N+1)*(E-v-_+N+1))}for(;O<_;O++)T*=1-v/(E-O);return d.min(1,d.max(0,T))}}),c.extend(c.poisson,{pdf:function(m,E){return E<0||m%1!=0||m<0?0:d.pow(E,m)*d.exp(-E)/c.factorial(m)},cdf:function(m,E){var v=[],_=0;if(m<0)return 0;for(;_<=m;_++)v.push(c.poisson.pdf(_,E));return c.sum(v)},mean:function(m){return m},variance:function(m){return m},sampleSmall:function(m){var E=1,v=0,_=d.exp(-m);do v++,E*=c._random_fn();while(E>_);return v-1},sampleLarge:function(m){var E,v,_,T,R,O,N,G,D,k,z=m;for(T=d.sqrt(z),R=d.log(z),O=.02483*(N=.931+2.53*T)-.059,G=1.1239+1.1328/(N-3.4),D=.9277-3.6224/(N-2);;)if(v=d.random()-.5,_=d.random(),k=.5-d.abs(v),E=d.floor((2*O/k+N)*v+z+.43),k>=.07&&_<=D||!(E<0||k<.013&&_>k)&&d.log(_)+d.log(G)-d.log(O/(k*k)+N)<=E*R-z-c.loggam(E+1))return E},sample:function(m){return m<10?this.sampleSmall(m):this.sampleLarge(m)}}),c.extend(c.triangular,{pdf:function(m,E,v,_){return v<=E||_<E||_>v?NaN:m<E||m>v?0:m<_?2*(m-E)/((v-E)*(_-E)):m===_?2/(v-E):2*(v-m)/((v-E)*(v-_))},cdf:function(m,E,v,_){return v<=E||_<E||_>v?NaN:m<=E?0:m>=v?1:m<=_?d.pow(m-E,2)/((v-E)*(_-E)):1-d.pow(v-m,2)/((v-E)*(v-_))},inv:function(m,E,v,_){return v<=E||_<E||_>v?NaN:m<=(_-E)/(v-E)?E+(v-E)*d.sqrt(m*((_-E)/(v-E))):E+(v-E)*(1-d.sqrt((1-m)*(1-(_-E)/(v-E))))},mean:function(m,E,v){return(m+E+v)/3},median:function(m,E,v){return v<=(m+E)/2?E-d.sqrt((E-m)*(E-v))/d.sqrt(2):v>(m+E)/2?m+d.sqrt((E-m)*(v-m))/d.sqrt(2):void 0},mode:function(m,E,v){return v},sample:function(m,E,v){var _=c._random_fn();return _<(v-m)/(E-m)?m+d.sqrt(_*(E-m)*(v-m)):E-d.sqrt((1-_)*(E-m)*(E-v))},variance:function(m,E,v){return(m*m+E*E+v*v-m*E-m*v-E*v)/18}}),c.extend(c.arcsine,{pdf:function(m,E,v){return v<=E?NaN:m<=E||m>=v?0:2/d.PI*d.pow(d.pow(v-E,2)-d.pow(2*m-E-v,2),-.5)},cdf:function(m,E,v){return m<E?0:m<v?2/d.PI*d.asin(d.sqrt((m-E)/(v-E))):1},inv:function(m,E,v){return E+(.5-.5*d.cos(d.PI*m))*(v-E)},mean:function(m,E){return E<=m?NaN:(m+E)/2},median:function(m,E){return E<=m?NaN:(m+E)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,E){return(m+E)/2+(E-m)/2*d.sin(2*d.PI*c.uniform.sample(0,1))},variance:function(m,E){return E<=m?NaN:d.pow(E-m,2)/8}}),c.extend(c.laplace,{pdf:function(m,E,v){return v<=0?0:d.exp(-d.abs(m-E)/v)/(2*v)},cdf:function(m,E,v){return v<=0?0:m<E?.5*d.exp((m-E)/v):1-.5*d.exp(-(m-E)/v)},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},variance:function(m,E){return 2*E*E},sample:function(m,E){var v,_=c._random_fn()-.5;return m-E*((v=_)/d.abs(v))*d.log(1-2*d.abs(_))}}),c.extend(c.tukey,{cdf:function(m,E,v){var _=E,T=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],R=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(m<=0)return 0;if(v<2||_<2)return NaN;if(!Number.isFinite(m))return 1;if(v>25e3)return C(m,1,_);var O,N=.5*v,G=N*d.log(v)-v*d.log(2)-c.gammaln(N),D=N-1,k=.25*v;O=v<=100?1:v<=800?.5:v<=5e3?.25:.125,G+=d.log(O);for(var z=0,ne=1;ne<=50;ne++){for(var Z=0,ve=(2*ne-1)*O,xe=1;xe<=16;xe++){var de,Se;8<xe?(de=xe-8-1,Se=G+D*d.log(ve+T[de]*O)-(T[de]*O+ve)*k):(de=xe-1,Se=G+D*d.log(ve-T[de]*O)+(T[de]*O-ve)*k),Se>=-30&&(Z+=C(8<xe?m*d.sqrt(.5*(T[de]*O+ve)):m*d.sqrt(.5*(-T[de]*O+ve)),1,_)*R[de]*d.exp(Se))}if(ne*O>=1&&Z<=1e-14)break;z+=Z}if(Z>1e-14)throw new Error("tukey.cdf failed to converge");return z>1&&(z=1),z},inv:function(m,E,v){if(v<2||E<2)return NaN;if(m<0||m>1)return NaN;if(m===0)return 0;if(m===1)return 1/0;var _,T=function(D,k,z){var ne=.5-.5*D,Z=d.sqrt(d.log(1/(ne*ne))),ve=Z+((((-453642210148e-16*Z-.204231210125)*Z-.342242088547)*Z-1)*Z+.322232421088)/((((.0038560700634*Z+.10353775285)*Z+.531103462366)*Z+.588581570495)*Z+.099348462606);z<120&&(ve+=(ve*ve*ve+ve)/z/4);var xe=.8832-.2368*ve;return z<120&&(xe+=-1.214/z+1.208*ve/z),ve*(xe*d.log(k-1)+1.4142)}(m,E,v),R=c.tukey.cdf(T,E,v)-m;_=R>0?d.max(0,T-1):T+1;for(var O,N=c.tukey.cdf(_,E,v)-m,G=1;G<50;G++)if(O=_-N*(_-T)/(N-R),R=N,T=_,O<0&&(O=0,N=-m),N=c.tukey.cdf(O,E,v)-m,_=O,d.abs(_-T)<1e-4)return O;throw new Error("tukey.inv failed to converge")}})}(u,Math),function(c,d){var f,C,m=Array.prototype.push,E=c.utils.isArray;function v(_){return E(_)||_ instanceof c}c.extend({add:function(_,T){return v(T)?(v(T[0])||(T=[T]),c.map(_,function(R,O,N){return R+T[O][N]})):c.map(_,function(R){return R+T})},subtract:function(_,T){return v(T)?(v(T[0])||(T=[T]),c.map(_,function(R,O,N){return R-T[O][N]||0})):c.map(_,function(R){return R-T})},divide:function(_,T){return v(T)?(v(T[0])||(T=[T]),c.multiply(_,c.inv(T))):c.map(_,function(R){return R/T})},multiply:function(_,T){var R,O,N,G,D,k,z,ne;if(_.length===void 0&&T.length===void 0)return _*T;if(D=_.length,k=_[0].length,z=c.zeros(D,N=v(T)?T[0].length:k),ne=0,v(T)){for(;ne<N;ne++)for(R=0;R<D;R++){for(G=0,O=0;O<k;O++)G+=_[R][O]*T[O][ne];z[R][ne]=G}return D===1&&ne===1?z[0][0]:z}return c.map(_,function(Z){return Z*T})},outer:function(_,T){return c.multiply(_.map(function(R){return[R]}),[T])},dot:function(_,T){v(_[0])||(_=[_]),v(T[0])||(T=[T]);for(var R,O,N=_[0].length===1&&_.length!==1?c.transpose(_):_,G=T[0].length===1&&T.length!==1?c.transpose(T):T,D=[],k=0,z=N.length,ne=N[0].length;k<z;k++){for(D[k]=[],R=0,O=0;O<ne;O++)R+=N[k][O]*G[k][O];D[k]=R}return D.length===1?D[0]:D},pow:function(_,T){return c.map(_,function(R){return d.pow(R,T)})},exp:function(_){return c.map(_,function(T){return d.exp(T)})},log:function(_){return c.map(_,function(T){return d.log(T)})},abs:function(_){return c.map(_,function(T){return d.abs(T)})},norm:function(_,T){var R=0,O=0;for(isNaN(T)&&(T=2),v(_[0])&&(_=_[0]);O<_.length;O++)R+=d.pow(d.abs(_[O]),T);return d.pow(R,1/T)},angle:function(_,T){return d.acos(c.dot(_,T)/(c.norm(_)*c.norm(T)))},aug:function(_,T){var R,O=[];for(R=0;R<_.length;R++)O.push(_[R].slice());for(R=0;R<O.length;R++)m.apply(O[R],T[R]);return O},inv:function(_){for(var T,R=_.length,O=_[0].length,N=c.identity(R,O),G=c.gauss_jordan(_,N),D=[],k=0;k<R;k++)for(D[k]=[],T=O;T<G[0].length;T++)D[k][T-O]=G[k][T];return D},det:function _(T){if(T.length===2)return T[0][0]*T[1][1]-T[0][1]*T[1][0];for(var R=0,O=0;O<T.length;O++){for(var N=[],G=1;G<T.length;G++){N[G-1]=[];for(var D=0;D<T.length;D++)D<O?N[G-1][D]=T[G][D]:D>O&&(N[G-1][D-1]=T[G][D])}var k=O%2?-1:1;R+=_(N)*T[0][O]*k}return R},gauss_elimination:function(_,T){var R,O,N,G,D=0,k=0,z=_.length,ne=_[0].length,Z=1,ve=0,xe=[];for(R=(_=c.aug(_,T))[0].length,D=0;D<z;D++){for(O=_[D][D],k=D,G=D+1;G<ne;G++)O<d.abs(_[G][D])&&(O=_[G][D],k=G);if(k!=D)for(G=0;G<R;G++)N=_[D][G],_[D][G]=_[k][G],_[k][G]=N;for(k=D+1;k<z;k++)for(Z=_[k][D]/_[D][D],G=D;G<R;G++)_[k][G]=_[k][G]-Z*_[D][G]}for(D=z-1;D>=0;D--){for(ve=0,k=D+1;k<=z-1;k++)ve+=xe[k]*_[D][k];xe[D]=(_[D][R-1]-ve)/_[D][D]}return xe},gauss_jordan:function(_,T){var R,O,N,G=c.aug(_,T),D=G.length,k=G[0].length,z=0;for(O=0;O<D;O++){var ne=O;for(N=O+1;N<D;N++)d.abs(G[N][O])>d.abs(G[ne][O])&&(ne=N);var Z=G[O];for(G[O]=G[ne],G[ne]=Z,N=O+1;N<D;N++)for(z=G[N][O]/G[O][O],R=O;R<k;R++)G[N][R]-=G[O][R]*z}for(O=D-1;O>=0;O--){for(z=G[O][O],N=0;N<O;N++)for(R=k-1;R>O-1;R--)G[N][R]-=G[O][R]*G[N][O]/z;for(G[O][O]/=z,R=D;R<k;R++)G[O][R]/=z}return G},triaUpSolve:function(_,T){var R,O=_[0].length,N=c.zeros(1,O)[0],G=!1;return T[0].length!=null&&(T=T.map(function(D){return D[0]}),G=!0),c.arange(O-1,-1,-1).forEach(function(D){R=c.arange(D+1,O).map(function(k){return N[k]*_[D][k]}),N[D]=(T[D]-c.sum(R))/_[D][D]}),G?N.map(function(D){return[D]}):N},triaLowSolve:function(_,T){var R,O=_[0].length,N=c.zeros(1,O)[0],G=!1;return T[0].length!=null&&(T=T.map(function(D){return D[0]}),G=!0),c.arange(O).forEach(function(D){R=c.arange(D).map(function(k){return _[D][k]*N[k]}),N[D]=(T[D]-c.sum(R))/_[D][D]}),G?N.map(function(D){return[D]}):N},lu:function(_){var T,R=_.length,O=c.identity(R),N=c.zeros(_.length,_[0].length);return c.arange(R).forEach(function(G){N[0][G]=_[0][G]}),c.arange(1,R).forEach(function(G){c.arange(G).forEach(function(D){T=c.arange(D).map(function(k){return O[G][k]*N[k][D]}),O[G][D]=(_[G][D]-c.sum(T))/N[D][D]}),c.arange(G,R).forEach(function(D){T=c.arange(G).map(function(k){return O[G][k]*N[k][D]}),N[G][D]=_[T.length][D]-c.sum(T)})}),[O,N]},cholesky:function(_){var T,R=_.length,O=c.zeros(_.length,_[0].length);return c.arange(R).forEach(function(N){T=c.arange(N).map(function(G){return d.pow(O[N][G],2)}),O[N][N]=d.sqrt(_[N][N]-c.sum(T)),c.arange(N+1,R).forEach(function(G){T=c.arange(N).map(function(D){return O[N][D]*O[G][D]}),O[G][N]=(_[N][G]-c.sum(T))/O[N][N]})}),O},gauss_jacobi:function(_,T,R,O){for(var N,G,D,k,z=0,ne=0,Z=_.length,ve=[],xe=[],de=[];z<Z;z++)for(ve[z]=[],xe[z]=[],de[z]=[],ne=0;ne<Z;ne++)z>ne?(ve[z][ne]=_[z][ne],xe[z][ne]=de[z][ne]=0):z<ne?(xe[z][ne]=_[z][ne],ve[z][ne]=de[z][ne]=0):(de[z][ne]=_[z][ne],ve[z][ne]=xe[z][ne]=0);for(D=c.multiply(c.multiply(c.inv(de),c.add(ve,xe)),-1),G=c.multiply(c.inv(de),T),N=R,k=c.add(c.multiply(D,R),G),z=2;d.abs(c.norm(c.subtract(k,N)))>O;)N=k,k=c.add(c.multiply(D,N),G),z++;return k},gauss_seidel:function(_,T,R,O){for(var N,G,D,k,z,ne=0,Z=_.length,ve=[],xe=[],de=[];ne<Z;ne++)for(ve[ne]=[],xe[ne]=[],de[ne]=[],N=0;N<Z;N++)ne>N?(ve[ne][N]=_[ne][N],xe[ne][N]=de[ne][N]=0):ne<N?(xe[ne][N]=_[ne][N],ve[ne][N]=de[ne][N]=0):(de[ne][N]=_[ne][N],ve[ne][N]=xe[ne][N]=0);for(k=c.multiply(c.multiply(c.inv(c.add(de,ve)),xe),-1),D=c.multiply(c.inv(c.add(de,ve)),T),G=R,z=c.add(c.multiply(k,R),D),ne=2;d.abs(c.norm(c.subtract(z,G)))>O;)G=z,z=c.add(c.multiply(k,G),D),ne+=1;return z},SOR:function(_,T,R,O,N){for(var G,D,k,z,ne,Z=0,ve=_.length,xe=[],de=[],Se=[];Z<ve;Z++)for(xe[Z]=[],de[Z]=[],Se[Z]=[],G=0;G<ve;G++)Z>G?(xe[Z][G]=_[Z][G],de[Z][G]=Se[Z][G]=0):Z<G?(de[Z][G]=_[Z][G],xe[Z][G]=Se[Z][G]=0):(Se[Z][G]=_[Z][G],xe[Z][G]=de[Z][G]=0);for(z=c.multiply(c.inv(c.add(Se,c.multiply(xe,N))),c.subtract(c.multiply(Se,1-N),c.multiply(de,N))),k=c.multiply(c.multiply(c.inv(c.add(Se,c.multiply(xe,N))),T),N),D=R,ne=c.add(c.multiply(z,R),k),Z=2;d.abs(c.norm(c.subtract(ne,D)))>O;)D=ne,ne=c.add(c.multiply(z,D),k),Z++;return ne},householder:function(_){for(var T,R,O,N,G=_.length,D=_[0].length,k=0,z=[],ne=[];k<G-1;k++){for(T=0,N=k+1;N<D;N++)T+=_[N][k]*_[N][k];for(T=(_[k+1][k]>0?-1:1)*d.sqrt(T),R=d.sqrt((T*T-_[k+1][k]*T)/2),(z=c.zeros(G,1))[k+1][0]=(_[k+1][k]-T)/(2*R),O=k+2;O<G;O++)z[O][0]=_[O][k]/(2*R);ne=c.subtract(c.identity(G,D),c.multiply(c.multiply(z,c.transpose(z)),2)),_=c.multiply(ne,c.multiply(_,ne))}return _},QR:(f=c.sum,C=c.arange,function(_){var T,R,O,N=_.length,G=_[0].length,D=c.zeros(G,G);for(_=c.copy(_),R=0;R<G;R++){for(D[R][R]=d.sqrt(f(C(N).map(function(k){return _[k][R]*_[k][R]}))),T=0;T<N;T++)_[T][R]=_[T][R]/D[R][R];for(O=R+1;O<G;O++)for(D[R][O]=f(C(N).map(function(k){return _[k][R]*_[k][O]})),T=0;T<N;T++)_[T][O]=_[T][O]-_[T][R]*D[R][O]}return[_,D]}),lstsq:function(_,T){var R=!1;T[0].length===void 0&&(T=T.map(function(ve){return[ve]}),R=!0);var O=c.QR(_),N=O[0],G=O[1],D=_[0].length,k=c.slice(N,{col:{end:D}}),z=function(ve){var xe=(ve=c.copy(ve)).length,de=c.identity(xe);return c.arange(xe-1,-1,-1).forEach(function(Se){c.sliceAssign(de,{row:Se},c.divide(c.slice(de,{row:Se}),ve[Se][Se])),c.sliceAssign(ve,{row:Se},c.divide(c.slice(ve,{row:Se}),ve[Se][Se])),c.arange(Se).forEach(function(Me){var Pe=c.multiply(ve[Me][Se],-1),_e=c.slice(ve,{row:Me}),Oe=c.multiply(c.slice(ve,{row:Se}),Pe);c.sliceAssign(ve,{row:Me},c.add(_e,Oe));var st=c.slice(de,{row:Me}),rt=c.multiply(c.slice(de,{row:Se}),Pe);c.sliceAssign(de,{row:Me},c.add(st,rt))})}),de}(c.slice(G,{row:{end:D}})),ne=c.transpose(k);ne[0].length===void 0&&(ne=[ne]);var Z=c.multiply(c.multiply(z,ne),T);return Z.length===void 0&&(Z=[[Z]]),R?Z.map(function(ve){return ve[0]}):Z},jacobi:function(_){for(var T,R,O,N,G,D,k,z=1,ne=_.length,Z=c.identity(ne,ne),ve=[];z===1;){for(G=_[0][1],O=0,N=1,T=0;T<ne;T++)for(R=0;R<ne;R++)T!=R&&G<d.abs(_[T][R])&&(G=d.abs(_[T][R]),O=T,N=R);for(D=_[O][O]===_[N][N]?_[O][N]>0?d.PI/4:-d.PI/4:d.atan(2*_[O][N]/(_[O][O]-_[N][N]))/2,(k=c.identity(ne,ne))[O][O]=d.cos(D),k[O][N]=-d.sin(D),k[N][O]=d.sin(D),k[N][N]=d.cos(D),Z=c.multiply(Z,k),_=c.multiply(c.multiply(c.inv(k),_),k),z=0,T=1;T<ne;T++)for(R=1;R<ne;R++)T!=R&&d.abs(_[T][R])>.001&&(z=1)}for(T=0;T<ne;T++)ve.push(_[T][T]);return[Z,ve]},rungekutta:function(_,T,R,O,N,G){var D,k,z;if(G===2)for(;O<=R;)N+=((D=T*_(O,N))+(k=T*_(O+T,N+D)))/2,O+=T;if(G===4)for(;O<=R;)N+=((D=T*_(O,N))+2*(k=T*_(O+T/2,N+D/2))+2*(z=T*_(O+T/2,N+k/2))+T*_(O+T,N+z))/6,O+=T;return N},romberg:function(_,T,R,O){for(var N,G,D,k,z,ne=0,Z=(R-T)/2,ve=[],xe=[],de=[];ne<O/2;){for(z=_(T),D=T,k=0;D<=R;D+=Z,k++)ve[k]=D;for(N=ve.length,D=1;D<N-1;D++)z+=(D%2!=0?4:2)*_(ve[D]);z=Z/3*(z+_(R)),de[ne]=z,Z/=2,ne++}for(G=de.length,N=1;G!==1;){for(D=0;D<G-1;D++)xe[D]=(d.pow(4,N)*de[D+1]-de[D])/(d.pow(4,N)-1);G=xe.length,de=xe,xe=[],N++}return de},richardson:function(_,T,R,O){function N(Se,Me){for(var Pe,_e=0,Oe=Se.length;_e<Oe;_e++)Se[_e]===Me&&(Pe=_e);return Pe}for(var G,D,k,z,ne,Z=d.abs(R-_[N(_,R)+1]),ve=0,xe=[],de=[];O>=Z;)G=N(_,R+O),D=N(_,R),xe[ve]=(T[G]-2*T[D]+T[2*D-G])/(O*O),O/=2,ve++;for(z=xe.length,k=1;z!=1;){for(ne=0;ne<z-1;ne++)de[ne]=(d.pow(4,k)*xe[ne+1]-xe[ne])/(d.pow(4,k)-1);z=de.length,xe=de,de=[],k++}return xe},simpson:function(_,T,R,O){for(var N,G=(R-T)/O,D=_(T),k=[],z=T,ne=0,Z=1;z<=R;z+=G,ne++)k[ne]=z;for(N=k.length;Z<N-1;Z++)D+=(Z%2!=0?4:2)*_(k[Z]);return G/3*(D+_(R))},hermite:function(_,T,R,O){for(var N,G=_.length,D=0,k=0,z=[],ne=[],Z=[],ve=[];k<G;k++){for(z[k]=1,N=0;N<G;N++)k!=N&&(z[k]*=(O-_[N])/(_[k]-_[N]));for(ne[k]=0,N=0;N<G;N++)k!=N&&(ne[k]+=1/(_[k]-_[N]));Z[k]=(1-2*(O-_[k])*ne[k])*(z[k]*z[k]),ve[k]=(O-_[k])*(z[k]*z[k]),D+=Z[k]*T[k]+ve[k]*R[k]}return D},lagrange:function(_,T,R){for(var O,N,G=0,D=0,k=_.length;D<k;D++){for(N=T[D],O=0;O<k;O++)D!=O&&(N*=(R-_[O])/(_[D]-_[O]));G+=N}return G},cubic_spline:function(_,T,R){for(var O,N,G=_.length,D=0,k=[],z=[],ne=[],Z=[],ve=[],xe=[];D<G-1;D++)Z[D]=_[D+1]-_[D];for(ne[0]=0,D=1;D<G-1;D++)ne[D]=3/Z[D]*(T[D+1]-T[D])-3/Z[D-1]*(T[D]-T[D-1]);for(D=1;D<G-1;D++)k[D]=[],z[D]=[],k[D][D-1]=Z[D-1],k[D][D]=2*(Z[D-1]+Z[D]),k[D][D+1]=Z[D],z[D][0]=ne[D];for(N=c.multiply(c.inv(k),z),O=0;O<G-1;O++)ve[O]=(T[O+1]-T[O])/Z[O]-Z[O]*(N[O+1][0]+2*N[O][0])/3,xe[O]=(N[O+1][0]-N[O][0])/(3*Z[O]);for(O=0;O<G&&!(_[O]>R);O++);return T[O-=1]+(R-_[O])*ve[O]+c.sq(R-_[O])*N[O]+(R-_[O])*c.sq(R-_[O])*xe[O]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(_){var T,R,O,N,G,D=_.length,k=_[0].length,z=0,ne=[],Z=[],ve=[],xe=[],de=[],Se=[],Me=[];for(z=0;z<D;z++)ne[z]=c.sum(_[z])/k;for(z=0;z<k;z++)for(de[z]=[],T=0;T<D;T++)de[z][T]=_[T][z]-ne[T];for(de=c.transpose(de),z=0;z<D;z++)for(Se[z]=[],T=0;T<D;T++)Se[z][T]=c.dot([de[z]],[de[T]])/(k-1);for(G=(O=c.jacobi(Se))[0],Z=O[1],Me=c.transpose(G),z=0;z<Z.length;z++)for(T=z;T<Z.length;T++)Z[z]<Z[T]&&(R=Z[z],Z[z]=Z[T],Z[T]=R,ve=Me[z],Me[z]=Me[T],Me[T]=ve);for(N=c.transpose(de),z=0;z<D;z++)for(xe[z]=[],T=0;T<N.length;T++)xe[z][T]=c.dot([Me[z]],[N[T]]);return[_,Z,Me,xe]}}),function(_){for(var T=0;T<_.length;T++)(function(R){c.fn[R]=function(O,N){var G=this;return N?(setTimeout(function(){N.call(G,c.fn[R].call(G,O))},15),this):typeof c[R](this,O)=="number"?c[R](this,O):c(c[R](this,O))}})(_[T])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(u,Math),function(c,d){var f=[].slice,C=c.utils.isNumber,m=c.utils.isArray;function E(v,_,T,R){if(v>1||T>1||v<=0||T<=0)throw new Error("Proportions should be greater than 0 and less than 1");var O=(v*_+T*R)/(_+R);return(v-T)/d.sqrt(O*(1-O)*(1/_+1/R))}c.extend({zscore:function(){var v=f.call(arguments);return C(v[1])?(v[0]-v[1])/v[2]:(v[0]-c.mean(v[1]))/c.stdev(v[1],v[2])},ztest:function(){var v,_=f.call(arguments);return m(_[1])?(v=c.zscore(_[0],_[1],_[3]),_[2]===1?c.normal.cdf(-d.abs(v),0,1):2*c.normal.cdf(-d.abs(v),0,1)):_.length>2?(v=c.zscore(_[0],_[1],_[2]),_[3]===1?c.normal.cdf(-d.abs(v),0,1):2*c.normal.cdf(-d.abs(v),0,1)):(v=_[0],_[1]===1?c.normal.cdf(-d.abs(v),0,1):2*c.normal.cdf(-d.abs(v),0,1))}}),c.extend(c.fn,{zscore:function(v,_){return(v-this.mean())/this.stdev(_)},ztest:function(v,_,T){var R=d.abs(this.zscore(v,T));return _===1?c.normal.cdf(-R,0,1):2*c.normal.cdf(-R,0,1)}}),c.extend({tscore:function(){var v=f.call(arguments);return v.length===4?(v[0]-v[1])/(v[2]/d.sqrt(v[3])):(v[0]-c.mean(v[1]))/(c.stdev(v[1],!0)/d.sqrt(v[1].length))},ttest:function(){var v,_=f.call(arguments);return _.length===5?(v=d.abs(c.tscore(_[0],_[1],_[2],_[3])),_[4]===1?c.studentt.cdf(-v,_[3]-1):2*c.studentt.cdf(-v,_[3]-1)):C(_[1])?(v=d.abs(_[0]),_[2]==1?c.studentt.cdf(-v,_[1]-1):2*c.studentt.cdf(-v,_[1]-1)):(v=d.abs(c.tscore(_[0],_[1])),_[2]==1?c.studentt.cdf(-v,_[1].length-1):2*c.studentt.cdf(-v,_[1].length-1))}}),c.extend(c.fn,{tscore:function(v){return(v-this.mean())/(this.stdev(!0)/d.sqrt(this.cols()))},ttest:function(v,_){return _===1?1-c.studentt.cdf(d.abs(this.tscore(v)),this.cols()-1):2*c.studentt.cdf(-d.abs(this.tscore(v)),this.cols()-1)}}),c.extend({anovafscore:function(){var v,_,T,R,O,N,G,D,k=f.call(arguments);if(k.length===1){for(O=new Array(k[0].length),G=0;G<k[0].length;G++)O[G]=k[0][G];k=O}for(_=new Array,G=0;G<k.length;G++)_=_.concat(k[G]);for(T=c.mean(_),v=0,G=0;G<k.length;G++)v+=k[G].length*d.pow(c.mean(k[G])-T,2);for(v/=k.length-1,N=0,G=0;G<k.length;G++)for(R=c.mean(k[G]),D=0;D<k[G].length;D++)N+=d.pow(k[G][D]-R,2);return v/(N/(_.length-k.length))},anovaftest:function(){var v,_,T,R,O=f.call(arguments);if(C(O[0]))return 1-c.centralF.cdf(O[0],O[1],O[2]);var N=c.anovafscore(O);for(v=O.length-1,T=0,R=0;R<O.length;R++)T+=O[R].length;return _=T-v-1,1-c.centralF.cdf(N,v,_)},ftest:function(v,_,T){return 1-c.centralF.cdf(v,_,T)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){var v,_=0;for(v=0;v<this.length;v++)_+=this[v].length;return c.ftest(this.anovafscore(),this.length-1,_-this.length)}}),c.extend({qscore:function(){var v,_,T,R,O,N=f.call(arguments);return C(N[0])?(v=N[0],_=N[1],T=N[2],R=N[3],O=N[4]):(v=c.mean(N[0]),_=c.mean(N[1]),T=N[0].length,R=N[1].length,O=N[2]),d.abs(v-_)/(O*d.sqrt((1/T+1/R)/2))},qtest:function(){var v,_=f.call(arguments);_.length===3?(v=_[0],_=_.slice(1)):_.length===7?(v=c.qscore(_[0],_[1],_[2],_[3],_[4]),_=_.slice(5)):(v=c.qscore(_[0],_[1],_[2]),_=_.slice(3));var T=_[0],R=_[1];return 1-c.tukey.cdf(v,R,T-R)},tukeyhsd:function(v){for(var _=c.pooledstdev(v),T=v.map(function(k){return c.mean(k)}),R=v.reduce(function(k,z){return k+z.length},0),O=[],N=0;N<v.length;++N)for(var G=N+1;G<v.length;++G){var D=c.qtest(T[N],T[G],v[N].length,v[G].length,_,R,v.length);O.push([[N,G],D])}return O}}),c.extend({normalci:function(){var v,_=f.call(arguments),T=new Array(2);return v=_.length===4?d.abs(c.normal.inv(_[1]/2,0,1)*_[2]/d.sqrt(_[3])):d.abs(c.normal.inv(_[1]/2,0,1)*c.stdev(_[2])/d.sqrt(_[2].length)),T[0]=_[0]-v,T[1]=_[0]+v,T},tci:function(){var v,_=f.call(arguments),T=new Array(2);return v=_.length===4?d.abs(c.studentt.inv(_[1]/2,_[3]-1)*_[2]/d.sqrt(_[3])):d.abs(c.studentt.inv(_[1]/2,_[2].length-1)*c.stdev(_[2],!0)/d.sqrt(_[2].length)),T[0]=_[0]-v,T[1]=_[0]+v,T},significant:function(v,_){return v<_}}),c.extend(c.fn,{normalci:function(v,_){return c.normalci(v,_,this.toArray())},tci:function(v,_){return c.tci(v,_,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(v,_,T,R){var O=E(v,_,T,R);return c.ztest(O,1)},twoSidedDifferenceOfProportions:function(v,_,T,R){var O=E(v,_,T,R);return c.ztest(O,2)}})}(u,Math),u.models=function(){function c(f,C){var m=f.length,E=C[0].length-1,v=m-E-1,_=u.lstsq(C,f),T=u.multiply(C,_.map(function(k){return[k]})).map(function(k){return k[0]}),R=u.subtract(f,T),O=u.mean(f),N=u.sum(T.map(function(k){return Math.pow(k-O,2)})),G=u.sum(f.map(function(k,z){return Math.pow(k-T[z],2)})),D=N+G;return{exog:C,endog:f,nobs:m,df_model:E,df_resid:v,coef:_,predict:T,resid:R,ybar:O,SST:D,SSE:N,SSR:G,R2:N/D}}function d(f){var C,m,E=(C=f.exog,m=C[0].length,u.arange(m).map(function(G){var D=u.arange(m).filter(function(k){return k!==G});return c(u.col(C,G).map(function(k){return k[0]}),u.col(C,D))})),v=Math.sqrt(f.SSR/f.df_resid),_=E.map(function(G){var D=G.SST,k=G.R2;return v/Math.sqrt(D*(1-k))}),T=f.coef.map(function(G,D){return(G-0)/_[D]}),R=T.map(function(G){var D=u.studentt.cdf(G,f.df_resid);return 2*(D>.5?1-D:D)}),O=u.studentt.inv(.975,f.df_resid),N=f.coef.map(function(G,D){var k=O*_[D];return[G-k,G+k]});return{se:_,t:T,p:R,sigmaHat:v,interval95:N}}return{ols:function(f,C){var m=c(f,C),E=d(m),v=function(T){var R,O,N,G=T.R2/T.df_model/((1-T.R2)/T.df_resid);return{F_statistic:G,pvalue:1-(R=G,O=T.df_model,N=T.df_resid,u.beta.cdf(R/(N/O+R),O/2,N/2))}}(m),_=1-(1-m.R2)*((m.nobs-1)/m.df_resid);return m.t=E,m.f=v,m.adjust_R2=_,m}}}(),u.extend({buildxmatrix:function(){for(var c=new Array(arguments.length),d=0;d<arguments.length;d++)c[d]=[1].concat(arguments[d]);return u(c)},builddxmatrix:function(){for(var c=new Array(arguments[0].length),d=0;d<arguments[0].length;d++)c[d]=[1].concat(arguments[0][d]);return u(c)},buildjxmatrix:function(c){for(var d=new Array(c.length),f=0;f<c.length;f++)d[f]=c[f];return u.builddxmatrix(d)},buildymatrix:function(c){return u(c).transpose()},buildjymatrix:function(c){return c.transpose()},matrixmult:function(c,d){var f,C,m,E,v;if(c.cols()==d.rows()){if(d.rows()>1){for(E=[],f=0;f<c.rows();f++)for(E[f]=[],C=0;C<d.cols();C++){for(v=0,m=0;m<c.cols();m++)v+=c.toArray()[f][m]*d.toArray()[m][C];E[f][C]=v}return u(E)}for(E=[],f=0;f<c.rows();f++)for(E[f]=[],C=0;C<d.cols();C++){for(v=0,m=0;m<c.cols();m++)v+=c.toArray()[f][m]*d.toArray()[C];E[f][C]=v}return u(E)}},regress:function(c,d){var f=u.xtranspxinv(c),C=c.transpose(),m=u.matrixmult(u(f),C);return u.matrixmult(m,d)},regresst:function(c,d,f){var C=u.regress(c,d),m={anova:{}},E=u.jMatYBar(c,C);m.yBar=E;var v=d.mean();m.anova.residuals=u.residuals(d,E),m.anova.ssr=u.ssr(E,v),m.anova.msr=m.anova.ssr/(c[0].length-1),m.anova.sse=u.sse(d,E),m.anova.mse=m.anova.sse/(d.length-(c[0].length-1)-1),m.anova.sst=u.sst(d,v),m.anova.mst=m.anova.sst/(d.length-1),m.anova.r2=1-m.anova.sse/m.anova.sst,m.anova.r2<0&&(m.anova.r2=0),m.anova.fratio=m.anova.msr/m.anova.mse,m.anova.pvalue=u.anovaftest(m.anova.fratio,c[0].length-1,d.length-(c[0].length-1)-1),m.anova.rmse=Math.sqrt(m.anova.mse),m.anova.r2adj=1-m.anova.mse/m.anova.mst,m.anova.r2adj<0&&(m.anova.r2adj=0),m.stats=new Array(c[0].length);for(var _,T,R,O=u.xtranspxinv(c),N=0;N<C.length;N++)_=Math.sqrt(m.anova.mse*Math.abs(O[N][N])),T=Math.abs(C[N]/_),R=u.ttest(T,d.length-c[0].length-1,f),m.stats[N]=[C[N],_,T,R];return m.regress=C,m},xtranspx:function(c){return u.matrixmult(c.transpose(),c)},xtranspxinv:function(c){var d=u.matrixmult(c.transpose(),c);return u.inv(d)},jMatYBar:function(c,d){var f=u.matrixmult(c,d);return new u(f)},residuals:function(c,d){return u.matrixsubtract(c,d)},ssr:function(c,d){for(var f=0,C=0;C<c.length;C++)f+=Math.pow(c[C]-d,2);return f},sse:function(c,d){for(var f=0,C=0;C<c.length;C++)f+=Math.pow(c[C]-d[C],2);return f},sst:function(c,d){for(var f=0,C=0;C<c.length;C++)f+=Math.pow(c[C]-d,2);return f},matrixsubtract:function(c,d){for(var f=new Array(c.length),C=0;C<c.length;C++){f[C]=new Array(c[C].length);for(var m=0;m<c[C].length;m++)f[C][m]=c[C][m]-d[C][m]}return u(f)}}),u.jStat=u,u)},960:function(l,u,c){const d=c(592);l.exports=function(f){function C(N,G){const D=G.split(".");let k=N;for(const z of D){if(k==null)return;k=k[z]}return k}for(let N=0;N<Object.keys(d).length;N++){let G,D=Object.keys(d)[N],k=[];if(typeof d[D]=="object"){k=Object.keys(d[D]),G=Object.values(d[D]);for(let z=0;z<G.length;z++)if(typeof G[z]=="object"){let ne=k[z];d[D][ne]&&(k=[...k,...Object.keys(d[D][ne]).map(Z=>ne+"."+Z)],k.splice(k.indexOf(ne),1))}}if(k.length<1)f[D]=d[D];else for(let z=0;z<k.length;z++)typeof C(d[D],k[z])=="function"&&(f[D]=C(d[D],k[z]))}let m=function(N){return typeof N=="number"&&(N=parseInt(N)),N},E=null,v=null,_=null;f.TABLE=function(){return _},f.COLUMN=f.COL=function(){return _.tracking&&_.tracking.push(O.getColumnNameFromCoords(m(E),m(v))),m(E)+1},f.ROW=function(){return _.tracking&&_.tracking.push(O.getColumnNameFromCoords(m(E),m(v))),m(v)+1},f.CELL=function(){return O.getColumnNameFromCoords(E,v)},f.VALUE=function(N,G,D){return _.getValueFromCoords(m(N)-1,m(G)-1,D)},f.THISROWCELL=function(N){return _.getValueFromCoords(m(N)-1,m(v))};const T=function(N,G){for(let D=0;D<N.length;D++){let k=O.getTokensFromRange(N[D]);G=G.replace(N[D],"["+k.join(",")+"]")}return G},R=function(N){return typeof N=="string"&&(N=N.trim()),!isNaN(N)&&N!==null&&N!==""},O=function(N,G,D,k,z){_=z,E=D,v=k;let ne="",Z={};if(G)if(G.size){let de,Se=null;G.forEach(function(Me,Pe){de=Pe.replace(/!/g,"."),de.indexOf(".")!==-1&&(de=de.split("."),Z[de[0]]=!0)}),de=Object.keys(Z);for(let Me=0;Me<de.length;Me++)ne+="var "+de[Me]+" = {};";G.forEach(function(Me,Pe){de=Pe.replace(/!/g,"."),Me===null||R(Me)||(Se=Me.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),Se&&Se.length&&(Me=updateRanges(Se,Me))),de.indexOf(".")>0?ne+=de+" = "+G.get(Pe)+`;
`:ne+="var "+de+" = "+Me+`;
`})}else{let de=Object.keys(G);if(de.length){let Se,Me={};for(let Pe=0;Pe<de.length;Pe++)if(Se=de[Pe].replace(/\!/g,"."),Se.indexOf(".")>0){let _e=_e.split(".");Me[_e[0]]={}}Se=Object.keys(Me);for(let Pe=0;Pe<Se.length;Pe++)ne+="var "+Se[Pe]+" = {};";for(let Pe=0;Pe<de.length;Pe++){if(Se=de[Pe].replace(/!/g,"."),G[de[Pe]]!==null&&!R(G[de[Pe]])){let _e=G[de[Pe]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);_e&&_e.length&&(G[de[Pe]]=T(_e,G[de[Pe]]))}Se.indexOf(".")>0?ne+=Se+" = "+G[de[Pe]]+`;
`:ne+="var "+Se+" = "+G[de[Pe]]+`;
`}}}let ve=(N=function(de,Se){let Me="",Pe=0,_e=["=","!",">","<"];for(let Oe=0;Oe<de.length;Oe++)de[Oe]==='"'&&(Pe=Pe===0?1:0),Pe===1?Me+=de[Oe]:(Me+=de[Oe].toUpperCase(),Oe>0&&de[Oe]==="="&&_e.indexOf(de[Oe-1])===-1&&_e.indexOf(de[Oe+1])===-1&&(Me+="="));return Me=Me.replace(/\^/g,"**"),Me=Me.replace(/<>/g,"!="),Me=Me.replace(/&/g,"+"),Me=Me.replace(/\$/g,""),Me}(N=(N=N.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ve&&ve.length&&(N=T(ve,N));let xe=new Function(ne+"; return "+N)();return xe===null&&(xe=0),xe};return O.getColumnNameFromCoords=function(N,G){return D=parseInt(N),k="",D>701?(k+=String.fromCharCode(64+parseInt(D/676)),k+=String.fromCharCode(64+parseInt(D%676/26))):D>25&&(k+=String.fromCharCode(64+parseInt(D/26))),k+String.fromCharCode(65+D%26)+(parseInt(G)+1);var D,k},O.getCoordsFromColumnName=function(N){var G=/^[a-zA-Z]+/.exec(N);if(G){for(var D=0,k=0;k<G[0].length;k++)D+=parseInt(G[0].charCodeAt(k)-64)*Math.pow(26,G[0].length-1-k);--D<0&&(D=0);var z=parseInt(/[0-9]+$/.exec(N))||null;return z>0&&z--,[D,z]}},O.getRangeFromTokens=function(N){N=N.filter(function(z){return z!="#REF!"});for(var G="",D="",k=0;k<N.length;k++)N[k].indexOf(".")>=0?G=".":N[k].indexOf("!")>=0&&(G="!"),G&&(D=N[k].split(G),N[k]=D[1],D=D[0]+G);return N.sort(function(z,ne){var Z=Helpers.getCoordsFromColumnName(z),ve=Helpers.getCoordsFromColumnName(ne);return Z[1]>ve[1]?1:Z[1]<ve[1]?-1:Z[0]>ve[0]?1:Z[0]<ve[0]?-1:0}),N.length?D+(N[0]+":")+N[N.length-1]:"#REF!"},O.getTokensFromRange=function(N){if(N.indexOf(".")>0){var G=N.split(".");N=G[1],G=G[0]+"."}else N.indexOf("!")>0?(G=N.split("!"),N=G[1],G=G[0]+"!"):G="";N=N.split(":");var D=O.getCoordsFromColumnName(N[0]),k=O.getCoordsFromColumnName(N[1]);if(D[0]<=k[0])var z=D[0],ne=k[0];else z=k[0],ne=D[0];if(D[1]===null&&k[1]==null)for(var Z=null,ve=null,xe=Object.keys(vars),de=0;de<xe.length;de++){var Se=O.getCoordsFromColumnName(xe[de]);Se[0]===D[0]&&(Z===null||Se[1]<Z)&&(Z=Se[1]),Se[0]===k[0]&&(ve===null||Se[1]>ve)&&(ve=Se[1])}else D[1]<=k[1]?(Z=D[1],ve=k[1]):(Z=k[1],ve=D[1]);for(var Me=[],Pe=Z;Pe<=ve;Pe++){var _e=[];for(de=z;de<=ne;de++)_e.push(G+O.getColumnNameFromCoords(de,Pe));Me.push(_e)}return Me},O.setFormula=function(N){let G=Object.keys(N);for(let D=0;D<G.length;D++)typeof N[G[D]]=="function"&&(f[G[D]]=N[G[D]])},O.basic=!0,O}(typeof window>"u"?c.g:window)},592:function(l,u,c){var d=c(162),f=c(765);const C=new Error("#NULL!"),m=new Error("#DIV/0!"),E=new Error("#VALUE!"),v=new Error("#REF!"),_=new Error("#NAME?"),T=new Error("#NUM!"),R=new Error("#N/A"),O=new Error("#ERROR!"),N=new Error("#GETTING_DATA");var G=Object.freeze({__proto__:null,data:N,div0:m,error:O,na:R,name:_,nil:C,num:T,ref:v,value:E});function D(p){const S=[];return k(p,P=>{S.push(P)}),S}function k(p,S){let P=-1;const B=p.length;for(;++P<B&&S(p[P],P,p)!==!1;);return p}function z(p){let S,P=p.length;for(;P--;)if(S=p[P],typeof S!="number")if(S!==!0)if(S!==!1){if(typeof S=="string"){const B=V(S);p[P]=B instanceof Error?0:B}}else p[P]=0;else p[P]=1;return p}function ne(p,S){if(!p)return E;p.every(se=>Array.isArray(se))&&p.length!==0||(p=[[...p]]),p.map((se,fe)=>{se.map((be,Xe)=>{be||(p[fe][Xe]=0)})});const P=p.reduce((se,fe,be)=>fe.length>p[se].length?be:se,0),B=p[P].length;return p.map(se=>[...se,...Array(B-se.length).fill(0)])}function Z(){let p;if(arguments.length===1){const P=arguments[0];p=(S=P)!=null&&typeof S.length=="number"&&typeof S!="string"?D.apply(null,arguments):[P]}else p=Array.from(arguments);for(var S;!xe(p);)p=ve(p);return p}function ve(p){return p&&p.reduce?p.reduce((S,P)=>{const B=Array.isArray(S),se=Array.isArray(P);return B&&se?S.concat(P):B?(S.push(P),S):se?[S].concat(P):[S,P]}):[p]}function xe(p){if(!p)return!1;for(let S=0;S<p.length;++S)if(Array.isArray(p[S]))return!1;return!0}function de(p,S){return S=S||1,p&&typeof p.slice=="function"?p.slice(S):p}function Se(p){return p?p[0].map((S,P)=>p.map(B=>B[P])):E}function Me(p,S){let P=null;return k(p,(B,se)=>{if(B[0]===S)return P=se,!1}),P??E}function Pe(){for(let p=0;p<arguments.length;p++)if(arguments[p]instanceof Error)return arguments[p]}function _e(){let p=arguments.length;for(;p--;)if(arguments[p]instanceof Error)return!0;return!1}function Oe(p){return Math.round(p*1e14)/1e14}function st(){return Z.apply(null,arguments).filter(p=>typeof p=="number")}function rt(p){if(typeof p=="boolean"||p instanceof Error)return p;if(typeof p=="number")return p!==0;if(typeof p=="string"){const S=p.toUpperCase();if(S==="TRUE")return!0;if(S==="FALSE")return!1}return p instanceof Date&&!isNaN(p)||E}function U(p){if(!isNaN(p)){if(p instanceof Date)return new Date(p);const S=parseFloat(p);return S<0||S>=2958466?T:function(P){P<60&&(P+=1);const B=Math.floor(P-25569),se=new Date(86400*B*1e3),fe=P-Math.floor(P)+1e-7;let be=Math.floor(86400*fe);const Xe=be%60;be-=Xe;const ut=Math.floor(be/3600),Ct=Math.floor(be/60)%60;let Ot=se.getUTCDate(),kt=se.getUTCMonth();return P>=60&&P<61&&(Ot=29,kt=1),new Date(se.getUTCFullYear(),kt,Ot,ut,Ct,Xe)}(S)}return typeof p!="string"||(p=/(\d{4})-(\d\d?)-(\d\d?)$/.test(p)?new Date(p+"T00:00:00.000"):new Date(p),isNaN(p))?E:p}function te(p){let S,P=p.length;for(;P--;){if(S=U(p[P]),S===E)return S;p[P]=S}return p}function V(p){return p instanceof Error?p:p==null?0:(typeof p=="boolean"&&(p=+p),isNaN(p)||p===""?E:parseFloat(p))}function ue(p){let S,P;if(!p||(S=p.length)===0)return E;for(;S--;){if(p[S]instanceof Error)return p[S];if(P=V(p[S]),P instanceof Error)return P;p[S]=P}return p}function Ne(p){return p instanceof Error?p:p==null?"":p.toString()}function Ge(){let p=arguments.length;for(;p--;)if(typeof arguments[p]=="string")return!0;return!1}function Ue(p){return p!=null}const Ie="=",Ke=[">",">=","<","<=","=","<>"],le="operator",ge="literal",we=[le,ge],qe=le,$e=ge;function ze(p,S){if(we.indexOf(S)===-1)throw new Error("Unsupported token type: "+S);return{value:p,type:S}}function it(p){return function(S){let P="";const B=[];for(let se=0;se<S.length;se++){const fe=S[se];se===0&&Ke.indexOf(fe)>=0?B.push(ze(fe,qe)):P+=fe}return P.length>0&&B.push(ze(function(se){return typeof se!="string"||/^\d+(\.\d+)?$/.test(se)&&(se=se.indexOf(".")===-1?parseInt(se,10):parseFloat(se)),se}(P),$e)),B.length>0&&B[0].type!==qe&&B.unshift(ze(Ie,qe)),B}(function(S){const P=S.length,B=[];let se=0,fe="",be="";for(;se<P;){const Xe=S.charAt(se);switch(Xe){case">":case"<":case"=":be+=Xe,fe.length>0&&(B.push(fe),fe="");break;default:be.length>0&&(B.push(be),be=""),fe+=Xe}se++}return fe.length>0&&B.push(fe),be.length>0&&B.push(be),B}(p))}const Ve=function(p){const S=[];let P;for(let B=0;B<p.length;B++){const se=p[B];switch(se.type){case qe:P=se.value;break;case $e:S.push(se.value)}}return function(B,se){let fe=!1;switch(se){case">":fe=B[0]>B[1];break;case">=":fe=B[0]>=B[1];break;case"<":fe=B[0]<B[1];break;case"<=":fe=B[0]<=B[1];break;case"=":fe=B[0]==B[1];break;case"<>":fe=B[0]!=B[1]}return fe}(S,P)},Qe={};function nt(p){return[E,v,m,T,_,C].indexOf(p)>=0||typeof p=="number"&&(isNaN(p)||!isFinite(p))}function Ze(p){return nt(p)||p===R}function at(p){return p===!0||p===!1}function St(p){return typeof p=="number"&&!isNaN(p)&&isFinite(p)}function bt(p){return typeof p=="string"}function q(){const p=[];for(let S=0;S<arguments.length;++S){let P=!1;const B=arguments[S];for(let se=0;se<p.length&&(P=p[se]===B,!P);++se);P||p.push(B)}return p}function X(p,S,P,B){if(!S||!P)return R;B=!(B===0||B===!1);let se=R;const fe=typeof p=="number";let be=!1;for(let Xe=0;Xe<S.length;Xe++){const ut=S[Xe];if(ut[0]===p){se=P<ut.length+1?ut[P-1]:v;break}!be&&(fe&&B&&ut[0]<=p||B&&typeof ut[0]=="string"&&ut[0].localeCompare(p)<0)&&(se=P<ut.length+1?ut[P-1]:v),fe&&ut[0]>p&&(be=!0)}return se}function F(){const p=Z(arguments).filter(Ue);if(p.length===0)return m;const S=Pe.apply(void 0,p);if(S)return S;const P=st(p),B=P.length;let se,fe=0,be=0;for(let Xe=0;Xe<B;Xe++)fe+=P[Xe],be+=1;return se=fe/be,isNaN(se)&&(se=T),se}function b(){const p=Z(arguments).filter(Ue);if(p.length===0)return m;const S=Pe.apply(void 0,p);if(S)return S;const P=p,B=P.length;let se,fe=0,be=0;for(let Xe=0;Xe<B;Xe++){const ut=P[Xe];typeof ut=="number"&&(fe+=ut),ut===!0&&fe++,ut!==null&&be++}return se=fe/be,isNaN(se)&&(se=T),se}Qe.TYPE=p=>{switch(p){case C:return 1;case m:return 2;case E:return 3;case v:return 4;case _:return 5;case T:return 6;case R:return 7;case N:return 8}return R};const ce={DIST:function(p,S,P,B,se,fe){return arguments.length<4?E:(se=se===void 0?0:se,fe=fe===void 0?1:fe,_e(p=V(p),S=V(S),P=V(P),se=V(se),fe=V(fe))?E:(p=(p-se)/(fe-se),B?d.beta.cdf(p,S,P):d.beta.pdf(p,S,P)))},INV:(p,S,P,B,se)=>(B=B===void 0?0:B,se=se===void 0?1:se,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se))?E:d.beta.inv(p,S,P)*(se-B)+B)},Fe={DIST:(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P),B=V(B))?E:B?d.binomial.cdf(p,S,P):d.binomial.pdf(p,S,P)};Fe.DIST.RANGE=(p,S,P,B)=>{if(B=B===void 0?P:B,_e(p=V(p),S=V(S),P=V(P),B=V(B)))return E;let se=0;for(let fe=P;fe<=B;fe++)se+=ht(p,fe)*Math.pow(S,fe)*Math.pow(1-S,p-fe);return se},Fe.INV=(p,S,P)=>{if(_e(p=V(p),S=V(S),P=V(P)))return E;let B=0;for(;B<=p;){if(d.binomial.cdf(B,p,S)>=P)return B;B++}};const Le={DIST:(p,S,P)=>_e(p=V(p),S=V(S))?E:P?d.chisquare.cdf(p,S):d.chisquare.pdf(p,S)};Le.DIST.RT=(p,S)=>!p|!S?R:p<1||S>Math.pow(10,10)?T:typeof p!="number"||typeof S!="number"?E:1-d.chisquare.cdf(p,S),Le.INV=(p,S)=>_e(p=V(p),S=V(S))?E:d.chisquare.inv(p,S),Le.INV.RT=(p,S)=>!p|!S?R:p<0||p>1||S<1||S>Math.pow(10,10)?T:typeof p!="number"||typeof S!="number"?E:d.chisquare.inv(1-p,S),Le.TEST=function(p,S){if(arguments.length!==2)return R;if(!(p instanceof Array&&S instanceof Array)||p.length!==S.length||p[0]&&S[0]&&p[0].length!==S[0].length)return E;const P=p.length;let B,se,fe;for(se=0;se<P;se++)p[se]instanceof Array||(B=p[se],p[se]=[],p[se].push(B)),S[se]instanceof Array||(B=S[se],S[se]=[],S[se].push(B));const be=p[0].length,Xe=be===1?P-1:(P-1)*(be-1);let ut=0;const Ct=Math.PI;for(se=0;se<P;se++)for(fe=0;fe<be;fe++)ut+=Math.pow(p[se][fe]-S[se][fe],2)/S[se][fe];return Math.round(1e6*function(Ot,kt){let Ft=Math.exp(-.5*Ot);kt%2==1&&(Ft*=Math.sqrt(2*Ot/Ct));let Gt=kt;for(;Gt>=2;)Ft=Ft*Ot/Gt,Gt-=2;let zt=Ft,Yt=kt;for(;zt>1e-10*Ft;)Yt+=2,zt=zt*Ot/Yt,Ft+=zt;return 1-Ft}(ut,Xe))/1e6};const ae={};function re(){return st(Z(arguments)).length}function me(){const p=Z(arguments);return p.length-he(p)}function he(){const p=Z(arguments);let S,P=0;for(let B=0;B<p.length;B++)S=p[B],S!=null&&S!==""||P++;return P}ae.NORM=(p,S,P)=>_e(p=V(p),S=V(S),P=V(P))?E:d.normalci(1,p,S,P)[1]-1,ae.T=(p,S,P)=>_e(p=V(p),S=V(S),P=V(P))?E:d.tci(1,p,S,P)[1]-1;const Ae={P:(p,S)=>{if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=d.mean(p),B=d.mean(S);let se=0;const fe=p.length;for(let be=0;be<fe;be++)se+=(p[be]-P)*(S[be]-B);return se/fe},S:(p,S)=>_e(p=ue(Z(p)),S=ue(Z(S)))?E:d.covariance(p,S)},je={DIST:(p,S,P)=>_e(p=V(p),S=V(S))?E:P?d.exponential.cdf(p,S):d.exponential.pdf(p,S)},ke={};function et(p,S,P){if(_e(p=V(p),S=ue(Z(S)),P=ue(Z(P))))return E;const B=d.mean(P),se=d.mean(S),fe=P.length;let be=0,Xe=0;for(let Ct=0;Ct<fe;Ct++)be+=(P[Ct]-B)*(S[Ct]-se),Xe+=Math.pow(P[Ct]-B,2);const ut=be/Xe;return se-ut*B+ut*p}function pt(p){return(p=V(p))instanceof Error?p:p===0||parseInt(p,10)===p&&p<0?T:d.gammafn(p)}function A(p){return(p=V(p))instanceof Error?p:d.gammaln(p)}ke.DIST=(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P))?E:B?d.centralF.cdf(p,S,P):d.centralF.pdf(p,S,P),ke.DIST.RT=function(p,S,P){return arguments.length!==3?R:p<0||S<1||P<1?T:typeof p!="number"||typeof S!="number"||typeof P!="number"?E:1-d.centralF.cdf(p,S,P)},ke.INV=(p,S,P)=>_e(p=V(p),S=V(S),P=V(P))?E:p<=0||p>1?T:d.centralF.inv(p,S,P),ke.INV.RT=function(p,S,P){return arguments.length!==3?R:p<0||p>1||S<1||S>Math.pow(10,10)||P<1||P>Math.pow(10,10)?T:typeof p!="number"||typeof S!="number"||typeof P!="number"?E:d.centralF.inv(1-p,S,P)},ke.TEST=(p,S)=>{if(!p||!S||!(p instanceof Array&&S instanceof Array))return R;if(p.length<2||S.length<2)return m;const P=(fe,be)=>{let Xe=0;for(let ut=0;ut<fe.length;ut++)Xe+=Math.pow(fe[ut]-be,2);return Xe},B=Qt(p)/p.length,se=Qt(S)/S.length;return P(p,B)/(p.length-1)/(P(S,se)/(S.length-1))},pt.DIST=function(p,S,P,B){return arguments.length!==4?R:p<0||S<=0||P<=0||typeof p!="number"||typeof S!="number"||typeof P!="number"?E:B?d.gamma.cdf(p,S,P,!0):d.gamma.pdf(p,S,P,!1)},pt.INV=function(p,S,P){return arguments.length!==3?R:p<0||p>1||S<=0||P<=0?T:typeof p!="number"||typeof S!="number"||typeof P!="number"?E:d.gamma.inv(p,S,P)},A.PRECISE=function(p){return arguments.length!==1?R:p<=0?T:typeof p!="number"?E:d.gammaln(p)};const K={};function L(p,S){return _e(p=ue(Z(p)),S=V(S))?p:S<0||p.length<S?E:p.sort((P,B)=>B-P)[S-1]}function j(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=d.mean(p),B=d.mean(S),se=S.length;let fe=0,be=0;for(let ut=0;ut<se;ut++)fe+=(S[ut]-B)*(p[ut]-P),be+=Math.pow(S[ut]-B,2);const Xe=fe/be;return[Xe,P-Xe*B]}K.DIST=(p,S,P,B,se)=>{if(_e(p=V(p),S=V(S),P=V(P),B=V(B)))return E;function fe(be,Xe,ut,Ct){return ht(ut,be)*ht(Ct-ut,Xe-be)/ht(Ct,Xe)}return se?function(be,Xe,ut,Ct){let Ot=0;for(let kt=0;kt<=be;kt++)Ot+=fe(kt,Xe,ut,Ct);return Ot}(p,S,P,B):fe(p,S,P,B)};const Y={};function oe(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;const P=st(p);return P.length===0?0:Math.max.apply(Math,P)}function Te(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;const P=z(p);let B=d.median(P);return isNaN(B)&&(B=T),B}function ee(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;const P=st(p);return P.length===0?0:Math.min.apply(Math,P)}Y.DIST=(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P))?E:B?d.lognormal.cdf(p,S,P):d.lognormal.pdf(p,S,P),Y.INV=(p,S,P)=>_e(p=V(p),S=V(S),P=V(P))?E:d.lognormal.inv(p,S,P);const ye={MULT:function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=p.length,P={};let B,se=[],fe=0;for(let be=0;be<S;be++)B=p[be],P[B]=P[B]?P[B]+1:1,P[B]>fe&&(fe=P[B],se=[]),P[B]===fe&&(se[se.length]=B);return se},SNGL:function(){const p=ue(Z(arguments));return p instanceof Error?p:ye.MULT(p).sort((S,P)=>S-P)[0]}},H={DIST:(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P))?E:B?d.negbin.cdf(p,S,P):d.negbin.pdf(p,S,P)},Q={};function pe(p,S){if(_e(S=ue(Z(S)),p=ue(Z(p))))return E;const P=d.mean(p),B=d.mean(S),se=p.length;let fe=0,be=0,Xe=0;for(let ut=0;ut<se;ut++)fe+=(p[ut]-P)*(S[ut]-B),be+=Math.pow(p[ut]-P,2),Xe+=Math.pow(S[ut]-B,2);return fe/Math.sqrt(be*Xe)}Q.DIST=(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P))?E:P<=0?T:B?d.normal.cdf(p,S,P):d.normal.pdf(p,S,P),Q.INV=(p,S,P)=>_e(p=V(p),S=V(S),P=V(P))?E:d.normal.inv(p,S,P),Q.S={},Q.S.DIST=(p,S)=>(p=V(p))instanceof Error?E:S?d.normal.cdf(p,0,1):d.normal.pdf(p,0,1),Q.S.INV=p=>(p=V(p))instanceof Error?E:d.normal.inv(p,0,1);const Re={EXC:(p,S)=>{if(_e(p=ue(Z(p)),S=V(S)))return E;const P=(p=p.sort((fe,be)=>fe-be)).length;if(S<1/(P+1)||S>1-1/(P+1))return T;const B=S*(P+1)-1,se=Math.floor(B);return Oe(B===se?p[B]:p[se]+(B-se)*(p[se+1]-p[se]))},INC:(p,S)=>{if(_e(p=ue(Z(p)),S=V(S)))return E;const P=S*((p=p.sort((se,fe)=>se-fe)).length-1),B=Math.floor(P);return Oe(P===B?p[P]:p[B]+(P-B)*(p[B+1]-p[B]))}},Ce={EXC:(p,S,P)=>{if(P=P===void 0?3:P,_e(p=ue(Z(p)),S=V(S),P=V(P)))return E;p=p.sort((Ot,kt)=>Ot-kt);const B=q.apply(null,p),se=p.length,fe=B.length,be=Math.pow(10,P);let Xe=0,ut=!1,Ct=0;for(;!ut&&Ct<fe;)S===B[Ct]?(Xe=(p.indexOf(B[Ct])+1)/(se+1),ut=!0):S>=B[Ct]&&(S<B[Ct+1]||Ct===fe-1)&&(Xe=(p.indexOf(B[Ct])+1+(S-B[Ct])/(B[Ct+1]-B[Ct]))/(se+1),ut=!0),Ct++;return Math.floor(Xe*be)/be},INC:(p,S,P)=>{if(P=P===void 0?3:P,_e(p=ue(Z(p)),S=V(S),P=V(P)))return E;p=p.sort((Ot,kt)=>Ot-kt);const B=q.apply(null,p),se=p.length,fe=B.length,be=Math.pow(10,P);let Xe=0,ut=!1,Ct=0;for(;!ut&&Ct<fe;)S===B[Ct]?(Xe=p.indexOf(B[Ct])/(se-1),ut=!0):S>=B[Ct]&&(S<B[Ct+1]||Ct===fe-1)&&(Xe=(p.indexOf(B[Ct])+(S-B[Ct])/(B[Ct+1]-B[Ct]))/(se-1),ut=!0),Ct++;return Math.floor(Xe*be)/be}},We={DIST:(p,S,P)=>_e(p=V(p),S=V(S))?E:P?d.poisson.cdf(p,S):d.poisson.pdf(p,S)},ot={EXC:(p,S)=>{if(_e(p=ue(Z(p)),S=V(S)))return E;switch(S){case 1:return Re.EXC(p,.25);case 2:return Re.EXC(p,.5);case 3:return Re.EXC(p,.75);default:return T}},INC:(p,S)=>{if(_e(p=ue(Z(p)),S=V(S)))return E;switch(S){case 1:return Re.INC(p,.25);case 2:return Re.INC(p,.5);case 3:return Re.INC(p,.75);default:return T}}},mt={};function Ye(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=d.mean(p),P=p.length;let B=0;for(let se=0;se<P;se++)B+=Math.pow(p[se]-S,3);return P*B/((P-1)*(P-2)*Math.pow(d.stdev(p,!0),3))}function Et(p,S){return _e(p=ue(Z(p)),S=V(S))?p:p.sort((P,B)=>P-B)[S-1]}mt.AVG=(p,S,P)=>{if(_e(p=V(p),S=ue(Z(S))))return E;const B=(P=P||!1)?(be,Xe)=>be-Xe:(be,Xe)=>Xe-be,se=(S=(S=Z(S)).sort(B)).length;let fe=0;for(let be=0;be<se;be++)S[be]===p&&fe++;return fe>1?(2*S.indexOf(p)+fe+1)/2:S.indexOf(p)+1},mt.EQ=(p,S,P)=>{if(_e(p=V(p),S=ue(Z(S))))return E;const B=(P=P||!1)?(se,fe)=>se-fe:(se,fe)=>fe-se;return(S=S.sort(B)).indexOf(p)+1},Ye.P=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=d.mean(p),P=p.length;let B=0,se=0;for(let fe=0;fe<P;fe++)se+=Math.pow(p[fe]-S,3),B+=Math.pow(p[fe]-S,2);return se/=P,B/=P,se/Math.pow(B,1.5)};const vt={P:function(){const p=He.P.apply(this,arguments);let S=Math.sqrt(p);return isNaN(S)&&(S=T),S},S:function(){const p=He.S.apply(this,arguments);return Math.sqrt(p)}},xt={DIST:(p,S,P)=>P!==1&&P!==2?T:P===1?xt.DIST.RT(p,S):xt.DIST["2T"](p,S)};xt.DIST["2T"]=function(p,S){return arguments.length!==2?R:p<0||S<1?T:typeof p!="number"||typeof S!="number"?E:2*(1-d.studentt.cdf(p,S))},xt.DIST.RT=function(p,S){return arguments.length!==2?R:p<0||S<1?T:typeof p!="number"||typeof S!="number"?E:1-d.studentt.cdf(p,S)},xt.INV=(p,S)=>_e(p=V(p),S=V(S))?E:d.studentt.inv(p,S),xt.INV["2T"]=(p,S)=>(p=V(p),S=V(S),p<=0||p>1||S<1?T:_e(p,S)?E:Math.abs(d.studentt.inv(p/2,S))),xt.TEST=(p,S)=>{if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=d.mean(p),B=d.mean(S);let se,fe=0,be=0;for(se=0;se<p.length;se++)fe+=Math.pow(p[se]-P,2);for(se=0;se<S.length;se++)be+=Math.pow(S[se]-B,2);fe/=p.length-1,be/=S.length-1;const Xe=Math.abs(P-B)/Math.sqrt(fe/p.length+be/S.length);return xt.DIST["2T"](Xe,p.length+S.length-2)};const He={};function ft(){const p=Z(arguments),S=p.length;let P=0,B=0;const se=b(p);for(let fe=0;fe<S;fe++){const be=p[fe];P+=Math.pow(typeof be=="number"?be-se:be===!0?1-se:0-se,2),be!==null&&B++}return P/(B-1)}function yt(){const p=Z(arguments),S=p.length;let P=0,B=0;const se=b(p);let fe;for(let be=0;be<S;be++){const Xe=p[be];P+=Math.pow(typeof Xe=="number"?Xe-se:Xe===!0?1-se:0-se,2),Xe!==null&&B++}return fe=P/B,isNaN(fe)&&(fe=T),fe}He.P=function(){const p=st(Z(arguments)),S=p.length;let P=0;const B=F(p);let se;for(let fe=0;fe<S;fe++)P+=Math.pow(p[fe]-B,2);return se=P/S,isNaN(se)&&(se=T),se},He.S=function(){const p=st(Z(arguments)),S=p.length;let P=0;const B=F(p);for(let se=0;se<S;se++)P+=Math.pow(p[se]-B,2);return P/(S-1)};const It={DIST:(p,S,P,B)=>_e(p=V(p),S=V(S),P=V(P))?E:B?1-Math.exp(-Math.pow(p/P,S)):Math.pow(p,S-1)*Math.exp(-Math.pow(p/P,S))*S/Math.pow(P,S)},gt={};function De(p,S,P){const B=Pe(p=V(p),S=V(S),P=V(P));if(B)return B;if(S===0)return 0;S=Math.abs(S);const se=-Math.floor(Math.log(S)/Math.log(10));return p>=0?cr(Math.ceil(p/S)*S,se):P===0?-cr(Math.floor(Math.abs(p)/S)*S,se):-cr(Math.ceil(Math.abs(p)/S)*S,se)}function ht(p,S){return Pe(p=V(p),S=V(S))||(p<S?T:Pt(p)/(Pt(S)*Pt(p-S)))}gt.TEST=(p,S,P)=>{if(_e(p=ue(Z(p)),S=V(S)))return E;P=P||vt.S(p);const B=p.length;return 1-Q.S.DIST((F(p)-S)/(P/Math.sqrt(B)),!0)},De.MATH=De,De.PRECISE=De;const Rt=[];function Pt(p){if((p=V(p))instanceof Error)return p;const S=Math.floor(p);return S===0||S===1?1:(Rt[S]>0||(Rt[S]=Pt(S-1)*S),Rt[S])}function Vt(p,S){const P=Pe(p=V(p),S=V(S));if(P)return P;if(S===0)return 0;if(!(p>=0&&S>0||p<=0&&S<0))return T;S=Math.abs(S);const B=-Math.floor(Math.log(S)/Math.log(10));return p>=0?cr(Math.floor(p/S)*S,B):-cr(Math.ceil(Math.abs(p)/S),B)}Vt.MATH=(p,S,P)=>{if(S instanceof Error)return S;S=S===void 0?0:S;const B=Pe(p=V(p),S=V(S),P=V(P));if(B)return B;if(S===0)return 0;S=S?Math.abs(S):1;const se=-Math.floor(Math.log(S)/Math.log(10));return p>=0?cr(Math.floor(p/S)*S,se):P===0||P===void 0?-cr(Math.ceil(Math.abs(p)/S)*S,se):-cr(Math.floor(Math.abs(p)/S)*S,se)},Vt.PRECISE=Vt.MATH;const Nt={CEILING:De};function ur(p,S){const P=Pe(p=V(p),S=V(S));if(P)return P;if(p===0&&S===0)return T;const B=Math.pow(p,S);return isNaN(B)?T:B}function pr(){const p=Z(arguments).filter(B=>B!=null);if(p.length===0)return 0;const S=ue(p);if(S instanceof Error)return S;let P=1;for(let B=0;B<S.length;B++)P*=S[B];return P}function cr(p,S){return Pe(p=V(p),S=V(S))||+(Math.round(+(p+"e"+S))+"e"+-1*S)}function Qt(){let p=0;return k(D(arguments),S=>{if(p instanceof Error)return!1;if(S instanceof Error)p=S;else if(typeof S=="number")p+=S;else if(typeof S=="string"){const P=parseFloat(S);!isNaN(P)&&(p+=P)}else if(Array.isArray(S)){const P=Qt.apply(null,S);P instanceof Error?p=P:p+=P}}),p}var di=Object.freeze({__proto__:null,ADD:function(p,S){return arguments.length!==2?R:Pe(p=V(p),S=V(S))||p+S},DIVIDE:function(p,S){return arguments.length!==2?R:Pe(p=V(p),S=V(S))||(S===0?m:p/S)},EQ:function(p,S){return arguments.length!==2?R:p instanceof Error?p:S instanceof Error?S:(p===null&&(p=void 0),S===null&&(S=void 0),p===S)},GT:function(p,S){return arguments.length!==2?R:p instanceof Error?p:S instanceof Error?S:(Ge(p,S)?(p=Ne(p),S=Ne(S)):(p=V(p),S=V(S)),Pe(p,S)||p>S)},GTE:function(p,S){return arguments.length!==2?R:(Ge(p,S)?(p=Ne(p),S=Ne(S)):(p=V(p),S=V(S)),Pe(p,S)||p>=S)},LT:function(p,S){return arguments.length!==2?R:(Ge(p,S)?(p=Ne(p),S=Ne(S)):(p=V(p),S=V(S)),Pe(p,S)||p<S)},LTE:function(p,S){return arguments.length!==2?R:(Ge(p,S)?(p=Ne(p),S=Ne(S)):(p=V(p),S=V(S)),Pe(p,S)||p<=S)},MINUS:function(p,S){return arguments.length!==2?R:Pe(p=V(p),S=V(S))||p-S},MULTIPLY:function(p,S){return arguments.length!==2?R:Pe(p=V(p),S=V(S))||p*S},NE:function(p,S){return arguments.length!==2?R:p instanceof Error?p:S instanceof Error?S:(p===null&&(p=void 0),S===null&&(S=void 0),p!==S)},POW:function(p,S){return arguments.length!==2?R:ur(p,S)}});const Gn=new Date(Date.UTC(1900,0,1)),hi=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Ur=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],fi=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Cr(p,S,P){P=P.toUpperCase(),p=U(p),S=U(S);const B=p.getFullYear(),se=p.getMonth(),fe=p.getDate(),be=S.getFullYear(),Xe=S.getMonth(),ut=S.getDate();let Ct;switch(P){case"Y":Ct=Math.floor(Ki(p,S));break;case"D":Ct=fn(S,p);break;case"M":Ct=Xe-se+12*(be-B),ut<fe&&Ct--;break;case"MD":fe<=ut?Ct=ut-fe:(Xe===0?(p.setFullYear(be-1),p.setMonth(12)):(p.setFullYear(be),p.setMonth(Xe-1)),Ct=fn(S,p));break;case"YM":Ct=Xe-se+12*(be-B),ut<fe&&Ct--,Ct%=12;break;case"YD":Xe>se||Xe===se&&ut<fe?p.setFullYear(be):p.setFullYear(be-1),Ct=fn(S,p)}return Ct}function pi(p){const S=new Date(p);return S.setHours(0,0,0,0),S}function fn(p,S){return p=U(p),S=U(S),p instanceof Error?p:S instanceof Error?S:gi(pi(p))-gi(pi(S))}function rn(p,S,P){if(P=rt(P||"false"),p=U(p),S=U(S),p instanceof Error)return p;if(S instanceof Error)return S;if(P instanceof Error)return P;const B=p.getMonth();let se,fe,be=S.getMonth();if(P)se=p.getDate()===31?30:p.getDate(),fe=S.getDate()===31?30:S.getDate();else{const Xe=new Date(p.getFullYear(),B+1,0).getDate(),ut=new Date(S.getFullYear(),be+1,0).getDate();se=p.getDate()===Xe?30:p.getDate(),S.getDate()===ut?se<30?(be++,fe=1):fe=30:fe=S.getDate()}return 360*(S.getFullYear()-p.getFullYear())+30*(be-B)+(fe-se)}function jn(p){if((p=U(p))instanceof Error)return p;(p=pi(p)).setDate(p.getDate()+4-(p.getDay()||7));const S=new Date(p.getFullYear(),0,1);return Math.ceil(((p-S)/864e5+1)/7)}function pn(p,S,P){return pn.INTL(p,S,1,P)}function nn(p,S,P){return nn.INTL(p,S,1,P)}function Tn(p){return new Date(p,1,29).getMonth()===1}function mi(p,S){return Math.ceil((S-p)/1e3/60/60/24)}function Ki(p,S,P){if((p=U(p))instanceof Error)return p;if((S=U(S))instanceof Error)return S;P=P||0;let B=p.getDate();const se=p.getMonth()+1,fe=p.getFullYear();let be=S.getDate();const Xe=S.getMonth()+1,ut=S.getFullYear();switch(P){case 0:return B===31&&be===31?(B=30,be=30):B===31?B=30:B===30&&be===31&&(be=30),(be+30*Xe+360*ut-(B+30*se+360*fe))/360;case 1:{const Ct=(Gt,zt)=>{const Yt=Gt.getFullYear(),_r=new Date(Yt,2,1);if(Tn(Yt)&&Gt<_r&&zt>=_r)return!0;const rr=zt.getFullYear(),an=new Date(rr,2,1);return Tn(rr)&&zt>=an&&Gt<an};let Ot=365;if(fe===ut||fe+1===ut&&(se>Xe||se===Xe&&B>=be))return(fe===ut&&Tn(fe)||Ct(p,S)||Xe===1&&be===29)&&(Ot=366),mi(p,S)/Ot;const kt=ut-fe+1,Ft=(new Date(ut+1,0,1)-new Date(fe,0,1))/1e3/60/60/24/kt;return mi(p,S)/Ft}case 2:return mi(p,S)/360;case 3:return mi(p,S)/365;case 4:return(be+30*Xe+360*ut-(B+30*se+360*fe))/360}}function gi(p){const S=p>-22038912e5?2:1;return Math.ceil((p-Gn)/864e5)+S}function Xi(p){return(p=V(p))===0?E:p instanceof Error?p:String.fromCharCode(p)}function yi(p){if(_e(p))return p;let S=(p=p||"").charCodeAt(0);return isNaN(S)&&(S=E),S}function wn(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;let P=0;for(;(P=p.indexOf(!0))>-1;)p[P]="TRUE";let B=0;for(;(B=p.indexOf(!1))>-1;)p[B]="FALSE";return p.join("")}pn.INTL=(p,S,P,B)=>{if((p=U(p))instanceof Error)return p;if((S=U(S))instanceof Error)return S;let se=!1;const fe=[],be=[1,2,3,4,5,6,0],Xe=new RegExp("^[0|1]{7}$");if(P===void 0)P=fi[1];else if(typeof P=="string"&&Xe.test(P)){se=!0,P=P.split("");for(let kt=0;kt<P.length;kt++)P[kt]==="1"&&fe.push(be[kt])}else P=fi[P];if(!(P instanceof Array))return E;B===void 0?B=[]:B instanceof Array||(B=[B]);for(let kt=0;kt<B.length;kt++){const Ft=U(B[kt]);if(Ft instanceof Error)return Ft;B[kt]=Ft}const ut=Math.round((S-p)/864e5)+1;let Ct=ut;const Ot=p;for(let kt=0;kt<ut;kt++){const Ft=new Date().getTimezoneOffset()>0?Ot.getUTCDay():Ot.getDay();let Gt=se?fe.includes(Ft):Ft===P[0]||Ft===P[1];for(let zt=0;zt<B.length;zt++){const Yt=B[zt];if(Yt.getDate()===Ot.getDate()&&Yt.getMonth()===Ot.getMonth()&&Yt.getFullYear()===Ot.getFullYear()){Gt=!0;break}}Gt&&Ct--,Ot.setDate(Ot.getDate()+1)}return Ct},nn.INTL=(p,S,P,B)=>{if((p=U(p))instanceof Error)return p;if((S=V(S))instanceof Error)return S;if(S<0)return T;if(!((P=P===void 0?fi[1]:fi[P])instanceof Array))return E;B===void 0?B=[]:B instanceof Array||(B=[B]);for(let fe=0;fe<B.length;fe++){const be=U(B[fe]);if(be instanceof Error)return be;B[fe]=be}let se=0;for(;se<S;){p.setDate(p.getDate()+1);const fe=p.getDay();if(fe!==P[0]&&fe!==P[1]){for(let be=0;be<B.length;be++){const Xe=B[be];if(Xe.getDate()===p.getDate()&&Xe.getMonth()===p.getMonth()&&Xe.getFullYear()===p.getFullYear()){se--;break}}se++}}return p};const Lo=wn;function Ei(p,S=2,P=!1){if(p=V(p),isNaN(p)||(S=V(S),isNaN(S)))return E;if(S<0){const B=Math.pow(10,-S);p=Math.round(p/B)*B}else p=p.toFixed(S);if(P)p=p.toString().replace(/,/g,"");else{const B=p.toString().split(".");B[0]=B[0].replace(/\B(?=(\d{3})+$)/g,","),p=B.join(".")}return p}function Wt(p,S){return Pe(p,S)||(p=Ne(p),(S=V(S))instanceof Error?S:new Array(S+1).join(p))}const Os=Xi,Ms=yi;function Wn(p){return/^[01]{1,10}$/.test(p)}function dr(p,S,P){if(_e(p=V(p),S=V(S)))return p;if((P=P===void 0?"i":P)!=="i"&&P!=="j")return E;if(p===0&&S===0)return 0;if(p===0)return S===1?P:S.toString()+P;if(S===0)return p.toString();{const B=S>0?"+":"";return p.toString()+B+(S===1?P:S.toString()+P)}}function Ci(p,S){return S=S===void 0?0:S,_e(p=V(p),S=V(S))?E:d.erf(p)}function vi(p){return isNaN(p)?E:d.erfc(p)}function zn(p){const S=qt(p),P=Kt(p);return _e(S,P)?E:Math.sqrt(Math.pow(S,2)+Math.pow(P,2))}function Kt(p){if(p===void 0||p===!0||p===!1)return E;if(p===0||p==="0")return 0;if(["i","j"].indexOf(p)>=0)return 1;let S=(p=(p+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),P=p.indexOf("-");S===0&&(S=p.indexOf("+",1)),P===0&&(P=p.indexOf("-",1));const B=p.substring(p.length-1,p.length),se=B==="i"||B==="j";return S>=0||P>=0?se?S>=0?isNaN(p.substring(0,S))||isNaN(p.substring(S+1,p.length-1))?T:Number(p.substring(S+1,p.length-1)):isNaN(p.substring(0,P))||isNaN(p.substring(P+1,p.length-1))?T:-Number(p.substring(P+1,p.length-1)):T:se?isNaN(p.substring(0,p.length-1))?T:p.substring(0,p.length-1):isNaN(p)?T:0}function Vr(p){const S=qt(p),P=Kt(p);return _e(S,P)?E:S===0&&P===0?m:S===0&&P>0?Math.PI/2:S===0&&P<0?-Math.PI/2:P===0&&S>0?0:P===0&&S<0?-Math.PI:S>0?Math.atan(P/S):S<0&&P>=0?Math.atan(P/S)+Math.PI:Math.atan(P/S)-Math.PI}function Lr(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.cos(S)*(Math.exp(P)+Math.exp(-P))/2,-Math.sin(S)*(Math.exp(P)-Math.exp(-P))/2,B)}function Kr(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.cos(P)*(Math.exp(S)+Math.exp(-S))/2,Math.sin(P)*(Math.exp(S)-Math.exp(-S))/2,B)}function Dr(p,S){const P=qt(p),B=Kt(p),se=qt(S),fe=Kt(S);if(_e(P,B,se,fe))return E;const be=p.substring(p.length-1),Xe=S.substring(S.length-1);let ut="i";if((be==="j"||Xe==="j")&&(ut="j"),se===0&&fe===0)return T;const Ct=se*se+fe*fe;return dr((P*se+B*fe)/Ct,(B*se-P*fe)/Ct,ut)}function qt(p){if(p===void 0||p===!0||p===!1)return E;if(p===0||p==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(p)>=0)return 0;let S=(p+="").indexOf("+"),P=p.indexOf("-");S===0&&(S=p.indexOf("+",1)),P===0&&(P=p.indexOf("-",1));const B=p.substring(p.length-1,p.length),se=B==="i"||B==="j";return S>=0||P>=0?se?S>=0?isNaN(p.substring(0,S))||isNaN(p.substring(S+1,p.length-1))?T:Number(p.substring(0,S)):isNaN(p.substring(0,P))||isNaN(p.substring(P+1,p.length-1))?T:Number(p.substring(0,P)):T:se?isNaN(p.substring(0,p.length-1))?T:0:isNaN(p)?T:p}function $r(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.sin(S)*(Math.exp(P)+Math.exp(-P))/2,Math.cos(S)*(Math.exp(P)-Math.exp(-P))/2,B)}function Ps(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.cos(P)*(Math.exp(S)-Math.exp(-S))/2,Math.sin(P)*(Math.exp(S)+Math.exp(-S))/2,B)}Ci.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},vi.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const xs=ce.DIST,qn=ce.INV,Do=Fe.DIST,Fs=De.MATH,Si=De.PRECISE,Ls=Le.DIST,$o=Le.DIST.RT,Yn=Le.INV,Kn=Le.INV.RT,Rn=Le.TEST,_i=Ae.P,ko=Ae.P,Ho=Ae.S,Ji=Fe.INV,Ti=vi.PRECISE,Qi=Ci.PRECISE,Ds=je.DIST,sn=ke.DIST,Zi=ke.DIST.RT,wi=ke.INV,$s=ke.INV.RT,Ri=Vt.MATH,bi=Vt.PRECISE,ks=ke.TEST,Ar=pt.DIST,bn=pt.INV,es=A.PRECISE,Xn=K.DIST,Bo=Y.INV,ts=Y.DIST,rs=Y.INV,Jn=ye.MULT,Ai=ye.SNGL,Hs=H.DIST,Uo=pn.INTL,Vo=Q.DIST,Go=Q.INV,ns=Q.S.DIST,jo=Q.S.INV,Wo=Re.EXC,zo=Re.INC,qo=Ce.EXC,Yo=Ce.INC,Bs=We.DIST,Ko=ot.EXC,Xo=ot.INC,Jo=mt.AVG,Qo=mt.EQ,is=Ye.P,Zo=vt.P,ea=vt.S,ta=xt.DIST,Us=xt.DIST.RT,ra=xt.INV,na=xt.TEST,ia=He.P,sa=He.S,oa=It.DIST,aa=nn.INTL,la=gt.TEST;function Qn(p){const S=[];return k(p,P=>{P&&S.push(P)}),S}function mr(p,S){const P={};for(let fe=1;fe<p[0].length;++fe)P[fe]=!0;let B=S[0].length;for(let fe=1;fe<S.length;++fe)S[fe].length>B&&(B=S[fe].length);for(let fe=1;fe<p.length;++fe)for(let be=1;be<p[fe].length;++be){let Xe=!1,ut=!1;for(let Ct=0;Ct<S.length;++Ct){const Ot=S[Ct];if(Ot.length<B)continue;const kt=Ot[0];if(p[fe][0]===kt){ut=!0;for(let Ft=1;Ft<Ot.length;++Ft)if(!Xe)if(Ot[Ft]===void 0||Ot[Ft]==="*")Xe=!0;else{const Gt=it(Ot[Ft]+""),zt=[ze(p[fe][be],$e)].concat(Gt);Xe=Ve(zt)}}}ut&&(P[be]=P[be]&&Xe)}const se=[];for(let fe=0;fe<p[0].length;++fe)P[fe]&&se.push(fe-1);return se}function ss(p){return p&&p.getTime&&!isNaN(p.getTime())}function Ni(p){return p instanceof Date?p:new Date(p)}function on(p,S,P,B,se){if(B=B||0,se=se||0,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se)))return E;let fe;if(p===0)fe=B+P*S;else{const be=Math.pow(1+p,S);fe=se===1?B*be+P*(1+p)*(be-1)/p:B*be+P*(be-1)/p}return-fe}function ls(p,S,P,B,se,fe){if(se=se||0,fe=fe||0,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se),fe=V(fe)))return E;const be=An(p,P,B,se,fe);return(S===1?fe===1?0:-B:fe===1?on(p,S-2,be,B,1)-be:on(p,S-1,be,B,0))*p}function Ii(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=p[0];let P=0;for(let B=1;B<p.length;B++)P+=p[B]/Math.pow(1+S,B);return P}function An(p,S,P,B,se){if(B=B||0,se=se||0,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se)))return E;let fe;if(p===0)fe=(P+B)/S;else{const be=Math.pow(1+p,S);fe=se===1?(B*p/(be-1)+P*p/(1-1/be))/(1+p):B*p/(be-1)+P*p/(1-1/be)}return-fe}const Nn={errors:G,symbols:di};u.ABS=function(p){return(p=V(p))instanceof Error?p:Math.abs(p)},u.ACCRINT=function(p,S,P,B,se,fe,be){return p=Ni(p),S=Ni(S),P=Ni(P),ss(p)&&ss(S)&&ss(P)?B<=0||se<=0||[1,2,4].indexOf(fe)===-1||[0,1,2,3,4].indexOf(be)===-1||P<=p?T:(se=se||0)*B*Ki(p,P,be=be||0):E},u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},u.ACOS=function(p){if((p=V(p))instanceof Error)return p;let S=Math.acos(p);return isNaN(S)&&(S=T),S},u.ACOSH=function(p){if((p=V(p))instanceof Error)return p;let S=Math.log(p+Math.sqrt(p*p-1));return isNaN(S)&&(S=T),S},u.ACOT=function(p){return(p=V(p))instanceof Error?p:Math.atan(1/p)},u.ACOTH=function(p){if((p=V(p))instanceof Error)return p;let S=.5*Math.log((p+1)/(p-1));return isNaN(S)&&(S=T),S},u.AGGREGATE=function(p,S,P,B){if(_e(p=V(p),V(p)))return E;switch(p){case 1:return F(P);case 2:return re(P);case 3:return me(P);case 4:return oe(P);case 5:return ee(P);case 6:return pr(P);case 7:return vt.S(P);case 8:return vt.P(P);case 9:return Qt(P);case 10:return He.S(P);case 11:return He.P(P);case 12:return Te(P);case 13:return ye.SNGL(P);case 14:return L(P,B);case 15:return Et(P,B);case 16:return Re.INC(P,B);case 17:return ot.INC(P,B);case 18:return Re.EXC(P,B);case 19:return ot.EXC(P,B)}},u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},u.AND=function(){const p=Z(arguments);let S=E;for(let P=0;P<p.length;P++){if(p[P]instanceof Error)return p[P];p[P]!==void 0&&p[P]!==null&&typeof p[P]!="string"&&(S===E&&(S=!0),p[P]||(S=!1))}return S},u.ARABIC=function(p){if(p==null)return 0;if(p instanceof Error)return p;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(p))return E;let S=0;return p.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,P=>{S+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[P]}),S},u.ASC=function(){throw new Error("ASC is not implemented")},u.ASIN=function(p){if((p=V(p))instanceof Error)return p;let S=Math.asin(p);return isNaN(S)&&(S=T),S},u.ASINH=function(p){return(p=V(p))instanceof Error?p:Math.log(p+Math.sqrt(p*p+1))},u.ATAN=function(p){return(p=V(p))instanceof Error?p:Math.atan(p)},u.ATAN2=function(p,S){return Pe(p=V(p),S=V(S))||Math.atan2(p,S)},u.ATANH=function(p){if((p=V(p))instanceof Error)return p;let S=Math.log((1+p)/(1-p))/2;return isNaN(S)&&(S=T),S},u.AVEDEV=function(){const p=Z(arguments).filter(Ue);if(p.length===0)return T;const S=ue(p);return S instanceof Error?S:d.sum(d(S).subtract(d.mean(S)).abs()[0])/S.length},u.AVERAGE=F,u.AVERAGEA=b,u.AVERAGEIF=function(p,S,P){if(arguments.length<=1)return R;if(P=ue(Z(P=P||p).filter(Ue)),p=Z(p),P instanceof Error)return P;let B=0,se=0;const fe=S===void 0||S==="*",be=fe?null:it(S+"");for(let Xe=0;Xe<p.length;Xe++){const ut=p[Xe];if(fe)se+=P[Xe],B++;else{const Ct=[ze(ut,$e)].concat(be);Ve(Ct)&&(se+=P[Xe],B++)}}return se/B},u.AVERAGEIFS=function(){const p=D(arguments),S=(p.length-1)/2,P=Z(p[0]);let B=0,se=0;for(let be=0;be<P.length;be++){let Xe=!1;for(let ut=0;ut<S;ut++){const Ct=p[2*ut+1][be],Ot=p[2*ut+2];let kt=!1;if(Ot===void 0||Ot==="*")kt=!0;else{const Ft=it(Ot+""),Gt=[ze(Ct,$e)].concat(Ft);kt=Ve(Gt)}if(!kt){Xe=!1;break}Xe=!0}Xe&&(se+=P[be],B++)}const fe=se/B;return isNaN(fe)?0:fe},u.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},u.BASE=function(p,S,P){const B=Pe(p=V(p),S=V(S),P=V(P));if(B)return B;if(S===0)return T;const se=p.toString(S);return new Array(Math.max(P+1-se.length,0)).join("0")+se},u.BESSELI=function(p,S){return _e(p=V(p),S=V(S))?E:f.besseli(p,S)},u.BESSELJ=function(p,S){return _e(p=V(p),S=V(S))?E:f.besselj(p,S)},u.BESSELK=function(p,S){return _e(p=V(p),S=V(S))?E:f.besselk(p,S)},u.BESSELY=function(p,S){return _e(p=V(p),S=V(S))?E:f.bessely(p,S)},u.BETA=ce,u.BETADIST=xs,u.BETAINV=qn,u.BIN2DEC=function(p){if(!Wn(p))return T;const S=parseInt(p,2),P=p.toString();return P.length===10&&P.substring(0,1)==="1"?parseInt(P.substring(1),2)-512:S},u.BIN2HEX=function(p,S){if(!Wn(p))return T;const P=p.toString();if(P.length===10&&P.substring(0,1)==="1")return(0xfffffffe00+parseInt(P.substring(1),2)).toString(16);const B=parseInt(p,2).toString(16);return S===void 0?B:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=B.length?Wt("0",S-B.length)+B:T},u.BIN2OCT=function(p,S){if(!Wn(p))return T;const P=p.toString();if(P.length===10&&P.substring(0,1)==="1")return(1073741312+parseInt(P.substring(1),2)).toString(8);const B=parseInt(p,2).toString(8);return S===void 0?B:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=B.length?Wt("0",S-B.length)+B:T},u.BINOM=Fe,u.BINOMDIST=Do,u.BITAND=function(p,S){return _e(p=V(p),S=V(S))?E:p<0||S<0||Math.floor(p)!==p||Math.floor(S)!==S||p>0xffffffffffff||S>0xffffffffffff?T:p&S},u.BITLSHIFT=function(p,S){return _e(p=V(p),S=V(S))?E:p<0||Math.floor(p)!==p||p>0xffffffffffff||Math.abs(S)>53?T:S>=0?p<<S:p>>-S},u.BITOR=function(p,S){return _e(p=V(p),S=V(S))?E:p<0||S<0||Math.floor(p)!==p||Math.floor(S)!==S||p>0xffffffffffff||S>0xffffffffffff?T:p|S},u.BITRSHIFT=function(p,S){return _e(p=V(p),S=V(S))?E:p<0||Math.floor(p)!==p||p>0xffffffffffff||Math.abs(S)>53?T:S>=0?p>>S:p<<-S},u.BITXOR=function(p,S){return _e(p=V(p),S=V(S))?E:p<0||S<0||Math.floor(p)!==p||Math.floor(S)!==S||p>0xffffffffffff||S>0xffffffffffff?T:p^S},u.CEILING=De,u.CEILINGMATH=Fs,u.CEILINGPRECISE=Si,u.CELL=function(){throw new Error("CELL is not implemented")},u.CHAR=Xi,u.CHIDIST=Ls,u.CHIDISTRT=$o,u.CHIINV=Yn,u.CHIINVRT=Kn,u.CHISQ=Le,u.CHITEST=Rn,u.CHOOSE=function(){if(arguments.length<2)return R;const p=arguments[0];return p<1||p>254||arguments.length<p+1?E:arguments[p]},u.CLEAN=function(p){return _e(p)?p:(p=p||"").replace(/[\0-\x1F]/g,"")},u.CODE=yi,u.COLUMN=function(p,S){return arguments.length!==2?R:S<0?T:p instanceof Array&&typeof S=="number"?p.length!==0?d.col(p,S):void 0:E},u.COLUMNS=function(p){return arguments.length!==1?R:p instanceof Array?p.length===0?0:d.cols(p):E},u.COMBIN=ht,u.COMBINA=function(p,S){return Pe(p=V(p),S=V(S))||(p<S?T:p===0&&S===0?1:ht(p+S-1,p-1))},u.COMPLEX=dr,u.CONCAT=Lo,u.CONCATENATE=wn,u.CONFIDENCE=ae,u.CONVERT=function(p,S,P){if((p=V(p))instanceof Error)return p;const B=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],se={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},fe={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let be,Xe=null,ut=null,Ct=S,Ot=P,kt=1,Ft=1;for(let Gt=0;Gt<B.length;Gt++)be=B[Gt][2]===null?[]:B[Gt][2],(B[Gt][1]===Ct||be.indexOf(Ct)>=0)&&(Xe=B[Gt]),(B[Gt][1]===Ot||be.indexOf(Ot)>=0)&&(ut=B[Gt]);if(Xe===null){const Gt=se[S.substring(0,2)];let zt=fe[S.substring(0,1)];S.substring(0,2)==="da"&&(zt=["dekao",10,"da"]),Gt?(kt=Gt[2],Ct=S.substring(2)):zt&&(kt=zt[1],Ct=S.substring(zt[2].length));for(let Yt=0;Yt<B.length;Yt++)be=B[Yt][2]===null?[]:B[Yt][2],(B[Yt][1]===Ct||be.indexOf(Ct)>=0)&&(Xe=B[Yt])}if(ut===null){const Gt=se[P.substring(0,2)];let zt=fe[P.substring(0,1)];P.substring(0,2)==="da"&&(zt=["dekao",10,"da"]),Gt?(Ft=Gt[2],Ot=P.substring(2)):zt&&(Ft=zt[1],Ot=P.substring(zt[2].length));for(let Yt=0;Yt<B.length;Yt++)be=B[Yt][2]===null?[]:B[Yt][2],(B[Yt][1]===Ot||be.indexOf(Ot)>=0)&&(ut=B[Yt])}return Xe===null||ut===null||Xe[3]!==ut[3]?R:p*Xe[6]*kt/(ut[6]*Ft)},u.CORREL=function(p,S){return _e(p=ue(Z(p)),S=ue(Z(S)))?E:d.corrcoeff(p,S)},u.COS=function(p){return(p=V(p))instanceof Error?p:Math.cos(p)},u.COSH=function(p){return(p=V(p))instanceof Error?p:(Math.exp(p)+Math.exp(-p))/2},u.COT=function(p){return(p=V(p))instanceof Error?p:p===0?m:1/Math.tan(p)},u.COTH=function(p){if((p=V(p))instanceof Error)return p;if(p===0)return m;const S=Math.exp(2*p);return(S+1)/(S-1)},u.COUNT=re,u.COUNTA=me,u.COUNTBLANK=he,u.COUNTIF=function(p,S){if(p=Z(p),S===void 0||S==="*")return p.length;let P=0;const B=it(S+"");for(let se=0;se<p.length;se++){const fe=[ze(p[se],$e)].concat(B);Ve(fe)&&P++}return P},u.COUNTIFS=function(){const p=D(arguments),S=new Array(Z(p[0]).length);for(let B=0;B<S.length;B++)S[B]=!0;for(let B=0;B<p.length;B+=2){const se=Z(p[B]),fe=p[B+1];if(fe!==void 0&&fe!=="*"){const be=it(fe+"");for(let Xe=0;Xe<se.length;Xe++){const ut=[ze(se[Xe],$e)].concat(be);S[Xe]=S[Xe]&&Ve(ut)}}}let P=0;for(let B=0;B<S.length;B++)S[B]&&P++;return P},u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},u.COVAR=_i,u.COVARIANCE=Ae,u.COVARIANCEP=ko,u.COVARIANCES=Ho,u.CRITBINOM=Ji,u.CSC=function(p){return(p=V(p))instanceof Error?p:p===0?m:1/Math.sin(p)},u.CSCH=function(p){return(p=V(p))instanceof Error?p:p===0?m:2/(Math.exp(p)-Math.exp(-p))},u.CUMIPMT=function(p,S,P,B,se,fe){if(_e(p=V(p),S=V(S),P=V(P)))return E;if(p<=0||S<=0||P<=0||B<1||se<1||B>se||fe!==0&&fe!==1)return T;const be=An(p,S,P,0,fe);let Xe=0;B===1&&(fe===0&&(Xe=-P),B++);for(let ut=B;ut<=se;ut++)Xe+=fe===1?on(p,ut-2,be,P,1)-be:on(p,ut-1,be,P,0);return Xe*=p,Xe},u.CUMPRINC=function(p,S,P,B,se,fe){if(_e(p=V(p),S=V(S),P=V(P)))return E;if(p<=0||S<=0||P<=0||B<1||se<1||B>se||fe!==0&&fe!==1)return T;const be=An(p,S,P,0,fe);let Xe=0;B===1&&(Xe=fe===0?be+P*p:be,B++);for(let ut=B;ut<=se;ut++)Xe+=fe>0?be-(on(p,ut-2,be,P,1)-be)*p:be-on(p,ut-1,be,P,0)*p;return Xe},u.DATE=function(p,S,P){let B;return _e(p=V(p),S=V(S),P=V(P))?B=E:(B=new Date(p,S-1,P),B.getFullYear()<0&&(B=T)),B},u.DATEDIF=Cr,u.DATEVALUE=function(p){if(typeof p!="string")return E;const S=Date.parse(p);return isNaN(S)?E:new Date(p)},u.DAVERAGE=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);let fe=0;return k(B,be=>{fe+=se[be]}),B.length===0?m:fe/B.length},u.DAY=function(p){const S=U(p);return S instanceof Error?S:S.getDate()},u.DAYS=fn,u.DAYS360=rn,u.DB=function(p,S,P,B,se){if(se=se===void 0?12:se,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se)))return E;if(p<0||S<0||P<0||B<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(se)===-1||B>P)return T;if(S>=p)return 0;const fe=(1-Math.pow(S/p,1/P)).toFixed(3),be=p*fe*se/12;let Xe=be,ut=0;const Ct=B===P?P-1:B;for(let Ot=2;Ot<=Ct;Ot++)ut=(p-Xe)*fe,Xe+=ut;return B===1?be:B===P?(p-Xe)*fe:ut},u.DBCS=function(){throw new Error("DBCS is not implemented")},u.DCOUNT=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);const fe=[];return k(B,be=>{fe.push(se[be])}),re(fe)},u.DCOUNTA=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);const fe=[];return k(B,be=>{fe.push(se[be])}),me(fe)},u.DDB=function(p,S,P,B,se){if(se=se===void 0?2:se,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se)))return E;if(p<0||S<0||P<0||B<0||se<=0||B>P)return T;if(S>=p)return 0;let fe=0,be=0;for(let Xe=1;Xe<=B;Xe++)be=Math.min(se/P*(p-fe),p-S-fe),fe+=be;return be},u.DEC2BIN=function(p,S){if((p=V(p))instanceof Error)return p;if(!/^-?[0-9]{1,3}$/.test(p)||p<-512||p>511)return T;if(p<0)return"1"+Wt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const P=parseInt(p,10).toString(2);return S===void 0?P:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=P.length?Wt("0",S-P.length)+P:T},u.DEC2HEX=function(p,S){if((p=V(p))instanceof Error)return p;if(!/^-?[0-9]{1,12}$/.test(p)||p<-549755813888||p>549755813887)return T;if(p<0)return(1099511627776+p).toString(16);const P=parseInt(p,10).toString(16);return S===void 0?P:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=P.length?Wt("0",S-P.length)+P:T},u.DEC2OCT=function(p,S){if((p=V(p))instanceof Error)return p;if(!/^-?[0-9]{1,9}$/.test(p)||p<-536870912||p>536870911)return T;if(p<0)return(1073741824+p).toString(8);const P=parseInt(p,10).toString(8);return S===void 0?P:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=P.length?Wt("0",S-P.length)+P:T},u.DECIMAL=function(p,S){return arguments.length<1?E:Pe(p=V(p),S=V(S))||(S===0?T:parseInt(p,S))},u.DEGREES=function(p){return(p=V(p))instanceof Error?p:180*p/Math.PI},u.DELTA=function(p,S){return S=S===void 0?0:S,_e(p=V(p),S=V(S))?E:p===S?1:0},u.DEVSQ=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=d.mean(p);let P=0;for(let B=0;B<p.length;B++)P+=Math.pow(p[B]-S,2);return P},u.DGET=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];return se=de(typeof S=="string"?p[Me(p,S)]:p[S]),B.length===0?E:B.length>1?T:se[B[0]]},u.DISC=function(p,S,P,B,se){if(_e(p=U(p),S=U(S),P=V(P),B=V(B),se=(se=V(se))||0))return E;if(P<=0||B<=0)return T;if(p>=S)return E;let fe,be;switch(se){case 0:fe=360,be=rn(p,S,!1);break;case 1:case 3:fe=365,be=Cr(p,S,"D");break;case 2:fe=360,be=Cr(p,S,"D");break;case 4:fe=360,be=rn(p,S,!0);break;default:return T}return(B-P)/B*fe/be},u.DMAX=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);let fe=se[B[0]];return k(B,be=>{fe<se[be]&&(fe=se[be])}),fe},u.DMIN=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);let fe=se[B[0]];return k(B,be=>{fe>se[be]&&(fe=se[be])}),fe},u.DOLLAR=function(p,S=2){if(p=V(p),isNaN(p))return E;const P={style:"currency",currency:"USD",minimumFractionDigits:S>=0?S:0,maximumFractionDigits:S>=0?S:0},B=(p=cr(p,S)).toLocaleString("en-US",P);return p<0?"$("+B.slice(2)+")":B},u.DOLLARDE=function(p,S){if(_e(p=V(p),S=V(S)))return E;if(S<0)return T;if(S>=0&&S<1)return m;S=parseInt(S,10);let P=parseInt(p,10);P+=p%1*Math.pow(10,Math.ceil(Math.log(S)/Math.LN10))/S;const B=Math.pow(10,Math.ceil(Math.log(S)/Math.LN2)+1);return P=Math.round(P*B)/B,P},u.DOLLARFR=function(p,S){if(_e(p=V(p),S=V(S)))return E;if(S<0)return T;if(S>=0&&S<1)return m;S=parseInt(S,10);let P=parseInt(p,10);return P+=p%1*Math.pow(10,-Math.ceil(Math.log(S)/Math.LN10))*S,P},u.DPRODUCT=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const Xe=Me(p,S);se=de(p[Xe])}else se=de(p[S]);let fe=[];k(B,Xe=>{fe.push(se[Xe])}),fe=Qn(fe);let be=1;return k(fe,Xe=>{be*=Xe}),be},u.DSTDEV=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);let fe=[];return k(B,be=>{fe.push(se[be])}),fe=Qn(fe),vt.S(fe)},u.DSTDEVP=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);let fe=[];return k(B,be=>{fe.push(se[be])}),fe=Qn(fe),vt.P(fe)},u.DSUM=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);const fe=[];return k(B,be=>{fe.push(se[be])}),Qt(fe)},u.DURATION=function(){throw new Error("DURATION is not implemented")},u.DVAR=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);const fe=[];return k(B,be=>{fe.push(se[be])}),He.S(fe)},u.DVARP=function(p,S,P){if(isNaN(S)&&typeof S!="string")return E;const B=mr(p,P);let se=[];if(typeof S=="string"){const be=Me(p,S);se=de(p[be])}else se=de(p[S]);const fe=[];return k(B,be=>{fe.push(se[be])}),He.P(fe)},u.EDATE=function(p,S){return(p=U(p))instanceof Error?p:isNaN(S)?E:(S=parseInt(S,10),p.setMonth(p.getMonth()+S),p)},u.EFFECT=function(p,S){return _e(p=V(p),S=V(S))?E:p<=0||S<1?T:(S=parseInt(S,10),Math.pow(1+p/S,S)-1)},u.EOMONTH=function(p,S){return(p=U(p))instanceof Error?p:isNaN(S)?E:(S=parseInt(S,10),new Date(p.getFullYear(),p.getMonth()+S+1,0))},u.ERF=Ci,u.ERFC=vi,u.ERFCPRECISE=Ti,u.ERFPRECISE=Qi,u.ERROR=Qe,u.EVEN=function(p){return(p=V(p))instanceof Error?p:De(p,-2,-1)},u.EXACT=function(p,S){return arguments.length!==2?R:Pe(p,S)||(p=Ne(p))===Ne(S)},u.EXP=function(p){return arguments.length<1?R:arguments.length>1?O:(p=V(p))instanceof Error?p:p=Math.exp(p)},u.EXPON=je,u.EXPONDIST=Ds,u.F=ke,u.FACT=Pt,u.FACTDOUBLE=function p(S){if((S=V(S))instanceof Error)return S;const P=Math.floor(S);return P<=0?1:P*p(P-2)},u.FALSE=function(){return!1},u.FDIST=sn,u.FDISTRT=Zi,u.FIND=function(p,S,P){if(arguments.length<2)return R;p=Ne(p),P=P===void 0?0:P;const B=(S=Ne(S)).indexOf(p,P-1);return B===-1?E:B+1},u.FINV=wi,u.FINVRT=$s,u.FISHER=function(p){return(p=V(p))instanceof Error?p:Math.log((1+p)/(1-p))/2},u.FISHERINV=function(p){if((p=V(p))instanceof Error)return p;const S=Math.exp(2*p);return(S-1)/(S+1)},u.FIXED=Ei,u.FLOOR=Vt,u.FLOORMATH=Ri,u.FLOORPRECISE=bi,u.FORECAST=et,u.FREQUENCY=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=p.length,B=S.length,se=[];for(let fe=0;fe<=B;fe++){se[fe]=0;for(let be=0;be<P;be++)fe===0?p[be]<=S[0]&&(se[0]+=1):fe<B?p[be]>S[fe-1]&&p[be]<=S[fe]&&(se[fe]+=1):fe===B&&p[be]>S[B-1]&&(se[B]+=1)}return se},u.FTEST=ks,u.FV=on,u.FVSCHEDULE=function(p,S){if(_e(p=V(p),S=ue(Z(S))))return E;const P=S.length;let B=p;for(let se=0;se<P;se++)B*=1+S[se];return B},u.GAMMA=pt,u.GAMMADIST=Ar,u.GAMMAINV=bn,u.GAMMALN=A,u.GAMMALNPRECISE=es,u.GAUSS=function(p){return(p=V(p))instanceof Error?p:d.normal.cdf(p,0,1)-.5},u.GCD=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=p.length,P=p[0];let B=P<0?-P:P;for(let se=1;se<S;se++){const fe=p[se];let be=fe<0?-fe:fe;for(;B&&be;)B>be?B%=be:be%=B;B+=be}return B},u.GEOMEAN=function(){const p=ue(Z(arguments));return p instanceof Error?p:d.geomean(p)},u.GESTEP=function(p,S){return _e(S=S||0,p=V(p))?p:p>=S?1:0},u.GROWTH=function(p,S,P,B){if((p=ue(p))instanceof Error)return p;let se;if(S===void 0)for(S=[],se=1;se<=p.length;se++)S.push(se);if(P===void 0)for(P=[],se=1;se<=p.length;se++)P.push(se);if(_e(S=ue(S),P=ue(P)))return E;B===void 0&&(B=!0);const fe=p.length;let be,Xe,ut=0,Ct=0,Ot=0,kt=0;for(se=0;se<fe;se++){const Gt=S[se],zt=Math.log(p[se]);ut+=Gt,Ct+=zt,Ot+=Gt*zt,kt+=Gt*Gt}ut/=fe,Ct/=fe,Ot/=fe,kt/=fe,B?(be=(Ot-ut*Ct)/(kt-ut*ut),Xe=Ct-be*ut):(be=Ot/kt,Xe=0);const Ft=[];for(se=0;se<P.length;se++)Ft.push(Math.exp(Xe+be*P[se]));return Ft},u.HARMEAN=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=p.length;let P=0;for(let B=0;B<S;B++)P+=1/p[B];return S/P},u.HEX2BIN=function(p,S){if(!/^[0-9A-Fa-f]{1,10}$/.test(p))return T;const P=!(p.length!==10||p.substring(0,1).toLowerCase()!=="f"),B=P?parseInt(p,16)-1099511627776:parseInt(p,16);if(B<-512||B>511)return T;if(P)return"1"+Wt("0",9-(512+B).toString(2).length)+(512+B).toString(2);const se=B.toString(2);return S===void 0?se:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=se.length?Wt("0",S-se.length)+se:T},u.HEX2DEC=function(p){if(!/^[0-9A-Fa-f]{1,10}$/.test(p))return T;const S=parseInt(p,16);return S>=549755813888?S-1099511627776:S},u.HEX2OCT=function(p,S){if(!/^[0-9A-Fa-f]{1,10}$/.test(p))return T;const P=parseInt(p,16);if(P>536870911&&P<0xffe0000000)return T;if(P>=0xffe0000000)return(P-0xffc0000000).toString(8);const B=P.toString(8);return S===void 0?B:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=B.length?Wt("0",S-B.length)+B:T},u.HLOOKUP=function(p,S,P,B){return X(p,Se(S),P,B)},u.HOUR=function(p){return(p=U(p))instanceof Error?p:p.getHours()},u.HYPGEOM=K,u.HYPGEOMDIST=Xn,u.IF=function(p,S,P){return p instanceof Error?p:((S=!(arguments.length>=2)||S)==null&&(S=0),(P=arguments.length===3&&P)==null&&(P=0),p?S:P)},u.IFERROR=function(p,S){return Ze(p)?S:p},u.IFNA=function(p,S){return p===R?S:p},u.IFS=function(){for(let p=0;p<arguments.length/2;p++)if(arguments[2*p])return arguments[2*p+1];return R},u.IMABS=zn,u.IMAGINARY=Kt,u.IMARGUMENT=Vr,u.IMCONJUGATE=function(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",P!==0?dr(S,-P,B):p},u.IMCOS=Lr,u.IMCOSH=Kr,u.IMCOT=function(p){return _e(qt(p),Kt(p))?E:Dr(Lr(p),$r(p))},u.IMCSC=function(p){return p===!0||p===!1?E:_e(qt(p),Kt(p))?T:Dr("1",$r(p))},u.IMCSCH=function(p){return p===!0||p===!1?E:_e(qt(p),Kt(p))?T:Dr("1",Ps(p))},u.IMDIV=Dr,u.IMEXP=function(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);B=B==="i"||B==="j"?B:"i";const se=Math.exp(S);return dr(se*Math.cos(P),se*Math.sin(P),B)},u.IMLN=function(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.log(Math.sqrt(S*S+P*P)),Math.atan(P/S),B)},u.IMLOG10=function(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.log(Math.sqrt(S*S+P*P))/Math.log(10),Math.atan(P/S)/Math.log(10),B)},u.IMLOG2=function(p){const S=qt(p),P=Kt(p);if(_e(S,P))return E;let B=p.substring(p.length-1);return B=B==="i"||B==="j"?B:"i",dr(Math.log(Math.sqrt(S*S+P*P))/Math.log(2),Math.atan(P/S)/Math.log(2),B)},u.IMPOWER=function(p,S){if(_e(S=V(S),qt(p),Kt(p)))return E;let P=p.substring(p.length-1);P=P==="i"||P==="j"?P:"i";const B=Math.pow(zn(p),S),se=Vr(p);return dr(B*Math.cos(S*se),B*Math.sin(S*se),P)},u.IMPRODUCT=function(){let p=arguments[0];if(!arguments.length)return E;for(let S=1;S<arguments.length;S++){const P=qt(p),B=Kt(p),se=qt(arguments[S]),fe=Kt(arguments[S]);if(_e(P,B,se,fe))return E;p=dr(P*se-B*fe,P*fe+B*se)}return p},u.IMREAL=qt,u.IMSEC=function(p){return p===!0||p===!1||_e(qt(p),Kt(p))?E:Dr("1",Lr(p))},u.IMSECH=function(p){return _e(qt(p),Kt(p))?E:Dr("1",Kr(p))},u.IMSIN=$r,u.IMSINH=Ps,u.IMSQRT=function(p){if(_e(qt(p),Kt(p)))return E;let S=p.substring(p.length-1);S=S==="i"||S==="j"?S:"i";const P=Math.sqrt(zn(p)),B=Vr(p);return dr(P*Math.cos(B/2),P*Math.sin(B/2),S)},u.IMSUB=function(p,S){const P=qt(p),B=Kt(p),se=qt(S),fe=Kt(S);if(_e(P,B,se,fe))return E;const be=p.substring(p.length-1),Xe=S.substring(S.length-1);let ut="i";return(be==="j"||Xe==="j")&&(ut="j"),dr(P-se,B-fe,ut)},u.IMSUM=function(){if(!arguments.length)return E;const p=Z(arguments);let S=p[0];for(let P=1;P<p.length;P++){const B=qt(S),se=Kt(S),fe=qt(p[P]),be=Kt(p[P]);if(_e(B,se,fe,be))return E;S=dr(B+fe,se+be)}return S},u.IMTAN=function(p){return p===!0||p===!1||_e(qt(p),Kt(p))?E:Dr($r(p),Lr(p))},u.INDEX=function(p,S,P){const B=Pe(p,S,P);if(B)return B;if(!Array.isArray(p))return E;const se=p.length>0&&!Array.isArray(p[0]);return se&&!P?(P=S,S=1):(P=P||1,S=S||1),P<0||S<0?E:se&&S===1&&P<=p.length?p[P-1]:S<=p.length&&P<=p[S-1].length?p[S-1][P-1]:v},u.INFO=function(){throw new Error("INFO is not implemented")},u.INT=function(p){return(p=V(p))instanceof Error?p:Math.floor(p)},u.INTERCEPT=function(p,S){return _e(p=ue(p),S=ue(S))?E:p.length!==S.length?R:et(0,p,S)},u.INTRATE=function(){throw new Error("INTRATE is not implemented")},u.IPMT=ls,u.IRR=function(p,S){if(S=S||0,_e(p=ue(Z(p)),S=V(S)))return E;const P=(Ft,Gt,zt)=>{const Yt=zt+1;let _r=Ft[0];for(let rr=1;rr<Ft.length;rr++)_r+=Ft[rr]/Math.pow(Yt,(Gt[rr]-Gt[0])/365);return _r},B=(Ft,Gt,zt)=>{const Yt=zt+1;let _r=0;for(let rr=1;rr<Ft.length;rr++){const an=(Gt[rr]-Gt[0])/365;_r-=an*Ft[rr]/Math.pow(Yt,an+1)}return _r},se=[];let fe=!1,be=!1;for(let Ft=0;Ft<p.length;Ft++)se[Ft]=Ft===0?0:se[Ft-1]+365,p[Ft]>0&&(fe=!0),p[Ft]<0&&(be=!0);if(!fe||!be)return T;let Xe,ut,Ct,Ot=S=S===void 0?.1:S,kt=!0;do Ct=P(p,se,Ot),Xe=Ot-Ct/B(p,se,Ot),ut=Math.abs(Xe-Ot),Ot=Xe,kt=ut>1e-10&&Math.abs(Ct)>1e-10;while(kt);return Ot},u.ISBLANK=function(p){return p===null},u.ISERR=nt,u.ISERROR=Ze,u.ISEVEN=function(p){return!(1&Math.floor(Math.abs(p)))},u.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},u.ISLOGICAL=at,u.ISNA=function(p){return p===R},u.ISNONTEXT=function(p){return typeof p!="string"},u.ISNUMBER=St,u.ISO=Nt,u.ISODD=function(p){return!!(1&Math.floor(Math.abs(p)))},u.ISOWEEKNUM=jn,u.ISPMT=function(p,S,P,B){return _e(p=V(p),S=V(S),P=V(P),B=V(B))?E:B*p*(S/P-1)},u.ISREF=function(){throw new Error("ISREF is not implemented")},u.ISTEXT=bt,u.KURT=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;const S=d.mean(p),P=p.length;let B=0;for(let se=0;se<P;se++)B+=Math.pow(p[se]-S,4);return B/=Math.pow(d.stdev(p,!0),4),P*(P+1)/((P-1)*(P-2)*(P-3))*B-3*(P-1)*(P-1)/((P-2)*(P-3))},u.LARGE=L,u.LCM=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;for(var S,P,B,se,fe=1;(B=p.pop())!==void 0;){if(B===0)return 0;for(;B>1;){if(B%2){for(S=3,P=Math.floor(Math.sqrt(B));S<=P&&B%S;S+=2);se=S<=P?S:B}else se=2;for(B/=se,fe*=se,S=p.length;S;p[--S]%se==0&&(p[S]/=se)==1&&p.splice(S,1));}}return fe},u.LEFT=function(p,S){return Pe(p,S)||(p=Ne(p),(S=V(S=S===void 0?1:S))instanceof Error||typeof p!="string"?E:p.substring(0,S))},u.LEN=function(p){return arguments.length===0?O:p instanceof Error?p:Array.isArray(p)?E:Ne(p).length},u.LINEST=j,u.LN=function(p){return(p=V(p))instanceof Error?p:p===0?T:Math.log(p)},u.LOG=function(p,S){return Pe(p=V(p),S=V(S))||(p===0||S===0?T:Math.log(p)/Math.log(S))},u.LOG10=function(p){return(p=V(p))instanceof Error?p:p===0?T:Math.log(p)/Math.log(10)},u.LOGEST=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S)))||p.length!==S.length)return E;for(let B=0;B<p.length;B++)p[B]=Math.log(p[B]);const P=j(p,S);return P[0]=Math.round(1e6*Math.exp(P[0]))/1e6,P[1]=Math.round(1e6*Math.exp(P[1]))/1e6,P},u.LOGINV=Bo,u.LOGNORM=Y,u.LOGNORMDIST=ts,u.LOGNORMINV=rs,u.LOOKUP=function(p,S,P){S=Z(S),P=P?Z(P):S;const B=typeof p=="number";let se=R;for(let fe=0;fe<S.length;fe++){if(S[fe]===p)return P[fe];if(B&&S[fe]<=p||typeof S[fe]=="string"&&S[fe].localeCompare(p)<0)se=P[fe];else if(B&&S[fe]>p)return se}return se},u.LOWER=function(p){return arguments.length!==1?E:_e(p=Ne(p))?p:p.toLowerCase()},u.MATCH=function(p,S,P){if(!p||!S||(arguments.length===2&&(P=1),!((S=Z(S))instanceof Array))||P!==-1&&P!==0&&P!==1)return R;let B,se;for(let fe=0;fe<S.length;fe++)if(P===1){if(S[fe]===p)return fe+1;S[fe]<p&&(se?S[fe]>se&&(B=fe+1,se=S[fe]):(B=fe+1,se=S[fe]))}else if(P===0){if(typeof p=="string"&&typeof S[fe]=="string"){const be=p.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+be+"$").test(S[fe].toLowerCase()))return fe+1}else if(S[fe]===p)return fe+1}else if(P===-1){if(S[fe]===p)return fe+1;S[fe]>p&&(se?S[fe]<se&&(B=fe+1,se=S[fe]):(B=fe+1,se=S[fe]))}return B||R},u.MAX=oe,u.MAXA=function(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;let P=z(p);return P=P.map(B=>B??0),P.length===0?0:Math.max.apply(Math,P)},u.MDURATION=function(){throw new Error("MDURATION is not implemented")},u.MEDIAN=Te,u.MID=function(p,S,P){if(S==null)return E;if(_e(S=V(S),P=V(P))||typeof p!="string")return P;const B=S-1,se=B+P;return p.substring(B,se)},u.MIN=ee,u.MINA=function(){const p=Z(arguments),S=Pe.apply(void 0,p);if(S)return S;let P=z(p);return P=P.map(B=>B??0),P.length===0?0:Math.min.apply(Math,P)},u.MINUTE=function(p){return(p=U(p))instanceof Error?p:p.getMinutes()},u.MIRR=function(p,S,P){if(_e(p=ue(Z(p)),S=V(S),P=V(P)))return E;const B=p.length,se=[],fe=[];for(let ut=0;ut<B;ut++)p[ut]<0?se.push(p[ut]):fe.push(p[ut]);const be=-Ii(P,fe)*Math.pow(1+P,B-1),Xe=Ii(S,se)*(1+S);return Math.pow(be/Xe,1/(B-1))-1},u.MMULT=function(p,S){return!Array.isArray(p)||!Array.isArray(S)||p.some(P=>!P.length)||S.some(P=>!P.length)||ve(p).some(P=>typeof P!="number")||ve(S).some(P=>typeof P!="number")||p[0].length!==S.length?E:Array(p.length).fill(0).map(()=>Array(S[0].length).fill(0)).map((P,B)=>P.map((se,fe)=>p[B].reduce((be,Xe,ut)=>be+Xe*S[ut][fe],0)))},u.MOD=function(p,S){const P=Pe(p=V(p),S=V(S));if(P)return P;if(S===0)return m;let B=Math.abs(p%S);return B=p<0?S-B:B,S>0?B:-B},u.MODE=ye,u.MODEMULT=Jn,u.MODESNGL=Ai,u.MONTH=function(p){return(p=U(p))instanceof Error?p:p.getMonth()+1},u.MROUND=function(p,S){return Pe(p=V(p),S=V(S))||(p*S==0?0:p*S<0?T:Math.round(p/S)*S)},u.MULTINOMIAL=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;let S=0,P=1;for(let B=0;B<p.length;B++)S+=p[B],P*=Pt(p[B]);return Pt(S)/P},u.MUNIT=function(p){return arguments.length>1?R:!(p=parseInt(p))||p<=0?E:Array(p).fill(0).map(()=>Array(p).fill(0)).map((S,P)=>(S[P]=1,S))},u.N=function(p){return St(p)?p:p instanceof Date?p.getTime():p===!0?1:p===!1?0:Ze(p)?p:0},u.NA=function(){return R},u.NEGBINOM=H,u.NEGBINOMDIST=Hs,u.NETWORKDAYS=pn,u.NETWORKDAYSINTL=Uo,u.NOMINAL=function(p,S){return _e(p=V(p),S=V(S))?E:p<=0||S<1?T:(S=parseInt(S,10),(Math.pow(p+1,1/S)-1)*S)},u.NORM=Q,u.NORMDIST=Vo,u.NORMINV=Go,u.NORMSDIST=ns,u.NORMSINV=jo,u.NOT=function(p){return typeof p=="string"?E:p instanceof Error?p:!p},u.NOW=function(){return new Date},u.NPER=function(p,S,P,B,se){if(se=se===void 0?0:se,B=B===void 0?0:B,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se)))return E;if(p===0)return-(P+B)/S;{const fe=S*(1+p*se)-B*p,be=P*p+S*(1+p*se);return Math.log(fe/be)/Math.log(1+p)}},u.NPV=Ii,u.NUMBERVALUE=function(p,S,P){return typeof(p=Ue(p)?p:"")=="number"?p:typeof p!="string"?R:(S=S===void 0?".":S,P=P===void 0?",":P,Number(p.replace(S,".").replace(P,"")))},u.OCT2BIN=function(p,S){if(!/^[0-7]{1,10}$/.test(p))return T;const P=!(p.length!==10||p.substring(0,1)!=="7"),B=P?parseInt(p,8)-1073741824:parseInt(p,8);if(B<-512||B>511)return T;if(P)return"1"+Wt("0",9-(512+B).toString(2).length)+(512+B).toString(2);const se=B.toString(2);return S===void 0?se:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=se.length?Wt("0",S-se.length)+se:T},u.OCT2DEC=function(p){if(!/^[0-7]{1,10}$/.test(p))return T;const S=parseInt(p,8);return S>=536870912?S-1073741824:S},u.OCT2HEX=function(p,S){if(!/^[0-7]{1,10}$/.test(p))return T;const P=parseInt(p,8);if(P>=536870912)return"ff"+(P+3221225472).toString(16);const B=P.toString(16);return S===void 0?B:isNaN(S)?E:S<0?T:(S=Math.floor(S))>=B.length?Wt("0",S-B.length)+B:T},u.ODD=function(p){if((p=V(p))instanceof Error)return p;let S=Math.ceil(Math.abs(p));return S=1&S?S:S+1,p>=0?S:-S},u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},u.OR=function(){const p=Z(arguments);let S=E;for(let P=0;P<p.length;P++){if(p[P]instanceof Error)return p[P];p[P]!==void 0&&p[P]!==null&&typeof p[P]!="string"&&(S===E&&(S=!1),p[P]&&(S=!0))}return S},u.PDURATION=function(p,S,P){return _e(p=V(p),S=V(S),P=V(P))?E:p<=0?T:(Math.log(P)-Math.log(S))/Math.log(1+p)},u.PEARSON=pe,u.PERCENTILE=Re,u.PERCENTILEEXC=Wo,u.PERCENTILEINC=zo,u.PERCENTRANK=Ce,u.PERCENTRANKEXC=qo,u.PERCENTRANKINC=Yo,u.PERMUT=function(p,S){return _e(p=V(p),S=V(S))?E:Pt(p)/Pt(p-S)},u.PERMUTATIONA=function(p,S){return _e(p=V(p),S=V(S))?E:Math.pow(p,S)},u.PHI=function(p){return(p=V(p))instanceof Error?E:Math.exp(-.5*p*p)/2.5066282746310002},u.PI=function(){return Math.PI},u.PMT=An,u.POISSON=We,u.POISSONDIST=Bs,u.POWER=ur,u.PPMT=function(p,S,P,B,se,fe){return se=se||0,fe=fe||0,_e(p=V(p),P=V(P),B=V(B),se=V(se),fe=V(fe))?E:An(p,P,B,se,fe)-ls(p,S,P,B,se,fe)},u.PRICE=function(){throw new Error("PRICE is not implemented")},u.PRICEDISC=function(p,S,P,B,se){if(_e(p=U(p),S=U(S),P=V(P),B=V(B),se=(se=V(se))||0))return E;if(P<=0||B<=0)return T;if(p>=S)return E;let fe,be;switch(se){case 0:fe=360,be=rn(p,S,!1);break;case 1:case 3:fe=365,be=Cr(p,S,"D");break;case 2:fe=360,be=Cr(p,S,"D");break;case 4:fe=360,be=rn(p,S,!0);break;default:return T}return B-P*B*be/fe},u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},u.PROB=function(p,S,P,B){if(P===void 0)return 0;if(B=B===void 0?P:B,_e(p=ue(Z(p)),S=ue(Z(S)),P=V(P),B=V(B)))return E;if(P===B)return p.indexOf(P)>=0?S[p.indexOf(P)]:0;const se=p.sort((Xe,ut)=>Xe-ut),fe=se.length;let be=0;for(let Xe=0;Xe<fe;Xe++)se[Xe]>=P&&se[Xe]<=B&&(be+=S[p.indexOf(se[Xe])]);return be},u.PRODUCT=pr,u.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},u.PROPER=function(p){return _e(p)?p:isNaN(p)&&typeof p=="number"?E:(p=Ne(p)).replace(/\w\S*/g,S=>S.charAt(0).toUpperCase()+S.substr(1).toLowerCase())},u.PV=function(p,S,P,B,se){return B=B||0,se=se||0,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se))?E:p===0?-P*S-B:((1-Math.pow(1+p,S))/p*P*(1+p*se)-B)/Math.pow(1+p,S)},u.QUARTILE=ot,u.QUARTILEEXC=Ko,u.QUARTILEINC=Xo,u.QUOTIENT=function(p,S){return Pe(p=V(p),S=V(S))||parseInt(p/S,10)},u.RADIANS=function(p){return(p=V(p))instanceof Error?p:p*Math.PI/180},u.RAND=function(){return Math.random()},u.RANDBETWEEN=function(p,S){return Pe(p=V(p),S=V(S))||p+Math.ceil((S-p+1)*Math.random())-1},u.RANK=mt,u.RANKAVG=Jo,u.RANKEQ=Qo,u.RATE=function(p,S,P,B,se,fe){if(fe=fe===void 0?.01:fe,B=B===void 0?0:B,se=se===void 0?0:se,_e(p=V(p),S=V(S),P=V(P),B=V(B),se=V(se),fe=V(fe)))return E;const be=1e-10;let Xe=fe;se=se?1:0;for(let ut=0;ut<20;ut++){if(Xe<=-1)return T;let Ct,Ot,kt;if(Math.abs(Xe)<be?Ct=P*(1+p*Xe)+S*(1+Xe*se)*p+B:(Ot=Math.pow(1+Xe,p),Ct=P*Ot+S*(1/Xe+se)*(Ot-1)+B),Math.abs(Ct)<be)return Xe;if(Math.abs(Xe)<be)kt=P*p+S*se*p;else{Ot=Math.pow(1+Xe,p);const Ft=p*Math.pow(1+Xe,p-1);kt=P*Ft+S*(1/Xe+se)*Ft+S*(-1/(Xe*Xe))*(Ot-1)}Xe-=Ct/kt}return Xe},u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},u.REPLACE=function(p,S,P,B){return _e(S=V(S),P=V(P))||typeof p!="string"||typeof B!="string"?E:p.substr(0,S-1)+B+p.substr(S-1+P)},u.REPT=Wt,u.RIGHT=function(p,S){return Pe(p,S)||(p=Ne(p),(S=V(S=S===void 0?1:S))instanceof Error?S:p.substring(p.length-S))},u.ROMAN=function(p){if((p=V(p))instanceof Error)return p;const S=String(p).split(""),P=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let B="",se=3;for(;se--;)B=(P[+S.pop()+10*se]||"")+B;return new Array(+S.join("")+1).join("M")+B},u.ROUND=cr,u.ROUNDDOWN=function(p,S){return Pe(p=V(p),S=V(S))||(p>0?1:-1)*Math.floor(Math.abs(p)*Math.pow(10,S))/Math.pow(10,S)},u.ROUNDUP=function(p,S){return Pe(p=V(p),S=V(S))||(p>0?1:-1)*Math.ceil(Math.abs(p)*Math.pow(10,S))/Math.pow(10,S)},u.ROW=function(p,S){return arguments.length!==2?R:S<0?T:p instanceof Array&&typeof S=="number"?p.length!==0?d.row(p,S):void 0:E},u.ROWS=function(p){return arguments.length!==1?R:p instanceof Array?p.length===0?0:d.rows(p):E},u.RRI=function(p,S,P){return _e(p=V(p),S=V(S),P=V(P))?E:p===0||S===0?T:Math.pow(P/S,1/p)-1},u.RSQ=function(p,S){return _e(p=ue(Z(p)),S=ue(Z(S)))?E:Math.pow(pe(p,S),2)},u.SEARCH=function(p,S,P){let B;return typeof p!="string"||typeof S!="string"?E:(P=P===void 0?0:P,B=S.toLowerCase().indexOf(p.toLowerCase(),P-1)+1,B===0?E:B)},u.SEC=function(p){return(p=V(p))instanceof Error?p:1/Math.cos(p)},u.SECH=function(p){return(p=V(p))instanceof Error?p:2/(Math.exp(p)+Math.exp(-p))},u.SECOND=function(p){return(p=U(p))instanceof Error?p:p.getSeconds()},u.SERIESSUM=function(p,S,P,B){if(_e(p=V(p),S=V(S),P=V(P),B=ue(B)))return E;let se=B[0]*Math.pow(p,S);for(let fe=1;fe<B.length;fe++)se+=B[fe]*Math.pow(p,S+fe*P);return se},u.SHEET=function(){throw new Error("SHEET is not implemented")},u.SHEETS=function(){throw new Error("SHEETS is not implemented")},u.SIGN=function(p){return(p=V(p))instanceof Error?p:p<0?-1:p===0?0:1},u.SIN=function(p){return(p=V(p))instanceof Error?p:Math.sin(p)},u.SINH=function(p){return(p=V(p))instanceof Error?p:(Math.exp(p)-Math.exp(-p))/2},u.SKEW=Ye,u.SKEWP=is,u.SLN=function(p,S,P){return _e(p=V(p),S=V(S),P=V(P))?E:P===0?T:(p-S)/P},u.SLOPE=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=d.mean(S),B=d.mean(p),se=S.length;let fe=0,be=0;for(let Xe=0;Xe<se;Xe++)fe+=(S[Xe]-P)*(p[Xe]-B),be+=Math.pow(S[Xe]-P,2);return fe/be},u.SMALL=Et,u.SORT=function(p,S=1,P=1,B=!1){if(!p||!Array.isArray(p))return R;if(p.length===0)return 0;if(!(S=V(S))||S<1||(P=V(P))!==1&&P!==-1)return E;if(typeof(B=rt(B))!="boolean")return _;const se=Xe=>Xe.sort((ut,Ct)=>(ut=Ne(ut[S-1]),Ct=Ne(Ct[S-1]),P===1?ut<Ct?-1*P:P:ut>Ct?P:-1*P)),fe=ne(p),be=B?Se(fe):fe;return S>=1&&S<=be[0].length?B?Se(se(be)):se(be):E},u.SQRT=function(p){return(p=V(p))instanceof Error?p:p<0?T:Math.sqrt(p)},u.SQRTPI=function(p){return(p=V(p))instanceof Error?p:Math.sqrt(p*Math.PI)},u.STANDARDIZE=function(p,S,P){return _e(p=V(p),S=V(S),P=V(P))?E:(p-S)/P},u.STDEV=vt,u.STDEVA=function(){const p=ft.apply(this,arguments);return Math.sqrt(p)},u.STDEVP=Zo,u.STDEVPA=function(){const p=yt.apply(this,arguments);let S=Math.sqrt(p);return isNaN(S)&&(S=T),S},u.STDEVS=ea,u.STEYX=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;const P=d.mean(S),B=d.mean(p),se=S.length;let fe=0,be=0,Xe=0;for(let ut=0;ut<se;ut++)fe+=Math.pow(p[ut]-B,2),be+=(S[ut]-P)*(p[ut]-B),Xe+=Math.pow(S[ut]-P,2);return Math.sqrt((fe-be*be/Xe)/(se-2))},u.SUBSTITUTE=function(p,S,P,B){if(arguments.length<3)return R;if(p&&S){if(B===void 0)return p.split(S).join(P);{if(B=Math.floor(Number(B)),Number.isNaN(B)||B<=0)return E;let se=0,fe=0;for(;se>-1&&p.indexOf(S,se)>-1;)if(se=p.indexOf(S,se+1),fe++,se>-1&&fe===B)return p.substring(0,se)+P+p.substring(se+S.length);return p}}return p},u.SUBTOTAL=function(p,S){if((p=V(p))instanceof Error)return p;switch(p){case 1:case 101:return F(S);case 2:case 102:return re(S);case 3:case 103:return me(S);case 4:case 104:return oe(S);case 5:case 105:return ee(S);case 6:case 106:return pr(S);case 7:case 107:return vt.S(S);case 8:case 108:return vt.P(S);case 9:case 109:return Qt(S);case 10:case 110:return He.S(S);case 11:case 111:return He.P(S)}},u.SUM=Qt,u.SUMIF=function(p,S,P){if(p=Z(p),P=P?Z(P):p,p instanceof Error)return p;if(S==null||S instanceof Error)return 0;let B=0;const se=S==="*",fe=se?null:it(S+"");for(let be=0;be<p.length;be++){const Xe=p[be],ut=P[be];if(se)B+=Xe;else{const Ct=[ze(Xe,$e)].concat(fe);B+=Ve(Ct)?ut:0}}return B},u.SUMIFS=function(){const p=D(arguments),S=ue(Z(p.shift()));if(S instanceof Error)return S;const P=p,B=P.length/2;for(let fe=0;fe<B;fe++)P[2*fe]=Z(P[2*fe]);let se=0;for(let fe=0;fe<S.length;fe++){let be=!1;for(let Xe=0;Xe<B;Xe++){const ut=P[2*Xe][fe],Ct=P[2*Xe+1];let Ot=!1;if(Ct===void 0||Ct==="*")Ot=!0;else{const kt=it(Ct+""),Ft=[ze(ut,$e)].concat(kt);Ot=Ve(Ft)}if(!Ot){be=!1;break}be=!0}be&&(se+=S[fe])}return se},u.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return E;const p=arguments.length+1;let S,P,B,se,fe=0;for(let be=0;be<arguments[0].length;be++)if(arguments[0][be]instanceof Array)for(let Xe=0;Xe<arguments[0][be].length;Xe++){for(S=1,P=1;P<p;P++){const ut=arguments[P-1][be][Xe];if(ut instanceof Error)return ut;if(se=V(ut),se instanceof Error)return se;S*=se}fe+=S}else{for(S=1,P=1;P<p;P++){const Xe=arguments[P-1][be];if(Xe instanceof Error)return Xe;if(B=V(Xe),B instanceof Error)return B;S*=B}fe+=S}return fe},u.SUMSQ=function(){const p=ue(Z(arguments));if(p instanceof Error)return p;let S=0;const P=p.length;for(let B=0;B<P;B++)S+=St(p[B])?p[B]*p[B]:0;return S},u.SUMX2MY2=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;let P=0;for(let B=0;B<p.length;B++)P+=p[B]*p[B]-S[B]*S[B];return P},u.SUMX2PY2=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;let P=0;p=ue(Z(p)),S=ue(Z(S));for(let B=0;B<p.length;B++)P+=p[B]*p[B]+S[B]*S[B];return P},u.SUMXMY2=function(p,S){if(_e(p=ue(Z(p)),S=ue(Z(S))))return E;let P=0;p=Z(p),S=Z(S);for(let B=0;B<p.length;B++)P+=Math.pow(p[B]-S[B],2);return P},u.SWITCH=function(){let p;if(arguments.length>0){const S=arguments[0],P=arguments.length-1,B=Math.floor(P/2);let se=!1;const fe=P%2!=0,be=P%2==0?null:arguments[arguments.length-1];if(B){for(let Xe=0;Xe<B;Xe++)if(S===arguments[2*Xe+1]){p=arguments[2*Xe+2],se=!0;break}}se||(p=fe?be:R)}else p=E;return p},u.SYD=function(p,S,P,B){return _e(p=V(p),S=V(S),P=V(P),B=V(B))?E:P===0||B<1||B>P?T:(p-S)*(P-(B=parseInt(B,10))+1)*2/(P*(P+1))},u.T=function(p){return p instanceof Error||typeof p=="string"?p:""},u.TAN=function(p){return(p=V(p))instanceof Error?p:Math.tan(p)},u.TANH=function(p){if((p=V(p))instanceof Error)return p;const S=Math.exp(2*p);return(S-1)/(S+1)},u.TBILLEQ=function(p,S,P){return _e(p=U(p),S=U(S),P=V(P))?E:P<=0||p>S||S-p>31536e6?T:365*P/(360-P*rn(p,S,!1))},u.TBILLPRICE=function(p,S,P){return _e(p=U(p),S=U(S),P=V(P))?E:P<=0||p>S||S-p>31536e6?T:100*(1-P*rn(p,S,!1)/360)},u.TBILLYIELD=function(p,S,P){return _e(p=U(p),S=U(S),P=V(P))?E:P<=0||p>S||S-p>31536e6?T:360*(100-P)/(P*rn(p,S,!1))},u.TDIST=ta,u.TDISTRT=Us,u.TEXT=function(p,S){if(p===void 0||p instanceof Error||S instanceof Error)return R;if(S==null)return"";if(typeof S=="number")return String(S);if(typeof S!="string")return E;const P=S.startsWith("$")?"$":"",B=S.endsWith("%");return B&&(p*=100),p=(p=Ei(p,(S=S.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!S.includes(","))).startsWith("-")?"-"+P+(p=p.replace("-","")):P+p,B&&(p+="%"),p},u.TEXTJOIN=function(p,S,...P){if(typeof S!="boolean"&&(S=rt(S)),arguments.length<3)return R;p=p??"";let B=Z(P),se=S?B.filter(fe=>fe):B;if(Array.isArray(p)){p=Z(p);let fe=se.map(Xe=>[Xe]),be=0;for(let Xe=0;Xe<fe.length-1;Xe++)fe[Xe].push(p[be]),be++,be===p.length&&(be=0);return se=Z(fe),se.join("")}return se.join(p)},u.TIME=function(p,S,P){return _e(p=V(p),S=V(S),P=V(P))?E:p<0||S<0||P<0?T:(3600*p+60*S+P)/86400},u.TIMEVALUE=function(p){return(p=U(p))instanceof Error?p:(3600*p.getHours()+60*p.getMinutes()+p.getSeconds())/86400},u.TINV=ra,u.TODAY=function(){return pi(new Date)},u.TRANSPOSE=function(p){return p?Se(ne(p)):R},u.TREND=function(p,S,P){if(_e(p=ue(Z(p)),S=ue(Z(S)),P=ue(Z(P))))return E;const B=j(p,S),se=B[0],fe=B[1],be=[];return P.forEach(Xe=>{be.push(se*Xe+fe)}),be},u.TRIM=function(p){return(p=Ne(p))instanceof Error?p:p.replace(/\s+/g," ").trim()},u.TRIMMEAN=function(p,S){if(_e(p=ue(Z(p)),S=V(S)))return E;const P=Vt(p.length*S,2)/2;return d.mean((se=(se=P)||1,(B=de(p.sort((fe,be)=>fe-be),P))&&typeof B.slice=="function"?B.slice(0,B.length-se):B));var B,se},u.TRUE=function(){return!0},u.TRUNC=function(p,S){return Pe(p=V(p),S=V(S))||(p>0?1:-1)*Math.floor(Math.abs(p)*Math.pow(10,S))/Math.pow(10,S)},u.TTEST=na,u.TYPE=function(p){return St(p)?1:bt(p)?2:at(p)?4:Ze(p)?16:Array.isArray(p)?64:void 0},u.UNICHAR=Os,u.UNICODE=Ms,u.UNIQUE=q,u.UPPER=function(p){return(p=Ne(p))instanceof Error?p:p.toUpperCase()},u.VALUE=function(p){const S=Pe(p);if(S)return S;if(typeof p=="number")return p;if(Ue(p)||(p=""),typeof p!="string")return E;const P=/(%)$/.test(p)||/^(%)/.test(p);if((p=(p=(p=p.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let B=Number(p);return isNaN(B)?E:(B=B||0,P&&(B*=.01),B)},u.VAR=He,u.VARA=ft,u.VARP=ia,u.VARPA=yt,u.VARS=sa,u.VDB=function(){throw new Error("VDB is not implemented")},u.VLOOKUP=X,u.WEEKDAY=function(p,S){if((p=U(p))instanceof Error)return p;S===void 0&&(S=1);const P=p.getDay();return Ur[S][P]},u.WEEKNUM=function(p,S){if((p=U(p))instanceof Error)return p;if(S===void 0&&(S=1),S===21)return jn(p);const P=hi[S];let B=new Date(p.getFullYear(),0,1);const se=B.getDay()<P?1:0;return B-=24*Math.abs(B.getDay()-P)*60*60*1e3,Math.floor((p-B)/864e5/7+1)+se},u.WEIBULL=It,u.WEIBULLDIST=oa,u.WORKDAY=nn,u.WORKDAYINTL=aa,u.XIRR=function(p,S,P){if(_e(p=ue(Z(p)),S=te(Z(S)),P=V(P)))return E;const B=(Ft,Gt,zt)=>{const Yt=zt+1;let _r=Ft[0];for(let rr=1;rr<Ft.length;rr++)_r+=Ft[rr]/Math.pow(Yt,fn(Gt[rr],Gt[0])/365);return _r},se=(Ft,Gt,zt)=>{const Yt=zt+1;let _r=0;for(let rr=1;rr<Ft.length;rr++){const an=fn(Gt[rr],Gt[0])/365;_r-=an*Ft[rr]/Math.pow(Yt,an+1)}return _r};let fe=!1,be=!1;for(let Ft=0;Ft<p.length;Ft++)p[Ft]>0&&(fe=!0),p[Ft]<0&&(be=!0);if(!fe||!be)return T;let Xe,ut,Ct,Ot=P=P||.1,kt=!0;do Ct=B(p,S,Ot),Xe=Ot-Ct/se(p,S,Ot),ut=Math.abs(Xe-Ot),Ot=Xe,kt=ut>1e-10&&Math.abs(Ct)>1e-10;while(kt);return Ot},u.XNPV=function(p,S,P){if(_e(p=V(p),S=ue(Z(S)),P=te(Z(P))))return E;let B=0;for(let se=0;se<S.length;se++)B+=S[se]/Math.pow(1+p,fn(P[se],P[0])/365);return B},u.XOR=function(){const p=Z(arguments);let S=E;for(let P=0;P<p.length;P++){if(p[P]instanceof Error)return p[P];p[P]!==void 0&&p[P]!==null&&typeof p[P]!="string"&&(S===E&&(S=0),p[P]&&S++)}return S===E?S:!!(1&Math.floor(Math.abs(S)))},u.YEAR=function(p){return(p=U(p))instanceof Error?p:p.getFullYear()},u.YEARFRAC=Ki,u.YIELD=function(){throw new Error("YIELD is not implemented")},u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},u.Z=gt,u.ZTEST=la,u.utils=Nn}},s={};function o(l){var u=s[l];if(u!==void 0)return u.exports;var c=s[l]={exports:{}};return n[l].call(c.exports,c,c.exports,o),c.exports}o.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var a=o(960);t=a}(),t})}(dist$2)),dist$2.exports}var dist=dist$3.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire=="function")var formula=requireDist$1();(function(r,e){module.exports=e()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={100:function(r,e){const t=function(o){const a=this,l=[];for(let u=0;u<o.length;u++){const c=o[u].x,d=o[u].y,f=a.options.columns[c].name?a.options.columns[c].name:c;l[d]||(l[d]={row:d,data:{}}),l[d].data[f]=o[u].value}return l.filter(function(u){return u!=null})},n=function(o,a){const l=this,u=s.call(l.parent,"onbeforesave",l.parent,l,a);if(u)a=u;else if(u===!1)return!1;jSuites.ajax({url:o,method:"POST",dataType:"json",data:{data:JSON.stringify(a)},success:function(c){s.call(l,"onsave",l.parent,l,a)}})},s=function(o){const a=this;let l=null,u=a.parent?a.parent:a;if(!u.ignoreEvents&&(typeof u.config.onevent=="function"&&(l=u.config.onevent.apply(this,arguments)),typeof u.config[o]=="function"&&(l=u.config[o].apply(this,Array.prototype.slice.call(arguments,1))),typeof u.plugins=="object")){const c=Object.keys(u.plugins);for(let d=0;d<c.length;d++){const f=c[d],C=u.plugins[f];typeof C.onevent=="function"&&(l=C.onevent.apply(this,arguments))}}if(o=="onafterchanges"){const c=arguments;if(typeof u.plugins=="object"&&Object.entries(u.plugins).forEach(function([,d]){typeof d.persistence=="function"&&d.persistence(a,"setValue",{data:c[2]})}),a.options.persistence){const d=a.options.persistence==1?a.options.url:a.options.persistence,f=t.call(a,arguments[2]);n.call(a,d,f)}}return l};e.Z=s},456:function(r,e,t){t.d(e,{B4:function(){return o},aw:function(){return l},ql:function(){return a}});var n=t(992),s=t(366);const o=function(u){const c=this;if(c.options.filters){u=parseInt(u),c.resetSelection();let d=[];if(c.options.columns[u].type=="checkbox")d.push({id:"true",name:"True"}),d.push({id:"false",name:"False"});else{const m=[];let E=!1;for(let _=0;_<c.options.data.length;_++){const T=c.options.data[_][u],R=c.records[_][u].element.innerHTML;T&&R?m[T]=R:E=!0}const v=Object.keys(m);d=[];for(let _=0;_<v.length;_++)d.push({id:v[_],name:m[v[_]]});E&&d.push({value:"",id:"",name:"(Blanks)"})}const f=document.createElement("div");c.filter.children[u+1].innerHTML="",c.filter.children[u+1].appendChild(f),c.filter.children[u+1].style.paddingLeft="0px",c.filter.children[u+1].style.paddingRight="0px",c.filter.children[u+1].style.overflow="initial";const C={data:d,multiple:!0,autocomplete:!0,opened:!0,value:c.filters[u]!==void 0?c.filters[u]:null,width:"100%",position:c.options.tableOverflow==1||c.parent.config.fullscreen==1,onclose:function(m){l.call(c),c.filters[u]=m.dropdown.getValue(!0),c.filter.children[u+1].innerHTML=m.dropdown.getText(),c.filter.children[u+1].style.paddingLeft="",c.filter.children[u+1].style.paddingRight="",c.filter.children[u+1].style.overflow="",a.call(c,u),s.E.call(c)}};jSuites.dropdown(f,C)}else console.log("Jspreadsheet: filters not enabled.")},a=function(u){const c=this;if(!u)for(let C=0;C<c.filter.children.length;C++)c.filters[C]&&(u=C);const d=function(C,m,E){for(let v=0;v<C.length;v++){const _=""+c.options.data[E][m],T=""+c.records[E][m].element.innerHTML;if(C[v]==_||C[v]==T)return!0}return!1},f=c.filters[u];c.results=[];for(let C=0;C<c.options.data.length;C++)d(f,u,C)&&c.results.push(C);c.results.length||(c.results=null),n.cW.call(c)},l=function(){const u=this;if(u.options.filters)for(let c=0;c<u.filter.children.length;c++)u.filter.children[c].innerHTML="&nbsp;",u.filters[c]=null;u.results=null,n.cW.call(u)}},427:function(r,e,t){t.d(e,{i:function(){return s}});var n=t(992);const s=function(o){const a=this;if(o&&(a.options.footers=o),a.options.footers){a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot));for(let l=0;l<a.options.footers.length;l++){let u;if(a.tfoot.children[l])u=a.tfoot.children[l];else{u=document.createElement("tr");const c=document.createElement("td");u.appendChild(c),a.tfoot.appendChild(u)}for(let c=0;c<a.headers.length;c++){let d;if(a.options.footers[l][c]||(a.options.footers[l][c]=""),a.tfoot.children[l].children[c+1])d=a.tfoot.children[l].children[c+1];else{d=document.createElement("td"),u.appendChild(d);const f=a.options.columns[c].align||a.options.defaultColAlign||"center";d.style.textAlign=f}d.textContent=n.H2.call(a,+a.records.length+c,l,a.options.footers[l][c]),d.style.display=a.cols[c].colElement.style.display}}}}},157:function(r,e,t){t.d(e,{I:function(){return n}});const n=function(){const s=this;let o=0;if(s.options.freezeColumns>0)for(let a=0;a<s.options.freezeColumns;a++){let l;l=s.options.columns&&s.options.columns[a]&&s.options.columns[a].width!==void 0?parseInt(s.options.columns[a].width):s.options.defaultColWidth!==void 0?parseInt(s.options.defaultColWidth):100,o+=l}return o}},650:function(r,e,t){t.r(e),t.d(e,{createFromTable:function(){return f},getCaretIndex:function(){return s},getCellNameFromCoords:function(){return l},getColumnName:function(){return a},getCoordsFromCellName:function(){return u},getCoordsFromRange:function(){return c},invert:function(){return o},parseCSV:function(){return d}});var n=t(323);const s=function(C){let m;m=this.config.root?this.config.root:window;let E=0;const v=m.getSelection();if(v&&v.rangeCount!==0){const _=v.getRangeAt(0),T=_.cloneRange();T.selectNodeContents(C),T.setEnd(_.endContainer,_.endOffset),E=T.toString().length}return E},o=function(C){const m=[],E=Object.keys(C);for(let v=0;v<E.length;v++)m[C[E[v]]]=E[v];return m},a=function(C){let m="";return C>701?(m+=String.fromCharCode(64+parseInt(C/676)),m+=String.fromCharCode(64+parseInt(C%676/26))):C>25&&(m+=String.fromCharCode(64+parseInt(C/26))),m+=String.fromCharCode(65+C%26),m},l=function(C,m){return a(parseInt(C))+(parseInt(m)+1)},u=function(C){const m=/^[a-zA-Z]+/.exec(C);if(m){let E=0;for(let _=0;_<m[0].length;_++)E+=parseInt(m[0].charCodeAt(_)-64)*Math.pow(26,m[0].length-1-_);E--,E<0&&(E=0);let v=parseInt(/[0-9]+$/.exec(C))||null;return v>0&&v--,[E,v]}},c=function(C){const[m,E]=C.split(":");return[...u(m),...u(E)]},d=function(C,m){(C=C.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(C.length-1)==9&&(C+="\0"),m=m||",";const E=[];let v=!1;for(let _=0,T=0,R=0;R<C.length;R++){const O=C[R],N=C[R+1];E[_]=E[_]||[],E[_][T]=E[_][T]||"",O=='"'&&v&&N=='"'?(E[_][T]+=O,++R):O!='"'?O!=m||v?O!="\r"||N!=`
`||v?O==`
`&&!v||O=="\r"&&!v?(++_,T=0):E[_][T]+=O:(++_,T=0,++R):++T:v=!v}return E},f=function(C,m){if(C.tagName=="TABLE"){m||(m={}),m.columns=[],m.data=[];const E=C.querySelectorAll("colgroup > col");if(E.length)for(let z=0;z<E.length;z++){let ne=E[z].style.width;ne||(ne=E[z].getAttribute("width")),ne&&(m.columns[z]||(m.columns[z]={}),m.columns[z].width=ne)}const v=function(z,ne){let Z=z.getBoundingClientRect();const ve=Z.width>50?Z.width:50;m.columns[ne]||(m.columns[ne]={}),z.getAttribute("data-celltype")?m.columns[ne].type=z.getAttribute("data-celltype"):m.columns[ne].type="text",m.columns[ne].width=ve+"px",m.columns[ne].title=z.innerHTML,z.style.textAlign&&(m.columns[ne].align=z.style.textAlign),(Z=z.getAttribute("name"))&&(m.columns[ne].name=Z),(Z=z.getAttribute("id"))&&(m.columns[ne].id=Z),(Z=z.getAttribute("data-mask"))&&(m.columns[ne].mask=Z)},_=[];let T=C.querySelectorAll(":scope > thead > tr");if(T.length){for(let z=0;z<T.length-1;z++){const ne=[];for(let Z=0;Z<T[z].children.length;Z++){const ve={title:T[z].children[Z].textContent,colspan:T[z].children[Z].getAttribute("colspan")||1};ne.push(ve)}_.push(ne)}T=T[T.length-1].children;for(let z=0;z<T.length;z++)v(T[z],z)}let R=0;const O={},N={},G={},D={};let k=C.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let z=0;z<k.length;z++)if(m.data[R]=[],m.parseTableFirstRowAsHeader!=1||T.length||z!=0){for(let ne=0;ne<k[z].children.length;ne++){let Z=k[z].children[ne].getAttribute("data-formula");Z?Z.substr(0,1)!="="&&(Z="="+Z):Z=k[z].children[ne].innerHTML,m.data[R].push(Z);const ve=(0,n.Ar)([ne,z]),xe=k[z].children[ne].getAttribute("class");xe&&(D[ve]=xe);const de=parseInt(k[z].children[ne].getAttribute("colspan"))||0,Se=parseInt(k[z].children[ne].getAttribute("rowspan"))||0;(de||Se)&&(O[ve]=[de||1,Se||1]),k[z].children[ne].style&&k[z].children[ne].style.display=="none"&&(k[z].children[ne].style.display="");const Me=k[z].children[ne].getAttribute("style");Me&&(G[ve]=Me),k[z].children[ne].classList.contains("styleBold")&&(G[ve]?G[ve]+="; font-weight:bold;":G[ve]="font-weight:bold;")}k[z].style&&k[z].style.height&&(N[z]={height:k[z].style.height}),R++}else for(let ne=0;ne<k[z].children.length;ne++)v(k[z].children[ne],ne);if(Object.keys(_).length>0&&(m.nestedHeaders=_),Object.keys(G).length>0&&(m.style=G),Object.keys(O).length>0&&(m.mergeCells=O),Object.keys(N).length>0&&(m.rows=N),Object.keys(D).length>0&&(m.classes=D),k=C.querySelectorAll("tfoot tr"),k.length){const z=[];for(let ne=0;ne<k.length;ne++){let Z=[];for(let ve=0;ve<k[ne].children.length;ve++)Z.push(k[ne].children[ve].textContent);z.push(Z)}Object.keys(z).length>0&&(m.footers=z)}if(m.parseTableAutoCellType==1){const z=[];for(let ne=0;ne<m.columns.length;ne++){let Z=!0,ve=!0;z[ne]=[];for(let de=0;de<m.data.length;de++){const Se=m.data[de][ne];z[ne][Se]||(z[ne][Se]=0),z[ne][Se]++,Se.length>25&&(Z=!1),Se.length==10&&Se.substr(4,1)=="-"&&Se.substr(7,1)=="-"||(ve=!1)}const xe=Object.keys(z[ne]).length;ve?m.columns[ne].type="calendar":Z==1&&xe>1&&xe<=parseInt(.1*m.data.length)&&(m.columns[ne].type="dropdown",m.columns[ne].source=Object.keys(z[ne]))}}return m}console.log("Element is not a table")}},923:function(r,e,t){t.d(e,{JB:function(){return c},KX:function(){return m},Yw:function(){return C}});var n=t(100),s=t(323),o=t(992),a=t(49),l=t(54),u=t(366);const c=function(E){const v=this;if(v.ignoreHistory!=1){const _=++v.historyIndex;v.history=v.history=v.history.slice(0,_+1),v.history[_]=E}},d=function(E,v){const _=this,T=v.insertBefore?+v.rowNumber:v.rowNumber+1;if(_.options.search==1&&_.results&&_.results.length!=_.rows.length&&_.resetSearch(),E==1){const R=v.numOfRows;for(let O=T;O<R+T;O++)_.rows[O].element.parentNode.removeChild(_.rows[O].element);_.records.splice(T,R),_.options.data.splice(T,R),_.rows.splice(T,R),u.Uv.call(_,1,T,R+T-1)}else{_.records=(0,s.Wc)(_.records,T,v.rowRecords),_.options.data=(0,s.Wc)(_.options.data,T,v.rowData),_.rows=(0,s.Wc)(_.rows,T,v.rowNode);let R=0;for(let O=T;O<v.numOfRows+T;O++)_.tbody.insertBefore(v.rowNode[R].element,_.tbody.children[O]),R++}for(let R=T;R<_.rows.length;R++)_.rows[R].y=R;for(let R=T;R<_.records.length;R++)for(let O=0;O<_.records[R].length;O++)_.records[R][O].y=R;_.options.pagination>0&&_.page(_.pageNumber),o.ec.call(_)},f=function(E,v){const _=this,T=v.insertBefore?v.columnNumber:v.columnNumber+1;if(E==1){const R=v.numOfColumns;_.options.columns.splice(T,R);for(let O=T;O<R+T;O++)_.headers[O].parentNode.removeChild(_.headers[O]),_.cols[O].colElement.parentNode.removeChild(_.cols[O].colElement);_.headers.splice(T,R),_.cols.splice(T,R);for(let O=0;O<v.data.length;O++){for(let N=T;N<R+T;N++)_.records[O][N].element.parentNode.removeChild(_.records[O][N].element);_.records[O].splice(T,R),_.options.data[O].splice(T,R)}if(_.options.footers)for(let O=0;O<_.options.footers.length;O++)_.options.footers[O].splice(T,R)}else{_.options.columns=(0,s.Wc)(_.options.columns,T,v.columns),_.headers=(0,s.Wc)(_.headers,T,v.headers),_.cols=(0,s.Wc)(_.cols,T,v.cols);let R=0;for(let O=T;O<v.numOfColumns+T;O++)_.headerContainer.insertBefore(v.headers[R],_.headerContainer.children[O+1]),_.colgroupContainer.insertBefore(v.cols[R].colElement,_.colgroupContainer.children[O+1]),R++;for(let O=0;O<v.data.length;O++){_.options.data[O]=(0,s.Wc)(_.options.data[O],T,v.data[O]),_.records[O]=(0,s.Wc)(_.records[O],T,v.records[O]);let N=0;for(let G=T;G<v.numOfColumns+T;G++)_.rows[O].element.insertBefore(v.records[O][N].element,_.rows[O].element.children[G+1]),N++}if(_.options.footers)for(let O=0;O<_.options.footers.length;O++)_.options.footers[O]=(0,s.Wc)(_.options.footers[O],T,v.footers[O])}for(let R=T;R<_.cols.length;R++)_.cols[R].x=R;for(let R=0;R<_.records.length;R++)for(let O=T;O<_.records[R].length;O++)_.records[R][O].x=O;if(_.options.nestedHeaders&&_.options.nestedHeaders.length>0&&_.options.nestedHeaders[0]&&_.options.nestedHeaders[0][0])for(let R=0;R<_.options.nestedHeaders.length;R++){let O;O=E==1?parseInt(_.options.nestedHeaders[R][_.options.nestedHeaders[R].length-1].colspan)-v.numOfColumns:parseInt(_.options.nestedHeaders[R][_.options.nestedHeaders[R].length-1].colspan)+v.numOfColumns,_.options.nestedHeaders[R][_.options.nestedHeaders[R].length-1].colspan=O,_.thead.children[R].children[_.thead.children[R].children.length-1].setAttribute("colspan",O)}o.ec.call(_)},C=function(){const E=this,v=!!E.parent.ignoreEvents,_=!!E.ignoreHistory;E.parent.ignoreEvents=!0,E.ignoreHistory=!0;const T=[];let R;if(E.historyIndex>=0){if(R=E.history[E.historyIndex--],R.action=="insertRow")d.call(E,1,R);else if(R.action=="deleteRow")d.call(E,0,R);else if(R.action=="insertColumn")f.call(E,1,R);else if(R.action=="deleteColumn")f.call(E,0,R);else if(R.action=="moveRow")E.moveRow(R.newValue,R.oldValue);else if(R.action=="moveColumn")E.moveColumn(R.newValue,R.oldValue);else if(R.action=="setMerge")E.removeMerge(R.column,R.data);else if(R.action=="setStyle")E.setStyle(R.oldValue,null,null,1);else if(R.action=="setWidth")E.setWidth(R.column,R.oldValue);else if(R.action=="setHeight")E.setHeight(R.row,R.oldValue);else if(R.action=="setHeader")E.setHeader(R.column,R.oldValue);else if(R.action=="setComments")E.setComments(R.oldValue);else if(R.action=="orderBy"){let O=[];for(let N=0;N<R.rows.length;N++)O[R.rows[N]]=N;l.SV.call(E,R.column,R.order?0:1),l.Cs.call(E,O)}else if(R.action=="setValue"){for(let O=0;O<R.records.length;O++)T.push({x:R.records[O].x,y:R.records[O].y,value:R.records[O].oldValue}),R.oldStyle&&E.resetStyle(R.oldStyle);E.setValue(T),R.selection&&E.updateSelectionFromCoords(R.selection[0],R.selection[1],R.selection[2],R.selection[3])}}E.parent.ignoreEvents=v,E.ignoreHistory=_,n.Z.call(E,"onundo",E,R)},m=function(){const E=this,v=!!E.parent.ignoreEvents,_=!!E.ignoreHistory;let T;if(E.parent.ignoreEvents=!0,E.ignoreHistory=!0,E.historyIndex<E.history.length-1){if(T=E.history[++E.historyIndex],T.action=="insertRow")d.call(E,0,T);else if(T.action=="deleteRow")d.call(E,1,T);else if(T.action=="insertColumn")f.call(E,0,T);else if(T.action=="deleteColumn")f.call(E,1,T);else if(T.action=="moveRow")E.moveRow(T.oldValue,T.newValue);else if(T.action=="moveColumn")E.moveColumn(T.oldValue,T.newValue);else if(T.action=="setMerge")a.mt.call(E,T.column,T.colspan,T.rowspan,1);else if(T.action=="setStyle")E.setStyle(T.newValue,null,null,1);else if(T.action=="setWidth")E.setWidth(T.column,T.newValue);else if(T.action=="setHeight")E.setHeight(T.row,T.newValue);else if(T.action=="setHeader")E.setHeader(T.column,T.newValue);else if(T.action=="setComments")E.setComments(T.newValue);else if(T.action=="orderBy")l.SV.call(E,T.column,T.order),l.Cs.call(E,T.rows);else if(T.action=="setValue"){E.setValue(T.records);for(let R=0;R<T.records.length;R++)T.oldStyle&&E.resetStyle(T.newStyle);T.selection&&E.updateSelectionFromCoords(T.selection[0],T.selection[1],T.selection[2],T.selection[3])}}E.parent.ignoreEvents=v,E.ignoreHistory=_,n.Z.call(E,"onredo",E,T)}},992:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$S:function(){return getCell},E2:function(){return updateFormula},Gr:function(){return fullscreen},H2:function(){return parseValue},Hf:function(){return getWorksheetInstance},Of:function(){return updateScroll},Sl:function(){return getCellFromCoords},T0:function(){return updateTable},TO:function(){return hideIndex},UI:function(){return showIndex},UQ:function(){return createNestedHeader},Vi:function(){return getMask},X0:function(){return getWorksheetActive},Zz:function(){return updateFormulaChain},cW:function(){return updateResult},ec:function(){return updateTableReferences},id:function(){return getLabel},jr:function(){return isFormula},kE:function(){return createCell},pX:function(){return executeFormula},wW:function(){return updateCell}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(100),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(366),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(650),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(272),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(157),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(673),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(427),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(323);const updateTable=function(){const r=this;if(r.options.minSpareRows>0){let e=0;for(let t=r.rows.length-1;t>=0;t--){let n=!1;for(let s=0;s<r.headers.length;s++)r.options.data[t][s]&&(n=!0);if(n)break;e++}r.options.minSpareRows-e>0&&r.insertRow(r.options.minSpareRows-e)}if(r.options.minSpareCols>0){let e=0;for(let t=r.headers.length-1;t>=0;t--){let n=!1;for(let s=0;s<r.rows.length;s++)r.options.data[s][t]&&(n=!0);if(n)break;e++}r.options.minSpareCols-e>0&&r.insertColumn(r.options.minSpareCols-e)}r.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.i.call(r),setTimeout(function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(r)},0)},parseNumber=function(r,e){const t=e&&this.options.columns[e].decimal?this.options.columns[e].decimal:".";let n=""+r;return n=n.split(t),n[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&Number.isInteger(Number(n[0]))?n[1]?+(n[0]+"."+n[1]):+(n[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(r){for(let e=0;e<r.length;e++){const t=[],n=r[e].split(":"),s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n[0],!0),o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n[1],!0);let a,l,u,c;s[0]<=o[0]?(a=s[0],l=o[0]):(a=o[0],l=s[0]),s[1]<=o[1]?(u=s[1],c=o[1]):(u=o[1],c=s[1]);for(let d=u;d<=c;d++)for(let f=a;f<=l;f++)t.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([f,d]));expression=expression.replace(r[e],t.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const r=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(tokens[i],1);let e;if(e=obj.options.data[r[1]]!==void 0&&obj.options.data[r[1]][r[0]]!==void 0?obj.options.data[r[1]][r[0]]:"",(""+e).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?e=formulaResults[tokens[i]]:(e=execute(e,r[0],r[1]),formulaResults[tokens[i]]=e)),(""+e).trim()=="")formulaExpressions[tokens[i]]=null;else if(e==Number(e)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(e);else{const t=parseNumber.call(obj,e,r[0]);obj.parent.config.autoCasting!=0&&t?formulaExpressions[tokens[i]]=t:formulaExpressions[tokens[i]]='"'+e+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(r){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,r)}return res}};return execute(expression,x,y)},parseValue=function(r,e,t,n){const s=this;(""+t).substr(0,1)=="="&&s.parent.config.parseFormulas!=0&&(t=executeFormula.call(s,t,r,e));const o=s.options.columns&&s.options.columns[r];if(o&&!isFormula(t)){let a=null;if(a=getMask(o)){t&&t==Number(t)&&(t=Number(t));let l=jSuites.mask.render(t,a,!0);if(n&&a.mask){const u=a.mask.split(";");u[1]&&(u[1].match(new RegExp("\\[Red\\]","gi"))&&(t<0?n.classList.add("red"):n.classList.remove("red")),u[1].match(new RegExp("\\(","gi"))&&t<0&&(l="("+l+")"))}l&&(t=l)}}return t},getDropDownValue=function(r,e){const t=this,n=[];if(t.options.columns&&t.options.columns[r]&&t.options.columns[r].source){const s=[],o=t.options.columns[r].source;for(let l=0;l<o.length;l++)typeof o[l]=="object"?s[o[l].id]=o[l].name:s[o[l]]=o[l];const a=Array.isArray(e)?e:(""+e).split(";");for(let l=0;l<a.length;l++)typeof a[l]=="object"?n.push(s[a[l].id]):s[a[l]]&&n.push(s[a[l]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},validDate=function(r){return(r=""+r).substr(4,1)=="-"&&r.substr(7,1)=="-"||(r=r.split("-"))[0].length==4&&r[0]==Number(r[0])&&r[1].length==2&&r[1]==Number(r[1])},stripScript=function(r){const e=new Option;e.innerHTML=r;let t=null;for(r=e.getElementsByTagName("script");t=r[0];)t.parentNode.removeChild(t);return e.innerHTML},createCell=function(r,e,t){const n=this;let s=document.createElement("td");if(s.setAttribute("data-x",r),s.setAttribute("data-y",e),(""+t).substr(0,1)=="="&&n.options.secureFormulas==1){const a=secureFormula(t);a!=t&&(t=a)}if(n.options.columns&&n.options.columns[r]&&typeof n.options.columns[r].type=="object")n.parent.config.parseHTML===!0?s.innerHTML=t:s.textContent=t,typeof n.options.columns[r].type.createCell=="function"&&n.options.columns[r].type.createCell(s,t,parseInt(r),parseInt(e),n,n.options.columns[r]);else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="hidden")s.style.display="none",s.textContent=t;else if(n.options.columns&&n.options.columns[r]&&(n.options.columns[r].type=="checkbox"||n.options.columns[r].type=="radio")){const a=document.createElement("input");a.type=n.options.columns[r].type,a.name="c"+r,a.checked=t==1||t==1||t=="true",a.onclick=function(){n.setValue(s,this.checked)},n.options.columns[r].readOnly!=1&&n.options.editable!=0||a.setAttribute("disabled","disabled"),s.appendChild(a),n.options.data[e][r]=a.checked}else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="calendar"){let a=null;if(!validDate(t)){const l=jSuites.calendar.extractDateFromString(t,n.options.columns[r].options&&n.options.columns[r].options.format||"YYYY-MM-DD");l&&(a=l)}s.textContent=jSuites.calendar.getDateString(a||t,n.options.columns[r].options&&n.options.columns[r].options.format)}else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="dropdown")s.classList.add("jss_dropdown"),s.textContent=getDropDownValue.call(n,r,t);else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="color")if(n.options.columns[r].render=="square"){const a=document.createElement("div");a.className="color",a.style.backgroundColor=t,s.appendChild(a)}else s.style.color=t,s.textContent=t;else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="image"){if(t&&t.substr(0,10)=="data:image"){const a=document.createElement("img");a.src=t,s.appendChild(a)}}else n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="html"||n.parent.config.parseHTML===!0?s.innerHTML=stripScript(parseValue.call(this,r,e,t,s)):s.textContent=parseValue.call(this,r,e,t,s);n.options.columns&&n.options.columns[r]&&n.options.columns[r].readOnly==1&&(s.className="readonly");const o=n.options.columns&&n.options.columns[r]&&n.options.columns[r].align||n.options.defaultColAlign||"center";return s.style.textAlign=o,n.options.columns&&n.options.columns[r]&&n.options.columns[r].wordWrap==0||!(n.options.wordWrap==1||n.options.columns&&n.options.columns[r]&&n.options.columns[r].wordWrap==1||s.innerHTML.length>200)||(s.style.whiteSpace="pre-wrap"),r>0&&this.options.textOverflow==1&&(t||s.innerHTML?n.records[e][r-1].element.style.overflow="hidden":r==n.options.columns.length-1&&(s.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(n,"oncreatecell",n,s,r,e,t),s},updateCell=function(r,e,t,n){const s=this;let o;if(s.records[e][r].element.classList.contains("readonly")!=1||n){if((""+t).substr(0,1)=="="&&s.options.secureFormulas==1){const u=secureFormula(t);u!=t&&(t=u)}const a=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(s,"onbeforechange",s,s.records[e][r].element,r,e,t);if(a!=null&&(t=a),s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].type=="object"&&typeof s.options.columns[r].type.updateCell=="function"){const u=s.options.columns[r].type.updateCell(s.records[e][r].element,t,parseInt(r),parseInt(e),s,s.options.columns[r]);u!==void 0&&(t=u)}o={x:r,y:e,col:r,row:e,value:t,oldValue:s.options.data[e][r]};let l=s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].type=="object"?s.options.columns[r].type:null;if(l)s.options.data[e][r]=t,typeof l.setValue=="function"&&l.setValue(s.records[e][r].element,t);else if(s.options.columns&&s.options.columns[r]&&(s.options.columns[r].type=="checkbox"||s.options.columns[r].type=="radio")){if(s.options.columns[r].type=="radio")for(let u=0;u<s.options.data.length;u++)s.options.data[u][r]=!1;s.records[e][r].element.children[0].checked=t==1||t==1||t=="true"||t=="TRUE",s.options.data[e][r]=s.records[e][r].element.children[0].checked}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="dropdown")s.options.data[e][r]=t,s.records[e][r].element.textContent=getDropDownValue.call(s,r,t);else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="calendar"){let u=null;if(!validDate(t)){const c=jSuites.calendar.extractDateFromString(t,s.options.columns[r].options&&s.options.columns[r].options.format||"YYYY-MM-DD");c&&(u=c)}s.options.data[e][r]=t,s.records[e][r].element.textContent=jSuites.calendar.getDateString(u||t,s.options.columns[r].options&&s.options.columns[r].options.format)}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="color")if(s.options.data[e][r]=t,s.options.columns[r].render=="square"){const u=document.createElement("div");u.className="color",u.style.backgroundColor=t,s.records[e][r].element.textContent="",s.records[e][r].element.appendChild(u)}else s.records[e][r].element.style.color=t,s.records[e][r].element.textContent=t;else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="image"){if(t=""+t,s.options.data[e][r]=t,s.records[e][r].element.innerHTML="",t&&t.substr(0,10)=="data:image"){const u=document.createElement("img");u.src=t,s.records[e][r].element.appendChild(u)}}else s.options.data[e][r]=t,s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="html"?s.records[e][r].element.innerHTML=stripScript(parseValue.call(s,r,e,t)):s.parent.config.parseHTML===!0?s.records[e][r].element.innerHTML=stripScript(parseValue.call(s,r,e,t,s.records[e][r].element)):s.records[e][r].element.textContent=parseValue.call(s,r,e,t,s.records[e][r].element),s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==0||!(s.options.wordWrap==1||s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==1||s.records[e][r].element.innerHTML.length>200)?s.records[e][r].element.style.whiteSpace="":s.records[e][r].element.style.whiteSpace="pre-wrap";r>0&&(s.records[e][r-1].element.style.overflow=t?"hidden":""),s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].render=="function"&&s.options.columns[r].render(s.records[e]&&s.records[e][r]?s.records[e][r].element:null,t,parseInt(r),parseInt(e),s,s.options.columns[r]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(s,"onchange",s,s.records[e]&&s.records[e][r]?s.records[e][r].element:null,r,e,t,o.oldValue)}else o={x:r,y:e,col:r,row:e};return o},isFormula=function(r){const e=(""+r)[0];return e=="="||e=="#"},getMask=function(r){if(r.format||r.mask||r.locale){const e={};return r.mask?e.mask=r.mask:r.format?e.mask=r.format:(e.locale=r.locale,e.options=r.options),r.decimal&&(e.options||(e.options={}),e.options={decimal:r.decimal}),e}return null},secureFormula=function(r){let e="",t=0;for(let n=0;n<r.length;n++)r[n]=='"'&&(t=t==0?1:0),e+=t==1?r[n]:r[n].toUpperCase();return e};let chainLoopProtection=[];const updateFormulaChain=function(r,e,t){const n=this,s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([r,e]);if(n.formula[s]&&n.formula[s].length>0)if(chainLoopProtection[s])n.records[e][r].element.innerHTML="#ERROR",n.formula[s]="";else{chainLoopProtection[s]=!0;for(let o=0;o<n.formula[s].length;o++){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n.formula[s][o],!0),l=""+n.options.data[a[1]][a[0]];l.substr(0,1)=="="?t.push(updateCell.call(n,a[0],a[1],l,!0)):Object.keys(n.formula)[o]=null,updateFormulaChain.call(n,a[0],a[1],t)}}chainLoopProtection=[]},updateFormula=function(r,e){const t=/[A-Z]/,n=/[0-9]/;let s="",o=null,a=null,l="";for(let u=0;u<r.length;u++)t.exec(r[u])?(o=1,a=0,l+=r[u]):n.exec(r[u])?(a=o?1:0,l+=r[u]):(o&&a&&(l=e[l]?e[l]:l),s+=l,s+=r[u],o=0,a=0,l="");return l&&(o&&a&&(l=e[l]?e[l]:l),s+=l),s},updateFormulas=function(r){const e=this;for(let s=0;s<e.options.data.length;s++)for(let o=0;o<e.options.data[0].length;o++){const a=""+e.options.data[s][o];if(a.substr(0,1)=="="){const l=updateFormula(a,r);l!=a&&(e.options.data[s][o]=l)}}const t=[],n=Object.keys(e.formula);for(let s=0;s<n.length;s++){let o=n[s];const a=e.formula[o];r[o]&&(o=r[o]),t[o]=[];for(let l=0;l<a.length;l++){let u=a[l];r[u]&&(u=r[u]),t[o].push(u)}}e.formula=t},updateTableReferences=function(){const r=this;for(let o=0;o<r.headers.length;o++)r.headers[o].getAttribute("data-x")!=o&&(r.headers[o].setAttribute("data-x",o),r.headers[o].getAttribute("title")||(r.headers[o].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(o)));for(let o=0;o<r.rows.length;o++)r.rows[o]&&r.rows[o].element.getAttribute("data-y")!=o&&(r.rows[o].element.setAttribute("data-y",o),r.rows[o].element.children[0].setAttribute("data-y",o),r.rows[o].element.children[0].innerHTML=o+1);const e=[],t=[],n=function(o,a,l,u){if(o!=l&&r.records[u][l].element.setAttribute("data-x",l),a!=u&&r.records[u][l].element.setAttribute("data-y",u),o!=l||a!=u){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,a]),d=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([l,u]);e[c]=d}};for(let o=0;o<r.records.length;o++)for(let a=0;a<r.records[0].length;a++)if(r.records[o][a]){const l=r.records[o][a].element.getAttribute("data-x"),u=r.records[o][a].element.getAttribute("data-y");if(r.records[o][a].element.getAttribute("data-merged")){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([l,u]),d=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([a,o]);if(t[c]==null)if(c==d)t[c]=!1;else{const f=parseInt(a-l),C=parseInt(o-u);t[c]=[d,f,C]}}else n(l,u,a,o)}const s=Object.keys(t);if(s.length){for(let o=0;o<s.length;o++)if(t[s[o]]){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(s[o],!0);let l=a[0],u=a[1];n(l,u,l+t[s[o]][1],u+t[s[o]][2]);const c=s[o],d=t[s[o]][0];for(let f=0;f<r.options.mergeCells[c][2].length;f++)l=parseInt(r.options.mergeCells[c][2][f].getAttribute("data-x")),u=parseInt(r.options.mergeCells[c][2][f].getAttribute("data-y")),r.options.mergeCells[c][2][f].setAttribute("data-x",l+t[s[o]][1]),r.options.mergeCells[c][2][f].setAttribute("data-y",u+t[s[o]][2]);r.options.mergeCells[d]=r.options.mergeCells[c],delete r.options.mergeCells[c]}}updateFormulas.call(r,e),_meta_js__WEBPACK_IMPORTED_MODULE_5__.Lx.call(r,e),_selection_js__WEBPACK_IMPORTED_MODULE_1__.E.call(r),updateTable.call(r)},updateScroll=function(r){const e=this,t=e.content.getBoundingClientRect(),n=t.left,s=t.top,o=t.width,a=t.height,l=e.records[e.selectedCell[3]][e.selectedCell[2]].element.getBoundingClientRect(),u=l.left,c=l.top,d=l.width,f=l.height;let C,m;r==0||r==1?(C=u-n+e.content.scrollLeft,m=c-s+e.content.scrollTop-2):(C=u-n+e.content.scrollLeft+d,m=c-s+e.content.scrollTop+f),m>e.content.scrollTop+30&&m<e.content.scrollTop+a||(m<e.content.scrollTop+30?e.content.scrollTop=m-f:e.content.scrollTop=m-(a-2));const E=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.I.call(e);C>e.content.scrollLeft+E&&C<e.content.scrollLeft+o||(C<e.content.scrollLeft+30?(e.content.scrollLeft=C,e.content.scrollLeft<50&&(e.content.scrollLeft=0)):C<e.content.scrollLeft+E?e.content.scrollLeft=C-E-1:e.content.scrollLeft=C-(o-20))},updateResult=function(){const r=this;let e=0,t=0;for(e=r.options.lazyLoading==1?100:r.options.pagination>0?r.options.pagination:r.results?r.results.length:r.rows.length;r.tbody.firstChild;)r.tbody.removeChild(r.tbody.firstChild);for(let n=0;n<r.rows.length;n++)!r.results||r.results.indexOf(n)>-1?(t<e&&(r.tbody.appendChild(r.rows[n].element),t++),r.rows[n].element.style.display=""):r.rows[n].element.style.display="none";return r.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.Ik.call(r),_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(r),e},getCell=function(r,e){if(typeof r=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r,!0);r=t[0],e=t[1]}return this.records[e][r].element},getCellFromCoords=function(r,e){return this.records[e][r].element},getLabel=function(r,e){if(typeof r=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r,!0);r=t[0],e=t[1]}return this.records[e][r].element.innerHTML},fullscreen=function(r){const e=this;r==null&&(r=!e.config.fullscreen),e.config.fullscreen!=r&&(e.config.fullscreen=r,r==1?e.element.classList.add("fullscreen"):e.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(r){const e=this,t=document.createElement("tr");t.classList.add("jss_nested");const n=document.createElement("td");n.classList.add("jss_selectall"),t.appendChild(n),r.element=t;let s=0;for(let o=0;o<r.length;o++){r[o].colspan||(r[o].colspan=1),r[o].title||(r[o].title=""),r[o].id||(r[o].id="");let a=r[o].colspan;const l=[];for(let c=0;c<a;c++)e.options.columns[s]&&e.options.columns[s].type=="hidden"&&a++,l.push(s),s++;const u=document.createElement("td");u.setAttribute("data-column",l.join(",")),u.setAttribute("colspan",r[o].colspan),u.setAttribute("align",r[o].align||"center"),u.setAttribute("id",r[o].id),u.textContent=r[o].title,t.appendChild(u)}return t},getWorksheetActive=function(){const r=this.parent?this.parent:this;return r.element.tabs?r.element.tabs.getActive():0},getWorksheetInstance=function(r){const e=r!==void 0?r:getWorksheetActive.call(this);return this.worksheets[e]}},323:function(r,e,t){t.d(e,{Ar:function(){return a},Wc:function(){return s},qP:function(){return o}});var n=t(650);const s=function(l,u,c){if(u<=l.length)return l.slice(0,u).concat(c).concat(l.slice(u));const d=l.slice(0,l.length);for(;u>d.length;)d.push(void 0);return d.concat(c)},o=function(l,u){const c=/^[a-zA-Z]+/.exec(l);if(c){let d=0;for(let C=0;C<c[0].length;C++)d+=parseInt(c[0].charCodeAt(C)-64)*Math.pow(26,c[0].length-1-C);d--,d<0&&(d=0);let f=parseInt(/[0-9]+$/.exec(l));f>0&&f--,l=u==1?[d,f]:d+"-"+f}return l},a=function(l){return Array.isArray(l)||(l=l.split("-")),(0,n.getColumnName)(parseInt(l[0]))+(parseInt(l[1])+1)}},665:function(r,e,t){t.d(e,{Kw:function(){return o},VG:function(){return a},ij:function(){return n},iw:function(){return s}});const n=function(l){const u=this;let c;c=u.options.search!=1&&u.options.filters!=1||!u.results?u.rows:u.results;const d=100;l!=null&&l!=-1||(l=Math.ceil(c.length/d)-1);let f=l*d,C=l*d+d;C>c.length&&(C=c.length),f=C-100,f<0&&(f=0);for(let m=f;m<C;m++)u.options.search!=1&&u.options.filters!=1||!u.results?u.tbody.appendChild(u.rows[m].element):u.tbody.appendChild(u.rows[c[m]].element),u.tbody.children.length>d&&u.tbody.removeChild(u.tbody.firstChild)},s=function(){const l=this;if(l.selectedCell){const u=parseInt(l.tbody.firstChild.getAttribute("data-y"))/100,c=parseInt(l.selectedCell[3]/100),d=parseInt(l.rows.length/100);if(u!=c&&c<=d&&!Array.prototype.indexOf.call(l.tbody.children,l.rows[l.selectedCell[3]].element))return l.loadPage(c),!0}return!1},o=function(){const l=this;let u;u=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let c=0;if(u.length>100){let d=parseInt(l.tbody.firstChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(d=u.indexOf(d)),d>0)for(let f=0;f<30;f++)d-=1,d>-1&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.insertBefore(l.rows[d].element,l.tbody.firstChild):l.tbody.insertBefore(l.rows[u[d]].element,l.tbody.firstChild),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.lastChild),c=1))}return c},a=function(){const l=this;let u;u=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let c=0;if(u.length>100){let d=parseInt(l.tbody.lastChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(d=u.indexOf(d)),d<l.rows.length-1)for(let f=0;f<=30;f++)d<u.length&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.appendChild(l.rows[d].element):l.tbody.appendChild(l.rows[u[d]].element),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.firstChild),c=1)),d+=1}return c}},49:function(r,e,t){t.d(e,{D0:function(){return u},D8:function(){return d},Vg:function(){return C},mt:function(){return f},q4:function(){return c},tW:function(){return m}});var n=t(323),s=t(992),o=t(923),a=t(100),l=t(366);const u=function(E,v){const _=this,T=[];if(_.options.mergeCells){const R=Object.keys(_.options.mergeCells);for(let O=0;O<R.length;O++){const N=(0,n.qP)(R[O],!0),G=_.options.mergeCells[R[O]][0],D=N[0],k=N[0]+(G>1?G-1:0);v==null?D<=E&&k>=E&&T.push(R[O]):v?D<E&&k>=E&&T.push(R[O]):D<=E&&k>E&&T.push(R[O])}}return T},c=function(E,v){const _=this,T=[];if(_.options.mergeCells){const R=Object.keys(_.options.mergeCells);for(let O=0;O<R.length;O++){const N=(0,n.qP)(R[O],!0),G=_.options.mergeCells[R[O]][1],D=N[1],k=N[1]+(G>1?G-1:0);v==null?D<=E&&k>=E&&T.push(R[O]):v?D<E&&k>=E&&T.push(R[O]):D<=E&&k>E&&T.push(R[O])}}return T},d=function(E){const v=this;let _={};if(E)_=v.options.mergeCells&&v.options.mergeCells[E]?[v.options.mergeCells[E][0],v.options.mergeCells[E][1]]:null;else if(v.options.mergeCells){v.options.mergeCells;const T=Object.keys(v.options.mergeCells);for(let R=0;R<T.length;R++)_[T[R]]=[v.options.mergeCells[T[R]][0],v.options.mergeCells[T[R]][1]]}return _},f=function(E,v,_,T){const R=this;let O=!1;if(E){if(typeof E!="string")return null}else{if(!R.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const G=parseInt(R.highlighted[0].getAttribute("data-x")),D=parseInt(R.highlighted[0].getAttribute("data-y")),k=parseInt(R.highlighted[R.highlighted.length-1].getAttribute("data-x")),z=parseInt(R.highlighted[R.highlighted.length-1].getAttribute("data-y"));E=(0,n.Ar)([G,D]),v=k-G+1,_=z-D+1}}const N=(0,n.qP)(E,!0);if(R.options.mergeCells&&R.options.mergeCells[E])R.records[N[1]][N[0]].element.getAttribute("data-merged")&&(O="Cell already merged");else if((!v||v<2)&&(!_||_<2))O="Invalid merged properties";else for(let G=N[1];G<N[1]+_;G++)for(let D=N[0];D<N[0]+v;D++)(0,n.Ar)([D,G]),R.records[G][D].element.getAttribute("data-merged")&&(O="There is a conflict with another merged cell");if(O)alert(jSuites.translate(O));else{v>1?R.records[N[1]][N[0]].element.setAttribute("colspan",v):v=1,_>1?R.records[N[1]][N[0]].element.setAttribute("rowspan",_):_=1,R.options.mergeCells||(R.options.mergeCells={}),R.options.mergeCells[E]=[v,_,[]],R.records[N[1]][N[0]].element.setAttribute("data-merged","true"),R.records[N[1]][N[0]].element.style.overflow="hidden";const G=[];for(let D=N[1];D<N[1]+_;D++)for(let k=N[0];k<N[0]+v;k++)N[0]==k&&N[1]==D||(G.push(R.options.data[D][k]),s.wW.call(R,k,D,"",!0),R.options.mergeCells[E][2].push(R.records[D][k].element),R.records[D][k].element.style.display="none",R.records[D][k].element=R.records[N[1]][N[0]].element);l.e3.call(R,R.records[N[1]][N[0]].element),T||(o.JB.call(R,{action:"setMerge",column:E,colspan:v,rowspan:_,data:G}),a.Z.call(R,"onmerge",R,{[E]:[v,_]}))}},C=function(E,v,_){const T=this;if(T.options.mergeCells&&T.options.mergeCells[E]){const R=(0,n.qP)(E,!0);T.records[R[1]][R[0]].element.removeAttribute("colspan"),T.records[R[1]][R[0]].element.removeAttribute("rowspan"),T.records[R[1]][R[0]].element.removeAttribute("data-merged");const O=T.options.mergeCells[E];let N,G,D=0;for(N=0;N<O[1];N++)for(G=0;G<O[0];G++)(N>0||G>0)&&(T.records[R[1]+N][R[0]+G].element=O[2][D],T.records[R[1]+N][R[0]+G].element.style.display="",v&&v[D]&&s.wW.call(T,R[0]+G,R[1]+N,v[D]),D++);l.e3.call(T,T.records[R[1]][R[0]].element,T.records[R[1]+N-1][R[0]+G-1].element),_||delete T.options.mergeCells[E]}},m=function(E){const v=this;if(v.options.mergeCells){v.options.mergeCells;const _=Object.keys(v.options.mergeCells);for(let T=0;T<_.length;T++)C.call(v,_[T],null,E)}}},272:function(r,e,t){t.d(e,{Lx:function(){return o},US:function(){return a},xZ:function(){return s}});var n=t(100);const s=function(l,u){const c=this;return l?u?c.options.meta&&c.options.meta[l]&&c.options.meta[l][u]?c.options.meta[l][u]:null:c.options.meta&&c.options.meta[l]?c.options.meta[l]:null:c.options.meta},o=function(l){const u=this;if(u.options.meta){const c={},d=Object.keys(u.options.meta);for(let f=0;f<d.length;f++)l[d[f]]?c[l[d[f]]]=u.options.meta[d[f]]:c[d[f]]=u.options.meta[d[f]];u.options.meta=c}},a=function(l,u,c){const d=this;if(d.options.meta||(d.options.meta={}),u&&c)d.options.meta[l]||(d.options.meta[l]={}),d.options.meta[l][u]=c,n.Z.call(d,"onchangemeta",d,{[l]:{[u]:c}});else{const f=Object.keys(l);for(let C=0;C<f.length;C++){d.options.meta[f[C]]||(d.options.meta[f[C]]={});const m=Object.keys(l[f[C]]);for(let E=0;E<m.length;E++)d.options.meta[f[C]][m[E]]=l[f[C]][m[E]]}n.Z.call(d,"onchangemeta",d,l)}}},54:function(r,e,t){t.d(e,{Cs:function(){return c},SV:function(){return u},Xo:function(){return d}});var n=t(923),s=t(100),o=t(992),a=t(665),l=t(456);const u=function(f,C){const m=this;for(let E=0;E<m.headers.length;E++)m.headers[E].classList.remove("arrow-up"),m.headers[E].classList.remove("arrow-down");C?m.headers[f].classList.add("arrow-up"):m.headers[f].classList.add("arrow-down")},c=function(f){const C=this;let m=[];for(let E=0;E<f.length;E++)m[E]=C.options.data[f[E]];C.options.data=m,m=[];for(let E=0;E<f.length;E++){m[E]=C.records[f[E]];for(let v=0;v<m[E].length;v++)m[E][v].y=E}C.records=m,m=[];for(let E=0;E<f.length;E++)m[E]=C.rows[f[E]],m[E].y=E;if(C.rows=m,o.ec.call(C),C.results&&C.results.length)C.searchInput.value?C.search(C.searchInput.value):l.ql.call(C);else if(C.results=null,C.pageNumber=0,C.options.pagination>0)C.page(0);else if(C.options.lazyLoading==1)a.ij.call(C,0);else for(let E=0;E<C.rows.length;E++)C.tbody.appendChild(C.rows[E].element)},d=function(f,C){const m=this;if(f>=0){if(m.options.mergeCells&&Object.keys(m.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;m.destroyMerge()}C=C==null?m.headers[f].classList.contains("arrow-down")?1:0:C?1:0;let E=[];if(m.options.columns&&m.options.columns[f]&&(m.options.columns[f].type=="number"||m.options.columns[f].type=="numeric"||m.options.columns[f].type=="percentage"||m.options.columns[f].type=="autonumber"||m.options.columns[f].type=="color"))for(let _=0;_<m.options.data.length;_++)E[_]=[_,Number(m.options.data[_][f])];else if(m.options.columns&&m.options.columns[f]&&(m.options.columns[f].type=="calendar"||m.options.columns[f].type=="checkbox"||m.options.columns[f].type=="radio"))for(let _=0;_<m.options.data.length;_++)E[_]=[_,m.options.data[_][f]];else for(let _=0;_<m.options.data.length;_++)E[_]=[_,m.records[_][f].element.textContent.toLowerCase()];typeof m.parent.config.sorting!="function"&&(m.parent.config.sorting=function(_){return function(T,R){const O=T[1],N=R[1];return _?O===""&&N!==""?1:O!==""&&N===""||O>N?-1:O<N?1:0:O===""&&N!==""?1:O!==""&&N===""?-1:O>N?1:O<N?-1:0}}),E=E.sort(m.parent.config.sorting(C));const v=[];for(let _=0;_<E.length;_++)v[_]=E[_][0];return n.JB.call(m,{action:"orderBy",rows:v,column:f,order:C}),u.call(m,f,C),c.call(m,v),s.Z.call(m,"onsort",m,f,C,v.map(_=>_)),!0}}},673:function(r,e,t){t.d(e,{Ik:function(){return a},Md:function(){return l},an:function(){return o},ur:function(){return u}});var n=t(100),s=t(366);const o=function(c){const d=this;return d.options.search!=1&&d.options.filters!=1||!d.results||(c=d.results.indexOf(c)),Math.ceil((parseInt(c)+1)/parseInt(d.options.pagination))-1},a=function(){const c=this;if(c.pagination.children[0].innerHTML="",c.pagination.children[1].innerHTML="",c.options.pagination){let d;if(d=c.options.search!=1&&c.options.filters!=1||!c.results?c.rows.length:c.results.length,d){const f=Math.ceil(d/c.options.pagination);let C,m;if(c.pageNumber<6?(C=1,m=f<10?f:10):f-c.pageNumber<5?(C=f-9,m=f,C<1&&(C=1)):(C=c.pageNumber-4,m=c.pageNumber+5),C>1){const v=document.createElement("div");v.className="jss_page",v.innerHTML="<",v.title=1,c.pagination.children[1].appendChild(v)}for(let v=C;v<=m;v++){const _=document.createElement("div");_.className="jss_page",_.innerHTML=v,c.pagination.children[1].appendChild(_),c.pageNumber==v-1&&_.classList.add("jss_page_selected")}if(m<f){const v=document.createElement("div");v.className="jss_page",v.innerHTML=">",v.title=f,c.pagination.children[1].appendChild(v)}const E=function(v){const _=Array.prototype.slice.call(arguments,1);return v.replace(/{(\d+)}/g,function(T,R){return _[R]!==void 0?_[R]:T})};c.pagination.children[0].innerHTML=E(jSuites.translate("Showing page {0} of {1} entries"),c.pageNumber+1,f)}else c.pagination.children[0].innerHTML=jSuites.translate("No records found")}},l=function(c){const d=this,f=d.pageNumber;let C;C=d.options.search!=1&&d.options.filters!=1||!d.results?d.rows:d.results;const m=parseInt(d.options.pagination);c!=null&&c!=-1||(c=Math.ceil(C.length/m)-1),d.pageNumber=c;let E=c*m,v=c*m+m;for(v>C.length&&(v=C.length),E<0&&(E=0);d.tbody.firstChild;)d.tbody.removeChild(d.tbody.firstChild);for(let _=E;_<v;_++)d.options.search!=1&&d.options.filters!=1||!d.results?d.tbody.appendChild(d.rows[_].element):d.tbody.appendChild(d.rows[C[_]].element);d.options.pagination>0&&a.call(d),s.x8.call(d),n.Z.call(d,"onchangepage",d,c,f,d.options.pagination)},u=function(){const c=this;let d;return d=c.options.search!=1&&c.options.filters!=1||!c.results?c.rows.length:c.results.length,Math.ceil(d/c.options.pagination)}},366:function(r,e,t){t.d(e,{E:function(){return _},Es:function(){return E},F1:function(){return O},H7:function(){return v},Mf:function(){return z},Mt:function(){return T},Uv:function(){return G},VD:function(){return xe},VL:function(){return ve},Ym:function(){return D},e3:function(){return C},ey:function(){return ne},rx:function(){return Z},td:function(){return k},vn:function(){return m},vp:function(){return N},x8:function(){return d},yE:function(){return f}});var n=t(100),s=t(157),o=t(650),a=t(923),l=t(992),u=t(323),c=t(898);const d=function(){const de=this;if(de.highlighted&&de.highlighted.length){const Se=de.highlighted[de.highlighted.length-1].element,Me=Se.getAttribute("data-x"),Pe=de.content.getBoundingClientRect(),_e=Pe.left,Oe=Pe.top,st=Se.getBoundingClientRect(),rt=st.left,U=st.top,te=st.width,V=st.height,ue=rt-_e+de.content.scrollLeft+te-4,Ne=U-Oe+de.content.scrollTop+V-4;if(de.corner.style.top=Ne+"px",de.corner.style.left=ue+"px",de.options.freezeColumns){const Ge=s.I.call(de);Me>de.options.freezeColumns-1&&rt-_e+te<Ge?de.corner.style.display="none":de.options.selectionCopy!=0&&(de.corner.style.display="")}else de.options.selectionCopy!=0&&(de.corner.style.display="")}else de.corner.style.top="-2000px",de.corner.style.left="-2000px";(0,c.yf)(de)},f=function(de){const Se=this;let Me;if(Se.highlighted&&Se.highlighted.length){Me=1;for(let Pe=0;Pe<Se.highlighted.length;Pe++){Se.highlighted[Pe].element.classList.remove("highlight"),Se.highlighted[Pe].element.classList.remove("highlight-left"),Se.highlighted[Pe].element.classList.remove("highlight-right"),Se.highlighted[Pe].element.classList.remove("highlight-top"),Se.highlighted[Pe].element.classList.remove("highlight-bottom"),Se.highlighted[Pe].element.classList.remove("highlight-selected");const _e=parseInt(Se.highlighted[Pe].element.getAttribute("data-x")),Oe=parseInt(Se.highlighted[Pe].element.getAttribute("data-y"));let st,rt;if(Se.highlighted[Pe].element.getAttribute("data-merged")){const U=parseInt(Se.highlighted[Pe].element.getAttribute("colspan")),te=parseInt(Se.highlighted[Pe].element.getAttribute("rowspan"));st=U>0?_e+(U-1):_e,rt=te>0?Oe+(te-1):Oe}else st=_e,rt=Oe;for(let U=_e;U<=st;U++)Se.headers[U]&&Se.headers[U].classList.remove("selected");for(let U=Oe;U<=rt;U++)Se.rows[U]&&Se.rows[U].element.classList.remove("selected")}}else Me=0;return Se.highlighted=[],Se.selectedCell=null,Se.corner.style.top="-2000px",Se.corner.style.left="-2000px",de==1&&Me==1&&n.Z.call(Se,"onblur",Se),Me},C=function(de,Se,Me){const Pe=de.getAttribute("data-x"),_e=de.getAttribute("data-y");let Oe,st;Se?(Oe=Se.getAttribute("data-x"),st=Se.getAttribute("data-y")):(Oe=Pe,st=_e),E.call(this,Pe,_e,Oe,st,Me)},m=function(){const de=document.querySelectorAll(".jss_worksheet .copying");for(let Se=0;Se<de.length;Se++)de[Se].classList.remove("copying"),de[Se].classList.remove("copying-left"),de[Se].classList.remove("copying-right"),de[Se].classList.remove("copying-top"),de[Se].classList.remove("copying-bottom")},E=function(de,Se,Me,Pe,_e){const Oe=this;if(Se==null){if(Se=0,Pe=Oe.rows.length-1,de==null)return}else de==null&&(de=0,Me=Oe.options.data[0].length-1);Me==null&&(Me=de),Pe==null&&(Pe=Se),de>=Oe.headers.length&&(de=Oe.headers.length-1),Se>=Oe.rows.length&&(Se=Oe.rows.length-1),Me>=Oe.headers.length&&(Me=Oe.headers.length-1),Pe>=Oe.rows.length&&(Pe=Oe.rows.length-1);let st,rt,U,te,V=null,ue=null,Ne=null,Ge=null;parseInt(de)<parseInt(Me)?(st=parseInt(de),rt=parseInt(Me)):(st=parseInt(Me),rt=parseInt(de)),parseInt(Se)<parseInt(Pe)?(U=parseInt(Se),te=parseInt(Pe)):(U=parseInt(Pe),te=parseInt(Se));for(let Ie=st;Ie<=rt;Ie++)for(let Ke=U;Ke<=te;Ke++)if(Oe.records[Ke][Ie]&&Oe.records[Ke][Ie].element.getAttribute("data-merged")){const le=parseInt(Oe.records[Ke][Ie].element.getAttribute("data-x")),ge=parseInt(Oe.records[Ke][Ie].element.getAttribute("data-y")),we=parseInt(Oe.records[Ke][Ie].element.getAttribute("colspan")),qe=parseInt(Oe.records[Ke][Ie].element.getAttribute("rowspan"));we>1&&(le<st&&(st=le),le+we>rt&&(rt=le+we-1)),qe&&(ge<U&&(U=ge),ge+qe>te&&(te=ge+qe-1))}for(let Ie=U;Ie<=te;Ie++)Oe.rows[Ie].element.style.display!="none"&&(Ne==null&&(Ne=Ie),Ge=Ie);for(let Ie=st;Ie<=rt;Ie++)for(let Ke=U;Ke<=te;Ke++)Oe.options.columns&&Oe.options.columns[Ie]&&Oe.options.columns[Ie].type=="hidden"||(V==null&&(V=Ie),ue=Ie);if(V||(V=0),ue||(ue=0),n.Z.call(Oe,"onbeforeselection",Oe,V,Ne,ue,Ge,_e)===!1)return!1;const Ue=Oe.resetSelection();Oe.selectedCell=[de,Se,Me,Pe],Oe.records[Se][de]&&Oe.records[Se][de].element.classList.add("highlight-selected");for(let Ie=st;Ie<=rt;Ie++)for(let Ke=U;Ke<=te;Ke++)Oe.rows[Ke].element.style.display!="none"&&Oe.records[Ke][Ie].element.style.display!="none"&&(Oe.records[Ke][Ie].element.classList.add("highlight"),Oe.highlighted.push(Oe.records[Ke][Ie]));for(let Ie=V;Ie<=ue;Ie++)Oe.options.columns&&Oe.options.columns[Ie]&&Oe.options.columns[Ie].type=="hidden"||!Oe.cols[Ie].colElement.style||Oe.cols[Ie].colElement.style.display=="none"||(Oe.records[Ne]&&Oe.records[Ne][Ie]&&Oe.records[Ne][Ie].element.classList.add("highlight-top"),Oe.records[Ge]&&Oe.records[Ge][Ie]&&Oe.records[Ge][Ie].element.classList.add("highlight-bottom"),Oe.headers[Ie].classList.add("selected"));for(let Ie=Ne;Ie<=Ge;Ie++)Oe.rows[Ie]&&Oe.rows[Ie].element.style.display!="none"&&(Oe.records[Ie][V].element.classList.add("highlight-left"),Oe.records[Ie][ue].element.classList.add("highlight-right"),Oe.rows[Ie].element.classList.add("selected"));Oe.selectedContainer=[V,Ne,ue,Ge],Ue==0&&(n.Z.call(Oe,"onfocus",Oe),m()),n.Z.call(Oe,"onselection",Oe,V,Ne,ue,Ge,_e),d.call(Oe)},v=function(de){const Se=this;if(!Se.selectedCell)return[];const Me=[];for(let Pe=Math.min(Se.selectedCell[0],Se.selectedCell[2]);Pe<=Math.max(Se.selectedCell[0],Se.selectedCell[2]);Pe++)de&&Se.headers[Pe].style.display=="none"||Me.push(Pe);return Me},_=function(){const de=this;de.selectedCell&&de.updateSelectionFromCoords(de.selectedCell[0],de.selectedCell[1],de.selectedCell[2],de.selectedCell[3])},T=function(){const de=this;for(let Se=0;Se<de.selection.length;Se++)de.selection[Se].classList.remove("selection"),de.selection[Se].classList.remove("selection-left"),de.selection[Se].classList.remove("selection-right"),de.selection[Se].classList.remove("selection-top"),de.selection[Se].classList.remove("selection-bottom");de.selection=[]},R=function(de){return(de=""+de).length==1&&(de="0"+de),de},O=function(de,Se){const Me=this,Pe=Me.getData(!0,!0),_e=Me.selectedContainer,Oe=parseInt(de.getAttribute("data-x")),st=parseInt(de.getAttribute("data-y")),rt=parseInt(Se.getAttribute("data-x")),U=parseInt(Se.getAttribute("data-y")),te=[];let V,ue,Ne=!1;_e[0]==Oe?(V=st<_e[1]?st-_e[1]:1,ue=0):(ue=Oe<_e[0]?Oe-_e[0]:1,V=0);let Ge=0,Ue=0;for(let Ke=st;Ke<=U;Ke++)if(!Me.rows[Ke]||Me.rows[Ke].element.style.display!="none"){Pe[Ue]==null&&(Ue=0),Ge=0,_e[0]!=Oe&&(ue=Oe<_e[0]?Oe-_e[0]:1);for(let le=Oe;le<=rt;le++){if(Me.records[Ke][le]&&!Me.records[Ke][le].element.classList.contains("readonly")&&Me.records[Ke][le].element.style.display!="none"&&Ne==0){if(!Me.selection.length&&Me.options.data[Ke][le]!=""){Ne=!0;continue}(Pe[Ue]==null||Pe[Ue][Ge]==null)&&(Ge=0);let ge=Pe[Ue][Ge];if(ge&&!Pe[1]&&Me.parent.config.autoIncrement!=0)if(!Me.options.columns||!Me.options.columns[le]||Me.options.columns[le].type&&Me.options.columns[le].type!="text"&&Me.options.columns[le].type!="number"){if(Me.options.columns&&Me.options.columns[le]&&Me.options.columns[le].type=="calendar"){const we=new Date(ge);we.setDate(we.getDate()+V),ge=we.getFullYear()+"-"+R(parseInt(we.getMonth()+1))+"-"+R(we.getDate())+" 00:00:00"}}else if((""+ge).substr(0,1)=="="){const we=ge.match(/([A-Z]+[0-9]+)/g);if(we){const qe=[];for(let $e=0;$e<we.length;$e++){const ze=(0,u.qP)(we[$e],1);ze[0]+=ue,ze[1]+=V,ze[1]<0&&(ze[1]=0);const it=(0,u.Ar)([ze[0],ze[1]]);it!=we[$e]&&(qe[we[$e]]=it)}ge=(0,l.E2)(ge,qe)}}else ge==Number(ge)&&(ge=Number(ge)+V);te.push(l.wW.call(Me,le,Ke,ge)),l.Zz.call(Me,le,Ke,te)}Ge++,_e[0]!=Oe&&ue++}Ue++,V++}a.JB.call(Me,{action:"setValue",records:te,selection:Me.selectedCell}),l.T0.call(Me);const Ie=te.map(function(Ke){return{x:Ke.x,y:Ke.y,value:Ke.newValue,oldValue:Ke.oldValue}});n.Z.call(Me,"onafterchanges",Me,Ie)},N=function(de){let Se,Me,Pe=0;if(de.length===0)return Pe;for(Se=0;Se<de.length;Se++)Me=de.charCodeAt(Se),Pe=(Pe<<5)-Pe+Me,Pe|=0;return Pe},G=function(de,Se,Me){const Pe=this;if(de==1){if(Pe.selectedCell&&(Se>=Pe.selectedCell[1]&&Se<=Pe.selectedCell[3]||Me>=Pe.selectedCell[1]&&Me<=Pe.selectedCell[3]))return void Pe.resetSelection()}else if(Pe.selectedCell&&(Se>=Pe.selectedCell[0]&&Se<=Pe.selectedCell[2]||Me>=Pe.selectedCell[0]&&Me<=Pe.selectedCell[2]))return void Pe.resetSelection()},D=function(de){const Se=this;if(!Se.selectedCell)return[];const Me=[];for(let Pe=Math.min(Se.selectedCell[1],Se.selectedCell[3]);Pe<=Math.max(Se.selectedCell[1],Se.selectedCell[3]);Pe++)de&&Se.rows[Pe].element.style.display=="none"||Me.push(Pe);return Me},k=function(){const de=this;de.selectedCell||(de.selectedCell=[]),de.selectedCell[0]=0,de.selectedCell[1]=0,de.selectedCell[2]=de.headers.length-1,de.selectedCell[3]=de.records.length-1,de.updateSelectionFromCoords(de.selectedCell[0],de.selectedCell[1],de.selectedCell[2],de.selectedCell[3])},z=function(){const de=this;return de.selectedCell?[Math.min(de.selectedCell[0],de.selectedCell[2]),Math.min(de.selectedCell[1],de.selectedCell[3]),Math.max(de.selectedCell[0],de.selectedCell[2]),Math.max(de.selectedCell[1],de.selectedCell[3])]:null},ne=function(de){const Se=this,Me=z.call(Se);if(!Me)return[];const Pe=[];for(let _e=Me[1];_e<=Me[3];_e++)for(let Oe=Me[0];Oe<=Me[2];Oe++)de?Pe.push((0,o.getCellNameFromCoords)(Oe,_e)):Pe.push(Se.records[_e][Oe]);return Pe},Z=function(){const de=this,Se=z.call(de);if(!Se)return"";const Me=(0,o.getCellNameFromCoords)(Se[0],Se[1]),Pe=(0,o.getCellNameFromCoords)(Se[2],Se[3]);return Me===Pe?de.options.worksheetName+"!"+Me:de.options.worksheetName+"!"+Me+":"+Pe},ve=function(de,Se){const Me=z.call(this);return de>=Me[0]&&de<=Me[2]&&Se>=Me[1]&&Se<=Me[3]},xe=function(){const de=z.call(this);return de?[de]:[]}},898:function(r,e,t){t.d(e,{bv:function(){return d},iu:function(){return f},yf:function(){return c}});var n=t(650),s=t(992);const o=function(C,m){m.options.editable!=0?C.classList.remove("jtoolbar-disabled"):C.classList.add("jtoolbar-disabled")},a=function(){const C=[],m=this,E=function(){return s.Hf.call(m)};C.push({content:"undo",onclick:function(){E().undo()}}),C.push({content:"redo",onclick:function(){E().redo()}}),C.push({content:"save",onclick:function(){const _=E();_&&_.download()}}),C.push({type:"divisor"}),C.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(_){return'<span style="font-family:'+_+'">'+_+"</span>"},onchange:function(_,T,R,O,N){const G=E();let D=G.getSelected(!0);if(D){let k=N?O:"";G.setStyle(Object.fromEntries(D.map(function(z){return[z,"font-family: "+k]})))}},updateState:function(_,T,R){o(R,E())}}),C.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(_){return'<span style="font-size:'+_+'">'+_+"</span>"},onchange:function(_,T,R,O){const N=E();let G=N.getSelected(!0);G&&N.setStyle(Object.fromEntries(G.map(function(D){return[D,"font-size: "+O]})))},updateState:function(_,T,R){o(R,E())}}),C.push({type:"select",options:["left","center","right","justify"],render:function(_){return'<i class="material-icons">format_align_'+_+"</i>"},onchange:function(_,T,R,O){const N=E();let G=N.getSelected(!0);G&&N.setStyle(Object.fromEntries(G.map(function(D){return[D,"text-align: "+O]})))},updateState:function(_,T,R){o(R,E())}}),C.push({content:"format_bold",onclick:function(_,T,R){const O=E();let N=O.getSelected(!0);N&&O.setStyle(Object.fromEntries(N.map(function(G){return[G,"font-weight:bold"]})))},updateState:function(_,T,R){o(R,E())}}),C.push({type:"color",content:"format_color_text",k:"color",updateState:function(_,T,R){o(R,E())}}),C.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(_,T,R,O){o(R,E())}});let v=["top","middle","bottom"];return C.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(_){return'<i class="material-icons">'+_+"</i>"},value:1,onchange:function(_,T,R,O,N){const G=E();let D=G.getSelected(!0);D&&G.setStyle(Object.fromEntries(D.map(function(k){return[k,"vertical-align: "+v[N]]})))},updateState:function(_,T,R){o(R,E())}}),C.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const _=E();if(_.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const T=[Math.min(_.selectedCell[0],_.selectedCell[2]),Math.min(_.selectedCell[1],_.selectedCell[3]),Math.max(_.selectedCell[0],_.selectedCell[2]),Math.max(_.selectedCell[1],_.selectedCell[3])];let R=(0,n.getCellNameFromCoords)(T[0],T[1]);if(_.records[T[1]][T[0]].element.getAttribute("data-merged"))_.removeMerge(R);else{let O=T[2]-T[0]+1,N=T[3]-T[1]+1;O===1&&N===1||_.setMerge(R,O,N)}}},updateState:function(_,T,R){o(R,E())}}),C.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(_){return'<i class="material-icons">'+_+"</i>"},right:!0,onchange:function(_,T,R,O){const N=E(),G=[Math.min(N.selectedCell[0],N.selectedCell[2]),Math.min(N.selectedCell[1],N.selectedCell[3]),Math.max(N.selectedCell[0],N.selectedCell[2]),Math.max(N.selectedCell[1],N.selectedCell[3])];let D=O;{let k=T.thickness||1,z=T.color||"black";const ne=T.style||"solid";ne==="double"&&(k+=2);let Z={},ve=G[0],xe=G[1],de=G[2],Se=G[3];const Me=function(Pe,_e,Oe){let st=["","","",""];st[0]=(D==="border_top"||D==="border_outer")&&Oe===xe||(D==="border_inner"||D==="border_horizontal")&&Oe>xe||D==="border_all"?"border-top: "+k+"px "+ne+" "+z:"border-top: ",st[1]=D!=="border_all"&&D!=="border_right"&&D!=="border_outer"||_e!==de?"border-right: ":"border-right: "+k+"px "+ne+" "+z,st[2]=D!=="border_all"&&D!=="border_bottom"&&D!=="border_outer"||Oe!==Se?"border-bottom: ":"border-bottom: "+k+"px "+ne+" "+z,st[3]=(D==="border_left"||D==="border_outer")&&_e===ve||(D==="border_inner"||D==="border_vertical")&&_e>ve||D==="border_all"?"border-left: "+k+"px "+ne+" "+z:"border-left: ",Z[Pe]=st.join(";")};for(let Pe=G[1];Pe<=G[3];Pe++)for(let _e=G[0];_e<=G[2];_e++)Me((0,n.getCellNameFromCoords)(_e,Pe),_e,Pe),N.records[Pe][_e].element.getAttribute("data-merged")&&Me((0,n.getCellNameFromCoords)(G[0],G[1]),_e,Pe);Object.keys(Z)&&N.setStyle(Z)}},onload:function(_,T){let R=document.createElement("div"),O=document.createElement("div");R.appendChild(O);let N=jSuites.color(O,{closeOnChange:!1,onchange:function(k,z){k.parentNode.children[1].style.color=z,T.color=z}}),G=document.createElement("i");G.classList.add("material-icons"),G.innerHTML="color_lens",G.onclick=function(){N.open()},R.appendChild(G),_.children[1].appendChild(R),O=document.createElement("div"),jSuites.picker(O,{type:"select",data:[1,2,3,4,5],render:function(k){return'<div style="height: '+k+'px; width: 30px; background-color: black;"></div>'},onchange:function(k,z,ne,Z){T.thickness=Z},width:"50px"}),_.children[1].appendChild(O);const D=document.createElement("div");jSuites.picker(D,{type:"select",data:["solid","dotted","dashed","double"],render:function(k){return k==="double"?'<div style="width: 30px; border-top: 3px '+k+' black;"></div>':'<div style="width: 30px; border-top: 2px '+k+' black;"></div>'},onchange:function(k,z,ne,Z){T.style=Z},width:"50px"}),_.children[1].appendChild(D),O=document.createElement("div"),O.style.flex="1",_.children[1].appendChild(O)},updateState:function(_,T,R){o(R,E())}}),C.push({type:"divisor"}),C.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(_,T,R){R.children[0].textContent==="fullscreen"?(m.fullscreen(!0),R.children[0].textContent="fullscreen_exit"):(m.fullscreen(!1),R.children[0].textContent="fullscreen")},updateState:function(_,T,R,O){O.parent.config.fullscreen===!0?R.children[0].textContent="fullscreen_exit":R.children[0].textContent="fullscreen"}}),C},l=function(C){const m=this,E=C.items;for(let v=0;v<E.length;v++)E[v].tooltip&&(E[v].title=E[v].tooltip,delete E[v].tooltip),E[v].type=="select"?E[v].options?(E[v].data=E[v].options,delete E[v].options):(E[v].data=E[v].v,delete E[v].v,E[v].k&&!E[v].onchange&&(E[v].onchange=function(_,T,R){const O=s.Hf.call(m),N=O.getSelected(!0);O.setStyle(Object.fromEntries(N.map(function(G){return[G,E[v].k+": "+R]})))})):E[v].type=="color"&&(E[v].type="i",E[v].onclick=function(_,T,R){R.color||(jSuites.color(R,{onchange:function(O,N){const G=s.Hf.call(m),D=G.getSelected(!0);G.setStyle(Object.fromEntries(D.map(function(k){return[k,E[v].k+": "+N]})))},onopen:function(O){O.color.select("")}}),R.color.open())})},u=function(C){const m=this,E=document.createElement("div");return E.classList.add("jss_toolbar"),l.call(m,C),typeof m.plugins=="object"&&Object.entries(m.plugins).forEach(function([,v]){if(typeof v.toolbar=="function"){const _=v.toolbar(C);_&&(C=_)}}),jSuites.toolbar(E,C),E},c=function(C){C.parent.toolbar&&C.parent.toolbar.toolbar.update(C)},d=function(){const C=this;if(C.config.toolbar&&!C.toolbar){let m;Array.isArray(C.config.toolbar)?m={items:C.config.toolbar}:typeof C.config.toolbar=="object"?m=C.config.toolbar:(m={items:a.call(C)},typeof C.config.toolbar=="function"&&(m=C.config.toolbar(m))),C.toolbar=C.element.insertBefore(u.call(C,m),C.element.children[1])}},f=function(){const C=this;C.toolbar&&(C.toolbar.parentNode.removeChild(C.toolbar),delete C.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=function(r,e){for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},__webpack_require__.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__={};(function(){__webpack_require__.d(__webpack_exports__,{default:function(){return pt}});var r={jspreadsheet:{}},e=__webpack_require__(100),t=__webpack_require__(992),n=__webpack_require__(923);const s=function(A,K,L){const j=this,Y=A.getAttribute("data-y"),oe=A.getAttribute("data-x");e.Z.call(j,"oneditionstart",j,A,parseInt(oe),parseInt(Y)),oe>0&&(j.records[Y][oe-1].element.style.overflow="hidden");const Te=function(ee){const ye=A.getBoundingClientRect(),H=document.createElement(ee);return H.style.width=ye.width+"px",H.style.height=ye.height-2+"px",H.style.minHeight=ye.height-2+"px",A.classList.add("editor"),A.innerHTML="",A.appendChild(H),H};if(A.classList.contains("readonly")!=1){if(j.edition=[j.records[Y][oe].element,j.records[Y][oe].element.innerHTML,oe,Y],j.options.columns&&j.options.columns[oe]&&typeof j.options.columns[oe].type=="object")j.options.columns[oe].type.openEditor(A,j.options.data[Y][oe],parseInt(oe),parseInt(Y),j,j.options.columns[oe],L),e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]);else if(!(j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].type=="hidden"))if(j.options.columns&&j.options.columns[oe]&&(j.options.columns[oe].type=="checkbox"||j.options.columns[oe].type=="radio")){const ee=!A.children[0].checked;j.setValue(A,ee),j.edition=null}else if(j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].type=="dropdown"){let ee,ye=j.options.data[Y][oe];j.options.columns[oe].multiple&&!Array.isArray(ye)&&(ye=ye.split(";")),ee=typeof j.options.columns[oe].filter=="function"?j.options.columns[oe].filter(j.element,A,oe,Y,j.options.columns[oe].source):j.options.columns[oe].source;const H=[];if(ee)for(let Re=0;Re<ee.length;Re++)H.push(ee[Re]);const Q=Te("div");e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]);const pe={data:H,multiple:!!j.options.columns[oe].multiple,autocomplete:!!j.options.columns[oe].autocomplete,opened:!0,value:ye,width:"100%",height:Q.style.minHeight,position:j.options.tableOverflow==1||j.parent.config.fullscreen==1,onclose:function(){o.call(j,A,!0)}};j.options.columns[oe].options&&j.options.columns[oe].options.type&&(pe.type=j.options.columns[oe].options.type),jSuites.dropdown(Q,pe)}else if(j.options.columns&&j.options.columns[oe]&&(j.options.columns[oe].type=="calendar"||j.options.columns[oe].type=="color")){const ee=j.options.data[Y][oe],ye=Te("input");e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]),ye.value=ee;const H=j.options.columns[oe].options?{...j.options.columns[oe].options}:{};j.options.tableOverflow!=1&&j.parent.config.fullscreen!=1||(H.position=!0),H.value=j.options.data[Y][oe],H.opened=!0,H.onclose=function(Q,pe){o.call(j,A,!0)},j.options.columns[oe].type=="color"?jSuites.color(ye,H):(H.format||(H.format="YYYY-MM-DD"),jSuites.calendar(ye,H)),ye.focus()}else if(j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].type=="html"){const ee=j.options.data[Y][oe],ye=Te("div");e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]),ye.style.position="relative";const H=document.createElement("div");H.classList.add("jss_richtext"),ye.appendChild(H),jSuites.editor(H,{focus:!0,value:ee});const Q=A.getBoundingClientRect(),pe=H.getBoundingClientRect();window.innerHeight<Q.bottom+pe.height?H.style.top=Q.top-(pe.height+2)+"px":H.style.top=Q.top+"px"}else if(j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].type=="image"){const ee=A.children[0],ye=Te("div");e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]),ye.style.position="relative";const H=document.createElement("div");H.classList.add("jclose"),ee&&ee.src&&H.appendChild(ee),ye.appendChild(H),jSuites.image(H,j.options.columns[oe]);const Q=A.getBoundingClientRect(),pe=H.getBoundingClientRect();window.innerHeight<Q.bottom+pe.height?H.style.top=Q.top-(pe.height+2)+"px":H.style.top=Q.top+"px"}else{const ee=K==1?"":j.options.data[Y][oe];let ye;ye=j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].wordWrap==0||!(j.options.wordWrap==1||j.options.columns&&j.options.columns[oe]&&j.options.columns[oe].wordWrap==1)?Te("input"):Te("textarea"),e.Z.call(j,"oncreateeditor",j,A,parseInt(oe),parseInt(Y),null,j.options.columns[oe]),ye.focus(),ye.value=ee;const H=j.options.columns&&j.options.columns[oe];if(!(0,t.jr)(ee)&&H){const Q=(0,t.Vi)(H);if(Q){if(!H.disabledMaskOnEdition)if(H.mask){const pe=H.mask.split(";");ye.setAttribute("data-mask",pe[0])}else H.locale&&ye.setAttribute("data-locale",H.locale);Q.input=ye,ye.mask=Q,jSuites.mask.render(ee,Q,!1)}}ye.onblur=function(){o.call(j,A,!0)},ye.scrollLeft=ye.scrollWidth}}},o=function(A,K){const L=this,j=parseInt(A.getAttribute("data-x")),Y=parseInt(A.getAttribute("data-y"));let oe;if(K==1){if(L.options.columns&&L.options.columns[j]&&typeof L.options.columns[j].type=="object")oe=L.options.columns[j].type.closeEditor(A,K,parseInt(j),parseInt(Y),L,L.options.columns[j]);else if(!(L.options.columns&&L.options.columns[j]&&(L.options.columns[j].type=="checkbox"||L.options.columns[j].type=="radio"||L.options.columns[j].type=="hidden")))if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="dropdown")oe=A.children[0].dropdown.close(!0);else if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="calendar")oe=A.children[0].calendar.close(!0);else if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="color")oe=A.children[0].color.close(!0);else if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="html")oe=A.children[0].children[0].editor.getData();else if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="image"){const Te=A.children[0].children[0].children[0];oe=Te&&Te.tagName=="IMG"?Te.src:""}else if(L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="numeric")oe=A.children[0].value,(""+oe).substr(0,1)!="="&&oe==""&&(oe=L.options.columns[j].allowEmpty?"":0),A.children[0].onblur=null;else{oe=A.children[0].value,A.children[0].onblur=null;const Te=L.options.columns&&L.options.columns[j];if(Te){const ee=(0,t.Vi)(Te);if(ee&&oe!==""&&!(0,t.jr)(oe)&&typeof oe!="number"){const ye=jSuites.mask.extract(oe,ee,!0);ye&&ye.value!==""&&(oe=ye.value)}}}L.options.data[Y][j]==oe?A.innerHTML=L.edition[1]:L.setValue(A,oe)}else L.options.columns&&L.options.columns[j]&&typeof L.options.columns[j].type=="object"?L.options.columns[j].type.closeEditor(A,K,parseInt(j),parseInt(Y),L,L.options.columns[j]):L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="dropdown"?A.children[0].dropdown.close(!0):L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="calendar"?A.children[0].calendar.close(!0):L.options.columns&&L.options.columns[j]&&L.options.columns[j].type=="color"?A.children[0].color.close(!0):A.children[0].onblur=null,A.innerHTML=L.edition&&L.edition[1]?L.edition[1]:"";e.Z.call(L,"oneditionend",L,A,j,Y,oe,K),A.classList.remove("editor"),L.edition=null},a=function(){const A=this,K=[],L=Object.keys(A.highlighted);for(let j=0;j<L.length;j++){const Y=A.highlighted[j].element.getAttribute("data-x"),oe=A.highlighted[j].element.getAttribute("data-y");A.options.columns[Y].type!="checkbox"&&A.options.columns[Y].type!="radio"||K.push(t.wW.call(A,Y,oe,!A.options.data[oe][Y]))}if(K.length){n.JB.call(A,{action:"setValue",records:K,selection:A.selectedCell});const j=K.map(function(Y){return{x:Y.x,y:Y.y,value:Y.newValue,oldValue:Y.oldValue}});e.Z.call(A,"onafterchanges",A,j)}};var l=__webpack_require__(665);const u=function(A,K){const L=this;A=parseInt(A);for(let j=(K=parseInt(K))-1;j>=0;j--)if(L.records[j][A].element.style.display!="none"&&L.rows[j].element.style.display!="none"){if(L.records[j][A].element.getAttribute("data-merged")&&L.records[j][A].element==L.records[K][A].element)continue;K=j;break}return K},c=function(A,K){const L=this;let j,Y;if(A==0?(j=parseInt(L.selectedCell[0]),Y=parseInt(L.selectedCell[1])):(j=parseInt(L.selectedCell[2]),Y=parseInt(L.selectedCell[3])),K==0){for(let oe=0;oe<Y;oe++)if(L.records[oe][j].element.style.display!="none"&&L.rows[oe].element.style.display!="none"){Y=oe;break}}else Y=u.call(L,j,Y);A==0?(L.selectedCell[0]=j,L.selectedCell[1]=Y):(L.selectedCell[2]=j,L.selectedCell[3]=Y)},d=function(A,K){const L=this;if(A?L.selectedCell[3]>0&&c.call(L,1,K?0:1):(L.selectedCell[1]>0&&c.call(L,0,K?0:1),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),L.options.lazyLoading==1)if(L.selectedCell[1]==0||L.selectedCell[3]==0)l.ij.call(L,0),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]);else if(l.iw.call(L))L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]);else{const j=parseInt(L.tbody.firstChild.getAttribute("data-y"));L.selectedCell[1]-j<30&&(l.Kw.call(L),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]))}else if(L.options.pagination>0){const j=L.whichPage(L.selectedCell[3]);j!=L.pageNumber&&L.page(j)}t.Of.call(L,1)},f=function(A,K){const L=this;A=parseInt(A),K=parseInt(K);for(let j=A+1;j<L.headers.length;j++)if(L.records[K][j].element.style.display!="none"){if(L.records[K][j].element.getAttribute("data-merged")&&L.records[K][j].element==L.records[K][A].element)continue;A=j;break}return A},C=function(A,K){const L=this;let j,Y;if(A==0?(j=parseInt(L.selectedCell[0]),Y=parseInt(L.selectedCell[1])):(j=parseInt(L.selectedCell[2]),Y=parseInt(L.selectedCell[3])),K==0){for(let oe=L.headers.length-1;oe>j;oe--)if(L.records[Y][oe].element.style.display!="none"){j=oe;break}}else j=f.call(L,j,Y);A==0?(L.selectedCell[0]=j,L.selectedCell[1]=Y):(L.selectedCell[2]=j,L.selectedCell[3]=Y)},m=function(A,K){const L=this;A?L.selectedCell[2]<L.headers.length-1&&C.call(L,1,K?0:1):(L.selectedCell[0]<L.headers.length-1&&C.call(L,0,K?0:1),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),t.Of.call(L,2)},E=function(A,K){const L=this;A=parseInt(A);for(let j=(K=parseInt(K))+1;j<L.rows.length;j++)if(L.records[j][A].element.style.display!="none"&&L.rows[j].element.style.display!="none"){if(L.records[j][A].element.getAttribute("data-merged")&&L.records[j][A].element==L.records[K][A].element)continue;K=j;break}return K},v=function(A,K){const L=this;let j,Y;if(A==0?(j=parseInt(L.selectedCell[0]),Y=parseInt(L.selectedCell[1])):(j=parseInt(L.selectedCell[2]),Y=parseInt(L.selectedCell[3])),K==0){for(let oe=L.rows.length-1;oe>Y;oe--)if(L.records[oe][j].element.style.display!="none"&&L.rows[oe].element.style.display!="none"){Y=oe;break}}else Y=E.call(L,j,Y);A==0?(L.selectedCell[0]=j,L.selectedCell[1]=Y):(L.selectedCell[2]=j,L.selectedCell[3]=Y)},_=function(A,K){const L=this;if(A?L.selectedCell[3]<L.records.length-1&&v.call(L,1,K?0:1):(L.selectedCell[1]<L.records.length-1&&v.call(L,0,K?0:1),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),L.options.lazyLoading==1)L.selectedCell[1]==L.records.length-1||L.selectedCell[3]==L.records.length-1?(l.ij.call(L,-1),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3])):l.iw.call(L)?L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]):parseInt(L.tbody.lastChild.getAttribute("data-y"))-L.selectedCell[3]<30&&(l.VG.call(L),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]));else if(L.options.pagination>0){const j=L.whichPage(L.selectedCell[3]);j!=L.pageNumber&&L.page(j)}t.Of.call(L,3)},T=function(A,K){const L=this;A=parseInt(A),K=parseInt(K);for(let j=A-1;j>=0;j--)if(L.records[K][j].element.style.display!="none"){if(L.records[K][j].element.getAttribute("data-merged")&&L.records[K][j].element==L.records[K][A].element)continue;A=j;break}return A},R=function(A,K){const L=this;let j,Y;if(A==0?(j=parseInt(L.selectedCell[0]),Y=parseInt(L.selectedCell[1])):(j=parseInt(L.selectedCell[2]),Y=parseInt(L.selectedCell[3])),K==0){for(let oe=0;oe<j;oe++)if(L.records[Y][oe].element.style.display!="none"){j=oe;break}}else j=T.call(L,j,Y);A==0?(L.selectedCell[0]=j,L.selectedCell[1]=Y):(L.selectedCell[2]=j,L.selectedCell[3]=Y)},O=function(A,K){const L=this;A?L.selectedCell[2]>0&&R.call(L,1,K?0:1):(L.selectedCell[0]>0&&R.call(L,0,K?0:1),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),t.Of.call(L,0)},N=function(A,K){const L=this;if(A?K?L.selectedCell[3]=0:R.call(L,1,0):(K?L.selectedCell[1]=0:R.call(L,0,0),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.options.lazyLoading!=1||L.selectedCell[1]!=0&&L.selectedCell[3]!=0){if(L.options.pagination>0){const j=L.whichPage(L.selectedCell[3]);j!=L.pageNumber&&L.page(j)}}else l.ij.call(L,0);L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),t.Of.call(L,1)},G=function(A,K){const L=this;if(A?K?L.selectedCell[3]=L.records.length-1:C.call(L,1,0):(K?L.selectedCell[1]=L.records.length-1:C.call(L,0,0),L.selectedCell[2]=L.selectedCell[0],L.selectedCell[3]=L.selectedCell[1]),L.options.lazyLoading!=1||L.selectedCell[1]!=L.records.length-1&&L.selectedCell[3]!=L.records.length-1){if(L.options.pagination>0){const j=L.whichPage(L.selectedCell[3]);j!=L.pageNumber&&L.page(j)}}else l.ij.call(L,-1);L.updateSelectionFromCoords(L.selectedCell[0],L.selectedCell[1],L.selectedCell[2],L.selectedCell[3]),t.Of.call(L,3)};var D=__webpack_require__(49),k=__webpack_require__(366),z=__webpack_require__(650),ne=__webpack_require__(323);const Z=function(A,K,L,j,Y,oe,Te){const ee=this;K||(K="	");const ye=new RegExp(K,"ig"),H=[];let Q=[],pe=[];const Re=[],Ce=[],We=ee.options.data[0].length,ot=ee.options.data.length;let mt="",Ye=!1,Et="",vt="",xt=0,He=0,ft=0;for(let gt=0;gt<ot;gt++)for(let De=0;De<We;De++)A&&!ee.records[gt][De].element.classList.contains("highlight")||ft<=gt&&(ft=gt);if(Y&&(ee.parent.config.includeHeadersOnDownload==1||j)){if(ee.options.nestedHeaders&&ee.options.nestedHeaders.length>0){mt=ee.options.nestedHeaders;for(let gt=0;gt<mt.length;gt++){const De=[];for(let ht=0;ht<mt[gt].length;ht++){const Rt=parseInt(mt[gt][ht].colspan);De.push(mt[gt][ht].title);for(let Pt=0;Pt<Rt-1;Pt++)De.push("")}vt+=De.join(K)+`\r
`}}Ye=!0}ee.style=[];for(let gt=0;gt<ot;gt++){Q=[],pe=[];for(let De=0;De<We;De++)if(!A||ee.records[gt][De].element.classList.contains("highlight")){Ye==1&&H.push(ee.headers[De].textContent);let ht,Rt=ee.options.data[gt][De];Rt.match&&(Rt.match(ye)||Rt.match(/,/g)||Rt.match(/\n/)||Rt.match(/\"/))&&(Rt=Rt.replace(new RegExp('"',"g"),'""'),Rt='"'+Rt+'"'),Q.push(Rt),ee.options.columns&&ee.options.columns[De]&&(ee.options.columns[De].type=="checkbox"||ee.options.columns[De].type=="radio")?ht=Rt:(ht=ee.records[gt][De].element.innerHTML,ht.match&&(ht.match(ye)||ht.match(/,/g)||ht.match(/\n/)||ht.match(/\"/))&&(ht=ht.replace(new RegExp('"',"g"),'""'),ht='"'+ht+'"')),pe.push(ht),mt=ee.records[gt][De].element.getAttribute("style"),mt=mt.replace("display: none;",""),ee.style.push(mt||"")}Q.length&&(Ye&&(xt=Q.length,Re.push(H.join(K))),Re.push(Q.join(K))),pe.length&&(He++,Ye&&(Ce.push(H.join(K)),Ye=!1),Ce.push(pe.join(K)))}We==xt&&ot==He&&(Et=vt);const yt=Et+Re.join(`\r
`);let It=Et+Ce.join(`\r
`);if(!L){const gt=[Math.min(ee.selectedCell[0],ee.selectedCell[2]),Math.min(ee.selectedCell[1],ee.selectedCell[3]),Math.max(ee.selectedCell[0],ee.selectedCell[2]),Math.max(ee.selectedCell[1],ee.selectedCell[3])],De=e.Z.call(ee,"oncopy",ee,gt,It,oe);if(De)It=De;else if(De===!1)return!1;ee.textarea.value=It,ee.textarea.select(),document.execCommand("copy")}if(ee.data=Te==1?It:yt,ee.hashString=k.vp.call(ee,ee.data),!L&&(k.vn.call(ee),ee.highlighted))for(let gt=0;gt<ee.highlighted.length;gt++)ee.highlighted[gt].element.classList.add("copying"),ee.highlighted[gt].element.classList.contains("highlight-left")&&ee.highlighted[gt].element.classList.add("copying-left"),ee.highlighted[gt].element.classList.contains("highlight-right")&&ee.highlighted[gt].element.classList.add("copying-right"),ee.highlighted[gt].element.classList.contains("highlight-top")&&ee.highlighted[gt].element.classList.add("copying-top"),ee.highlighted[gt].element.classList.contains("highlight-bottom")&&ee.highlighted[gt].element.classList.add("copying-bottom");return ee.data},ve=function(A,K,L){const j=this,Y=(0,k.vp)(L),oe=Y==j.hashString?j.style:null;Y==j.hashString&&(L=j.data),L=(0,z.parseCSV)(L,"	");const Te=e.Z.call(j,"onbeforepaste",j,L.map(function(ee){return ee.map(function(ye){return{value:ye}})}),A,K);if(Te===!1)return!1;if(Te&&(L=Te),A!=null&&K!=null&&L){let ee=0,ye=0;const H=[],Q={},pe={};let Re=0,Ce=parseInt(A),We=parseInt(K),ot=null;for(;ot=L[ye];){for(ee=0,Ce=parseInt(A);ot[ee]!=null;){const Et=t.wW.call(j,Ce,We,ot[ee]);if(H.push(Et),t.Zz.call(j,Ce,We,H),oe&&oe[Re]){const vt=(0,ne.Ar)([Ce,We]);Q[vt]=oe[Re],pe[vt]=j.getStyle(vt),j.records[We][Ce].element.setAttribute("style",oe[Re]),Re++}if(ee++,ot[ee]!=null){if(Ce>=j.headers.length-1){if(j.options.allowInsertColumn==0)break;j.insertColumn()}Ce=f.call(j,Ce,We)}}if(ye++,L[ye]){if(We>=j.rows.length-1){if(j.options.allowInsertRow==0)break;j.insertRow()}We=E.call(j,A,We)}}k.Es.call(j,A,K,Ce,We),n.JB.call(j,{action:"setValue",records:H,selection:j.selectedCell,newStyle:Q,oldStyle:pe}),t.T0.call(j);const mt=[];for(let Et=0;Et<L.length;Et++)for(let vt=0;vt<L[Et].length;vt++)mt.push({x:vt+A,y:Et+K,value:L[Et][vt]});e.Z.call(j,"onpaste",j,mt);const Ye=H.map(function(Et){return{x:Et.x,y:Et.y,value:Et.newValue,oldValue:Et.oldValue}});e.Z.call(j,"onafterchanges",j,Ye)}(0,k.vn)()};var xe=__webpack_require__(456),de=__webpack_require__(427);const Se=function(){const A=this;let K=A.options.columns&&A.options.columns.length||0;if(A.options.data&&A.options.data[0]!==void 0){const L=Object.keys(A.options.data[0]);L.length>K&&(K=L.length)}return A.options.minDimensions&&A.options.minDimensions[0]>K&&(K=A.options.minDimensions[0]),K},Me=function(A){const K=this,L=K.options.columns&&K.options.columns[A]&&K.options.columns[A].width||K.options.defaultColWidth||100,j=K.options.columns&&K.options.columns[A]&&K.options.columns[A].align||K.options.defaultColAlign||"center";K.headers[A]=document.createElement("td"),K.headers[A].textContent=K.options.columns&&K.options.columns[A]&&K.options.columns[A].title||(0,z.getColumnName)(A),K.headers[A].setAttribute("data-x",A),K.headers[A].style.textAlign=j,K.options.columns&&K.options.columns[A]&&K.options.columns[A].title&&K.headers[A].setAttribute("title",K.headers[A].innerText),K.options.columns&&K.options.columns[A]&&K.options.columns[A].id&&K.headers[A].setAttribute("id",K.options.columns[A].id);const Y=document.createElement("col");Y.setAttribute("width",L),K.cols[A]={colElement:Y,x:A},K.options.columns&&K.options.columns[A]&&K.options.columns[A].type=="hidden"&&(K.headers[A].style.display="none",Y.style.display="none")},Pe=function(A,K,L){const j=this;if(K){if(Array.isArray(A)){L||(L=[]);for(let Y=0;Y<A.length;Y++){L[Y]||(L[Y]=parseInt(j.cols[A[Y]].colElement.getAttribute("width")));const oe=Array.isArray(K)&&K[Y]?K[Y]:K;j.cols[A[Y]].colElement.setAttribute("width",oe),j.options.columns||(j.options.columns=[]),j.options.columns[A[Y]]||(j.options.columns[A[Y]]={}),j.options.columns[A[Y]].width=oe}}else L||(L=parseInt(j.cols[A].colElement.getAttribute("width"))),j.cols[A].colElement.setAttribute("width",K),j.options.columns||(j.options.columns=[]),j.options.columns[A]||(j.options.columns[A]={}),j.options.columns[A].width=K;n.JB.call(j,{action:"setWidth",column:A,oldValue:L,newValue:K}),e.Z.call(j,"onresizecolumn",j,A,K,L),k.x8.call(j)}},_e=function(A,K){const L=this;L.records[A]||(L.records[A]=[]),K||(K=L.options.data[A]);const j={element:document.createElement("tr"),y:A};L.rows[A]=j,j.element.setAttribute("data-y",A);let Y=null;L.options.defaultRowHeight&&(j.element.style.height=L.options.defaultRowHeight+"px"),L.options.rows&&L.options.rows[A]&&(L.options.rows[A].height&&(j.element.style.height=L.options.rows[A].height),L.options.rows[A].title&&(Y=L.options.rows[A].title)),Y||(Y=parseInt(A+1));const oe=document.createElement("td");oe.innerHTML=Y,oe.setAttribute("data-y",A),oe.className="jss_row",j.element.appendChild(oe);const Te=Se.call(L);for(let ee=0;ee<Te;ee++)L.records[A][ee]={element:t.kE.call(this,ee,A,K[ee]),x:ee,y:A},j.element.appendChild(L.records[A][ee].element),L.options.columns&&L.options.columns[ee]&&typeof L.options.columns[ee].render=="function"&&L.options.columns[ee].render(L.records[A][ee].element,K[ee],parseInt(ee),parseInt(A),L,L.options.columns[ee]);return j},Oe=function(A,K,L){const j=this;if(j.options.mergeCells&&Object.keys(j.options.mergeCells).length>0){let Te;if(Te=A>K?1:0,D.q4.call(j,A).length||D.q4.call(j,K,Te).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;j.destroyMerge()}}if(j.options.search==1){if(j.results&&j.results.length!=j.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;j.resetSearch()}j.results=null}L||(Array.prototype.indexOf.call(j.tbody.children,j.rows[K].element)>=0?A>K?j.tbody.insertBefore(j.rows[A].element,j.rows[K].element):j.tbody.insertBefore(j.rows[A].element,j.rows[K].element.nextSibling):j.tbody.removeChild(j.rows[A].element)),j.rows.splice(K,0,j.rows.splice(A,1)[0]),j.records.splice(K,0,j.records.splice(A,1)[0]),j.options.data.splice(K,0,j.options.data.splice(A,1)[0]);const Y=Math.min(A,K),oe=Math.max(A,K);for(let Te=Y;Te<=oe;Te++)j.rows[Te].y=Te;for(let Te=Y;Te<=oe;Te++)for(let ee=0;ee<j.records[Te].length;ee++)j.records[Te][ee].y=Te;j.options.pagination>0&&j.tbody.children.length!=j.options.pagination&&j.page(j.pageNumber),n.JB.call(j,{action:"moveRow",oldValue:A,newValue:K}),t.ec.call(j),e.Z.call(j,"onmoverow",j,parseInt(A),parseInt(K),1)},st=function(A,K,L){const j=this;K>0&&(L||(L=j.rows[A].element.getAttribute("height"))||(L=j.rows[A].element.getBoundingClientRect().height),K=parseInt(K),j.rows[A].element.style.height=K+"px",j.options.rows||(j.options.rows=[]),j.options.rows[A]||(j.options.rows[A]={}),j.options.rows[A].height=K,n.JB.call(j,{action:"setHeight",row:A,oldValue:L,newValue:K}),e.Z.call(j,"onresizerow",j,A,K,L),k.x8.call(j))};var rt={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const U=function(A){let K=0,L=0;return function j(Y){Y.className&&(Y.classList.contains("jss_container")&&(L=Y),Y.classList.contains("jss_spreadsheet")&&(L=Y.querySelector(":scope > .jtabs-content > .jtabs-selected"))),Y.tagName=="THEAD"?K=1:Y.tagName=="TBODY"&&(K=2),Y.parentNode&&(L||j(Y.parentNode))}(A),[L,K]},te=function(A){if(r.jspreadsheet.current)if(r.jspreadsheet.current.resizing){if(r.jspreadsheet.current.resizing.column){const K=parseInt(r.jspreadsheet.current.cols[r.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),L=r.jspreadsheet.current.getSelectedColumns();if(L.length>1){const j=[];for(let Y=0;Y<L.length;Y++)j.push(parseInt(r.jspreadsheet.current.cols[L[Y]].colElement.getAttribute("width")));j[L.indexOf(parseInt(r.jspreadsheet.current.resizing.column))]=r.jspreadsheet.current.resizing.width,Pe.call(r.jspreadsheet.current,L,K,j)}else Pe.call(r.jspreadsheet.current,parseInt(r.jspreadsheet.current.resizing.column),K,r.jspreadsheet.current.resizing.width);r.jspreadsheet.current.headers[r.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let j=0;j<r.jspreadsheet.current.records.length;j++)r.jspreadsheet.current.records[j][r.jspreadsheet.current.resizing.column]&&r.jspreadsheet.current.records[j][r.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let K=r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.getAttribute("height");st.call(r.jspreadsheet.current,r.jspreadsheet.current.resizing.row,K,r.jspreadsheet.current.resizing.height),r.jspreadsheet.current.resizing.element.classList.remove("resizing")}r.jspreadsheet.current.resizing=null}else if(r.jspreadsheet.current.dragging){if(r.jspreadsheet.current.dragging){if(r.jspreadsheet.current.dragging.column){const K=A.target.getAttribute("data-x");r.jspreadsheet.current.headers[r.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let L=0;L<r.jspreadsheet.current.rows.length;L++)r.jspreadsheet.current.records[L][r.jspreadsheet.current.dragging.column]&&r.jspreadsheet.current.records[L][r.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let L=0;L<r.jspreadsheet.current.headers.length;L++)r.jspreadsheet.current.headers[L].classList.remove("dragging-left"),r.jspreadsheet.current.headers[L].classList.remove("dragging-right");K&&r.jspreadsheet.current.dragging.column!=r.jspreadsheet.current.dragging.destination&&r.jspreadsheet.current.moveColumn(r.jspreadsheet.current.dragging.column,r.jspreadsheet.current.dragging.destination)}else{let K;r.jspreadsheet.current.dragging.element.nextSibling?(K=parseInt(r.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),r.jspreadsheet.current.dragging.row<K&&(K-=1)):K=parseInt(r.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),r.jspreadsheet.current.dragging.row!=r.jspreadsheet.current.dragging.destination&&Oe.call(r.jspreadsheet.current,r.jspreadsheet.current.dragging.row,K,!0),r.jspreadsheet.current.dragging.element.classList.remove("dragging")}r.jspreadsheet.current.dragging=null}}else r.jspreadsheet.current.selectedCorner&&(r.jspreadsheet.current.selectedCorner=!1,r.jspreadsheet.current.selection.length>0&&(k.F1.call(r.jspreadsheet.current,r.jspreadsheet.current.selection[0],r.jspreadsheet.current.selection[r.jspreadsheet.current.selection.length-1]),k.Mt.call(r.jspreadsheet.current)));r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null),r.jspreadsheet.isMouseAction=!1},V=function(A){let K;K=(A=A||window.event).buttons?A.buttons:A.button?A.button:A.which;const L=U(A.target);if(L[0]?r.jspreadsheet.current!=L[0].jssWorksheet&&(r.jspreadsheet.current&&(r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0),r.jspreadsheet.current.resetSelection()),r.jspreadsheet.current=L[0].jssWorksheet):r.jspreadsheet.current&&(r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0),A.target.classList.contains("jss_object")||(k.yE.call(r.jspreadsheet.current,!0),r.jspreadsheet.current=null)),r.jspreadsheet.current&&K==1){if(A.target.classList.contains("jss_selectall"))r.jspreadsheet.current&&k.td.call(r.jspreadsheet.current);else if(A.target.classList.contains("jss_corner"))r.jspreadsheet.current.options.editable!=0&&(r.jspreadsheet.current.selectedCorner=!0);else{if(L[1]==1){const j=A.target.getAttribute("data-x");if(j){const Y=A.target.getBoundingClientRect();if(r.jspreadsheet.current.options.columnResize!=0&&Y.width-A.offsetX<6){r.jspreadsheet.current.resizing={mousePosition:A.pageX,column:j,width:Y.width},r.jspreadsheet.current.headers[j].classList.add("resizing");for(let oe=0;oe<r.jspreadsheet.current.records.length;oe++)r.jspreadsheet.current.records[oe][j]&&r.jspreadsheet.current.records[oe][j].element.classList.add("resizing")}else if(r.jspreadsheet.current.options.columnDrag!=0&&Y.height-A.offsetY<6)if(D.D0.call(r.jspreadsheet.current,j).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current.dragging={element:A.target,column:j,destination:j},r.jspreadsheet.current.headers[j].classList.add("dragging");for(let oe=0;oe<r.jspreadsheet.current.records.length;oe++)r.jspreadsheet.current.records[oe][j]&&r.jspreadsheet.current.records[oe][j].element.classList.add("dragging")}else{let oe,Te;r.jspreadsheet.current.selectedHeader&&(A.shiftKey||A.ctrlKey)?(oe=r.jspreadsheet.current.selectedHeader,Te=j):(r.jspreadsheet.current.selectedHeader==j&&r.jspreadsheet.current.options.allowRenameColumn!=0&&(r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.setHeader(j)},800)),r.jspreadsheet.current.selectedHeader=j,oe=j,Te=j),k.Es.call(r.jspreadsheet.current,oe,0,Te,r.jspreadsheet.current.options.data.length-1,A)}}else if(A.target.parentNode.classList.contains("jss_nested")){let Y,oe;if(A.target.getAttribute("data-column")){const Te=A.target.getAttribute("data-column").split(",");Y=parseInt(Te[0]),oe=parseInt(Te[Te.length-1])}else Y=0,oe=r.jspreadsheet.current.options.columns.length-1;k.Es.call(r.jspreadsheet.current,Y,0,oe,r.jspreadsheet.current.options.data.length-1,A)}}else r.jspreadsheet.current.selectedHeader=!1;if(L[1]==2){const j=parseInt(A.target.getAttribute("data-y"));if(A.target.classList.contains("jss_row")){const Y=A.target.getBoundingClientRect();if(r.jspreadsheet.current.options.rowResize!=0&&Y.height-A.offsetY<6)r.jspreadsheet.current.resizing={element:A.target.parentNode,mousePosition:A.pageY,row:j,height:Y.height},A.target.parentNode.classList.add("resizing");else if(r.jspreadsheet.current.options.rowDrag!=0&&Y.width-A.offsetX<6)D.q4.call(r.jspreadsheet.current,j).length?console.error("Jspreadsheet: This row is part of a merged cell"):r.jspreadsheet.current.options.search==1&&r.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current.dragging={element:A.target.parentNode,row:j,destination:j},A.target.parentNode.classList.add("dragging"));else{let oe,Te;r.jspreadsheet.current.selectedRow&&(A.shiftKey||A.ctrlKey)?(oe=r.jspreadsheet.current.selectedRow,Te=j):(r.jspreadsheet.current.selectedRow=j,oe=j,Te=j),k.Es.call(r.jspreadsheet.current,null,oe,null,Te,A)}}else if(A.target.classList.contains("jclose")&&A.target.clientWidth-A.offsetX<50&&A.offsetY<50)o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0);else{const Y=function(Te){const ee=Te.getAttribute("data-x"),ye=Te.getAttribute("data-y");return ee&&ye?[ee,ye]:Te.parentNode?Y(Te.parentNode):void 0},oe=Y(A.target);if(oe){const Te=oe[0],ee=oe[1];r.jspreadsheet.current.edition&&(r.jspreadsheet.current.edition[2]==Te&&r.jspreadsheet.current.edition[3]==ee||o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0)),r.jspreadsheet.current.edition||(A.shiftKey?k.Es.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],Te,ee,A):k.Es.call(r.jspreadsheet.current,Te,ee,void 0,void 0,A)),r.jspreadsheet.current.selectedHeader=null,r.jspreadsheet.current.selectedRow=null}}}else r.jspreadsheet.current.selectedRow=!1;A.target.classList.contains("jss_page")&&(A.target.textContent=="<"?r.jspreadsheet.current.page(0):A.target.textContent==">"?r.jspreadsheet.current.page(A.target.getAttribute("title")-1):r.jspreadsheet.current.page(A.target.textContent-1))}r.jspreadsheet.current.edition?r.jspreadsheet.isMouseAction=!1:r.jspreadsheet.isMouseAction=!0}else r.jspreadsheet.isMouseAction=!1},ue=function(A){let K;if(K=(A=A||window.event).buttons?A.buttons:A.button?A.button:A.which,K||(r.jspreadsheet.isMouseAction=!1),r.jspreadsheet.current)if(r.jspreadsheet.isMouseAction==1){if(r.jspreadsheet.current.resizing)if(r.jspreadsheet.current.resizing.column){const L=A.pageX-r.jspreadsheet.current.resizing.mousePosition;if(r.jspreadsheet.current.resizing.width+L>0){const j=r.jspreadsheet.current.resizing.width+L;r.jspreadsheet.current.cols[r.jspreadsheet.current.resizing.column].colElement.setAttribute("width",j),k.x8.call(r.jspreadsheet.current)}}else{const L=A.pageY-r.jspreadsheet.current.resizing.mousePosition;if(r.jspreadsheet.current.resizing.height+L>0){const j=r.jspreadsheet.current.resizing.height+L;r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.setAttribute("height",j),k.x8.call(r.jspreadsheet.current)}}else if(r.jspreadsheet.current.dragging)if(r.jspreadsheet.current.dragging.column){const L=A.target.getAttribute("data-x");if(L)if(D.D0.call(r.jspreadsheet.current,L).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let j=0;j<r.jspreadsheet.current.headers.length;j++)r.jspreadsheet.current.headers[j].classList.remove("dragging-left"),r.jspreadsheet.current.headers[j].classList.remove("dragging-right");r.jspreadsheet.current.dragging.column==L?r.jspreadsheet.current.dragging.destination=parseInt(L):A.target.clientWidth/2>A.offsetX?(r.jspreadsheet.current.dragging.column<L?r.jspreadsheet.current.dragging.destination=parseInt(L)-1:r.jspreadsheet.current.dragging.destination=parseInt(L),r.jspreadsheet.current.headers[L].classList.add("dragging-left")):(r.jspreadsheet.current.dragging.column<L?r.jspreadsheet.current.dragging.destination=parseInt(L):r.jspreadsheet.current.dragging.destination=parseInt(L)+1,r.jspreadsheet.current.headers[L].classList.add("dragging-right"))}}else{const L=A.target.getAttribute("data-y");if(L)if(D.q4.call(r.jspreadsheet.current,L).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const j=A.target.clientHeight/2>A.offsetY?A.target.parentNode.nextSibling:A.target.parentNode;r.jspreadsheet.current.dragging.element!=j&&(A.target.parentNode.parentNode.insertBefore(r.jspreadsheet.current.dragging.element,j),r.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(r.jspreadsheet.current.dragging.element.parentNode.children,r.jspreadsheet.current.dragging.element))}}}else{const L=A.target.getAttribute("data-x"),j=A.target.getAttribute("data-y"),Y=A.target.getBoundingClientRect();r.jspreadsheet.current.cursor&&(r.jspreadsheet.current.cursor.style.cursor="",r.jspreadsheet.current.cursor=null),A.target.parentNode.parentNode&&A.target.parentNode.parentNode.className&&(A.target.parentNode.parentNode.classList.contains("resizable")&&(A.target&&L&&!j&&Y.width-(A.clientX-Y.left)<6?(r.jspreadsheet.current.cursor=A.target,r.jspreadsheet.current.cursor.style.cursor="col-resize"):A.target&&!L&&j&&Y.height-(A.clientY-Y.top)<6&&(r.jspreadsheet.current.cursor=A.target,r.jspreadsheet.current.cursor.style.cursor="row-resize")),A.target.parentNode.parentNode.classList.contains("draggable")&&(A.target&&!L&&j&&Y.width-(A.clientX-Y.left)<6||A.target&&L&&!j&&Y.height-(A.clientY-Y.top)<6)&&(r.jspreadsheet.current.cursor=A.target,r.jspreadsheet.current.cursor.style.cursor="move"))}},Ne=function(A,K){const L=this;k.Mt.call(L);const j=L.selectedContainer[0],Y=L.selectedContainer[1],oe=L.selectedContainer[2],Te=L.selectedContainer[3];if(A!=null&&K!=null){let ee,ye,H,Q;A-oe>0?(ee=parseInt(oe)+1,ye=parseInt(A)):(ee=parseInt(A),ye=parseInt(j)-1),K-Te>0?(H=parseInt(Te)+1,Q=parseInt(K)):(H=parseInt(K),Q=parseInt(Y)-1),ye-ee<=Q-H?(ee=parseInt(j),ye=parseInt(oe)):(H=parseInt(Y),Q=parseInt(Te));for(let pe=H;pe<=Q;pe++)for(let Re=ee;Re<=ye;Re++)L.records[pe][Re]&&L.rows[pe].element.style.display!="none"&&L.records[pe][Re].element.style.display!="none"&&(L.records[pe][Re].element.classList.add("selection"),L.records[H][Re].element.classList.add("selection-top"),L.records[Q][Re].element.classList.add("selection-bottom"),L.records[pe][ee].element.classList.add("selection-left"),L.records[pe][ye].element.classList.add("selection-right"),L.selection.push(L.records[pe][Re].element))}},Ge=function(A){let K;if(K=(A=A||window.event).buttons?A.buttons:A.button?A.button:A.which,K||(r.jspreadsheet.isMouseAction=!1),r.jspreadsheet.current&&r.jspreadsheet.isMouseAction==1){const L=U(A.target);if(L[0]){if(r.jspreadsheet.current!=L[0].jssWorksheet&&r.jspreadsheet.current)return!1;let j=A.target.getAttribute("data-x");const Y=A.target.getAttribute("data-y");if(!(r.jspreadsheet.current.resizing||r.jspreadsheet.current.dragging)){if(L[1]==1&&r.jspreadsheet.current.selectedHeader){j=A.target.getAttribute("data-x");const oe=r.jspreadsheet.current.selectedHeader,Te=j;k.Es.call(r.jspreadsheet.current,oe,0,Te,r.jspreadsheet.current.options.data.length-1,A)}if(L[1]==2)if(A.target.classList.contains("jss_row")){if(r.jspreadsheet.current.selectedRow){const oe=r.jspreadsheet.current.selectedRow,Te=Y;k.Es.call(r.jspreadsheet.current,0,oe,r.jspreadsheet.current.options.data[0].length-1,Te,A)}}else r.jspreadsheet.current.edition||j&&Y&&(r.jspreadsheet.current.selectedCorner?Ne.call(r.jspreadsheet.current,j,Y):r.jspreadsheet.current.selectedCell&&k.Es.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],j,Y,A))}}}r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null)},Ue=function(A){if(r.jspreadsheet.current)if(A.target.classList.contains("jss_corner")){if(r.jspreadsheet.current.highlighted.length>0){const K=r.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),L=parseInt(r.jspreadsheet.current.highlighted[r.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,j=r.jspreadsheet.current.highlighted[r.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),Y=r.jspreadsheet.current.records.length-1;k.F1.call(r.jspreadsheet.current,r.jspreadsheet.current.records[L][K].element,r.jspreadsheet.current.records[Y][j].element)}}else if(A.target.classList.contains("jss_column_filter")){const K=A.target.getAttribute("data-x");xe.B4.call(r.jspreadsheet.current,K)}else{const K=U(A.target);if(K[1]==1&&r.jspreadsheet.current.options.columnSorting!=0){const L=A.target.getAttribute("data-x");L&&r.jspreadsheet.current.orderBy(parseInt(L))}if(K[1]==2&&r.jspreadsheet.current.options.editable!=0&&!r.jspreadsheet.current.edition){const L=function(Y){if(Y.parentNode){const oe=Y.getAttribute("data-x"),Te=Y.getAttribute("data-y");return oe&&Te?Y:L(Y.parentNode)}},j=L(A.target);j&&j.classList.contains("highlight")&&s.call(r.jspreadsheet.current,j,void 0,A)}}},Ie=function(A){r.jspreadsheet.current&&r.jspreadsheet.current.selectedCell&&(r.jspreadsheet.current.edition||r.jspreadsheet.current.options.editable!=0&&(A&&A.clipboardData?(ve.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],A.clipboardData.getData("text")),A.preventDefault()):window.clipboardData&&ve.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},Ke=function(A){const K=A.parentElement.children;for(let L=0;L<K.length;L++)if(A===K[L])return L;return-1},le=function(A){if("buttons"in(A=A||window.event)?A.buttons:A.which||A.button,r.jspreadsheet.current){const K=r.jspreadsheet.current.parent;if(r.jspreadsheet.current.edition)A.preventDefault();else if(K.contextMenu.contextmenu.close(),r.jspreadsheet.current){const L=function(Te){if(Te.classList.contains("jss_selectall"))return"select-all";if(Te.classList.contains("jss_corner"))return"fill-handle";let ee=Te;for(;!ee.classList.contains("jss_spreadsheet");){if(ee.classList.contains("jss_row"))return"row";if(ee.classList.contains("jss_nested"))return"nested";if(ee.classList.contains("jtabs-headers"))return"tabs";if(ee.classList.contains("jtoolbar"))return"toolbar";if(ee.classList.contains("jss_pagination"))return"pagination";if(ee.tagName==="TBODY")return"cell";if(ee.tagName==="TFOOT")return Ke(Te)===0?"grid":"footer";if(ee.tagName==="THEAD")return"header";ee=ee.parentElement}return"applications"}(A.target);let j=null,Y=null;if(L==="cell"||L==="row"||L==="header")L!=="cell"&&L!=="row"||(Y=A.target.getAttribute("data-y")),L!=="cell"&&L!=="header"||(j=A.target.getAttribute("data-x")),(!r.jspreadsheet.current.selectedCell||j<parseInt(r.jspreadsheet.current.selectedCell[0])||j>parseInt(r.jspreadsheet.current.selectedCell[2])||Y<parseInt(r.jspreadsheet.current.selectedCell[1])||Y>parseInt(r.jspreadsheet.current.selectedCell[3]))&&k.Es.call(r.jspreadsheet.current,j,Y,j,Y,A);else if(L==="nested"){const Te=A.target.getAttribute("data-column").split(",");j=Ke(A.target)-1,Y=Ke(A.target.parentElement),r.jspreadsheet.current.selectedCell&&Te[0]==parseInt(r.jspreadsheet.current.selectedCell[0])&&Te[Te.length-1]==parseInt(r.jspreadsheet.current.selectedCell[2])&&r.jspreadsheet.current.selectedCell[1]==null&&r.jspreadsheet.current.selectedCell[3]==null||k.Es.call(r.jspreadsheet.current,Te[0],null,Te[Te.length-1],null,A)}else L==="select-all"?k.td.call(r.jspreadsheet.current):L==="tabs"?j=Ke(A.target):L==="footer"&&(j=Ke(A.target)-1,Y=Ke(A.target.parentElement));let oe=function(Te,ee,ye,H){const Q=[];if(H==="header"&&(Te.options.allowInsertColumn!=0&&Q.push({title:jSuites.translate("Insert a new column before"),onclick:function(){Te.insertColumn(1,parseInt(ee),1)}}),Te.options.allowInsertColumn!=0&&Q.push({title:jSuites.translate("Insert a new column after"),onclick:function(){Te.insertColumn(1,parseInt(ee),0)}}),Te.options.allowDeleteColumn!=0&&Q.push({title:jSuites.translate("Delete selected columns"),onclick:function(){Te.deleteColumn(Te.getSelectedColumns().length?void 0:parseInt(ee))}}),Te.options.allowRenameColumn!=0&&Q.push({title:jSuites.translate("Rename this column"),onclick:function(){const pe=Te.getHeader(ee),Re=prompt(jSuites.translate("Column name"),pe);Te.setHeader(ee,Re)}}),Te.options.columnSorting!=0&&(Q.push({type:"line"}),Q.push({title:jSuites.translate("Order ascending"),onclick:function(){Te.orderBy(ee,0)}}),Q.push({title:jSuites.translate("Order descending"),onclick:function(){Te.orderBy(ee,1)}}))),H!=="row"&&H!=="cell"||(Te.options.allowInsertRow!=0&&(Q.push({title:jSuites.translate("Insert a new row before"),onclick:function(){Te.insertRow(1,parseInt(ye),1)}}),Q.push({title:jSuites.translate("Insert a new row after"),onclick:function(){Te.insertRow(1,parseInt(ye))}})),Te.options.allowDeleteRow!=0&&Q.push({title:jSuites.translate("Delete selected rows"),onclick:function(){Te.deleteRow(Te.getSelectedRows().length?void 0:parseInt(ye))}})),H==="cell"&&Te.options.allowComments!=0){Q.push({type:"line"});const pe=Te.records[ye][ee].element.getAttribute("title")||"";Q.push({title:jSuites.translate(pe?"Edit comments":"Add comments"),onclick:function(){const Re=prompt(jSuites.translate("Comments"),pe);Re&&Te.setComments((0,z.getCellNameFromCoords)(ee,ye),Re)}}),pe&&Q.push({title:jSuites.translate("Clear comments"),onclick:function(){Te.setComments((0,z.getCellNameFromCoords)(ee,ye),"")}})}return Q.length!==0&&Q.push({type:"line"}),H!=="header"&&H!=="row"&&H!=="cell"||(Q.push({title:jSuites.translate("Copy..."),shortcut:"Ctrl + C",onclick:function(){Z.call(Te,!0)}}),navigator&&navigator.clipboard&&Q.push({title:jSuites.translate("Paste..."),shortcut:"Ctrl + V",onclick:function(){Te.selectedCell&&navigator.clipboard.readText().then(function(pe){pe&&ve.call(Te,Te.selectedCell[0],Te.selectedCell[1],pe)})}})),Te.parent.config.allowExport!=0&&Q.push({title:jSuites.translate("Save as..."),shortcut:"Ctrl + S",onclick:function(){Te.download()}}),Te.parent.config.about!=0&&Q.push({title:jSuites.translate("About"),onclick:function(){Te.parent.config.about===void 0||Te.parent.config.about===!0?alert(rt.print()):alert(Te.parent.config.about)}}),Q}(r.jspreadsheet.current,parseInt(j),parseInt(Y),L);if(typeof K.config.contextMenu=="function"){const Te=K.config.contextMenu(r.jspreadsheet.current,j,Y,A,oe,L,j,Y);if(Te)oe=Te;else if(Te===!1)return}typeof K.plugins=="object"&&Object.entries(K.plugins).forEach(function([,Te]){if(typeof Te.contextMenu=="function"){const ee=Te.contextMenu(r.jspreadsheet.current,j!==null?parseInt(j):null,Y!==null?parseInt(Y):null,A,oe,L,j!==null?parseInt(j):null,Y!==null?parseInt(Y):null);ee&&(oe=ee)}}),K.contextMenu.contextmenu.open(A,oe),A.preventDefault()}}},ge=function(A){const K=U(A.target);if(K[0]?r.jspreadsheet.current!=K[0].jssWorksheet&&(r.jspreadsheet.current&&r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current=K[0].jssWorksheet):r.jspreadsheet.current&&(r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current=null),r.jspreadsheet.current&&!r.jspreadsheet.current.edition){const L=A.target.getAttribute("data-x"),j=A.target.getAttribute("data-y");L&&j&&(k.Es.call(r.jspreadsheet.current,L,j,void 0,void 0,A),r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.options.columns[L].type=="color"?r.jspreadsheet.tmpElement=null:r.jspreadsheet.tmpElement=A.target,s.call(r.jspreadsheet.current,A.target,!1,A)},500))}},we=function(A){r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null,r.jspreadsheet.tmpElement&&r.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&r.jspreadsheet.tmpElement.children[0].focus(),r.jspreadsheet.tmpElement=null)},qe=function(A){r.jspreadsheet.current&&(r.jspreadsheet.current.edition||(Z.call(r.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),r.jspreadsheet.current.options.editable!=0&&r.jspreadsheet.current.setValue(r.jspreadsheet.current.highlighted.map(function(K){return K.element}),"")))},$e=function(A){r.jspreadsheet.current&&$e.enabled&&(r.jspreadsheet.current.edition||Z.call(r.jspreadsheet.current,!0))},ze=function(A){if(r.jspreadsheet.current){if(r.jspreadsheet.current.edition)if(A.which==27)r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!1),A.preventDefault();else if(A.which==13){if(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type=="calendar")o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0);else if(!(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type=="dropdown"))if((r.jspreadsheet.current.options.wordWrap==1||r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].wordWrap==1||r.jspreadsheet.current.options.data[r.jspreadsheet.current.edition[3]][r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.data[r.jspreadsheet.current.edition[3]][r.jspreadsheet.current.edition[2]].length>200)&&A.altKey){const K=r.jspreadsheet.current.edition[0].children[0];let L=r.jspreadsheet.current.edition[0].children[0].value;const j=K.selectionStart;L=L.slice(0,j)+`
`+L.slice(j),K.value=L,K.focus(),K.selectionStart=j+1,K.selectionEnd=j+1}else r.jspreadsheet.current.edition[0].children[0].blur()}else A.which==9&&(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type)?o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0):r.jspreadsheet.current.edition[0].children[0].blur());if(!r.jspreadsheet.current.edition&&r.jspreadsheet.current.selectedCell)if(A.which==37)O.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==39)m.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==38)d.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==40)_.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==36)N.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==35)G.call(r.jspreadsheet.current,A.shiftKey,A.ctrlKey),A.preventDefault();else if(A.which==46)r.jspreadsheet.current.options.editable!=0&&(r.jspreadsheet.current.selectedRow?r.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&r.jspreadsheet.current.deleteRow():r.jspreadsheet.current.selectedHeader?r.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&r.jspreadsheet.current.deleteColumn():r.jspreadsheet.current.setValue(r.jspreadsheet.current.highlighted.map(function(K){return K.element}),""));else if(A.which==13)A.shiftKey?d.call(r.jspreadsheet.current):(r.jspreadsheet.current.options.allowInsertRow!=0&&r.jspreadsheet.current.options.allowManualInsertRow!=0&&r.jspreadsheet.current.selectedCell[1]==r.jspreadsheet.current.options.data.length-1&&r.jspreadsheet.current.insertRow(),_.call(r.jspreadsheet.current)),A.preventDefault();else if(A.which==9)A.shiftKey?O.call(r.jspreadsheet.current):(r.jspreadsheet.current.options.allowInsertColumn!=0&&r.jspreadsheet.current.options.allowManualInsertColumn!=0&&r.jspreadsheet.current.selectedCell[0]==r.jspreadsheet.current.options.data[0].length-1&&r.jspreadsheet.current.insertColumn(),m.call(r.jspreadsheet.current)),A.preventDefault();else if(!A.ctrlKey&&!A.metaKey||A.shiftKey){if(r.jspreadsheet.current.selectedCell&&r.jspreadsheet.current.options.editable!=0){const K=r.jspreadsheet.current.selectedCell[1],L=r.jspreadsheet.current.selectedCell[0];A.keyCode==32?(A.preventDefault(),r.jspreadsheet.current.options.columns[L].type=="checkbox"||r.jspreadsheet.current.options.columns[L].type=="radio"?a.call(r.jspreadsheet.current):s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[K][L].element,!0,A)):A.keyCode==113?s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[K][L].element,!1,A):(A.keyCode==8||A.keyCode>=48&&A.keyCode<=57||A.keyCode>=96&&A.keyCode<=111||A.keyCode>=187&&A.keyCode<=190||(String.fromCharCode(A.keyCode)==A.key||String.fromCharCode(A.keyCode).toLowerCase()==A.key.toLowerCase())&&String.fromCharCode(A.keyCode).match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g))&&(s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[K][L].element,!0,A),r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[L]&&r.jspreadsheet.current.options.columns[L].type=="calendar"&&A.preventDefault())}}else A.which==65?(k.td.call(r.jspreadsheet.current),A.preventDefault()):A.which==83?(r.jspreadsheet.current.download(),A.preventDefault()):A.which==89?(r.jspreadsheet.current.redo(),A.preventDefault()):A.which==90?(r.jspreadsheet.current.undo(),A.preventDefault()):A.which==67?(Z.call(r.jspreadsheet.current,!0),A.preventDefault()):A.which==88?(r.jspreadsheet.current.options.editable!=0?qe():$e(),A.preventDefault()):A.which==86&&Ie();else A.target.classList.contains("jss_search")&&(r.jspreadsheet.timeControl&&clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.search(A.target.value)},200))}},it=function(A){const K=this;K.options.lazyLoading==1&&r.jspreadsheet.timeControlLoading==null&&(r.jspreadsheet.timeControlLoading=setTimeout(function(){K.content.scrollTop+K.content.clientHeight>=K.content.scrollHeight-10?l.VG.call(K)&&(K.content.scrollTop+K.content.clientHeight>K.content.scrollHeight-10&&(K.content.scrollTop=K.content.scrollTop-K.content.clientHeight),k.x8.call(K)):K.content.scrollTop<=K.content.clientHeight&&l.Kw.call(K)&&(K.content.scrollTop<10&&(K.content.scrollTop=K.content.scrollTop+K.content.clientHeight),k.x8.call(K)),r.jspreadsheet.timeControlLoading=null},100))};let Ve=0;const Qe=function(){const A=this;Ve=A.content.scrollLeft;let K=0;if(Ve>50)for(let L=0;L<A.options.freezeColumns;L++){if(L>0&&(!A.options.columns||!A.options.columns[L-1]||A.options.columns[L-1].type!=="hidden")){let j;j=A.options.columns&&A.options.columns[L-1]&&A.options.columns[L-1].width!==void 0?parseInt(A.options.columns[L-1].width):A.options.defaultColWidth!==void 0?parseInt(A.options.defaultColWidth):100,K+=parseInt(j)}A.headers[L].classList.add("jss_freezed"),A.headers[L].style.left=K+"px";for(let j=0;j<A.rows.length;j++)if(A.rows[j]&&A.records[j][L]){const Y=Ve+(L>0?A.records[j][L-1].element.style.width:0)-51+"px";A.records[j][L].element.classList.add("jss_freezed"),A.records[j][L].element.style.left=Y}}else for(let L=0;L<A.options.freezeColumns;L++){A.headers[L].classList.remove("jss_freezed"),A.headers[L].style.left="";for(let j=0;j<A.rows.length;j++)A.records[j][L]&&(A.records[j][L].element.classList.remove("jss_freezed"),A.records[j][L].element.style.left="")}k.x8.call(A)},nt=function(A){const K=this;it.call(K),K.options.freezeColumns>0&&K.content.scrollLeft!=Ve&&Qe.call(K),K.options.lazyLoading!=1&&K.options.tableOverflow!=1||K.edition&&A.target.className.substr(0,9)!="jdropdown"&&o.call(K,K.edition[0],!0)},Ze=function(A){at(A),A.addEventListener("mouseup",te),A.addEventListener("mousedown",V),A.addEventListener("mousemove",ue),A.addEventListener("mouseover",Ge),A.addEventListener("dblclick",Ue),A.addEventListener("paste",Ie),A.addEventListener("contextmenu",le),A.addEventListener("touchstart",ge),A.addEventListener("touchend",we),A.addEventListener("touchcancel",we),A.addEventListener("touchmove",we),document.addEventListener("keydown",ze)},at=function(A){A.removeEventListener("mouseup",te),A.removeEventListener("mousedown",V),A.removeEventListener("mousemove",ue),A.removeEventListener("mouseover",Ge),A.removeEventListener("dblclick",Ue),A.removeEventListener("paste",Ie),A.removeEventListener("contextmenu",le),A.removeEventListener("touchstart",ge),A.removeEventListener("touchend",we),A.removeEventListener("touchcancel",we),document.removeEventListener("keydown",ze)};var St=__webpack_require__(898),bt=__webpack_require__(673);const q=function(A,K,L,j,Y){const oe=this,Te={},ee={},ye=function(Q,pe,Re){const Ce=(0,ne.qP)(Q,!0);if(oe.records[Ce[1]]&&oe.records[Ce[1]][Ce[0]]&&(oe.records[Ce[1]][Ce[0]].element.classList.contains("readonly")==0||j)){const We=oe.records[Ce[1]][Ce[0]].element.style[pe];We!=Re||j?oe.records[Ce[1]][Ce[0]].element.style[pe]=Re:(Re="",oe.records[Ce[1]][Ce[0]].element.style[pe]=""),ee[Q]||(ee[Q]=[]),Te[Q]||(Te[Q]=[]),ee[Q].push([pe+":"+We]),Te[Q].push([pe+":"+Re])}};if(K&&L)typeof A=="string"&&ye(A,K,L);else{const Q=Object.keys(A);for(let pe=0;pe<Q.length;pe++){let Re=A[Q[pe]];typeof Re=="string"&&(Re=Re.split(";"));for(let Ce=0;Ce<Re.length;Ce++)typeof Re[Ce]=="string"&&(Re[Ce]=Re[Ce].split(":")),Re[Ce][0].trim()&&ye(Q[pe],Re[Ce][0].trim(),Re[Ce][1])}}let H=Object.keys(ee);for(let Q=0;Q<H.length;Q++)ee[H[Q]]=ee[H[Q]].join(";");H=Object.keys(Te);for(let Q=0;Q<H.length;Q++)Te[H[Q]]=Te[H[Q]].join(";");Y||n.JB.call(oe,{action:"setStyle",oldValue:ee,newValue:Te}),e.Z.call(oe,"onchangestyle",oe,Te)},X=function(A){const K=this;if(A)return typeof A!="string"?X.call(K):(A=(0,ne.qP)(A,!0),K.records[A[1]][A[0]].element.getAttribute("title")||"");{const L={};for(let j=0;j<K.options.data.length;j++)for(let Y=0;Y<K.options.columns.length;Y++){const oe=K.records[j][Y].element.getAttribute("title");oe&&(L[(0,ne.Ar)([Y,j])]=oe)}return L}};var F=__webpack_require__(54);const b=function(){return this.config},ce=function(A,K){const L=this,j=Object.keys(A);let Y;L.parent?Y=L.parent:(K=!0,Y=L),j.forEach(function(oe){K?(Y.config[oe]=A[oe],oe==="toolbar"&&(A[oe]===!0?Y.showToolbar():A[oe]===!1&&Y.hideToolbar())):L.options[oe]=A[oe]})};var Fe=__webpack_require__(272);const Le=function(){let A=this;(function(pe){for(let Re=0;Re<je;Re++){const[Ce,We]=Ae[Re];pe[Ce]=We.bind(pe)}})(A),A.table=document.createElement("table"),A.thead=document.createElement("thead"),A.tbody=document.createElement("tbody"),A.headers=[],A.cols=[],A.content=document.createElement("div"),A.content.classList.add("jss_content"),A.content.onscroll=function(pe){nt.call(A,pe)},A.content.onwheel=function(pe){it.call(A,pe)};const K=document.createElement("div"),L=document.createTextNode(jSuites.translate("Search")+": ");A.searchInput=document.createElement("input"),A.searchInput.classList.add("jss_search"),K.appendChild(L),K.appendChild(A.searchInput),A.searchInput.onfocus=function(){A.resetSelection()};const j=document.createElement("div");if(A.options.pagination>0&&A.options.paginationOptions&&A.options.paginationOptions.length>0){A.paginationDropdown=document.createElement("select"),A.paginationDropdown.classList.add("jss_pagination_dropdown"),A.paginationDropdown.onchange=function(){A.options.pagination=parseInt(this.value),A.page(0)};for(let pe=0;pe<A.options.paginationOptions.length;pe++){const Re=document.createElement("option");Re.value=A.options.paginationOptions[pe],Re.innerHTML=A.options.paginationOptions[pe],A.paginationDropdown.appendChild(Re)}A.paginationDropdown.value=A.options.pagination,j.appendChild(document.createTextNode(jSuites.translate("Show "))),j.appendChild(A.paginationDropdown),j.appendChild(document.createTextNode(jSuites.translate("entries")))}const Y=document.createElement("div");Y.classList.add("jss_filter"),Y.appendChild(j),Y.appendChild(K),A.colgroupContainer=document.createElement("colgroup");let oe=document.createElement("col");if(oe.setAttribute("width","50"),A.colgroupContainer.appendChild(oe),A.options.nestedHeaders&&A.options.nestedHeaders.length>0&&A.options.nestedHeaders[0]&&A.options.nestedHeaders[0][0])for(let pe=0;pe<A.options.nestedHeaders.length;pe++)A.thead.appendChild(t.UQ.call(A,A.options.nestedHeaders[pe]));A.headerContainer=document.createElement("tr"),oe=document.createElement("td"),oe.classList.add("jss_selectall"),A.headerContainer.appendChild(oe);const Te=Se.call(A);for(let pe=0;pe<Te;pe++)Me.call(A,pe),A.headerContainer.appendChild(A.headers[pe]),A.colgroupContainer.appendChild(A.cols[pe].colElement);if(A.thead.appendChild(A.headerContainer),A.options.filters==1){A.filter=document.createElement("tr");const pe=document.createElement("td");A.filter.appendChild(pe);for(let Re=0;Re<A.options.columns.length;Re++){const Ce=document.createElement("td");Ce.innerHTML="&nbsp;",Ce.setAttribute("data-x",Re),Ce.className="jss_column_filter",A.options.columns[Re].type=="hidden"&&(Ce.style.display="none"),A.filter.appendChild(Ce)}A.thead.appendChild(A.filter)}A.table=document.createElement("table"),A.table.classList.add("jss_worksheet"),A.table.setAttribute("cellpadding","0"),A.table.setAttribute("cellspacing","0"),A.table.setAttribute("unselectable","yes"),A.table.appendChild(A.colgroupContainer),A.table.appendChild(A.thead),A.table.appendChild(A.tbody),A.options.textOverflow||A.table.classList.add("jss_overflow"),A.corner=document.createElement("div"),A.corner.className="jss_corner",A.corner.setAttribute("unselectable","on"),A.corner.setAttribute("onselectstart","return false"),A.options.selectionCopy==0&&(A.corner.style.display="none"),A.textarea=document.createElement("textarea"),A.textarea.className="jss_textarea",A.textarea.id="jss_textarea",A.textarea.tabIndex="-1";const ee=document.createElement("a");ee.setAttribute("href","https://bossanova.uk/jspreadsheet/"),A.ads=document.createElement("div"),A.ads.className="jss_about";const ye=document.createElement("span");ye.innerHTML="Jspreadsheet CE",ee.appendChild(ye),A.ads.appendChild(ee),document.createElement("div").classList.add("jss_table"),A.pagination=document.createElement("div"),A.pagination.classList.add("jss_pagination");const H=document.createElement("div"),Q=document.createElement("div");if(A.pagination.appendChild(H),A.pagination.appendChild(Q),A.options.pagination||(A.pagination.style.display="none"),A.options.search==1&&A.element.appendChild(Y),A.content.appendChild(A.table),A.content.appendChild(A.corner),A.content.appendChild(A.textarea),A.element.appendChild(A.content),A.element.appendChild(A.pagination),A.element.appendChild(A.ads),A.element.classList.add("jss_container"),A.element.jssWorksheet=A,A.element.jspreadsheet=A,A.options.tableOverflow==1&&(A.options.tableHeight&&(A.content.style["overflow-y"]="auto",A.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",A.content.style.maxHeight=typeof A.options.tableHeight=="string"?A.options.tableHeight:A.options.tableHeight+"px"),A.options.tableWidth&&(A.content.style["overflow-x"]="auto",A.content.style.width=typeof A.options.tableWidth=="string"?A.options.tableWidth:A.options.tableWidth+"px")),A.options.tableOverflow!=1&&A.parent.config.toolbar&&A.element.classList.add("with-toolbar"),A.options.columnDrag!=0&&A.thead.classList.add("draggable"),A.options.columnResize!=0&&A.thead.classList.add("resizable"),A.options.rowDrag!=0&&A.tbody.classList.add("draggable"),A.options.rowResize!=0&&A.tbody.classList.add("resizable"),A.setData.call(A),A.options.style&&(A.setStyle(A.options.style,null,null,1,1),delete A.options.style),Object.defineProperty(A.options,"style",{enumerable:!0,configurable:!0,get(){return A.getStyle()}}),A.options.comments&&A.setComments(A.options.comments),A.options.classes){const pe=Object.keys(A.options.classes);for(let Re=0;Re<pe.length;Re++){const Ce=(0,ne.qP)(pe[Re],!0);A.records[Ce[1]][Ce[0]].element.classList.add(A.options.classes[pe[Re]])}}},ae=function(){const A=this;A.options.lazyLoading==1&&A.options.tableOverflow!=1&&A.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),A.options.lazyLoading=!1),A.options.columns||(A.options.columns=[]);let K,L=A.options.columns.length;if(A.options.data&&A.options.data[0]!==void 0)if(Array.isArray(A.options.data[0])){const Y=A.options.data[0].length;Y>L&&(L=Y)}else K=Object.keys(A.options.data[0]),K.length>L&&(L=K.length);A.options.minDimensions||(A.options.minDimensions=[0,0]),A.options.minDimensions[0]>L&&(L=A.options.minDimensions[0]);const j=[];for(let Y=0;Y<L;Y++)A.options.columns[Y]||(A.options.columns[Y]={}),!A.options.columns[Y].name&&K&&K[Y]&&(A.options.columns[Y].name=K[Y]),A.options.columns[Y].type=="dropdown"&&A.options.columns[Y].url&&j.push({url:A.options.columns[Y].url,index:Y,method:"GET",dataType:"json",success:function(oe){A.options.columns[this.index].source||(A.options.columns[this.index].source=[]);for(let Te=0;Te<oe.length;Te++)A.options.columns[this.index].source.push(oe[Te])}});j.length?jSuites.ajax(j,function(){Le.call(A)}):Le.call(A)},re=function(A){const K=/^Sheet(\d+)$/;let L=0;return A.worksheets.forEach(function(j){const Y=K.exec(j.options.worksheetName);Y&&(L=Math.max(L,parseInt(Y[1])))}),"Sheet"+(L+1)},me=async function(){const A=this,K=A.element,L=A.parent;typeof L.plugins=="object"&&Object.entries(L.plugins).forEach(function([,Y]){typeof Y.beforeinit=="function"&&Y.beforeinit(A)}),r.jspreadsheet.current=A,K.setAttribute("tabindex",1),K.addEventListener("focus",function(Y){r.jspreadsheet.current&&!A.selectedCell&&A.updateSelectionFromCoords(0,0,0,0)});const j=[];if(A.options.csv){const Y=new Promise(oe=>{jSuites.ajax({url:A.options.csv,method:"GET",dataType:"text",success:function(Te){const ee=(0,z.parseCSV)(Te,A.options.csvDelimiter);if(A.options.csvHeaders==1&&ee.length>0){const ye=ee.shift();if(ye.length>0){A.options.columns||(A.options.columns=[]);for(let H=0;H<ye.length;H++)A.options.columns[H]||(A.options.columns[H]={}),A.options.columns[H].title===void 0&&(A.options.columns[H].title=ye[H])}}A.options.data=ee,ae.call(A),oe()}})});j.push(Y)}else if(A.options.url){const Y=new Promise(oe=>{jSuites.ajax({url:A.options.url,method:"GET",dataType:"json",success:function(Te){A.options.data=Te.data?Te.data:Te,ae.call(A),oe()}})});j.push(Y)}else ae.call(A);await Promise.all(j),typeof L.plugins=="object"&&Object.entries(L.plugins).forEach(function([,Y]){typeof Y.init=="function"&&Y.init(A)})},he=function(A){const K=this.parent;A.worksheetName||(A.worksheetName=re(this.parent));const L={parent:K,options:A,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return K.config.worksheets.push(L.options),K.worksheets.push(L),L},Ae=[["selectAll",k.td],["updateSelectionFromCoords",function(A,K,L,j){return k.Es.call(this,A,K,L,j)}],["resetSelection",function(){return k.yE.call(this)}],["getSelection",k.Mf],["getSelected",k.ey],["getSelectedColumns",k.H7],["getSelectedRows",k.Ym],["getData",function(A,K,L,j){const Y=this,oe=[];let Te=0,ee=0;const ye=Math.max(...Y.options.data.map(function(Q){return Q.length})),H=Y.options.data.length;for(let Q=0;Q<H;Q++){Te=0;for(let pe=0;pe<ye;pe++)A&&!Y.records[Q][pe].element.classList.contains("highlight")||(oe[ee]||(oe[ee]=[]),oe[ee][Te]=K?Y.records[Q][pe].element.innerHTML:Y.options.data[Q][pe],Te++);Te>0&&ee++}return L?oe.map(function(Q){return Q.join(L)}).join(`\r
`)+`\r
`:j?oe.map(function(Q){const pe={};return Q.forEach(function(Re,Ce){pe[Ce]=Re}),pe}):oe}],["setData",function(A){const K=this;if(A&&(K.options.data=A),K.options.data||(K.options.data=[]),K.options.data&&K.options.data[0]&&!Array.isArray(K.options.data[0])){A=[];for(let Re=0;Re<K.options.data.length;Re++){const Ce=[];for(let We=0;We<K.options.columns.length;We++)Ce[We]=K.options.data[Re][K.options.columns[We].name];A.push(Ce)}K.options.data=A}let L=0,j=0;const Y=K.options.columns&&K.options.columns.length||0,oe=K.options.data.length,Te=K.options.minDimensions[0],ee=K.options.minDimensions[1],ye=Te>Y?Te:Y,H=ee>oe?ee:oe;for(L=0;L<H;L++)for(j=0;j<ye;j++)K.options.data[L]==null&&(K.options.data[L]=[]),K.options.data[L][j]==null&&(K.options.data[L][j]="");let Q,pe;for(K.rows=[],K.results=null,K.records=[],K.history=[],K.historyIndex=-1,K.tbody.innerHTML="",K.options.lazyLoading==1?(Q=0,pe=K.options.data.length<100?K.options.data.length:100,K.options.pagination&&(K.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):K.options.pagination?(K.pageNumber||(K.pageNumber=0),K.options.pagination,Q=K.options.pagination*K.pageNumber,pe=K.options.pagination*K.pageNumber+K.options.pagination,K.options.data.length<pe&&(pe=K.options.data.length)):(Q=0,pe=K.options.data.length),L=0;L<K.options.data.length;L++){const Re=_e.call(K,L,K.options.data[L]);L>=Q&&L<pe&&K.tbody.appendChild(Re.element)}if(K.options.lazyLoading==1||K.options.pagination&&bt.Ik.call(K),K.options.mergeCells){const Re=Object.keys(K.options.mergeCells);for(let Ce=0;Ce<Re.length;Ce++){const We=K.options.mergeCells[Re[Ce]];D.mt.call(K,Re[Ce],We[0],We[1],1)}}t.T0.call(K)}],["getValue",function(A,K){const L=this;let j,Y;if(typeof A!="string")return null;j=(A=(0,ne.qP)(A,!0))[0],Y=A[1];let oe=null;return j!=null&&Y!=null&&(L.records[Y]&&L.records[Y][j]&&K?oe=L.records[Y][j].element.innerHTML:L.options.data[Y]&&L.options.data[Y][j]!="undefined"&&(oe=L.options.data[Y][j])),oe}],["getValueFromCoords",function(A,K,L){const j=this;let Y=null;return A!=null&&K!=null&&(j.records[K]&&j.records[K][A]&&L?Y=j.records[K][A].element.innerHTML:j.options.data[K]&&j.options.data[K][A]!="undefined"&&(Y=j.options.data[K][A])),Y}],["setValue",function(A,K,L){const j=this,Y=[];if(typeof A=="string"){const Te=(0,ne.qP)(A,!0),ee=Te[0],ye=Te[1];Y.push(t.wW.call(j,ee,ye,K,L)),t.Zz.call(j,ee,ye,Y)}else{let Te=null,ee=null;if(A&&A.getAttribute&&(Te=A.getAttribute("data-x"),ee=A.getAttribute("data-y")),Te!=null&&ee!=null)Y.push(t.wW.call(j,Te,ee,K,L)),t.Zz.call(j,Te,ee,Y);else{const ye=Object.keys(A);if(ye.length>0)for(let H=0;H<ye.length;H++){let Q,pe;if(typeof A[H]=="string"){const Re=(0,ne.qP)(A[H],!0);Q=Re[0],pe=Re[1]}else A[H].x!=null&&A[H].y!=null?(Q=A[H].x,pe=A[H].y,A[H].value!=null&&(K=A[H].value)):(Q=A[H].getAttribute("data-x"),pe=A[H].getAttribute("data-y"));Q!=null&&pe!=null&&(Y.push(t.wW.call(j,Q,pe,K,L)),t.Zz.call(j,Q,pe,Y))}}}n.JB.call(j,{action:"setValue",records:Y,selection:j.selectedCell}),t.T0.call(j);const oe=Y.map(function(Te){return{x:Te.x,y:Te.y,value:Te.newValue,oldValue:Te.oldValue}});e.Z.call(j,"onafterchanges",j,oe)}],["setValueFromCoords",function(A,K,L,j){const Y=this,oe=[];oe.push(t.wW.call(Y,A,K,L,j)),t.Zz.call(Y,A,K,oe),n.JB.call(Y,{action:"setValue",records:oe,selection:Y.selectedCell}),t.T0.call(Y);const Te=oe.map(function(ee){return{x:ee.x,y:ee.y,value:ee.newValue,oldValue:ee.oldValue}});e.Z.call(Y,"onafterchanges",Y,Te)}],["getWidth",function(A){const K=this;let L;if(A===void 0){L=[];for(let j=0;j<K.headers.length;j++)L.push(K.options.columns&&K.options.columns[j]&&K.options.columns[j].width||K.options.defaultColWidth||100)}else L=parseInt(K.cols[A].colElement.getAttribute("width"));return L}],["setWidth",function(A,K){return Pe.call(this,A,K)}],["insertRow",function(A,K,L){const j=this;if(j.options.allowInsertRow!=0){let Y,oe=[];Array.isArray(A)?(Y=1,A&&(oe=A)):Y=A!==void 0?A:1,L=!!L;const Te=j.options.data.length-1;(K==null||K>=parseInt(Te)||K<0)&&(K=Te);const ee=[];for(let ot=0;ot<Y;ot++){const mt=[];for(let Ye=0;Ye<j.options.columns.length;Ye++)mt[Ye]=oe[Ye]?oe[Ye]:"";ee.push({row:ot+K+(L?0:1),data:mt})}if(e.Z.call(j,"onbeforeinsertrow",j,ee)===!1)return!1;if(j.options.mergeCells&&Object.keys(j.options.mergeCells).length>0&&D.q4.call(j,K,L).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;j.destroyMerge()}if(j.options.search==1){if(j.results&&j.results.length!=j.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;j.resetSearch()}j.results=null}const ye=L?K:K+1,H=j.records.splice(ye),Q=j.options.data.splice(ye),pe=j.rows.splice(ye),Re=[],Ce=[],We=[];for(let ot=ye;ot<Y+ye;ot++){j.options.data[ot]=[];for(let Ye=0;Ye<j.options.columns.length;Ye++)j.options.data[ot][Ye]=oe[Ye]?oe[Ye]:"";const mt=_e.call(j,ot,j.options.data[ot]);pe[0]?Array.prototype.indexOf.call(j.tbody.children,pe[0].element)>=0&&j.tbody.insertBefore(mt.element,pe[0].element):Array.prototype.indexOf.call(j.tbody.children,j.rows[K].element)>=0&&j.tbody.appendChild(mt.element),Re.push(j.records[ot]),Ce.push(j.options.data[ot]),We.push(mt)}Array.prototype.push.apply(j.records,H),Array.prototype.push.apply(j.options.data,Q),Array.prototype.push.apply(j.rows,pe);for(let ot=ye;ot<j.rows.length;ot++)j.rows[ot].y=ot;for(let ot=ye;ot<j.records.length;ot++)for(let mt=0;mt<j.records[ot].length;mt++)j.records[ot][mt].y=ot;j.options.pagination>0&&j.page(j.pageNumber),n.JB.call(j,{action:"insertRow",rowNumber:K,numOfRows:Y,insertBefore:L,rowRecords:Re,rowData:Ce,rowNode:We}),t.ec.call(j),e.Z.call(j,"oninsertrow",j,ee)}}],["moveRow",function(A,K){return Oe.call(this,A,K)}],["deleteRow",function(A,K){const L=this;if(L.options.allowDeleteRow!=0)if(L.options.allowDeletingAllRows==1||L.options.data.length>1){if(A==null){const oe=k.Ym.call(L);oe.length===0?(A=L.options.data.length-1,K=1):(A=oe[0],K=oe.length)}let j=L.options.data.length-1;(A==null||A>j||A<0)&&(A=j),K||(K=1),A+K>=L.options.data.length&&(K=L.options.data.length-A);const Y=[];for(let oe=0;oe<K;oe++)Y.push(oe+A);if(e.Z.call(L,"onbeforedeleterow",L,Y)===!1)return!1;if(parseInt(A)>-1){let oe=!1;if(L.options.mergeCells&&Object.keys(L.options.mergeCells).length>0)for(let H=A;H<A+K;H++)D.q4.call(L,H,!1).length&&(oe=!0);if(oe){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;L.destroyMerge()}if(L.options.search==1){if(L.results&&L.results.length!=L.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;L.resetSearch()}L.results=null}L.options.allowDeletingAllRows!=1&&j+1===K&&(K--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let H=A;H<A+K;H++)Array.prototype.indexOf.call(L.tbody.children,L.rows[H].element)>=0&&(L.rows[H].element.className="",L.rows[H].element.parentNode.removeChild(L.rows[H].element));const Te=L.records.splice(A,K),ee=L.options.data.splice(A,K),ye=L.rows.splice(A,K);for(let H=A;H<L.rows.length;H++)L.rows[H].y=H;for(let H=A;H<L.records.length;H++)for(let Q=0;Q<L.records[H].length;Q++)L.records[H][Q].y=H;L.options.pagination>0&&L.tbody.children.length!=L.options.pagination&&L.page(L.pageNumber),k.Uv.call(L,1,A,A+K-1),n.JB.call(L,{action:"deleteRow",rowNumber:A,numOfRows:K,insertBefore:1,rowRecords:Te,rowData:ee,rowNode:ye}),t.ec.call(L),e.Z.call(L,"ondeleterow",L,Y)}}else console.error("Jspreadsheet: It is not possible to delete the last row")}],["hideRow",function(A){const K=this;Array.isArray(A)||(A=[A]),A.forEach(function(L){K.rows[L].element.style.display="none"})}],["showRow",function(A){const K=this;Array.isArray(A)||(A=[A]),A.forEach(function(L){K.rows[L].element.style.display=""})}],["getRowData",function(A,K){return K?this.records[A].map(function(L){return L.element.innerHTML}):this.options.data[A]}],["setRowData",function(A,K,L){const j=this;for(let Y=0;Y<j.headers.length;Y++){const oe=(0,ne.Ar)([Y,A]);K[Y]!=null&&j.setValue(oe,K[Y],L)}}],["getHeight",function(A){const K=this;let L;if(A===void 0){L=[];for(let j=0;j<K.rows.length;j++){const Y=K.rows[j].element.style.height;Y&&(L[j]=Y)}}else typeof A=="object"&&(A=$(A).getAttribute("data-y")),L=K.rows[A].element.style.height;return L}],["setHeight",function(A,K){return st.call(this,A,K)}],["getMerge",D.D8],["setMerge",function(A,K,L){return D.mt.call(this,A,K,L)}],["destroyMerge",function(){return D.tW.call(this)}],["removeMerge",function(A,K){return D.Vg.call(this,A,K)}],["search",function(A){const K=this;if(K.options.filters&&xe.aw.call(K),K.resetSelection(),K.pageNumber=0,K.results=[],A){K.searchInput.value!==A&&(K.searchInput.value=A);const L=function(oe,Te,ee){for(let ye=0;ye<oe.length;ye++)if((""+oe[ye]).toLowerCase().search(Te)>=0||(""+K.records[ee][ye].element.innerHTML).toLowerCase().search(Te)>=0)return!0;return!1},j=function(oe){K.results.indexOf(oe)==-1&&K.results.push(oe)};let Y=A.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");Y=new RegExp(Y,"i"),K.options.data.forEach(function(oe,Te){if(L(oe,Y,Te)){const ee=D.q4.call(K,Te);if(ee.length)for(let ye=0;ye<ee.length;ye++){const H=(0,ne.qP)(ee[ye],!0);for(let Q=0;Q<K.options.mergeCells[ee[ye]][1];Q++)j(H[1]+Q)}else j(Te)}})}else K.results=null;t.cW.call(K)}],["resetSearch",function(){const A=this;A.searchInput.value="",A.search(""),A.results=null}],["getHeader",function(A){return this.headers[A].textContent}],["getHeaders",function(A){const K=this,L=[];for(let j=0;j<K.headers.length;j++)L.push(K.getHeader(j));return A?L:L.join(K.options.csvDelimiter)}],["setHeader",function(A,K){const L=this;if(L.headers[A]){const j=L.headers[A].textContent,Y=L.options.columns&&L.options.columns[A]&&L.options.columns[A].title||"";K||(K=(0,z.getColumnName)(A)),L.headers[A].textContent=K,L.headers[A].setAttribute("title",K),L.options.columns||(L.options.columns=[]),L.options.columns[A]||(L.options.columns[A]={}),L.options.columns[A].title=K,n.JB.call(L,{action:"setHeader",column:A,oldValue:j,newValue:K}),e.Z.call(L,"onchangeheader",L,parseInt(A),K,Y)}}],["getStyle",function(A,K){const L=this;if(A)return A=(0,ne.qP)(A,!0),K?L.records[A[1]][A[0]].element.style[K]:L.records[A[1]][A[0]].element.getAttribute("style");{const j={},Y=L.options.data[0].length,oe=L.options.data.length;for(let Te=0;Te<oe;Te++)for(let ee=0;ee<Y;ee++){const ye=K?L.records[Te][ee].element.style[K]:L.records[Te][ee].element.getAttribute("style");ye&&(j[(0,ne.Ar)([ee,Te])]=ye)}return j}}],["setStyle",function(A,K,L,j){return q.call(this,A,K,L,j)}],["resetStyle",function(A,K){const L=this,j=Object.keys(A);for(let Y=0;Y<j.length;Y++){const oe=(0,ne.qP)(j[Y],!0);L.records[oe[1]]&&L.records[oe[1]][oe[0]]&&L.records[oe[1]][oe[0]].element.setAttribute("style","")}L.setStyle(A,null,null,null,K)}],["insertColumn",function(A,K,L,j){const Y=this;if(Y.options.allowInsertColumn!=0){let oe,Te=[];Array.isArray(A)?(oe=1,A&&(Te=A)):oe=typeof A=="number"?A:1,L=!!L;const ee=Math.max(Y.options.columns.length,...Y.options.data.map(function(Ye){return Ye.length}))-1;(K==null||K>=parseInt(ee)||K<0)&&(K=ee),j||(j=[]);for(let Ye=0;Ye<oe;Ye++)j[Ye]||(j[Ye]={});const ye=[];if(Array.isArray(A)){const Ye=[];for(let vt=0;vt<Y.options.data.length;vt++)Ye.push(vt<A.length?A[vt]:"");const Et={column:K+(L?0:1),options:Object.assign({},j[0]),data:Ye};ye.push(Et)}else for(let Ye=0;Ye<A;Ye++){const Et={column:K+Ye+(L?0:1),options:Object.assign({},j[Ye])};ye.push(Et)}if(e.Z.call(Y,"onbeforeinsertcolumn",Y,ye)===!1)return!1;if(Y.options.mergeCells&&Object.keys(Y.options.mergeCells).length>0&&D.D0.call(Y,K,L).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;Y.destroyMerge()}const H=L?K:K+1;Y.options.columns=(0,ne.Wc)(Y.options.columns,H,j);const Q=Y.headers.splice(H),pe=Y.cols.splice(H),Re=[],Ce=[],We=[],ot=[],mt=[];for(let Ye=H;Ye<oe+H;Ye++)Me.call(Y,Ye),Y.headerContainer.insertBefore(Y.headers[Ye],Y.headerContainer.children[Ye+1]),Y.colgroupContainer.insertBefore(Y.cols[Ye].colElement,Y.colgroupContainer.children[Ye+1]),Re.push(Y.headers[Ye]),Ce.push(Y.cols[Ye]);if(Y.options.footers)for(let Ye=0;Ye<Y.options.footers.length;Ye++){mt[Ye]=[];for(let Et=0;Et<oe;Et++)mt[Ye].push("");Y.options.footers[Ye].splice(H,0,mt[Ye])}for(let Ye=0;Ye<Y.options.data.length;Ye++){const Et=Y.options.data[Ye].splice(H),vt=Y.records[Ye].splice(H);ot[Ye]=[],We[Ye]=[];for(let xt=H;xt<oe+H;xt++){const He=Te[Ye]?Te[Ye]:"";Y.options.data[Ye][xt]=He;const ft=t.kE.call(Y,xt,Ye,Y.options.data[Ye][xt]);Y.records[Ye][xt]={element:ft,y:Ye},Y.rows[Ye]&&Y.rows[Ye].element.insertBefore(ft,Y.rows[Ye].element.children[xt+1]),Y.options.columns&&Y.options.columns[xt]&&typeof Y.options.columns[xt].render=="function"&&Y.options.columns[xt].render(ft,He,parseInt(xt),parseInt(Ye),Y,Y.options.columns[xt]),ot[Ye].push(He),We[Ye].push({element:ft,x:xt,y:Ye})}Array.prototype.push.apply(Y.options.data[Ye],Et),Array.prototype.push.apply(Y.records[Ye],vt)}Array.prototype.push.apply(Y.headers,Q),Array.prototype.push.apply(Y.cols,pe);for(let Ye=H;Ye<Y.cols.length;Ye++)Y.cols[Ye].x=Ye;for(let Ye=0;Ye<Y.records.length;Ye++)for(let Et=0;Et<Y.records[Ye].length;Et++)Y.records[Ye][Et].x=Et;if(Y.options.nestedHeaders&&Y.options.nestedHeaders.length>0&&Y.options.nestedHeaders[0]&&Y.options.nestedHeaders[0][0])for(let Ye=0;Ye<Y.options.nestedHeaders.length;Ye++){const Et=parseInt(Y.options.nestedHeaders[Ye][Y.options.nestedHeaders[Ye].length-1].colspan)+oe;Y.options.nestedHeaders[Ye][Y.options.nestedHeaders[Ye].length-1].colspan=Et,Y.thead.children[Ye].children[Y.thead.children[Ye].children.length-1].setAttribute("colspan",Et);let vt=Y.thead.children[Ye].children[Y.thead.children[Ye].children.length-1].getAttribute("data-column");vt=vt.split(",");for(let xt=H;xt<oe+H;xt++)vt.push(xt);Y.thead.children[Ye].children[Y.thead.children[Ye].children.length-1].setAttribute("data-column",vt)}n.JB.call(Y,{action:"insertColumn",columnNumber:K,numOfColumns:oe,insertBefore:L,columns:j,headers:Re,cols:Ce,records:We,footers:mt,data:ot}),t.ec.call(Y),e.Z.call(Y,"oninsertcolumn",Y,ye)}}],["moveColumn",function(A,K){const L=this;if(L.options.mergeCells&&Object.keys(L.options.mergeCells).length>0){let oe;if(oe=A>K?1:0,D.D0.call(L,A).length||D.D0.call(L,K,oe).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;L.destroyMerge()}}if((A=parseInt(A))>(K=parseInt(K))){L.headerContainer.insertBefore(L.headers[A],L.headers[K]),L.colgroupContainer.insertBefore(L.cols[A].colElement,L.cols[K].colElement);for(let oe=0;oe<L.rows.length;oe++)L.rows[oe].element.insertBefore(L.records[oe][A].element,L.records[oe][K].element)}else{L.headerContainer.insertBefore(L.headers[A],L.headers[K].nextSibling),L.colgroupContainer.insertBefore(L.cols[A].colElement,L.cols[K].colElement.nextSibling);for(let oe=0;oe<L.rows.length;oe++)L.rows[oe].element.insertBefore(L.records[oe][A].element,L.records[oe][K].element.nextSibling)}L.options.columns.splice(K,0,L.options.columns.splice(A,1)[0]),L.headers.splice(K,0,L.headers.splice(A,1)[0]),L.cols.splice(K,0,L.cols.splice(A,1)[0]);const j=Math.min(A,K),Y=Math.max(A,K);for(let oe=0;oe<L.rows.length;oe++)L.options.data[oe].splice(K,0,L.options.data[oe].splice(A,1)[0]),L.records[oe].splice(K,0,L.records[oe].splice(A,1)[0]);for(let oe=j;oe<=Y;oe++)L.cols[oe].x=oe;for(let oe=0;oe<L.records.length;oe++)for(let Te=j;Te<=Y;Te++)L.records[oe][Te].x=Te;if(L.options.footers)for(let oe=0;oe<L.options.footers.length;oe++)L.options.footers[oe].splice(K,0,L.options.footers[oe].splice(A,1)[0]);n.JB.call(L,{action:"moveColumn",oldValue:A,newValue:K}),t.ec.call(L),e.Z.call(L,"onmovecolumn",L,A,K,1)}],["deleteColumn",function(A,K){const L=this;if(L.options.allowDeleteColumn!=0)if(L.headers.length>1){if(A==null){const oe=L.getSelectedColumns(!0);oe.length?(A=parseInt(oe[0]),K=parseInt(oe.length)):(A=L.headers.length-1,K=1)}const j=L.options.data[0].length-1;(A==null||A>j||A<0)&&(A=j),K||(K=1),K>L.options.data[0].length-A&&(K=L.options.data[0].length-A);const Y=[];for(let oe=0;oe<K;oe++)Y.push(oe+A);if(e.Z.call(L,"onbeforedeletecolumn",L,Y)===!1)return!1;if(parseInt(A)>-1){let oe=!1;if(L.options.mergeCells&&Object.keys(L.options.mergeCells).length>0)for(let Re=A;Re<A+K;Re++)D.D0.call(L,Re,!1).length&&(oe=!0);if(oe){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;L.destroyMerge()}const Te=L.options.columns?L.options.columns.splice(A,K):void 0;for(let Re=A;Re<A+K;Re++)L.cols[Re].colElement.className="",L.headers[Re].className="",L.cols[Re].colElement.parentNode.removeChild(L.cols[Re].colElement),L.headers[Re].parentNode.removeChild(L.headers[Re]);const ee=L.headers.splice(A,K),ye=L.cols.splice(A,K),H=[],Q=[],pe=[];for(let Re=0;Re<L.options.data.length;Re++)for(let Ce=A;Ce<A+K;Ce++)L.records[Re][Ce].element.className="",L.records[Re][Ce].element.parentNode.removeChild(L.records[Re][Ce].element);for(let Re=0;Re<L.options.data.length;Re++)Q[Re]=L.options.data[Re].splice(A,K),H[Re]=L.records[Re].splice(A,K);for(let Re=A;Re<L.cols.length;Re++)L.cols[Re].x=Re;for(let Re=0;Re<L.records.length;Re++)for(let Ce=A;Ce<L.records[Re].length;Ce++)L.records[Re][Ce].x=Ce;if(L.options.footers)for(let Re=0;Re<L.options.footers.length;Re++)pe[Re]=L.options.footers[Re].splice(A,K);if(k.Uv.call(L,0,A,A+K-1),L.options.nestedHeaders&&L.options.nestedHeaders.length>0&&L.options.nestedHeaders[0]&&L.options.nestedHeaders[0][0])for(let Re=0;Re<L.options.nestedHeaders.length;Re++){const Ce=parseInt(L.options.nestedHeaders[Re][L.options.nestedHeaders[Re].length-1].colspan)-K;L.options.nestedHeaders[Re][L.options.nestedHeaders[Re].length-1].colspan=Ce,L.thead.children[Re].children[L.thead.children[Re].children.length-1].setAttribute("colspan",Ce)}n.JB.call(L,{action:"deleteColumn",columnNumber:A,numOfColumns:K,insertBefore:1,columns:Te,headers:ee,cols:ye,records:H,footers:pe,data:Q}),t.ec.call(L),e.Z.call(L,"ondeletecolumn",L,Y)}}else console.error("Jspreadsheet: It is not possible to delete the last column")}],["getColumnData",function(A,K){const L=this,j=[];for(let Y=0;Y<L.options.data.length;Y++)K?j.push(L.records[Y][A].element.innerHTML):j.push(L.options.data[Y][A]);return j}],["setColumnData",function(A,K,L){const j=this;for(let Y=0;Y<j.rows.length;Y++){const oe=(0,ne.Ar)([A,Y]);K[Y]!=null&&j.setValue(oe,K[Y],L)}}],["whichPage",bt.an],["page",bt.Md],["download",function(A,K){const L=this;if(L.parent.config.allowExport==0)console.error("Export not allowed");else{let j="";j+=Z.call(L,!1,L.options.csvDelimiter,!0,A,!0,void 0,K);const Y=new Blob(["\uFEFF"+j],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(Y,(L.options.csvFileName||L.options.worksheetName)+".csv");else{const oe=document.createElement("a"),Te=URL.createObjectURL(Y);oe.href=Te,oe.setAttribute("download",(L.options.csvFileName||L.options.worksheetName)+".csv"),document.body.appendChild(oe),oe.click(),oe.parentNode.removeChild(oe)}}}],["getComments",X],["setComments",function(A,K){const L=this;let j;j=typeof A=="string"?{[A]:K}:A;const Y={};Object.entries(j).forEach(function([oe,Te]){const ee=(0,z.getCoordsFromCellName)(oe);Y[oe]=L.records[ee[1]][ee[0]].element.getAttribute("title"),L.records[ee[1]][ee[0]].element.setAttribute("title",Te||""),Te?(L.records[ee[1]][ee[0]].element.classList.add("jss_comments"),L.options.comments||(L.options.comments={}),L.options.comments[oe]=Te):(L.records[ee[1]][ee[0]].element.classList.remove("jss_comments"),L.options.comments&&L.options.comments[oe]&&delete L.options.comments[oe])}),n.JB.call(L,{action:"setComments",newValue:j,oldValue:Y}),e.Z.call(L,"oncomments",L,j,Y)}],["orderBy",F.Xo],["undo",n.Yw],["redo",n.KX],["getCell",t.$S],["getCellFromCoords",t.Sl],["getLabel",t.id],["getConfig",function(){return this.options}],["setConfig",ce],["getMeta",function(A){return Fe.xZ.call(this,A)}],["setMeta",Fe.US],["showColumn",function(A){const K=this;Array.isArray(A)||(A=[A]);for(let L=0;L<A.length;L++){const j=A[L];K.headers[j].style.display="",K.cols[j].colElement.style.display="",K.filter&&K.filter.children.length>j+1&&(K.filter.children[j+1].style.display="");for(let Y=0;Y<K.options.data.length;Y++)K.records[Y][j].element.style.display=""}K.options.footers&&de.i.call(K),K.resetSelection()}],["hideColumn",function(A){const K=this;Array.isArray(A)||(A=[A]);for(let L=0;L<A.length;L++){const j=A[L];K.headers[j].style.display="none",K.cols[j].colElement.style.display="none",K.filter&&K.filter.children.length>j+1&&(K.filter.children[j+1].style.display="none");for(let Y=0;Y<K.options.data.length;Y++)K.records[Y][j].element.style.display="none"}K.options.footers&&de.i.call(K),K.resetSelection()}],["showIndex",t.UI],["hideIndex",t.TO],["getWorksheetActive",t.X0],["openEditor",s],["closeEditor",o],["createWorksheet",function(A){const K=this.parent;K.creationThroughJss=!0,he.call(this,A),K.element.tabs.create(A.worksheetName)}],["openWorksheet",function(A){this.parent.element.tabs.open(A)}],["deleteWorksheet",function(A){const K=this;K.parent.element.tabs.remove(A);const L=K.parent.worksheets.splice(A,1)[0];e.Z.call(K.parent,"ondeleteworksheet",L,A)}],["copy",function(A){A?qe():Z.call(this,!0)}],["paste",ve],["executeFormula",t.pX],["getDataFromRange",function(A,K){const L=this,j=(0,z.getCoordsFromRange)(A),Y=[];for(let oe=j[1];oe<=j[3];oe++){Y.push([]);for(let Te=j[0];Te<=j[2];Te++)K?Y[Y.length-1].push(L.records[oe][Te].element.innerHTML):Y[Y.length-1].push(L.options.data[oe][Te])}return Y}],["quantiyOfPages",bt.ur],["getRange",k.rx],["isSelected",k.VL],["setReadOnly",function(A,K){const L=this;let j;if(typeof A=="string"){const Y=(0,z.getCoordsFromCellName)(A);j=L.records[Y[1]][Y[0]]}else{const Y=parseInt(A.getAttribute("data-x")),oe=parseInt(A.getAttribute("data-y"));j=L.records[oe][Y]}K?j.element.classList.add("readonly"):j.element.classList.remove("readonly")}],["isReadOnly",function(A,K){return typeof A=="string"&&K===void 0&&([A,K]=(0,z.getCoordsFromCellName)(A)),this.records[K][A].element.classList.contains("readonly")}],["getHighlighted",k.VD],["dispatch",e.Z],["down",_],["first",N],["last",G],["left",O],["right",m],["up",d],["openFilter",xe.B4],["resetFilters",xe.aw]],je=Ae.length,ke=function(){};ke.spreadsheet=async function(A,K,L){if(A.tagName=="TABLE"){K||(K={}),K.worksheets||(K.worksheets=[]);const Y=(0,z.createFromTable)(A,K.worksheets[0]);K.worksheets[0]=Y;const oe=document.createElement("div");A.parentNode.insertBefore(oe,A),A.remove(),A=oe}let j={worksheets:L,config:K,element:A,el:A};return j.contextMenu=document.createElement("div"),j.contextMenu.className="jss_contextmenu",j.getWorksheetActive=t.X0.bind(j),j.fullscreen=t.Gr.bind(j),j.showToolbar=St.bv.bind(j),j.hideToolbar=St.iu.bind(j),j.getConfig=b.bind(j),j.setConfig=ce.bind(j),j.setPlugins=function(Y){j.plugins||(j.plugins={}),typeof Y=="object"&&Object.entries(Y).forEach(function([oe,Te]){j.plugins[oe]=Te.call(r.jspreadsheet,j,{},j.config)})},j.setPlugins(K.plugins),await async function(Y,oe,Te){let ee=oe.worksheets;if(!ee)throw new Error("JSS: worksheets are not defined");{let ye={animation:!0,onbeforecreate:function(pe,Re){return Re||re(Y)},oncreate:function(pe,Re){if(Y.creationThroughJss)Y.creationThroughJss=!1;else{const We=pe.tabs.headers.children[pe.tabs.headers.children.length-2].innerHTML;he.call(Y.worksheets[0],{minDimensions:[10,15],worksheetName:We})}const Ce=Y.worksheets[Y.worksheets.length-1];Ce.element=Re,me.call(Ce).then(function(){(0,St.yf)(Ce),e.Z.call(Ce,"oncreateworksheet",Ce,oe,Y.worksheets.length-1)})},onchange:function(pe,Re,Ce){Y.worksheets.length!=0&&Y.worksheets[Ce]&&(0,St.yf)(Y.worksheets[Ce])}};oe.tabs==1?ye.allowCreate=!0:ye.hideHeaders=!0,ye.data=[];let H=1;for(let pe=0;pe<ee.length;pe++)ee[pe].worksheetName||(ee[pe].worksheetName="Sheet"+H++),ye.data.push({title:ee[pe].worksheetName,content:""});Te.classList.add("jss_spreadsheet");const Q=jSuites.tabs(Te,ye);for(let pe=0;pe<ee.length;pe++)Y.worksheets.push({parent:Y,element:Q.content.children[pe],options:ee[pe],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await me.call(Y.worksheets[pe])}}(j,K,A),j.element.appendChild(j.contextMenu),jSuites.contextmenu(j.contextMenu,{onclick:function(){j.contextMenu.contextmenu.close(!1)}}),j.config.fullscreen==1&&j.element.classList.add("fullscreen"),St.bv.call(j),K.root?Ze(K.root):Ze(document),A.spreadsheet=j,j},ke.worksheet=function(A,K,L){let j={parent:A,options:{}};return L===void 0?A.worksheets.push(j):A.worksheets.splice(L,0,j),Object.assign(j.options,K),j};var et=ke;r.jspreadsheet=function(A,K){try{let L=[];return et.spreadsheet(A,K,L).then(j=>{r.jspreadsheet.spreadsheet.push(j),e.Z.call(j,"onload",j)}),L}catch(L){console.error(L)}},r.jspreadsheet.getWorksheetInstanceByName=function(A,K){const L=r.jspreadsheet.spreadsheet.find(j=>j.config.namespace===K);if(L)return{};if(A==null){const j=L.worksheets.map(Y=>[Y.options.worksheetName,Y]);return Object.fromEntries(j)}return L.worksheets.find(j=>j.options.worksheetName===A)},r.jspreadsheet.setDictionary=function(A){jSuites.setDictionary(A)},r.jspreadsheet.destroy=function(A,K){if(A.spreadsheet){const L=r.jspreadsheet.spreadsheet.indexOf(A.spreadsheet);r.jspreadsheet.spreadsheet.splice(L,1);const j=A.spreadsheet.config.root||document;A.spreadsheet=null,A.innerHTML="",K&&at(j)}},r.jspreadsheet.destroyAll=function(){for(let A=0;A<r.jspreadsheet.spreadsheet.length;A++){const K=r.jspreadsheet.spreadsheet[A];r.jspreadsheet.destroy(K.element)}},r.jspreadsheet.current=null,r.jspreadsheet.spreadsheet=[],r.jspreadsheet.helpers={},r.jspreadsheet.version=function(){return rt},Object.entries(z).forEach(([A,K])=>{r.jspreadsheet.helpers[A]=K});var pt=r.jspreadsheet})(),jspreadsheet=__webpack_exports__.default}(),jspreadsheet})}(dist$3)),dist$3.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs$3(distExports),extractWorksheetProperties=function(r){this.worksheets.push({minDimensions:[10,10],...r})};typeof window<"u"&&(window.jspreadsheet=jspreadsheet);const Spreadsheet=React.forwardRef((r,e)=>{const t=reactExports.useRef(null);let n={...r};n.worksheets||(n.worksheets=[],Array.isArray(r.children)?r.children.map(function(o){extractWorksheetProperties.call(n,o.props)}):r.children&&extractWorksheetProperties.call(n,r.children.props)),reactExports.useEffect(()=>{!t.current.textContent&&!e.current&&(e.current=jspreadsheet(t.current,n))},[]);let s={ref:t};return typeof n.id<"u"&&(s.id=n.id),React.createElement("div",s)});function Worksheet(){return null}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(r,e){return r.concat([e+"-"+start,e+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(r,e){return r.concat([e,e+"-"+start,e+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(r){return r?(r.nodeName||"").toLowerCase():null}function getWindow(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var e=r.ownerDocument;return e&&e.defaultView||window}return r}function isElement$1(r){var e=getWindow(r).Element;return r instanceof e||r instanceof Element}function isHTMLElement(r){var e=getWindow(r).HTMLElement;return r instanceof e||r instanceof HTMLElement}function isShadowRoot(r){if(typeof ShadowRoot>"u")return!1;var e=getWindow(r).ShadowRoot;return r instanceof e||r instanceof ShadowRoot}function applyStyles(r){var e=r.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},s=e.attributes[t]||{},o=e.elements[t];!isHTMLElement(o)||!getNodeName(o)||(Object.assign(o.style,n),Object.keys(s).forEach(function(a){var l=s[a];l===!1?o.removeAttribute(a):o.setAttribute(a,l===!0?"":l)}))})}function effect$2(r){var e=r.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(n){var s=e.elements[n],o=e.attributes[n]||{},a=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:t[n]),l=a.reduce(function(u,c){return u[c]="",u},{});!isHTMLElement(s)||!getNodeName(s)||(Object.assign(s.style,l),Object.keys(o).forEach(function(u){s.removeAttribute(u)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement$1(r){return r.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var n=r.getBoundingClientRect(),s=1,o=1;e&&isHTMLElement(r)&&(s=r.offsetWidth>0&&round(n.width)/r.offsetWidth||1,o=r.offsetHeight>0&&round(n.height)/r.offsetHeight||1);var a=isElement$1(r)?getWindow(r):window,l=a.visualViewport,u=!isLayoutViewport()&&t,c=(n.left+(u&&l?l.offsetLeft:0))/s,d=(n.top+(u&&l?l.offsetTop:0))/o,f=n.width/s,C=n.height/o;return{width:f,height:C,top:d,right:c+f,bottom:d+C,left:c,x:c,y:d}}function getLayoutRect(r){var e=getBoundingClientRect(r),t=r.offsetWidth,n=r.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:r.offsetLeft,y:r.offsetTop,width:t,height:n}}function contains(r,e){var t=e.getRootNode&&e.getRootNode();if(r.contains(e))return!0;if(t&&isShadowRoot(t)){var n=e;do{if(n&&r.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function getComputedStyle$1(r){return getWindow(r).getComputedStyle(r)}function isTableElement(r){return["table","td","th"].indexOf(getNodeName(r))>=0}function getDocumentElement(r){return((isElement$1(r)?r.ownerDocument:r.document)||window.document).documentElement}function getParentNode(r){return getNodeName(r)==="html"?r:r.assignedSlot||r.parentNode||(isShadowRoot(r)?r.host:null)||getDocumentElement(r)}function getTrueOffsetParent(r){return!isHTMLElement(r)||getComputedStyle$1(r).position==="fixed"?null:r.offsetParent}function getContainingBlock(r){var e=/firefox/i.test(getUAString()),t=/Trident/i.test(getUAString());if(t&&isHTMLElement(r)){var n=getComputedStyle$1(r);if(n.position==="fixed")return null}var s=getParentNode(r);for(isShadowRoot(s)&&(s=s.host);isHTMLElement(s)&&["html","body"].indexOf(getNodeName(s))<0;){var o=getComputedStyle$1(s);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return s;s=s.parentNode}return null}function getOffsetParent(r){for(var e=getWindow(r),t=getTrueOffsetParent(r);t&&isTableElement(t)&&getComputedStyle$1(t).position==="static";)t=getTrueOffsetParent(t);return t&&(getNodeName(t)==="html"||getNodeName(t)==="body"&&getComputedStyle$1(t).position==="static")?e:t||getContainingBlock(r)||e}function getMainAxisFromPlacement(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function within(r,e,t){return max(r,min(e,t))}function withinMaxClamp(r,e,t){var n=within(r,e,t);return n>t?t:n}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(r){return Object.assign({},getFreshSideObject(),r)}function expandToHashMap(r,e){return e.reduce(function(t,n){return t[n]=r,t},{})}var toPaddingObject=function r(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,mergePaddingObject(typeof e!="number"?e:expandToHashMap(e,basePlacements))};function arrow$1(r){var e,t=r.state,n=r.name,s=r.options,o=t.elements.arrow,a=t.modifiersData.popperOffsets,l=getBasePlacement$1(t.placement),u=getMainAxisFromPlacement(l),c=[left,right].indexOf(l)>=0,d=c?"height":"width";if(!(!o||!a)){var f=toPaddingObject(s.padding,t),C=getLayoutRect(o),m=u==="y"?top:left,E=u==="y"?bottom:right,v=t.rects.reference[d]+t.rects.reference[u]-a[u]-t.rects.popper[d],_=a[u]-t.rects.reference[u],T=getOffsetParent(o),R=T?u==="y"?T.clientHeight||0:T.clientWidth||0:0,O=v/2-_/2,N=f[m],G=R-C[d]-f[E],D=R/2-C[d]/2+O,k=within(N,D,G),z=u;t.modifiersData[n]=(e={},e[z]=k,e.centerOffset=k-D,e)}}function effect$1(r){var e=r.state,t=r.options,n=t.element,s=n===void 0?"[data-popper-arrow]":n;s!=null&&(typeof s=="string"&&(s=e.elements.popper.querySelector(s),!s)||contains(e.elements.popper,s)&&(e.elements.arrow=s))}const arrow$2={name:"arrow",enabled:!0,phase:"main",fn:arrow$1,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(r){return r.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(r,e){var t=r.x,n=r.y,s=e.devicePixelRatio||1;return{x:round(t*s)/s||0,y:round(n*s)/s||0}}function mapToStyles(r){var e,t=r.popper,n=r.popperRect,s=r.placement,o=r.variation,a=r.offsets,l=r.position,u=r.gpuAcceleration,c=r.adaptive,d=r.roundOffsets,f=r.isFixed,C=a.x,m=C===void 0?0:C,E=a.y,v=E===void 0?0:E,_=typeof d=="function"?d({x:m,y:v}):{x:m,y:v};m=_.x,v=_.y;var T=a.hasOwnProperty("x"),R=a.hasOwnProperty("y"),O=left,N=top,G=window;if(c){var D=getOffsetParent(t),k="clientHeight",z="clientWidth";if(D===getWindow(t)&&(D=getDocumentElement(t),getComputedStyle$1(D).position!=="static"&&l==="absolute"&&(k="scrollHeight",z="scrollWidth")),D=D,s===top||(s===left||s===right)&&o===end){N=bottom;var ne=f&&D===G&&G.visualViewport?G.visualViewport.height:D[k];v-=ne-n.height,v*=u?1:-1}if(s===left||(s===top||s===bottom)&&o===end){O=right;var Z=f&&D===G&&G.visualViewport?G.visualViewport.width:D[z];m-=Z-n.width,m*=u?1:-1}}var ve=Object.assign({position:l},c&&unsetSides),xe=d===!0?roundOffsetsByDPR({x:m,y:v},getWindow(t)):{x:m,y:v};if(m=xe.x,v=xe.y,u){var de;return Object.assign({},ve,(de={},de[N]=R?"0":"",de[O]=T?"0":"",de.transform=(G.devicePixelRatio||1)<=1?"translate("+m+"px, "+v+"px)":"translate3d("+m+"px, "+v+"px, 0)",de))}return Object.assign({},ve,(e={},e[N]=R?v+"px":"",e[O]=T?m+"px":"",e.transform="",e))}function computeStyles(r){var e=r.state,t=r.options,n=t.gpuAcceleration,s=n===void 0?!0:n,o=t.adaptive,a=o===void 0?!0:o,l=t.roundOffsets,u=l===void 0?!0:l,c={placement:getBasePlacement$1(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(r){var e=r.state,t=r.instance,n=r.options,s=n.scroll,o=s===void 0?!0:s,a=n.resize,l=a===void 0?!0:a,u=getWindow(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(d){d.addEventListener("scroll",t.update,passive)}),l&&u.addEventListener("resize",t.update,passive),function(){o&&c.forEach(function(d){d.removeEventListener("scroll",t.update,passive)}),l&&u.removeEventListener("resize",t.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function r(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(r){return r.replace(/left|right|bottom|top/g,function(e){return hash$1[e]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(r){return r.replace(/start|end/g,function(e){return hash[e]})}function getWindowScroll(r){var e=getWindow(r),t=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:t,scrollTop:n}}function getWindowScrollBarX(r){return getBoundingClientRect(getDocumentElement(r)).left+getWindowScroll(r).scrollLeft}function getViewportRect(r,e){var t=getWindow(r),n=getDocumentElement(r),s=t.visualViewport,o=n.clientWidth,a=n.clientHeight,l=0,u=0;if(s){o=s.width,a=s.height;var c=isLayoutViewport();(c||!c&&e==="fixed")&&(l=s.offsetLeft,u=s.offsetTop)}return{width:o,height:a,x:l+getWindowScrollBarX(r),y:u}}function getDocumentRect(r){var e,t=getDocumentElement(r),n=getWindowScroll(r),s=(e=r.ownerDocument)==null?void 0:e.body,o=max(t.scrollWidth,t.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),a=max(t.scrollHeight,t.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),l=-n.scrollLeft+getWindowScrollBarX(r),u=-n.scrollTop;return getComputedStyle$1(s||t).direction==="rtl"&&(l+=max(t.clientWidth,s?s.clientWidth:0)-o),{width:o,height:a,x:l,y:u}}function isScrollParent(r){var e=getComputedStyle$1(r),t=e.overflow,n=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+s+n)}function getScrollParent(r){return["html","body","#document"].indexOf(getNodeName(r))>=0?r.ownerDocument.body:isHTMLElement(r)&&isScrollParent(r)?r:getScrollParent(getParentNode(r))}function listScrollParents(r,e){var t;e===void 0&&(e=[]);var n=getScrollParent(r),s=n===((t=r.ownerDocument)==null?void 0:t.body),o=getWindow(n),a=s?[o].concat(o.visualViewport||[],isScrollParent(n)?n:[]):n,l=e.concat(a);return s?l:l.concat(listScrollParents(getParentNode(a)))}function rectToClientRect(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function getInnerBoundingClientRect(r,e){var t=getBoundingClientRect(r,!1,e==="fixed");return t.top=t.top+r.clientTop,t.left=t.left+r.clientLeft,t.bottom=t.top+r.clientHeight,t.right=t.left+r.clientWidth,t.width=r.clientWidth,t.height=r.clientHeight,t.x=t.left,t.y=t.top,t}function getClientRectFromMixedType(r,e,t){return e===viewport?rectToClientRect(getViewportRect(r,t)):isElement$1(e)?getInnerBoundingClientRect(e,t):rectToClientRect(getDocumentRect(getDocumentElement(r)))}function getClippingParents(r){var e=listScrollParents(getParentNode(r)),t=["absolute","fixed"].indexOf(getComputedStyle$1(r).position)>=0,n=t&&isHTMLElement(r)?getOffsetParent(r):r;return isElement$1(n)?e.filter(function(s){return isElement$1(s)&&contains(s,n)&&getNodeName(s)!=="body"}):[]}function getClippingRect(r,e,t,n){var s=e==="clippingParents"?getClippingParents(r):[].concat(e),o=[].concat(s,[t]),a=o[0],l=o.reduce(function(u,c){var d=getClientRectFromMixedType(r,c,n);return u.top=max(d.top,u.top),u.right=min(d.right,u.right),u.bottom=min(d.bottom,u.bottom),u.left=max(d.left,u.left),u},getClientRectFromMixedType(r,a,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function computeOffsets(r){var e=r.reference,t=r.element,n=r.placement,s=n?getBasePlacement$1(n):null,o=n?getVariation(n):null,a=e.x+e.width/2-t.width/2,l=e.y+e.height/2-t.height/2,u;switch(s){case top:u={x:a,y:e.y-t.height};break;case bottom:u={x:a,y:e.y+e.height};break;case right:u={x:e.x+e.width,y:l};break;case left:u={x:e.x-t.width,y:l};break;default:u={x:e.x,y:e.y}}var c=s?getMainAxisFromPlacement(s):null;if(c!=null){var d=c==="y"?"height":"width";switch(o){case start:u[c]=u[c]-(e[d]/2-t[d]/2);break;case end:u[c]=u[c]+(e[d]/2-t[d]/2);break}}return u}function detectOverflow(r,e){e===void 0&&(e={});var t=e,n=t.placement,s=n===void 0?r.placement:n,o=t.strategy,a=o===void 0?r.strategy:o,l=t.boundary,u=l===void 0?clippingParents:l,c=t.rootBoundary,d=c===void 0?viewport:c,f=t.elementContext,C=f===void 0?popper:f,m=t.altBoundary,E=m===void 0?!1:m,v=t.padding,_=v===void 0?0:v,T=mergePaddingObject(typeof _!="number"?_:expandToHashMap(_,basePlacements)),R=C===popper?reference:popper,O=r.rects.popper,N=r.elements[E?R:C],G=getClippingRect(isElement$1(N)?N:N.contextElement||getDocumentElement(r.elements.popper),u,d,a),D=getBoundingClientRect(r.elements.reference),k=computeOffsets({reference:D,element:O,strategy:"absolute",placement:s}),z=rectToClientRect(Object.assign({},O,k)),ne=C===popper?z:D,Z={top:G.top-ne.top+T.top,bottom:ne.bottom-G.bottom+T.bottom,left:G.left-ne.left+T.left,right:ne.right-G.right+T.right},ve=r.modifiersData.offset;if(C===popper&&ve){var xe=ve[s];Object.keys(Z).forEach(function(de){var Se=[right,bottom].indexOf(de)>=0?1:-1,Me=[top,bottom].indexOf(de)>=0?"y":"x";Z[de]+=xe[Me]*Se})}return Z}function computeAutoPlacement(r,e){e===void 0&&(e={});var t=e,n=t.placement,s=t.boundary,o=t.rootBoundary,a=t.padding,l=t.flipVariations,u=t.allowedAutoPlacements,c=u===void 0?placements:u,d=getVariation(n),f=d?l?variationPlacements:variationPlacements.filter(function(E){return getVariation(E)===d}):basePlacements,C=f.filter(function(E){return c.indexOf(E)>=0});C.length===0&&(C=f);var m=C.reduce(function(E,v){return E[v]=detectOverflow(r,{placement:v,boundary:s,rootBoundary:o,padding:a})[getBasePlacement$1(v)],E},{});return Object.keys(m).sort(function(E,v){return m[E]-m[v]})}function getExpandedFallbackPlacements(r){if(getBasePlacement$1(r)===auto)return[];var e=getOppositePlacement(r);return[getOppositeVariationPlacement(r),e,getOppositeVariationPlacement(e)]}function flip(r){var e=r.state,t=r.options,n=r.name;if(!e.modifiersData[n]._skip){for(var s=t.mainAxis,o=s===void 0?!0:s,a=t.altAxis,l=a===void 0?!0:a,u=t.fallbackPlacements,c=t.padding,d=t.boundary,f=t.rootBoundary,C=t.altBoundary,m=t.flipVariations,E=m===void 0?!0:m,v=t.allowedAutoPlacements,_=e.options.placement,T=getBasePlacement$1(_),R=T===_,O=u||(R||!E?[getOppositePlacement(_)]:getExpandedFallbackPlacements(_)),N=[_].concat(O).reduce(function(ue,Ne){return ue.concat(getBasePlacement$1(Ne)===auto?computeAutoPlacement(e,{placement:Ne,boundary:d,rootBoundary:f,padding:c,flipVariations:E,allowedAutoPlacements:v}):Ne)},[]),G=e.rects.reference,D=e.rects.popper,k=new Map,z=!0,ne=N[0],Z=0;Z<N.length;Z++){var ve=N[Z],xe=getBasePlacement$1(ve),de=getVariation(ve)===start,Se=[top,bottom].indexOf(xe)>=0,Me=Se?"width":"height",Pe=detectOverflow(e,{placement:ve,boundary:d,rootBoundary:f,altBoundary:C,padding:c}),_e=Se?de?right:left:de?bottom:top;G[Me]>D[Me]&&(_e=getOppositePlacement(_e));var Oe=getOppositePlacement(_e),st=[];if(o&&st.push(Pe[xe]<=0),l&&st.push(Pe[_e]<=0,Pe[Oe]<=0),st.every(function(ue){return ue})){ne=ve,z=!1;break}k.set(ve,st)}if(z)for(var rt=E?3:1,U=function(Ne){var Ge=N.find(function(Ue){var Ie=k.get(Ue);if(Ie)return Ie.slice(0,Ne).every(function(Ke){return Ke})});if(Ge)return ne=Ge,"break"},te=rt;te>0;te--){var V=U(te);if(V==="break")break}e.placement!==ne&&(e.modifiersData[n]._skip=!0,e.placement=ne,e.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(r,e,t){return t===void 0&&(t={x:0,y:0}),{top:r.top-e.height-t.y,right:r.right-e.width+t.x,bottom:r.bottom-e.height+t.y,left:r.left-e.width-t.x}}function isAnySideFullyClipped(r){return[top,right,bottom,left].some(function(e){return r[e]>=0})}function hide(r){var e=r.state,t=r.name,n=e.rects.reference,s=e.rects.popper,o=e.modifiersData.preventOverflow,a=detectOverflow(e,{elementContext:"reference"}),l=detectOverflow(e,{altBoundary:!0}),u=getSideOffsets(a,n),c=getSideOffsets(l,s,o),d=isAnySideFullyClipped(u),f=isAnySideFullyClipped(c);e.modifiersData[t]={referenceClippingOffsets:u,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(r,e,t){var n=getBasePlacement$1(r),s=[left,top].indexOf(n)>=0?-1:1,o=typeof t=="function"?t(Object.assign({},e,{placement:r})):t,a=o[0],l=o[1];return a=a||0,l=(l||0)*s,[left,right].indexOf(n)>=0?{x:l,y:a}:{x:a,y:l}}function offset(r){var e=r.state,t=r.options,n=r.name,s=t.offset,o=s===void 0?[0,0]:s,a=placements.reduce(function(d,f){return d[f]=distanceAndSkiddingToXY(f,e.rects,o),d},{}),l=a[e.placement],u=l.x,c=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=a}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(r){var e=r.state,t=r.name;e.modifiersData[t]=computeOffsets({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(r){return r==="x"?"y":"x"}function preventOverflow(r){var e=r.state,t=r.options,n=r.name,s=t.mainAxis,o=s===void 0?!0:s,a=t.altAxis,l=a===void 0?!1:a,u=t.boundary,c=t.rootBoundary,d=t.altBoundary,f=t.padding,C=t.tether,m=C===void 0?!0:C,E=t.tetherOffset,v=E===void 0?0:E,_=detectOverflow(e,{boundary:u,rootBoundary:c,padding:f,altBoundary:d}),T=getBasePlacement$1(e.placement),R=getVariation(e.placement),O=!R,N=getMainAxisFromPlacement(T),G=getAltAxis(N),D=e.modifiersData.popperOffsets,k=e.rects.reference,z=e.rects.popper,ne=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,Z=typeof ne=="number"?{mainAxis:ne,altAxis:ne}:Object.assign({mainAxis:0,altAxis:0},ne),ve=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,xe={x:0,y:0};if(D){if(o){var de,Se=N==="y"?top:left,Me=N==="y"?bottom:right,Pe=N==="y"?"height":"width",_e=D[N],Oe=_e+_[Se],st=_e-_[Me],rt=m?-z[Pe]/2:0,U=R===start?k[Pe]:z[Pe],te=R===start?-z[Pe]:-k[Pe],V=e.elements.arrow,ue=m&&V?getLayoutRect(V):{width:0,height:0},Ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:getFreshSideObject(),Ge=Ne[Se],Ue=Ne[Me],Ie=within(0,k[Pe],ue[Pe]),Ke=O?k[Pe]/2-rt-Ie-Ge-Z.mainAxis:U-Ie-Ge-Z.mainAxis,le=O?-k[Pe]/2+rt+Ie+Ue+Z.mainAxis:te+Ie+Ue+Z.mainAxis,ge=e.elements.arrow&&getOffsetParent(e.elements.arrow),we=ge?N==="y"?ge.clientTop||0:ge.clientLeft||0:0,qe=(de=ve==null?void 0:ve[N])!=null?de:0,$e=_e+Ke-qe-we,ze=_e+le-qe,it=within(m?min(Oe,$e):Oe,_e,m?max(st,ze):st);D[N]=it,xe[N]=it-_e}if(l){var Ve,Qe=N==="x"?top:left,nt=N==="x"?bottom:right,Ze=D[G],at=G==="y"?"height":"width",St=Ze+_[Qe],bt=Ze-_[nt],q=[top,left].indexOf(T)!==-1,X=(Ve=ve==null?void 0:ve[G])!=null?Ve:0,F=q?St:Ze-k[at]-z[at]-X+Z.altAxis,b=q?Ze+k[at]+z[at]-X-Z.altAxis:bt,ce=m&&q?withinMaxClamp(F,Ze,b):within(m?F:St,Ze,m?b:bt);D[G]=ce,xe[G]=ce-Ze}e.modifiersData[n]=xe}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function getNodeScroll(r){return r===getWindow(r)||!isHTMLElement(r)?getWindowScroll(r):getHTMLElementScroll(r)}function isElementScaled(r){var e=r.getBoundingClientRect(),t=round(e.width)/r.offsetWidth||1,n=round(e.height)/r.offsetHeight||1;return t!==1||n!==1}function getCompositeRect(r,e,t){t===void 0&&(t=!1);var n=isHTMLElement(e),s=isHTMLElement(e)&&isElementScaled(e),o=getDocumentElement(e),a=getBoundingClientRect(r,s,t),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!t)&&((getNodeName(e)!=="body"||isScrollParent(o))&&(l=getNodeScroll(e)),isHTMLElement(e)?(u=getBoundingClientRect(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):o&&(u.x=getWindowScrollBarX(o))),{x:a.left+l.scrollLeft-u.x,y:a.top+l.scrollTop-u.y,width:a.width,height:a.height}}function order(r){var e=new Map,t=new Set,n=[];r.forEach(function(o){e.set(o.name,o)});function s(o){t.add(o.name);var a=[].concat(o.requires||[],o.requiresIfExists||[]);a.forEach(function(l){if(!t.has(l)){var u=e.get(l);u&&s(u)}}),n.push(o)}return r.forEach(function(o){t.has(o.name)||s(o)}),n}function orderModifiers(r){var e=order(r);return modifierPhases.reduce(function(t,n){return t.concat(e.filter(function(s){return s.phase===n}))},[])}function debounce$1(r){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(r())})})),e}}function mergeByName(r){var e=r.reduce(function(t,n){var s=t[n.name];return t[n.name]=s?Object.assign({},s,n,{options:Object.assign({},s.options,n.options),data:Object.assign({},s.data,n.data)}):n,t},{});return Object.keys(e).map(function(t){return e[t]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function popperGenerator(r){r===void 0&&(r={});var e=r,t=e.defaultModifiers,n=t===void 0?[]:t,s=e.defaultOptions,o=s===void 0?DEFAULT_OPTIONS:s;return function(l,u,c){c===void 0&&(c=o);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,o),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},f=[],C=!1,m={state:d,setOptions:function(T){var R=typeof T=="function"?T(d.options):T;v(),d.options=Object.assign({},o,d.options,R),d.scrollParents={reference:isElement$1(l)?listScrollParents(l):l.contextElement?listScrollParents(l.contextElement):[],popper:listScrollParents(u)};var O=orderModifiers(mergeByName([].concat(n,d.options.modifiers)));return d.orderedModifiers=O.filter(function(N){return N.enabled}),E(),m.update()},forceUpdate:function(){if(!C){var T=d.elements,R=T.reference,O=T.popper;if(areValidElements(R,O)){d.rects={reference:getCompositeRect(R,getOffsetParent(O),d.options.strategy==="fixed"),popper:getLayoutRect(O)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(Z){return d.modifiersData[Z.name]=Object.assign({},Z.data)});for(var N=0;N<d.orderedModifiers.length;N++){if(d.reset===!0){d.reset=!1,N=-1;continue}var G=d.orderedModifiers[N],D=G.fn,k=G.options,z=k===void 0?{}:k,ne=G.name;typeof D=="function"&&(d=D({state:d,options:z,name:ne,instance:m})||d)}}}},update:debounce$1(function(){return new Promise(function(_){m.forceUpdate(),_(d)})}),destroy:function(){v(),C=!0}};if(!areValidElements(l,u))return m;m.setOptions(c).then(function(_){!C&&c.onFirstUpdate&&c.onFirstUpdate(_)});function E(){d.orderedModifiers.forEach(function(_){var T=_.name,R=_.options,O=R===void 0?{}:R,N=_.effect;if(typeof N=="function"){var G=N({state:d,name:T,instance:m,options:O}),D=function(){};f.push(G||D)}})}function v(){f.forEach(function(_){return _()}),f=[]}return m}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$2,hide$1],createPopper=popperGenerator({defaultModifiers}),BOX_CLASS="tippy-box",CONTENT_CLASS="tippy-content",BACKDROP_CLASS="tippy-backdrop",ARROW_CLASS="tippy-arrow",SVG_ARROW_CLASS="tippy-svg-arrow",TOUCH_OPTIONS={passive:!0,capture:!0},TIPPY_DEFAULT_APPEND_TO=function r(){return document.body};function getValueAtIndexOrReturn(r,e,t){if(Array.isArray(r)){var n=r[e];return n??(Array.isArray(t)?t[e]:t)}return r}function isType(r,e){var t={}.toString.call(r);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function invokeWithArgsOrReturn(r,e){return typeof r=="function"?r.apply(void 0,e):r}function debounce(r,e){if(e===0)return r;var t;return function(n){clearTimeout(t),t=setTimeout(function(){r(n)},e)}}function splitBySpaces(r){return r.split(/\s+/).filter(Boolean)}function normalizeToArray(r){return[].concat(r)}function pushIfUnique(r,e){r.indexOf(e)===-1&&r.push(e)}function unique(r){return r.filter(function(e,t){return r.indexOf(e)===t})}function getBasePlacement(r){return r.split("-")[0]}function arrayFrom(r){return[].slice.call(r)}function removeUndefinedProps(r){return Object.keys(r).reduce(function(e,t){return r[t]!==void 0&&(e[t]=r[t]),e},{})}function div(){return document.createElement("div")}function isElement(r){return["Element","Fragment"].some(function(e){return isType(r,e)})}function isNodeList(r){return isType(r,"NodeList")}function isMouseEvent(r){return isType(r,"MouseEvent")}function isReferenceElement(r){return!!(r&&r._tippy&&r._tippy.reference===r)}function getArrayOfElements(r){return isElement(r)?[r]:isNodeList(r)?arrayFrom(r):Array.isArray(r)?r:arrayFrom(document.querySelectorAll(r))}function setTransitionDuration(r,e){r.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function setVisibilityState(r,e){r.forEach(function(t){t&&t.setAttribute("data-state",e)})}function getOwnerDocument(r){var e,t=normalizeToArray(r),n=t[0];return n!=null&&(e=n.ownerDocument)!=null&&e.body?n.ownerDocument:document}function isCursorOutsideInteractiveBorder(r,e){var t=e.clientX,n=e.clientY;return r.every(function(s){var o=s.popperRect,a=s.popperState,l=s.props,u=l.interactiveBorder,c=getBasePlacement(a.placement),d=a.modifiersData.offset;if(!d)return!0;var f=c==="bottom"?d.top.y:0,C=c==="top"?d.bottom.y:0,m=c==="right"?d.left.x:0,E=c==="left"?d.right.x:0,v=o.top-n+f>u,_=n-o.bottom-C>u,T=o.left-t+m>u,R=t-o.right-E>u;return v||_||T||R})}function updateTransitionEndListener(r,e,t){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(s){r[n](s,t)})}function actualContains(r,e){for(var t=e;t;){var n;if(r.contains(t))return!0;t=t.getRootNode==null||(n=t.getRootNode())==null?void 0:n.host}return!1}var currentInput={isTouch:!1},lastMouseMoveTime=0;function onDocumentTouchStart(){currentInput.isTouch||(currentInput.isTouch=!0,window.performance&&document.addEventListener("mousemove",onDocumentMouseMove))}function onDocumentMouseMove(){var r=performance.now();r-lastMouseMoveTime<20&&(currentInput.isTouch=!1,document.removeEventListener("mousemove",onDocumentMouseMove)),lastMouseMoveTime=r}function onWindowBlur(){var r=document.activeElement;if(isReferenceElement(r)){var e=r._tippy;r.blur&&!e.state.isVisible&&r.blur()}}function bindGlobalEventListeners(){document.addEventListener("touchstart",onDocumentTouchStart,TOUCH_OPTIONS),window.addEventListener("blur",onWindowBlur)}var isBrowser$1=typeof window<"u"&&typeof document<"u",isIE11=isBrowser$1?!!window.msCrypto:!1,pluginProps={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},renderProps={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},defaultProps=Object.assign({appendTo:TIPPY_DEFAULT_APPEND_TO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function r(){},onBeforeUpdate:function r(){},onCreate:function r(){},onDestroy:function r(){},onHidden:function r(){},onHide:function r(){},onMount:function r(){},onShow:function r(){},onShown:function r(){},onTrigger:function r(){},onUntrigger:function r(){},onClickOutside:function r(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},pluginProps,renderProps),defaultKeys=Object.keys(defaultProps),setDefaultProps=function r(e){var t=Object.keys(e);t.forEach(function(n){defaultProps[n]=e[n]})};function getExtendedPassedProps(r){var e=r.plugins||[],t=e.reduce(function(n,s){var o=s.name,a=s.defaultValue;if(o){var l;n[o]=r[o]!==void 0?r[o]:(l=defaultProps[o])!=null?l:a}return n},{});return Object.assign({},r,t)}function getDataAttributeProps(r,e){var t=e?Object.keys(getExtendedPassedProps(Object.assign({},defaultProps,{plugins:e}))):defaultKeys,n=t.reduce(function(s,o){var a=(r.getAttribute("data-tippy-"+o)||"").trim();if(!a)return s;if(o==="content")s[o]=a;else try{s[o]=JSON.parse(a)}catch{s[o]=a}return s},{});return n}function evaluateProps(r,e){var t=Object.assign({},e,{content:invokeWithArgsOrReturn(e.content,[r])},e.ignoreAttributes?{}:getDataAttributeProps(r,e.plugins));return t.aria=Object.assign({},defaultProps.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var innerHTML=function r(){return"innerHTML"};function dangerouslySetInnerHTML(r,e){r[innerHTML()]=e}function createArrowElement(r){var e=div();return r===!0?e.className=ARROW_CLASS:(e.className=SVG_ARROW_CLASS,isElement(r)?e.appendChild(r):dangerouslySetInnerHTML(e,r)),e}function setContent$1(r,e){isElement(e.content)?(dangerouslySetInnerHTML(r,""),r.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?dangerouslySetInnerHTML(r,e.content):r.textContent=e.content)}function getChildren(r){var e=r.firstElementChild,t=arrayFrom(e.children);return{box:e,content:t.find(function(n){return n.classList.contains(CONTENT_CLASS)}),arrow:t.find(function(n){return n.classList.contains(ARROW_CLASS)||n.classList.contains(SVG_ARROW_CLASS)}),backdrop:t.find(function(n){return n.classList.contains(BACKDROP_CLASS)})}}function render(r){var e=div(),t=div();t.className=BOX_CLASS,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var n=div();n.className=CONTENT_CLASS,n.setAttribute("data-state","hidden"),setContent$1(n,r.props),e.appendChild(t),t.appendChild(n),s(r.props,r.props);function s(o,a){var l=getChildren(e),u=l.box,c=l.content,d=l.arrow;a.theme?u.setAttribute("data-theme",a.theme):u.removeAttribute("data-theme"),typeof a.animation=="string"?u.setAttribute("data-animation",a.animation):u.removeAttribute("data-animation"),a.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof a.maxWidth=="number"?a.maxWidth+"px":a.maxWidth,a.role?u.setAttribute("role",a.role):u.removeAttribute("role"),(o.content!==a.content||o.allowHTML!==a.allowHTML)&&setContent$1(c,r.props),a.arrow?d?o.arrow!==a.arrow&&(u.removeChild(d),u.appendChild(createArrowElement(a.arrow))):u.appendChild(createArrowElement(a.arrow)):d&&u.removeChild(d)}return{popper:e,onUpdate:s}}render.$$tippy=!0;var idCounter=1,mouseMoveListeners=[],mountedInstances=[];function createTippy(r,e){var t=evaluateProps(r,Object.assign({},defaultProps,getExtendedPassedProps(removeUndefinedProps(e)))),n,s,o,a=!1,l=!1,u=!1,c=!1,d,f,C,m=[],E=debounce($e,t.interactiveDebounce),v,_=idCounter++,T=null,R=unique(t.plugins),O={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},N={id:_,reference:r,popper:div(),popperInstance:T,props:t,state:O,plugins:R,clearDelayTimeouts:F,setProps:b,setContent:ce,show:Fe,hide:Le,hideWithInteractivity:ae,enable:q,disable:X,unmount:re,destroy:me};if(!t.render)return N;var G=t.render(N),D=G.popper,k=G.onUpdate;D.setAttribute("data-tippy-root",""),D.id="tippy-"+N.id,N.popper=D,r._tippy=N,D._tippy=N;var z=R.map(function(he){return he.fn(N)}),ne=r.hasAttribute("aria-expanded");return ge(),rt(),_e(),Oe("onCreate",[N]),t.showOnCreate&&St(),D.addEventListener("mouseenter",function(){N.props.interactive&&N.state.isVisible&&N.clearDelayTimeouts()}),D.addEventListener("mouseleave",function(){N.props.interactive&&N.props.trigger.indexOf("mouseenter")>=0&&Se().addEventListener("mousemove",E)}),N;function Z(){var he=N.props.touch;return Array.isArray(he)?he:[he,0]}function ve(){return Z()[0]==="hold"}function xe(){var he;return!!((he=N.props.render)!=null&&he.$$tippy)}function de(){return v||r}function Se(){var he=de().parentNode;return he?getOwnerDocument(he):document}function Me(){return getChildren(D)}function Pe(he){return N.state.isMounted&&!N.state.isVisible||currentInput.isTouch||d&&d.type==="focus"?0:getValueAtIndexOrReturn(N.props.delay,he?0:1,defaultProps.delay)}function _e(he){he===void 0&&(he=!1),D.style.pointerEvents=N.props.interactive&&!he?"":"none",D.style.zIndex=""+N.props.zIndex}function Oe(he,Ae,je){if(je===void 0&&(je=!0),z.forEach(function(et){et[he]&&et[he].apply(et,Ae)}),je){var ke;(ke=N.props)[he].apply(ke,Ae)}}function st(){var he=N.props.aria;if(he.content){var Ae="aria-"+he.content,je=D.id,ke=normalizeToArray(N.props.triggerTarget||r);ke.forEach(function(et){var pt=et.getAttribute(Ae);if(N.state.isVisible)et.setAttribute(Ae,pt?pt+" "+je:je);else{var A=pt&&pt.replace(je,"").trim();A?et.setAttribute(Ae,A):et.removeAttribute(Ae)}})}}function rt(){if(!(ne||!N.props.aria.expanded)){var he=normalizeToArray(N.props.triggerTarget||r);he.forEach(function(Ae){N.props.interactive?Ae.setAttribute("aria-expanded",N.state.isVisible&&Ae===de()?"true":"false"):Ae.removeAttribute("aria-expanded")})}}function U(){Se().removeEventListener("mousemove",E),mouseMoveListeners=mouseMoveListeners.filter(function(he){return he!==E})}function te(he){if(!(currentInput.isTouch&&(u||he.type==="mousedown"))){var Ae=he.composedPath&&he.composedPath()[0]||he.target;if(!(N.props.interactive&&actualContains(D,Ae))){if(normalizeToArray(N.props.triggerTarget||r).some(function(je){return actualContains(je,Ae)})){if(currentInput.isTouch||N.state.isVisible&&N.props.trigger.indexOf("click")>=0)return}else Oe("onClickOutside",[N,he]);N.props.hideOnClick===!0&&(N.clearDelayTimeouts(),N.hide(),l=!0,setTimeout(function(){l=!1}),N.state.isMounted||Ge())}}}function V(){u=!0}function ue(){u=!1}function Ne(){var he=Se();he.addEventListener("mousedown",te,!0),he.addEventListener("touchend",te,TOUCH_OPTIONS),he.addEventListener("touchstart",ue,TOUCH_OPTIONS),he.addEventListener("touchmove",V,TOUCH_OPTIONS)}function Ge(){var he=Se();he.removeEventListener("mousedown",te,!0),he.removeEventListener("touchend",te,TOUCH_OPTIONS),he.removeEventListener("touchstart",ue,TOUCH_OPTIONS),he.removeEventListener("touchmove",V,TOUCH_OPTIONS)}function Ue(he,Ae){Ke(he,function(){!N.state.isVisible&&D.parentNode&&D.parentNode.contains(D)&&Ae()})}function Ie(he,Ae){Ke(he,Ae)}function Ke(he,Ae){var je=Me().box;function ke(et){et.target===je&&(updateTransitionEndListener(je,"remove",ke),Ae())}if(he===0)return Ae();updateTransitionEndListener(je,"remove",f),updateTransitionEndListener(je,"add",ke),f=ke}function le(he,Ae,je){je===void 0&&(je=!1);var ke=normalizeToArray(N.props.triggerTarget||r);ke.forEach(function(et){et.addEventListener(he,Ae,je),m.push({node:et,eventType:he,handler:Ae,options:je})})}function ge(){ve()&&(le("touchstart",qe,{passive:!0}),le("touchend",ze,{passive:!0})),splitBySpaces(N.props.trigger).forEach(function(he){if(he!=="manual")switch(le(he,qe),he){case"mouseenter":le("mouseleave",ze);break;case"focus":le(isIE11?"focusout":"blur",it);break;case"focusin":le("focusout",it);break}})}function we(){m.forEach(function(he){var Ae=he.node,je=he.eventType,ke=he.handler,et=he.options;Ae.removeEventListener(je,ke,et)}),m=[]}function qe(he){var Ae,je=!1;if(!(!N.state.isEnabled||Ve(he)||l)){var ke=((Ae=d)==null?void 0:Ae.type)==="focus";d=he,v=he.currentTarget,rt(),!N.state.isVisible&&isMouseEvent(he)&&mouseMoveListeners.forEach(function(et){return et(he)}),he.type==="click"&&(N.props.trigger.indexOf("mouseenter")<0||a)&&N.props.hideOnClick!==!1&&N.state.isVisible?je=!0:St(he),he.type==="click"&&(a=!je),je&&!ke&&bt(he)}}function $e(he){var Ae=he.target,je=de().contains(Ae)||D.contains(Ae);if(!(he.type==="mousemove"&&je)){var ke=at().concat(D).map(function(et){var pt,A=et._tippy,K=(pt=A.popperInstance)==null?void 0:pt.state;return K?{popperRect:et.getBoundingClientRect(),popperState:K,props:t}:null}).filter(Boolean);isCursorOutsideInteractiveBorder(ke,he)&&(U(),bt(he))}}function ze(he){var Ae=Ve(he)||N.props.trigger.indexOf("click")>=0&&a;if(!Ae){if(N.props.interactive){N.hideWithInteractivity(he);return}bt(he)}}function it(he){N.props.trigger.indexOf("focusin")<0&&he.target!==de()||N.props.interactive&&he.relatedTarget&&D.contains(he.relatedTarget)||bt(he)}function Ve(he){return currentInput.isTouch?ve()!==he.type.indexOf("touch")>=0:!1}function Qe(){nt();var he=N.props,Ae=he.popperOptions,je=he.placement,ke=he.offset,et=he.getReferenceClientRect,pt=he.moveTransition,A=xe()?getChildren(D).arrow:null,K=et?{getBoundingClientRect:et,contextElement:et.contextElement||de()}:r,L={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(oe){var Te=oe.state;if(xe()){var ee=Me(),ye=ee.box;["placement","reference-hidden","escaped"].forEach(function(H){H==="placement"?ye.setAttribute("data-placement",Te.placement):Te.attributes.popper["data-popper-"+H]?ye.setAttribute("data-"+H,""):ye.removeAttribute("data-"+H)}),Te.attributes.popper={}}}},j=[{name:"offset",options:{offset:ke}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!pt}},L];xe()&&A&&j.push({name:"arrow",options:{element:A,padding:3}}),j.push.apply(j,(Ae==null?void 0:Ae.modifiers)||[]),N.popperInstance=createPopper(K,D,Object.assign({},Ae,{placement:je,onFirstUpdate:C,modifiers:j}))}function nt(){N.popperInstance&&(N.popperInstance.destroy(),N.popperInstance=null)}function Ze(){var he=N.props.appendTo,Ae,je=de();N.props.interactive&&he===TIPPY_DEFAULT_APPEND_TO||he==="parent"?Ae=je.parentNode:Ae=invokeWithArgsOrReturn(he,[je]),Ae.contains(D)||Ae.appendChild(D),N.state.isMounted=!0,Qe()}function at(){return arrayFrom(D.querySelectorAll("[data-tippy-root]"))}function St(he){N.clearDelayTimeouts(),he&&Oe("onTrigger",[N,he]),Ne();var Ae=Pe(!0),je=Z(),ke=je[0],et=je[1];currentInput.isTouch&&ke==="hold"&&et&&(Ae=et),Ae?n=setTimeout(function(){N.show()},Ae):N.show()}function bt(he){if(N.clearDelayTimeouts(),Oe("onUntrigger",[N,he]),!N.state.isVisible){Ge();return}if(!(N.props.trigger.indexOf("mouseenter")>=0&&N.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(he.type)>=0&&a)){var Ae=Pe(!1);Ae?s=setTimeout(function(){N.state.isVisible&&N.hide()},Ae):o=requestAnimationFrame(function(){N.hide()})}}function q(){N.state.isEnabled=!0}function X(){N.hide(),N.state.isEnabled=!1}function F(){clearTimeout(n),clearTimeout(s),cancelAnimationFrame(o)}function b(he){if(!N.state.isDestroyed){Oe("onBeforeUpdate",[N,he]),we();var Ae=N.props,je=evaluateProps(r,Object.assign({},Ae,removeUndefinedProps(he),{ignoreAttributes:!0}));N.props=je,ge(),Ae.interactiveDebounce!==je.interactiveDebounce&&(U(),E=debounce($e,je.interactiveDebounce)),Ae.triggerTarget&&!je.triggerTarget?normalizeToArray(Ae.triggerTarget).forEach(function(ke){ke.removeAttribute("aria-expanded")}):je.triggerTarget&&r.removeAttribute("aria-expanded"),rt(),_e(),k&&k(Ae,je),N.popperInstance&&(Qe(),at().forEach(function(ke){requestAnimationFrame(ke._tippy.popperInstance.forceUpdate)})),Oe("onAfterUpdate",[N,he])}}function ce(he){N.setProps({content:he})}function Fe(){var he=N.state.isVisible,Ae=N.state.isDestroyed,je=!N.state.isEnabled,ke=currentInput.isTouch&&!N.props.touch,et=getValueAtIndexOrReturn(N.props.duration,0,defaultProps.duration);if(!(he||Ae||je||ke)&&!de().hasAttribute("disabled")&&(Oe("onShow",[N],!1),N.props.onShow(N)!==!1)){if(N.state.isVisible=!0,xe()&&(D.style.visibility="visible"),_e(),Ne(),N.state.isMounted||(D.style.transition="none"),xe()){var pt=Me(),A=pt.box,K=pt.content;setTransitionDuration([A,K],0)}C=function(){var j;if(!(!N.state.isVisible||c)){if(c=!0,D.offsetHeight,D.style.transition=N.props.moveTransition,xe()&&N.props.animation){var Y=Me(),oe=Y.box,Te=Y.content;setTransitionDuration([oe,Te],et),setVisibilityState([oe,Te],"visible")}st(),rt(),pushIfUnique(mountedInstances,N),(j=N.popperInstance)==null||j.forceUpdate(),Oe("onMount",[N]),N.props.animation&&xe()&&Ie(et,function(){N.state.isShown=!0,Oe("onShown",[N])})}},Ze()}}function Le(){var he=!N.state.isVisible,Ae=N.state.isDestroyed,je=!N.state.isEnabled,ke=getValueAtIndexOrReturn(N.props.duration,1,defaultProps.duration);if(!(he||Ae||je)&&(Oe("onHide",[N],!1),N.props.onHide(N)!==!1)){if(N.state.isVisible=!1,N.state.isShown=!1,c=!1,a=!1,xe()&&(D.style.visibility="hidden"),U(),Ge(),_e(!0),xe()){var et=Me(),pt=et.box,A=et.content;N.props.animation&&(setTransitionDuration([pt,A],ke),setVisibilityState([pt,A],"hidden"))}st(),rt(),N.props.animation?xe()&&Ue(ke,N.unmount):N.unmount()}}function ae(he){Se().addEventListener("mousemove",E),pushIfUnique(mouseMoveListeners,E),E(he)}function re(){N.state.isVisible&&N.hide(),N.state.isMounted&&(nt(),at().forEach(function(he){he._tippy.unmount()}),D.parentNode&&D.parentNode.removeChild(D),mountedInstances=mountedInstances.filter(function(he){return he!==N}),N.state.isMounted=!1,Oe("onHidden",[N]))}function me(){N.state.isDestroyed||(N.clearDelayTimeouts(),N.unmount(),we(),delete r._tippy,N.state.isDestroyed=!0,Oe("onDestroy",[N]))}}function tippy(r,e){e===void 0&&(e={});var t=defaultProps.plugins.concat(e.plugins||[]);bindGlobalEventListeners();var n=Object.assign({},e,{plugins:t}),s=getArrayOfElements(r),o=s.reduce(function(a,l){var u=l&&createTippy(l,n);return u&&a.push(u),a},[]);return isElement(r)?o[0]:o}tippy.defaultProps=defaultProps;tippy.setDefaultProps=setDefaultProps;tippy.currentInput=currentInput;Object.assign({},applyStyles$1,{effect:function r(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}});tippy.setDefaultProps({render});function _objectWithoutPropertiesLoose(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}var isBrowser=typeof window<"u"&&typeof document<"u";function preserveRef(r,e){r&&(typeof r=="function"&&r(e),{}.hasOwnProperty.call(r,"current")&&(r.current=e))}function ssrSafeCreateDiv(){return isBrowser&&document.createElement("div")}function toDataAttributes(r){var e={"data-placement":r.placement};return r.referenceHidden&&(e["data-reference-hidden"]=""),r.escaped&&(e["data-escaped"]=""),e}function deepEqual$1(r,e){if(r===e)return!0;if(typeof r=="object"&&r!=null&&typeof e=="object"&&e!=null){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(var t in r)if(e.hasOwnProperty(t)){if(!deepEqual$1(r[t],e[t]))return!1}else return!1;return!0}else return!1}function uniqueByShape(r){var e=[];return r.forEach(function(t){e.find(function(n){return deepEqual$1(t,n)})||e.push(t)}),e}function deepPreserveProps(r,e){var t,n;return Object.assign({},e,{popperOptions:Object.assign({},r.popperOptions,e.popperOptions,{modifiers:uniqueByShape([].concat(((t=r.popperOptions)==null?void 0:t.modifiers)||[],((n=e.popperOptions)==null?void 0:n.modifiers)||[]))})})}var useIsomorphicLayoutEffect$1=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableBox(r){var e=reactExports.useRef();return e.current||(e.current=typeof r=="function"?r():r),e.current}function updateClassName(r,e,t){t.split(/\s+/).forEach(function(n){n&&r.classList[e](n)})}var classNamePlugin={name:"className",defaultValue:"",fn:function r(e){var t=e.popper.firstElementChild,n=function(){var l;return!!((l=e.props.render)!=null&&l.$$tippy)};function s(){e.props.className&&!n()||updateClassName(t,"add",e.props.className)}function o(){n()&&updateClassName(t,"remove",e.props.className)}return{onCreate:s,onBeforeUpdate:o,onAfterUpdate:s}}};function TippyGenerator(r){function e(t){var n=t.children,s=t.content,o=t.visible,a=t.singleton,l=t.render,u=t.reference,c=t.disabled,d=c===void 0?!1:c,f=t.ignoreAttributes,C=f===void 0?!0:f;t.__source,t.__self;var m=_objectWithoutPropertiesLoose(t,["children","content","visible","singleton","render","reference","disabled","ignoreAttributes","__source","__self"]),E=o!==void 0,v=a!==void 0,_=reactExports.useState(!1),T=_[0],R=_[1],O=reactExports.useState({}),N=O[0],G=O[1],D=reactExports.useState(),k=D[0],z=D[1],ne=useMutableBox(function(){return{container:ssrSafeCreateDiv(),renders:1}}),Z=Object.assign({ignoreAttributes:C},m,{content:ne.container});E&&(Z.trigger="manual",Z.hideOnClick=!1),v&&(d=!0);var ve=Z,xe=Z.plugins||[];l&&(ve=Object.assign({},Z,{plugins:v&&a.data!=null?[].concat(xe,[{fn:function(){return{onTrigger:function(Pe,_e){var Oe=a.data.children.find(function(st){var rt=st.instance;return rt.reference===_e.currentTarget});Pe.state.$$activeSingletonInstance=Oe.instance,z(Oe.content)}}}}]):xe,render:function(){return{popper:ne.container}}}));var de=[u].concat(n?[n.type]:[]);return useIsomorphicLayoutEffect$1(function(){var Se=u;u&&u.hasOwnProperty("current")&&(Se=u.current);var Me=r(Se||ne.ref||ssrSafeCreateDiv(),Object.assign({},ve,{plugins:[classNamePlugin].concat(Z.plugins||[])}));return ne.instance=Me,d&&Me.disable(),o&&Me.show(),v&&a.hook({instance:Me,content:s,props:ve,setSingletonContent:z}),R(!0),function(){Me.destroy(),a==null||a.cleanup(Me)}},de),useIsomorphicLayoutEffect$1(function(){var Se;if(ne.renders===1){ne.renders++;return}var Me=ne.instance;Me.setProps(deepPreserveProps(Me.props,ve)),(Se=Me.popperInstance)==null||Se.forceUpdate(),d?Me.disable():Me.enable(),E&&(o?Me.show():Me.hide()),v&&a.hook({instance:Me,content:s,props:ve,setSingletonContent:z})}),useIsomorphicLayoutEffect$1(function(){var Se;if(l){var Me=ne.instance;Me.setProps({popperOptions:Object.assign({},Me.props.popperOptions,{modifiers:[].concat((((Se=Me.props.popperOptions)==null?void 0:Se.modifiers)||[]).filter(function(Pe){var _e=Pe.name;return _e!=="$$tippyReact"}),[{name:"$$tippyReact",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(_e){var Oe,st=_e.state,rt=(Oe=st.modifiersData)==null?void 0:Oe.hide;(N.placement!==st.placement||N.referenceHidden!==(rt==null?void 0:rt.isReferenceHidden)||N.escaped!==(rt==null?void 0:rt.hasPopperEscaped))&&G({placement:st.placement,referenceHidden:rt==null?void 0:rt.isReferenceHidden,escaped:rt==null?void 0:rt.hasPopperEscaped}),st.attributes.popper={}}}])})})}},[N.placement,N.referenceHidden,N.escaped].concat(de)),React.createElement(React.Fragment,null,n?reactExports.cloneElement(n,{ref:function(Me){ne.ref=Me,preserveRef(n.ref,Me)}}):null,T&&reactDomExports.createPortal(l?l(toDataAttributes(N),k,ne.instance):s,ne.container))}return e}var forwardRef=function(r,e){return reactExports.forwardRef(function(n,s){var o=n.children,a=_objectWithoutPropertiesLoose(n,["children"]);return React.createElement(r,Object.assign({},e,a),o?reactExports.cloneElement(o,{ref:function(u){preserveRef(s,u),preserveRef(o.ref,u)}}):null)})},index=forwardRef(TippyGenerator(tippy));function OrderedMap(r){this.content=r}OrderedMap.prototype={constructor:OrderedMap,find:function(r){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===r)return e;return-1},get:function(r){var e=this.find(r);return e==-1?void 0:this.content[e+1]},update:function(r,e,t){var n=t&&t!=r?this.remove(t):this,s=n.find(r),o=n.content.slice();return s==-1?o.push(t||r,e):(o[s+1]=e,t&&(o[s]=t)),new OrderedMap(o)},remove:function(r){var e=this.find(r);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new OrderedMap(t)},addToStart:function(r,e){return new OrderedMap([r,e].concat(this.remove(r).content))},addToEnd:function(r,e){var t=this.remove(r).content.slice();return t.push(r,e),new OrderedMap(t)},addBefore:function(r,e,t){var n=this.remove(e),s=n.content.slice(),o=n.find(r);return s.splice(o==-1?s.length:o,0,e,t),new OrderedMap(s)},forEach:function(r){for(var e=0;e<this.content.length;e+=2)r(this.content[e],this.content[e+1])},prepend:function(r){return r=OrderedMap.from(r),r.size?new OrderedMap(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=OrderedMap.from(r),r.size?new OrderedMap(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var e=this;r=OrderedMap.from(r);for(var t=0;t<r.content.length;t+=2)e=e.remove(r.content[t]);return e},toObject:function(){var r={};return this.forEach(function(e,t){r[e]=t}),r},get size(){return this.content.length>>1}};OrderedMap.from=function(r){if(r instanceof OrderedMap)return r;var e=[];if(r)for(var t in r)e.push(t,r[t]);return new OrderedMap(e)};function findDiffStart(r,e,t){for(let n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;let s=r.child(n),o=e.child(n);if(s==o){t+=s.nodeSize;continue}if(!s.sameMarkup(o))return t;if(s.isText&&s.text!=o.text){for(let a=0;s.text[a]==o.text[a];a++)t++;return t}if(s.content.size||o.content.size){let a=findDiffStart(s.content,o.content,t+1);if(a!=null)return a}t+=s.nodeSize}}function findDiffEnd(r,e,t,n){for(let s=r.childCount,o=e.childCount;;){if(s==0||o==0)return s==o?null:{a:t,b:n};let a=r.child(--s),l=e.child(--o),u=a.nodeSize;if(a==l){t-=u,n-=u;continue}if(!a.sameMarkup(l))return{a:t,b:n};if(a.isText&&a.text!=l.text){let c=0,d=Math.min(a.text.length,l.text.length);for(;c<d&&a.text[a.text.length-c-1]==l.text[l.text.length-c-1];)c++,t--,n--;return{a:t,b:n}}if(a.content.size||l.content.size){let c=findDiffEnd(a.content,l.content,t-1,n-1);if(c)return c}t-=u,n-=u}}class Fragment{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,s=0,o){for(let a=0,l=0;l<t;a++){let u=this.content[a],c=l+u.nodeSize;if(c>e&&n(u,s+l,o||null,a)!==!1&&u.content.size){let d=l+1;u.nodesBetween(Math.max(0,e-d),Math.min(u.content.size,t-d),n,s+d)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,s){let o="",a=!0;return this.nodesBetween(e,t,(l,u)=>{let c=l.isText?l.text.slice(Math.max(e,u)-u,t-u):l.isLeaf?s?typeof s=="function"?s(l):s:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&n&&(a?a=!1:o+=n),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,s=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(s[s.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)s.push(e.content[o]);return new Fragment(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],s=0;if(t>e)for(let o=0,a=0;a<t;o++){let l=this.content[o],u=a+l.nodeSize;u>e&&((a<e||u>t)&&(l.isText?l=l.cut(Math.max(0,e-a),Math.min(l.text.length,t-a)):l=l.cut(Math.max(0,e-a-1),Math.min(l.content.size,t-a-1))),n.push(l),s+=l.nodeSize),a=u}return new Fragment(n,s)}cutByIndex(e,t){return e==t?Fragment.empty:e==0&&t==this.content.length?this:new Fragment(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let s=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return s[e]=t,new Fragment(s,o)}addToStart(e){return new Fragment([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Fragment(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let s=this.content[t];e(s,n,t),n+=s.nodeSize}}findDiffStart(e,t=0){return findDiffStart(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return findDiffEnd(this,e,t,n)}findIndex(e,t=-1){if(e==0)return retIndex(0,e);if(e==this.size)return retIndex(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,s=0;;n++){let o=this.child(n),a=s+o.nodeSize;if(a>=e)return a==e||t>0?retIndex(n+1,a):retIndex(n,s);s=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Fragment.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fragment(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Fragment.empty;let t,n=0;for(let s=0;s<e.length;s++){let o=e[s];n+=o.nodeSize,s&&o.isText&&e[s-1].sameMarkup(o)?(t||(t=e.slice(0,s)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new Fragment(t||e,n)}static from(e){if(!e)return Fragment.empty;if(e instanceof Fragment)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Fragment([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Fragment.empty=new Fragment([],0);const found={index:0,offset:0};function retIndex(r,e){return found.index=r,found.offset=e,found}function compareDeep(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!compareDeep(r[n],e[n]))return!1}else{for(let n in r)if(!(n in e)||!compareDeep(r[n],e[n]))return!1;for(let n in e)if(!(n in r))return!1}return!0}let Mark$1=class bl{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let s=0;s<e.length;s++){let o=e[s];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,s));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&compareDeep(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=n.create(t.attrs);return n.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return bl.none;if(e instanceof bl)return[e];let t=e.slice();return t.sort((n,s)=>n.type.rank-s.type.rank),t}};Mark$1.none=[];class ReplaceError extends Error{}class Slice{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=insertInto(this.content,e+this.openStart,t);return n&&new Slice(n,this.openStart,this.openEnd)}removeBetween(e,t){return new Slice(removeRange(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Slice.empty;let n=t.openStart||0,s=t.openEnd||0;if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(e,t.content),n,s)}static maxOpen(e,t=!0){let n=0,s=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)s++;return new Slice(e,n,s)}}Slice.empty=new Slice(Fragment.empty,0,0);function removeRange(r,e,t){let{index:n,offset:s}=r.findIndex(e),o=r.maybeChild(n),{index:a,offset:l}=r.findIndex(t);if(s==e||o.isText){if(l!=t&&!r.child(a).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(n!=a)throw new RangeError("Removing non-flat range");return r.replaceChild(n,o.copy(removeRange(o.content,e-s-1,t-s-1)))}function insertInto(r,e,t,n){let{index:s,offset:o}=r.findIndex(e),a=r.maybeChild(s);if(o==e||a.isText)return r.cut(0,e).append(t).append(r.cut(e));let l=insertInto(a.content,e-o-1,t);return l&&r.replaceChild(s,a.copy(l))}function replace(r,e,t){if(t.openStart>r.depth)throw new ReplaceError("Inserted content deeper than insertion position");if(r.depth-t.openStart!=e.depth-t.openEnd)throw new ReplaceError("Inconsistent open depths");return replaceOuter(r,e,t,0)}function replaceOuter(r,e,t,n){let s=r.index(n),o=r.node(n);if(s==e.index(n)&&n<r.depth-t.openStart){let a=replaceOuter(r,e,t,n+1);return o.copy(o.content.replaceChild(s,a))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&r.depth==n&&e.depth==n){let a=r.parent,l=a.content;return close(a,l.cut(0,r.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:a,end:l}=prepareSliceForReplace(t,r);return close(o,replaceThreeWay(r,a,l,e,n))}else return close(o,replaceTwoWay(r,e,n))}function checkJoin(r,e){if(!e.type.compatibleContent(r.type))throw new ReplaceError("Cannot join "+e.type.name+" onto "+r.type.name)}function joinable$1(r,e,t){let n=r.node(t);return checkJoin(n,e.node(t)),n}function addNode(r,e){let t=e.length-1;t>=0&&r.isText&&r.sameMarkup(e[t])?e[t]=r.withText(e[t].text+r.text):e.push(r)}function addRange(r,e,t,n){let s=(e||r).node(t),o=0,a=e?e.index(t):s.childCount;r&&(o=r.index(t),r.depth>t?o++:r.textOffset&&(addNode(r.nodeAfter,n),o++));for(let l=o;l<a;l++)addNode(s.child(l),n);e&&e.depth==t&&e.textOffset&&addNode(e.nodeBefore,n)}function close(r,e){return r.type.checkContent(e),r.copy(e)}function replaceThreeWay(r,e,t,n,s){let o=r.depth>s&&joinable$1(r,e,s+1),a=n.depth>s&&joinable$1(t,n,s+1),l=[];return addRange(null,r,s,l),o&&a&&e.index(s)==t.index(s)?(checkJoin(o,a),addNode(close(o,replaceThreeWay(r,e,t,n,s+1)),l)):(o&&addNode(close(o,replaceTwoWay(r,e,s+1)),l),addRange(e,t,s,l),a&&addNode(close(a,replaceTwoWay(t,n,s+1)),l)),addRange(n,null,s,l),new Fragment(l)}function replaceTwoWay(r,e,t){let n=[];if(addRange(null,r,t,n),r.depth>t){let s=joinable$1(r,e,t+1);addNode(close(s,replaceTwoWay(r,e,t+1)),n)}return addRange(e,null,t,n),new Fragment(n)}function prepareSliceForReplace(r,e){let t=e.depth-r.openStart,s=e.node(t).copy(r.content);for(let o=t-1;o>=0;o--)s=e.node(o).copy(Fragment.from(s));return{start:s.resolveNoCache(r.openStart+t),end:s.resolveNoCache(s.content.size-r.openEnd-t)}}class ResolvedPos{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],s=e.child(t);return n?e.child(t).cut(n):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)s+=n.child(o).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Mark$1.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),s=e.maybeChild(t);if(!n){let l=n;n=s,s=l}let o=n.marks;for(var a=0;a<o.length;a++)o[a].type.spec.inclusive===!1&&(!s||!o[a].isInSet(s.marks))&&(o=o[a--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,s=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)n[o].type.spec.inclusive===!1&&(!s||!n[o].isInSet(s.marks))&&(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new NodeRange(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],s=0,o=t;for(let a=e;;){let{index:l,offset:u}=a.content.findIndex(o),c=o-u;if(n.push(a,l,s+u),!c||(a=a.child(l),a.isText))break;o=c-1,s+=u+1}return new ResolvedPos(t,n,o)}static resolveCached(e,t){let n=resolveCache.get(e);if(n)for(let o=0;o<n.elts.length;o++){let a=n.elts[o];if(a.pos==t)return a}else resolveCache.set(e,n=new ResolveCache);let s=n.elts[n.i]=ResolvedPos.resolve(e,t);return n.i=(n.i+1)%resolveCacheSize,s}}class ResolveCache{constructor(){this.elts=[],this.i=0}}const resolveCacheSize=12,resolveCache=new WeakMap;class NodeRange{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const emptyAttrs=Object.create(null);let Node$2=class Al{constructor(e,t,n,s=Mark$1.none){this.type=e,this.attrs=t,this.marks=s,this.content=n||Fragment.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,s=0){this.content.nodesBetween(e,t,n,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,s){return this.content.textBetween(e,t,n,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&compareDeep(this.attrs,t||e.defaultAttrs||emptyAttrs)&&Mark$1.sameSet(this.marks,n||Mark$1.none)}copy(e=null){return e==this.content?this:new Al(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Al(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return Slice.empty;let s=this.resolve(e),o=this.resolve(t),a=n?0:s.sharedDepth(t),l=s.start(a),c=s.node(a).content.cut(s.pos-l,o.pos-l);return new Slice(c,s.depth-a,o.depth-a)}replace(e,t,n){return replace(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let s=this.content.child(t-1);return{node:s,index:t-1,offset:n-s.nodeSize}}resolve(e){return ResolvedPos.resolveCached(this,e)}resolveNoCache(e){return ResolvedPos.resolve(this,e)}rangeHasMark(e,t,n){let s=!1;return t>e&&this.nodesBetween(e,t,o=>(n.isInSet(o.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=Fragment.empty,s=0,o=n.childCount){let a=this.contentMatchAt(e).matchFragment(n,s,o),l=a&&a.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let u=s;u<o;u++)if(!this.type.allowsMarks(n.child(u).marks))return!1;return!0}canReplaceWith(e,t,n,s){if(s&&!this.type.allowsMarks(s))return!1;let o=this.contentMatchAt(e).matchType(n),a=o&&o.matchFragment(this.content,t);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Mark$1.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Mark$1.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let s=Fragment.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,s,n);return o.type.checkAttrs(o.attrs),o}};Node$2.prototype.text=void 0;class TextNode extends Node$2{constructor(e,t,n,s){if(super(e,t,null,s),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new TextNode(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new TextNode(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function wrapMarks(r,e){for(let t=r.length-1;t>=0;t--)e=r[t].type.name+"("+e+")";return e}class ContentMatch{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new TokenStream(e,t);if(n.next==null)return ContentMatch.empty;let s=parseExpr(n);n.next&&n.err("Unexpected trailing text");let o=dfa(nfa(s));return checkForDeadEnds(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let s=this;for(let o=t;s&&o<n;o++)s=s.matchType(e.child(o).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let s=[this];function o(a,l){let u=a.matchFragment(e,n);if(u&&(!t||u.validEnd))return Fragment.from(l.map(c=>c.createAndFill()));for(let c=0;c<a.next.length;c++){let{type:d,next:f}=a.next[c];if(!(d.isText||d.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let C=o(f,l.concat(d));if(C)return C}}return null}return o(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let s=n.shift(),o=s.match;if(o.matchType(e)){let a=[];for(let l=s;l.type;l=l.via)a.push(l.type);return a.reverse()}for(let a=0;a<o.next.length;a++){let{type:l,next:u}=o.next[a];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!s.type||u.validEnd)&&(n.push({match:l.contentMatch,type:l,via:s}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(n){e.push(n);for(let s=0;s<n.next.length;s++)e.indexOf(n.next[s].next)==-1&&t(n.next[s].next)}return t(this),e.map((n,s)=>{let o=s+(n.validEnd?"*":" ")+" ";for(let a=0;a<n.next.length;a++)o+=(a?", ":"")+n.next[a].type.name+"->"+e.indexOf(n.next[a].next);return o}).join(`
`)}}ContentMatch.empty=new ContentMatch(!0);class TokenStream{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function parseExpr(r){let e=[];do e.push(parseExprSeq(r));while(r.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function parseExprSeq(r){let e=[];do e.push(parseExprSubscript(r));while(r.next&&r.next!=")"&&r.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function parseExprSubscript(r){let e=parseExprAtom(r);for(;;)if(r.eat("+"))e={type:"plus",expr:e};else if(r.eat("*"))e={type:"star",expr:e};else if(r.eat("?"))e={type:"opt",expr:e};else if(r.eat("{"))e=parseExprRange(r,e);else break;return e}function parseNum(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let e=Number(r.next);return r.pos++,e}function parseExprRange(r,e){let t=parseNum(r),n=t;return r.eat(",")&&(r.next!="}"?n=parseNum(r):n=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:e}}function resolveName(r,e){let t=r.nodeTypes,n=t[e];if(n)return[n];let s=[];for(let o in t){let a=t[o];a.isInGroup(e)&&s.push(a)}return s.length==0&&r.err("No node type or group '"+e+"' found"),s}function parseExprAtom(r){if(r.eat("(")){let e=parseExpr(r);return r.eat(")")||r.err("Missing closing paren"),e}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{let e=resolveName(r,r.next).map(t=>(r.inline==null?r.inline=t.isInline:r.inline!=t.isInline&&r.err("Mixing inline and block content"),{type:"name",value:t}));return r.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function nfa(r){let e=[[]];return s(o(r,0),t()),e;function t(){return e.push([])-1}function n(a,l,u){let c={term:u,to:l};return e[a].push(c),c}function s(a,l){a.forEach(u=>u.to=l)}function o(a,l){if(a.type=="choice")return a.exprs.reduce((u,c)=>u.concat(o(c,l)),[]);if(a.type=="seq")for(let u=0;;u++){let c=o(a.exprs[u],l);if(u==a.exprs.length-1)return c;s(c,l=t())}else if(a.type=="star"){let u=t();return n(l,u),s(o(a.expr,u),u),[n(u)]}else if(a.type=="plus"){let u=t();return s(o(a.expr,l),u),s(o(a.expr,u),u),[n(u)]}else{if(a.type=="opt")return[n(l)].concat(o(a.expr,l));if(a.type=="range"){let u=l;for(let c=0;c<a.min;c++){let d=t();s(o(a.expr,u),d),u=d}if(a.max==-1)s(o(a.expr,u),u);else for(let c=a.min;c<a.max;c++){let d=t();n(u,d),s(o(a.expr,u),d),u=d}return[n(u)]}else{if(a.type=="name")return[n(l,void 0,a.value)];throw new Error("Unknown expr type")}}}}function cmp(r,e){return e-r}function nullFrom(r,e){let t=[];return n(e),t.sort(cmp);function n(s){let o=r[s];if(o.length==1&&!o[0].term)return n(o[0].to);t.push(s);for(let a=0;a<o.length;a++){let{term:l,to:u}=o[a];!l&&t.indexOf(u)==-1&&n(u)}}}function dfa(r){let e=Object.create(null);return t(nullFrom(r,0));function t(n){let s=[];n.forEach(a=>{r[a].forEach(({term:l,to:u})=>{if(!l)return;let c;for(let d=0;d<s.length;d++)s[d][0]==l&&(c=s[d][1]);nullFrom(r,u).forEach(d=>{c||s.push([l,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let o=e[n.join(",")]=new ContentMatch(n.indexOf(r.length-1)>-1);for(let a=0;a<s.length;a++){let l=s[a][1].sort(cmp);o.next.push({type:s[a][0],next:e[l.join(",")]||t(l)})}return o}}function checkForDeadEnds(r,e){for(let t=0,n=[r];t<n.length;t++){let s=n[t],o=!s.validEnd,a=[];for(let l=0;l<s.next.length;l++){let{type:u,next:c}=s.next[l];a.push(u.name),o&&!(u.isText||u.hasRequiredAttrs())&&(o=!1),n.indexOf(c)==-1&&n.push(c)}o&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function defaultAttrs(r){let e=Object.create(null);for(let t in r){let n=r[t];if(!n.hasDefault)return null;e[t]=n.default}return e}function computeAttrs(r,e){let t=Object.create(null);for(let n in r){let s=e&&e[n];if(s===void 0){let o=r[n];if(o.hasDefault)s=o.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=s}return t}function checkAttrs(r,e,t,n){for(let s in e)if(!(s in r))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in r){let o=r[s];o.validate&&o.validate(e[s])}}function initAttrs(r,e){let t=Object.create(null);if(e)for(let n in e)t[n]=new Attribute(r,n,e[n]);return t}let NodeType$1=class Nc{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=initAttrs(e,n.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ContentMatch.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:computeAttrs(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Node$2(this,this.computeAttrs(e),Fragment.from(t),Mark$1.setFrom(n))}createChecked(e=null,t,n){return t=Fragment.from(t),this.checkContent(t),new Node$2(this,this.computeAttrs(e),t,Mark$1.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),t=Fragment.from(t),t.size){let a=this.contentMatch.fillBefore(t);if(!a)return null;t=a.append(t)}let s=this.contentMatch.matchFragment(t),o=s&&s.fillBefore(Fragment.empty,!0);return o?new Node$2(this,e,t.append(o),Mark$1.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){checkAttrs(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Mark$1.none:e}static compile(e,t){let n=Object.create(null);e.forEach((o,a)=>n[o]=new Nc(o,t,a));let s=t.spec.topNode||"doc";if(!n[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function validateType(r,e,t){let n=t.split("|");return s=>{let o=s===null?"null":typeof s;if(n.indexOf(o)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${r}, got ${o}`)}}class Attribute{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?validateType(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class MarkType{constructor(e,t,n,s){this.name=e,this.rank=t,this.schema=n,this.spec=s,this.attrs=initAttrs(e,s.attrs),this.excluded=null;let o=defaultAttrs(this.attrs);this.instance=o?new Mark$1(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Mark$1(this,computeAttrs(this.attrs,e))}static compile(e,t){let n=Object.create(null),s=0;return e.forEach((o,a)=>n[o]=new MarkType(o,s++,t,a)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){checkAttrs(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Schema{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=OrderedMap.from(e.nodes),t.marks=OrderedMap.from(e.marks||{}),this.nodes=NodeType$1.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);let n=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let o=this.nodes[s],a=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=n[a]||(n[a]=ContentMatch.parse(a,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?gatherMarks(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let s in this.marks){let o=this.marks[s],a=o.spec.excludes;o.excluded=a==null?[o]:a==""?[]:gatherMarks(this,a.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof NodeType$1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,n,s)}text(e,t){let n=this.nodes.text;return new TextNode(n,n.defaultAttrs,e,Mark$1.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Node$2.fromJSON(this,e)}markFromJSON(e){return Mark$1.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function gatherMarks(r,e){let t=[];for(let n=0;n<e.length;n++){let s=e[n],o=r.marks[s],a=o;if(o)t.push(o);else for(let l in r.marks){let u=r.marks[l];(s=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(s)>-1)&&t.push(a=u)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return t}function isTagRule(r){return r.tag!=null}function isStyleRule(r){return r.style!=null}let DOMParser$1=class Nl{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(s=>{if(isTagRule(s))this.tags.push(s);else if(isStyleRule(s)){let o=/[^=]*/.exec(s.style)[0];n.indexOf(o)<0&&n.push(o),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let o=e.nodes[s.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let n=new ParseContext(this,t,!1);return n.addAll(e,Mark$1.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new ParseContext(this,t,!0);return n.addAll(e,Mark$1.none,t.from,t.to),Slice.maxOpen(n.finish())}matchTag(e,t,n){for(let s=n?this.tags.indexOf(n)+1:0;s<this.tags.length;s++){let o=this.tags[s];if(matches(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let a=o.getAttrs(e);if(a===!1)continue;o.attrs=a||void 0}return o}}}matchStyle(e,t,n,s){for(let o=s?this.styles.indexOf(s)+1:0;o<this.styles.length;o++){let a=this.styles[o],l=a.style;if(!(l.indexOf(e)!=0||a.context&&!n.matchesContext(a.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(a.getAttrs){let u=a.getAttrs(t);if(u===!1)continue;a.attrs=u||void 0}return a}}}static schemaRules(e){let t=[];function n(s){let o=s.priority==null?50:s.priority,a=0;for(;a<t.length;a++){let l=t[a];if((l.priority==null?50:l.priority)<o)break}t.splice(a,0,s)}for(let s in e.marks){let o=e.marks[s].spec.parseDOM;o&&o.forEach(a=>{n(a=copy(a)),a.mark||a.ignore||a.clearMark||(a.mark=s)})}for(let s in e.nodes){let o=e.nodes[s].spec.parseDOM;o&&o.forEach(a=>{n(a=copy(a)),a.node||a.ignore||a.mark||(a.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Nl(e,Nl.schemaRules(e)))}};const blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0},OPT_PRESERVE_WS=1,OPT_PRESERVE_WS_FULL=2,OPT_OPEN_LEFT=4;function wsOptionsFor(r,e,t){return e!=null?(e?OPT_PRESERVE_WS:0)|(e==="full"?OPT_PRESERVE_WS_FULL:0):r&&r.whitespace=="pre"?OPT_PRESERVE_WS|OPT_PRESERVE_WS_FULL:t&-5}class NodeContext{constructor(e,t,n,s,o,a){this.type=e,this.attrs=t,this.marks=n,this.solid=s,this.options=a,this.content=[],this.activeMarks=Mark$1.none,this.match=o||(a&OPT_OPEN_LEFT?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Fragment.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,s;return(s=n.findWrapping(e.type))?(this.match=n,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&OPT_PRESERVE_WS)){let n=this.content[this.content.length-1],s;if(n&&n.isText&&(s=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-s[0].length))}}let t=Fragment.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!blockTags.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ParseContext{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let s=t.topNode,o,a=wsOptionsFor(null,t.preserveWhitespace,0)|(n?OPT_OPEN_LEFT:0);s?o=new NodeContext(s.type,s.attrs,Mark$1.none,!0,t.topMatch||s.type.contentMatch,a):n?o=new NodeContext(null,null,Mark$1.none,!0,null,a):o=new NodeContext(e.schema.topNodeType,null,Mark$1.none,!0,null,a),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,s=this.top,o=s.options&OPT_PRESERVE_WS_FULL?"full":this.localPreserveWS||(s.options&OPT_PRESERVE_WS)>0;if(o==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)o!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let s=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),l;listTags.hasOwnProperty(a)&&this.parser.normalizeLists&&normalizeList(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,n));e:if(u?u.ignore:ignoreTags.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let c,d=this.needsBlock;if(blockTags.hasOwnProperty(a))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let f=u&&u.skip?t:this.readStyles(e,t);f&&this.addAll(e,f),c&&this.sync(o),this.needsBlock=d}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,u,c,u.consuming===!1?l:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let o=this.parser.matchedStyles[s],a=n.getPropertyValue(o);if(a)for(let l=void 0;;){let u=this.parser.matchStyle(o,a,this,l);if(!u)break;if(u.ignore)return null;if(u.clearMark?t=t.filter(c=>!u.clearMark(c)):t=t.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)l=u;else break}}return t}addElementByRule(e,t,n,s){let o,a;if(t.node)if(a=this.parser.schema.nodes[t.node],a.isLeaf)this.insertNode(a.create(t.attrs),n)||this.leafFallback(e,n);else{let u=this.enter(a,t.attrs||null,n,t.preserveWhitespace);u&&(o=!0,n=u)}else{let u=this.parser.schema.marks[t.mark];n=n.concat(u.create(t.attrs))}let l=this.top;if(a&&a.isLeaf)this.findInside(e);else if(s)this.addElement(e,n,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,n));else{let u=e;typeof t.contentElement=="string"?u=e.querySelector(t.contentElement):typeof t.contentElement=="function"?u=t.contentElement(e):t.contentElement&&(u=t.contentElement),this.findAround(e,u,!0),this.addAll(u,n),this.findAround(e,u,!1)}o&&this.sync(l)&&this.open--}addAll(e,t,n,s){let o=n||0;for(let a=n?e.childNodes[n]:e.firstChild,l=s==null?null:e.childNodes[s];a!=l;a=a.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(a,t);this.findAtPoint(e,o)}findPlace(e,t){let n,s;for(let o=this.open;o>=0;o--){let a=this.nodes[o],l=a.findWrapping(e);if(l&&(!n||n.length>l.length)&&(n=l,s=a,!l.length)||a.solid)break}if(!n)return null;this.sync(s);for(let o=0;o<n.length;o++)t=this.enterInner(n[o],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(t=this.enterInner(s,null,t))}let n=this.findPlace(e,t);if(n){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=Mark$1.none;for(let a of n.concat(e.marks))(s.type?s.type.allowsMarkType(a.type):markMayApply(a.type,e.type))&&(o=a.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,t,n,s){let o=this.findPlace(e.create(t),n);return o&&(o=this.enterInner(e,t,n,!0,s)),o}enterInner(e,t,n,s=!1,o){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let l=wsOptionsFor(e,o,a.options);a.options&OPT_OPEN_LEFT&&a.content.length==0&&(l|=OPT_OPEN_LEFT);let u=Mark$1.none;return n=n.filter(c=>(a.type?a.type.allowsMarkType(c.type):markMayApply(c.type,e))?(u=c.addToSet(u),!1):!0),this.nodes.push(new NodeContext(e,t,u,s,null,l)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=OPT_PRESERVE_WS)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let s=n.length-1;s>=0;s--)e+=n[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(n?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,s=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(s?0:1),a=(l,u)=>{for(;l>=0;l--){let c=t[l];if(c==""){if(l==t.length-1||l==0)continue;for(;u>=o;u--)if(a(l-1,u))return!0;return!1}else{let d=u>0||u==0&&s?this.nodes[u].type:n&&u>=o?n.node(u-o).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;u--}}return!0};return a(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}}function normalizeList(r){for(let e=r.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&listTags.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function matches(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function copy(r){let e={};for(let t in r)e[t]=r[t];return e}function markMayApply(r,e){let t=e.schema.nodes;for(let n in t){let s=t[n];if(!s.allowsMarkType(r))continue;let o=[],a=l=>{o.push(l);for(let u=0;u<l.edgeCount;u++){let{type:c,next:d}=l.edge(u);if(c==e||o.indexOf(d)<0&&a(d))return!0}};if(a(s.contentMatch))return!0}}class DOMSerializer{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=doc$1(t).createDocumentFragment());let s=n,o=[];return e.forEach(a=>{if(o.length||a.marks.length){let l=0,u=0;for(;l<o.length&&u<a.marks.length;){let c=a.marks[u];if(!this.marks[c.type.name]){u++;continue}if(!c.eq(o[l][0])||c.type.spec.spanning===!1)break;l++,u++}for(;l<o.length;)s=o.pop()[1];for(;u<a.marks.length;){let c=a.marks[u++],d=this.serializeMark(c,a.isInline,t);d&&(o.push([c,s]),s.appendChild(d.dom),s=d.contentDOM||d.dom)}}s.appendChild(this.serializeNodeInner(a,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:s}=renderSpec(doc$1(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let o=this.serializeMark(e.marks[s],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let s=this.marks[e.type.name];return s&&renderSpec(doc$1(n),s(e,t),null,e.attrs)}static renderSpec(e,t,n=null,s){return renderSpec(e,t,n,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=gatherToDOM(e.nodes);return t.text||(t.text=n=>n.text),t}static marksFromSchema(e){return gatherToDOM(e.marks)}}function gatherToDOM(r){let e={};for(let t in r){let n=r[t].spec.toDOM;n&&(e[t]=n)}return e}function doc$1(r){return r.document||window.document}const suspiciousAttributeCache=new WeakMap;function suspiciousAttributes(r){let e=suspiciousAttributeCache.get(r);return e===void 0&&suspiciousAttributeCache.set(r,e=suspiciousAttributesInner(r)),e}function suspiciousAttributesInner(r){let e=null;function t(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let s=0;s<n.length;s++)t(n[s]);else for(let s in n)t(n[s])}return t(r),e}function renderSpec(r,e,t,n){if(typeof e=="string")return{dom:r.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],o;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=suspiciousAttributes(n))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=s.indexOf(" ");a>0&&(t=s.slice(0,a),s=s.slice(a+1));let l,u=t?r.createElementNS(t,s):r.createElement(s),c=e[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let f in c)if(c[f]!=null){let C=f.indexOf(" ");C>0?u.setAttributeNS(f.slice(0,C),f.slice(C+1),c[f]):u.setAttribute(f,c[f])}}for(let f=d;f<e.length;f++){let C=e[f];if(C===0){if(f<e.length-1||f>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:m,contentDOM:E}=renderSpec(r,C,t,n);if(u.appendChild(m),E){if(l)throw new RangeError("Multiple content holes");l=E}}}return{dom:u,contentDOM:l}}const lower16=65535,factor16=Math.pow(2,16);function makeRecover(r,e){return r+e*factor16}function recoverIndex(r){return r&lower16}function recoverOffset(r){return(r-(r&lower16))/factor16}const DEL_BEFORE=1,DEL_AFTER=2,DEL_ACROSS=4,DEL_SIDE=8;class MapResult{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&DEL_SIDE)>0}get deletedBefore(){return(this.delInfo&(DEL_BEFORE|DEL_ACROSS))>0}get deletedAfter(){return(this.delInfo&(DEL_AFTER|DEL_ACROSS))>0}get deletedAcross(){return(this.delInfo&DEL_ACROSS)>0}}class StepMap{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&StepMap.empty)return StepMap.empty}recover(e){let t=0,n=recoverIndex(e);if(!this.inverted)for(let s=0;s<n;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[n*3]+t+recoverOffset(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let s=0,o=this.inverted?2:1,a=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?s:0);if(u>e)break;let c=this.ranges[l+o],d=this.ranges[l+a],f=u+c;if(e<=f){let C=c?e==u?-1:e==f?1:t:t,m=u+s+(C<0?0:d);if(n)return m;let E=e==(t<0?u:f)?null:makeRecover(l/3,e-u),v=e==u?DEL_AFTER:e==f?DEL_BEFORE:DEL_ACROSS;return(t<0?e!=u:e!=f)&&(v|=DEL_SIDE),new MapResult(m,v,E)}s+=d-c}return n?e+s:new MapResult(e+s,0,null)}touches(e,t){let n=0,s=recoverIndex(t),o=this.inverted?2:1,a=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?n:0);if(u>e)break;let c=this.ranges[l+o],d=u+c;if(e<=d&&l==s*3)return!0;n+=this.ranges[l+a]-c}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let s=0,o=0;s<this.ranges.length;s+=3){let a=this.ranges[s],l=a-(this.inverted?o:0),u=a+(this.inverted?0:o),c=this.ranges[s+t],d=this.ranges[s+n];e(l,l+c,u,u+d),o+=d-c}}invert(){return new StepMap(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?StepMap.empty:new StepMap(e<0?[0,-e,0]:[0,0,e])}}StepMap.empty=new StepMap([]);class Mapping{constructor(e=[],t,n=0,s=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=s}slice(e=0,t=this.maps.length){return new Mapping(this.maps,this.mirror,e,t)}copy(){return new Mapping(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let s=e.getMirror(t);this.appendMap(e.maps[t],s!=null&&s<t?n+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e.maps[t].invert(),s!=null&&s>t?n-s-1:void 0)}}invert(){let e=new Mapping;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let s=0;for(let o=this.from;o<this.to;o++){let a=this.maps[o],l=a.mapResult(e,t);if(l.recover!=null){let u=this.getMirror(o);if(u!=null&&u>o&&u<this.to){o=u,e=this.maps[u].recover(l.recover);continue}}s|=l.delInfo,e=l.pos}return n?e:new MapResult(e,s,null)}}const stepsByID=Object.create(null);class Step{getMap(){return StepMap.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=stepsByID[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in stepsByID)throw new RangeError("Duplicate use of step JSON ID "+e);return stepsByID[e]=t,t.prototype.jsonID=e,t}}class StepResult{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new StepResult(e,null)}static fail(e){return new StepResult(null,e)}static fromReplace(e,t,n,s){try{return StepResult.ok(e.replace(t,n,s))}catch(o){if(o instanceof ReplaceError)return StepResult.fail(o.message);throw o}}}function mapFragment(r,e,t){let n=[];for(let s=0;s<r.childCount;s++){let o=r.child(s);o.content.size&&(o=o.copy(mapFragment(o.content,e,o))),o.isInline&&(o=e(o,t,s)),n.push(o)}return Fragment.fromArray(n)}class AddMarkStep extends Step{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),s=n.node(n.sharedDepth(this.to)),o=new Slice(mapFragment(t.content,(a,l)=>!a.isAtom||!l.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),s),t.openStart,t.openEnd);return StepResult.fromReplace(e,this.from,this.to,o)}invert(){return new RemoveMarkStep(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new AddMarkStep(t.pos,n.pos,this.mark)}merge(e){return e instanceof AddMarkStep&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new AddMarkStep(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(t.from,t.to,e.markFromJSON(t.mark))}}Step.jsonID("addMark",AddMarkStep);class RemoveMarkStep extends Step{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new Slice(mapFragment(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return StepResult.fromReplace(e,this.from,this.to,n)}invert(){return new AddMarkStep(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new RemoveMarkStep(t.pos,n.pos,this.mark)}merge(e){return e instanceof RemoveMarkStep&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new RemoveMarkStep(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(t.from,t.to,e.markFromJSON(t.mark))}}Step.jsonID("removeMark",RemoveMarkStep);class AddNodeMarkStep extends Step{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return StepResult.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return StepResult.fromReplace(e,this.pos,this.pos+1,new Slice(Fragment.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(n))return new AddNodeMarkStep(this.pos,t.marks[s]);return new AddNodeMarkStep(this.pos,this.mark)}}return new RemoveNodeMarkStep(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new AddNodeMarkStep(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new AddNodeMarkStep(t.pos,e.markFromJSON(t.mark))}}Step.jsonID("addNodeMark",AddNodeMarkStep);class RemoveNodeMarkStep extends Step{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return StepResult.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return StepResult.fromReplace(e,this.pos,this.pos+1,new Slice(Fragment.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new AddNodeMarkStep(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new RemoveNodeMarkStep(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new RemoveNodeMarkStep(t.pos,e.markFromJSON(t.mark))}}Step.jsonID("removeNodeMark",RemoveNodeMarkStep);class ReplaceStep extends Step{constructor(e,t,n,s=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=s}apply(e){return this.structure&&contentBetween(e,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])}invert(e){return new ReplaceStep(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new ReplaceStep(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof ReplaceStep)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Slice.empty:new Slice(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ReplaceStep(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Slice.empty:new Slice(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ReplaceStep(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(t.from,t.to,Slice.fromJSON(e,t.slice),!!t.structure)}}Step.jsonID("replace",ReplaceStep);class ReplaceAroundStep extends Step{constructor(e,t,n,s,o,a,l=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=s,this.slice=o,this.insert=a,this.structure=l}apply(e){if(this.structure&&(contentBetween(e,this.from,this.gapFrom)||contentBetween(e,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return StepResult.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?StepResult.fromReplace(e,this.from,this.to,n):StepResult.fail("Content does not fit in gap")}getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||s<t.pos||o>n.pos?null:new ReplaceAroundStep(t.pos,n.pos,s,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(t.from,t.to,t.gapFrom,t.gapTo,Slice.fromJSON(e,t.slice),t.insert,!!t.structure)}}Step.jsonID("replaceAround",ReplaceAroundStep);function contentBetween(r,e,t){let n=r.resolve(e),s=t-e,o=n.depth;for(;s>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,s--;if(s>0){let a=n.node(o).maybeChild(n.indexAfter(o));for(;s>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,s--}}return!1}function addMark(r,e,t,n){let s=[],o=[],a,l;r.doc.nodesBetween(e,t,(u,c,d)=>{if(!u.isInline)return;let f=u.marks;if(!n.isInSet(f)&&d.type.allowsMarkType(n.type)){let C=Math.max(c,e),m=Math.min(c+u.nodeSize,t),E=n.addToSet(f);for(let v=0;v<f.length;v++)f[v].isInSet(E)||(a&&a.to==C&&a.mark.eq(f[v])?a.to=m:s.push(a=new RemoveMarkStep(C,m,f[v])));l&&l.to==C?l.to=m:o.push(l=new AddMarkStep(C,m,n))}}),s.forEach(u=>r.step(u)),o.forEach(u=>r.step(u))}function removeMark(r,e,t,n){let s=[],o=0;r.doc.nodesBetween(e,t,(a,l)=>{if(!a.isInline)return;o++;let u=null;if(n instanceof MarkType){let c=a.marks,d;for(;d=n.isInSet(c);)(u||(u=[])).push(d),c=d.removeFromSet(c)}else n?n.isInSet(a.marks)&&(u=[n]):u=a.marks;if(u&&u.length){let c=Math.min(l+a.nodeSize,t);for(let d=0;d<u.length;d++){let f=u[d],C;for(let m=0;m<s.length;m++){let E=s[m];E.step==o-1&&f.eq(s[m].style)&&(C=E)}C?(C.to=c,C.step=o):s.push({style:f,from:Math.max(l,e),to:c,step:o})}}}),s.forEach(a=>r.step(new RemoveMarkStep(a.from,a.to,a.style)))}function clearIncompatible(r,e,t,n=t.contentMatch,s=!0){let o=r.doc.nodeAt(e),a=[],l=e+1;for(let u=0;u<o.childCount;u++){let c=o.child(u),d=l+c.nodeSize,f=n.matchType(c.type);if(!f)a.push(new ReplaceStep(l,d,Slice.empty));else{n=f;for(let C=0;C<c.marks.length;C++)t.allowsMarkType(c.marks[C].type)||r.step(new RemoveMarkStep(l,d,c.marks[C]));if(s&&c.isText&&t.whitespace!="pre"){let C,m=/\r?\n|\r/g,E;for(;C=m.exec(c.text);)E||(E=new Slice(Fragment.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),a.push(new ReplaceStep(l+C.index,l+C.index+C[0].length,E))}}l=d}if(!n.validEnd){let u=n.fillBefore(Fragment.empty,!0);r.replace(l,l,new Slice(u,0,0))}for(let u=a.length-1;u>=0;u--)r.step(a[u])}function canCut(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function liftTarget(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let s=r.$from.node(n),o=r.$from.index(n),a=r.$to.indexAfter(n);if(n<r.depth&&s.canReplace(o,a,t))return n;if(n==0||s.type.spec.isolating||!canCut(s,o,a))break}return null}function lift$2(r,e,t){let{$from:n,$to:s,depth:o}=e,a=n.before(o+1),l=s.after(o+1),u=a,c=l,d=Fragment.empty,f=0;for(let E=o,v=!1;E>t;E--)v||n.index(E)>0?(v=!0,d=Fragment.from(n.node(E).copy(d)),f++):u--;let C=Fragment.empty,m=0;for(let E=o,v=!1;E>t;E--)v||s.after(E+1)<s.end(E)?(v=!0,C=Fragment.from(s.node(E).copy(C)),m++):c++;r.step(new ReplaceAroundStep(u,c,a,l,new Slice(d.append(C),f,m),d.size-f,!0))}function findWrapping(r,e,t=null,n=r){let s=findWrappingOutside(r,e),o=s&&findWrappingInside(n,e);return o?s.map(withAttrs).concat({type:e,attrs:t}).concat(o.map(withAttrs)):null}function withAttrs(r){return{type:r,attrs:null}}function findWrappingOutside(r,e){let{parent:t,startIndex:n,endIndex:s}=r,o=t.contentMatchAt(n).findWrapping(e);if(!o)return null;let a=o.length?o[0]:e;return t.canReplaceWith(n,s,a)?o:null}function findWrappingInside(r,e){let{parent:t,startIndex:n,endIndex:s}=r,o=t.child(n),a=e.contentMatch.findWrapping(o.type);if(!a)return null;let u=(a.length?a[a.length-1]:e).contentMatch;for(let c=n;u&&c<s;c++)u=u.matchType(t.child(c).type);return!u||!u.validEnd?null:a}function wrap(r,e,t){let n=Fragment.empty;for(let a=t.length-1;a>=0;a--){if(n.size){let l=t[a].type.contentMatch.matchFragment(n);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Fragment.from(t[a].type.create(t[a].attrs,n))}let s=e.start,o=e.end;r.step(new ReplaceAroundStep(s,o,s,o,new Slice(n,0,0),t.length,!0))}function setBlockType$1(r,e,t,n,s){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=r.steps.length;r.doc.nodesBetween(e,t,(a,l)=>{let u=typeof s=="function"?s(a):s;if(a.isTextblock&&!a.hasMarkup(n,u)&&canChangeType(r.doc,r.mapping.slice(o).map(l),n)){let c=null;if(n.schema.linebreakReplacement){let m=n.whitespace=="pre",E=!!n.contentMatch.matchType(n.schema.linebreakReplacement);m&&!E?c=!1:!m&&E&&(c=!0)}c===!1&&replaceLinebreaks(r,a,l,o),clearIncompatible(r,r.mapping.slice(o).map(l,1),n,void 0,c===null);let d=r.mapping.slice(o),f=d.map(l,1),C=d.map(l+a.nodeSize,1);return r.step(new ReplaceAroundStep(f,C,f+1,C-1,new Slice(Fragment.from(n.create(u,null,a.marks)),0,0),1,!0)),c===!0&&replaceNewlines(r,a,l,o),!1}})}function replaceNewlines(r,e,t,n){e.forEach((s,o)=>{if(s.isText){let a,l=/\r?\n|\r/g;for(;a=l.exec(s.text);){let u=r.mapping.slice(n).map(t+1+o+a.index);r.replaceWith(u,u+1,e.type.schema.linebreakReplacement.create())}}})}function replaceLinebreaks(r,e,t,n){e.forEach((s,o)=>{if(s.type==s.type.schema.linebreakReplacement){let a=r.mapping.slice(n).map(t+1+o);r.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function canChangeType(r,e,t){let n=r.resolve(e),s=n.index();return n.parent.canReplaceWith(s,s+1,t)}function setNodeMarkup(r,e,t,n,s){let o=r.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let a=t.create(n,null,s||o.marks);if(o.isLeaf)return r.replaceWith(e,e+o.nodeSize,a);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);r.step(new ReplaceAroundStep(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new Slice(Fragment.from(a),0,0),1,!0))}function canSplit(r,e,t=1,n){let s=r.resolve(e),o=s.depth-t,a=n&&n[n.length-1]||s.parent;if(o<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!a.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,d=t-2;c>o;c--,d--){let f=s.node(c),C=s.index(c);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(C,f.childCount),E=n&&n[d+1];E&&(m=m.replaceChild(0,E.type.create(E.attrs)));let v=n&&n[d]||f;if(!f.canReplace(C+1,f.childCount)||!v.type.validContent(m))return!1}let l=s.indexAfter(o),u=n&&n[0];return s.node(o).canReplaceWith(l,l,u?u.type:s.node(o+1).type)}function split(r,e,t=1,n){let s=r.doc.resolve(e),o=Fragment.empty,a=Fragment.empty;for(let l=s.depth,u=s.depth-t,c=t-1;l>u;l--,c--){o=Fragment.from(s.node(l).copy(o));let d=n&&n[c];a=Fragment.from(d?d.type.create(d.attrs,a):s.node(l).copy(a))}r.step(new ReplaceStep(e,e,new Slice(o.append(a),t,t),!0))}function canJoin(r,e){let t=r.resolve(e),n=t.index();return joinable(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function canAppendWithSubstitutedLinebreaks(r,e){e.content.size||r.type.compatibleContent(e.type);let t=r.contentMatchAt(r.childCount),{linebreakReplacement:n}=r.type.schema;for(let s=0;s<e.childCount;s++){let o=e.child(s),a=o.type==n?r.type.schema.nodes.text:o.type;if(t=t.matchType(a),!t||!r.type.allowsMarks(o.marks))return!1}return t.validEnd}function joinable(r,e){return!!(r&&e&&!r.isLeaf&&canAppendWithSubstitutedLinebreaks(r,e))}function joinPoint(r,e,t=-1){let n=r.resolve(e);for(let s=n.depth;;s--){let o,a,l=n.index(s);if(s==n.depth?(o=n.nodeBefore,a=n.nodeAfter):t>0?(o=n.node(s+1),l++,a=n.node(s).maybeChild(l)):(o=n.node(s).maybeChild(l-1),a=n.node(s+1)),o&&!o.isTextblock&&joinable(o,a)&&n.node(s).canReplace(l,l+1))return e;if(s==0)break;e=t<0?n.before(s):n.after(s)}}function join(r,e,t){let n=null,{linebreakReplacement:s}=r.doc.type.schema,o=r.doc.resolve(e-t),a=o.node().type;if(s&&a.inlineContent){let d=a.whitespace=="pre",f=!!a.contentMatch.matchType(s);d&&!f?n=!1:!d&&f&&(n=!0)}let l=r.steps.length;if(n===!1){let d=r.doc.resolve(e+t);replaceLinebreaks(r,d.node(),d.before(),l)}a.inlineContent&&clearIncompatible(r,e+t-1,a,o.node().contentMatchAt(o.index()),n==null);let u=r.mapping.slice(l),c=u.map(e-t);if(r.step(new ReplaceStep(c,u.map(e+t,-1),Slice.empty,!0)),n===!0){let d=r.doc.resolve(c);replaceNewlines(r,d.node(),d.before(),r.steps.length)}return r}function insertPoint(r,e,t){let n=r.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),t))return e;if(n.parentOffset==0)for(let s=n.depth-1;s>=0;s--){let o=n.index(s);if(n.node(s).canReplaceWith(o,o,t))return n.before(s+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(let s=n.depth-1;s>=0;s--){let o=n.indexAfter(s);if(n.node(s).canReplaceWith(o,o,t))return n.after(s+1);if(o<n.node(s).childCount)return null}return null}function dropPoint(r,e,t){let n=r.resolve(e);if(!t.content.size)return e;let s=t.content;for(let o=0;o<t.openStart;o++)s=s.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let a=n.depth;a>=0;a--){let l=a==n.depth?0:n.pos<=(n.start(a+1)+n.end(a+1))/2?-1:1,u=n.index(a)+(l>0?1:0),c=n.node(a),d=!1;if(o==1)d=c.canReplace(u,u,s);else{let f=c.contentMatchAt(u).findWrapping(s.firstChild.type);d=f&&c.canReplaceWith(u,u,f[0])}if(d)return l==0?n.pos:l<0?n.before(a+1):n.after(a+1)}return null}function replaceStep(r,e,t=e,n=Slice.empty){if(e==t&&!n.size)return null;let s=r.resolve(e),o=r.resolve(t);return fitsTrivially(s,o,n)?new ReplaceStep(e,t,n):new Fitter(s,o,n).fit()}function fitsTrivially(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}class Fitter{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=Fragment.empty;for(let s=0;s<=e.depth;s++){let o=e.node(s);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=Fragment.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,s=this.close(e<0?this.$to:n.doc.resolve(e));if(!s)return null;let o=this.placed,a=n.depth,l=s.depth;for(;a&&l&&o.childCount==1;)o=o.firstChild.content,a--,l--;let u=new Slice(o,a,l);return e>-1?new ReplaceAroundStep(n.pos,e,this.$to.pos,this.$to.end(),u,t):u.size||n.pos!=this.$to.pos?new ReplaceStep(n.pos,s.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,s=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(s=0),o.type.spec.isolating&&s<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=t==1?e:this.unplaced.openStart;n>=0;n--){let s,o=null;n?(o=contentAt(this.unplaced.content,n-1).firstChild,s=o.content):s=this.unplaced.content;let a=s.firstChild;for(let l=this.depth;l>=0;l--){let{type:u,match:c}=this.frontier[l],d,f=null;if(t==1&&(a?c.matchType(a.type)||(f=c.fillBefore(Fragment.from(a),!1)):o&&u.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:l,parent:o,inject:f};if(t==2&&a&&(d=c.findWrapping(a.type)))return{sliceDepth:n,frontierDepth:l,parent:o,wrap:d};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,s=contentAt(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Slice(e,t+1,Math.max(n,s.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,s=contentAt(e,t);if(s.childCount<=1&&t>0){let o=e.size-t<=t+s.size;this.unplaced=new Slice(dropFromFragment(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new Slice(dropFromFragment(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:s,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let v=0;v<o.length;v++)this.openFrontierNode(o[v]);let a=this.unplaced,l=n?n.content:a.content,u=a.openStart-e,c=0,d=[],{match:f,type:C}=this.frontier[t];if(s){for(let v=0;v<s.childCount;v++)d.push(s.child(v));f=f.matchFragment(s)}let m=l.size+e-(a.content.size-a.openEnd);for(;c<l.childCount;){let v=l.child(c),_=f.matchType(v.type);if(!_)break;c++,(c>1||u==0||v.content.size)&&(f=_,d.push(closeNodeStart(v.mark(C.allowedMarks(v.marks)),c==1?u:0,c==l.childCount?m:-1)))}let E=c==l.childCount;E||(m=-1),this.placed=addToFragment(this.placed,t,Fragment.from(d)),this.frontier[t].match=f,E&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,_=l;v<m;v++){let T=_.lastChild;this.frontier.push({type:T.type,match:T.contentMatchAt(T.childCount)}),_=T.content}this.unplaced=E?e==0?Slice.empty:new Slice(dropFromFragment(a.content,e-1,1),e-1,m<0?a.openEnd:e-1):new Slice(dropFromFragment(a.content,e,c),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,s=this.$to.after(n);for(;n>1&&s==this.$to.end(--n);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:s}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),a=contentAfterFits(e,t,s,n,o);if(a){for(let l=t-1;l>=0;l--){let{match:u,type:c}=this.frontier[l],d=contentAfterFits(e,l,c,u,!0);if(!d||d.childCount)continue e}return{depth:t,fit:a,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=addToFragment(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let s=e.node(n),o=s.type.contentMatch.fillBefore(s.content,!0,e.index(n));this.openFrontierNode(s.type,s.attrs,o)}return e}openFrontierNode(e,t=null,n){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=addToFragment(this.placed,this.depth,Fragment.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(Fragment.empty,!0);t.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,t))}}function dropFromFragment(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(dropFromFragment(r.firstChild.content,e-1,t)))}function addToFragment(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(addToFragment(r.lastChild.content,e-1,t)))}function contentAt(r,e){for(let t=0;t<e;t++)r=r.firstChild.content;return r}function closeNodeStart(r,e,t){if(e<=0)return r;let n=r.content;return e>1&&(n=n.replaceChild(0,closeNodeStart(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(Fragment.empty,!0)))),r.copy(n)}function contentAfterFits(r,e,t,n,s){let o=r.node(e),a=s?r.indexAfter(e):r.index(e);if(a==o.childCount&&!t.compatibleContent(o.type))return null;let l=n.fillBefore(o.content,!0,a);return l&&!invalidMarks(t,o.content,a)?l:null}function invalidMarks(r,e,t){for(let n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}function definesContent(r){return r.spec.defining||r.spec.definingForContent}function replaceRange(r,e,t,n){if(!n.size)return r.deleteRange(e,t);let s=r.doc.resolve(e),o=r.doc.resolve(t);if(fitsTrivially(s,o,n))return r.step(new ReplaceStep(e,t,n));let a=coveredDepths(s,r.doc.resolve(t));a[a.length-1]==0&&a.pop();let l=-(s.depth+1);a.unshift(l);for(let C=s.depth,m=s.pos-1;C>0;C--,m--){let E=s.node(C).type.spec;if(E.defining||E.definingAsContext||E.isolating)break;a.indexOf(C)>-1?l=C:s.before(C)==m&&a.splice(1,0,-C)}let u=a.indexOf(l),c=[],d=n.openStart;for(let C=n.content,m=0;;m++){let E=C.firstChild;if(c.push(E),m==n.openStart)break;C=E.content}for(let C=d-1;C>=0;C--){let m=c[C],E=definesContent(m.type);if(E&&!m.sameMarkup(s.node(Math.abs(l)-1)))d=C;else if(E||!m.type.isTextblock)break}for(let C=n.openStart;C>=0;C--){let m=(C+d+1)%(n.openStart+1),E=c[m];if(E)for(let v=0;v<a.length;v++){let _=a[(v+u)%a.length],T=!0;_<0&&(T=!1,_=-_);let R=s.node(_-1),O=s.index(_-1);if(R.canReplaceWith(O,O,E.type,E.marks))return r.replace(s.before(_),T?o.after(_):t,new Slice(closeFragment(n.content,0,n.openStart,m),m,n.openEnd))}}let f=r.steps.length;for(let C=a.length-1;C>=0&&(r.replace(e,t,n),!(r.steps.length>f));C--){let m=a[C];m<0||(e=s.before(m),t=o.after(m))}}function closeFragment(r,e,t,n,s){if(e<t){let o=r.firstChild;r=r.replaceChild(0,o.copy(closeFragment(o.content,e+1,t,n,o)))}if(e>n){let o=s.contentMatchAt(0),a=o.fillBefore(r).append(r);r=a.append(o.matchFragment(a).fillBefore(Fragment.empty,!0))}return r}function replaceRangeWith(r,e,t,n){if(!n.isInline&&e==t&&r.doc.resolve(e).parent.content.size){let s=insertPoint(r.doc,e,n.type);s!=null&&(e=t=s)}r.replaceRange(e,t,new Slice(Fragment.from(n),0,0))}function deleteRange$1(r,e,t){let n=r.doc.resolve(e),s=r.doc.resolve(t),o=coveredDepths(n,s);for(let a=0;a<o.length;a++){let l=o[a],u=a==o.length-1;if(u&&l==0||n.node(l).type.contentMatch.validEnd)return r.delete(n.start(l),s.end(l));if(l>0&&(u||n.node(l-1).canReplace(n.index(l-1),s.indexAfter(l-1))))return r.delete(n.before(l),s.after(l))}for(let a=1;a<=n.depth&&a<=s.depth;a++)if(e-n.start(a)==n.depth-a&&t>n.end(a)&&s.end(a)-t!=s.depth-a&&n.start(a-1)==s.start(a-1)&&n.node(a-1).canReplace(n.index(a-1),s.index(a-1)))return r.delete(n.before(a),t);r.delete(e,t)}function coveredDepths(r,e){let t=[],n=Math.min(r.depth,e.depth);for(let s=n;s>=0;s--){let o=r.start(s);if(o<r.pos-(r.depth-s)||e.end(s)>e.pos+(e.depth-s)||r.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(o==e.start(s)||s==r.depth&&s==e.depth&&r.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==o-1)&&t.push(s)}return t}class AttrStep extends Step{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return StepResult.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let s=t.type.create(n,null,t.marks);return StepResult.fromReplace(e,this.pos,this.pos+1,new Slice(Fragment.from(s),0,t.isLeaf?0:1))}getMap(){return StepMap.empty}invert(e){return new AttrStep(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new AttrStep(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new AttrStep(t.pos,t.attr,t.value)}}Step.jsonID("attr",AttrStep);class DocAttrStep extends Step{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return StepResult.ok(n)}getMap(){return StepMap.empty}invert(e){return new DocAttrStep(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new DocAttrStep(t.attr,t.value)}}Step.jsonID("docAttr",DocAttrStep);let TransformError=class extends Error{};TransformError=function r(e){let t=Error.call(this,e);return t.__proto__=r.prototype,t};TransformError.prototype=Object.create(Error.prototype);TransformError.prototype.constructor=TransformError;TransformError.prototype.name="TransformError";class Transform{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Mapping}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new TransformError(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=Slice.empty){let s=replaceStep(this.doc,e,t,n);return s&&this.step(s),this}replaceWith(e,t,n){return this.replace(e,t,new Slice(Fragment.from(n),0,0))}delete(e,t){return this.replace(e,t,Slice.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return replaceRange(this,e,t,n),this}replaceRangeWith(e,t,n){return replaceRangeWith(this,e,t,n),this}deleteRange(e,t){return deleteRange$1(this,e,t),this}lift(e,t){return lift$2(this,e,t),this}join(e,t=1){return join(this,e,t),this}wrap(e,t){return wrap(this,e,t),this}setBlockType(e,t=e,n,s=null){return setBlockType$1(this,e,t,n,s),this}setNodeMarkup(e,t,n=null,s){return setNodeMarkup(this,e,t,n,s),this}setNodeAttribute(e,t,n){return this.step(new AttrStep(e,t,n)),this}setDocAttribute(e,t){return this.step(new DocAttrStep(e,t)),this}addNodeMark(e,t){return this.step(new AddNodeMarkStep(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Mark$1)){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t=t.isInSet(n.marks),!t)return this}return this.step(new RemoveNodeMarkStep(e,t)),this}split(e,t=1,n){return split(this,e,t,n),this}addMark(e,t,n){return addMark(this,e,t,n),this}removeMark(e,t,n){return removeMark(this,e,t,n),this}clearIncompatible(e,t,n){return clearIncompatible(this,e,t,n),this}}const classesById=Object.create(null);class Selection{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new SelectionRange(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Slice.empty){let n=t.content.lastChild,s=null;for(let l=0;l<t.openEnd;l++)s=n,n=n.lastChild;let o=e.steps.length,a=this.ranges;for(let l=0;l<a.length;l++){let{$from:u,$to:c}=a[l],d=e.mapping.slice(o);e.replaceRange(d.map(u.pos),d.map(c.pos),l?Slice.empty:t),l==0&&selectionToInsertionEnd$1(e,o,(n?n.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],u=e.mapping.slice(n),c=u.map(a.pos),d=u.map(l.pos);o?e.deleteRange(c,d):(e.replaceRangeWith(c,d,t),selectionToInsertionEnd$1(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let s=e.parent.inlineContent?new TextSelection(e):findSelectionIn(e.node(0),e.parent,e.pos,e.index(),t,n);if(s)return s;for(let o=e.depth-1;o>=0;o--){let a=t<0?findSelectionIn(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):findSelectionIn(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(a)return a}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new AllSelection(e.node(0))}static atStart(e){return findSelectionIn(e,e,0,0,1)||new AllSelection(e)}static atEnd(e){return findSelectionIn(e,e,e.content.size,e.childCount,-1)||new AllSelection(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=classesById[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in classesById)throw new RangeError("Duplicate use of selection JSON ID "+e);return classesById[e]=t,t.prototype.jsonID=e,t}getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()}}Selection.prototype.visible=!0;class SelectionRange{constructor(e,t){this.$from=e,this.$to=t}}let warnedAboutTextSelection=!1;function checkTextSelection(r){!warnedAboutTextSelection&&!r.parent.inlineContent&&(warnedAboutTextSelection=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class TextSelection extends Selection{constructor(e,t=e){checkTextSelection(e),checkTextSelection(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return Selection.near(n);let s=e.resolve(t.map(this.anchor));return new TextSelection(s.parent.inlineContent?s:n,n)}replace(e,t=Slice.empty){if(super.replace(e,t),t==Slice.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof TextSelection&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new TextBookmark(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let s=e.resolve(t);return new this(s,n==t?s:e.resolve(n))}static between(e,t,n){let s=e.pos-t.pos;if((!n||s)&&(n=s>=0?1:-1),!t.parent.inlineContent){let o=Selection.findFrom(t,n,!0)||Selection.findFrom(t,-n,!0);if(o)t=o.$head;else return Selection.near(t,n)}return e.parent.inlineContent||(s==0?e=t:(e=(Selection.findFrom(e,-n,!0)||Selection.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new TextSelection(e,t)}}Selection.jsonID("text",TextSelection);class TextBookmark{constructor(e,t){this.anchor=e,this.head=t}map(e){return new TextBookmark(e.map(this.anchor),e.map(this.head))}resolve(e){return TextSelection.between(e.resolve(this.anchor),e.resolve(this.head))}}class NodeSelection extends Selection{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:s}=t.mapResult(this.anchor),o=e.resolve(s);return n?Selection.near(o):new NodeSelection(o)}content(){return new Slice(Fragment.from(this.node),0,0)}eq(e){return e instanceof NodeSelection&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new NodeBookmark(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(e.resolve(t.anchor))}static create(e,t){return new NodeSelection(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}NodeSelection.prototype.visible=!1;Selection.jsonID("node",NodeSelection);class NodeBookmark{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new TextBookmark(n,n):new NodeBookmark(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&NodeSelection.isSelectable(n)?new NodeSelection(t):Selection.near(t)}}class AllSelection extends Selection{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Slice.empty){if(t==Slice.empty){e.delete(0,e.doc.content.size);let n=Selection.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new AllSelection(e)}map(e){return new AllSelection(e)}eq(e){return e instanceof AllSelection}getBookmark(){return AllBookmark}}Selection.jsonID("all",AllSelection);const AllBookmark={map(){return this},resolve(r){return new AllSelection(r)}};function findSelectionIn(r,e,t,n,s,o=!1){if(e.inlineContent)return TextSelection.create(r,t);for(let a=n-(s>0?0:1);s>0?a<e.childCount:a>=0;a+=s){let l=e.child(a);if(l.isAtom){if(!o&&NodeSelection.isSelectable(l))return NodeSelection.create(r,t-(s<0?l.nodeSize:0))}else{let u=findSelectionIn(r,l,t+s,s<0?l.childCount:0,s,o);if(u)return u}t+=l.nodeSize*s}return null}function selectionToInsertionEnd$1(r,e,t){let n=r.steps.length-1;if(n<e)return;let s=r.steps[n];if(!(s instanceof ReplaceStep||s instanceof ReplaceAroundStep))return;let o=r.mapping.maps[n],a;o.forEach((l,u,c,d)=>{a==null&&(a=d)}),r.setSelection(Selection.near(r.doc.resolve(a),t))}const UPDATED_SEL=1,UPDATED_MARKS=2,UPDATED_SCROLL=4;class Transaction extends Transform{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|UPDATED_SEL)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&UPDATED_SEL)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=UPDATED_MARKS,this}ensureMarks(e){return Mark$1.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&UPDATED_MARKS)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Mark$1.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(n==null&&(n=t),n=n??t,!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let a=this.doc.resolve(t);o=n==t?a.marks():a.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,s.text(e,o)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=UPDATED_SCROLL,this}get scrolledIntoView(){return(this.updated&UPDATED_SCROLL)>0}}function bind(r,e){return!e||!r?r:r.bind(e)}class FieldDesc{constructor(e,t,n){this.name=e,this.init=bind(t.init,n),this.apply=bind(t.apply,n)}}const baseFields=[new FieldDesc("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new FieldDesc("selection",{init(r,e){return r.selection||Selection.atStart(e.doc)},apply(r){return r.selection}}),new FieldDesc("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,t,n){return n.selection.$cursor?r.storedMarks:null}}),new FieldDesc("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}})];class Configuration{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=baseFields.slice(),t&&t.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new FieldDesc(n.key,n.spec.state,n))})}}class EditorState{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let s=this.config.plugins[n];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),s=null;for(;;){let o=!1;for(let a=0;a<this.config.plugins.length;a++){let l=this.config.plugins[a];if(l.spec.appendTransaction){let u=s?s[a].n:0,c=s?s[a].state:this,d=u<t.length&&l.spec.appendTransaction.call(l,u?t.slice(u):t,c,n);if(d&&n.filterTransaction(d,a)){if(d.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<a?{state:n,n:t.length}:{state:this,n:0})}t.push(d),n=n.applyInner(d),o=!0}s&&(s[a]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new EditorState(this.config),n=this.config.fields;for(let s=0;s<n.length;s++){let o=n[s];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new Transaction(this)}static create(e){let t=new Configuration(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new EditorState(t);for(let s=0;s<t.fields.length;s++)n[t.fields[s].name]=t.fields[s].init(e,n);return n}reconfigure(e){let t=new Configuration(this.schema,e.plugins),n=t.fields,s=new EditorState(t);for(let o=0;o<n.length;o++){let a=n[o].name;s[a]=this.hasOwnProperty(a)?this[a]:n[o].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[n],o=s.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Configuration(e.schema,e.plugins),o=new EditorState(s);return s.fields.forEach(a=>{if(a.name=="doc")o.doc=Node$2.fromJSON(e.schema,t.doc);else if(a.name=="selection")o.selection=Selection.fromJSON(o.doc,t.selection);else if(a.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let l in n){let u=n[l],c=u.spec.state;if(u.key==a.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){o[a.name]=c.fromJSON.call(u,e,t[l],o);return}}o[a.name]=a.init(e,o)}}),o}}function bindProps(r,e,t){for(let n in r){let s=r[n];s instanceof Function?s=s.bind(e):n=="handleDOMEvents"&&(s=bindProps(s,e,{})),t[n]=s}return t}class Plugin{constructor(e){this.spec=e,this.props={},e.props&&bindProps(e.props,this,this.props),this.key=e.key?e.key.key:createKey("plugin")}getState(e){return e[this.key]}}const keys=Object.create(null);function createKey(r){return r in keys?r+"$"+ ++keys[r]:(keys[r]=0,r+"$")}class PluginKey{constructor(e="key"){this.key=createKey(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const domIndex=function(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e},parentNode=function(r){let e=r.assignedSlot||r.parentNode;return e&&e.nodeType==11?e.host:e};let reusedRange=null;const textRange=function(r,e,t){let n=reusedRange||(reusedRange=document.createRange());return n.setEnd(r,t??r.nodeValue.length),n.setStart(r,e||0),n},clearReusedRange=function(){reusedRange=null},isEquivalentPosition=function(r,e,t,n){return t&&(scanFor(r,e,t,n,-1)||scanFor(r,e,t,n,1))},atomElements=/^(img|br|input|textarea|hr)$/i;function scanFor(r,e,t,n,s){for(;;){if(r==t&&e==n)return!0;if(e==(s<0?0:nodeSize(r))){let o=r.parentNode;if(!o||o.nodeType!=1||hasBlockDesc(r)||atomElements.test(r.nodeName)||r.contentEditable=="false")return!1;e=domIndex(r)+(s<0?0:1),r=o}else if(r.nodeType==1){if(r=r.childNodes[e+(s<0?-1:0)],r.contentEditable=="false")return!1;e=s<0?nodeSize(r):0}else return!1}}function nodeSize(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function textNodeBefore$1(r,e){for(;;){if(r.nodeType==3&&e)return r;if(r.nodeType==1&&e>0){if(r.contentEditable=="false")return null;r=r.childNodes[e-1],e=nodeSize(r)}else if(r.parentNode&&!hasBlockDesc(r))e=domIndex(r),r=r.parentNode;else return null}}function textNodeAfter$1(r,e){for(;;){if(r.nodeType==3&&e<r.nodeValue.length)return r;if(r.nodeType==1&&e<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[e],e=0}else if(r.parentNode&&!hasBlockDesc(r))e=domIndex(r)+1,r=r.parentNode;else return null}}function isOnEdge(r,e,t){for(let n=e==0,s=e==nodeSize(r);n||s;){if(r==t)return!0;let o=domIndex(r);if(r=r.parentNode,!r)return!1;n=n&&o==0,s=s&&o==nodeSize(r)}}function hasBlockDesc(r){let e;for(let t=r;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==r||e.contentDOM==r)}const selectionCollapsed=function(r){return r.focusNode&&isEquivalentPosition(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function keyEvent(r,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=r,t.key=t.code=e,t}function deepActiveElement(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function caretFromPoint(r,e,t){if(r.caretPositionFromPoint)try{let n=r.caretPositionFromPoint(e,t);if(n)return{node:n.offsetNode,offset:Math.min(nodeSize(n.offsetNode),n.offset)}}catch{}if(r.caretRangeFromPoint){let n=r.caretRangeFromPoint(e,t);if(n)return{node:n.startContainer,offset:Math.min(nodeSize(n.startContainer),n.startOffset)}}}const nav=typeof navigator<"u"?navigator:null,doc=typeof document<"u"?document:null,agent=nav&&nav.userAgent||"",ie_edge=/Edge\/(\d+)/.exec(agent),ie_upto10=/MSIE \d/.exec(agent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(agent),ie$1=!!(ie_upto10||ie_11up||ie_edge),ie_version=ie_upto10?document.documentMode:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko=!ie$1&&/gecko\/(\d+)/i.test(agent);gecko&&+(/Firefox\/(\d+)/.exec(agent)||[0,0])[1];const _chrome=!ie$1&&/Chrome\/(\d+)/.exec(agent),chrome=!!_chrome,chrome_version=_chrome?+_chrome[1]:0,safari=!ie$1&&!!nav&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(agent)||!!nav&&nav.maxTouchPoints>2),mac$2=ios||(nav?/Mac/.test(nav.platform):!1),windows=nav?/Win/.test(nav.platform):!1,android=/Android \d/.test(agent),webkit=!!doc&&"webkitFontSmoothing"in doc.documentElement.style,webkit_version=webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function windowRect(r){let e=r.defaultView&&r.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function getSide(r,e){return typeof r=="number"?r:r[e]}function clientRect(r){let e=r.getBoundingClientRect(),t=e.width/r.offsetWidth||1,n=e.height/r.offsetHeight||1;return{left:e.left,right:e.left+r.clientWidth*t,top:e.top,bottom:e.top+r.clientHeight*n}}function scrollRectIntoView(r,e,t){let n=r.someProp("scrollThreshold")||0,s=r.someProp("scrollMargin")||5,o=r.dom.ownerDocument;for(let a=t||r.dom;a;a=parentNode(a)){if(a.nodeType!=1)continue;let l=a,u=l==o.body,c=u?windowRect(o):clientRect(l),d=0,f=0;if(e.top<c.top+getSide(n,"top")?f=-(c.top-e.top+getSide(s,"top")):e.bottom>c.bottom-getSide(n,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+getSide(s,"top")-c.top:e.bottom-c.bottom+getSide(s,"bottom")),e.left<c.left+getSide(n,"left")?d=-(c.left-e.left+getSide(s,"left")):e.right>c.right-getSide(n,"right")&&(d=e.right-c.right+getSide(s,"right")),d||f)if(u)o.defaultView.scrollBy(d,f);else{let C=l.scrollLeft,m=l.scrollTop;f&&(l.scrollTop+=f),d&&(l.scrollLeft+=d);let E=l.scrollLeft-C,v=l.scrollTop-m;e={left:e.left-E,top:e.top-v,right:e.right-E,bottom:e.bottom-v}}if(u||/^(fixed|sticky)$/.test(getComputedStyle(a).position))break}}function storeScrollPos(r){let e=r.dom.getBoundingClientRect(),t=Math.max(0,e.top),n,s;for(let o=(e.left+e.right)/2,a=t+1;a<Math.min(innerHeight,e.bottom);a+=5){let l=r.root.elementFromPoint(o,a);if(!l||l==r.dom||!r.dom.contains(l))continue;let u=l.getBoundingClientRect();if(u.top>=t-20){n=l,s=u.top;break}}return{refDOM:n,refTop:s,stack:scrollStack(r.dom)}}function scrollStack(r){let e=[],t=r.ownerDocument;for(let n=r;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),r!=t);n=parentNode(n));return e}function resetScrollPos({refDOM:r,refTop:e,stack:t}){let n=r?r.getBoundingClientRect().top:0;restoreScrollStack(t,n==0?0:n-e)}function restoreScrollStack(r,e){for(let t=0;t<r.length;t++){let{dom:n,top:s,left:o}=r[t];n.scrollTop!=s+e&&(n.scrollTop=s+e),n.scrollLeft!=o&&(n.scrollLeft=o)}}let preventScrollSupported=null;function focusPreventScroll(r){if(r.setActive)return r.setActive();if(preventScrollSupported)return r.focus(preventScrollSupported);let e=scrollStack(r);r.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),preventScrollSupported||(preventScrollSupported=!1,restoreScrollStack(e,0))}function findOffsetInNode(r,e){let t,n=2e8,s,o=0,a=e.top,l=e.top,u,c;for(let d=r.firstChild,f=0;d;d=d.nextSibling,f++){let C;if(d.nodeType==1)C=d.getClientRects();else if(d.nodeType==3)C=textRange(d).getClientRects();else continue;for(let m=0;m<C.length;m++){let E=C[m];if(E.top<=a&&E.bottom>=l){a=Math.max(E.bottom,a),l=Math.min(E.top,l);let v=E.left>e.left?E.left-e.left:E.right<e.left?e.left-E.right:0;if(v<n){t=d,n=v,s=v&&t.nodeType==3?{left:E.right<e.left?E.right:E.left,top:e.top}:e,d.nodeType==1&&v&&(o=f+(e.left>=(E.left+E.right)/2?1:0));continue}}else E.top>e.top&&!u&&E.left<=e.left&&E.right>=e.left&&(u=d,c={left:Math.max(E.left,Math.min(E.right,e.left)),top:E.top});!t&&(e.left>=E.right&&e.top>=E.top||e.left>=E.left&&e.top>=E.bottom)&&(o=f+1)}}return!t&&u&&(t=u,s=c,n=0),t&&t.nodeType==3?findOffsetInText(t,s):!t||n&&t.nodeType==1?{node:r,offset:o}:findOffsetInNode(t,s)}function findOffsetInText(r,e){let t=r.nodeValue.length,n=document.createRange();for(let s=0;s<t;s++){n.setEnd(r,s+1),n.setStart(r,s);let o=singleRect(n,1);if(o.top!=o.bottom&&inRect(e,o))return{node:r,offset:s+(e.left>=(o.left+o.right)/2?1:0)}}return{node:r,offset:0}}function inRect(r,e){return r.left>=e.left-1&&r.left<=e.right+1&&r.top>=e.top-1&&r.top<=e.bottom+1}function targetKludge(r,e){let t=r.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<r.getBoundingClientRect().left?t:r}function posFromElement(r,e,t){let{node:n,offset:s}=findOffsetInNode(e,t),o=-1;if(n.nodeType==1&&!n.firstChild){let a=n.getBoundingClientRect();o=a.left!=a.right&&t.left>(a.left+a.right)/2?1:-1}return r.docView.posFromDOM(n,s,o)}function posFromCaret(r,e,t,n){let s=-1;for(let o=e,a=!1;o!=r.dom;){let l=r.docView.nearestDesc(o,!0),u;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((u=l.dom.getBoundingClientRect()).width||u.height)&&(l.node.isBlock&&l.parent&&(!a&&u.left>n.left||u.top>n.top?s=l.posBefore:(!a&&u.right<n.left||u.bottom<n.top)&&(s=l.posAfter),a=!0),!l.contentDOM&&s<0&&!l.node.isText))return(l.node.isBlock?n.top<(u.top+u.bottom)/2:n.left<(u.left+u.right)/2)?l.posBefore:l.posAfter;o=l.dom.parentNode}return s>-1?s:r.docView.posFromDOM(e,t,-1)}function elementFromPoint(r,e,t){let n=r.childNodes.length;if(n&&t.top<t.bottom)for(let s=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-t.top)/(t.bottom-t.top))-2)),o=s;;){let a=r.childNodes[o];if(a.nodeType==1){let l=a.getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(inRect(e,c))return elementFromPoint(a,e,c)}}if((o=(o+1)%n)==s)break}return r}function posAtCoords(r,e){let t=r.dom.ownerDocument,n,s=0,o=caretFromPoint(t,e.left,e.top);o&&({node:n,offset:s}=o);let a=(r.root.elementFromPoint?r.root:t).elementFromPoint(e.left,e.top),l;if(!a||!r.dom.contains(a.nodeType!=1?a.parentNode:a)){let c=r.dom.getBoundingClientRect();if(!inRect(e,c)||(a=elementFromPoint(r.dom,e,c),!a))return null}if(safari)for(let c=a;n&&c;c=parentNode(c))c.draggable&&(n=void 0);if(a=targetKludge(a,e),n){if(gecko&&n.nodeType==1&&(s=Math.min(s,n.childNodes.length),s<n.childNodes.length)){let d=n.childNodes[s],f;d.nodeName=="IMG"&&(f=d.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&s++}let c;webkit&&s&&n.nodeType==1&&(c=n.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,n==r.dom&&s==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?l=r.state.doc.content.size:(s==0||n.nodeType!=1||n.childNodes[s-1].nodeName!="BR")&&(l=posFromCaret(r,n,s,e))}l==null&&(l=posFromElement(r,a,e));let u=r.docView.nearestDesc(a,!0);return{pos:l,inside:u?u.posAtStart-u.border:-1}}function nonZero(r){return r.top<r.bottom||r.left<r.right}function singleRect(r,e){let t=r.getClientRects();if(t.length){let n=t[e<0?0:t.length-1];if(nonZero(n))return n}return Array.prototype.find.call(t,nonZero)||r.getBoundingClientRect()}const BIDI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function coordsAtPos(r,e,t){let{node:n,offset:s,atom:o}=r.docView.domFromPos(e,t<0?-1:1),a=webkit||gecko;if(n.nodeType==3)if(a&&(BIDI.test(n.nodeValue)||(t<0?!s:s==n.nodeValue.length))){let u=singleRect(textRange(n,s,s),t);if(gecko&&s&&/\s/.test(n.nodeValue[s-1])&&s<n.nodeValue.length){let c=singleRect(textRange(n,s-1,s-1),-1);if(c.top==u.top){let d=singleRect(textRange(n,s,s+1),-1);if(d.top!=u.top)return flattenV(d,d.left<c.left)}}return u}else{let u=s,c=s,d=t<0?1:-1;return t<0&&!s?(c++,d=-1):t>=0&&s==n.nodeValue.length?(u--,d=1):t<0?u--:c++,flattenV(singleRect(textRange(n,u,c),d),d<0)}if(!r.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&s&&(t<0||s==nodeSize(n))){let u=n.childNodes[s-1];if(u.nodeType==1)return flattenH(u.getBoundingClientRect(),!1)}if(o==null&&s<nodeSize(n)){let u=n.childNodes[s];if(u.nodeType==1)return flattenH(u.getBoundingClientRect(),!0)}return flattenH(n.getBoundingClientRect(),t>=0)}if(o==null&&s&&(t<0||s==nodeSize(n))){let u=n.childNodes[s-1],c=u.nodeType==3?textRange(u,nodeSize(u)-(a?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(c)return flattenV(singleRect(c,1),!1)}if(o==null&&s<nodeSize(n)){let u=n.childNodes[s];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let c=u?u.nodeType==3?textRange(u,0,a?0:1):u.nodeType==1?u:null:null;if(c)return flattenV(singleRect(c,-1),!0)}return flattenV(singleRect(n.nodeType==3?textRange(n):n,-t),t>=0)}function flattenV(r,e){if(r.width==0)return r;let t=e?r.left:r.right;return{top:r.top,bottom:r.bottom,left:t,right:t}}function flattenH(r,e){if(r.height==0)return r;let t=e?r.top:r.bottom;return{top:t,bottom:t,left:r.left,right:r.right}}function withFlushedState(r,e,t){let n=r.state,s=r.root.activeElement;n!=e&&r.updateState(e),s!=r.dom&&r.focus();try{return t()}finally{n!=e&&r.updateState(n),s!=r.dom&&s&&s.focus()}}function endOfTextblockVertical(r,e,t){let n=e.selection,s=t=="up"?n.$from:n.$to;return withFlushedState(r,e,()=>{let{node:o}=r.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let l=r.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let a=coordsAtPos(r,s.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=textRange(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<u.length;c++){let d=u[c];if(d.bottom>d.top+1&&(t=="up"?a.top-d.top>(d.bottom-a.top)*2:d.bottom-a.bottom>(a.bottom-d.top)*2))return!1}}return!0})}const maybeRTL=/[\u0590-\u08ac]/;function endOfTextblockHorizontal(r,e,t){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let s=n.parentOffset,o=!s,a=s==n.parent.content.size,l=r.domSelection();return l?!maybeRTL.test(n.parent.textContent)||!l.modify?t=="left"||t=="backward"?o:a:withFlushedState(r,e,()=>{let{focusNode:u,focusOffset:c,anchorNode:d,anchorOffset:f}=r.domSelectionRange(),C=l.caretBidiLevel;l.modify("move",t,"character");let m=n.depth?r.docView.domAfterPos(n.before()):r.dom,{focusNode:E,focusOffset:v}=r.domSelectionRange(),_=E&&!m.contains(E.nodeType==1?E:E.parentNode)||u==E&&c==v;try{l.collapse(d,f),u&&(u!=d||c!=f)&&l.extend&&l.extend(u,c)}catch{}return C!=null&&(l.caretBidiLevel=C),_}):n.pos==n.start()||n.pos==n.end()}let cachedState=null,cachedDir=null,cachedResult=!1;function endOfTextblock(r,e,t){return cachedState==e&&cachedDir==t?cachedResult:(cachedState=e,cachedDir=t,cachedResult=t=="up"||t=="down"?endOfTextblockVertical(r,e,t):endOfTextblockHorizontal(r,e,t))}const NOT_DIRTY=0,CHILD_DIRTY=1,CONTENT_DIRTY=2,NODE_DIRTY=3;class ViewDesc{constructor(e,t,n,s){this.parent=e,this.children=t,this.dom=n,this.contentDOM=s,this.dirty=NOT_DIRTY,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let s=this.children[t];if(s==e)return n;n+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let o,a;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(a)+a.size:this.posAtStart}else{let o,a;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(a):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>domIndex(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){s=!1;break}if(o.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){s=!0;break}if(o.nextSibling)break}}return s??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,s=e;s;s=s.parentNode){let o=this.getDesc(s),a;if(o&&(!t||o.node))if(n&&(a=o.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))n=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let s=e;s;s=s.parentNode){let o=this.getDesc(s);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let s=this.children[t],o=n+s.size;if(n==e&&o!=n){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(e<o)return s.descAt(e-n-s.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,s=0;for(let o=0;n<this.children.length;n++){let a=this.children[n],l=o+a.size;if(l>e||a instanceof TrailingHackViewDesc){s=e-o;break}o=l}if(s)return this.children[n].domFromPos(s-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof WidgetViewDesc&&o.side>=0;n--);if(t<=0){let o,a=!0;for(;o=n?this.children[n-1]:null,!(!o||o.dom.parentNode==this.contentDOM);n--,a=!1);return o&&t&&a&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?domIndex(o.dom)+1:0}}else{let o,a=!0;for(;o=n<this.children.length?this.children[n]:null,!(!o||o.dom.parentNode==this.contentDOM);n++,a=!1);return o&&a&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?domIndex(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,o=-1;for(let a=n,l=0;;l++){let u=this.children[l],c=a+u.size;if(s==-1&&e<=c){let d=a+u.border;if(e>=d&&t<=c-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(e,t,d);e=a;for(let f=l;f>0;f--){let C=this.children[f-1];if(C.size&&C.dom.parentNode==this.contentDOM&&!C.emptyChildAt(1)){s=domIndex(C.dom)+1;break}e-=C.size}s==-1&&(s=0)}if(s>-1&&(c>t||l==this.children.length-1)){t=c;for(let d=l+1;d<this.children.length;d++){let f=this.children[d];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=domIndex(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}a=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(t.nodeType!=1||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,s=!1){let o=Math.min(e,t),a=Math.max(e,t);for(let m=0,E=0;m<this.children.length;m++){let v=this.children[m],_=E+v.size;if(o>E&&a<_)return v.setSelection(e-E-v.border,t-E-v.border,n,s);E=_}let l=this.domFromPos(e,e?-1:1),u=t==e?l:this.domFromPos(t,t?-1:1),c=n.root.getSelection(),d=n.domSelectionRange(),f=!1;if((gecko||safari)&&e==t){let{node:m,offset:E}=l;if(m.nodeType==3){if(f=!!(E&&m.nodeValue[E-1]==`
`),f&&E==m.nodeValue.length)for(let v=m,_;v;v=v.parentNode){if(_=v.nextSibling){_.nodeName=="BR"&&(l=u={node:_.parentNode,offset:domIndex(_)+1});break}let T=v.pmViewDesc;if(T&&T.node&&T.node.isBlock)break}}else{let v=m.childNodes[E-1];f=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(gecko&&d.focusNode&&d.focusNode!=u.node&&d.focusNode.nodeType==1){let m=d.focusNode.childNodes[d.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||f&&safari)&&isEquivalentPosition(l.node,l.offset,d.anchorNode,d.anchorOffset)&&isEquivalentPosition(u.node,u.offset,d.focusNode,d.focusOffset))return;let C=!1;if((c.extend||e==t)&&!f){c.collapse(l.node,l.offset);try{e!=t&&c.extend(u.node,u.offset),C=!0}catch{}}if(!C){if(e>t){let E=l;l=u,u=E}let m=document.createRange();m.setEnd(u.node,u.offset),m.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,s=0;s<this.children.length;s++){let o=this.children[s],a=n+o.size;if(n==a?e<=a&&t>=n:e<a&&t>n){let l=n+o.border,u=a-o.border;if(e>=l&&t<=u){this.dirty=e==n||t==a?CONTENT_DIRTY:CHILD_DIRTY,e==l&&t==u&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=NODE_DIRTY:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?CONTENT_DIRTY:NODE_DIRTY}n=a}this.dirty=CONTENT_DIRTY}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=e==1?CONTENT_DIRTY:CHILD_DIRTY;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class WidgetViewDesc extends ViewDesc{constructor(e,t,n,s){let o,a=t.type.toDOM;if(typeof a=="function"&&(a=a(n,()=>{if(!o)return s;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(a.nodeType!=1){let l=document.createElement("span");l.appendChild(a),a=l}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==NOT_DIRTY&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class CompositionViewDesc extends ViewDesc{constructor(e,t,n,s){super(e,[],t,null),this.textDOM=n,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class MarkViewDesc extends ViewDesc{constructor(e,t,n,s,o){super(e,[],n,s),this.mark=t,this.spec=o}static create(e,t,n,s){let o=s.nodeViews[t.type.name],a=o&&o(t,s,n);return(!a||!a.dom)&&(a=DOMSerializer.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new MarkViewDesc(e,t,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&NODE_DIRTY||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=NODE_DIRTY&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=NOT_DIRTY){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=NOT_DIRTY}}slice(e,t,n){let s=MarkViewDesc.create(this.parent,this.mark,!0,n),o=this.children,a=this.size;t<a&&(o=replaceNodes(o,t,a,n)),e>0&&(o=replaceNodes(o,0,e,n));for(let l=0;l<o.length;l++)o[l].parent=s;return s.children=o,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class NodeViewDesc extends ViewDesc{constructor(e,t,n,s,o,a,l,u,c){super(e,[],o,a),this.node=t,this.outerDeco=n,this.innerDeco=s,this.nodeDOM=l}static create(e,t,n,s,o,a){let l=o.nodeViews[t.type.name],u,c=l&&l(t,o,()=>{if(!u)return a;if(u.parent)return u.parent.posBeforeChild(u)},n,s),d=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!d)d=document.createTextNode(t.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:f}=DOMSerializer.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),t.type.spec.draggable&&(d.draggable=!0));let C=d;return d=applyOuterDeco(d,n,t),c?u=new CustomNodeViewDesc(e,t,n,s,d,f||null,C,c,o,a+1):t.isText?new TextViewDesc(e,t,n,s,d,C,o):new NodeViewDesc(e,t,n,s,d,f||null,C,o,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Fragment.empty)}return e}matchesNode(e,t,n){return this.dirty==NOT_DIRTY&&e.eq(this.node)&&sameOuterDeco(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,s=t,o=e.composing?this.localCompositionInfo(e,t):null,a=o&&o.pos>-1?o:null,l=o&&o.pos<0,u=new ViewTreeUpdater(this,a&&a.node,e);iterDeco(this.node,this.innerDeco,(c,d,f)=>{c.spec.marks?u.syncToMarks(c.spec.marks,n,e):c.type.side>=0&&!f&&u.syncToMarks(d==this.node.childCount?Mark$1.none:this.node.child(d).marks,n,e),u.placeWidget(c,e,s)},(c,d,f,C)=>{u.syncToMarks(c.marks,n,e);let m;u.findNodeMatch(c,d,f,C)||l&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=u.findIndexWithChild(o.node))>-1&&u.updateNodeAt(c,d,f,m,e)||u.updateNextNode(c,d,f,e,C,s)||u.addNode(c,d,f,e,s),s+=c.nodeSize}),u.syncToMarks([],n,e),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==CONTENT_DIRTY)&&(a&&this.protectLocalComposition(e,a),renderDescs(this.contentDOM,this.children,e),ios&&iosHacks(this.dom))}localCompositionInfo(e,t){let{from:n,to:s}=e.state.selection;if(!(e.state.selection instanceof TextSelection)||n<t||s>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,l=findTextInFragment(this.node.content,a,n-t,s-t);return l<0?null:{node:o,pos:l,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:s}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let a=new CompositionViewDesc(this,o,t,s);e.input.compositionNodes.push(a),this.children=replaceNodes(this.children,n,n+s.length,e,a)}update(e,t,n,s){return this.dirty==NODE_DIRTY||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,n,s),!0)}updateInner(e,t,n,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=NOT_DIRTY}updateOuterDeco(e){if(sameOuterDeco(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=patchOuterDeco(this.dom,this.nodeDOM,computeOuterDeco(this.outerDeco,this.node,t),computeOuterDeco(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function docViewDesc(r,e,t,n,s){applyOuterDeco(n,e,r);let o=new NodeViewDesc(void 0,r,e,t,n,n,n,s,0);return o.contentDOM&&o.updateChildren(s,0),o}class TextViewDesc extends NodeViewDesc{constructor(e,t,n,s,o,a,l){super(e,t,n,s,o,null,a,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,s){return this.dirty==NODE_DIRTY||this.dirty!=NOT_DIRTY&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=NOT_DIRTY||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=NOT_DIRTY,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,n){let s=this.node.cut(e,t),o=document.createTextNode(s.text);return new TextViewDesc(this.parent,s,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=NODE_DIRTY)}get domAtom(){return!1}isText(e){return this.node.text==e}}class TrailingHackViewDesc extends ViewDesc{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==NOT_DIRTY&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class CustomNodeViewDesc extends NodeViewDesc{constructor(e,t,n,s,o,a,l,u,c,d){super(e,t,n,s,o,a,l,c,d),this.spec=u}update(e,t,n,s){if(this.dirty==NODE_DIRTY)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,s),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,n,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,s){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function renderDescs(r,e,t){let n=r.firstChild,s=!1;for(let o=0;o<e.length;o++){let a=e[o],l=a.dom;if(l.parentNode==r){for(;l!=n;)n=rm(n),s=!0;n=n.nextSibling}else s=!0,r.insertBefore(l,n);if(a instanceof MarkViewDesc){let u=n?n.previousSibling:r.lastChild;renderDescs(a.contentDOM,a.children,t),n=u?u.nextSibling:r.firstChild}}for(;n;)n=rm(n),s=!0;s&&t.trackWrites==r&&(t.trackWrites=null)}const OuterDecoLevel=function(r){r&&(this.nodeName=r)};OuterDecoLevel.prototype=Object.create(null);const noDeco=[new OuterDecoLevel];function computeOuterDeco(r,e,t){if(r.length==0)return noDeco;let n=t?noDeco[0]:new OuterDecoLevel,s=[n];for(let o=0;o<r.length;o++){let a=r[o].type.attrs;if(a){a.nodeName&&s.push(n=new OuterDecoLevel(a.nodeName));for(let l in a){let u=a[l];u!=null&&(t&&s.length==1&&s.push(n=new OuterDecoLevel(e.isInline?"span":"div")),l=="class"?n.class=(n.class?n.class+" ":"")+u:l=="style"?n.style=(n.style?n.style+";":"")+u:l!="nodeName"&&(n[l]=u))}}}return s}function patchOuterDeco(r,e,t,n){if(t==noDeco&&n==noDeco)return e;let s=e;for(let o=0;o<n.length;o++){let a=n[o],l=t[o];if(o){let u;l&&l.nodeName==a.nodeName&&s!=r&&(u=s.parentNode)&&u.nodeName.toLowerCase()==a.nodeName||(u=document.createElement(a.nodeName),u.pmIsDeco=!0,u.appendChild(s),l=noDeco[0]),s=u}patchAttributes(s,l||noDeco[0],a)}return s}function patchAttributes(r,e,t){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in t)&&r.removeAttribute(n);for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&t[n]!=e[n]&&r.setAttribute(n,t[n]);if(e.class!=t.class){let n=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<n.length;o++)s.indexOf(n[o])==-1&&r.classList.remove(n[o]);for(let o=0;o<s.length;o++)n.indexOf(s[o])==-1&&r.classList.add(s[o]);r.classList.length==0&&r.removeAttribute("class")}if(e.style!=t.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=n.exec(e.style);)r.style.removeProperty(s[1])}t.style&&(r.style.cssText+=t.style)}}function applyOuterDeco(r,e,t){return patchOuterDeco(r,r,noDeco,computeOuterDeco(e,t,r.nodeType!=1))}function sameOuterDeco(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].type.eq(e[t].type))return!1;return!0}function rm(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class ViewTreeUpdater{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=preMatch(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let s=0,o=this.stack.length>>1,a=Math.min(o,e.length);for(;s<a&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=NOT_DIRTY,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let u=this.index;u<Math.min(this.index+3,this.top.children.length);u++){let c=this.top.children[u];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let u=MarkViewDesc.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,s){let o=-1,a;if(s>=this.preMatch.index&&(a=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&a.matchesNode(e,t,n))o=this.top.children.indexOf(a,this.index);else for(let l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){let c=this.top.children[l];if(c.matchesNode(e,t,n)&&!this.preMatch.matched.has(c)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,n,s,o){let a=this.top.children[s];return a.dirty==NODE_DIRTY&&a.dom==a.contentDOM&&(a.dirty=CONTENT_DIRTY),a.update(e,t,n,o)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==n)return s}return-1}e=t}}updateNextNode(e,t,n,s,o,a){for(let l=this.index;l<this.top.children.length;l++){let u=this.top.children[l];if(u instanceof NodeViewDesc){let c=this.preMatch.matched.get(u);if(c!=null&&c!=o)return!1;let d=u.dom,f,C=this.isLocked(d)&&!(e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&u.dirty!=NODE_DIRTY&&sameOuterDeco(t,u.outerDeco));if(!C&&u.update(e,t,n,s))return this.destroyBetween(this.index,l),u.dom!=d&&(this.changed=!0),this.index++,!0;if(!C&&(f=this.recreateWrapper(u,e,t,n,s,a)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=CONTENT_DIRTY,f.updateChildren(s,a+1),f.dirty=NOT_DIRTY),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,s,o,a){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!sameOuterDeco(n,e.outerDeco)||!s.eq(e.innerDeco))return null;let l=NodeViewDesc.create(this.top,t,n,s,o,a);if(l.contentDOM){l.children=e.children,e.children=[];for(let u of l.children)u.parent=l}return e.destroy(),l}addNode(e,t,n,s,o){let a=NodeViewDesc.create(this.top,e,t,n,s,o);a.contentDOM&&a.updateChildren(s,o+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,t,n){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let o=new WidgetViewDesc(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof MarkViewDesc;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof TextViewDesc)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((safari||chrome)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let s=new TrailingHackViewDesc(this.top,[],n,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function preMatch(r,e){let t=e,n=t.children.length,s=r.childCount,o=new Map,a=[];e:for(;s>0;){let l;for(;;)if(n){let c=t.children[n-1];if(c instanceof MarkViewDesc)t=c,n=c.children.length;else{l=c,n--;break}}else{if(t==e)break e;n=t.parent.children.indexOf(t),t=t.parent}let u=l.node;if(u){if(u!=r.child(s-1))break;--s,o.set(l,s),a.push(l)}}return{index:s,matched:o,matches:a.reverse()}}function compareSide(r,e){return r.type.side-e.type.side}function iterDeco(r,e,t,n){let s=e.locals(r),o=0;if(s.length==0){for(let c=0;c<r.childCount;c++){let d=r.child(c);n(d,s,e.forChild(o,d),c),o+=d.nodeSize}return}let a=0,l=[],u=null;for(let c=0;;){let d,f;for(;a<s.length&&s[a].to==o;){let _=s[a++];_.widget&&(d?(f||(f=[d])).push(_):d=_)}if(d)if(f){f.sort(compareSide);for(let _=0;_<f.length;_++)t(f[_],c,!!u)}else t(d,c,!!u);let C,m;if(u)m=-1,C=u,u=null;else if(c<r.childCount)m=c,C=r.child(c++);else break;for(let _=0;_<l.length;_++)l[_].to<=o&&l.splice(_--,1);for(;a<s.length&&s[a].from<=o&&s[a].to>o;)l.push(s[a++]);let E=o+C.nodeSize;if(C.isText){let _=E;a<s.length&&s[a].from<_&&(_=s[a].from);for(let T=0;T<l.length;T++)l[T].to<_&&(_=l[T].to);_<E&&(u=C.cut(_-o),C=C.cut(0,_-o),E=_,m=-1)}else for(;a<s.length&&s[a].to<E;)a++;let v=C.isInline&&!C.isLeaf?l.filter(_=>!_.inline):l.slice();n(C,v,e.forChild(o,C),m),o=E}}function iosHacks(r){if(r.nodeName=="UL"||r.nodeName=="OL"){let e=r.style.cssText;r.style.cssText=e+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=e}}function findTextInFragment(r,e,t,n){for(let s=0,o=0;s<r.childCount&&o<=n;){let a=r.child(s++),l=o;if(o+=a.nodeSize,!a.isText)continue;let u=a.text;for(;s<r.childCount;){let c=r.child(s++);if(o+=c.nodeSize,!c.isText)break;u+=c.text}if(o>=t){if(o>=n&&u.slice(n-e.length-l,n-l)==e)return n-e.length;let c=l<n?u.lastIndexOf(e,n-l-1):-1;if(c>=0&&c+e.length+l>=t)return l+c;if(t==n&&u.length>=n+e.length-l&&u.slice(n-l,n-l+e.length)==e)return n}}return-1}function replaceNodes(r,e,t,n,s){let o=[];for(let a=0,l=0;a<r.length;a++){let u=r[a],c=l,d=l+=u.size;c>=t||d<=e?o.push(u):(c<e&&o.push(u.slice(0,e-c,n)),s&&(o.push(s),s=void 0),d>t&&o.push(u.slice(t-c,u.size,n)))}return o}function selectionFromDOM(r,e=null){let t=r.domSelectionRange(),n=r.state.doc;if(!t.focusNode)return null;let s=r.docView.nearestDesc(t.focusNode),o=s&&s.size==0,a=r.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(a<0)return null;let l=n.resolve(a),u,c;if(selectionCollapsed(t)){for(u=a;s&&!s.node;)s=s.parent;let f=s.node;if(s&&f.isAtom&&NodeSelection.isSelectable(f)&&s.parent&&!(f.isInline&&isOnEdge(t.focusNode,t.focusOffset,s.dom))){let C=s.posBefore;c=new NodeSelection(a==C?l:n.resolve(C))}}else{if(t instanceof r.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=a,C=a;for(let m=0;m<t.rangeCount;m++){let E=t.getRangeAt(m);f=Math.min(f,r.docView.posFromDOM(E.startContainer,E.startOffset,1)),C=Math.max(C,r.docView.posFromDOM(E.endContainer,E.endOffset,-1))}if(f<0)return null;[u,a]=C==r.state.selection.anchor?[C,f]:[f,C],l=n.resolve(a)}else u=r.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null}let d=n.resolve(u);if(!c){let f=e=="pointer"||r.state.selection.head<l.pos&&!o?1:-1;c=selectionBetween(r,d,l,f)}return c}function editorOwnsSelection(r){return r.editable?r.hasFocus():hasSelection(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function selectionToDOM(r,e=!1){let t=r.state.selection;if(syncNodeSelection(r,t),!!editorOwnsSelection(r)){if(!e&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&chrome){let n=r.domSelectionRange(),s=r.domObserver.currentSelection;if(n.anchorNode&&s.anchorNode&&isEquivalentPosition(n.anchorNode,n.anchorOffset,s.anchorNode,s.anchorOffset)){r.input.mouseDown.delayedSelectionSync=!0,r.domObserver.setCurSelection();return}}if(r.domObserver.disconnectSelection(),r.cursorWrapper)selectCursorWrapper(r);else{let{anchor:n,head:s}=t,o,a;brokenSelectBetweenUneditable&&!(t instanceof TextSelection)&&(t.$from.parent.inlineContent||(o=temporarilyEditableNear(r,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(a=temporarilyEditableNear(r,t.to))),r.docView.setSelection(n,s,r,e),brokenSelectBetweenUneditable&&(o&&resetEditable(o),a&&resetEditable(a)),t.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&removeClassOnSelectionChange(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}const brokenSelectBetweenUneditable=safari||chrome&&chrome_version<63;function temporarilyEditableNear(r,e){let{node:t,offset:n}=r.docView.domFromPos(e,0),s=n<t.childNodes.length?t.childNodes[n]:null,o=n?t.childNodes[n-1]:null;if(safari&&s&&s.contentEditable=="false")return setEditable(s);if((!s||s.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(s)return setEditable(s);if(o)return setEditable(o)}}function setEditable(r){return r.contentEditable="true",safari&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function resetEditable(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function removeClassOnSelectionChange(r){let e=r.dom.ownerDocument;e.removeEventListener("selectionchange",r.input.hideSelectionGuard);let t=r.domSelectionRange(),n=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(t.anchorNode!=n||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!editorOwnsSelection(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}function selectCursorWrapper(r){let e=r.domSelection(),t=document.createRange();if(!e)return;let n=r.cursorWrapper.dom,s=n.nodeName=="IMG";s?t.setStart(n.parentNode,domIndex(n)+1):t.setStart(n,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!s&&!r.state.selection.visible&&ie$1&&ie_version<=11&&(n.disabled=!0,n.disabled=!1)}function syncNodeSelection(r,e){if(e instanceof NodeSelection){let t=r.docView.descAt(e.from);t!=r.lastSelectedViewDesc&&(clearNodeSelection(r),t&&t.selectNode(),r.lastSelectedViewDesc=t)}else clearNodeSelection(r)}function clearNodeSelection(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function selectionBetween(r,e,t,n){return r.someProp("createSelectionBetween",s=>s(r,e,t))||TextSelection.between(e,t,n)}function hasFocusAndSelection(r){return r.editable&&!r.hasFocus()?!1:hasSelection(r)}function hasSelection(r){let e=r.domSelectionRange();if(!e.anchorNode)return!1;try{return r.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(r.editable||r.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function anchorInRightPlace(r){let e=r.docView.domFromPos(r.state.selection.anchor,0),t=r.domSelectionRange();return isEquivalentPosition(e.node,e.offset,t.anchorNode,t.anchorOffset)}function moveSelectionBlock(r,e){let{$anchor:t,$head:n}=r.selection,s=e>0?t.max(n):t.min(n),o=s.parent.inlineContent?s.depth?r.doc.resolve(e>0?s.after():s.before()):null:s;return o&&Selection.findFrom(o,e)}function apply(r,e){return r.dispatch(r.state.tr.setSelection(e).scrollIntoView()),!0}function selectHorizontally(r,e,t){let n=r.state.selection;if(n instanceof TextSelection)if(t.indexOf("s")>-1){let{$head:s}=n,o=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let a=r.state.doc.resolve(s.pos+o.nodeSize*(e<0?-1:1));return apply(r,new TextSelection(n.$anchor,a))}else if(n.empty){if(r.endOfTextblock(e>0?"forward":"backward")){let s=moveSelectionBlock(r.state,e);return s&&s instanceof NodeSelection?apply(r,s):!1}else if(!(mac$2&&t.indexOf("m")>-1)){let s=n.$head,o=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,a;if(!o||o.isText)return!1;let l=e<0?s.pos-o.nodeSize:s.pos;return o.isAtom||(a=r.docView.descAt(l))&&!a.contentDOM?NodeSelection.isSelectable(o)?apply(r,new NodeSelection(e<0?r.state.doc.resolve(s.pos-o.nodeSize):s)):webkit?apply(r,new TextSelection(r.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(n instanceof NodeSelection&&n.node.isInline)return apply(r,new TextSelection(e>0?n.$to:n.$from));{let s=moveSelectionBlock(r.state,e);return s?apply(r,s):!1}}}function nodeLen(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function isIgnorable(r,e){let t=r.pmViewDesc;return t&&t.size==0&&(e<0||r.nextSibling||r.nodeName!="BR")}function skipIgnoredNodes(r,e){return e<0?skipIgnoredNodesBefore(r):skipIgnoredNodesAfter(r)}function skipIgnoredNodesBefore(r){let e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let s,o,a=!1;for(gecko&&t.nodeType==1&&n<nodeLen(t)&&isIgnorable(t.childNodes[n],-1)&&(a=!0);;)if(n>0){if(t.nodeType!=1)break;{let l=t.childNodes[n-1];if(isIgnorable(l,-1))s=t,o=--n;else if(l.nodeType==3)t=l,n=t.nodeValue.length;else break}}else{if(isBlockNode(t))break;{let l=t.previousSibling;for(;l&&isIgnorable(l,-1);)s=t.parentNode,o=domIndex(l),l=l.previousSibling;if(l)t=l,n=nodeLen(t);else{if(t=t.parentNode,t==r.dom)break;n=0}}}a?setSelFocus(r,t,n):s&&setSelFocus(r,s,o)}function skipIgnoredNodesAfter(r){let e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let s=nodeLen(t),o,a;for(;;)if(n<s){if(t.nodeType!=1)break;let l=t.childNodes[n];if(isIgnorable(l,1))o=t,a=++n;else break}else{if(isBlockNode(t))break;{let l=t.nextSibling;for(;l&&isIgnorable(l,1);)o=l.parentNode,a=domIndex(l)+1,l=l.nextSibling;if(l)t=l,n=0,s=nodeLen(t);else{if(t=t.parentNode,t==r.dom)break;n=s=0}}}o&&setSelFocus(r,o,a)}function isBlockNode(r){let e=r.pmViewDesc;return e&&e.node&&e.node.isBlock}function textNodeAfter(r,e){for(;r&&e==r.childNodes.length&&!hasBlockDesc(r);)e=domIndex(r)+1,r=r.parentNode;for(;r&&e<r.childNodes.length;){let t=r.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=0}}function textNodeBefore(r,e){for(;r&&!e&&!hasBlockDesc(r);)e=domIndex(r),r=r.parentNode;for(;r&&e;){let t=r.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=r.childNodes.length}}function setSelFocus(r,e,t){if(e.nodeType!=3){let o,a;(a=textNodeAfter(e,t))?(e=a,t=0):(o=textNodeBefore(e,t))&&(e=o,t=o.nodeValue.length)}let n=r.domSelection();if(!n)return;if(selectionCollapsed(n)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),n.removeAllRanges(),n.addRange(o)}else n.extend&&n.extend(e,t);r.domObserver.setCurSelection();let{state:s}=r;setTimeout(()=>{r.state==s&&selectionToDOM(r)},50)}function findDirection(r,e){let t=r.state.doc.resolve(e);if(!(chrome||windows)&&t.parent.inlineContent){let s=r.coordsAtPos(e);if(e>t.start()){let o=r.coordsAtPos(e-1),a=(o.top+o.bottom)/2;if(a>s.top&&a<s.bottom&&Math.abs(o.left-s.left)>1)return o.left<s.left?"ltr":"rtl"}if(e<t.end()){let o=r.coordsAtPos(e+1),a=(o.top+o.bottom)/2;if(a>s.top&&a<s.bottom&&Math.abs(o.left-s.left)>1)return o.left>s.left?"ltr":"rtl"}}return getComputedStyle(r.dom).direction=="rtl"?"rtl":"ltr"}function selectVertically(r,e,t){let n=r.state.selection;if(n instanceof TextSelection&&!n.empty||t.indexOf("s")>-1||mac$2&&t.indexOf("m")>-1)return!1;let{$from:s,$to:o}=n;if(!s.parent.inlineContent||r.endOfTextblock(e<0?"up":"down")){let a=moveSelectionBlock(r.state,e);if(a&&a instanceof NodeSelection)return apply(r,a)}if(!s.parent.inlineContent){let a=e<0?s:o,l=n instanceof AllSelection?Selection.near(a,e):Selection.findFrom(a,e);return l?apply(r,l):!1}return!1}function stopNativeHorizontalDelete(r,e){if(!(r.state.selection instanceof TextSelection))return!0;let{$head:t,$anchor:n,empty:s}=r.state.selection;if(!t.sameParent(n))return!0;if(!s)return!1;if(r.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let a=r.state.tr;return e<0?a.delete(t.pos-o.nodeSize,t.pos):a.delete(t.pos,t.pos+o.nodeSize),r.dispatch(a),!0}return!1}function switchEditable(r,e,t){r.domObserver.stop(),e.contentEditable=t,r.domObserver.start()}function safariDownArrowBug(r){if(!safari||r.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=r.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;switchEditable(r,n,"true"),setTimeout(()=>switchEditable(r,n,"false"),20)}return!1}function getMods(r){let e="";return r.ctrlKey&&(e+="c"),r.metaKey&&(e+="m"),r.altKey&&(e+="a"),r.shiftKey&&(e+="s"),e}function captureKeyDown(r,e){let t=e.keyCode,n=getMods(e);if(t==8||mac$2&&t==72&&n=="c")return stopNativeHorizontalDelete(r,-1)||skipIgnoredNodes(r,-1);if(t==46&&!e.shiftKey||mac$2&&t==68&&n=="c")return stopNativeHorizontalDelete(r,1)||skipIgnoredNodes(r,1);if(t==13||t==27)return!0;if(t==37||mac$2&&t==66&&n=="c"){let s=t==37?findDirection(r,r.state.selection.from)=="ltr"?-1:1:-1;return selectHorizontally(r,s,n)||skipIgnoredNodes(r,s)}else if(t==39||mac$2&&t==70&&n=="c"){let s=t==39?findDirection(r,r.state.selection.from)=="ltr"?1:-1:1;return selectHorizontally(r,s,n)||skipIgnoredNodes(r,s)}else{if(t==38||mac$2&&t==80&&n=="c")return selectVertically(r,-1,n)||skipIgnoredNodes(r,-1);if(t==40||mac$2&&t==78&&n=="c")return safariDownArrowBug(r)||selectVertically(r,1,n)||skipIgnoredNodes(r,1);if(n==(mac$2?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function serializeForClipboard(r,e){r.someProp("transformCopied",m=>{e=m(e,r)});let t=[],{content:n,openStart:s,openEnd:o}=e;for(;s>1&&o>1&&n.childCount==1&&n.firstChild.childCount==1;){s--,o--;let m=n.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),n=m.content}let a=r.someProp("clipboardSerializer")||DOMSerializer.fromSchema(r.state.schema),l=detachedDoc(),u=l.createElement("div");u.appendChild(a.serializeFragment(n,{document:l}));let c=u.firstChild,d,f=0;for(;c&&c.nodeType==1&&(d=wrapMap[c.nodeName.toLowerCase()]);){for(let m=d.length-1;m>=0;m--){let E=l.createElement(d[m]);for(;u.firstChild;)E.appendChild(u.firstChild);u.appendChild(E),f++}c=u.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let C=r.someProp("clipboardTextSerializer",m=>m(e,r))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:C,slice:e}}function parseFromClipboard(r,e,t,n,s){let o=s.parent.type.spec.code,a,l;if(!t&&!e)return null;let u=e&&(n||o||!t);if(u){if(r.someProp("transformPastedText",C=>{e=C(e,o||n,r)}),o)return e?new Slice(Fragment.from(r.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):Slice.empty;let f=r.someProp("clipboardTextParser",C=>C(e,s,n,r));if(f)l=f;else{let C=s.marks(),{schema:m}=r.state,E=DOMSerializer.fromSchema(m);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let _=a.appendChild(document.createElement("p"));v&&_.appendChild(E.serializeNode(m.text(v,C)))})}}else r.someProp("transformPastedHTML",f=>{t=f(t,r)}),a=readHTML(t),webkit&&restoreReplacedSpaces(a);let c=a&&a.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let f=+d[3];f>0;f--){let C=a.firstChild;for(;C&&C.nodeType!=1;)C=C.nextSibling;if(!C)break;a=C}if(l||(l=(r.someProp("clipboardParser")||r.someProp("domParser")||DOMParser$1.fromSchema(r.state.schema)).parseSlice(a,{preserveWhitespace:!!(u||d),context:s,ruleFromNode(C){return C.nodeName=="BR"&&!C.nextSibling&&C.parentNode&&!inlineParents.test(C.parentNode.nodeName)?{ignore:!0}:null}})),d)l=addContext(closeSlice(l,+d[1],+d[2]),d[4]);else if(l=Slice.maxOpen(normalizeSiblings(l.content,s),!0),l.openStart||l.openEnd){let f=0,C=0;for(let m=l.content.firstChild;f<l.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=l.content.lastChild;C<l.openEnd&&!m.type.spec.isolating;C++,m=m.lastChild);l=closeSlice(l,f,C)}return r.someProp("transformPasted",f=>{l=f(l,r)}),l}const inlineParents=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function normalizeSiblings(r,e){if(r.childCount<2)return r;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),o,a=[];if(r.forEach(l=>{if(!a)return;let u=s.findWrapping(l.type),c;if(!u)return a=null;if(c=a.length&&o.length&&addToSibling(u,o,l,a[a.length-1],0))a[a.length-1]=c;else{a.length&&(a[a.length-1]=closeRight(a[a.length-1],o.length));let d=withWrappers(l,u);a.push(d),s=s.matchType(d.type),o=u}}),a)return Fragment.from(a)}return r}function withWrappers(r,e,t=0){for(let n=e.length-1;n>=t;n--)r=e[n].create(null,Fragment.from(r));return r}function addToSibling(r,e,t,n,s){if(s<r.length&&s<e.length&&r[s]==e[s]){let o=addToSibling(r,e,t,n.lastChild,s+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(s==r.length-1?t.type:r[s+1]))return n.copy(n.content.append(Fragment.from(withWrappers(t,r,s+1))))}}function closeRight(r,e){if(e==0)return r;let t=r.content.replaceChild(r.childCount-1,closeRight(r.lastChild,e-1)),n=r.contentMatchAt(r.childCount).fillBefore(Fragment.empty,!0);return r.copy(t.append(n))}function closeRange(r,e,t,n,s,o){let a=e<0?r.firstChild:r.lastChild,l=a.content;return r.childCount>1&&(o=0),s<n-1&&(l=closeRange(l,e,t,n,s+1,o)),s>=t&&(l=e<0?a.contentMatchAt(0).fillBefore(l,o<=s).append(l):l.append(a.contentMatchAt(a.childCount).fillBefore(Fragment.empty,!0))),r.replaceChild(e<0?0:r.childCount-1,a.copy(l))}function closeSlice(r,e,t){return e<r.openStart&&(r=new Slice(closeRange(r.content,-1,e,r.openStart,0,r.openEnd),e,r.openEnd)),t<r.openEnd&&(r=new Slice(closeRange(r.content,1,t,r.openEnd,0,0),r.openStart,t)),r}const wrapMap={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let _detachedDoc=null;function detachedDoc(){return _detachedDoc||(_detachedDoc=document.implementation.createHTMLDocument("title"))}let _policy=null;function maybeWrapTrusted(r){let e=window.trustedTypes;return e?(_policy||(_policy=e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),_policy.createHTML(r)):r}function readHTML(r){let e=/^(\s*<meta [^>]*>)*/.exec(r);e&&(r=r.slice(e[0].length));let t=detachedDoc().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(r),s;if((s=n&&wrapMap[n[1].toLowerCase()])&&(r=s.map(o=>"<"+o+">").join("")+r+s.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=maybeWrapTrusted(r),s)for(let o=0;o<s.length;o++)t=t.querySelector(s[o])||t;return t}function restoreReplacedSpaces(r){let e=r.querySelectorAll(chrome?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let n=e[t];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),n)}}function addContext(r,e){if(!r.size)return r;let t=r.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return r}let{content:s,openStart:o,openEnd:a}=r;for(let l=n.length-2;l>=0;l-=2){let u=t.nodes[n[l]];if(!u||u.hasRequiredAttrs())break;s=Fragment.from(u.create(n[l+1],s)),o++,a++}return new Slice(s,o,a)}const handlers={},editHandlers={},passiveHandlers={touchstart:!0,touchmove:!0};class InputState{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function initInput(r){for(let e in handlers){let t=handlers[e];r.dom.addEventListener(e,r.input.eventHandlers[e]=n=>{eventBelongsToView(r,n)&&!runCustomHandler(r,n)&&(r.editable||!(n.type in editHandlers))&&t(r,n)},passiveHandlers[e]?{passive:!0}:void 0)}safari&&r.dom.addEventListener("input",()=>null),ensureListeners(r)}function setSelectionOrigin(r,e){r.input.lastSelectionOrigin=e,r.input.lastSelectionTime=Date.now()}function destroyInput(r){r.domObserver.stop();for(let e in r.input.eventHandlers)r.dom.removeEventListener(e,r.input.eventHandlers[e]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}function ensureListeners(r){r.someProp("handleDOMEvents",e=>{for(let t in e)r.input.eventHandlers[t]||r.dom.addEventListener(t,r.input.eventHandlers[t]=n=>runCustomHandler(r,n))})}function runCustomHandler(r,e){return r.someProp("handleDOMEvents",t=>{let n=t[e.type];return n?n(r,e)||e.defaultPrevented:!1})}function eventBelongsToView(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=r.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function dispatchEvent(r,e){!runCustomHandler(r,e)&&handlers[e.type]&&(r.editable||!(e.type in editHandlers))&&handlers[e.type](r,e)}editHandlers.keydown=(r,e)=>{let t=e;if(r.input.shiftKey=t.keyCode==16||t.shiftKey,!inOrNearComposition(r,t)&&(r.input.lastKeyCode=t.keyCode,r.input.lastKeyCodeTime=Date.now(),!(android&&chrome&&t.keyCode==13)))if(t.keyCode!=229&&r.domObserver.forceFlush(),ios&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let n=Date.now();r.input.lastIOSEnter=n,r.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{r.input.lastIOSEnter==n&&(r.someProp("handleKeyDown",s=>s(r,keyEvent(13,"Enter"))),r.input.lastIOSEnter=0)},200)}else r.someProp("handleKeyDown",n=>n(r,t))||captureKeyDown(r,t)?t.preventDefault():setSelectionOrigin(r,"key")};editHandlers.keyup=(r,e)=>{e.keyCode==16&&(r.input.shiftKey=!1)};editHandlers.keypress=(r,e)=>{let t=e;if(inOrNearComposition(r,t)||!t.charCode||t.ctrlKey&&!t.altKey||mac$2&&t.metaKey)return;if(r.someProp("handleKeyPress",s=>s(r,t))){t.preventDefault();return}let n=r.state.selection;if(!(n instanceof TextSelection)||!n.$from.sameParent(n.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!r.someProp("handleTextInput",o=>o(r,n.$from.pos,n.$to.pos,s))&&r.dispatch(r.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function eventCoords(r){return{left:r.clientX,top:r.clientY}}function isNear(r,e){let t=e.x-r.clientX,n=e.y-r.clientY;return t*t+n*n<100}function runHandlerOnContext(r,e,t,n,s){if(n==-1)return!1;let o=r.state.doc.resolve(n);for(let a=o.depth+1;a>0;a--)if(r.someProp(e,l=>a>o.depth?l(r,t,o.nodeAfter,o.before(a),s,!0):l(r,t,o.node(a),o.before(a),s,!1)))return!0;return!1}function updateSelection(r,e,t){if(r.focused||r.focus(),r.state.selection.eq(e))return;let n=r.state.tr.setSelection(e);n.setMeta("pointer",!0),r.dispatch(n)}function selectClickedLeaf(r,e){if(e==-1)return!1;let t=r.state.doc.resolve(e),n=t.nodeAfter;return n&&n.isAtom&&NodeSelection.isSelectable(n)?(updateSelection(r,new NodeSelection(t)),!0):!1}function selectClickedNode(r,e){if(e==-1)return!1;let t=r.state.selection,n,s;t instanceof NodeSelection&&(n=t.node);let o=r.state.doc.resolve(e);for(let a=o.depth+1;a>0;a--){let l=a>o.depth?o.nodeAfter:o.node(a);if(NodeSelection.isSelectable(l)){n&&t.$from.depth>0&&a>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?s=o.before(t.$from.depth):s=o.before(a);break}}return s!=null?(updateSelection(r,NodeSelection.create(r.state.doc,s)),!0):!1}function handleSingleClick(r,e,t,n,s){return runHandlerOnContext(r,"handleClickOn",e,t,n)||r.someProp("handleClick",o=>o(r,e,n))||(s?selectClickedNode(r,t):selectClickedLeaf(r,t))}function handleDoubleClick(r,e,t,n){return runHandlerOnContext(r,"handleDoubleClickOn",e,t,n)||r.someProp("handleDoubleClick",s=>s(r,e,n))}function handleTripleClick(r,e,t,n){return runHandlerOnContext(r,"handleTripleClickOn",e,t,n)||r.someProp("handleTripleClick",s=>s(r,e,n))||defaultTripleClick(r,t,n)}function defaultTripleClick(r,e,t){if(t.button!=0)return!1;let n=r.state.doc;if(e==-1)return n.inlineContent?(updateSelection(r,TextSelection.create(n,0,n.content.size)),!0):!1;let s=n.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o),l=s.before(o);if(a.inlineContent)updateSelection(r,TextSelection.create(n,l+1,l+1+a.content.size));else if(NodeSelection.isSelectable(a))updateSelection(r,NodeSelection.create(n,l));else continue;return!0}}function forceDOMFlush(r){return endComposition(r)}const selectNodeModifier=mac$2?"metaKey":"ctrlKey";handlers.mousedown=(r,e)=>{let t=e;r.input.shiftKey=t.shiftKey;let n=forceDOMFlush(r),s=Date.now(),o="singleClick";s-r.input.lastClick.time<500&&isNear(t,r.input.lastClick)&&!t[selectNodeModifier]&&(r.input.lastClick.type=="singleClick"?o="doubleClick":r.input.lastClick.type=="doubleClick"&&(o="tripleClick")),r.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:o};let a=r.posAtCoords(eventCoords(t));a&&(o=="singleClick"?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new MouseDown(r,a,t,!!n)):(o=="doubleClick"?handleDoubleClick:handleTripleClick)(r,a.pos,a.inside,t)?t.preventDefault():setSelectionOrigin(r,"pointer"))};class MouseDown{constructor(e,t,n,s){this.view=e,this.pos=t,this.event=n,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[selectNodeModifier],this.allowDefault=n.shiftKey;let o,a;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),a=t.inside;else{let d=e.state.doc.resolve(t.pos);o=d.parent,a=d.depth?d.before():0}const l=s?null:n.target,u=l?e.docView.nearestDesc(l,!0):null;this.target=u&&u.dom.nodeType==1?u.dom:null;let{selection:c}=e.state;(n.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof NodeSelection&&c.from<=a&&c.to>a)&&(this.mightDrag={node:o,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&gecko&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),setSelectionOrigin(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>selectionToDOM(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(eventCoords(e))),this.updateAllowDefault(e),this.allowDefault||!t?setSelectionOrigin(this.view,"pointer"):handleSingleClick(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||safari&&this.mightDrag&&!this.mightDrag.node.isAtom||chrome&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(updateSelection(this.view,Selection.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):setSelectionOrigin(this.view,"pointer")}move(e){this.updateAllowDefault(e),setSelectionOrigin(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}handlers.touchstart=r=>{r.input.lastTouch=Date.now(),forceDOMFlush(r),setSelectionOrigin(r,"pointer")};handlers.touchmove=r=>{r.input.lastTouch=Date.now(),setSelectionOrigin(r,"pointer")};handlers.contextmenu=r=>forceDOMFlush(r);function inOrNearComposition(r,e){return r.composing?!0:safari&&Math.abs(e.timeStamp-r.input.compositionEndedAt)<500?(r.input.compositionEndedAt=-2e8,!0):!1}const timeoutComposition=android?5e3:-1;editHandlers.compositionstart=editHandlers.compositionupdate=r=>{if(!r.composing){r.domObserver.flush();let{state:e}=r,t=e.selection.$to;if(e.selection instanceof TextSelection&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))r.markCursor=r.state.storedMarks||t.marks(),endComposition(r,!0),r.markCursor=null;else if(endComposition(r,!e.selection.empty),gecko&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let n=r.domSelectionRange();for(let s=n.focusNode,o=n.focusOffset;s&&s.nodeType==1&&o!=0;){let a=o<0?s.lastChild:s.childNodes[o-1];if(!a)break;if(a.nodeType==3){let l=r.domSelection();l&&l.collapse(a,a.nodeValue.length);break}else s=a,o=-1}}r.input.composing=!0}scheduleComposeEnd(r,timeoutComposition)};editHandlers.compositionend=(r,e)=>{r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=e.timeStamp,r.input.compositionPendingChanges=r.domObserver.pendingRecords().length?r.input.compositionID:0,r.input.compositionNode=null,r.input.compositionPendingChanges&&Promise.resolve().then(()=>r.domObserver.flush()),r.input.compositionID++,scheduleComposeEnd(r,20))};function scheduleComposeEnd(r,e){clearTimeout(r.input.composingTimeout),e>-1&&(r.input.composingTimeout=setTimeout(()=>endComposition(r),e))}function clearComposition(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=timestampFromCustomEvent());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function findCompositionNode(r){let e=r.domSelectionRange();if(!e.focusNode)return null;let t=textNodeBefore$1(e.focusNode,e.focusOffset),n=textNodeAfter$1(e.focusNode,e.focusOffset);if(t&&n&&t!=n){let s=n.pmViewDesc,o=r.domObserver.lastChangedTextNode;if(t==o||n==o)return o;if(!s||!s.isText(n.nodeValue))return n;if(r.input.compositionNode==n){let a=t.pmViewDesc;if(!(!a||!a.isText(t.nodeValue)))return n}}return t||n}function timestampFromCustomEvent(){let r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}function endComposition(r,e=!1){if(!(android&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),clearComposition(r),e||r.docView&&r.docView.dirty){let t=selectionFromDOM(r);return t&&!t.eq(r.state.selection)?r.dispatch(r.state.tr.setSelection(t)):(r.markCursor||e)&&!r.state.selection.empty?r.dispatch(r.state.tr.deleteSelection()):r.updateState(r.state),!0}return!1}}function captureCopy(r,e){if(!r.dom.parentNode)return;let t=r.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),s=document.createRange();s.selectNodeContents(e),r.dom.blur(),n.removeAllRanges(),n.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),r.focus()},50)}const brokenClipboardAPI=ie$1&&ie_version<15||ios&&webkit_version<604;handlers.copy=editHandlers.cut=(r,e)=>{let t=e,n=r.state.selection,s=t.type=="cut";if(n.empty)return;let o=brokenClipboardAPI?null:t.clipboardData,a=n.content(),{dom:l,text:u}=serializeForClipboard(r,a);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",u)):captureCopy(r,l),s&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function sliceSingleNode(r){return r.openStart==0&&r.openEnd==0&&r.content.childCount==1?r.content.firstChild:null}function capturePaste(r,e){if(!r.dom.parentNode)return;let t=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,n=r.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let s=r.input.shiftKey&&r.input.lastKeyCode!=45;setTimeout(()=>{r.focus(),n.parentNode&&n.parentNode.removeChild(n),t?doPaste(r,n.value,null,s,e):doPaste(r,n.textContent,n.innerHTML,s,e)},50)}function doPaste(r,e,t,n,s){let o=parseFromClipboard(r,e,t,n,r.state.selection.$from);if(r.someProp("handlePaste",u=>u(r,s,o||Slice.empty)))return!0;if(!o)return!1;let a=sliceSingleNode(o),l=a?r.state.tr.replaceSelectionWith(a,n):r.state.tr.replaceSelection(o);return r.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function getText$1(r){let e=r.getData("text/plain")||r.getData("Text");if(e)return e;let t=r.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}editHandlers.paste=(r,e)=>{let t=e;if(r.composing&&!android)return;let n=brokenClipboardAPI?null:t.clipboardData,s=r.input.shiftKey&&r.input.lastKeyCode!=45;n&&doPaste(r,getText$1(n),n.getData("text/html"),s,t)?t.preventDefault():capturePaste(r,t)};class Dragging{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const dragCopyModifier=mac$2?"altKey":"ctrlKey";handlers.dragstart=(r,e)=>{let t=e,n=r.input.mouseDown;if(n&&n.done(),!t.dataTransfer)return;let s=r.state.selection,o=s.empty?null:r.posAtCoords(eventCoords(t)),a;if(!(o&&o.pos>=s.from&&o.pos<=(s instanceof NodeSelection?s.to-1:s.to))){if(n&&n.mightDrag)a=NodeSelection.create(r.state.doc,n.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=r.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=r.docView&&(a=NodeSelection.create(r.state.doc,f.posBefore))}}let l=(a||r.state.selection).content(),{dom:u,text:c,slice:d}=serializeForClipboard(r,l);(!t.dataTransfer.files.length||!chrome||chrome_version>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",u.innerHTML),t.dataTransfer.effectAllowed="copyMove",brokenClipboardAPI||t.dataTransfer.setData("text/plain",c),r.dragging=new Dragging(d,!t[dragCopyModifier],a)};handlers.dragend=r=>{let e=r.dragging;window.setTimeout(()=>{r.dragging==e&&(r.dragging=null)},50)};editHandlers.dragover=editHandlers.dragenter=(r,e)=>e.preventDefault();editHandlers.drop=(r,e)=>{let t=e,n=r.dragging;if(r.dragging=null,!t.dataTransfer)return;let s=r.posAtCoords(eventCoords(t));if(!s)return;let o=r.state.doc.resolve(s.pos),a=n&&n.slice;a?r.someProp("transformPasted",E=>{a=E(a,r)}):a=parseFromClipboard(r,getText$1(t.dataTransfer),brokenClipboardAPI?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(n&&!t[dragCopyModifier]);if(r.someProp("handleDrop",E=>E(r,t,a||Slice.empty,l))){t.preventDefault();return}if(!a)return;t.preventDefault();let u=a?dropPoint(r.state.doc,o.pos,a):o.pos;u==null&&(u=o.pos);let c=r.state.tr;if(l){let{node:E}=n;E?E.replace(c):c.deleteSelection()}let d=c.mapping.map(u),f=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,C=c.doc;if(f?c.replaceRangeWith(d,d,a.content.firstChild):c.replaceRange(d,d,a),c.doc.eq(C))return;let m=c.doc.resolve(d);if(f&&NodeSelection.isSelectable(a.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new NodeSelection(m));else{let E=c.mapping.map(u);c.mapping.maps[c.mapping.maps.length-1].forEach((v,_,T,R)=>E=R),c.setSelection(selectionBetween(r,m,c.doc.resolve(E)))}r.focus(),r.dispatch(c.setMeta("uiEvent","drop"))};handlers.focus=r=>{r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(()=>{r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&selectionToDOM(r)},20))};handlers.blur=(r,e)=>{let t=e;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),t.relatedTarget&&r.dom.contains(t.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)};handlers.beforeinput=(r,e)=>{if(chrome&&android&&e.inputType=="deleteContentBackward"){r.domObserver.flushSoon();let{domChangeCount:n}=r.input;setTimeout(()=>{if(r.input.domChangeCount!=n||(r.dom.blur(),r.focus(),r.someProp("handleKeyDown",o=>o(r,keyEvent(8,"Backspace")))))return;let{$cursor:s}=r.state.selection;s&&s.pos>0&&r.dispatch(r.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let r in editHandlers)handlers[r]=editHandlers[r];function compareObjs(r,e){if(r==e)return!0;for(let t in r)if(r[t]!==e[t])return!1;for(let t in e)if(!(t in r))return!1;return!0}class WidgetType{constructor(e,t){this.toDOM=e,this.spec=t||noSpec,this.side=this.spec.side||0}map(e,t,n,s){let{pos:o,deleted:a}=e.mapResult(t.from+s,this.side<0?-1:1);return a?null:new Decoration(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof WidgetType&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&compareObjs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class InlineType{constructor(e,t){this.attrs=e,this.spec=t||noSpec}map(e,t,n,s){let o=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-n,a=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-n;return o>=a?null:new Decoration(o,a,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof InlineType&&compareObjs(this.attrs,e.attrs)&&compareObjs(this.spec,e.spec)}static is(e){return e.type instanceof InlineType}destroy(){}}class NodeType{constructor(e,t){this.attrs=e,this.spec=t||noSpec}map(e,t,n,s){let o=e.mapResult(t.from+s,1);if(o.deleted)return null;let a=e.mapResult(t.to+s,-1);return a.deleted||a.pos<=o.pos?null:new Decoration(o.pos-n,a.pos-n,this)}valid(e,t){let{index:n,offset:s}=e.content.findIndex(t.from),o;return s==t.from&&!(o=e.child(n)).isText&&s+o.nodeSize==t.to}eq(e){return this==e||e instanceof NodeType&&compareObjs(this.attrs,e.attrs)&&compareObjs(this.spec,e.spec)}destroy(){}}class Decoration{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Decoration(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Decoration(e,e,new WidgetType(t,n))}static inline(e,t,n,s){return new Decoration(e,t,new InlineType(n,s))}static node(e,t,n,s){return new Decoration(e,t,new NodeType(n,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof InlineType}get widget(){return this.type instanceof WidgetType}}const none=[],noSpec={};class DecorationSet{constructor(e,t){this.local=e.length?e:none,this.children=t.length?t:none}static create(e,t){return t.length?buildTree(t,e,0,noSpec):empty}find(e,t,n){let s=[];return this.findInner(e??0,t??1e9,s,0,n),s}findInner(e,t,n,s,o){for(let a=0;a<this.local.length;a++){let l=this.local[a];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&n.push(l.copy(l.from+s,l.to+s))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){let l=this.children[a]+1;this.children[a+2].findInner(e-l,t-l,n,s+l,o)}}map(e,t,n){return this==empty||e.maps.length==0?this:this.mapInner(e,t,0,0,n||noSpec)}mapInner(e,t,n,s,o){let a;for(let l=0;l<this.local.length;l++){let u=this.local[l].map(e,n,s);u&&u.type.valid(t,u)?(a||(a=[])).push(u):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?mapChildren(this.children,a||[],e,t,n,s,o):a?new DecorationSet(a.sort(byPos),none):empty}add(e,t){return t.length?this==empty?DecorationSet.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let s,o=0;e.forEach((l,u)=>{let c=u+n,d;if(d=takeSpansForNode(t,l,c)){for(s||(s=this.children.slice());o<s.length&&s[o]<u;)o+=3;s[o]==u?s[o+2]=s[o+2].addInner(l,d,c+1):s.splice(o,0,u,u+l.nodeSize,buildTree(d,l,c+1,noSpec)),o+=3}});let a=moveSpans(o?withoutNulls(t):t,-n);for(let l=0;l<a.length;l++)a[l].type.valid(e,a[l])||a.splice(l--,1);return new DecorationSet(a.length?this.local.concat(a).sort(byPos):this.local,s||this.children)}remove(e){return e.length==0||this==empty?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,s=this.local;for(let o=0;o<n.length;o+=3){let a,l=n[o]+t,u=n[o+1]+t;for(let d=0,f;d<e.length;d++)(f=e[d])&&f.from>l&&f.to<u&&(e[d]=null,(a||(a=[])).push(f));if(!a)continue;n==this.children&&(n=this.children.slice());let c=n[o+2].removeInner(a,l+1);c!=empty?n[o+2]=c:(n.splice(o,3),o-=3)}if(s.length){for(let o=0,a;o<e.length;o++)if(a=e[o])for(let l=0;l<s.length;l++)s[l].eq(a,t)&&(s==this.local&&(s=this.local.slice()),s.splice(l--,1))}return n==this.children&&s==this.local?this:s.length||n.length?new DecorationSet(s,n):empty}forChild(e,t){if(this==empty)return this;if(t.isLeaf)return DecorationSet.empty;let n,s;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(n=this.children[l+2]);break}let o=e+1,a=o+t.content.size;for(let l=0;l<this.local.length;l++){let u=this.local[l];if(u.from<a&&u.to>o&&u.type instanceof InlineType){let c=Math.max(o,u.from)-o,d=Math.min(a,u.to)-o;c<d&&(s||(s=[])).push(u.copy(c,d))}}if(s){let l=new DecorationSet(s.sort(byPos),none);return n?new DecorationGroup([l,n]):l}return n||empty}eq(e){if(this==e)return!0;if(!(e instanceof DecorationSet)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return removeOverlap(this.localsInner(e))}localsInner(e){if(this==empty)return none;if(e.inlineContent||!this.local.some(InlineType.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof InlineType||t.push(this.local[n]);return t}forEachSet(e){e(this)}}DecorationSet.empty=new DecorationSet([],[]);DecorationSet.removeOverlap=removeOverlap;const empty=DecorationSet.empty;class DecorationGroup{constructor(e){this.members=e}map(e,t){const n=this.members.map(s=>s.map(e,t,noSpec));return DecorationGroup.from(n)}forChild(e,t){if(t.isLeaf)return DecorationSet.empty;let n=[];for(let s=0;s<this.members.length;s++){let o=this.members[s].forChild(e,t);o!=empty&&(o instanceof DecorationGroup?n=n.concat(o.members):n.push(o))}return DecorationGroup.from(n)}eq(e){if(!(e instanceof DecorationGroup)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let s=0;s<this.members.length;s++){let o=this.members[s].localsInner(e);if(o.length)if(!t)t=o;else{n&&(t=t.slice(),n=!1);for(let a=0;a<o.length;a++)t.push(o[a])}}return t?removeOverlap(n?t:t.sort(byPos)):none}static from(e){switch(e.length){case 0:return empty;case 1:return e[0];default:return new DecorationGroup(e.every(t=>t instanceof DecorationSet)?e:e.reduce((t,n)=>t.concat(n instanceof DecorationSet?n:n.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function mapChildren(r,e,t,n,s,o,a){let l=r.slice();for(let c=0,d=o;c<t.maps.length;c++){let f=0;t.maps[c].forEach((C,m,E,v)=>{let _=v-E-(m-C);for(let T=0;T<l.length;T+=3){let R=l[T+1];if(R<0||C>R+d-f)continue;let O=l[T]+d-f;m>=O?l[T+1]=C<=O?-2:-1:C>=d&&_&&(l[T]+=_,l[T+1]+=_)}f+=_}),d=t.maps[c].map(d,-1)}let u=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){u=!0,l[c+1]=-1;continue}let d=t.map(r[c]+o),f=d-s;if(f<0||f>=n.content.size){u=!0;continue}let C=t.map(r[c+1]+o,-1),m=C-s,{index:E,offset:v}=n.content.findIndex(f),_=n.maybeChild(E);if(_&&v==f&&v+_.nodeSize==m){let T=l[c+2].mapInner(t,_,d+1,r[c]+o+1,a);T!=empty?(l[c]=f,l[c+1]=m,l[c+2]=T):(l[c+1]=-2,u=!0)}else u=!0}if(u){let c=mapAndGatherRemainingDecorations(l,r,e,t,s,o,a),d=buildTree(c,n,0,a);e=d.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,C=0;f<d.children.length;f+=3){let m=d.children[f];for(;C<l.length&&l[C]<m;)C+=3;l.splice(C,0,d.children[f],d.children[f+1],d.children[f+2])}}return new DecorationSet(e.sort(byPos),l)}function moveSpans(r,e){if(!e||!r.length)return r;let t=[];for(let n=0;n<r.length;n++){let s=r[n];t.push(new Decoration(s.from+e,s.to+e,s.type))}return t}function mapAndGatherRemainingDecorations(r,e,t,n,s,o,a){function l(u,c){for(let d=0;d<u.local.length;d++){let f=u.local[d].map(n,s,c);f?t.push(f):a.onRemove&&a.onRemove(u.local[d].spec)}for(let d=0;d<u.children.length;d+=3)l(u.children[d+2],u.children[d]+c+1)}for(let u=0;u<r.length;u+=3)r[u+1]==-1&&l(r[u+2],e[u]+o+1);return t}function takeSpansForNode(r,e,t){if(e.isLeaf)return null;let n=t+e.nodeSize,s=null;for(let o=0,a;o<r.length;o++)(a=r[o])&&a.from>t&&a.to<n&&((s||(s=[])).push(a),r[o]=null);return s}function withoutNulls(r){let e=[];for(let t=0;t<r.length;t++)r[t]!=null&&e.push(r[t]);return e}function buildTree(r,e,t,n){let s=[],o=!1;e.forEach((l,u)=>{let c=takeSpansForNode(r,l,u+t);if(c){o=!0;let d=buildTree(c,l,t+u+1,n);d!=empty&&s.push(u,u+l.nodeSize,d)}});let a=moveSpans(o?withoutNulls(r):r,-t).sort(byPos);for(let l=0;l<a.length;l++)a[l].type.valid(e,a[l])||(n.onRemove&&n.onRemove(a[l].spec),a.splice(l--,1));return a.length||s.length?new DecorationSet(a,s):empty}function byPos(r,e){return r.from-e.from||r.to-e.to}function removeOverlap(r){let e=r;for(let t=0;t<e.length-1;t++){let n=e[t];if(n.from!=n.to)for(let s=t+1;s<e.length;s++){let o=e[s];if(o.from==n.from){o.to!=n.to&&(e==r&&(e=r.slice()),e[s]=o.copy(o.from,n.to),insertAhead(e,s+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(e==r&&(e=r.slice()),e[t]=n.copy(n.from,o.from),insertAhead(e,s,n.copy(o.from,n.to)));break}}}return e}function insertAhead(r,e,t){for(;e<r.length&&byPos(t,r[e])>0;)e++;r.splice(e,0,t)}function viewDecorations(r){let e=[];return r.someProp("decorations",t=>{let n=t(r.state);n&&n!=empty&&e.push(n)}),r.cursorWrapper&&e.push(DecorationSet.create(r.state.doc,[r.cursorWrapper.deco])),DecorationGroup.from(e)}const observeOptions={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},useCharData=ie$1&&ie_version<=11;class SelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class DOMObserver{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new SelectionState,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let s=0;s<n.length;s++)this.queue.push(n[s]);ie$1&&ie_version<=11&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),useCharData&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,observeOptions)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(hasFocusAndSelection(this.view)){if(this.suppressingSelectionUpdates)return selectionToDOM(this.view);if(ie$1&&ie_version<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&isEquivalentPosition(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let o=e.focusNode;o;o=parentNode(o))t.add(o);for(let o=e.anchorNode;o;o=parentNode(o))if(t.has(o)){n=o;break}let s=n&&this.view.docView.nearestDesc(n);if(s&&s.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&hasFocusAndSelection(e)&&!this.ignoreSelectionChange(n),o=-1,a=-1,l=!1,u=[];if(e.editable)for(let d=0;d<t.length;d++){let f=this.registerMutation(t[d],u);f&&(o=o<0?f.from:Math.min(f.from,o),a=a<0?f.to:Math.max(f.to,a),f.typeOver&&(l=!0))}if(gecko&&u.length){let d=u.filter(f=>f.nodeName=="BR");if(d.length==2){let[f,C]=d;f.parentNode&&f.parentNode.parentNode==C.parentNode?C.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let C of d){let m=C.parentNode;m&&m.nodeName=="LI"&&(!f||blockParent(e,f)!=m)&&C.remove()}}}let c=null;o<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&selectionCollapsed(n)&&(c=selectionFromDOM(e))&&c.eq(Selection.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,selectionToDOM(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||s)&&(o>-1&&(e.docView.markDirty(o,a),checkCSS(e)),this.handleDOMChange(o,a,l,u),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||selectionToDOM(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let d=0;d<e.addedNodes.length;d++){let f=e.addedNodes[d];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let s=e.previousSibling,o=e.nextSibling;if(ie$1&&ie_version<=11&&e.addedNodes.length)for(let d=0;d<e.addedNodes.length;d++){let{previousSibling:f,nextSibling:C}=e.addedNodes[d];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!C||Array.prototype.indexOf.call(e.addedNodes,C)<0)&&(o=C)}let a=s&&s.parentNode==e.target?domIndex(s)+1:0,l=n.localPosFromDOM(e.target,a,-1),u=o&&o.parentNode==e.target?domIndex(o):e.target.childNodes.length,c=n.localPosFromDOM(e.target,u,1);return{from:l,to:c}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let cssChecked=new WeakMap,cssCheckWarned=!1;function checkCSS(r){if(!cssChecked.has(r)&&(cssChecked.set(r,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace)!==-1)){if(r.requiresGeckoHackNode=gecko,cssCheckWarned)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cssCheckWarned=!0}}function rangeToSelectionRange(r,e){let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,a=r.domAtPos(r.state.selection.anchor);return isEquivalentPosition(a.node,a.offset,s,o)&&([t,n,s,o]=[s,o,t,n]),{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:o}}function safariShadowSelectionRange(r,e){if(e.getComposedRanges){let s=e.getComposedRanges(r.root)[0];if(s)return rangeToSelectionRange(r,s)}let t;function n(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return r.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",n,!0),t?rangeToSelectionRange(r,t):null}function blockParent(r,e){for(let t=e.parentNode;t&&t!=r.dom;t=t.parentNode){let n=r.docView.nearestDesc(t,!0);if(n&&n.node.isBlock)return t}return null}function parseBetween(r,e,t){let{node:n,fromOffset:s,toOffset:o,from:a,to:l}=r.docView.parseRange(e,t),u=r.domSelectionRange(),c,d=u.anchorNode;if(d&&r.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:u.anchorOffset}],selectionCollapsed(u)||c.push({node:u.focusNode,offset:u.focusOffset})),chrome&&r.input.lastKeyCode===8)for(let _=o;_>s;_--){let T=n.childNodes[_-1],R=T.pmViewDesc;if(T.nodeName=="BR"&&!R){o=_;break}if(!R||R.size)break}let f=r.state.doc,C=r.someProp("domParser")||DOMParser$1.fromSchema(r.state.schema),m=f.resolve(a),E=null,v=C.parse(n,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:o,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode,context:m});if(c&&c[0].pos!=null){let _=c[0].pos,T=c[1]&&c[1].pos;T==null&&(T=_),E={anchor:_+a,head:T+a}}return{doc:v,sel:E,from:a,to:l}}function ruleFromNode(r){let e=r.pmViewDesc;if(e)return e.parseRule();if(r.nodeName=="BR"&&r.parentNode){if(safari&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(r.parentNode.lastChild==r||safari&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if(r.nodeName=="IMG"&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}const isInline=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function readDOMChange(r,e,t,n,s){let o=r.input.compositionPendingChanges||(r.composing?r.input.compositionID:0);if(r.input.compositionPendingChanges=0,e<0){let ne=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,Z=selectionFromDOM(r,ne);if(Z&&!r.state.selection.eq(Z)){if(chrome&&android&&r.input.lastKeyCode===13&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",xe=>xe(r,keyEvent(13,"Enter"))))return;let ve=r.state.tr.setSelection(Z);ne=="pointer"?ve.setMeta("pointer",!0):ne=="key"&&ve.scrollIntoView(),o&&ve.setMeta("composition",o),r.dispatch(ve)}return}let a=r.state.doc.resolve(e),l=a.sharedDepth(t);e=a.before(l+1),t=r.state.doc.resolve(t).after(l+1);let u=r.state.selection,c=parseBetween(r,e,t),d=r.state.doc,f=d.slice(c.from,c.to),C,m;r.input.lastKeyCode===8&&Date.now()-100<r.input.lastKeyCodeTime?(C=r.state.selection.to,m="end"):(C=r.state.selection.from,m="start"),r.input.lastKeyCode=null;let E=findDiff(f.content,c.doc.content,c.from,C,m);if(E&&r.input.domChangeCount++,(ios&&r.input.lastIOSEnter>Date.now()-225||android)&&s.some(ne=>ne.nodeType==1&&!isInline.test(ne.nodeName))&&(!E||E.endA>=E.endB)&&r.someProp("handleKeyDown",ne=>ne(r,keyEvent(13,"Enter")))){r.input.lastIOSEnter=0;return}if(!E)if(n&&u instanceof TextSelection&&!u.empty&&u.$head.sameParent(u.$anchor)&&!r.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))E={start:u.from,endA:u.to,endB:u.to};else{if(c.sel){let ne=resolveSelection(r,r.state.doc,c.sel);if(ne&&!ne.eq(r.state.selection)){let Z=r.state.tr.setSelection(ne);o&&Z.setMeta("composition",o),r.dispatch(Z)}}return}r.state.selection.from<r.state.selection.to&&E.start==E.endB&&r.state.selection instanceof TextSelection&&(E.start>r.state.selection.from&&E.start<=r.state.selection.from+2&&r.state.selection.from>=c.from?E.start=r.state.selection.from:E.endA<r.state.selection.to&&E.endA>=r.state.selection.to-2&&r.state.selection.to<=c.to&&(E.endB+=r.state.selection.to-E.endA,E.endA=r.state.selection.to)),ie$1&&ie_version<=11&&E.endB==E.start+1&&E.endA==E.start&&E.start>c.from&&c.doc.textBetween(E.start-c.from-1,E.start-c.from+1)==" "&&(E.start--,E.endA--,E.endB--);let v=c.doc.resolveNoCache(E.start-c.from),_=c.doc.resolveNoCache(E.endB-c.from),T=d.resolve(E.start),R=v.sameParent(_)&&v.parent.inlineContent&&T.end()>=E.endA,O;if((ios&&r.input.lastIOSEnter>Date.now()-225&&(!R||s.some(ne=>ne.nodeName=="DIV"||ne.nodeName=="P"))||!R&&v.pos<c.doc.content.size&&!v.sameParent(_)&&(O=Selection.findFrom(c.doc.resolve(v.pos+1),1,!0))&&O.head==_.pos)&&r.someProp("handleKeyDown",ne=>ne(r,keyEvent(13,"Enter")))){r.input.lastIOSEnter=0;return}if(r.state.selection.anchor>E.start&&looksLikeBackspace(d,E.start,E.endA,v,_)&&r.someProp("handleKeyDown",ne=>ne(r,keyEvent(8,"Backspace")))){android&&chrome&&r.domObserver.suppressSelectionUpdates();return}chrome&&E.endB==E.start&&(r.input.lastChromeDelete=Date.now()),android&&!R&&v.start()!=_.start()&&_.parentOffset==0&&v.depth==_.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==E.endA&&(E.endB-=2,_=c.doc.resolveNoCache(E.endB-c.from),setTimeout(()=>{r.someProp("handleKeyDown",function(ne){return ne(r,keyEvent(13,"Enter"))})},20));let N=E.start,G=E.endA,D,k,z;if(R){if(v.pos==_.pos)ie$1&&ie_version<=11&&v.parentOffset==0&&(r.domObserver.suppressSelectionUpdates(),setTimeout(()=>selectionToDOM(r),20)),D=r.state.tr.delete(N,G),k=d.resolve(E.start).marksAcross(d.resolve(E.endA));else if(E.endA==E.endB&&(z=isMarkChange(v.parent.content.cut(v.parentOffset,_.parentOffset),T.parent.content.cut(T.parentOffset,E.endA-T.start()))))D=r.state.tr,z.type=="add"?D.addMark(N,G,z.mark):D.removeMark(N,G,z.mark);else if(v.parent.child(v.index()).isText&&v.index()==_.index()-(_.textOffset?0:1)){let ne=v.parent.textBetween(v.parentOffset,_.parentOffset);if(r.someProp("handleTextInput",Z=>Z(r,N,G,ne)))return;D=r.state.tr.insertText(ne,N,G)}}if(D||(D=r.state.tr.replace(N,G,c.doc.slice(E.start-c.from,E.endB-c.from))),c.sel){let ne=resolveSelection(r,D.doc,c.sel);ne&&!(chrome&&r.composing&&ne.empty&&(E.start!=E.endB||r.input.lastChromeDelete<Date.now()-100)&&(ne.head==N||ne.head==D.mapping.map(G)-1)||ie$1&&ne.empty&&ne.head==N)&&D.setSelection(ne)}k&&D.ensureMarks(k),o&&D.setMeta("composition",o),r.dispatch(D.scrollIntoView())}function resolveSelection(r,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:selectionBetween(r,e.resolve(t.anchor),e.resolve(t.head))}function isMarkChange(r,e){let t=r.firstChild.marks,n=e.firstChild.marks,s=t,o=n,a,l,u;for(let d=0;d<n.length;d++)s=n[d].removeFromSet(s);for(let d=0;d<t.length;d++)o=t[d].removeFromSet(o);if(s.length==1&&o.length==0)l=s[0],a="add",u=d=>d.mark(l.addToSet(d.marks));else if(s.length==0&&o.length==1)l=o[0],a="remove",u=d=>d.mark(l.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<e.childCount;d++)c.push(u(e.child(d)));if(Fragment.from(c).eq(r))return{mark:l,type:a}}function looksLikeBackspace(r,e,t,n,s){if(t-e<=s.pos-n.pos||skipClosingAndOpening(n,!0,!1)<s.pos)return!1;let o=r.resolve(e);if(!n.parent.isTextblock){let l=o.nodeAfter;return l!=null&&t==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let a=r.resolve(skipClosingAndOpening(o,!0,!0));return!a.parent.isTextblock||a.pos>t||skipClosingAndOpening(a,!0,!1)<t?!1:n.parent.content.cut(n.parentOffset).eq(a.parent.content)}function skipClosingAndOpening(r,e,t){let n=r.depth,s=e?r.end():r.pos;for(;n>0&&(e||r.indexAfter(n)==r.node(n).childCount);)n--,s++,e=!1;if(t){let o=r.node(n).maybeChild(r.indexAfter(n));for(;o&&!o.isLeaf;)o=o.firstChild,s++}return s}function findDiff(r,e,t,n,s){let o=r.findDiffStart(e,t);if(o==null)return null;let{a,b:l}=r.findDiffEnd(e,t+r.size,t+e.size);if(s=="end"){let u=Math.max(0,o-Math.min(a,l));n-=a+u-o}if(a<o&&r.size<e.size){let u=n<=o&&n>=a?o-n:0;o-=u,o&&o<e.size&&isSurrogatePair(e.textBetween(o-1,o+1))&&(o+=u?1:-1),l=o+(l-a),a=o}else if(l<o){let u=n<=o&&n>=l?o-n:0;o-=u,o&&o<r.size&&isSurrogatePair(r.textBetween(o-1,o+1))&&(o+=u?1:-1),a=o+(a-l),l=o}return{start:o,endA:a,endB:l}}function isSurrogatePair(r){if(r.length!=2)return!1;let e=r.charCodeAt(0),t=r.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class EditorView{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new InputState,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(checkStateComponent),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=getEditable(this),updateCursorWrapper(this),this.nodeViews=buildNodeViews(this),this.docView=docViewDesc(this.state.doc,computeDocDeco(this),viewDecorations(this),this.dom,this),this.domObserver=new DOMObserver(this,(n,s,o,a)=>readDOMChange(this,n,s,o,a)),this.domObserver.start(),initInput(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ensureListeners(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(checkStateComponent),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let s=this.state,o=!1,a=!1;e.storedMarks&&this.composing&&(clearComposition(this),a=!0),this.state=e;let l=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=buildNodeViews(this);changedNodeViews(m,this.nodeViews)&&(this.nodeViews=m,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&ensureListeners(this),this.editable=getEditable(this),updateCursorWrapper(this);let u=viewDecorations(this),c=computeDocDeco(this),d=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,c,u);(f||!e.selection.eq(s.selection))&&(a=!0);let C=d=="preserve"&&a&&this.dom.style.overflowAnchor==null&&storeScrollPos(this);if(a){this.domObserver.stop();let m=f&&(ie$1||chrome)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&selectionContextChanged(s.selection,e.selection);if(f){let E=chrome?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=findCompositionNode(this)),(o||!this.docView.update(e.doc,c,u,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=docViewDesc(e.doc,c,u,this.dom,this)),E&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&anchorInRightPlace(this))?selectionToDOM(this,m):(syncNodeSelection(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((n=this.dragging)===null||n===void 0)&&n.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():C&&resetScrollPos(C)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof NodeSelection){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&scrollRectIntoView(this,t.getBoundingClientRect(),e)}else scrollRectIntoView(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let n=this.directPlugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let n=this.state.plugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}}updateDraggedNode(e,t){let n=e.node,s=-1;if(this.state.doc.nodeAt(n.from)==n.node)s=n.from;else{let o=n.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(s=o)}this.dragging=new Dragging(e.slice,e.move,s<0?void 0:NodeSelection.create(this.state.doc,s))}someProp(e,t){let n=this._props&&this._props[e],s;if(n!=null&&(s=t?t(n):n))return s;for(let a=0;a<this.directPlugins.length;a++){let l=this.directPlugins[a].props[e];if(l!=null&&(s=t?t(l):l))return s}let o=this.state.plugins;if(o)for(let a=0;a<o.length;a++){let l=o[a].props[e];if(l!=null&&(s=t?t(l):l))return s}}hasFocus(){if(ie$1){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&focusPreventScroll(this.dom),selectionToDOM(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return posAtCoords(this,e)}coordsAtPos(e,t=1){return coordsAtPos(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let s=this.docView.posFromDOM(e,t,n);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return endOfTextblock(this,t||this.state,e)}pasteHTML(e,t){return doPaste(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return doPaste(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(destroyInput(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],viewDecorations(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,clearReusedRange())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return dispatchEvent(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?safari&&this.root.nodeType===11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariShadowSelectionRange(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function computeDocDeco(r){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(r.editable),r.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(r.state)),t)for(let n in t)n=="class"?e.class+=" "+t[n]:n=="style"?e.style=(e.style?e.style+";":"")+t[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(t[n]))}),e.translate||(e.translate="no"),[Decoration.node(0,r.state.doc.content.size,e)]}function updateCursorWrapper(r){if(r.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),r.cursorWrapper={dom:e,deco:Decoration.widget(r.state.selection.from,e,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function getEditable(r){return!r.someProp("editable",e=>e(r.state)===!1)}function selectionContextChanged(r,e){let t=Math.min(r.$anchor.sharedDepth(r.head),e.$anchor.sharedDepth(e.head));return r.$anchor.start(t)!=e.$anchor.start(t)}function buildNodeViews(r){let e=Object.create(null);function t(n){for(let s in n)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=n[s])}return r.someProp("nodeViews",t),r.someProp("markViews",t),e}function changedNodeViews(r,e){let t=0,n=0;for(let s in r){if(r[s]!=e[s])return!0;t++}for(let s in e)n++;return t!=n}function checkStateComponent(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac$1=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(r){var e=mac$1&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||ie&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?shift:base)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const mac=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function normalizeKeyName$1(r){let e=r.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let n,s,o,a;for(let l=0;l<e.length-1;l++){let u=e[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))mac?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return n&&(t="Alt-"+t),s&&(t="Ctrl-"+t),a&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function normalize(r){let e=Object.create(null);for(let t in r)e[normalizeKeyName$1(t)]=r[t];return e}function modifiers(r,e,t=!0){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t&&e.shiftKey&&(r="Shift-"+r),r}function keymap(r){return new Plugin({props:{handleKeyDown:keydownHandler(r)}})}function keydownHandler(r){let e=normalize(r);return function(t,n){let s=keyName(n),o,a=e[modifiers(s,n)];if(a&&a(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(n.shiftKey){let l=e[modifiers(s,n,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((n.shiftKey||n.altKey||n.metaKey||s.charCodeAt(0)>127)&&(o=base[n.keyCode])&&o!=s){let l=e[modifiers(o,n)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const deleteSelection$1=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0);function atBlockStart(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("backward",r):t.parentOffset>0)?null:t}const joinBackward$1=(r,e,t)=>{let n=atBlockStart(r,t);if(!n)return!1;let s=findCutBefore(n);if(!s){let a=n.blockRange(),l=a&&liftTarget(a);return l==null?!1:(e&&e(r.tr.lift(a,l).scrollIntoView()),!0)}let o=s.nodeBefore;if(deleteBarrier(r,s,e,-1))return!0;if(n.parent.content.size==0&&(textblockAt(o,"end")||NodeSelection.isSelectable(o)))for(let a=n.depth;;a--){let l=replaceStep(r.doc,n.before(a),n.after(a),Slice.empty);if(l&&l.slice.size<l.to-l.from){if(e){let u=r.tr.step(l);u.setSelection(textblockAt(o,"end")?Selection.findFrom(u.doc.resolve(u.mapping.map(s.pos,-1)),-1):NodeSelection.create(u.doc,s.pos-o.nodeSize)),e(u.scrollIntoView())}return!0}if(a==1||n.node(a-1).childCount>1)break}return o.isAtom&&s.depth==n.depth-1?(e&&e(r.tr.delete(s.pos-o.nodeSize,s.pos).scrollIntoView()),!0):!1},joinTextblockBackward$1=(r,e,t)=>{let n=atBlockStart(r,t);if(!n)return!1;let s=findCutBefore(n);return s?joinTextblocksAround(r,s,e):!1},joinTextblockForward$1=(r,e,t)=>{let n=atBlockEnd(r,t);if(!n)return!1;let s=findCutAfter(n);return s?joinTextblocksAround(r,s,e):!1};function joinTextblocksAround(r,e,t){let n=e.nodeBefore,s=n,o=e.pos-1;for(;!s.isTextblock;o--){if(s.type.spec.isolating)return!1;let d=s.lastChild;if(!d)return!1;s=d}let a=e.nodeAfter,l=a,u=e.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let c=replaceStep(r.doc,o,u,Slice.empty);if(!c||c.from!=o||c instanceof ReplaceStep&&c.slice.size>=u-o)return!1;if(t){let d=r.tr.step(c);d.setSelection(TextSelection.create(d.doc,o)),t(d.scrollIntoView())}return!0}function textblockAt(r,e,t=!1){for(let n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const selectNodeBackward$1=(r,e,t)=>{let{$head:n,empty:s}=r.selection,o=n;if(!s)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",r):n.parentOffset>0)return!1;o=findCutBefore(n)}let a=o&&o.nodeBefore;return!a||!NodeSelection.isSelectable(a)?!1:(e&&e(r.tr.setSelection(NodeSelection.create(r.doc,o.pos-a.nodeSize)).scrollIntoView()),!0)};function findCutBefore(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function atBlockEnd(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("forward",r):t.parentOffset<t.parent.content.size)?null:t}const joinForward$1=(r,e,t)=>{let n=atBlockEnd(r,t);if(!n)return!1;let s=findCutAfter(n);if(!s)return!1;let o=s.nodeAfter;if(deleteBarrier(r,s,e,1))return!0;if(n.parent.content.size==0&&(textblockAt(o,"start")||NodeSelection.isSelectable(o))){let a=replaceStep(r.doc,n.before(),n.after(),Slice.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=r.tr.step(a);l.setSelection(textblockAt(o,"start")?Selection.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):NodeSelection.create(l.doc,l.mapping.map(s.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&s.depth==n.depth-1?(e&&e(r.tr.delete(s.pos,s.pos+o.nodeSize).scrollIntoView()),!0):!1},selectNodeForward$1=(r,e,t)=>{let{$head:n,empty:s}=r.selection,o=n;if(!s)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;o=findCutAfter(n)}let a=o&&o.nodeAfter;return!a||!NodeSelection.isSelectable(a)?!1:(e&&e(r.tr.setSelection(NodeSelection.create(r.doc,o.pos)).scrollIntoView()),!0)};function findCutAfter(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}const joinUp$1=(r,e)=>{let t=r.selection,n=t instanceof NodeSelection,s;if(n){if(t.node.isTextblock||!canJoin(r.doc,t.from))return!1;s=t.from}else if(s=joinPoint(r.doc,t.from,-1),s==null)return!1;if(e){let o=r.tr.join(s);n&&o.setSelection(NodeSelection.create(o.doc,s-r.doc.resolve(s).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},joinDown$1=(r,e)=>{let t=r.selection,n;if(t instanceof NodeSelection){if(t.node.isTextblock||!canJoin(r.doc,t.to))return!1;n=t.to}else if(n=joinPoint(r.doc,t.to,1),n==null)return!1;return e&&e(r.tr.join(n).scrollIntoView()),!0},lift$1=(r,e)=>{let{$from:t,$to:n}=r.selection,s=t.blockRange(n),o=s&&liftTarget(s);return o==null?!1:(e&&e(r.tr.lift(s,o).scrollIntoView()),!0)},newlineInCode$1=(r,e)=>{let{$head:t,$anchor:n}=r.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function defaultBlockAt$1(r){for(let e=0;e<r.edgeCount;e++){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const exitCode$1=(r,e)=>{let{$head:t,$anchor:n}=r.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let s=t.node(-1),o=t.indexAfter(-1),a=defaultBlockAt$1(s.contentMatchAt(o));if(!a||!s.canReplaceWith(o,o,a))return!1;if(e){let l=t.after(),u=r.tr.replaceWith(l,l,a.createAndFill());u.setSelection(Selection.near(u.doc.resolve(l),1)),e(u.scrollIntoView())}return!0},createParagraphNear$1=(r,e)=>{let t=r.selection,{$from:n,$to:s}=t;if(t instanceof AllSelection||n.parent.inlineContent||s.parent.inlineContent)return!1;let o=defaultBlockAt$1(s.parent.contentMatchAt(s.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let a=(!n.parentOffset&&s.index()<s.parent.childCount?n:s).pos,l=r.tr.insert(a,o.createAndFill());l.setSelection(TextSelection.create(l.doc,a+1)),e(l.scrollIntoView())}return!0},liftEmptyBlock$1=(r,e)=>{let{$cursor:t}=r.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(canSplit(r.doc,o))return e&&e(r.tr.split(o).scrollIntoView()),!0}let n=t.blockRange(),s=n&&liftTarget(n);return s==null?!1:(e&&e(r.tr.lift(n,s).scrollIntoView()),!0)},selectParentNode$1=(r,e)=>{let{$from:t,to:n}=r.selection,s,o=t.sharedDepth(n);return o==0?!1:(s=t.before(o),e&&e(r.tr.setSelection(NodeSelection.create(r.doc,s))),!0)};function joinMaybeClear(r,e,t){let n=e.nodeBefore,s=e.nodeAfter,o=e.index();return!n||!s||!n.type.compatibleContent(s.type)?!1:!n.content.size&&e.parent.canReplace(o-1,o)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(s.isTextblock||canJoin(r.doc,e.pos))?!1:(t&&t(r.tr.join(e.pos).scrollIntoView()),!0)}function deleteBarrier(r,e,t,n){let s=e.nodeBefore,o=e.nodeAfter,a,l,u=s.type.spec.isolating||o.type.spec.isolating;if(!u&&joinMaybeClear(r,e,t))return!0;let c=!u&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(a=(l=s.contentMatchAt(s.childCount)).findWrapping(o.type))&&l.matchType(a[0]||o.type).validEnd){if(t){let m=e.pos+o.nodeSize,E=Fragment.empty;for(let T=a.length-1;T>=0;T--)E=Fragment.from(a[T].create(null,E));E=Fragment.from(s.copy(E));let v=r.tr.step(new ReplaceAroundStep(e.pos-1,m,e.pos,m,new Slice(E,1,0),a.length,!0)),_=v.doc.resolve(m+2*a.length);_.nodeAfter&&_.nodeAfter.type==s.type&&canJoin(v.doc,_.pos)&&v.join(_.pos),t(v.scrollIntoView())}return!0}let d=o.type.spec.isolating||n>0&&u?null:Selection.findFrom(e,1),f=d&&d.$from.blockRange(d.$to),C=f&&liftTarget(f);if(C!=null&&C>=e.depth)return t&&t(r.tr.lift(f,C).scrollIntoView()),!0;if(c&&textblockAt(o,"start",!0)&&textblockAt(s,"end")){let m=s,E=[];for(;E.push(m),!m.isTextblock;)m=m.lastChild;let v=o,_=1;for(;!v.isTextblock;v=v.firstChild)_++;if(m.canReplace(m.childCount,m.childCount,v.content)){if(t){let T=Fragment.empty;for(let O=E.length-1;O>=0;O--)T=Fragment.from(E[O].copy(T));let R=r.tr.step(new ReplaceAroundStep(e.pos-E.length,e.pos+o.nodeSize,e.pos+_,e.pos+o.nodeSize-_,new Slice(T,E.length,0),0,!0));t(R.scrollIntoView())}return!0}}return!1}function selectTextblockSide(r){return function(e,t){let n=e.selection,s=r<0?n.$from:n.$to,o=s.depth;for(;s.node(o).isInline;){if(!o)return!1;o--}return s.node(o).isTextblock?(t&&t(e.tr.setSelection(TextSelection.create(e.doc,r<0?s.start(o):s.end(o)))),!0):!1}}const selectTextblockStart$1=selectTextblockSide(-1),selectTextblockEnd$1=selectTextblockSide(1);function wrapIn$1(r,e=null){return function(t,n){let{$from:s,$to:o}=t.selection,a=s.blockRange(o),l=a&&findWrapping(a,r,e);return l?(n&&n(t.tr.wrap(a,l).scrollIntoView()),!0):!1}}function setBlockType(r,e=null){return function(t,n){let s=!1;for(let o=0;o<t.selection.ranges.length&&!s;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];t.doc.nodesBetween(a,l,(u,c)=>{if(s)return!1;if(!(!u.isTextblock||u.hasMarkup(r,e)))if(u.type==r)s=!0;else{let d=t.doc.resolve(c),f=d.index();s=d.parent.canReplaceWith(f,f+1,r)}})}if(!s)return!1;if(n){let o=t.tr;for(let a=0;a<t.selection.ranges.length;a++){let{$from:{pos:l},$to:{pos:u}}=t.selection.ranges[a];o.setBlockType(l,u,r,e)}n(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function wrapInList$1(r,e=null){return function(t,n){let{$from:s,$to:o}=t.selection,a=s.blockRange(o);if(!a)return!1;let l=n?t.tr:null;return wrapRangeInList(l,a,r,e)?(n&&n(l.scrollIntoView()),!0):!1}}function wrapRangeInList(r,e,t,n=null){let s=!1,o=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=a.resolve(e.start-2);o=new NodeRange(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new NodeRange(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let l=findWrapping(o,t,n,e);return l?(r&&doWrapInList(r,e,l,s,t),!0):!1}function doWrapInList(r,e,t,n,s){let o=Fragment.empty;for(let d=t.length-1;d>=0;d--)o=Fragment.from(t[d].type.create(t[d].attrs,o));r.step(new ReplaceAroundStep(e.start-(n?2:0),e.end,e.start,e.end,new Slice(o,0,0),t.length,!0));let a=0;for(let d=0;d<t.length;d++)t[d].type==s&&(a=d+1);let l=t.length-a,u=e.start+t.length-(n?2:0),c=e.parent;for(let d=e.startIndex,f=e.endIndex,C=!0;d<f;d++,C=!1)!C&&canSplit(r.doc,u,l)&&(r.split(u,l),u+=2*l),u+=c.child(d).nodeSize;return r}function liftListItem$1(r){return function(e,t){let{$from:n,$to:s}=e.selection,o=n.blockRange(s,a=>a.childCount>0&&a.firstChild.type==r);return o?t?n.node(o.depth-1).type==r?liftToOuterList(e,t,r,o):liftOutOfList(e,t,o):!0:!1}}function liftToOuterList(r,e,t,n){let s=r.tr,o=n.end,a=n.$to.end(n.depth);o<a&&(s.step(new ReplaceAroundStep(o-1,a,o,a,new Slice(Fragment.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new NodeRange(s.doc.resolve(n.$from.pos),s.doc.resolve(a),n.depth));const l=liftTarget(n);if(l==null)return!1;s.lift(n,l);let u=s.mapping.map(o,-1)-1;return canJoin(s.doc,u)&&s.join(u),e(s.scrollIntoView()),!0}function liftOutOfList(r,e,t){let n=r.tr,s=t.parent;for(let m=t.end,E=t.endIndex-1,v=t.startIndex;E>v;E--)m-=s.child(E).nodeSize,n.delete(m-1,m+1);let o=n.doc.resolve(t.start),a=o.nodeAfter;if(n.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,u=t.endIndex==s.childCount,c=o.node(-1),d=o.index(-1);if(!c.canReplace(d+(l?0:1),d+1,a.content.append(u?Fragment.empty:Fragment.from(s))))return!1;let f=o.pos,C=f+a.nodeSize;return n.step(new ReplaceAroundStep(f-(l?1:0),C+(u?1:0),f+1,C-1,new Slice((l?Fragment.empty:Fragment.from(s.copy(Fragment.empty))).append(u?Fragment.empty:Fragment.from(s.copy(Fragment.empty))),l?0:1,u?0:1),l?0:1)),e(n.scrollIntoView()),!0}function sinkListItem$1(r){return function(e,t){let{$from:n,$to:s}=e.selection,o=n.blockRange(s,c=>c.childCount>0&&c.firstChild.type==r);if(!o)return!1;let a=o.startIndex;if(a==0)return!1;let l=o.parent,u=l.child(a-1);if(u.type!=r)return!1;if(t){let c=u.lastChild&&u.lastChild.type==l.type,d=Fragment.from(c?r.create():null),f=new Slice(Fragment.from(r.create(null,Fragment.from(l.type.create(null,d)))),c?3:1,0),C=o.start,m=o.end;t(e.tr.step(new ReplaceAroundStep(C-(c?3:1),m,C,m,f,1,!0)).scrollIntoView())}return!0}}function createChainableState(r){const{state:e,transaction:t}=r;let{selection:n}=t,{doc:s}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return s},get tr(){return n=t.selection,s=t.doc,o=t.storedMarks,t}}}class CommandManager{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:s}=t,{tr:o}=n,a=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([l,u])=>[l,(...d)=>{const f=u(...d)(a);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:s,state:o}=this,{view:a}=s,l=[],u=!!e,c=e||o.tr,d=()=>(!u&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(c),l.every(C=>C===!0)),f={...Object.fromEntries(Object.entries(n).map(([C,m])=>[C,(...v)=>{const _=this.buildProps(c,t),T=m(...v)(_);return l.push(T),f}])),run:d};return f}createCan(e){const{rawCommands:t,state:n}=this,s=!1,o=e||n.tr,a=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(t).map(([u,c])=>[u,(...d)=>c(...d)({...a,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(e,t=!0){const{rawCommands:n,editor:s,state:o}=this,{view:a}=s,l={tr:e,editor:s,view:a,state:createChainableState({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([u,c])=>[u,(...d)=>c(...d)(l)]))}};return l}}class EventEmitter{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(s=>s.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(s=>s!==t):delete this.callbacks[e]),this}once(e,t){const n=(...s)=>{this.off(e,n),t.apply(this,s)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function getExtensionField(r,e,t){return r.config[e]===void 0&&r.parent?getExtensionField(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?getExtensionField(r.parent,e,t):null}):r.config[e]}function splitExtensions(r){const e=r.filter(s=>s.type==="extension"),t=r.filter(s=>s.type==="node"),n=r.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function getAttributesFromExtensions(r){const e=[],{nodeExtensions:t,markExtensions:n}=splitExtensions(r),s=[...t,...n],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return r.forEach(a=>{const l={name:a.name,options:a.options,storage:a.storage,extensions:s},u=getExtensionField(a,"addGlobalAttributes",l);if(!u)return;u().forEach(d=>{d.types.forEach(f=>{Object.entries(d.attributes).forEach(([C,m])=>{e.push({type:f,name:C,attribute:{...o,...m}})})})})}),s.forEach(a=>{const l={name:a.name,options:a.options,storage:a.storage},u=getExtensionField(a,"addAttributes",l);if(!u)return;const c=u();Object.entries(c).forEach(([d,f])=>{const C={...o,...f};typeof(C==null?void 0:C.default)=="function"&&(C.default=C.default()),C!=null&&C.isRequired&&(C==null?void 0:C.default)===void 0&&delete C.default,e.push({type:a.name,name:d,attribute:C})})}),e}function getNodeType(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}function mergeAttributes(...r){return r.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([s,o])=>{if(!n[s]){n[s]=o;return}if(s==="class"){const l=o?String(o).split(" "):[],u=n[s]?n[s].split(" "):[],c=l.filter(d=>!u.includes(d));n[s]=[...u,...c].join(" ")}else if(s==="style"){const l=o?o.split(";").map(d=>d.trim()).filter(Boolean):[],u=n[s]?n[s].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;u.forEach(d=>{const[f,C]=d.split(":").map(m=>m.trim());c.set(f,C)}),l.forEach(d=>{const[f,C]=d.split(":").map(m=>m.trim());c.set(f,C)}),n[s]=Array.from(c.entries()).map(([d,f])=>`${d}: ${f}`).join("; ")}else n[s]=o}),n},{})}function getRenderedAttributes(r,e){return e.filter(t=>t.type===r.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(r.attrs)||{}:{[t.name]:r.attrs[t.name]}).reduce((t,n)=>mergeAttributes(t,n),{})}function isFunction(r){return typeof r=="function"}function callOrReturn(r,e=void 0,...t){return isFunction(r)?e?r.bind(e)(...t):r(...t):r}function isEmptyObject(r={}){return Object.keys(r).length===0&&r.constructor===Object}function fromString(r){return typeof r!="string"?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):r==="true"?!0:r==="false"?!1:r}function injectExtensionAttributesToParseRule(r,e){return"style"in r?r:{...r,getAttrs:t=>{const n=r.getAttrs?r.getAttrs(t):r.attrs;if(n===!1)return!1;const s=e.reduce((o,a)=>{const l=a.attribute.parseHTML?a.attribute.parseHTML(t):fromString(t.getAttribute(a.name));return l==null?o:{...o,[a.name]:l}},{});return{...n,...s}}}}function cleanUpSchemaItem(r){return Object.fromEntries(Object.entries(r).filter(([e,t])=>e==="attrs"&&isEmptyObject(t)?!1:t!=null))}function getSchemaByResolvedExtensions(r,e){var t;const n=getAttributesFromExtensions(r),{nodeExtensions:s,markExtensions:o}=splitExtensions(r),a=(t=s.find(c=>getExtensionField(c,"topNode")))===null||t===void 0?void 0:t.name,l=Object.fromEntries(s.map(c=>{const d=n.filter(T=>T.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},C=r.reduce((T,R)=>{const O=getExtensionField(R,"extendNodeSchema",f);return{...T,...O?O(c):{}}},{}),m=cleanUpSchemaItem({...C,content:callOrReturn(getExtensionField(c,"content",f)),marks:callOrReturn(getExtensionField(c,"marks",f)),group:callOrReturn(getExtensionField(c,"group",f)),inline:callOrReturn(getExtensionField(c,"inline",f)),atom:callOrReturn(getExtensionField(c,"atom",f)),selectable:callOrReturn(getExtensionField(c,"selectable",f)),draggable:callOrReturn(getExtensionField(c,"draggable",f)),code:callOrReturn(getExtensionField(c,"code",f)),whitespace:callOrReturn(getExtensionField(c,"whitespace",f)),linebreakReplacement:callOrReturn(getExtensionField(c,"linebreakReplacement",f)),defining:callOrReturn(getExtensionField(c,"defining",f)),isolating:callOrReturn(getExtensionField(c,"isolating",f)),attrs:Object.fromEntries(d.map(T=>{var R;return[T.name,{default:(R=T==null?void 0:T.attribute)===null||R===void 0?void 0:R.default}]}))}),E=callOrReturn(getExtensionField(c,"parseHTML",f));E&&(m.parseDOM=E.map(T=>injectExtensionAttributesToParseRule(T,d)));const v=getExtensionField(c,"renderHTML",f);v&&(m.toDOM=T=>v({node:T,HTMLAttributes:getRenderedAttributes(T,d)}));const _=getExtensionField(c,"renderText",f);return _&&(m.toText=_),[c.name,m]})),u=Object.fromEntries(o.map(c=>{const d=n.filter(_=>_.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},C=r.reduce((_,T)=>{const R=getExtensionField(T,"extendMarkSchema",f);return{..._,...R?R(c):{}}},{}),m=cleanUpSchemaItem({...C,inclusive:callOrReturn(getExtensionField(c,"inclusive",f)),excludes:callOrReturn(getExtensionField(c,"excludes",f)),group:callOrReturn(getExtensionField(c,"group",f)),spanning:callOrReturn(getExtensionField(c,"spanning",f)),code:callOrReturn(getExtensionField(c,"code",f)),attrs:Object.fromEntries(d.map(_=>{var T;return[_.name,{default:(T=_==null?void 0:_.attribute)===null||T===void 0?void 0:T.default}]}))}),E=callOrReturn(getExtensionField(c,"parseHTML",f));E&&(m.parseDOM=E.map(_=>injectExtensionAttributesToParseRule(_,d)));const v=getExtensionField(c,"renderHTML",f);return v&&(m.toDOM=_=>v({mark:_,HTMLAttributes:getRenderedAttributes(_,d)})),[c.name,m]}));return new Schema({topNode:a,nodes:l,marks:u})}function getSchemaTypeByName(r,e){return e.nodes[r]||e.marks[r]||null}function isExtensionRulesEnabled(r,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===r.name):e}function getHTMLFromFragment(r,e){const t=DOMSerializer.fromSchema(e).serializeFragment(r),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}const getTextContentFromNodes=(r,e=500)=>{let t="";const n=r.parentOffset;return r.parent.nodesBetween(Math.max(0,n-e),n,(s,o,a,l)=>{var u,c;const d=((c=(u=s.type.spec).toText)===null||c===void 0?void 0:c.call(u,{node:s,pos:o,parent:a,index:l}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?d:d.slice(0,Math.max(0,n-o))}),t};function isRegExp(r){return Object.prototype.toString.call(r)==="[object RegExp]"}class InputRule{constructor(e){this.find=e.find,this.handler=e.handler}}const inputRuleMatcherHandler=(r,e)=>{if(isRegExp(e))return e.exec(r);const t=e(r);if(!t)return null;const n=[t.text];return n.index=t.index,n.input=r,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(t.replaceWith)),n};function run$1(r){var e;const{editor:t,from:n,to:s,text:o,rules:a,plugin:l}=r,{view:u}=t;if(u.composing)return!1;const c=u.state.doc.resolve(n);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(C=>C.type.spec.code))return!1;let d=!1;const f=getTextContentFromNodes(c)+o;return a.forEach(C=>{if(d)return;const m=inputRuleMatcherHandler(f,C.find);if(!m)return;const E=u.state.tr,v=createChainableState({state:u.state,transaction:E}),_={from:n-(m[0].length-o.length),to:s},{commands:T,chain:R,can:O}=new CommandManager({editor:t,state:v});C.handler({state:v,range:_,match:m,commands:T,chain:R,can:O})===null||!E.steps.length||(E.setMeta(l,{transform:E,from:n,to:s,text:o}),u.dispatch(E),d=!0)}),d}function inputRulesPlugin(r){const{editor:e,rules:t}=r,n=new Plugin({state:{init(){return null},apply(s,o,a){const l=s.getMeta(n);if(l)return l;const u=s.getMeta("applyInputRules");return!!u&&setTimeout(()=>{let{text:d}=u;typeof d=="string"?d=d:d=getHTMLFromFragment(Fragment.from(d),a.schema);const{from:f}=u,C=f+d.length;run$1({editor:e,from:f,to:C,text:d,rules:t,plugin:n})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,a,l){return run$1({editor:e,from:o,to:a,text:l,rules:t,plugin:n})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&run$1({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:n})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:a}=s.state.selection;return a?run$1({editor:e,from:a.pos,to:a.pos,text:`
`,rules:t,plugin:n}):!1}},isInputRules:!0});return n}function getType(r){return Object.prototype.toString.call(r).slice(8,-1)}function isPlainObject(r){return getType(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function mergeDeep(r,e){const t={...r};return isPlainObject(r)&&isPlainObject(e)&&Object.keys(e).forEach(n=>{isPlainObject(e[n])&&isPlainObject(r[n])?t[n]=mergeDeep(r[n],e[n]):t[n]=e[n]}),t}class Mark{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Mark(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>mergeDeep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Mark(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=callOrReturn(getExtensionField(t,"addOptions",{name:t.name})),t.storage=callOrReturn(getExtensionField(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const a=s.marks();if(!!!a.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const u=a.find(c=>(c==null?void 0:c.type.name)===t.name);return u&&n.removeStoredMark(u),n.insertText(" ",s.pos),e.view.dispatch(n),!0}return!1}}function isNumber(r){return typeof r=="number"}class PasteRule{constructor(e){this.find=e.find,this.handler=e.handler}}const pasteRuleMatcherHandler=(r,e,t)=>{if(isRegExp(e))return[...r.matchAll(e)];const n=e(r,t);return n?n.map(s=>{const o=[s.text];return o.index=s.index,o.input=r,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function run(r){const{editor:e,state:t,from:n,to:s,rule:o,pasteEvent:a,dropEvent:l}=r,{commands:u,chain:c,can:d}=new CommandManager({editor:e,state:t}),f=[];return t.doc.nodesBetween(n,s,(m,E)=>{if(!m.isTextblock||m.type.spec.code)return;const v=Math.max(n,E),_=Math.min(s,E+m.content.size),T=m.textBetween(v-E,_-E,void 0,"");pasteRuleMatcherHandler(T,o.find,a).forEach(O=>{if(O.index===void 0)return;const N=v+O.index+1,G=N+O[0].length,D={from:t.tr.mapping.map(N),to:t.tr.mapping.map(G)},k=o.handler({state:t,range:D,match:O,commands:u,chain:c,can:d,pasteEvent:a,dropEvent:l});f.push(k)})}),f.every(m=>m!==null)}let tiptapDragFromOtherEditor=null;const createClipboardPasteEvent=r=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",r),t};function pasteRulesPlugin(r){const{editor:e,rules:t}=r;let n=null,s=!1,o=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const u=({state:d,from:f,to:C,rule:m,pasteEvt:E})=>{const v=d.tr,_=createChainableState({state:d,transaction:v});if(!(!run({editor:e,state:_,from:Math.max(f-1,0),to:C.b-1,rule:m,pasteEvent:E,dropEvent:l})||!v.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return t.map(d=>new Plugin({view(f){const C=E=>{var v;n=!((v=f.dom.parentElement)===null||v===void 0)&&v.contains(E.target)?f.dom.parentElement:null,n&&(tiptapDragFromOtherEditor=e)},m=()=>{tiptapDragFromOtherEditor&&(tiptapDragFromOtherEditor=null)};return window.addEventListener("dragstart",C),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",C),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(f,C)=>{if(o=n===f.dom.parentElement,l=C,!o){const m=tiptapDragFromOtherEditor;m&&setTimeout(()=>{const E=m.state.selection;E&&m.commands.deleteRange({from:E.from,to:E.to})},10)}return!1},paste:(f,C)=>{var m;const E=(m=C.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return a=C,s=!!(E!=null&&E.includes("data-pm-slice")),!1}}},appendTransaction:(f,C,m)=>{const E=f[0],v=E.getMeta("uiEvent")==="paste"&&!s,_=E.getMeta("uiEvent")==="drop"&&!o,T=E.getMeta("applyPasteRules"),R=!!T;if(!v&&!_&&!R)return;if(R){let{text:G}=T;typeof G=="string"?G=G:G=getHTMLFromFragment(Fragment.from(G),m.schema);const{from:D}=T,k=D+G.length,z=createClipboardPasteEvent(G);return u({rule:d,state:m,from:D,to:{b:k},pasteEvt:z})}const O=C.doc.content.findDiffStart(m.doc.content),N=C.doc.content.findDiffEnd(m.doc.content);if(!(!isNumber(O)||!N||O===N.b))return u({rule:d,state:m,from:O,to:N,pasteEvt:a})}}))}function findDuplicates(r){const e=r.filter((t,n)=>r.indexOf(t)!==n);return Array.from(new Set(e))}class ExtensionManager{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=ExtensionManager.resolve(e),this.schema=getSchemaByResolvedExtensions(this.extensions,t),this.setupExtensions()}static resolve(e){const t=ExtensionManager.sort(ExtensionManager.flatten(e)),n=findDuplicates(t.map(s=>s.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const n={name:t.name,options:t.options,storage:t.storage},s=getExtensionField(t,"addExtensions",n);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((n,s)=>{const o=getExtensionField(n,"priority")||100,a=getExtensionField(s,"priority")||100;return o>a?-1:o<a?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:getSchemaTypeByName(t.name,this.schema)},s=getExtensionField(t,"addCommands",n);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=ExtensionManager.sort([...this.extensions].reverse()),n=[],s=[],o=t.map(a=>{const l={name:a.name,options:a.options,storage:a.storage,editor:e,type:getSchemaTypeByName(a.name,this.schema)},u=[],c=getExtensionField(a,"addKeyboardShortcuts",l);let d={};if(a.type==="mark"&&getExtensionField(a,"exitable",l)&&(d.ArrowRight=()=>Mark.handleExit({editor:e,mark:a})),c){const v=Object.fromEntries(Object.entries(c()).map(([_,T])=>[_,()=>T({editor:e})]));d={...d,...v}}const f=keymap(d);u.push(f);const C=getExtensionField(a,"addInputRules",l);isExtensionRulesEnabled(a,e.options.enableInputRules)&&C&&n.push(...C());const m=getExtensionField(a,"addPasteRules",l);isExtensionRulesEnabled(a,e.options.enablePasteRules)&&m&&s.push(...m());const E=getExtensionField(a,"addProseMirrorPlugins",l);if(E){const v=E();u.push(...v)}return u}).flat();return[inputRulesPlugin({editor:e,rules:n}),...pasteRulesPlugin({editor:e,rules:s}),...o]}get attributes(){return getAttributesFromExtensions(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=splitExtensions(this.extensions);return Object.fromEntries(t.filter(n=>!!getExtensionField(n,"addNodeView")).map(n=>{const s=this.attributes.filter(u=>u.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:e,type:getNodeType(n.name,this.schema)},a=getExtensionField(n,"addNodeView",o);if(!a)return[];const l=(u,c,d,f,C)=>{const m=getRenderedAttributes(u,s);return a()({node:u,view:c,getPos:d,decorations:f,innerDecorations:C,editor:e,extension:n,HTMLAttributes:m})};return[n.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:getSchemaTypeByName(e.name,this.schema)};e.type==="mark"&&(!((t=callOrReturn(getExtensionField(e,"keepOnSplit",n)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=getExtensionField(e,"onBeforeCreate",n),o=getExtensionField(e,"onCreate",n),a=getExtensionField(e,"onUpdate",n),l=getExtensionField(e,"onSelectionUpdate",n),u=getExtensionField(e,"onTransaction",n),c=getExtensionField(e,"onFocus",n),d=getExtensionField(e,"onBlur",n),f=getExtensionField(e,"onDestroy",n);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),u&&this.editor.on("transaction",u),c&&this.editor.on("focus",c),d&&this.editor.on("blur",d),f&&this.editor.on("destroy",f)})}}class Extension{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Extension(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>mergeDeep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Extension({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=callOrReturn(getExtensionField(t,"addOptions",{name:t.name})),t.storage=callOrReturn(getExtensionField(t,"addStorage",{name:t.name,options:t.options})),t}}function getTextBetween(r,e,t){const{from:n,to:s}=e,{blockSeparator:o=`

`,textSerializers:a={}}=t||{};let l="";return r.nodesBetween(n,s,(u,c,d,f)=>{var C;u.isBlock&&c>n&&(l+=o);const m=a==null?void 0:a[u.type.name];if(m)return d&&(l+=m({node:u,pos:c,parent:d,index:f,range:e})),!1;u.isText&&(l+=(C=u==null?void 0:u.text)===null||C===void 0?void 0:C.slice(Math.max(n,c)-c,s-c))}),l}function getTextSerializersFromSchema(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const ClipboardTextSerializer=Extension.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:s}=e,{ranges:o}=s,a=Math.min(...o.map(d=>d.$from.pos)),l=Math.max(...o.map(d=>d.$to.pos)),u=getTextSerializersFromSchema(t);return getTextBetween(n,{from:a,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),blur=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),clearContent=(r=!1)=>({commands:e})=>e.setContent("",r),clearNodes=()=>({state:r,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:s}=n;return t&&s.forEach(({$from:o,$to:a})=>{r.doc.nodesBetween(o.pos,a.pos,(l,u)=>{if(l.type.isText)return;const{doc:c,mapping:d}=e,f=c.resolve(d.map(u)),C=c.resolve(d.map(u+l.nodeSize)),m=f.blockRange(C);if(!m)return;const E=liftTarget(m);if(l.type.isTextblock){const{defaultType:v}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,v)}(E||E===0)&&e.lift(m,E)})}),!0},command=r=>e=>r(e),createParagraphNear=()=>({state:r,dispatch:e})=>createParagraphNear$1(r,e),cut=(r,e)=>({editor:t,tr:n})=>{const{state:s}=t,o=s.doc.slice(r.from,r.to);n.deleteRange(r.from,r.to);const a=n.mapping.map(e);return n.insert(a,o.content),n.setSelection(new TextSelection(n.doc.resolve(a-1))),!0},deleteCurrentNode=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,n=t.$anchor.node();if(n.content.size>0)return!1;const s=r.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===n.type){if(e){const l=s.before(o),u=s.after(o);r.delete(l,u).scrollIntoView()}return!0}return!1},deleteNode=r=>({tr:e,state:t,dispatch:n})=>{const s=getNodeType(r,t.schema),o=e.selection.$anchor;for(let a=o.depth;a>0;a-=1)if(o.node(a).type===s){if(n){const u=o.before(a),c=o.after(a);e.delete(u,c).scrollIntoView()}return!0}return!1},deleteRange=r=>({tr:e,dispatch:t})=>{const{from:n,to:s}=r;return t&&e.delete(n,s),!0},deleteSelection=()=>({state:r,dispatch:e})=>deleteSelection$1(r,e),enter=()=>({commands:r})=>r.keyboardShortcut("Enter"),exitCode=()=>({state:r,dispatch:e})=>exitCode$1(r,e);function objectIncludes(r,e,t={strict:!0}){const n=Object.keys(e);return n.length?n.every(s=>t.strict?e[s]===r[s]:isRegExp(e[s])?e[s].test(r[s]):e[s]===r[s]):!0}function findMarkInSet(r,e,t={}){return r.find(n=>n.type===e&&objectIncludes(Object.fromEntries(Object.keys(t).map(s=>[s,n.attrs[s]])),t))}function isMarkInSet(r,e,t={}){return!!findMarkInSet(r,e,t)}function getMarkRange(r,e,t){var n;if(!r||!e)return;let s=r.parent.childAfter(r.parentOffset);if((!s.node||!s.node.marks.some(d=>d.type===e))&&(s=r.parent.childBefore(r.parentOffset)),!s.node||!s.node.marks.some(d=>d.type===e)||(t=t||((n=s.node.marks[0])===null||n===void 0?void 0:n.attrs),!findMarkInSet([...s.node.marks],e,t)))return;let a=s.index,l=r.start()+s.offset,u=a+1,c=l+s.node.nodeSize;for(;a>0&&isMarkInSet([...r.parent.child(a-1).marks],e,t);)a-=1,l-=r.parent.child(a).nodeSize;for(;u<r.parent.childCount&&isMarkInSet([...r.parent.child(u).marks],e,t);)c+=r.parent.child(u).nodeSize,u+=1;return{from:l,to:c}}function getMarkType(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}const extendMarkRange=(r,e={})=>({tr:t,state:n,dispatch:s})=>{const o=getMarkType(r,n.schema),{doc:a,selection:l}=t,{$from:u,from:c,to:d}=l;if(s){const f=getMarkRange(u,o,e);if(f&&f.from<=c&&f.to>=d){const C=TextSelection.create(a,f.from,f.to);t.setSelection(C)}}return!0},first=r=>e=>{const t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1};function isTextSelection(r){return r instanceof TextSelection}function minMax(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function resolveFocusPosition(r,e=null){if(!e)return null;const t=Selection.atStart(r),n=Selection.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;const s=t.from,o=n.to;return e==="all"?TextSelection.create(r,minMax(0,s,o),minMax(r.content.size,s,o)):TextSelection.create(r,minMax(e,s,o),minMax(e,s,o))}const focus=(r=null,e={})=>({editor:t,view:n,tr:s,dispatch:o})=>{e={scrollIntoView:!0,...e};const a=()=>{n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(o&&r===null&&!isTextSelection(t.state.selection))return a(),!0;const l=resolveFocusPosition(s.doc,r)||t.state.selection,u=t.state.selection.eq(l);return o&&(u||s.setSelection(l),u&&s.storedMarks&&s.setStoredMarks(s.storedMarks),a()),!0},forEach=(r,e)=>t=>r.every((n,s)=>e(n,{...t,index:s})),insertContent=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e),removeWhitespaces=r=>{const e=r.childNodes;for(let t=e.length-1;t>=0;t-=1){const n=e[t];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?r.removeChild(n):n.nodeType===1&&removeWhitespaces(n)}return r};function elementFromString(r){const e=`<body>${r}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return removeWhitespaces(t)}function createNodeFromContent(r,e,t){if(r instanceof Node$2||r instanceof Fragment)return r;t={slice:!0,parseOptions:{},...t};const n=typeof r=="object"&&r!==null,s=typeof r=="string";if(n)try{if(Array.isArray(r)&&r.length>0)return Fragment.fromArray(r.map(l=>e.nodeFromJSON(l)));const a=e.nodeFromJSON(r);return t.errorOnInvalidContent&&a.check(),a}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",o),createNodeFromContent("",e,t)}if(s){if(t.errorOnInvalidContent){let a=!1,l="";const u=new Schema({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(a=!0,l=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?DOMParser$1.fromSchema(u).parseSlice(elementFromString(r),t.parseOptions):DOMParser$1.fromSchema(u).parse(elementFromString(r),t.parseOptions),t.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const o=DOMParser$1.fromSchema(e);return t.slice?o.parseSlice(elementFromString(r),t.parseOptions).content:o.parse(elementFromString(r),t.parseOptions)}return createNodeFromContent("",e,t)}function selectionToInsertionEnd(r,e,t){const n=r.steps.length-1;if(n<e)return;const s=r.steps[n];if(!(s instanceof ReplaceStep||s instanceof ReplaceAroundStep))return;const o=r.mapping.maps[n];let a=0;o.forEach((l,u,c,d)=>{a===0&&(a=d)}),r.setSelection(Selection.near(r.doc.resolve(a),t))}const isFragment=r=>!("type"in r),insertContentAt=(r,e,t)=>({tr:n,dispatch:s,editor:o})=>{var a;if(s){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let l;try{l=createNodeFromContent(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(a=t.errorOnInvalidContent)!==null&&a!==void 0?a:o.options.enableContentCheck})}catch(E){return o.emit("contentError",{editor:o,error:E,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:u,to:c}=typeof r=="number"?{from:r,to:r}:{from:r.from,to:r.to},d=!0,f=!0;if((isFragment(l)?l:[l]).forEach(E=>{E.check(),d=d?E.isText&&E.marks.length===0:!1,f=f?E.isBlock:!1}),u===c&&f){const{parent:E}=n.doc.resolve(u);E.isTextblock&&!E.type.spec.code&&!E.childCount&&(u-=1,c+=1)}let m;if(d){if(Array.isArray(e))m=e.map(E=>E.text||"").join("");else if(e instanceof Fragment){let E="";e.forEach(v=>{v.text&&(E+=v.text)}),m=E}else typeof e=="object"&&e&&e.text?m=e.text:m=e;n.insertText(m,u,c)}else m=l,n.replaceWith(u,c,m);t.updateSelection&&selectionToInsertionEnd(n,n.steps.length-1,-1),t.applyInputRules&&n.setMeta("applyInputRules",{from:u,text:m}),t.applyPasteRules&&n.setMeta("applyPasteRules",{from:u,text:m})}return!0},joinUp=()=>({state:r,dispatch:e})=>joinUp$1(r,e),joinDown=()=>({state:r,dispatch:e})=>joinDown$1(r,e),joinBackward=()=>({state:r,dispatch:e})=>joinBackward$1(r,e),joinForward=()=>({state:r,dispatch:e})=>joinForward$1(r,e),joinItemBackward=()=>({state:r,dispatch:e,tr:t})=>{try{const n=joinPoint(r.doc,r.selection.$from.pos,-1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},joinItemForward=()=>({state:r,dispatch:e,tr:t})=>{try{const n=joinPoint(r.doc,r.selection.$from.pos,1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},joinTextblockBackward=()=>({state:r,dispatch:e})=>joinTextblockBackward$1(r,e),joinTextblockForward=()=>({state:r,dispatch:e})=>joinTextblockForward$1(r,e);function isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function isMacOS(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function normalizeKeyName(r){const e=r.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let n,s,o,a;for(let l=0;l<e.length-1;l+=1){const u=e[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))isiOS()||isMacOS()?a=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return n&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),a&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const keyboardShortcut=r=>({editor:e,view:t,tr:n,dispatch:s})=>{const o=normalizeKeyName(r).split(/-(?!$)/),a=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,l))});return u==null||u.steps.forEach(c=>{const d=c.map(n.mapping);d&&s&&n.maybeStep(d)}),!0};function isNodeActive(r,e,t={}){const{from:n,to:s,empty:o}=r.selection,a=e?getNodeType(e,r.schema):null,l=[];r.doc.nodesBetween(n,s,(f,C)=>{if(f.isText)return;const m=Math.max(n,C),E=Math.min(s,C+f.nodeSize);l.push({node:f,from:m,to:E})});const u=s-n,c=l.filter(f=>a?a.name===f.node.type.name:!0).filter(f=>objectIncludes(f.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((f,C)=>f+C.to-C.from,0)>=u}const lift=(r,e={})=>({state:t,dispatch:n})=>{const s=getNodeType(r,t.schema);return isNodeActive(t,s,e)?lift$1(t,n):!1},liftEmptyBlock=()=>({state:r,dispatch:e})=>liftEmptyBlock$1(r,e),liftListItem=r=>({state:e,dispatch:t})=>{const n=getNodeType(r,e.schema);return liftListItem$1(n)(e,t)},newlineInCode=()=>({state:r,dispatch:e})=>newlineInCode$1(r,e);function getSchemaTypeNameByName(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function deleteProps(r,e){const t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,s)=>(t.includes(s)||(n[s]=r[s]),n),{})}const resetAttributes=(r,e)=>({tr:t,state:n,dispatch:s})=>{let o=null,a=null;const l=getSchemaTypeNameByName(typeof r=="string"?r:r.name,n.schema);return l?(l==="node"&&(o=getNodeType(r,n.schema)),l==="mark"&&(a=getMarkType(r,n.schema)),s&&t.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,d)=>{o&&o===c.type&&t.setNodeMarkup(d,void 0,deleteProps(c.attrs,e)),a&&c.marks.length&&c.marks.forEach(f=>{a===f.type&&t.addMark(d,d+c.nodeSize,a.create(deleteProps(f.attrs,e)))})})}),!0):!1},scrollIntoView=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),selectAll=()=>({tr:r,dispatch:e})=>{if(e){const t=new AllSelection(r.doc);r.setSelection(t)}return!0},selectNodeBackward=()=>({state:r,dispatch:e})=>selectNodeBackward$1(r,e),selectNodeForward=()=>({state:r,dispatch:e})=>selectNodeForward$1(r,e),selectParentNode=()=>({state:r,dispatch:e})=>selectParentNode$1(r,e),selectTextblockEnd=()=>({state:r,dispatch:e})=>selectTextblockEnd$1(r,e),selectTextblockStart=()=>({state:r,dispatch:e})=>selectTextblockStart$1(r,e);function createDocument(r,e,t={},n={}){return createNodeFromContent(r,e,{slice:!1,parseOptions:t,errorOnInvalidContent:n.errorOnInvalidContent})}const setContent=(r,e=!1,t={},n={})=>({editor:s,tr:o,dispatch:a,commands:l})=>{var u,c;const{doc:d}=o;if(t.preserveWhitespace!=="full"){const f=createDocument(r,s.schema,t,{errorOnInvalidContent:(u=n.errorOnInvalidContent)!==null&&u!==void 0?u:s.options.enableContentCheck});return a&&o.replaceWith(0,d.content.size,f).setMeta("preventUpdate",!e),!0}return a&&o.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:d.content.size},r,{parseOptions:t,errorOnInvalidContent:(c=n.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function getMarkAttributes(r,e){const t=getMarkType(e,r.schema),{from:n,to:s,empty:o}=r.selection,a=[];o?(r.storedMarks&&a.push(...r.storedMarks),a.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,s,u=>{a.push(...u.marks)});const l=a.find(u=>u.type.name===t.name);return l?{...l.attrs}:{}}function defaultBlockAt(r){for(let e=0;e<r.edgeCount;e+=1){const{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function findParentNodeClosestToPos(r,e){for(let t=r.depth;t>0;t-=1){const n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function findParentNode(r){return e=>findParentNodeClosestToPos(e.$from,r)}function getText(r,e){const t={from:0,to:r.content.size};return getTextBetween(r,t,e)}function getNodeAttributes(r,e){const t=getNodeType(e,r.schema),{from:n,to:s}=r.selection,o=[];r.doc.nodesBetween(n,s,l=>{o.push(l)});const a=o.reverse().find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function getAttributes(r,e){const t=getSchemaTypeNameByName(typeof e=="string"?e:e.name,r.schema);return t==="node"?getNodeAttributes(r,e):t==="mark"?getMarkAttributes(r,e):{}}function getMarksBetween(r,e,t){const n=[];return r===e?t.resolve(r).marks().forEach(s=>{const o=t.resolve(r),a=getMarkRange(o,s.type);a&&n.push({mark:s,...a})}):t.nodesBetween(r,e,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||n.push(...s.marks.map(a=>({from:o,to:o+s.nodeSize,mark:a})))}),n}function getSplittedAttributes(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const s=r.find(o=>o.type===e&&o.name===n);return s?s.attribute.keepOnSplit:!1}))}function isMarkActive(r,e,t={}){const{empty:n,ranges:s}=r.selection,o=e?getMarkType(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>objectIncludes(f.attrs,t,{strict:!1}));let a=0;const l=[];if(s.forEach(({$from:f,$to:C})=>{const m=f.pos,E=C.pos;r.doc.nodesBetween(m,E,(v,_)=>{if(!v.isText&&!v.marks.length)return;const T=Math.max(m,_),R=Math.min(E,_+v.nodeSize),O=R-T;a+=O,l.push(...v.marks.map(N=>({mark:N,from:T,to:R})))})}),a===0)return!1;const u=l.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>objectIncludes(f.mark.attrs,t,{strict:!1})).reduce((f,C)=>f+C.to-C.from,0),c=l.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,C)=>f+C.to-C.from,0);return(u>0?u+c:u)>=a}function isActive(r,e,t={}){if(!e)return isNodeActive(r,null,t)||isMarkActive(r,null,t);const n=getSchemaTypeNameByName(e,r.schema);return n==="node"?isNodeActive(r,e,t):n==="mark"?isMarkActive(r,e,t):!1}function isList(r,e){const{nodeExtensions:t}=splitExtensions(e),n=t.find(a=>a.name===r);if(!n)return!1;const s={name:n.name,options:n.options,storage:n.storage},o=callOrReturn(getExtensionField(n,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function isNodeEmpty(r,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var n;if(t){if(r.type.name==="hardBreak")return!0;if(r.isText)return/^\s*$/m.test((n=r.text)!==null&&n!==void 0?n:"")}if(r.isText)return!r.text;if(r.isAtom||r.isLeaf)return!1;if(r.content.childCount===0)return!0;if(e){let s=!0;return r.content.forEach(o=>{s!==!1&&(isNodeEmpty(o,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function isNodeSelection(r){return r instanceof NodeSelection}function canSetMark(r,e,t){var n;const{selection:s}=e;let o=null;if(isTextSelection(s)&&(o=s.$cursor),o){const l=(n=r.storedMarks)!==null&&n!==void 0?n:o.marks();return!!t.isInSet(l)||!l.some(u=>u.type.excludes(t))}const{ranges:a}=s;return a.some(({$from:l,$to:u})=>{let c=l.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(l.pos,u.pos,(d,f,C)=>{if(c)return!1;if(d.isInline){const m=!C||C.type.allowsMarkType(t),E=!!t.isInSet(d.marks)||!d.marks.some(v=>v.type.excludes(t));c=m&&E}return!c}),c})}const setMark=(r,e={})=>({tr:t,state:n,dispatch:s})=>{const{selection:o}=t,{empty:a,ranges:l}=o,u=getMarkType(r,n.schema);if(s)if(a){const c=getMarkAttributes(n,u);t.addStoredMark(u.create({...c,...e}))}else l.forEach(c=>{const d=c.$from.pos,f=c.$to.pos;n.doc.nodesBetween(d,f,(C,m)=>{const E=Math.max(m,d),v=Math.min(m+C.nodeSize,f);C.marks.find(T=>T.type===u)?C.marks.forEach(T=>{u===T.type&&t.addMark(E,v,u.create({...T.attrs,...e}))}):t.addMark(E,v,u.create(e))})});return canSetMark(n,t,u)},setMeta=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),setNode=(r,e={})=>({state:t,dispatch:n,chain:s})=>{const o=getNodeType(r,t.schema);let a;return t.selection.$anchor.sameParent(t.selection.$head)&&(a=t.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:l})=>setBlockType(o,{...a,...e})(t)?!0:l.clearNodes()).command(({state:l})=>setBlockType(o,{...a,...e})(l,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,s=minMax(r,0,n.content.size),o=NodeSelection.create(n,s);e.setSelection(o)}return!0},setTextSelection=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r,a=TextSelection.atStart(n).from,l=TextSelection.atEnd(n).to,u=minMax(s,a,l),c=minMax(o,a,l),d=TextSelection.create(n,u,c);e.setSelection(d)}return!0},sinkListItem=r=>({state:e,dispatch:t})=>{const n=getNodeType(r,e.schema);return sinkListItem$1(n)(e,t)};function ensureMarks(r,e){const t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){const n=t.filter(s=>e==null?void 0:e.includes(s.type.name));r.tr.ensureMarks(n)}}const splitBlock=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:s})=>{const{selection:o,doc:a}=e,{$from:l,$to:u}=o,c=s.extensionManager.attributes,d=getSplittedAttributes(c,l.node().type.name,l.node().attrs);if(o instanceof NodeSelection&&o.node.isBlock)return!l.parentOffset||!canSplit(a,l.pos)?!1:(n&&(r&&ensureMarks(t,s.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=u.parentOffset===u.parent.content.size,C=l.depth===0?void 0:defaultBlockAt(l.node(-1).contentMatchAt(l.indexAfter(-1)));let m=f&&C?[{type:C,attrs:d}]:void 0,E=canSplit(e.doc,e.mapping.map(l.pos),1,m);if(!m&&!E&&canSplit(e.doc,e.mapping.map(l.pos),1,C?[{type:C}]:void 0)&&(E=!0,m=C?[{type:C,attrs:d}]:void 0),n){if(E&&(o instanceof TextSelection&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,m),C&&!f&&!l.parentOffset&&l.parent.type!==C)){const v=e.mapping.map(l.before()),_=e.doc.resolve(v);l.node(-1).canReplaceWith(_.index(),_.index()+1,C)&&e.setNodeMarkup(e.mapping.map(l.before()),C)}r&&ensureMarks(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return E},splitListItem=(r,e={})=>({tr:t,state:n,dispatch:s,editor:o})=>{var a;const l=getNodeType(r,n.schema),{$from:u,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||u.depth<2||!u.sameParent(c))return!1;const f=u.node(-1);if(f.type!==l)return!1;const C=o.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==l||u.index(-2)!==u.node(-2).childCount-1)return!1;if(s){let T=Fragment.empty;const R=u.index(-1)?1:u.index(-2)?2:3;for(let z=u.depth-R;z>=u.depth-3;z-=1)T=Fragment.from(u.node(z).copy(T));const O=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,N={...getSplittedAttributes(C,u.node().type.name,u.node().attrs),...e},G=((a=l.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(N))||void 0;T=T.append(Fragment.from(l.createAndFill(null,G)||void 0));const D=u.before(u.depth-(R-1));t.replace(D,u.after(-O),new Slice(T,4-R,0));let k=-1;t.doc.nodesBetween(D,t.doc.content.size,(z,ne)=>{if(k>-1)return!1;z.isTextblock&&z.content.size===0&&(k=ne+1)}),k>-1&&t.setSelection(TextSelection.near(t.doc.resolve(k))),t.scrollIntoView()}return!0}const m=c.pos===u.end()?f.contentMatchAt(0).defaultType:null,E={...getSplittedAttributes(C,f.type.name,f.attrs),...e},v={...getSplittedAttributes(C,u.node().type.name,u.node().attrs),...e};t.delete(u.pos,c.pos);const _=m?[{type:l,attrs:E},{type:m,attrs:v}]:[{type:l,attrs:E}];if(!canSplit(t.doc,u.pos,2))return!1;if(s){const{selection:T,storedMarks:R}=n,{splittableMarks:O}=o.extensionManager,N=R||T.$to.parentOffset&&T.$from.marks();if(t.split(u.pos,2,_).scrollIntoView(),!N||!s)return!0;const G=N.filter(D=>O.includes(D.type.name));t.ensureMarks(G)}return!0},joinListBackwards=(r,e)=>{const t=findParentNode(a=>a.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;const s=r.doc.nodeAt(n);return t.node.type===(s==null?void 0:s.type)&&canJoin(r.doc,t.pos)&&r.join(t.pos),!0},joinListForwards=(r,e)=>{const t=findParentNode(a=>a.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;const s=r.doc.nodeAt(n);return t.node.type===(s==null?void 0:s.type)&&canJoin(r.doc,n)&&r.join(n),!0},toggleList=(r,e,t,n={})=>({editor:s,tr:o,state:a,dispatch:l,chain:u,commands:c,can:d})=>{const{extensions:f,splittableMarks:C}=s.extensionManager,m=getNodeType(r,a.schema),E=getNodeType(e,a.schema),{selection:v,storedMarks:_}=a,{$from:T,$to:R}=v,O=T.blockRange(R),N=_||v.$to.parentOffset&&v.$from.marks();if(!O)return!1;const G=findParentNode(D=>isList(D.type.name,f))(v);if(O.depth>=1&&G&&O.depth-G.depth<=1){if(G.node.type===m)return c.liftListItem(E);if(isList(G.node.type.name,f)&&m.validContent(G.node.content)&&l)return u().command(()=>(o.setNodeMarkup(G.pos,m),!0)).command(()=>joinListBackwards(o,m)).command(()=>joinListForwards(o,m)).run()}return!t||!N||!l?u().command(()=>d().wrapInList(m,n)?!0:c.clearNodes()).wrapInList(m,n).command(()=>joinListBackwards(o,m)).command(()=>joinListForwards(o,m)).run():u().command(()=>{const D=d().wrapInList(m,n),k=N.filter(z=>C.includes(z.type.name));return o.ensureMarks(k),D?!0:c.clearNodes()}).wrapInList(m,n).command(()=>joinListBackwards(o,m)).command(()=>joinListForwards(o,m)).run()},toggleMark=(r,e={},t={})=>({state:n,commands:s})=>{const{extendEmptyMarkRange:o=!1}=t,a=getMarkType(r,n.schema);return isMarkActive(n,a,e)?s.unsetMark(a,{extendEmptyMarkRange:o}):s.setMark(a,e)},toggleNode=(r,e,t={})=>({state:n,commands:s})=>{const o=getNodeType(r,n.schema),a=getNodeType(e,n.schema),l=isNodeActive(n,o,t);let u;return n.selection.$anchor.sameParent(n.selection.$head)&&(u=n.selection.$anchor.parent.attrs),l?s.setNode(a,u):s.setNode(o,{...u,...t})},toggleWrap=(r,e={})=>({state:t,commands:n})=>{const s=getNodeType(r,t.schema);return isNodeActive(t,s,e)?n.lift(s):n.wrapIn(s,e)},undoInputRule=()=>({state:r,dispatch:e})=>{const t=r.plugins;for(let n=0;n<t.length;n+=1){const s=t[n];let o;if(s.spec.isInputRules&&(o=s.getState(r))){if(e){const a=r.tr,l=o.transform;for(let u=l.steps.length-1;u>=0;u-=1)a.step(l.steps[u].invert(l.docs[u]));if(o.text){const u=a.doc.resolve(o.from).marks();a.replaceWith(o.from,o.to,r.schema.text(o.text,u))}else a.delete(o.from,o.to)}return!0}}return!1},unsetAllMarks=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,{empty:n,ranges:s}=t;return n||e&&s.forEach(o=>{r.removeMark(o.$from.pos,o.$to.pos)}),!0},unsetMark=(r,e={})=>({tr:t,state:n,dispatch:s})=>{var o;const{extendEmptyMarkRange:a=!1}=e,{selection:l}=t,u=getMarkType(r,n.schema),{$from:c,empty:d,ranges:f}=l;if(!s)return!0;if(d&&a){let{from:C,to:m}=l;const E=(o=c.marks().find(_=>_.type===u))===null||o===void 0?void 0:o.attrs,v=getMarkRange(c,u,E);v&&(C=v.from,m=v.to),t.removeMark(C,m,u)}else f.forEach(C=>{t.removeMark(C.$from.pos,C.$to.pos,u)});return t.removeStoredMark(u),!0},updateAttributes=(r,e={})=>({tr:t,state:n,dispatch:s})=>{let o=null,a=null;const l=getSchemaTypeNameByName(typeof r=="string"?r:r.name,n.schema);return l?(l==="node"&&(o=getNodeType(r,n.schema)),l==="mark"&&(a=getMarkType(r,n.schema)),s&&t.selection.ranges.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;let f,C,m,E;t.selection.empty?n.doc.nodesBetween(c,d,(v,_)=>{o&&o===v.type&&(m=Math.max(_,c),E=Math.min(_+v.nodeSize,d),f=_,C=v)}):n.doc.nodesBetween(c,d,(v,_)=>{_<c&&o&&o===v.type&&(m=Math.max(_,c),E=Math.min(_+v.nodeSize,d),f=_,C=v),_>=c&&_<=d&&(o&&o===v.type&&t.setNodeMarkup(_,void 0,{...v.attrs,...e}),a&&v.marks.length&&v.marks.forEach(T=>{if(a===T.type){const R=Math.max(_,c),O=Math.min(_+v.nodeSize,d);t.addMark(R,O,a.create({...T.attrs,...e}))}}))}),C&&(f!==void 0&&t.setNodeMarkup(f,void 0,{...C.attrs,...e}),a&&C.marks.length&&C.marks.forEach(v=>{a===v.type&&t.addMark(m,E,a.create({...v.attrs,...e}))}))}),!0):!1},wrapIn=(r,e={})=>({state:t,dispatch:n})=>{const s=getNodeType(r,t.schema);return wrapIn$1(s,e)(t,n)},wrapInList=(r,e={})=>({state:t,dispatch:n})=>{const s=getNodeType(r,t.schema);return wrapInList$1(s,e)(t,n)};var commands=Object.freeze({__proto__:null,blur,clearContent,clearNodes,command,createParagraphNear,cut,deleteCurrentNode,deleteNode,deleteRange,deleteSelection,enter,exitCode,extendMarkRange,first,focus,forEach,insertContent,insertContentAt,joinBackward,joinDown,joinForward,joinItemBackward,joinItemForward,joinTextblockBackward,joinTextblockForward,joinUp,keyboardShortcut,lift,liftEmptyBlock,liftListItem,newlineInCode,resetAttributes,scrollIntoView,selectAll,selectNodeBackward,selectNodeForward,selectParentNode,selectTextblockEnd,selectTextblockStart,setContent,setMark,setMeta,setNode,setNodeSelection,setTextSelection,sinkListItem,splitBlock,splitListItem,toggleList,toggleMark,toggleNode,toggleWrap,undoInputRule,unsetAllMarks,unsetMark,updateAttributes,wrapIn,wrapInList});const Commands=Extension.create({name:"commands",addCommands(){return{...commands}}}),Drop=Extension.create({name:"drop",addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("tiptapDrop"),props:{handleDrop:(r,e,t,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:n})}}})]}}),Editable=Extension.create({name:"editable",addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),FocusEvents=Extension.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new Plugin({key:new PluginKey("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;const n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;const n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),Keymap=Extension.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:l})=>{const{selection:u,doc:c}=l,{empty:d,$anchor:f}=u,{pos:C,parent:m}=f,E=f.parent.isTextblock&&C>0?l.doc.resolve(C-1):f,v=E.parent.type.spec.isolating,_=f.pos-f.parentOffset,T=v&&E.parent.childCount===1?_===f.pos:Selection.atStart(c).from===C;return!d||!m.type.isTextblock||m.textContent.length||!T||T&&f.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...n},o={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return isiOS()||isMacOS()?o:s},addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("clearDocument"),appendTransaction:(r,e,t)=>{const n=r.some(v=>v.docChanged)&&!e.doc.eq(t.doc),s=r.some(v=>v.getMeta("preventClearDocument"));if(!n||s)return;const{empty:o,from:a,to:l}=e.selection,u=Selection.atStart(e.doc).from,c=Selection.atEnd(e.doc).to;if(o||!(a===u&&l===c)||!isNodeEmpty(t.doc))return;const C=t.tr,m=createChainableState({state:t,transaction:C}),{commands:E}=new CommandManager({editor:this.editor,state:m});if(E.clearNodes(),!!C.steps.length)return C}})]}}),Paste=Extension.create({name:"paste",addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("tiptapPaste"),props:{handlePaste:(r,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),Tabindex=Extension.create({name:"tabindex",addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class NodePos{get name(){return this.node.type.name}constructor(e,t,n=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new NodePos(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new NodePos(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new NodePos(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,n)=>{const s=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,a=this.pos+n+(o?0:1),l=this.resolvedPos.doc.resolve(a);if(!s&&l.depth<=this.depth)return;const u=new NodePos(l,this.editor,s,s?t:null);s&&(u.actualDepth=this.depth+1),e.push(new NodePos(l,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,s=this.parent;for(;s&&!n;){if(s.node.type.name===e)if(Object.keys(t).length>0){const o=s.node.attrs,a=Object.keys(t);for(let l=0;l<a.length;l+=1){const u=a[l];if(o[u]!==t[u])break}}else n=s;s=s.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(t);return this.children.forEach(a=>{n&&s.length>0||(a.node.type.name===e&&o.every(u=>t[u]===a.node.attrs[u])&&s.push(a),!(n&&s.length>0)&&(s=s.concat(a.querySelectorAll(e,t,n))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const style=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function createStyleTag(r,e,t){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(s),s}class Editor extends EventEmitter{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:n,moved:s})=>this.options.onDrop(t,n,s)),this.on("paste",({event:t,slice:n})=>this.options.onPaste(t,n)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=createStyleTag(style,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=isFunction(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:n});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(o=>{const a=typeof o=="string"?`${o}$`:o.key;n=t.filter(l=>!l.key.startsWith(a))}),t.length===n.length)return;const s=this.state.reconfigure({plugins:n});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[Editable,ClipboardTextSerializer.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),Commands,FocusEvents,Keymap,Tabindex,Drop,Paste].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new ExtensionManager(s,this)}createCommandManager(){this.commandManager=new CommandManager({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=createDocument(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(a){if(!(a instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(a.message))throw a;this.emit("contentError",{editor:this,error:a,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),t=createDocument(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=resolveFocusPosition(t,this.options.autofocus);this.view=new EditorView(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:EditorState.create({doc:t,selection:n||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(a=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(a)});return}const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),o=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return getAttributes(this.state,e)}isActive(e,t){const n=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return isActive(this.state,n,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return getHTMLFromFragment(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:n={}}=e||{};return getText(this.state.doc,{blockSeparator:t,textSerializers:{...getTextSerializersFromSchema(this.schema),...n}})}get isEmpty(){return isNodeEmpty(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new NodePos(t,this)}get $doc(){return this.$pos(0)}}function markInputRule(r){return new InputRule({find:r.find,handler:({state:e,range:t,match:n})=>{const s=callOrReturn(r.getAttributes,void 0,n);if(s===!1||s===null)return null;const{tr:o}=e,a=n[n.length-1],l=n[0];if(a){const u=l.search(/\S/),c=t.from+l.indexOf(a),d=c+a.length;if(getMarksBetween(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===r.type&&v!==m.mark.type)).filter(m=>m.to>c).length)return null;d<t.to&&o.delete(d,t.to),c>t.from&&o.delete(t.from+u,c);const C=t.from+u+a.length;o.addMark(t.from+u,C,r.type.create(s||{})),o.removeStoredMark(r.type)}}})}function nodeInputRule(r){return new InputRule({find:r.find,handler:({state:e,range:t,match:n})=>{const s=callOrReturn(r.getAttributes,void 0,n)||{},{tr:o}=e,a=t.from;let l=t.to;const u=r.type.create(s);if(n[1]){const c=n[0].lastIndexOf(n[1]);let d=a+c;d>l?d=l:l=d+n[1].length;const f=n[0][n[0].length-1];o.insertText(f,a+n[0].length-1),o.replaceWith(d,l,u)}else if(n[0]){const c=r.type.isInline?a:a-1;o.insert(c,r.type.create(s)).delete(o.mapping.map(a),o.mapping.map(l))}o.scrollIntoView()}})}function textblockTypeInputRule(r){return new InputRule({find:r.find,handler:({state:e,range:t,match:n})=>{const s=e.doc.resolve(t.from),o=callOrReturn(r.getAttributes,void 0,n)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),r.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,r.type,o)}})}function wrappingInputRule(r){return new InputRule({find:r.find,handler:({state:e,range:t,match:n,chain:s})=>{const o=callOrReturn(r.getAttributes,void 0,n)||{},a=e.tr.delete(t.from,t.to),u=a.doc.resolve(t.from).blockRange(),c=u&&findWrapping(u,r.type,o);if(!c)return null;if(a.wrap(u,c),r.keepMarks&&r.editor){const{selection:f,storedMarks:C}=e,{splittableMarks:m}=r.editor.extensionManager,E=C||f.$to.parentOffset&&f.$from.marks();if(E){const v=E.filter(_=>m.includes(_.type.name));a.ensureMarks(v)}}if(r.keepAttributes){const f=r.type.name==="bulletList"||r.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(f,o).run()}const d=a.doc.resolve(t.from-1).nodeBefore;d&&d.type===r.type&&canJoin(a.doc,t.from-1)&&(!r.joinPredicate||r.joinPredicate(n,d))&&a.join(t.from-1)}})}let Node$1=class Il{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Il(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>mergeDeep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Il(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=callOrReturn(getExtensionField(t,"addOptions",{name:t.name})),t.storage=callOrReturn(getExtensionField(t,"addStorage",{name:t.name,options:t.options})),t}};function markPasteRule(r){return new PasteRule({find:r.find,handler:({state:e,range:t,match:n,pasteEvent:s})=>{const o=callOrReturn(r.getAttributes,void 0,n,s);if(o===!1||o===null)return null;const{tr:a}=e,l=n[n.length-1],u=n[0];let c=t.to;if(l){const d=u.search(/\S/),f=t.from+u.indexOf(l),C=f+l.length;if(getMarksBetween(t.from,t.to,e.doc).filter(E=>E.mark.type.excluded.find(_=>_===r.type&&_!==E.mark.type)).filter(E=>E.to>f).length)return null;C<t.to&&a.delete(C,t.to),f>t.from&&a.delete(t.from+d,f),c=t.from+d+l.length,a.addMark(t.from+d,c,r.type.create(o||{})),a.removeStoredMark(r.type)}}})}const ListItem=Node$1.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:r}){return["li",mergeAttributes(this.options.HTMLAttributes,r),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),mergeNestedSpanStyles=r=>{if(!r.children.length)return;const e=r.querySelectorAll("span");e&&e.forEach(t=>{var n,s;const o=t.getAttribute("style"),a=(s=(n=t.parentElement)===null||n===void 0?void 0:n.closest("span"))===null||s===void 0?void 0:s.getAttribute("style");t.setAttribute("style",`${a};${o}`)})},TextStyle=Mark.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:r=>r.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&mergeNestedSpanStyles(r),{}):!1}]},renderHTML({HTMLAttributes:r}){return["span",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:r})=>{const{selection:e}=r;return r.doc.nodesBetween(e.from,e.to,(t,n)=>{if(t.isTextblock)return!0;t.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(o=>!!o))||r.removeMark(n,n+t.nodeSize,this.type)}),!0}}}});function getDefaultExportFromCjs(r){return r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var shim={exports:{}},useSyncExternalStoreShim_production_min={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production_min;function requireUseSyncExternalStoreShim_production_min(){if(hasRequiredUseSyncExternalStoreShim_production_min)return useSyncExternalStoreShim_production_min;hasRequiredUseSyncExternalStoreShim_production_min=1;var r=React;function e(f,C){return f===C&&(f!==0||1/f===1/C)||f!==f&&C!==C}var t=typeof Object.is=="function"?Object.is:e,n=r.useState,s=r.useEffect,o=r.useLayoutEffect,a=r.useDebugValue;function l(f,C){var m=C(),E=n({inst:{value:m,getSnapshot:C}}),v=E[0].inst,_=E[1];return o(function(){v.value=m,v.getSnapshot=C,u(v)&&_({inst:v})},[f,m,C]),s(function(){return u(v)&&_({inst:v}),f(function(){u(v)&&_({inst:v})})},[f]),a(m),m}function u(f){var C=f.getSnapshot;f=f.value;try{var m=C();return!t(f,m)}catch{return!0}}function c(f,C){return C()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return useSyncExternalStoreShim_production_min.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:d,useSyncExternalStoreShim_production_min}shim.exports=requireUseSyncExternalStoreShim_production_min();var shimExports=shim.exports;const mergeRefs=(...r)=>e=>{r.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},Portals=({contentComponent:r})=>{const e=shimExports.useSyncExternalStore(r.subscribe,r.getSnapshot,r.getServerSnapshot);return React.createElement(React.Fragment,null,Object.values(e))};function getInstance(){const r=new Set;let e={};return{subscribe(t){return r.add(t),()=>{r.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,n){e={...e,[t]:ReactDOM.createPortal(n.reactElement,n.element,t)},r.forEach(s=>s())},removeRenderer(t){const n={...e};delete n[t],e=n,r.forEach(s=>s())}}}class PureEditorContent extends React.Component{constructor(e){var t;super(e),this.editorContentRef=React.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=getInstance(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...n}=this.props;return React.createElement(React.Fragment,null,React.createElement("div",{ref:mergeRefs(t,this.editorContentRef),...n}),(e==null?void 0:e.contentComponent)&&React.createElement(Portals,{contentComponent:e.contentComponent}))}}const EditorContentWithKey=reactExports.forwardRef((r,e)=>{const t=React.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[r.editor]);return React.createElement(PureEditorContent,{key:t,innerRef:e,...r})}),EditorContent=React.memo(EditorContentWithKey);var react=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(s=n;s--!==0;)if(!r(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!r(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(s=n;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[s]))return!1;for(s=n;s--!==0;){var a=o[s];if(!(a==="_owner"&&e.$$typeof)&&!r(e[a],t[a]))return!1}return!0}return e!==e&&t!==t},deepEqual=getDefaultExportFromCjs(react),withSelector={exports:{}},withSelector_production_min={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production_min;function requireWithSelector_production_min(){if(hasRequiredWithSelector_production_min)return withSelector_production_min;hasRequiredWithSelector_production_min=1;var r=React,e=shimExports;function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,o=r.useRef,a=r.useEffect,l=r.useMemo,u=r.useDebugValue;return withSelector_production_min.useSyncExternalStoreWithSelector=function(c,d,f,C,m){var E=o(null);if(E.current===null){var v={hasValue:!1,value:null};E.current=v}else v=E.current;E=l(function(){function T(D){if(!R){if(R=!0,O=D,D=C(D),m!==void 0&&v.hasValue){var k=v.value;if(m(k,D))return N=k}return N=D}if(k=N,n(O,D))return k;var z=C(D);return m!==void 0&&m(k,z)?k:(O=D,N=z)}var R=!1,O,N,G=f===void 0?null:f;return[function(){return T(d())},G===null?void 0:function(){return T(G())}]},[d,f,C,m]);var _=s(c,E[0],E[1]);return a(function(){v.hasValue=!0,v.value=_},[_]),u(_),_},withSelector_production_min}withSelector.exports=requireWithSelector_production_min();var withSelectorExports=withSelector.exports;const useIsomorphicLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;class EditorStateManager{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},n=this.editor;return n.on("transaction",t),()=>{n.off("transaction",t)}}}}function useEditorState(r){var e;const[t]=reactExports.useState(()=>new EditorStateManager(r.editor)),n=withSelectorExports.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,r.selector,(e=r.equalityFn)!==null&&e!==void 0?e:deepEqual);return useIsomorphicLayoutEffect(()=>t.watch(r.editor),[r.editor,t]),reactExports.useDebugValue(n),n}const isDev=!1,isSSR=typeof window>"u",isNext=isSSR||!!(typeof window<"u"&&window.next);class EditorInstanceManager{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?isSSR||isNext?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var s,o;return(o=(s=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(s,...n)},onBlur:(...n)=>{var s,o;return(o=(s=this.options.current).onBlur)===null||o===void 0?void 0:o.call(s,...n)},onCreate:(...n)=>{var s,o;return(o=(s=this.options.current).onCreate)===null||o===void 0?void 0:o.call(s,...n)},onDestroy:(...n)=>{var s,o;return(o=(s=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(s,...n)},onFocus:(...n)=>{var s,o;return(o=(s=this.options.current).onFocus)===null||o===void 0?void 0:o.call(s,...n)},onSelectionUpdate:(...n)=>{var s,o;return(o=(s=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(s,...n)},onTransaction:(...n)=>{var s,o;return(o=(s=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(s,...n)},onUpdate:(...n)=>{var s,o;return(o=(s=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(s,...n)},onContentError:(...n)=>{var s,o;return(o=(s=this.options.current).onContentError)===null||o===void 0?void 0:o.call(s,...n)},onDrop:(...n)=>{var s,o;return(o=(s=this.options.current).onDrop)===null||o===void 0?void 0:o.call(s,...n)},onPaste:(...n)=>{var s,o;return(o=(s=this.options.current).onPaste)===null||o===void 0?void 0:o.call(s,...n)}};return new Editor(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,s)=>n===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function useEditor(r={},e=[]){const t=reactExports.useRef(r);t.current=r;const[n]=reactExports.useState(()=>new EditorInstanceManager(t)),s=shimExports.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return reactExports.useDebugValue(s),reactExports.useEffect(n.onRender(e)),useEditorState({editor:s,selector:({transactionNumber:o})=>r.shouldRerenderOnTransaction===!1?null:r.immediatelyRender&&o===0?0:o+1}),s}const EditorContext=reactExports.createContext({editor:null}),EditorConsumer=EditorContext.Consumer,useCurrentEditor=()=>reactExports.useContext(EditorContext);function EditorProvider({children:r,slotAfter:e,slotBefore:t,editorContainerProps:n={},...s}){const o=useEditor(s);return o?React.createElement(EditorContext.Provider,{value:{editor:o}},t,React.createElement(EditorConsumer,null,({editor:a})=>React.createElement(EditorContent,{editor:a,...n})),r,e):null}const ReactNodeViewContext=reactExports.createContext({onDragStart:void 0}),useReactNodeView=()=>reactExports.useContext(ReactNodeViewContext);React.forwardRef((r,e)=>{const{onDragStart:t}=useReactNodeView(),n=r.as||"div";return React.createElement(n,{...r,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...r.style}})});const inputRegex$4=/^\s*>\s$/,Blockquote=Node$1.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:r}){return["blockquote",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setBlockquote:()=>({commands:r})=>r.wrapIn(this.name),toggleBlockquote:()=>({commands:r})=>r.toggleWrap(this.name),unsetBlockquote:()=>({commands:r})=>r.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[wrappingInputRule({find:inputRegex$4,type:this.type})]}}),starInputRegex$1=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,starPasteRegex$1=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,underscoreInputRegex$1=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,underscorePasteRegex$1=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Bold=Mark.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:r=>r.type.name===this.name},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}]},renderHTML({HTMLAttributes:r}){return["strong",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setBold:()=>({commands:r})=>r.setMark(this.name),toggleBold:()=>({commands:r})=>r.toggleMark(this.name),unsetBold:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[markInputRule({find:starInputRegex$1,type:this.type}),markInputRule({find:underscoreInputRegex$1,type:this.type})]},addPasteRules(){return[markPasteRule({find:starPasteRegex$1,type:this.type}),markPasteRule({find:underscorePasteRegex$1,type:this.type})]}}),ListItemName$1="listItem",TextStyleName$1="textStyle",inputRegex$3=/^\s*([-+*])\s$/,BulletList=Node$1.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:r}){return["ul",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleBulletList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ListItemName$1,this.editor.getAttributes(TextStyleName$1)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let r=wrappingInputRule({find:inputRegex$3,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(r=wrappingInputRule({find:inputRegex$3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(TextStyleName$1),editor:this.editor})),[r]}}),inputRegex$2=/(^|[^`])`([^`]+)`(?!`)/,pasteRegex$1=/(^|[^`])`([^`]+)`(?!`)/g,Code=Mark.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:r}){return["code",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setCode:()=>({commands:r})=>r.setMark(this.name),toggleCode:()=>({commands:r})=>r.toggleMark(this.name),unsetCode:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[markInputRule({find:inputRegex$2,type:this.type})]},addPasteRules(){return[markPasteRule({find:pasteRegex$1,type:this.type})]}}),backtickInputRegex=/^```([a-z]+)?[\s\n]$/,tildeInputRegex=/^~~~([a-z]+)?[\s\n]$/,CodeBlock=Node$1.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:r=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=r.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(a=>a.startsWith(t)).map(a=>a.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:r,HTMLAttributes:e}){return["pre",mergeAttributes(this.options.HTMLAttributes,e),["code",{class:r.attrs.language?this.options.languageClassPrefix+r.attrs.language:null},0]]},addCommands(){return{setCodeBlock:r=>({commands:e})=>e.setNode(this.name,r),toggleCodeBlock:r=>({commands:e})=>e.toggleNode(this.name,"paragraph",r)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:r,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!r||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:r})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=r,{selection:t}=e,{$from:n,empty:s}=t;if(!s||n.parent.type!==this.type)return!1;const o=n.parentOffset===n.parent.nodeSize-2,a=n.parent.textContent.endsWith(`

`);return!o||!a?!1:r.chain().command(({tr:l})=>(l.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:r})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=r,{selection:t,doc:n}=e,{$from:s,empty:o}=t;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:n.nodeAt(l)?r.commands.command(({tr:c})=>(c.setSelection(Selection.near(n.resolve(l))),!0)):r.commands.exitCode()}}},addInputRules(){return[textblockTypeInputRule({find:backtickInputRegex,type:this.type,getAttributes:r=>({language:r[1]})}),textblockTypeInputRule({find:tildeInputRegex,type:this.type,getAttributes:r=>({language:r[1]})})]},addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:(r,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),s=n?JSON.parse(n):void 0,o=s==null?void 0:s.mode;if(!t||!o)return!1;const{tr:a,schema:l}=r.state,u=l.text(t.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:o},u)),a.selection.$from.parent.type!==this.type&&a.setSelection(TextSelection.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),r.dispatch(a),!0}}})]}}),Document=Node$1.create({name:"doc",topNode:!0,content:"block+"});function dropCursor(r={}){return new Plugin({view(e){return new DropCursorView(e,r)}})}class DropCursorView{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=t.width)!==null&&n!==void 0?n:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let o=a=>{this[s](a)};return e.dom.addEventListener(s,o),{name:s,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,n;if(t){let l=e.nodeBefore,u=e.nodeAfter;if(l||u){let c=this.editorView.nodeDOM(this.cursorPos-(l?l.nodeSize:0));if(c){let d=c.getBoundingClientRect(),f=l?d.bottom:d.top;l&&u&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:d.left,right:d.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!n){let l=this.editorView.coordsAtPos(this.cursorPos);n={left:l.left-this.width/2,right:l.left+this.width/2,top:l.top,bottom:l.bottom}}let s=this.editorView.dom.offsetParent;this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let o,a;if(!s||s==document.body&&getComputedStyle(s).position=="static")o=-pageXOffset,a=-pageYOffset;else{let l=s.getBoundingClientRect();o=l.left-s.scrollLeft,a=l.top-s.scrollTop}this.element.style.left=n.left-o+"px",this.element.style.top=n.top-a+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=n&&n.type.spec.disableDropCursor,o=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!o){let a=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=dropPoint(this.editorView.state.doc,a,this.editorView.dragging.slice);l!=null&&(a=l)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Dropcursor=Extension.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[dropCursor(this.options)]}});class GapCursor extends Selection{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return GapCursor.valid(n)?new GapCursor(n):Selection.near(n)}content(){return Slice.empty}eq(e){return e instanceof GapCursor&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new GapCursor(e.resolve(t.pos))}getBookmark(){return new GapBookmark(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!closedBefore(e)||!closedAfter(e))return!1;let n=t.type.spec.allowGapCursor;if(n!=null)return n;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&GapCursor.valid(e))return e;let s=e.pos,o=null;for(let a=e.depth;;a--){let l=e.node(a);if(t>0?e.indexAfter(a)<l.childCount:e.index(a)>0){o=l.child(t>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;s+=t;let u=e.doc.resolve(s);if(GapCursor.valid(u))return u}for(;;){let a=t>0?o.firstChild:o.lastChild;if(!a){if(o.isAtom&&!o.isText&&!NodeSelection.isSelectable(o)){e=e.doc.resolve(s+o.nodeSize*t),n=!1;continue e}break}o=a,s+=t;let l=e.doc.resolve(s);if(GapCursor.valid(l))return l}return null}}}GapCursor.prototype.visible=!1;GapCursor.findFrom=GapCursor.findGapCursorFrom;Selection.jsonID("gapcursor",GapCursor);class GapBookmark{constructor(e){this.pos=e}map(e){return new GapBookmark(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return GapCursor.valid(t)?new GapCursor(t):Selection.near(t)}}function closedBefore(r){for(let e=r.depth;e>=0;e--){let t=r.index(e),n=r.node(e);if(t==0){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function closedAfter(r){for(let e=r.depth;e>=0;e--){let t=r.indexAfter(e),n=r.node(e);if(t==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function gapCursor(){return new Plugin({props:{decorations:drawGapCursor,createSelectionBetween(r,e,t){return e.pos==t.pos&&GapCursor.valid(t)?new GapCursor(t):null},handleClick,handleKeyDown,handleDOMEvents:{beforeinput}}})}const handleKeyDown=keydownHandler({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1)});function arrow(r,e){const t=r=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,s,o){let a=n.selection,l=e>0?a.$to:a.$from,u=a.empty;if(a instanceof TextSelection){if(!o.endOfTextblock(t)||l.depth==0)return!1;u=!1,l=n.doc.resolve(e>0?l.after():l.before())}let c=GapCursor.findGapCursorFrom(l,e,u);return c?(s&&s(n.tr.setSelection(new GapCursor(c))),!0):!1}}function handleClick(r,e,t){if(!r||!r.editable)return!1;let n=r.state.doc.resolve(e);if(!GapCursor.valid(n))return!1;let s=r.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&NodeSelection.isSelectable(r.state.doc.nodeAt(s.inside))?!1:(r.dispatch(r.state.tr.setSelection(new GapCursor(n))),!0)}function beforeinput(r,e){if(e.inputType!="insertCompositionText"||!(r.state.selection instanceof GapCursor))return!1;let{$from:t}=r.state.selection,n=t.parent.contentMatchAt(t.index()).findWrapping(r.state.schema.nodes.text);if(!n)return!1;let s=Fragment.empty;for(let a=n.length-1;a>=0;a--)s=Fragment.from(n[a].createAndFill(null,s));let o=r.state.tr.replace(t.pos,t.pos,new Slice(s,0,0));return o.setSelection(TextSelection.near(o.doc.resolve(t.pos+1))),r.dispatch(o),!1}function drawGapCursor(r){if(!(r.selection instanceof GapCursor))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",DecorationSet.create(r.doc,[Decoration.widget(r.selection.head,e,{key:"gapcursor"})])}const Gapcursor=Extension.create({name:"gapCursor",addProseMirrorPlugins(){return[gapCursor()]},extendNodeSchema(r){var e;const t={name:r.name,options:r.options,storage:r.storage};return{allowGapCursor:(e=callOrReturn(getExtensionField(r,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),HardBreak=Node$1.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:r}){return["br",mergeAttributes(this.options.HTMLAttributes,r)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:r,chain:e,state:t,editor:n})=>r.first([()=>r.exitCode(),()=>r.command(()=>{const{selection:s,storedMarks:o}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:l}=n.extensionManager,u=o||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&u&&a){const f=u.filter(C=>l.includes(C.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Heading=Node$1.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(r=>({tag:`h${r}`,attrs:{level:r}}))},renderHTML({node:r,HTMLAttributes:e}){return[`h${this.options.levels.includes(r.attrs.level)?r.attrs.level:this.options.levels[0]}`,mergeAttributes(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.setNode(this.name,r):!1,toggleHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.toggleNode(this.name,"paragraph",r):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((r,e)=>({...r,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(r=>textblockTypeInputRule({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${r}})\\s$`),type:this.type,getAttributes:{level:r}}))}});var GOOD_LEAF_SIZE=200,RopeSequence=function r(){};RopeSequence.prototype.append=function r(e){return e.length?(e=RopeSequence.from(e),!this.length&&e||e.length<GOOD_LEAF_SIZE&&this.leafAppend(e)||this.length<GOOD_LEAF_SIZE&&e.leafPrepend(this)||this.appendInner(e)):this};RopeSequence.prototype.prepend=function r(e){return e.length?RopeSequence.from(e).append(this):this};RopeSequence.prototype.appendInner=function r(e){return new Append(this,e)};RopeSequence.prototype.slice=function r(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?RopeSequence.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};RopeSequence.prototype.get=function r(e){if(!(e<0||e>=this.length))return this.getInner(e)};RopeSequence.prototype.forEach=function r(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)};RopeSequence.prototype.map=function r(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var s=[];return this.forEach(function(o,a){return s.push(e(o,a))},t,n),s};RopeSequence.from=function r(e){return e instanceof RopeSequence?e:e&&e.length?new Leaf(e):RopeSequence.empty};var Leaf=function(r){function e(n){r.call(this),this.values=n}e.__proto__=r,e.prototype=Object.create(r.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,o){return s==0&&o==this.length?this:new e(this.values.slice(s,o))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,o,a,l){for(var u=o;u<a;u++)if(s(this.values[u],l+u)===!1)return!1},e.prototype.forEachInvertedInner=function(s,o,a,l){for(var u=o-1;u>=a;u--)if(s(this.values[u],l+u)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=GOOD_LEAF_SIZE)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=GOOD_LEAF_SIZE)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(RopeSequence);RopeSequence.empty=new Leaf([]);var Append=function(r){function e(t,n){r.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e.__proto__=r,e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,s,o,a){var l=this.left.length;if(s<l&&this.left.forEachInner(n,s,Math.min(o,l),a)===!1||o>l&&this.right.forEachInner(n,Math.max(s-l,0),Math.min(this.length,o)-l,a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(n,s,o,a){var l=this.left.length;if(s>l&&this.right.forEachInvertedInner(n,s-l,Math.max(o,l)-l,a+l)===!1||o<l&&this.left.forEachInvertedInner(n,Math.min(s,l),o,a)===!1)return!1},e.prototype.sliceInner=function(n,s){if(n==0&&s==this.length)return this;var o=this.left.length;return s<=o?this.left.slice(n,s):n>=o?this.right.slice(n-o,s-o):this.left.slice(n,o).append(this.right.slice(0,s-o))},e.prototype.leafAppend=function(n){var s=this.right.leafAppend(n);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(n){var s=this.left.leafPrepend(n);if(s)return new e(s,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(RopeSequence);const max_empty_items=500;class Branch{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let s,o;t&&(s=this.remapping(n,this.items.length),o=s.maps.length);let a=e.tr,l,u,c=[],d=[];return this.items.forEach((f,C)=>{if(!f.step){s||(s=this.remapping(n,C+1),o=s.maps.length),o--,d.push(f);return}if(s){d.push(new Item(f.map));let m=f.step.map(s.slice(o)),E;m&&a.maybeStep(m).doc&&(E=a.mapping.maps[a.mapping.maps.length-1],c.push(new Item(E,void 0,void 0,c.length+d.length))),o--,E&&s.appendMap(E,o)}else a.maybeStep(f.step);if(f.selection)return l=s?f.selection.map(s.slice(o)):f.selection,u=new Branch(this.items.slice(0,n).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:a,selection:l}}addTransform(e,t,n,s){let o=[],a=this.eventCount,l=this.items,u=!s&&l.length?l.get(l.length-1):null;for(let d=0;d<e.steps.length;d++){let f=e.steps[d].invert(e.docs[d]),C=new Item(e.mapping.maps[d],f,t),m;(m=u&&u.merge(C))&&(C=m,d?o.pop():l=l.slice(0,l.length-1)),o.push(C),t&&(a++,t=void 0),s||(u=C)}let c=a-n.depth;return c>DEPTH_OVERFLOW&&(l=cutOffEvents(l,c),a-=c),new Branch(l.append(o),a)}remapping(e,t){let n=new Mapping;return this.items.forEach((s,o)=>{let a=s.mirrorOffset!=null&&o-s.mirrorOffset>=e?n.maps.length-s.mirrorOffset:void 0;n.appendMap(s.map,a)},e,t),n}addMaps(e){return this.eventCount==0?this:new Branch(this.items.append(e.map(t=>new Item(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],s=Math.max(0,this.items.length-t),o=e.mapping,a=e.steps.length,l=this.eventCount;this.items.forEach(C=>{C.selection&&l--},s);let u=t;this.items.forEach(C=>{let m=o.getMirror(--u);if(m==null)return;a=Math.min(a,m);let E=o.maps[m];if(C.step){let v=e.steps[m].invert(e.docs[m]),_=C.selection&&C.selection.map(o.slice(u+1,m));_&&l++,n.push(new Item(E,v,_))}else n.push(new Item(E))},s);let c=[];for(let C=t;C<a;C++)c.push(new Item(o.maps[C]));let d=this.items.slice(0,s).append(c).append(n),f=new Branch(d,l);return f.emptyItemCount()>max_empty_items&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,s=[],o=0;return this.items.forEach((a,l)=>{if(l>=e)s.push(a),a.selection&&o++;else if(a.step){let u=a.step.map(t.slice(n)),c=u&&u.getMap();if(n--,c&&t.appendMap(c,n),u){let d=a.selection&&a.selection.map(t.slice(n));d&&o++;let f=new Item(c.invert(),u,d),C,m=s.length-1;(C=s.length&&s[m].merge(f))?s[m]=C:s.push(f)}}else a.map&&n--},this.items.length,0),new Branch(RopeSequence.from(s.reverse()),o)}}Branch.empty=new Branch(RopeSequence.empty,0);function cutOffEvents(r,e){let t;return r.forEach((n,s)=>{if(n.selection&&e--==0)return t=s,!1}),r.slice(t)}class Item{constructor(e,t,n,s){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Item(t.getMap().invert(),t,this.selection)}}}class HistoryState{constructor(e,t,n,s,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=s,this.prevComposition=o}}const DEPTH_OVERFLOW=20;function applyTransaction(r,e,t,n){let s=t.getMeta(historyKey),o;if(s)return s.historyState;t.getMeta(closeHistoryKey)&&(r=new HistoryState(r.done,r.undone,null,0,-1));let a=t.getMeta("appendedTransaction");if(t.steps.length==0)return r;if(a&&a.getMeta(historyKey))return a.getMeta(historyKey).redo?new HistoryState(r.done.addTransform(t,void 0,n,mustPreserveItems(e)),r.undone,rangesFor(t.mapping.maps),r.prevTime,r.prevComposition):new HistoryState(r.done,r.undone.addTransform(t,void 0,n,mustPreserveItems(e)),null,r.prevTime,r.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let l=t.getMeta("composition"),u=r.prevTime==0||!a&&r.prevComposition!=l&&(r.prevTime<(t.time||0)-n.newGroupDelay||!isAdjacentTo(t,r.prevRanges)),c=a?mapRanges(r.prevRanges,t.mapping):rangesFor(t.mapping.maps);return new HistoryState(r.done.addTransform(t,u?e.selection.getBookmark():void 0,n,mustPreserveItems(e)),Branch.empty,c,t.time,l??r.prevComposition)}else return(o=t.getMeta("rebased"))?new HistoryState(r.done.rebased(t,o),r.undone.rebased(t,o),mapRanges(r.prevRanges,t.mapping),r.prevTime,r.prevComposition):new HistoryState(r.done.addMaps(t.mapping.maps),r.undone.addMaps(t.mapping.maps),mapRanges(r.prevRanges,t.mapping),r.prevTime,r.prevComposition)}function isAdjacentTo(r,e){if(!e)return!1;if(!r.docChanged)return!0;let t=!1;return r.mapping.maps[0].forEach((n,s)=>{for(let o=0;o<e.length;o+=2)n<=e[o+1]&&s>=e[o]&&(t=!0)}),t}function rangesFor(r){let e=[];for(let t=r.length-1;t>=0&&e.length==0;t--)r[t].forEach((n,s,o,a)=>e.push(o,a));return e}function mapRanges(r,e){if(!r)return null;let t=[];for(let n=0;n<r.length;n+=2){let s=e.map(r[n],1),o=e.map(r[n+1],-1);s<=o&&t.push(s,o)}return t}function histTransaction(r,e,t){let n=mustPreserveItems(e),s=historyKey.get(e).spec.config,o=(t?r.undone:r.done).popEvent(e,n);if(!o)return null;let a=o.selection.resolve(o.transform.doc),l=(t?r.done:r.undone).addTransform(o.transform,e.selection.getBookmark(),s,n),u=new HistoryState(t?l:o.remaining,t?o.remaining:l,null,0,-1);return o.transform.setSelection(a).setMeta(historyKey,{redo:t,historyState:u})}let cachedPreserveItems=!1,cachedPreserveItemsPlugins=null;function mustPreserveItems(r){let e=r.plugins;if(cachedPreserveItemsPlugins!=e){cachedPreserveItems=!1,cachedPreserveItemsPlugins=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){cachedPreserveItems=!0;break}}return cachedPreserveItems}const historyKey=new PluginKey("history"),closeHistoryKey=new PluginKey("closeHistory");function history(r={}){return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new Plugin({key:historyKey,state:{init(){return new HistoryState(Branch.empty,Branch.empty,null,0,-1)},apply(e,t,n){return applyTransaction(t,n,e,r)}},config:r,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,s=n=="historyUndo"?undo:n=="historyRedo"?redo:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function buildCommand(r,e){return(t,n)=>{let s=historyKey.getState(t);if(!s||(r?s.undone:s.done).eventCount==0)return!1;if(n){let o=histTransaction(s,t,r);o&&n(e?o.scrollIntoView():o)}return!0}}const undo=buildCommand(!1,!0),redo=buildCommand(!0,!0),History=Extension.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:r,dispatch:e})=>undo(r,e),redo:()=>({state:r,dispatch:e})=>redo(r,e)}},addProseMirrorPlugins(){return[history(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),HorizontalRule=Node$1.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:r}){return["hr",mergeAttributes(this.options.HTMLAttributes,r)]},addCommands(){return{setHorizontalRule:()=>({chain:r,state:e})=>{const{selection:t}=e,{$from:n,$to:s}=t,o=r();return n.parentOffset===0?o.insertContentAt({from:Math.max(n.pos-1,0),to:s.pos},{type:this.name}):isNodeSelection(t)?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:a,dispatch:l})=>{var u;if(l){const{$to:c}=a.selection,d=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?a.setSelection(TextSelection.create(a.doc,c.pos+1)):c.nodeAfter.isBlock?a.setSelection(NodeSelection.create(a.doc,c.pos)):a.setSelection(TextSelection.create(a.doc,c.pos));else{const f=(u=c.parent.type.contentMatch.defaultType)===null||u===void 0?void 0:u.create();f&&(a.insert(d,f),a.setSelection(TextSelection.create(a.doc,d+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[nodeInputRule({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),starInputRegex=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,starPasteRegex=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,underscoreInputRegex=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,underscorePasteRegex=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Italic=Mark.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:r=>r.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:r=>r.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:r}){return["em",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setItalic:()=>({commands:r})=>r.setMark(this.name),toggleItalic:()=>({commands:r})=>r.toggleMark(this.name),unsetItalic:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[markInputRule({find:starInputRegex,type:this.type}),markInputRule({find:underscoreInputRegex,type:this.type})]},addPasteRules(){return[markPasteRule({find:starPasteRegex,type:this.type}),markPasteRule({find:underscorePasteRegex,type:this.type})]}}),ListItemName="listItem",TextStyleName="textStyle",inputRegex$1=/^(\d+)\.\s$/,OrderedList=Node$1.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:r=>r.hasAttribute("start")?parseInt(r.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:r=>r.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:r}){const{start:e,...t}=r;return e===1?["ol",mergeAttributes(this.options.HTMLAttributes,t),0]:["ol",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleOrderedList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ListItemName,this.editor.getAttributes(TextStyleName)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let r=wrappingInputRule({find:inputRegex$1,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(r=wrappingInputRule({find:inputRegex$1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(TextStyleName)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[r]}}),Paragraph=Node$1.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:r}){return["p",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setParagraph:()=>({commands:r})=>r.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),inputRegex=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,pasteRegex=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Strike=Mark.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["s",mergeAttributes(this.options.HTMLAttributes,r),0]},addCommands(){return{setStrike:()=>({commands:r})=>r.setMark(this.name),toggleStrike:()=>({commands:r})=>r.toggleMark(this.name),unsetStrike:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[markInputRule({find:inputRegex,type:this.type})]},addPasteRules(){return[markPasteRule({find:pasteRegex,type:this.type})]}}),Text=Node$1.create({name:"text",group:"inline"}),StarterKit=Extension.create({name:"starterKit",addExtensions(){var r,e,t,n,s,o,a,l,u,c,d,f,C,m,E,v,_,T;const R=[];return this.options.bold!==!1&&R.push(Bold.configure((r=this.options)===null||r===void 0?void 0:r.bold)),this.options.blockquote!==!1&&R.push(Blockquote.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&R.push(BulletList.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&R.push(Code.configure((n=this.options)===null||n===void 0?void 0:n.code)),this.options.codeBlock!==!1&&R.push(CodeBlock.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&R.push(Document.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&R.push(Dropcursor.configure((a=this.options)===null||a===void 0?void 0:a.dropcursor)),this.options.gapcursor!==!1&&R.push(Gapcursor.configure((l=this.options)===null||l===void 0?void 0:l.gapcursor)),this.options.hardBreak!==!1&&R.push(HardBreak.configure((u=this.options)===null||u===void 0?void 0:u.hardBreak)),this.options.heading!==!1&&R.push(Heading.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&R.push(History.configure((d=this.options)===null||d===void 0?void 0:d.history)),this.options.horizontalRule!==!1&&R.push(HorizontalRule.configure((f=this.options)===null||f===void 0?void 0:f.horizontalRule)),this.options.italic!==!1&&R.push(Italic.configure((C=this.options)===null||C===void 0?void 0:C.italic)),this.options.listItem!==!1&&R.push(ListItem.configure((m=this.options)===null||m===void 0?void 0:m.listItem)),this.options.orderedList!==!1&&R.push(OrderedList.configure((E=this.options)===null||E===void 0?void 0:E.orderedList)),this.options.paragraph!==!1&&R.push(Paragraph.configure((v=this.options)===null||v===void 0?void 0:v.paragraph)),this.options.strike!==!1&&R.push(Strike.configure((_=this.options)===null||_===void 0?void 0:_.strike)),this.options.text!==!1&&R.push(Text.configure((T=this.options)===null||T===void 0?void 0:T.text)),R}}),MenuBar=()=>{const{editor:r}=useCurrentEditor();return r?jsxRuntimeExports.jsx("div",{className:"control-group",children:jsxRuntimeExports.jsxs("div",{className:"button-group",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleBold().run(),disabled:!r.can().chain().focus().toggleBold().run(),className:r.isActive("bold")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_bold"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleItalic().run(),disabled:!r.can().chain().focus().toggleItalic().run(),className:r.isActive("italic")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_italic"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleStrike().run(),disabled:!r.can().chain().focus().toggleStrike().run(),className:r.isActive("strike")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"strikethrough_s"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().unsetAllMarks().run(),children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_clear"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().clearNodes().run(),children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"clear_all"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().setParagraph().run(),className:r.isActive("paragraph")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_paragraph"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:1}).run(),className:r.isActive("heading",{level:1})?"is-active":"",children:"H1"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:2}).run(),className:r.isActive("heading",{level:2})?"is-active":"",children:"H2"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:3}).run(),className:r.isActive("heading",{level:3})?"is-active":"",children:"H3"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:4}).run(),className:r.isActive("heading",{level:4})?"is-active":"",children:"H4"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:5}).run(),className:r.isActive("heading",{level:5})?"is-active":"",children:"H5"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleHeading({level:6}).run(),className:r.isActive("heading",{level:6})?"is-active":"",children:"H6"}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleBulletList().run(),className:r.isActive("bulletList")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_list_bulleted"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().toggleOrderedList().run(),className:r.isActive("orderedList")?"is-active":"",children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"format_list_numbered"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().setHardBreak().run(),children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"insert_page_break"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().undo().run(),disabled:!r.can().chain().focus().undo().run(),children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"undo"})}),jsxRuntimeExports.jsx("button",{onClick:()=>r.chain().focus().redo().run(),disabled:!r.can().chain().focus().redo().run(),children:jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",children:"redo"})})]})}):null},extensions=[TextStyle.configure({types:[ListItem.name]}),StarterKit.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}})],TiptapEditor=({content:r=""})=>jsxRuntimeExports.jsx(EditorProvider,{slotAfter:jsxRuntimeExports.jsx(MenuBar,{}),extensions,content:r,autofocus:"end"});registerAllModules();const data=[[" /","",""],["1"," ","100"],["2"," "," "],["3"," ","300"],["4","","???"],["5"," ","???"],["6","  ","???"],["7"," ","???"]],EditorComponent=()=>{const r=reactExports.useRef(null),{value:e,setValue:t,finishEditing:n}=useHotEditor({onOpen:()=>{r.current&&(r.current.style.display="block")},onClose:()=>{r.current&&(r.current.style.display="none")},onPrepare:(o,a,l,u,c,d)=>{const f=u.getBoundingClientRect();r.current&&(r.current.style.left=`${f.left+window.pageXOffset}px`,r.current.style.top=`${f.top+window.pageYOffset}px`)},onFocus:()=>{}}),s=o=>{o.stopPropagation()};return jsxRuntimeExports.jsx("div",{id:"editorElement",ref:r,style:{display:"none",position:"absolute",left:0,top:0,marginTop:"-4px",marginLeft:"-4px",background:"#fff",boxShadow:"0 0 7px 0px #d9d9d9",borderRadius:"10px",padding:"7px 12px",zIndex:999},onMouseDown:s,children:jsxRuntimeExports.jsx(TiptapEditor,{content:e},Math.random())})},RendererComponent=r=>r.value?r.value==="???"?jsxRuntimeExports.jsx(index,{content:jsxRuntimeExports.jsxs("div",{children:[" :  ",jsxRuntimeExports.jsx("br",{})," : ",jsxRuntimeExports.jsx("br",{})," : , "]}),children:jsxRuntimeExports.jsx("span",{style:{backgroundColor:"#fdd",padding:"0 6px",borderRadius:"5px"},children:r.value})}):r.value:null;function Handsontable(){return HyperFormula.buildEmpty({licenseKey:"internal-use-in-handsontable"}),jsxRuntimeExports.jsx("div",{className:"ht-theme-main-dark-auto",children:jsxRuntimeExports.jsx(HotTable,{data,rowHeaders:!0,colHeaders:!0,height:"auto",autoWrapRow:!0,autoWrapCol:!0,autoColumnSize:!1,autoRowSize:!1,licenseKey:"non-commercial-and-evaluation",contextMenu:!0,manualColumnResize:!0,renderer:RendererComponent,editor:EditorComponent,colWidths:[100,300,600]})})}const data3=[["","","","",""],[100,100,100,"=SUM(A2:C2)","=AVERAGE(A2:C2)"],[200,200,200,"=SUM(A3:C3)","=AVERAGE(A3:C3)"],[300,300,300,"=SUM(A4:C4)","=AVERAGE(A4:C4)"],["","","","=SUM(D2:D4)","=AVERAGE(E2:E4)"]];function Jspreadsheet(){const r=reactExports.useRef();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Spreadsheet,{ref:r,toolbar:!1,children:jsxRuntimeExports.jsx(Worksheet,{data:data3,minDimensions:[4,6],mergeCells:{A5:[3,1]},style:{A5:"font-weight: bold",D5:"font-weight: bold",E5:"font-weight: bold"},minSpareCols:1,minSpareRows:1,defaultColAlign:"left"})})})}const data2=[["","","","",""],[100,100,100,"=SUM(A2:C2)","=AVERAGE(A2:C2)"],[200,200,200,"=SUM(A3:C3)","=AVERAGE(A3:C3)"],[300,300,300,"=SUM(A4:C4)","=AVERAGE(A4:C4)"],["","","","=SUM(D2:D4)","=AVERAGE(E2:E4)"]];function Handsontable2(){const r=HyperFormula.buildEmpty({licenseKey:"internal-use-in-handsontable"});return _register$2("customStylesRenderer",(e,t,...n)=>{textRenderer(e,t,...n),t.style.fontWeight="bold"}),jsxRuntimeExports.jsx("div",{className:"ht-theme-main-dark-auto",children:jsxRuntimeExports.jsx(HotTable,{data:data2,mergeCells:[{row:4,col:0,colspan:3,rowspan:1}],rowHeaders:!0,colHeaders:!0,colWidths:150,autoRowSize:!0,autoColumnSize:!0,height:"auto",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:1,minSpareCols:1,formulas:{engine:r},contextMenu:!0,manualColumnResize:!0,cell:[{row:4,col:0,renderer:"customStylesRenderer"},{row:4,col:3,renderer:"customStylesRenderer"},{row:4,col:4,renderer:"customStylesRenderer"}]})})}function App(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{style:{marginBottom:0},children:jsxRuntimeExports.jsx("a",{href:"https://handsontable.com/",target:"_blank",children:"Handsontable"})}),jsxRuntimeExports.jsx("div",{children:"Free for non-commercial and evaluation"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"15px"},children:["    Excel, :",jsxRuntimeExports.jsx("br",{}),"-     / (   )",jsxRuntimeExports.jsx("br",{}),"-    / ,      Excel",jsxRuntimeExports.jsx("br",{}),"-   , ",jsxRuntimeExports.jsx("br",{}),"-  ",jsxRuntimeExports.jsx("br",{}),"-  ",jsxRuntimeExports.jsx("br",{}),"- ",jsxRuntimeExports.jsx("br",{}),"- "]}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("div",{style:{marginTop:"15px"},children:"    HTML"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(Handsontable,{}),jsxRuntimeExports.jsx("div",{style:{marginTop:"30px"},children:" ,  "}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(Handsontable2,{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("h2",{style:{marginBottom:0},children:jsxRuntimeExports.jsx("a",{href:"https://bossanova.uk/jspreadsheet/",target:"_blank",children:"Jspreadsheet"})}),jsxRuntimeExports.jsx("div",{children:"Free and open-source (MIT License)"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(Jspreadsheet,{}),jsxRuntimeExports.jsx("span",{className:"material-symbols-outlined",style:{userSelect:"none",opacity:"0"},children:"insert_page_break"})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}))});export default wd();
