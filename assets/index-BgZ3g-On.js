var gd=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var yd=gd((exports,module)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function v(B){return B===null||typeof B!="object"?null:(B=g&&B[g]||B["@@iterator"],typeof B=="function"?B:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,_={};function S(B,te,V){this.props=B,this.context=te,this.refs=_,this.updater=V||m}S.prototype.isReactComponent={},S.prototype.setState=function(B,te){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,te,"setState")},S.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function w(){}w.prototype=S.prototype;function A(B,te,V){this.props=B,this.context=te,this.refs=_,this.updater=V||m}var O=A.prototype=new w;O.constructor=A,E(O,S.prototype),O.isPureReactComponent=!0;var D=Array.isArray,Y=Object.prototype.hasOwnProperty,H={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function K(B,te,V){var ue,Ae={},Ve=null,He=null;if(te!=null)for(ue in te.ref!==void 0&&(He=te.ref),te.key!==void 0&&(Ve=""+te.key),te)Y.call(te,ue)&&!k.hasOwnProperty(ue)&&(Ae[ue]=te[ue]);var be=arguments.length-2;if(be===1)Ae.children=V;else if(1<be){for(var qe=Array(be),le=0;le<be;le++)qe[le]=arguments[le+2];Ae.children=qe}if(B&&B.defaultProps)for(ue in be=B.defaultProps,be)Ae[ue]===void 0&&(Ae[ue]=be[ue]);return{$$typeof:r,type:B,key:Ve,ref:He,props:Ae,_owner:H.current}}function se(B,te){return{$$typeof:r,type:B.type,key:te,ref:B.ref,props:B.props,_owner:B._owner}}function re(B){return typeof B=="object"&&B!==null&&B.$$typeof===r}function Ce(B){var te={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(V){return te[V]})}var Le=/\/+/g;function he(B,te){return typeof B=="object"&&B!==null&&B.key!=null?Ce(""+B.key):te.toString(36)}function ve(B,te,V,ue,Ae){var Ve=typeof B;(Ve==="undefined"||Ve==="boolean")&&(B=null);var He=!1;if(B===null)He=!0;else switch(Ve){case"string":case"number":He=!0;break;case"object":switch(B.$$typeof){case r:case e:He=!0}}if(He)return He=B,Ae=Ae(He),B=ue===""?"."+he(He,0):ue,D(Ae)?(V="",B!=null&&(V=B.replace(Le,"$&/")+"/"),ve(Ae,te,V,"",function(le){return le})):Ae!=null&&(re(Ae)&&(Ae=se(Ae,V+(!Ae.key||He&&He.key===Ae.key?"":(""+Ae.key).replace(Le,"$&/")+"/")+B)),te.push(Ae)),1;if(He=0,ue=ue===""?".":ue+":",D(B))for(var be=0;be<B.length;be++){Ve=B[be];var qe=ue+he(Ve,be);He+=ve(Ve,te,V,qe,Ae)}else if(qe=v(B),typeof qe=="function")for(B=qe.call(B),be=0;!(Ve=B.next()).done;)Ve=Ve.value,qe=ue+he(Ve,be++),He+=ve(Ve,te,V,qe,Ae);else if(Ve==="object")throw te=String(B),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.");return He}function xe(B,te,V){if(B==null)return B;var ue=[],Ae=0;return ve(B,ue,"","",function(Ve){return te.call(V,Ve,Ae++)}),ue}function Ie(B){if(B._status===-1){var te=B._result;te=te(),te.then(function(V){(B._status===0||B._status===-1)&&(B._status=1,B._result=V)},function(V){(B._status===0||B._status===-1)&&(B._status=2,B._result=V)}),B._status===-1&&(B._status=0,B._result=te)}if(B._status===1)return B._result.default;throw B._result}var we={current:null},Ne={transition:null},at={ReactCurrentDispatcher:we,ReactCurrentBatchConfig:Ne,ReactCurrentOwner:H};function nt(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:xe,forEach:function(B,te,V){xe(B,function(){te.apply(this,arguments)},V)},count:function(B){var te=0;return xe(B,function(){te++}),te},toArray:function(B){return xe(B,function(te){return te})||[]},only:function(B){if(!re(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},react_production_min.Component=S,react_production_min.Fragment=t,react_production_min.Profiler=s,react_production_min.PureComponent=A,react_production_min.StrictMode=n,react_production_min.Suspense=u,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=at,react_production_min.act=nt,react_production_min.cloneElement=function(B,te,V){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var ue=E({},B.props),Ae=B.key,Ve=B.ref,He=B._owner;if(te!=null){if(te.ref!==void 0&&(Ve=te.ref,He=H.current),te.key!==void 0&&(Ae=""+te.key),B.type&&B.type.defaultProps)var be=B.type.defaultProps;for(qe in te)Y.call(te,qe)&&!k.hasOwnProperty(qe)&&(ue[qe]=te[qe]===void 0&&be!==void 0?be[qe]:te[qe])}var qe=arguments.length-2;if(qe===1)ue.children=V;else if(1<qe){be=Array(qe);for(var le=0;le<qe;le++)be[le]=arguments[le+2];ue.children=be}return{$$typeof:r,type:B.type,key:Ae,ref:Ve,props:ue,_owner:He}},react_production_min.createContext=function(B){return B={$$typeof:a,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:o,_context:B},B.Consumer=B},react_production_min.createElement=K,react_production_min.createFactory=function(B){var te=K.bind(null,B);return te.type=B,te},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(B){return{$$typeof:l,render:B}},react_production_min.isValidElement=re,react_production_min.lazy=function(B){return{$$typeof:h,_payload:{_status:-1,_result:B},_init:Ie}},react_production_min.memo=function(B,te){return{$$typeof:c,type:B,compare:te===void 0?null:te}},react_production_min.startTransition=function(B){var te=Ne.transition;Ne.transition={};try{B()}finally{Ne.transition=te}},react_production_min.unstable_act=nt,react_production_min.useCallback=function(B,te){return we.current.useCallback(B,te)},react_production_min.useContext=function(B){return we.current.useContext(B)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(B){return we.current.useDeferredValue(B)},react_production_min.useEffect=function(B,te){return we.current.useEffect(B,te)},react_production_min.useId=function(){return we.current.useId()},react_production_min.useImperativeHandle=function(B,te,V){return we.current.useImperativeHandle(B,te,V)},react_production_min.useInsertionEffect=function(B,te){return we.current.useInsertionEffect(B,te)},react_production_min.useLayoutEffect=function(B,te){return we.current.useLayoutEffect(B,te)},react_production_min.useMemo=function(B,te){return we.current.useMemo(B,te)},react_production_min.useReducer=function(B,te,V){return we.current.useReducer(B,te,V)},react_production_min.useRef=function(B){return we.current.useRef(B)},react_production_min.useState=function(B){return we.current.useState(B)},react_production_min.useSyncExternalStore=function(B,te,V){return we.current.useSyncExternalStore(B,te,V)},react_production_min.useTransition=function(){return we.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(l,u,c){var h,g={},v=null,m=null;c!==void 0&&(v=""+c),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(m=u.ref);for(h in u)n.call(u,h)&&!o.hasOwnProperty(h)&&(g[h]=u[h]);if(l&&l.defaultProps)for(h in u=l.defaultProps,u)g[h]===void 0&&(g[h]=u[h]);return{$$typeof:e,type:l,key:v,ref:m,props:g,_owner:s.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=a,reactJsxRuntime_production_min.jsxs=a,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs$2(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(r){function e(Ne,at){var nt=Ne.length;Ne.push(at);e:for(;0<nt;){var B=nt-1>>>1,te=Ne[B];if(0<s(te,at))Ne[B]=at,Ne[nt]=te,nt=B;else break e}}function t(Ne){return Ne.length===0?null:Ne[0]}function n(Ne){if(Ne.length===0)return null;var at=Ne[0],nt=Ne.pop();if(nt!==at){Ne[0]=nt;e:for(var B=0,te=Ne.length,V=te>>>1;B<V;){var ue=2*(B+1)-1,Ae=Ne[ue],Ve=ue+1,He=Ne[Ve];if(0>s(Ae,nt))Ve<te&&0>s(He,Ae)?(Ne[B]=He,Ne[Ve]=nt,B=Ve):(Ne[B]=Ae,Ne[ue]=nt,B=ue);else if(Ve<te&&0>s(He,nt))Ne[B]=He,Ne[Ve]=nt,B=Ve;else break e}}return at}function s(Ne,at){var nt=Ne.sortIndex-at.sortIndex;return nt!==0?nt:Ne.id-at.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();r.unstable_now=function(){return a.now()-l}}var u=[],c=[],h=1,g=null,v=3,m=!1,E=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(Ne){for(var at=t(c);at!==null;){if(at.callback===null)n(c);else if(at.startTime<=Ne)n(c),at.sortIndex=at.expirationTime,e(u,at);else break;at=t(c)}}function D(Ne){if(_=!1,O(Ne),!E)if(t(u)!==null)E=!0,Ie(Y);else{var at=t(c);at!==null&&we(D,at.startTime-Ne)}}function Y(Ne,at){E=!1,_&&(_=!1,w(K),K=-1),m=!0;var nt=v;try{for(O(at),g=t(u);g!==null&&(!(g.expirationTime>at)||Ne&&!Ce());){var B=g.callback;if(typeof B=="function"){g.callback=null,v=g.priorityLevel;var te=B(g.expirationTime<=at);at=r.unstable_now(),typeof te=="function"?g.callback=te:g===t(u)&&n(u),O(at)}else n(u);g=t(u)}if(g!==null)var V=!0;else{var ue=t(c);ue!==null&&we(D,ue.startTime-at),V=!1}return V}finally{g=null,v=nt,m=!1}}var H=!1,k=null,K=-1,se=5,re=-1;function Ce(){return!(r.unstable_now()-re<se)}function Le(){if(k!==null){var Ne=r.unstable_now();re=Ne;var at=!0;try{at=k(!0,Ne)}finally{at?he():(H=!1,k=null)}}else H=!1}var he;if(typeof A=="function")he=function(){A(Le)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,xe=ve.port2;ve.port1.onmessage=Le,he=function(){xe.postMessage(null)}}else he=function(){S(Le,0)};function Ie(Ne){k=Ne,H||(H=!0,he())}function we(Ne,at){K=S(function(){Ne(r.unstable_now())},at)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Ne){Ne.callback=null},r.unstable_continueExecution=function(){E||m||(E=!0,Ie(Y))},r.unstable_forceFrameRate=function(Ne){0>Ne||125<Ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<Ne?Math.floor(1e3/Ne):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(Ne){switch(v){case 1:case 2:case 3:var at=3;break;default:at=v}var nt=v;v=at;try{return Ne()}finally{v=nt}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Ne,at){switch(Ne){case 1:case 2:case 3:case 4:case 5:break;default:Ne=3}var nt=v;v=Ne;try{return at()}finally{v=nt}},r.unstable_scheduleCallback=function(Ne,at,nt){var B=r.unstable_now();switch(typeof nt=="object"&&nt!==null?(nt=nt.delay,nt=typeof nt=="number"&&0<nt?B+nt:B):nt=B,Ne){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=nt+te,Ne={id:h++,callback:at,priorityLevel:Ne,startTime:nt,expirationTime:te,sortIndex:-1},nt>B?(Ne.sortIndex=nt,e(c,Ne),t(u)===null&&Ne===t(c)&&(_?(w(K),K=-1):_=!0,we(D,nt-B))):(Ne.sortIndex=te,e(u,Ne),E||m||(E=!0,Ie(Y))),Ne},r.unstable_shouldYield=Ce,r.unstable_wrapCallback=function(Ne){var at=v;return function(){var nt=v;v=at;try{return Ne.apply(this,arguments)}finally{v=nt}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var r=requireReact(),e=requireScheduler();function t(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,T=1;T<arguments.length;T++)p+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(d,p){a(d,p),a(d+"Capture",p)}function a(d,p){for(s[d]=p,d=0;d<p.length;d++)n.add(p[d])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function v(d){return u.call(g,d)?!0:u.call(h,d)?!1:c.test(d)?g[d]=!0:(h[d]=!0,!1)}function m(d,p,T,N){if(T!==null&&T.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return N?!1:T!==null?!T.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function E(d,p,T,N){if(p===null||typeof p>"u"||m(d,p,T,N))return!0;if(N)return!1;if(T!==null)switch(T.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function _(d,p,T,N,G,Q,ge){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=N,this.attributeNamespace=G,this.mustUseProperty=T,this.propertyName=d,this.type=p,this.sanitizeURL=Q,this.removeEmptyString=ge}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){S[d]=new _(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];S[p]=new _(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){S[d]=new _(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){S[d]=new _(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){S[d]=new _(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){S[d]=new _(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){S[d]=new _(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){S[d]=new _(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){S[d]=new _(d,5,!1,d.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function A(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(w,A);S[p]=new _(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(w,A);S[p]=new _(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(w,A);S[p]=new _(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){S[d]=new _(d,1,!1,d.toLowerCase(),null,!1,!1)}),S.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){S[d]=new _(d,1,!1,d.toLowerCase(),null,!0,!0)});function O(d,p,T,N){var G=S.hasOwnProperty(p)?S[p]:null;(G!==null?G.type!==0:N||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(E(p,T,G,N)&&(T=null),N||G===null?v(p)&&(T===null?d.removeAttribute(p):d.setAttribute(p,""+T)):G.mustUseProperty?d[G.propertyName]=T===null?G.type===3?!1:"":T:(p=G.attributeName,N=G.attributeNamespace,T===null?d.removeAttribute(p):(G=G.type,T=G===3||G===4&&T===!0?"":""+T,N?d.setAttributeNS(N,p,T):d.setAttribute(p,T))))}var D=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Y=Symbol.for("react.element"),H=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),re=Symbol.for("react.provider"),Ce=Symbol.for("react.context"),Le=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),we=Symbol.for("react.offscreen"),Ne=Symbol.iterator;function at(d){return d===null||typeof d!="object"?null:(d=Ne&&d[Ne]||d["@@iterator"],typeof d=="function"?d:null)}var nt=Object.assign,B;function te(d){if(B===void 0)try{throw Error()}catch(T){var p=T.stack.trim().match(/\n( *(at )?)/);B=p&&p[1]||""}return`
`+B+d}var V=!1;function ue(d,p){if(!d||V)return"";V=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(ct){var N=ct}Reflect.construct(d,[],p)}else{try{p.call()}catch(ct){N=ct}d.call(p.prototype)}else{try{throw Error()}catch(ct){N=ct}d()}}catch(ct){if(ct&&N&&typeof ct.stack=="string"){for(var G=ct.stack.split(`
`),Q=N.stack.split(`
`),ge=G.length-1,ke=Q.length-1;1<=ge&&0<=ke&&G[ge]!==Q[ke];)ke--;for(;1<=ge&&0<=ke;ge--,ke--)if(G[ge]!==Q[ke]){if(ge!==1||ke!==1)do if(ge--,ke--,0>ke||G[ge]!==Q[ke]){var Ke=`
`+G[ge].replace(" at new "," at ");return d.displayName&&Ke.includes("<anonymous>")&&(Ke=Ke.replace("<anonymous>",d.displayName)),Ke}while(1<=ge&&0<=ke);break}}}finally{V=!1,Error.prepareStackTrace=T}return(d=d?d.displayName||d.name:"")?te(d):""}function Ae(d){switch(d.tag){case 5:return te(d.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return d=ue(d.type,!1),d;case 11:return d=ue(d.type.render,!1),d;case 1:return d=ue(d.type,!0),d;default:return""}}function Ve(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case k:return"Fragment";case H:return"Portal";case se:return"Profiler";case K:return"StrictMode";case he:return"Suspense";case ve:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case Ce:return(d.displayName||"Context")+".Consumer";case re:return(d._context.displayName||"Context")+".Provider";case Le:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case xe:return p=d.displayName||null,p!==null?p:Ve(d.type)||"Memo";case Ie:p=d._payload,d=d._init;try{return Ve(d(p))}catch{}}return null}function He(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ve(p);case 8:return p===K?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function be(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function qe(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function le(d){var p=qe(d)?"checked":"value",T=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),N=""+d[p];if(!d.hasOwnProperty(p)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var G=T.get,Q=T.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return G.call(this)},set:function(ge){N=""+ge,Q.call(this,ge)}}),Object.defineProperty(d,p,{enumerable:T.enumerable}),{getValue:function(){return N},setValue:function(ge){N=""+ge},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function pe(d){d._valueTracker||(d._valueTracker=le(d))}function Se(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var T=p.getValue(),N="";return d&&(N=qe(d)?d.checked?"true":"false":d.value),d=N,d!==T?(p.setValue(d),!0):!1}function Ye(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Fe(d,p){var T=p.checked;return nt({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??d._wrapperState.initialChecked})}function je(d,p){var T=p.defaultValue==null?"":p.defaultValue,N=p.checked!=null?p.checked:p.defaultChecked;T=be(p.value!=null?p.value:T),d._wrapperState={initialChecked:N,initialValue:T,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function rt(d,p){p=p.checked,p!=null&&O(d,"checked",p,!1)}function Ue(d,p){rt(d,p);var T=be(p.value),N=p.type;if(T!=null)N==="number"?(T===0&&d.value===""||d.value!=T)&&(d.value=""+T):d.value!==""+T&&(d.value=""+T);else if(N==="submit"||N==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?et(d,p.type,T):p.hasOwnProperty("defaultValue")&&et(d,p.type,be(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function Xe(d,p,T){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var N=p.type;if(!(N!=="submit"&&N!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,T||p===d.value||(d.value=p),d.defaultValue=p}T=d.name,T!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,T!==""&&(d.name=T)}function et(d,p,T){(p!=="number"||Ye(d.ownerDocument)!==d)&&(T==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+T&&(d.defaultValue=""+T))}var Qe=Array.isArray;function st(d,p,T,N){if(d=d.options,p){p={};for(var G=0;G<T.length;G++)p["$"+T[G]]=!0;for(T=0;T<d.length;T++)G=p.hasOwnProperty("$"+d[T].value),d[T].selected!==G&&(d[T].selected=G),G&&N&&(d[T].defaultSelected=!0)}else{for(T=""+be(T),p=null,G=0;G<d.length;G++){if(d[G].value===T){d[G].selected=!0,N&&(d[G].defaultSelected=!0);return}p!==null||d[G].disabled||(p=d[G])}p!==null&&(p.selected=!0)}}function St(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return nt({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function At(d,p){var T=p.value;if(T==null){if(T=p.children,p=p.defaultValue,T!=null){if(p!=null)throw Error(t(92));if(Qe(T)){if(1<T.length)throw Error(t(93));T=T[0]}p=T}p==null&&(p=""),T=p}d._wrapperState={initialValue:be(T)}}function j(d,p){var T=be(p.value),N=be(p.defaultValue);T!=null&&(T=""+T,T!==d.value&&(d.value=T),p.defaultValue==null&&d.defaultValue!==T&&(d.defaultValue=T)),N!=null&&(d.defaultValue=""+N)}function X(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function P(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function R(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?P(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var ae,Pe=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,T,N,G){MSApp.execUnsafeLocalFunction(function(){return d(p,T,N,G)})}:d}(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(ae=ae||document.createElement("div"),ae.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=ae.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Oe(d,p){if(p){var T=d.firstChild;if(T&&T===d.lastChild&&T.nodeType===3){T.nodeValue=p;return}}d.textContent=p}var oe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ee=["Webkit","ms","Moz","O"];Object.keys(oe).forEach(function(d){ee.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),oe[p]=oe[d]})});function fe(d,p,T){return p==null||typeof p=="boolean"||p===""?"":T||typeof p!="number"||p===0||oe.hasOwnProperty(d)&&oe[d]?(""+p).trim():p+"px"}function Re(d,p){d=d.style;for(var T in p)if(p.hasOwnProperty(T)){var N=T.indexOf("--")===0,G=fe(T,p[T],N);T==="float"&&(T="cssFloat"),N?d.setProperty(T,G):d[T]=G}}var $e=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Je(d,p){if(p){if($e[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Be(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ot=null;function gt(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var b=null,q=null,F=null;function W(d){if(d=fs(d)){if(typeof b!="function")throw Error(t(280));var p=d.stateNode;p&&(p=Ys(p),b(d.stateNode,d.type,p))}}function z(d){q?F?F.push(d):F=[d]:q=d}function ie(){if(q){var d=q,p=F;if(F=q=null,W(d),p)for(d=0;d<p.length;d++)W(p[d])}}function _e(d,p){return d(p)}function J(){}var me=!1;function L(d,p,T){if(me)return d(p,T);me=!0;try{return _e(d,p,T)}finally{me=!1,(q!==null||F!==null)&&(J(),ie())}}function Z(d,p){var T=d.stateNode;if(T===null)return null;var N=Ys(T);if(N===null)return null;T=N[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(d=d.type,N=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!N;break e;default:d=!1}if(d)return null;if(T&&typeof T!="function")throw Error(t(231,p,typeof T));return T}var de=!1;if(l)try{var Ee={};Object.defineProperty(Ee,"passive",{get:function(){de=!0}}),window.addEventListener("test",Ee,Ee),window.removeEventListener("test",Ee,Ee)}catch{de=!1}function ye(d,p,T,N,G,Q,ge,ke,Ke){var ct=Array.prototype.slice.call(arguments,3);try{p.apply(T,ct)}catch(_t){this.onError(_t)}}var Ge=!1,tt=null,ft=!1,We=null,yt={onError:function(d){Ge=!0,tt=d}};function Ct(d,p,T,N,G,Q,ge,ke,Ke){Ge=!1,tt=null,ye.apply(yt,arguments)}function Mt(d,p,T,N,G,Q,ge,ke,Ke){if(Ct.apply(this,arguments),Ge){if(Ge){var ct=tt;Ge=!1,tt=null}else throw Error(t(198));ft||(ft=!0,We=ct)}}function De(d){var p=d,T=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,p.flags&4098&&(T=p.return),d=p.return;while(d)}return p.tag===3?T:null}function ht(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function mt(d){if(De(d)!==d)throw Error(t(188))}function Nt(d){var p=d.alternate;if(!p){if(p=De(d),p===null)throw Error(t(188));return p!==d?null:d}for(var T=d,N=p;;){var G=T.return;if(G===null)break;var Q=G.alternate;if(Q===null){if(N=G.return,N!==null){T=N;continue}break}if(G.child===Q.child){for(Q=G.child;Q;){if(Q===T)return mt(G),d;if(Q===N)return mt(G),p;Q=Q.sibling}throw Error(t(188))}if(T.return!==N.return)T=G,N=Q;else{for(var ge=!1,ke=G.child;ke;){if(ke===T){ge=!0,T=G,N=Q;break}if(ke===N){ge=!0,N=G,T=Q;break}ke=ke.sibling}if(!ge){for(ke=Q.child;ke;){if(ke===T){ge=!0,T=Q,N=G;break}if(ke===N){ge=!0,N=Q,T=G;break}ke=ke.sibling}if(!ge)throw Error(t(189))}}if(T.alternate!==N)throw Error(t(190))}if(T.tag!==3)throw Error(t(188));return T.stateNode.current===T?d:p}function pt(d){return d=Nt(d),d!==null?Me(d):null}function Me(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=Me(d);if(p!==null)return p;d=d.sibling}return null}var dt=e.unstable_scheduleCallback,wt=e.unstable_cancelCallback,Ot=e.unstable_shouldYield,Bt=e.unstable_requestPaint,bt=e.unstable_now,lr=e.unstable_getCurrentPriorityLevel,fr=e.unstable_ImmediatePriority,ur=e.unstable_UserBlockingPriority,Qt=e.unstable_NormalPriority,ci=e.unstable_LowPriority,Vn=e.unstable_IdlePriority,di=null,Ur=null;function hi(d){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(di,d,void 0,(d.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:tn,fi=Math.log,hn=Math.LN2;function tn(d){return d>>>=0,d===0?32:31-(fi(d)/hn|0)|0}var Gn=64,fn=4194304;function rn(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Sn(d,p){var T=d.pendingLanes;if(T===0)return 0;var N=0,G=d.suspendedLanes,Q=d.pingedLanes,ge=T&268435455;if(ge!==0){var ke=ge&~G;ke!==0?N=rn(ke):(Q&=ge,Q!==0&&(N=rn(Q)))}else ge=T&~G,ge!==0?N=rn(ge):Q!==0&&(N=rn(Q));if(N===0)return 0;if(p!==0&&p!==N&&!(p&G)&&(G=N&-N,Q=p&-p,G>=Q||G===16&&(Q&4194240)!==0))return p;if(N&4&&(N|=T&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=N;0<p;)T=31-Er(p),G=1<<T,N|=d[T],p&=~G;return N}function pi(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qi(d,p){for(var T=d.suspendedLanes,N=d.pingedLanes,G=d.expirationTimes,Q=d.pendingLanes;0<Q;){var ge=31-Er(Q),ke=1<<ge,Ke=G[ge];Ke===-1?(!(ke&T)||ke&N)&&(G[ge]=pi(ke,p)):Ke<=p&&(d.expiredLanes|=ke),Q&=~ke}}function mi(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Ki(){var d=Gn;return Gn<<=1,!(Gn&4194240)&&(Gn=64),d}function gi(d){for(var p=[],T=0;31>T;T++)p.push(d);return p}function Tn(d,p,T){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Er(p),d[p]=T}function xo(d,p){var T=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var N=d.eventTimes;for(d=d.expirationTimes;0<T;){var G=31-Er(T),Q=1<<G;p[G]=0,N[G]=-1,d[G]=-1,T&=~Q}}function yi(d,p){var T=d.entangledLanes|=p;for(d=d.entanglements;T;){var N=31-Er(T),G=1<<N;G&p|d[N]&p&&(d[N]|=p),T&=~G}}var Wt=0;function Ns(d){return d&=-d,1<d?4<d?d&268435455?16:536870912:4:1}var Is,Wn,cr,Ei,Ci,jn=!1,qt=[],Br=null,Fr=null,qr=null,Lr=new Map,Yt=new Map,$r=[],Ps="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Os(d,p){switch(d){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":qr=null;break;case"pointerover":case"pointerout":Lr.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yt.delete(p.pointerId)}}function Yn(d,p,T,N,G,Q){return d===null||d.nativeEvent!==Q?(d={blockedOn:p,domEventName:T,eventSystemFlags:N,nativeEvent:Q,targetContainers:[G]},p!==null&&(p=fs(p),p!==null&&Wn(p)),d):(d.eventSystemFlags|=N,p=d.targetContainers,G!==null&&p.indexOf(G)===-1&&p.push(G),d)}function Fo(d,p,T,N,G){switch(p){case"focusin":return Br=Yn(Br,d,p,T,N,G),!0;case"dragenter":return Fr=Yn(Fr,d,p,T,N,G),!0;case"mouseover":return qr=Yn(qr,d,p,T,N,G),!0;case"pointerover":var Q=G.pointerId;return Lr.set(Q,Yn(Lr.get(Q)||null,d,p,T,N,G)),!0;case"gotpointercapture":return Q=G.pointerId,Yt.set(Q,Yn(Yt.get(Q)||null,d,p,T,N,G)),!0}return!1}function Ms(d){var p=Zn(d.target);if(p!==null){var T=De(p);if(T!==null){if(p=T.tag,p===13){if(p=ht(T),p!==null){d.blockedOn=p,Ci(d.priority,function(){cr(T)});return}}else if(p===3&&T.stateNode.current.memoizedState.isDehydrated){d.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}d.blockedOn=null}function vi(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var T=Qi(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(T===null){T=d.nativeEvent;var N=new T.constructor(T.type,T);ot=N,T.target.dispatchEvent(N),ot=null}else return p=fs(T),p!==null&&Wn(p),d.blockedOn=T,!1;p.shift()}return!0}function xs(d,p,T){vi(d)&&T.delete(p)}function Lo(){jn=!1,Br!==null&&vi(Br)&&(Br=null),Fr!==null&&vi(Fr)&&(Fr=null),qr!==null&&vi(qr)&&(qr=null),Lr.forEach(xs),Yt.forEach(xs)}function zn(d,p){d.blockedOn===p&&(d.blockedOn=null,jn||(jn=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Lo)))}function qn(d){function p(G){return zn(G,d)}if(0<qt.length){zn(qt[0],d);for(var T=1;T<qt.length;T++){var N=qt[T];N.blockedOn===d&&(N.blockedOn=null)}}for(Br!==null&&zn(Br,d),Fr!==null&&zn(Fr,d),qr!==null&&zn(qr,d),Lr.forEach(p),Yt.forEach(p),T=0;T<$r.length;T++)N=$r[T],N.blockedOn===d&&(N.blockedOn=null);for(;0<$r.length&&(T=$r[0],T.blockedOn===null);)Ms(T),T.blockedOn===null&&$r.shift()}var wn=D.ReactCurrentBatchConfig,_i=!0;function $o(d,p,T,N){var G=Wt,Q=wn.transition;wn.transition=null;try{Wt=1,Xi(d,p,T,N)}finally{Wt=G,wn.transition=Q}}function Do(d,p,T,N){var G=Wt,Q=wn.transition;wn.transition=null;try{Wt=4,Xi(d,p,T,N)}finally{Wt=G,wn.transition=Q}}function Xi(d,p,T,N){if(_i){var G=Qi(d,p,T,N);if(G===null)pa(d,p,N,Si,T),Os(d,N);else if(Fo(G,d,p,T,N))N.stopPropagation();else if(Os(d,N),p&4&&-1<Ps.indexOf(d)){for(;G!==null;){var Q=fs(G);if(Q!==null&&Is(Q),Q=Qi(d,p,T,N),Q===null&&pa(d,p,N,Si,T),Q===G)break;G=Q}G!==null&&N.stopPropagation()}else pa(d,p,N,null,T)}}var Si=null;function Qi(d,p,T,N){if(Si=null,d=gt(N),d=Zn(d),d!==null)if(p=De(d),p===null)d=null;else if(T=p.tag,T===13){if(d=ht(p),d!==null)return d;d=null}else if(T===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Si=d,null}function Fs(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lr()){case fr:return 1;case ur:return 4;case Qt:case ci:return 16;case Vn:return 536870912;default:return 16}default:return 16}}var nn=null,Zi=null,Ti=null;function Ls(){if(Ti)return Ti;var d,p=Zi,T=p.length,N,G="value"in nn?nn.value:nn.textContent,Q=G.length;for(d=0;d<T&&p[d]===G[d];d++);var ge=T-d;for(N=1;N<=ge&&p[T-N]===G[Q-N];N++);return Ti=G.slice(d,1<N?1-N:void 0)}function wi(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Ri(){return!0}function $s(){return!1}function Ar(d){function p(T,N,G,Q,ge){this._reactName=T,this._targetInst=G,this.type=N,this.nativeEvent=Q,this.target=ge,this.currentTarget=null;for(var ke in d)d.hasOwnProperty(ke)&&(T=d[ke],this[ke]=T?T(Q):Q[ke]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?Ri:$s,this.isPropagationStopped=$s,this}return nt(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Ri)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Ri)},persist:function(){},isPersistent:Ri}),p}var Rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ji=Ar(Rn),Kn=nt({},Rn,{view:0,detail:0}),ko=Ar(Kn),es,ts,Xn,Ai=nt({},Kn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ns,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Xn&&(Xn&&d.type==="mousemove"?(es=d.screenX-Xn.screenX,ts=d.screenY-Xn.screenY):ts=es=0,Xn=d),es)},movementY:function(d){return"movementY"in d?d.movementY:ts}}),Ds=Ar(Ai),Ho=nt({},Ai,{dataTransfer:0}),Uo=Ar(Ho),Bo=nt({},Kn,{relatedTarget:0}),rs=Ar(Bo),Vo=nt({},Rn,{animationName:0,elapsedTime:0,pseudoElement:0}),Go=Ar(Vo),Wo=nt({},Rn,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),jo=Ar(Wo),Yo=nt({},Rn,{data:0}),ks=Ar(Yo),zo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ko={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xo(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=Ko[d])?!!p[d]:!1}function ns(){return Xo}var Qo=nt({},Kn,{key:function(d){if(d.key){var p=zo[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=wi(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?qo[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ns,charCode:function(d){return d.type==="keypress"?wi(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?wi(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Zo=Ar(Qo),Jo=nt({},Ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hs=Ar(Jo),ea=nt({},Kn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ns}),ta=Ar(ea),ra=nt({},Rn,{propertyName:0,elapsedTime:0,pseudoElement:0}),na=Ar(ra),ia=nt({},Ai,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),sa=Ar(ia),oa=[9,13,27,32],Qn=l&&"CompositionEvent"in window,pr=null;l&&"documentMode"in document&&(pr=document.documentMode);var is=l&&"TextEvent"in window&&!pr,bi=l&&(!Qn||pr&&8<pr&&11>=pr),sn=" ",ss=!1;function Ni(d,p){switch(d){case"keyup":return oa.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function An(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var bn=!1;function f(d,p){switch(d){case"compositionend":return An(p);case"keypress":return p.which!==32?null:(ss=!0,sn);case"textInput":return d=p.data,d===sn&&ss?null:d;default:return null}}function C(d,p){if(bn)return d==="compositionend"||!Qn&&Ni(d,p)?(d=Ls(),Ti=Zi=nn=null,bn=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return bi&&p.locale!=="ko"?null:p.data;default:return null}}var I={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function U(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!I[d.type]:p==="textarea"}function ne(d,p,T,N){z(N),p=Gs(p,"onChange"),0<p.length&&(T=new Ji("onChange","change",null,T,N),d.push({event:T,listeners:p}))}var ce=null,Te=null;function ze(d){Dl(d,0)}function lt(d){var p=xi(d);if(Se(p))return d}function Et(d,p){if(d==="change")return p}var It=!1;if(l){var Dt;if(l){var xt="oninput"in document;if(!xt){var Vt=document.createElement("div");Vt.setAttribute("oninput","return;"),xt=typeof Vt.oninput=="function"}Dt=xt}else Dt=!1;It=Dt&&(!document.documentMode||9<document.documentMode)}function jt(){ce&&(ce.detachEvent("onpropertychange",zt),Te=ce=null)}function zt(d){if(d.propertyName==="value"&&lt(Te)){var p=[];ne(p,Te,d,gt(d)),L(ze,p)}}function _r(d,p,T){d==="focusin"?(jt(),ce=p,Te=T,ce.attachEvent("onpropertychange",zt)):d==="focusout"&&jt()}function tr(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return lt(Te)}function on(d,p){if(d==="click")return lt(p)}function Sc(d,p){if(d==="input"||d==="change")return lt(p)}function Tc(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Kr=typeof Object.is=="function"?Object.is:Tc;function os(d,p){if(Kr(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var T=Object.keys(d),N=Object.keys(p);if(T.length!==N.length)return!1;for(N=0;N<T.length;N++){var G=T[N];if(!u.call(p,G)||!Kr(d[G],p[G]))return!1}return!0}function wl(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Rl(d,p){var T=wl(d);d=0;for(var N;T;){if(T.nodeType===3){if(N=d+T.textContent.length,d<=p&&N>=p)return{node:T,offset:p-d};d=N}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=wl(T)}}function Al(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?Al(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function bl(){for(var d=window,p=Ye();p instanceof d.HTMLIFrameElement;){try{var T=typeof p.contentWindow.location.href=="string"}catch{T=!1}if(T)d=p.contentWindow;else break;p=Ye(d.document)}return p}function aa(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function wc(d){var p=bl(),T=d.focusedElem,N=d.selectionRange;if(p!==T&&T&&T.ownerDocument&&Al(T.ownerDocument.documentElement,T)){if(N!==null&&aa(T)){if(p=N.start,d=N.end,d===void 0&&(d=p),"selectionStart"in T)T.selectionStart=p,T.selectionEnd=Math.min(d,T.value.length);else if(d=(p=T.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var G=T.textContent.length,Q=Math.min(N.start,G);N=N.end===void 0?Q:Math.min(N.end,G),!d.extend&&Q>N&&(G=N,N=Q,Q=G),G=Rl(T,Q);var ge=Rl(T,N);G&&ge&&(d.rangeCount!==1||d.anchorNode!==G.node||d.anchorOffset!==G.offset||d.focusNode!==ge.node||d.focusOffset!==ge.offset)&&(p=p.createRange(),p.setStart(G.node,G.offset),d.removeAllRanges(),Q>N?(d.addRange(p),d.extend(ge.node,ge.offset)):(p.setEnd(ge.node,ge.offset),d.addRange(p)))}}for(p=[],d=T;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<p.length;T++)d=p[T],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Rc=l&&"documentMode"in document&&11>=document.documentMode,Ii=null,la=null,ls=null,ua=!1;function Nl(d,p,T){var N=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;ua||Ii==null||Ii!==Ye(N)||(N=Ii,"selectionStart"in N&&aa(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),ls&&os(ls,N)||(ls=N,N=Gs(la,"onSelect"),0<N.length&&(p=new Ji("onSelect","select",null,p,T),d.push({event:p,listeners:N}),p.target=Ii)))}function Us(d,p){var T={};return T[d.toLowerCase()]=p.toLowerCase(),T["Webkit"+d]="webkit"+p,T["Moz"+d]="moz"+p,T}var Pi={animationend:Us("Animation","AnimationEnd"),animationiteration:Us("Animation","AnimationIteration"),animationstart:Us("Animation","AnimationStart"),transitionend:Us("Transition","TransitionEnd")},ca={},Il={};l&&(Il=document.createElement("div").style,"AnimationEvent"in window||(delete Pi.animationend.animation,delete Pi.animationiteration.animation,delete Pi.animationstart.animation),"TransitionEvent"in window||delete Pi.transitionend.transition);function Bs(d){if(ca[d])return ca[d];if(!Pi[d])return d;var p=Pi[d],T;for(T in p)if(p.hasOwnProperty(T)&&T in Il)return ca[d]=p[T];return d}var Pl=Bs("animationend"),Ol=Bs("animationiteration"),Ml=Bs("animationstart"),xl=Bs("transitionend"),Fl=new Map,Ll="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(d,p){Fl.set(d,p),o(p,[d])}for(var da=0;da<Ll.length;da++){var ha=Ll[da],Ac=ha.toLowerCase(),bc=ha[0].toUpperCase()+ha.slice(1);Nn(Ac,"on"+bc)}Nn(Pl,"onAnimationEnd"),Nn(Ol,"onAnimationIteration"),Nn(Ml,"onAnimationStart"),Nn("dblclick","onDoubleClick"),Nn("focusin","onFocus"),Nn("focusout","onBlur"),Nn(xl,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nc=new Set("cancel close invalid load scroll toggle".split(" ").concat(us));function $l(d,p,T){var N=d.type||"unknown-event";d.currentTarget=T,Mt(N,p,void 0,d),d.currentTarget=null}function Dl(d,p){p=(p&4)!==0;for(var T=0;T<d.length;T++){var N=d[T],G=N.event;N=N.listeners;e:{var Q=void 0;if(p)for(var ge=N.length-1;0<=ge;ge--){var ke=N[ge],Ke=ke.instance,ct=ke.currentTarget;if(ke=ke.listener,Ke!==Q&&G.isPropagationStopped())break e;$l(G,ke,ct),Q=Ke}else for(ge=0;ge<N.length;ge++){if(ke=N[ge],Ke=ke.instance,ct=ke.currentTarget,ke=ke.listener,Ke!==Q&&G.isPropagationStopped())break e;$l(G,ke,ct),Q=Ke}}}if(ft)throw d=We,ft=!1,We=null,d}function Jt(d,p){var T=p[va];T===void 0&&(T=p[va]=new Set);var N=d+"__bubble";T.has(N)||(kl(p,d,2,!1),T.add(N))}function fa(d,p,T){var N=0;p&&(N|=4),kl(T,d,N,p)}var Vs="_reactListening"+Math.random().toString(36).slice(2);function cs(d){if(!d[Vs]){d[Vs]=!0,n.forEach(function(T){T!=="selectionchange"&&(Nc.has(T)||fa(T,!1,d),fa(T,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[Vs]||(p[Vs]=!0,fa("selectionchange",!1,p))}}function kl(d,p,T,N){switch(Fs(p)){case 1:var G=$o;break;case 4:G=Do;break;default:G=Xi}T=G.bind(null,p,T,d),G=void 0,!de||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(G=!0),N?G!==void 0?d.addEventListener(p,T,{capture:!0,passive:G}):d.addEventListener(p,T,!0):G!==void 0?d.addEventListener(p,T,{passive:G}):d.addEventListener(p,T,!1)}function pa(d,p,T,N,G){var Q=N;if(!(p&1)&&!(p&2)&&N!==null)e:for(;;){if(N===null)return;var ge=N.tag;if(ge===3||ge===4){var ke=N.stateNode.containerInfo;if(ke===G||ke.nodeType===8&&ke.parentNode===G)break;if(ge===4)for(ge=N.return;ge!==null;){var Ke=ge.tag;if((Ke===3||Ke===4)&&(Ke=ge.stateNode.containerInfo,Ke===G||Ke.nodeType===8&&Ke.parentNode===G))return;ge=ge.return}for(;ke!==null;){if(ge=Zn(ke),ge===null)return;if(Ke=ge.tag,Ke===5||Ke===6){N=Q=ge;continue e}ke=ke.parentNode}}N=N.return}L(function(){var ct=Q,_t=gt(T),Tt=[];e:{var vt=Fl.get(d);if(vt!==void 0){var Pt=Ji,Lt=d;switch(d){case"keypress":if(wi(T)===0)break e;case"keydown":case"keyup":Pt=Zo;break;case"focusin":Lt="focus",Pt=rs;break;case"focusout":Lt="blur",Pt=rs;break;case"beforeblur":case"afterblur":Pt=rs;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pt=Ds;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pt=Uo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pt=ta;break;case Pl:case Ol:case Ml:Pt=Go;break;case xl:Pt=na;break;case"scroll":Pt=ko;break;case"wheel":Pt=sa;break;case"copy":case"cut":case"paste":Pt=jo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pt=Hs}var $t=(p&4)!==0,or=!$t&&d==="scroll",it=$t?vt!==null?vt+"Capture":null:vt;$t=[];for(var Ze=ct,ut;Ze!==null;){ut=Ze;var Rt=ut.stateNode;if(ut.tag===5&&Rt!==null&&(ut=Rt,it!==null&&(Rt=Z(Ze,it),Rt!=null&&$t.push(ds(Ze,Rt,ut)))),or)break;Ze=Ze.return}0<$t.length&&(vt=new Pt(vt,Lt,null,T,_t),Tt.push({event:vt,listeners:$t}))}}if(!(p&7)){e:{if(vt=d==="mouseover"||d==="pointerover",Pt=d==="mouseout"||d==="pointerout",vt&&T!==ot&&(Lt=T.relatedTarget||T.fromElement)&&(Zn(Lt)||Lt[pn]))break e;if((Pt||vt)&&(vt=_t.window===_t?_t:(vt=_t.ownerDocument)?vt.defaultView||vt.parentWindow:window,Pt?(Lt=T.relatedTarget||T.toElement,Pt=ct,Lt=Lt?Zn(Lt):null,Lt!==null&&(or=De(Lt),Lt!==or||Lt.tag!==5&&Lt.tag!==6)&&(Lt=null)):(Pt=null,Lt=ct),Pt!==Lt)){if($t=Ds,Rt="onMouseLeave",it="onMouseEnter",Ze="mouse",(d==="pointerout"||d==="pointerover")&&($t=Hs,Rt="onPointerLeave",it="onPointerEnter",Ze="pointer"),or=Pt==null?vt:xi(Pt),ut=Lt==null?vt:xi(Lt),vt=new $t(Rt,Ze+"leave",Pt,T,_t),vt.target=or,vt.relatedTarget=ut,Rt=null,Zn(_t)===ct&&($t=new $t(it,Ze+"enter",Lt,T,_t),$t.target=ut,$t.relatedTarget=or,Rt=$t),or=Rt,Pt&&Lt)t:{for($t=Pt,it=Lt,Ze=0,ut=$t;ut;ut=Oi(ut))Ze++;for(ut=0,Rt=it;Rt;Rt=Oi(Rt))ut++;for(;0<Ze-ut;)$t=Oi($t),Ze--;for(;0<ut-Ze;)it=Oi(it),ut--;for(;Ze--;){if($t===it||it!==null&&$t===it.alternate)break t;$t=Oi($t),it=Oi(it)}$t=null}else $t=null;Pt!==null&&Hl(Tt,vt,Pt,$t,!1),Lt!==null&&or!==null&&Hl(Tt,or,Lt,$t,!0)}}e:{if(vt=ct?xi(ct):window,Pt=vt.nodeName&&vt.nodeName.toLowerCase(),Pt==="select"||Pt==="input"&&vt.type==="file")var kt=Et;else if(U(vt))if(It)kt=Sc;else{kt=tr;var Ht=_r}else(Pt=vt.nodeName)&&Pt.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(kt=on);if(kt&&(kt=kt(d,ct))){ne(Tt,kt,T,_t);break e}Ht&&Ht(d,vt,ct),d==="focusout"&&(Ht=vt._wrapperState)&&Ht.controlled&&vt.type==="number"&&et(vt,"number",vt.value)}switch(Ht=ct?xi(ct):window,d){case"focusin":(U(Ht)||Ht.contentEditable==="true")&&(Ii=Ht,la=ct,ls=null);break;case"focusout":ls=la=Ii=null;break;case"mousedown":ua=!0;break;case"contextmenu":case"mouseup":case"dragend":ua=!1,Nl(Tt,T,_t);break;case"selectionchange":if(Rc)break;case"keydown":case"keyup":Nl(Tt,T,_t)}var Ut;if(Qn)e:{switch(d){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else bn?Ni(d,T)&&(Gt="onCompositionEnd"):d==="keydown"&&T.keyCode===229&&(Gt="onCompositionStart");Gt&&(bi&&T.locale!=="ko"&&(bn||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&bn&&(Ut=Ls()):(nn=_t,Zi="value"in nn?nn.value:nn.textContent,bn=!0)),Ht=Gs(ct,Gt),0<Ht.length&&(Gt=new ks(Gt,d,null,T,_t),Tt.push({event:Gt,listeners:Ht}),Ut?Gt.data=Ut:(Ut=An(T),Ut!==null&&(Gt.data=Ut)))),(Ut=is?f(d,T):C(d,T))&&(ct=Gs(ct,"onBeforeInput"),0<ct.length&&(_t=new ks("onBeforeInput","beforeinput",null,T,_t),Tt.push({event:_t,listeners:ct}),_t.data=Ut))}Dl(Tt,p)})}function ds(d,p,T){return{instance:d,listener:p,currentTarget:T}}function Gs(d,p){for(var T=p+"Capture",N=[];d!==null;){var G=d,Q=G.stateNode;G.tag===5&&Q!==null&&(G=Q,Q=Z(d,T),Q!=null&&N.unshift(ds(d,Q,G)),Q=Z(d,p),Q!=null&&N.push(ds(d,Q,G))),d=d.return}return N}function Oi(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function Hl(d,p,T,N,G){for(var Q=p._reactName,ge=[];T!==null&&T!==N;){var ke=T,Ke=ke.alternate,ct=ke.stateNode;if(Ke!==null&&Ke===N)break;ke.tag===5&&ct!==null&&(ke=ct,G?(Ke=Z(T,Q),Ke!=null&&ge.unshift(ds(T,Ke,ke))):G||(Ke=Z(T,Q),Ke!=null&&ge.push(ds(T,Ke,ke)))),T=T.return}ge.length!==0&&d.push({event:p,listeners:ge})}var Ic=/\r\n?/g,Pc=/\u0000|\uFFFD/g;function Ul(d){return(typeof d=="string"?d:""+d).replace(Ic,`
`).replace(Pc,"")}function Ws(d,p,T){if(p=Ul(p),Ul(d)!==p&&T)throw Error(t(425))}function js(){}var ma=null,ga=null;function ya(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Ea=typeof setTimeout=="function"?setTimeout:void 0,Oc=typeof clearTimeout=="function"?clearTimeout:void 0,Bl=typeof Promise=="function"?Promise:void 0,Mc=typeof queueMicrotask=="function"?queueMicrotask:typeof Bl<"u"?function(d){return Bl.resolve(null).then(d).catch(xc)}:Ea;function xc(d){setTimeout(function(){throw d})}function Ca(d,p){var T=p,N=0;do{var G=T.nextSibling;if(d.removeChild(T),G&&G.nodeType===8)if(T=G.data,T==="/$"){if(N===0){d.removeChild(G),qn(p);return}N--}else T!=="$"&&T!=="$?"&&T!=="$!"||N++;T=G}while(T);qn(p)}function In(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function Vl(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var T=d.data;if(T==="$"||T==="$!"||T==="$?"){if(p===0)return d;p--}else T==="/$"&&p++}d=d.previousSibling}return null}var Mi=Math.random().toString(36).slice(2),an="__reactFiber$"+Mi,hs="__reactProps$"+Mi,pn="__reactContainer$"+Mi,va="__reactEvents$"+Mi,Fc="__reactListeners$"+Mi,Lc="__reactHandles$"+Mi;function Zn(d){var p=d[an];if(p)return p;for(var T=d.parentNode;T;){if(p=T[pn]||T[an]){if(T=p.alternate,p.child!==null||T!==null&&T.child!==null)for(d=Vl(d);d!==null;){if(T=d[an])return T;d=Vl(d)}return p}d=T,T=d.parentNode}return null}function fs(d){return d=d[an]||d[pn],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function xi(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function Ys(d){return d[hs]||null}var _a=[],Fi=-1;function Pn(d){return{current:d}}function er(d){0>Fi||(d.current=_a[Fi],_a[Fi]=null,Fi--)}function Zt(d,p){Fi++,_a[Fi]=d.current,d.current=p}var On={},Sr=Pn(On),Ir=Pn(!1),Jn=On;function Li(d,p){var T=d.type.contextTypes;if(!T)return On;var N=d.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===p)return N.__reactInternalMemoizedMaskedChildContext;var G={},Q;for(Q in T)G[Q]=p[Q];return N&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=G),G}function Pr(d){return d=d.childContextTypes,d!=null}function zs(){er(Ir),er(Sr)}function Gl(d,p,T){if(Sr.current!==On)throw Error(t(168));Zt(Sr,p),Zt(Ir,T)}function Wl(d,p,T){var N=d.stateNode;if(p=p.childContextTypes,typeof N.getChildContext!="function")return T;N=N.getChildContext();for(var G in N)if(!(G in p))throw Error(t(108,He(d)||"Unknown",G));return nt({},T,N)}function qs(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||On,Jn=Sr.current,Zt(Sr,d),Zt(Ir,Ir.current),!0}function jl(d,p,T){var N=d.stateNode;if(!N)throw Error(t(169));T?(d=Wl(d,p,Jn),N.__reactInternalMemoizedMergedChildContext=d,er(Ir),er(Sr),Zt(Sr,d)):er(Ir),Zt(Ir,T)}var mn=null,Ks=!1,Sa=!1;function Yl(d){mn===null?mn=[d]:mn.push(d)}function $c(d){Ks=!0,Yl(d)}function Mn(){if(!Sa&&mn!==null){Sa=!0;var d=0,p=Wt;try{var T=mn;for(Wt=1;d<T.length;d++){var N=T[d];do N=N(!0);while(N!==null)}mn=null,Ks=!1}catch(G){throw mn!==null&&(mn=mn.slice(d+1)),dt(fr,Mn),G}finally{Wt=p,Sa=!1}}return null}var $i=[],Di=0,Xs=null,Qs=0,Vr=[],Gr=0,ei=null,gn=1,yn="";function ti(d,p){$i[Di++]=Qs,$i[Di++]=Xs,Xs=d,Qs=p}function zl(d,p,T){Vr[Gr++]=gn,Vr[Gr++]=yn,Vr[Gr++]=ei,ei=d;var N=gn;d=yn;var G=32-Er(N)-1;N&=~(1<<G),T+=1;var Q=32-Er(p)+G;if(30<Q){var ge=G-G%5;Q=(N&(1<<ge)-1).toString(32),N>>=ge,G-=ge,gn=1<<32-Er(p)+G|T<<G|N,yn=Q+d}else gn=1<<Q|T<<G|N,yn=d}function Ta(d){d.return!==null&&(ti(d,1),zl(d,1,0))}function wa(d){for(;d===Xs;)Xs=$i[--Di],$i[Di]=null,Qs=$i[--Di],$i[Di]=null;for(;d===ei;)ei=Vr[--Gr],Vr[Gr]=null,yn=Vr[--Gr],Vr[Gr]=null,gn=Vr[--Gr],Vr[Gr]=null}var Dr=null,kr=null,rr=!1,Xr=null;function ql(d,p){var T=zr(5,null,null,0);T.elementType="DELETED",T.stateNode=p,T.return=d,p=d.deletions,p===null?(d.deletions=[T],d.flags|=16):p.push(T)}function Kl(d,p){switch(d.tag){case 5:var T=d.type;return p=p.nodeType!==1||T.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Dr=d,kr=In(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Dr=d,kr=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(T=ei!==null?{id:gn,overflow:yn}:null,d.memoizedState={dehydrated:p,treeContext:T,retryLane:1073741824},T=zr(18,null,null,0),T.stateNode=p,T.return=d,d.child=T,Dr=d,kr=null,!0):!1;default:return!1}}function Ra(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Aa(d){if(rr){var p=kr;if(p){var T=p;if(!Kl(d,p)){if(Ra(d))throw Error(t(418));p=In(T.nextSibling);var N=Dr;p&&Kl(d,p)?ql(N,T):(d.flags=d.flags&-4097|2,rr=!1,Dr=d)}}else{if(Ra(d))throw Error(t(418));d.flags=d.flags&-4097|2,rr=!1,Dr=d}}}function Xl(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Dr=d}function Zs(d){if(d!==Dr)return!1;if(!rr)return Xl(d),rr=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!ya(d.type,d.memoizedProps)),p&&(p=kr)){if(Ra(d))throw Ql(),Error(t(418));for(;p;)ql(d,p),p=In(p.nextSibling)}if(Xl(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var T=d.data;if(T==="/$"){if(p===0){kr=In(d.nextSibling);break e}p--}else T!=="$"&&T!=="$!"&&T!=="$?"||p++}d=d.nextSibling}kr=null}}else kr=Dr?In(d.stateNode.nextSibling):null;return!0}function Ql(){for(var d=kr;d;)d=In(d.nextSibling)}function ki(){kr=Dr=null,rr=!1}function ba(d){Xr===null?Xr=[d]:Xr.push(d)}var Dc=D.ReactCurrentBatchConfig;function ps(d,p,T){if(d=T.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(t(309));var N=T.stateNode}if(!N)throw Error(t(147,d));var G=N,Q=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===Q?p.ref:(p=function(ge){var ke=G.refs;ge===null?delete ke[Q]:ke[Q]=ge},p._stringRef=Q,p)}if(typeof d!="string")throw Error(t(284));if(!T._owner)throw Error(t(290,d))}return d}function Js(d,p){throw d=Object.prototype.toString.call(p),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Zl(d){var p=d._init;return p(d._payload)}function Jl(d){function p(it,Ze){if(d){var ut=it.deletions;ut===null?(it.deletions=[Ze],it.flags|=16):ut.push(Ze)}}function T(it,Ze){if(!d)return null;for(;Ze!==null;)p(it,Ze),Ze=Ze.sibling;return null}function N(it,Ze){for(it=new Map;Ze!==null;)Ze.key!==null?it.set(Ze.key,Ze):it.set(Ze.index,Ze),Ze=Ze.sibling;return it}function G(it,Ze){return it=Un(it,Ze),it.index=0,it.sibling=null,it}function Q(it,Ze,ut){return it.index=ut,d?(ut=it.alternate,ut!==null?(ut=ut.index,ut<Ze?(it.flags|=2,Ze):ut):(it.flags|=2,Ze)):(it.flags|=1048576,Ze)}function ge(it){return d&&it.alternate===null&&(it.flags|=2),it}function ke(it,Ze,ut,Rt){return Ze===null||Ze.tag!==6?(Ze=El(ut,it.mode,Rt),Ze.return=it,Ze):(Ze=G(Ze,ut),Ze.return=it,Ze)}function Ke(it,Ze,ut,Rt){var kt=ut.type;return kt===k?_t(it,Ze,ut.props.children,Rt,ut.key):Ze!==null&&(Ze.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ie&&Zl(kt)===Ze.type)?(Rt=G(Ze,ut.props),Rt.ref=ps(it,Ze,ut),Rt.return=it,Rt):(Rt=Ro(ut.type,ut.key,ut.props,null,it.mode,Rt),Rt.ref=ps(it,Ze,ut),Rt.return=it,Rt)}function ct(it,Ze,ut,Rt){return Ze===null||Ze.tag!==4||Ze.stateNode.containerInfo!==ut.containerInfo||Ze.stateNode.implementation!==ut.implementation?(Ze=Cl(ut,it.mode,Rt),Ze.return=it,Ze):(Ze=G(Ze,ut.children||[]),Ze.return=it,Ze)}function _t(it,Ze,ut,Rt,kt){return Ze===null||Ze.tag!==7?(Ze=ui(ut,it.mode,Rt,kt),Ze.return=it,Ze):(Ze=G(Ze,ut),Ze.return=it,Ze)}function Tt(it,Ze,ut){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number")return Ze=El(""+Ze,it.mode,ut),Ze.return=it,Ze;if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case Y:return ut=Ro(Ze.type,Ze.key,Ze.props,null,it.mode,ut),ut.ref=ps(it,null,Ze),ut.return=it,ut;case H:return Ze=Cl(Ze,it.mode,ut),Ze.return=it,Ze;case Ie:var Rt=Ze._init;return Tt(it,Rt(Ze._payload),ut)}if(Qe(Ze)||at(Ze))return Ze=ui(Ze,it.mode,ut,null),Ze.return=it,Ze;Js(it,Ze)}return null}function vt(it,Ze,ut,Rt){var kt=Ze!==null?Ze.key:null;if(typeof ut=="string"&&ut!==""||typeof ut=="number")return kt!==null?null:ke(it,Ze,""+ut,Rt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Y:return ut.key===kt?Ke(it,Ze,ut,Rt):null;case H:return ut.key===kt?ct(it,Ze,ut,Rt):null;case Ie:return kt=ut._init,vt(it,Ze,kt(ut._payload),Rt)}if(Qe(ut)||at(ut))return kt!==null?null:_t(it,Ze,ut,Rt,null);Js(it,ut)}return null}function Pt(it,Ze,ut,Rt,kt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return it=it.get(ut)||null,ke(Ze,it,""+Rt,kt);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case Y:return it=it.get(Rt.key===null?ut:Rt.key)||null,Ke(Ze,it,Rt,kt);case H:return it=it.get(Rt.key===null?ut:Rt.key)||null,ct(Ze,it,Rt,kt);case Ie:var Ht=Rt._init;return Pt(it,Ze,ut,Ht(Rt._payload),kt)}if(Qe(Rt)||at(Rt))return it=it.get(ut)||null,_t(Ze,it,Rt,kt,null);Js(Ze,Rt)}return null}function Lt(it,Ze,ut,Rt){for(var kt=null,Ht=null,Ut=Ze,Gt=Ze=0,yr=null;Ut!==null&&Gt<ut.length;Gt++){Ut.index>Gt?(yr=Ut,Ut=null):yr=Ut.sibling;var Xt=vt(it,Ut,ut[Gt],Rt);if(Xt===null){Ut===null&&(Ut=yr);break}d&&Ut&&Xt.alternate===null&&p(it,Ut),Ze=Q(Xt,Ze,Gt),Ht===null?kt=Xt:Ht.sibling=Xt,Ht=Xt,Ut=yr}if(Gt===ut.length)return T(it,Ut),rr&&ti(it,Gt),kt;if(Ut===null){for(;Gt<ut.length;Gt++)Ut=Tt(it,ut[Gt],Rt),Ut!==null&&(Ze=Q(Ut,Ze,Gt),Ht===null?kt=Ut:Ht.sibling=Ut,Ht=Ut);return rr&&ti(it,Gt),kt}for(Ut=N(it,Ut);Gt<ut.length;Gt++)yr=Pt(Ut,it,Gt,ut[Gt],Rt),yr!==null&&(d&&yr.alternate!==null&&Ut.delete(yr.key===null?Gt:yr.key),Ze=Q(yr,Ze,Gt),Ht===null?kt=yr:Ht.sibling=yr,Ht=yr);return d&&Ut.forEach(function(Bn){return p(it,Bn)}),rr&&ti(it,Gt),kt}function $t(it,Ze,ut,Rt){var kt=at(ut);if(typeof kt!="function")throw Error(t(150));if(ut=kt.call(ut),ut==null)throw Error(t(151));for(var Ht=kt=null,Ut=Ze,Gt=Ze=0,yr=null,Xt=ut.next();Ut!==null&&!Xt.done;Gt++,Xt=ut.next()){Ut.index>Gt?(yr=Ut,Ut=null):yr=Ut.sibling;var Bn=vt(it,Ut,Xt.value,Rt);if(Bn===null){Ut===null&&(Ut=yr);break}d&&Ut&&Bn.alternate===null&&p(it,Ut),Ze=Q(Bn,Ze,Gt),Ht===null?kt=Bn:Ht.sibling=Bn,Ht=Bn,Ut=yr}if(Xt.done)return T(it,Ut),rr&&ti(it,Gt),kt;if(Ut===null){for(;!Xt.done;Gt++,Xt=ut.next())Xt=Tt(it,Xt.value,Rt),Xt!==null&&(Ze=Q(Xt,Ze,Gt),Ht===null?kt=Xt:Ht.sibling=Xt,Ht=Xt);return rr&&ti(it,Gt),kt}for(Ut=N(it,Ut);!Xt.done;Gt++,Xt=ut.next())Xt=Pt(Ut,it,Gt,Xt.value,Rt),Xt!==null&&(d&&Xt.alternate!==null&&Ut.delete(Xt.key===null?Gt:Xt.key),Ze=Q(Xt,Ze,Gt),Ht===null?kt=Xt:Ht.sibling=Xt,Ht=Xt);return d&&Ut.forEach(function(md){return p(it,md)}),rr&&ti(it,Gt),kt}function or(it,Ze,ut,Rt){if(typeof ut=="object"&&ut!==null&&ut.type===k&&ut.key===null&&(ut=ut.props.children),typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Y:e:{for(var kt=ut.key,Ht=Ze;Ht!==null;){if(Ht.key===kt){if(kt=ut.type,kt===k){if(Ht.tag===7){T(it,Ht.sibling),Ze=G(Ht,ut.props.children),Ze.return=it,it=Ze;break e}}else if(Ht.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ie&&Zl(kt)===Ht.type){T(it,Ht.sibling),Ze=G(Ht,ut.props),Ze.ref=ps(it,Ht,ut),Ze.return=it,it=Ze;break e}T(it,Ht);break}else p(it,Ht);Ht=Ht.sibling}ut.type===k?(Ze=ui(ut.props.children,it.mode,Rt,ut.key),Ze.return=it,it=Ze):(Rt=Ro(ut.type,ut.key,ut.props,null,it.mode,Rt),Rt.ref=ps(it,Ze,ut),Rt.return=it,it=Rt)}return ge(it);case H:e:{for(Ht=ut.key;Ze!==null;){if(Ze.key===Ht)if(Ze.tag===4&&Ze.stateNode.containerInfo===ut.containerInfo&&Ze.stateNode.implementation===ut.implementation){T(it,Ze.sibling),Ze=G(Ze,ut.children||[]),Ze.return=it,it=Ze;break e}else{T(it,Ze);break}else p(it,Ze);Ze=Ze.sibling}Ze=Cl(ut,it.mode,Rt),Ze.return=it,it=Ze}return ge(it);case Ie:return Ht=ut._init,or(it,Ze,Ht(ut._payload),Rt)}if(Qe(ut))return Lt(it,Ze,ut,Rt);if(at(ut))return $t(it,Ze,ut,Rt);Js(it,ut)}return typeof ut=="string"&&ut!==""||typeof ut=="number"?(ut=""+ut,Ze!==null&&Ze.tag===6?(T(it,Ze.sibling),Ze=G(Ze,ut),Ze.return=it,it=Ze):(T(it,Ze),Ze=El(ut,it.mode,Rt),Ze.return=it,it=Ze),ge(it)):T(it,Ze)}return or}var Hi=Jl(!0),eu=Jl(!1),eo=Pn(null),ro=null,Ui=null,Na=null;function Ia(){Na=Ui=ro=null}function Pa(d){var p=eo.current;er(eo),d._currentValue=p}function Oa(d,p,T){for(;d!==null;){var N=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,N!==null&&(N.childLanes|=p)):N!==null&&(N.childLanes&p)!==p&&(N.childLanes|=p),d===T)break;d=d.return}}function Bi(d,p){ro=d,Na=Ui=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.lanes&p&&(Or=!0),d.firstContext=null)}function Wr(d){var p=d._currentValue;if(Na!==d)if(d={context:d,memoizedValue:p,next:null},Ui===null){if(ro===null)throw Error(t(308));Ui=d,ro.dependencies={lanes:0,firstContext:d}}else Ui=Ui.next=d;return p}var ri=null;function Ma(d){ri===null?ri=[d]:ri.push(d)}function tu(d,p,T,N){var G=p.interleaved;return G===null?(T.next=T,Ma(p)):(T.next=G.next,G.next=T),p.interleaved=T,En(d,N)}function En(d,p){d.lanes|=p;var T=d.alternate;for(T!==null&&(T.lanes|=p),T=d,d=d.return;d!==null;)d.childLanes|=p,T=d.alternate,T!==null&&(T.childLanes|=p),T=d,d=d.return;return T.tag===3?T.stateNode:null}var xn=!1;function xa(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ru(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Cn(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function Fn(d,p,T){var N=d.updateQueue;if(N===null)return null;if(N=N.shared,Kt&2){var G=N.pending;return G===null?p.next=p:(p.next=G.next,G.next=p),N.pending=p,En(d,T)}return G=N.interleaved,G===null?(p.next=p,Ma(N)):(p.next=G.next,G.next=p),N.interleaved=p,En(d,T)}function no(d,p,T){if(p=p.updateQueue,p!==null&&(p=p.shared,(T&4194240)!==0)){var N=p.lanes;N&=d.pendingLanes,T|=N,p.lanes=T,yi(d,T)}}function nu(d,p){var T=d.updateQueue,N=d.alternate;if(N!==null&&(N=N.updateQueue,T===N)){var G=null,Q=null;if(T=T.firstBaseUpdate,T!==null){do{var ge={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};Q===null?G=Q=ge:Q=Q.next=ge,T=T.next}while(T!==null);Q===null?G=Q=p:Q=Q.next=p}else G=Q=p;T={baseState:N.baseState,firstBaseUpdate:G,lastBaseUpdate:Q,shared:N.shared,effects:N.effects},d.updateQueue=T;return}d=T.lastBaseUpdate,d===null?T.firstBaseUpdate=p:d.next=p,T.lastBaseUpdate=p}function io(d,p,T,N){var G=d.updateQueue;xn=!1;var Q=G.firstBaseUpdate,ge=G.lastBaseUpdate,ke=G.shared.pending;if(ke!==null){G.shared.pending=null;var Ke=ke,ct=Ke.next;Ke.next=null,ge===null?Q=ct:ge.next=ct,ge=Ke;var _t=d.alternate;_t!==null&&(_t=_t.updateQueue,ke=_t.lastBaseUpdate,ke!==ge&&(ke===null?_t.firstBaseUpdate=ct:ke.next=ct,_t.lastBaseUpdate=Ke))}if(Q!==null){var Tt=G.baseState;ge=0,_t=ct=Ke=null,ke=Q;do{var vt=ke.lane,Pt=ke.eventTime;if((N&vt)===vt){_t!==null&&(_t=_t.next={eventTime:Pt,lane:0,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null});e:{var Lt=d,$t=ke;switch(vt=p,Pt=T,$t.tag){case 1:if(Lt=$t.payload,typeof Lt=="function"){Tt=Lt.call(Pt,Tt,vt);break e}Tt=Lt;break e;case 3:Lt.flags=Lt.flags&-65537|128;case 0:if(Lt=$t.payload,vt=typeof Lt=="function"?Lt.call(Pt,Tt,vt):Lt,vt==null)break e;Tt=nt({},Tt,vt);break e;case 2:xn=!0}}ke.callback!==null&&ke.lane!==0&&(d.flags|=64,vt=G.effects,vt===null?G.effects=[ke]:vt.push(ke))}else Pt={eventTime:Pt,lane:vt,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null},_t===null?(ct=_t=Pt,Ke=Tt):_t=_t.next=Pt,ge|=vt;if(ke=ke.next,ke===null){if(ke=G.shared.pending,ke===null)break;vt=ke,ke=vt.next,vt.next=null,G.lastBaseUpdate=vt,G.shared.pending=null}}while(!0);if(_t===null&&(Ke=Tt),G.baseState=Ke,G.firstBaseUpdate=ct,G.lastBaseUpdate=_t,p=G.shared.interleaved,p!==null){G=p;do ge|=G.lane,G=G.next;while(G!==p)}else Q===null&&(G.shared.lanes=0);si|=ge,d.lanes=ge,d.memoizedState=Tt}}function iu(d,p,T){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var N=d[p],G=N.callback;if(G!==null){if(N.callback=null,N=T,typeof G!="function")throw Error(t(191,G));G.call(N)}}}var ms={},un=Pn(ms),gs=Pn(ms),ys=Pn(ms);function ni(d){if(d===ms)throw Error(t(174));return d}function Fa(d,p){switch(Zt(ys,p),Zt(gs,d),Zt(un,ms),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:R(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=R(p,d)}er(un),Zt(un,p)}function Vi(){er(un),er(gs),er(ys)}function su(d){ni(ys.current);var p=ni(un.current),T=R(p,d.type);p!==T&&(Zt(gs,d),Zt(un,T))}function La(d){gs.current===d&&(er(un),er(gs))}var nr=Pn(0);function so(d){for(var p=d;p!==null;){if(p.tag===13){var T=p.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if(p.flags&128)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var $a=[];function Da(){for(var d=0;d<$a.length;d++)$a[d]._workInProgressVersionPrimary=null;$a.length=0}var oo=D.ReactCurrentDispatcher,ka=D.ReactCurrentBatchConfig,ii=0,ir=null,dr=null,mr=null,ao=!1,Es=!1,Cs=0,kc=0;function Tr(){throw Error(t(321))}function Ha(d,p){if(p===null)return!1;for(var T=0;T<p.length&&T<d.length;T++)if(!Kr(d[T],p[T]))return!1;return!0}function Ua(d,p,T,N,G,Q){if(ii=Q,ir=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,oo.current=d===null||d.memoizedState===null?Vc:Gc,d=T(N,G),Es){Q=0;do{if(Es=!1,Cs=0,25<=Q)throw Error(t(301));Q+=1,mr=dr=null,p.updateQueue=null,oo.current=Wc,d=T(N,G)}while(Es)}if(oo.current=co,p=dr!==null&&dr.next!==null,ii=0,mr=dr=ir=null,ao=!1,p)throw Error(t(300));return d}function Ba(){var d=Cs!==0;return Cs=0,d}function cn(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?ir.memoizedState=mr=d:mr=mr.next=d,mr}function jr(){if(dr===null){var d=ir.alternate;d=d!==null?d.memoizedState:null}else d=dr.next;var p=mr===null?ir.memoizedState:mr.next;if(p!==null)mr=p,dr=d;else{if(d===null)throw Error(t(310));dr=d,d={memoizedState:dr.memoizedState,baseState:dr.baseState,baseQueue:dr.baseQueue,queue:dr.queue,next:null},mr===null?ir.memoizedState=mr=d:mr=mr.next=d}return mr}function vs(d,p){return typeof p=="function"?p(d):p}function Va(d){var p=jr(),T=p.queue;if(T===null)throw Error(t(311));T.lastRenderedReducer=d;var N=dr,G=N.baseQueue,Q=T.pending;if(Q!==null){if(G!==null){var ge=G.next;G.next=Q.next,Q.next=ge}N.baseQueue=G=Q,T.pending=null}if(G!==null){Q=G.next,N=N.baseState;var ke=ge=null,Ke=null,ct=Q;do{var _t=ct.lane;if((ii&_t)===_t)Ke!==null&&(Ke=Ke.next={lane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),N=ct.hasEagerState?ct.eagerState:d(N,ct.action);else{var Tt={lane:_t,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null};Ke===null?(ke=Ke=Tt,ge=N):Ke=Ke.next=Tt,ir.lanes|=_t,si|=_t}ct=ct.next}while(ct!==null&&ct!==Q);Ke===null?ge=N:Ke.next=ke,Kr(N,p.memoizedState)||(Or=!0),p.memoizedState=N,p.baseState=ge,p.baseQueue=Ke,T.lastRenderedState=N}if(d=T.interleaved,d!==null){G=d;do Q=G.lane,ir.lanes|=Q,si|=Q,G=G.next;while(G!==d)}else G===null&&(T.lanes=0);return[p.memoizedState,T.dispatch]}function Ga(d){var p=jr(),T=p.queue;if(T===null)throw Error(t(311));T.lastRenderedReducer=d;var N=T.dispatch,G=T.pending,Q=p.memoizedState;if(G!==null){T.pending=null;var ge=G=G.next;do Q=d(Q,ge.action),ge=ge.next;while(ge!==G);Kr(Q,p.memoizedState)||(Or=!0),p.memoizedState=Q,p.baseQueue===null&&(p.baseState=Q),T.lastRenderedState=Q}return[Q,N]}function ou(){}function au(d,p){var T=ir,N=jr(),G=p(),Q=!Kr(N.memoizedState,G);if(Q&&(N.memoizedState=G,Or=!0),N=N.queue,Wa(cu.bind(null,T,N,d),[d]),N.getSnapshot!==p||Q||mr!==null&&mr.memoizedState.tag&1){if(T.flags|=2048,_s(9,uu.bind(null,T,N,G,p),void 0,null),gr===null)throw Error(t(349));ii&30||lu(T,p,G)}return G}function lu(d,p,T){d.flags|=16384,d={getSnapshot:p,value:T},p=ir.updateQueue,p===null?(p={lastEffect:null,stores:null},ir.updateQueue=p,p.stores=[d]):(T=p.stores,T===null?p.stores=[d]:T.push(d))}function uu(d,p,T,N){p.value=T,p.getSnapshot=N,du(p)&&hu(d)}function cu(d,p,T){return T(function(){du(p)&&hu(d)})}function du(d){var p=d.getSnapshot;d=d.value;try{var T=p();return!Kr(d,T)}catch{return!0}}function hu(d){var p=En(d,1);p!==null&&en(p,d,1,-1)}function fu(d){var p=cn();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:d},p.queue=d,d=d.dispatch=Bc.bind(null,ir,d),[p.memoizedState,d]}function _s(d,p,T,N){return d={tag:d,create:p,destroy:T,deps:N,next:null},p=ir.updateQueue,p===null?(p={lastEffect:null,stores:null},ir.updateQueue=p,p.lastEffect=d.next=d):(T=p.lastEffect,T===null?p.lastEffect=d.next=d:(N=T.next,T.next=d,d.next=N,p.lastEffect=d)),d}function pu(){return jr().memoizedState}function lo(d,p,T,N){var G=cn();ir.flags|=d,G.memoizedState=_s(1|p,T,void 0,N===void 0?null:N)}function uo(d,p,T,N){var G=jr();N=N===void 0?null:N;var Q=void 0;if(dr!==null){var ge=dr.memoizedState;if(Q=ge.destroy,N!==null&&Ha(N,ge.deps)){G.memoizedState=_s(p,T,Q,N);return}}ir.flags|=d,G.memoizedState=_s(1|p,T,Q,N)}function mu(d,p){return lo(8390656,8,d,p)}function Wa(d,p){return uo(2048,8,d,p)}function gu(d,p){return uo(4,2,d,p)}function yu(d,p){return uo(4,4,d,p)}function Eu(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function Cu(d,p,T){return T=T!=null?T.concat([d]):null,uo(4,4,Eu.bind(null,p,d),T)}function ja(){}function vu(d,p){var T=jr();p=p===void 0?null:p;var N=T.memoizedState;return N!==null&&p!==null&&Ha(p,N[1])?N[0]:(T.memoizedState=[d,p],d)}function _u(d,p){var T=jr();p=p===void 0?null:p;var N=T.memoizedState;return N!==null&&p!==null&&Ha(p,N[1])?N[0]:(d=d(),T.memoizedState=[d,p],d)}function Su(d,p,T){return ii&21?(Kr(T,p)||(T=Ki(),ir.lanes|=T,si|=T,d.baseState=!0),p):(d.baseState&&(d.baseState=!1,Or=!0),d.memoizedState=T)}function Hc(d,p){var T=Wt;Wt=T!==0&&4>T?T:4,d(!0);var N=ka.transition;ka.transition={};try{d(!1),p()}finally{Wt=T,ka.transition=N}}function Tu(){return jr().memoizedState}function Uc(d,p,T){var N=kn(d);if(T={lane:N,action:T,hasEagerState:!1,eagerState:null,next:null},wu(d))Ru(p,T);else if(T=tu(d,p,T,N),T!==null){var G=Nr();en(T,d,N,G),Au(T,p,N)}}function Bc(d,p,T){var N=kn(d),G={lane:N,action:T,hasEagerState:!1,eagerState:null,next:null};if(wu(d))Ru(p,G);else{var Q=d.alternate;if(d.lanes===0&&(Q===null||Q.lanes===0)&&(Q=p.lastRenderedReducer,Q!==null))try{var ge=p.lastRenderedState,ke=Q(ge,T);if(G.hasEagerState=!0,G.eagerState=ke,Kr(ke,ge)){var Ke=p.interleaved;Ke===null?(G.next=G,Ma(p)):(G.next=Ke.next,Ke.next=G),p.interleaved=G;return}}catch{}finally{}T=tu(d,p,G,N),T!==null&&(G=Nr(),en(T,d,N,G),Au(T,p,N))}}function wu(d){var p=d.alternate;return d===ir||p!==null&&p===ir}function Ru(d,p){Es=ao=!0;var T=d.pending;T===null?p.next=p:(p.next=T.next,T.next=p),d.pending=p}function Au(d,p,T){if(T&4194240){var N=p.lanes;N&=d.pendingLanes,T|=N,p.lanes=T,yi(d,T)}}var co={readContext:Wr,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useInsertionEffect:Tr,useLayoutEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useMutableSource:Tr,useSyncExternalStore:Tr,useId:Tr,unstable_isNewReconciler:!1},Vc={readContext:Wr,useCallback:function(d,p){return cn().memoizedState=[d,p===void 0?null:p],d},useContext:Wr,useEffect:mu,useImperativeHandle:function(d,p,T){return T=T!=null?T.concat([d]):null,lo(4194308,4,Eu.bind(null,p,d),T)},useLayoutEffect:function(d,p){return lo(4194308,4,d,p)},useInsertionEffect:function(d,p){return lo(4,2,d,p)},useMemo:function(d,p){var T=cn();return p=p===void 0?null:p,d=d(),T.memoizedState=[d,p],d},useReducer:function(d,p,T){var N=cn();return p=T!==void 0?T(p):p,N.memoizedState=N.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},N.queue=d,d=d.dispatch=Uc.bind(null,ir,d),[N.memoizedState,d]},useRef:function(d){var p=cn();return d={current:d},p.memoizedState=d},useState:fu,useDebugValue:ja,useDeferredValue:function(d){return cn().memoizedState=d},useTransition:function(){var d=fu(!1),p=d[0];return d=Hc.bind(null,d[1]),cn().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,T){var N=ir,G=cn();if(rr){if(T===void 0)throw Error(t(407));T=T()}else{if(T=p(),gr===null)throw Error(t(349));ii&30||lu(N,p,T)}G.memoizedState=T;var Q={value:T,getSnapshot:p};return G.queue=Q,mu(cu.bind(null,N,Q,d),[d]),N.flags|=2048,_s(9,uu.bind(null,N,Q,T,p),void 0,null),T},useId:function(){var d=cn(),p=gr.identifierPrefix;if(rr){var T=yn,N=gn;T=(N&~(1<<32-Er(N)-1)).toString(32)+T,p=":"+p+"R"+T,T=Cs++,0<T&&(p+="H"+T.toString(32)),p+=":"}else T=kc++,p=":"+p+"r"+T.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},Gc={readContext:Wr,useCallback:vu,useContext:Wr,useEffect:Wa,useImperativeHandle:Cu,useInsertionEffect:gu,useLayoutEffect:yu,useMemo:_u,useReducer:Va,useRef:pu,useState:function(){return Va(vs)},useDebugValue:ja,useDeferredValue:function(d){var p=jr();return Su(p,dr.memoizedState,d)},useTransition:function(){var d=Va(vs)[0],p=jr().memoizedState;return[d,p]},useMutableSource:ou,useSyncExternalStore:au,useId:Tu,unstable_isNewReconciler:!1},Wc={readContext:Wr,useCallback:vu,useContext:Wr,useEffect:Wa,useImperativeHandle:Cu,useInsertionEffect:gu,useLayoutEffect:yu,useMemo:_u,useReducer:Ga,useRef:pu,useState:function(){return Ga(vs)},useDebugValue:ja,useDeferredValue:function(d){var p=jr();return dr===null?p.memoizedState=d:Su(p,dr.memoizedState,d)},useTransition:function(){var d=Ga(vs)[0],p=jr().memoizedState;return[d,p]},useMutableSource:ou,useSyncExternalStore:au,useId:Tu,unstable_isNewReconciler:!1};function Qr(d,p){if(d&&d.defaultProps){p=nt({},p),d=d.defaultProps;for(var T in d)p[T]===void 0&&(p[T]=d[T]);return p}return p}function Ya(d,p,T,N){p=d.memoizedState,T=T(N,p),T=T==null?p:nt({},p,T),d.memoizedState=T,d.lanes===0&&(d.updateQueue.baseState=T)}var ho={isMounted:function(d){return(d=d._reactInternals)?De(d)===d:!1},enqueueSetState:function(d,p,T){d=d._reactInternals;var N=Nr(),G=kn(d),Q=Cn(N,G);Q.payload=p,T!=null&&(Q.callback=T),p=Fn(d,Q,G),p!==null&&(en(p,d,G,N),no(p,d,G))},enqueueReplaceState:function(d,p,T){d=d._reactInternals;var N=Nr(),G=kn(d),Q=Cn(N,G);Q.tag=1,Q.payload=p,T!=null&&(Q.callback=T),p=Fn(d,Q,G),p!==null&&(en(p,d,G,N),no(p,d,G))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var T=Nr(),N=kn(d),G=Cn(T,N);G.tag=2,p!=null&&(G.callback=p),p=Fn(d,G,N),p!==null&&(en(p,d,N,T),no(p,d,N))}};function bu(d,p,T,N,G,Q,ge){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(N,Q,ge):p.prototype&&p.prototype.isPureReactComponent?!os(T,N)||!os(G,Q):!0}function Nu(d,p,T){var N=!1,G=On,Q=p.contextType;return typeof Q=="object"&&Q!==null?Q=Wr(Q):(G=Pr(p)?Jn:Sr.current,N=p.contextTypes,Q=(N=N!=null)?Li(d,G):On),p=new p(T,Q),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=ho,d.stateNode=p,p._reactInternals=d,N&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=G,d.__reactInternalMemoizedMaskedChildContext=Q),p}function Iu(d,p,T,N){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(T,N),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(T,N),p.state!==d&&ho.enqueueReplaceState(p,p.state,null)}function za(d,p,T,N){var G=d.stateNode;G.props=T,G.state=d.memoizedState,G.refs={},xa(d);var Q=p.contextType;typeof Q=="object"&&Q!==null?G.context=Wr(Q):(Q=Pr(p)?Jn:Sr.current,G.context=Li(d,Q)),G.state=d.memoizedState,Q=p.getDerivedStateFromProps,typeof Q=="function"&&(Ya(d,p,Q,T),G.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(p=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),p!==G.state&&ho.enqueueReplaceState(G,G.state,null),io(d,T,G,N),G.state=d.memoizedState),typeof G.componentDidMount=="function"&&(d.flags|=4194308)}function Gi(d,p){try{var T="",N=p;do T+=Ae(N),N=N.return;while(N);var G=T}catch(Q){G=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:d,source:p,stack:G,digest:null}}function qa(d,p,T){return{value:d,source:null,stack:T??null,digest:p??null}}function Ka(d,p){try{console.error(p.value)}catch(T){setTimeout(function(){throw T})}}var jc=typeof WeakMap=="function"?WeakMap:Map;function Pu(d,p,T){T=Cn(-1,T),T.tag=3,T.payload={element:null};var N=p.value;return T.callback=function(){Co||(Co=!0,cl=N),Ka(d,p)},T}function Ou(d,p,T){T=Cn(-1,T),T.tag=3;var N=d.type.getDerivedStateFromError;if(typeof N=="function"){var G=p.value;T.payload=function(){return N(G)},T.callback=function(){Ka(d,p)}}var Q=d.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(T.callback=function(){Ka(d,p),typeof N!="function"&&($n===null?$n=new Set([this]):$n.add(this));var ge=p.stack;this.componentDidCatch(p.value,{componentStack:ge!==null?ge:""})}),T}function Mu(d,p,T){var N=d.pingCache;if(N===null){N=d.pingCache=new jc;var G=new Set;N.set(p,G)}else G=N.get(p),G===void 0&&(G=new Set,N.set(p,G));G.has(T)||(G.add(T),d=sd.bind(null,d,p,T),p.then(d,d))}function xu(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function Fu(d,p,T,N,G){return d.mode&1?(d.flags|=65536,d.lanes=G,d):(d===p?d.flags|=65536:(d.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(p=Cn(-1,1),p.tag=2,Fn(T,p,1))),T.lanes|=1),d)}var Yc=D.ReactCurrentOwner,Or=!1;function br(d,p,T,N){p.child=d===null?eu(p,null,T,N):Hi(p,d.child,T,N)}function Lu(d,p,T,N,G){T=T.render;var Q=p.ref;return Bi(p,G),N=Ua(d,p,T,N,Q,G),T=Ba(),d!==null&&!Or?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~G,vn(d,p,G)):(rr&&T&&Ta(p),p.flags|=1,br(d,p,N,G),p.child)}function $u(d,p,T,N,G){if(d===null){var Q=T.type;return typeof Q=="function"&&!yl(Q)&&Q.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(p.tag=15,p.type=Q,Du(d,p,Q,N,G)):(d=Ro(T.type,null,N,p,p.mode,G),d.ref=p.ref,d.return=p,p.child=d)}if(Q=d.child,!(d.lanes&G)){var ge=Q.memoizedProps;if(T=T.compare,T=T!==null?T:os,T(ge,N)&&d.ref===p.ref)return vn(d,p,G)}return p.flags|=1,d=Un(Q,N),d.ref=p.ref,d.return=p,p.child=d}function Du(d,p,T,N,G){if(d!==null){var Q=d.memoizedProps;if(os(Q,N)&&d.ref===p.ref)if(Or=!1,p.pendingProps=N=Q,(d.lanes&G)!==0)d.flags&131072&&(Or=!0);else return p.lanes=d.lanes,vn(d,p,G)}return Xa(d,p,T,N,G)}function ku(d,p,T){var N=p.pendingProps,G=N.children,Q=d!==null?d.memoizedState:null;if(N.mode==="hidden")if(!(p.mode&1))p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(ji,Hr),Hr|=T;else{if(!(T&1073741824))return d=Q!==null?Q.baseLanes|T:T,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,Zt(ji,Hr),Hr|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=Q!==null?Q.baseLanes:T,Zt(ji,Hr),Hr|=N}else Q!==null?(N=Q.baseLanes|T,p.memoizedState=null):N=T,Zt(ji,Hr),Hr|=N;return br(d,p,G,T),p.child}function Hu(d,p){var T=p.ref;(d===null&&T!==null||d!==null&&d.ref!==T)&&(p.flags|=512,p.flags|=2097152)}function Xa(d,p,T,N,G){var Q=Pr(T)?Jn:Sr.current;return Q=Li(p,Q),Bi(p,G),T=Ua(d,p,T,N,Q,G),N=Ba(),d!==null&&!Or?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~G,vn(d,p,G)):(rr&&N&&Ta(p),p.flags|=1,br(d,p,T,G),p.child)}function Uu(d,p,T,N,G){if(Pr(T)){var Q=!0;qs(p)}else Q=!1;if(Bi(p,G),p.stateNode===null)po(d,p),Nu(p,T,N),za(p,T,N,G),N=!0;else if(d===null){var ge=p.stateNode,ke=p.memoizedProps;ge.props=ke;var Ke=ge.context,ct=T.contextType;typeof ct=="object"&&ct!==null?ct=Wr(ct):(ct=Pr(T)?Jn:Sr.current,ct=Li(p,ct));var _t=T.getDerivedStateFromProps,Tt=typeof _t=="function"||typeof ge.getSnapshotBeforeUpdate=="function";Tt||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(ke!==N||Ke!==ct)&&Iu(p,ge,N,ct),xn=!1;var vt=p.memoizedState;ge.state=vt,io(p,N,ge,G),Ke=p.memoizedState,ke!==N||vt!==Ke||Ir.current||xn?(typeof _t=="function"&&(Ya(p,T,_t,N),Ke=p.memoizedState),(ke=xn||bu(p,T,ke,N,vt,Ke,ct))?(Tt||typeof ge.UNSAFE_componentWillMount!="function"&&typeof ge.componentWillMount!="function"||(typeof ge.componentWillMount=="function"&&ge.componentWillMount(),typeof ge.UNSAFE_componentWillMount=="function"&&ge.UNSAFE_componentWillMount()),typeof ge.componentDidMount=="function"&&(p.flags|=4194308)):(typeof ge.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=N,p.memoizedState=Ke),ge.props=N,ge.state=Ke,ge.context=ct,N=ke):(typeof ge.componentDidMount=="function"&&(p.flags|=4194308),N=!1)}else{ge=p.stateNode,ru(d,p),ke=p.memoizedProps,ct=p.type===p.elementType?ke:Qr(p.type,ke),ge.props=ct,Tt=p.pendingProps,vt=ge.context,Ke=T.contextType,typeof Ke=="object"&&Ke!==null?Ke=Wr(Ke):(Ke=Pr(T)?Jn:Sr.current,Ke=Li(p,Ke));var Pt=T.getDerivedStateFromProps;(_t=typeof Pt=="function"||typeof ge.getSnapshotBeforeUpdate=="function")||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(ke!==Tt||vt!==Ke)&&Iu(p,ge,N,Ke),xn=!1,vt=p.memoizedState,ge.state=vt,io(p,N,ge,G);var Lt=p.memoizedState;ke!==Tt||vt!==Lt||Ir.current||xn?(typeof Pt=="function"&&(Ya(p,T,Pt,N),Lt=p.memoizedState),(ct=xn||bu(p,T,ct,N,vt,Lt,Ke)||!1)?(_t||typeof ge.UNSAFE_componentWillUpdate!="function"&&typeof ge.componentWillUpdate!="function"||(typeof ge.componentWillUpdate=="function"&&ge.componentWillUpdate(N,Lt,Ke),typeof ge.UNSAFE_componentWillUpdate=="function"&&ge.UNSAFE_componentWillUpdate(N,Lt,Ke)),typeof ge.componentDidUpdate=="function"&&(p.flags|=4),typeof ge.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof ge.componentDidUpdate!="function"||ke===d.memoizedProps&&vt===d.memoizedState||(p.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||ke===d.memoizedProps&&vt===d.memoizedState||(p.flags|=1024),p.memoizedProps=N,p.memoizedState=Lt),ge.props=N,ge.state=Lt,ge.context=Ke,N=ct):(typeof ge.componentDidUpdate!="function"||ke===d.memoizedProps&&vt===d.memoizedState||(p.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||ke===d.memoizedProps&&vt===d.memoizedState||(p.flags|=1024),N=!1)}return Qa(d,p,T,N,Q,G)}function Qa(d,p,T,N,G,Q){Hu(d,p);var ge=(p.flags&128)!==0;if(!N&&!ge)return G&&jl(p,T,!1),vn(d,p,Q);N=p.stateNode,Yc.current=p;var ke=ge&&typeof T.getDerivedStateFromError!="function"?null:N.render();return p.flags|=1,d!==null&&ge?(p.child=Hi(p,d.child,null,Q),p.child=Hi(p,null,ke,Q)):br(d,p,ke,Q),p.memoizedState=N.state,G&&jl(p,T,!0),p.child}function Bu(d){var p=d.stateNode;p.pendingContext?Gl(d,p.pendingContext,p.pendingContext!==p.context):p.context&&Gl(d,p.context,!1),Fa(d,p.containerInfo)}function Vu(d,p,T,N,G){return ki(),ba(G),p.flags|=256,br(d,p,T,N),p.child}var Za={dehydrated:null,treeContext:null,retryLane:0};function Ja(d){return{baseLanes:d,cachePool:null,transitions:null}}function Gu(d,p,T){var N=p.pendingProps,G=nr.current,Q=!1,ge=(p.flags&128)!==0,ke;if((ke=ge)||(ke=d!==null&&d.memoizedState===null?!1:(G&2)!==0),ke?(Q=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(G|=1),Zt(nr,G&1),d===null)return Aa(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?(p.mode&1?d.data==="$!"?p.lanes=8:p.lanes=1073741824:p.lanes=1,null):(ge=N.children,d=N.fallback,Q?(N=p.mode,Q=p.child,ge={mode:"hidden",children:ge},!(N&1)&&Q!==null?(Q.childLanes=0,Q.pendingProps=ge):Q=Ao(ge,N,0,null),d=ui(d,N,T,null),Q.return=p,d.return=p,Q.sibling=d,p.child=Q,p.child.memoizedState=Ja(T),p.memoizedState=Za,d):el(p,ge));if(G=d.memoizedState,G!==null&&(ke=G.dehydrated,ke!==null))return zc(d,p,ge,N,ke,G,T);if(Q){Q=N.fallback,ge=p.mode,G=d.child,ke=G.sibling;var Ke={mode:"hidden",children:N.children};return!(ge&1)&&p.child!==G?(N=p.child,N.childLanes=0,N.pendingProps=Ke,p.deletions=null):(N=Un(G,Ke),N.subtreeFlags=G.subtreeFlags&14680064),ke!==null?Q=Un(ke,Q):(Q=ui(Q,ge,T,null),Q.flags|=2),Q.return=p,N.return=p,N.sibling=Q,p.child=N,N=Q,Q=p.child,ge=d.child.memoizedState,ge=ge===null?Ja(T):{baseLanes:ge.baseLanes|T,cachePool:null,transitions:ge.transitions},Q.memoizedState=ge,Q.childLanes=d.childLanes&~T,p.memoizedState=Za,N}return Q=d.child,d=Q.sibling,N=Un(Q,{mode:"visible",children:N.children}),!(p.mode&1)&&(N.lanes=T),N.return=p,N.sibling=null,d!==null&&(T=p.deletions,T===null?(p.deletions=[d],p.flags|=16):T.push(d)),p.child=N,p.memoizedState=null,N}function el(d,p){return p=Ao({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function fo(d,p,T,N){return N!==null&&ba(N),Hi(p,d.child,null,T),d=el(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function zc(d,p,T,N,G,Q,ge){if(T)return p.flags&256?(p.flags&=-257,N=qa(Error(t(422))),fo(d,p,ge,N)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(Q=N.fallback,G=p.mode,N=Ao({mode:"visible",children:N.children},G,0,null),Q=ui(Q,G,ge,null),Q.flags|=2,N.return=p,Q.return=p,N.sibling=Q,p.child=N,p.mode&1&&Hi(p,d.child,null,ge),p.child.memoizedState=Ja(ge),p.memoizedState=Za,Q);if(!(p.mode&1))return fo(d,p,ge,null);if(G.data==="$!"){if(N=G.nextSibling&&G.nextSibling.dataset,N)var ke=N.dgst;return N=ke,Q=Error(t(419)),N=qa(Q,N,void 0),fo(d,p,ge,N)}if(ke=(ge&d.childLanes)!==0,Or||ke){if(N=gr,N!==null){switch(ge&-ge){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=G&(N.suspendedLanes|ge)?0:G,G!==0&&G!==Q.retryLane&&(Q.retryLane=G,En(d,G),en(N,d,G,-1))}return gl(),N=qa(Error(t(421))),fo(d,p,ge,N)}return G.data==="$?"?(p.flags|=128,p.child=d.child,p=od.bind(null,d),G._reactRetry=p,null):(d=Q.treeContext,kr=In(G.nextSibling),Dr=p,rr=!0,Xr=null,d!==null&&(Vr[Gr++]=gn,Vr[Gr++]=yn,Vr[Gr++]=ei,gn=d.id,yn=d.overflow,ei=p),p=el(p,N.children),p.flags|=4096,p)}function Wu(d,p,T){d.lanes|=p;var N=d.alternate;N!==null&&(N.lanes|=p),Oa(d.return,p,T)}function tl(d,p,T,N,G){var Q=d.memoizedState;Q===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:N,tail:T,tailMode:G}:(Q.isBackwards=p,Q.rendering=null,Q.renderingStartTime=0,Q.last=N,Q.tail=T,Q.tailMode=G)}function ju(d,p,T){var N=p.pendingProps,G=N.revealOrder,Q=N.tail;if(br(d,p,N.children,T),N=nr.current,N&2)N=N&1|2,p.flags|=128;else{if(d!==null&&d.flags&128)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Wu(d,T,p);else if(d.tag===19)Wu(d,T,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}N&=1}if(Zt(nr,N),!(p.mode&1))p.memoizedState=null;else switch(G){case"forwards":for(T=p.child,G=null;T!==null;)d=T.alternate,d!==null&&so(d)===null&&(G=T),T=T.sibling;T=G,T===null?(G=p.child,p.child=null):(G=T.sibling,T.sibling=null),tl(p,!1,G,T,Q);break;case"backwards":for(T=null,G=p.child,p.child=null;G!==null;){if(d=G.alternate,d!==null&&so(d)===null){p.child=G;break}d=G.sibling,G.sibling=T,T=G,G=d}tl(p,!0,T,null,Q);break;case"together":tl(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function po(d,p){!(p.mode&1)&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function vn(d,p,T){if(d!==null&&(p.dependencies=d.dependencies),si|=p.lanes,!(T&p.childLanes))return null;if(d!==null&&p.child!==d.child)throw Error(t(153));if(p.child!==null){for(d=p.child,T=Un(d,d.pendingProps),p.child=T,T.return=p;d.sibling!==null;)d=d.sibling,T=T.sibling=Un(d,d.pendingProps),T.return=p;T.sibling=null}return p.child}function qc(d,p,T){switch(p.tag){case 3:Bu(p),ki();break;case 5:su(p);break;case 1:Pr(p.type)&&qs(p);break;case 4:Fa(p,p.stateNode.containerInfo);break;case 10:var N=p.type._context,G=p.memoizedProps.value;Zt(eo,N._currentValue),N._currentValue=G;break;case 13:if(N=p.memoizedState,N!==null)return N.dehydrated!==null?(Zt(nr,nr.current&1),p.flags|=128,null):T&p.child.childLanes?Gu(d,p,T):(Zt(nr,nr.current&1),d=vn(d,p,T),d!==null?d.sibling:null);Zt(nr,nr.current&1);break;case 19:if(N=(T&p.childLanes)!==0,d.flags&128){if(N)return ju(d,p,T);p.flags|=128}if(G=p.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),Zt(nr,nr.current),N)break;return null;case 22:case 23:return p.lanes=0,ku(d,p,T)}return vn(d,p,T)}var Yu,rl,zu,qu;Yu=function(d,p){for(var T=p.child;T!==null;){if(T.tag===5||T.tag===6)d.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===p)break;for(;T.sibling===null;){if(T.return===null||T.return===p)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},rl=function(){},zu=function(d,p,T,N){var G=d.memoizedProps;if(G!==N){d=p.stateNode,ni(un.current);var Q=null;switch(T){case"input":G=Fe(d,G),N=Fe(d,N),Q=[];break;case"select":G=nt({},G,{value:void 0}),N=nt({},N,{value:void 0}),Q=[];break;case"textarea":G=St(d,G),N=St(d,N),Q=[];break;default:typeof G.onClick!="function"&&typeof N.onClick=="function"&&(d.onclick=js)}Je(T,N);var ge;T=null;for(ct in G)if(!N.hasOwnProperty(ct)&&G.hasOwnProperty(ct)&&G[ct]!=null)if(ct==="style"){var ke=G[ct];for(ge in ke)ke.hasOwnProperty(ge)&&(T||(T={}),T[ge]="")}else ct!=="dangerouslySetInnerHTML"&&ct!=="children"&&ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&ct!=="autoFocus"&&(s.hasOwnProperty(ct)?Q||(Q=[]):(Q=Q||[]).push(ct,null));for(ct in N){var Ke=N[ct];if(ke=G!=null?G[ct]:void 0,N.hasOwnProperty(ct)&&Ke!==ke&&(Ke!=null||ke!=null))if(ct==="style")if(ke){for(ge in ke)!ke.hasOwnProperty(ge)||Ke&&Ke.hasOwnProperty(ge)||(T||(T={}),T[ge]="");for(ge in Ke)Ke.hasOwnProperty(ge)&&ke[ge]!==Ke[ge]&&(T||(T={}),T[ge]=Ke[ge])}else T||(Q||(Q=[]),Q.push(ct,T)),T=Ke;else ct==="dangerouslySetInnerHTML"?(Ke=Ke?Ke.__html:void 0,ke=ke?ke.__html:void 0,Ke!=null&&ke!==Ke&&(Q=Q||[]).push(ct,Ke)):ct==="children"?typeof Ke!="string"&&typeof Ke!="number"||(Q=Q||[]).push(ct,""+Ke):ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&(s.hasOwnProperty(ct)?(Ke!=null&&ct==="onScroll"&&Jt("scroll",d),Q||ke===Ke||(Q=[])):(Q=Q||[]).push(ct,Ke))}T&&(Q=Q||[]).push("style",T);var ct=Q;(p.updateQueue=ct)&&(p.flags|=4)}},qu=function(d,p,T,N){T!==N&&(p.flags|=4)};function Ss(d,p){if(!rr)switch(d.tailMode){case"hidden":p=d.tail;for(var T=null;p!==null;)p.alternate!==null&&(T=p),p=p.sibling;T===null?d.tail=null:T.sibling=null;break;case"collapsed":T=d.tail;for(var N=null;T!==null;)T.alternate!==null&&(N=T),T=T.sibling;N===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:N.sibling=null}}function wr(d){var p=d.alternate!==null&&d.alternate.child===d.child,T=0,N=0;if(p)for(var G=d.child;G!==null;)T|=G.lanes|G.childLanes,N|=G.subtreeFlags&14680064,N|=G.flags&14680064,G.return=d,G=G.sibling;else for(G=d.child;G!==null;)T|=G.lanes|G.childLanes,N|=G.subtreeFlags,N|=G.flags,G.return=d,G=G.sibling;return d.subtreeFlags|=N,d.childLanes=T,p}function Kc(d,p,T){var N=p.pendingProps;switch(wa(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(p),null;case 1:return Pr(p.type)&&zs(),wr(p),null;case 3:return N=p.stateNode,Vi(),er(Ir),er(Sr),Da(),N.pendingContext&&(N.context=N.pendingContext,N.pendingContext=null),(d===null||d.child===null)&&(Zs(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&!(p.flags&256)||(p.flags|=1024,Xr!==null&&(fl(Xr),Xr=null))),rl(d,p),wr(p),null;case 5:La(p);var G=ni(ys.current);if(T=p.type,d!==null&&p.stateNode!=null)zu(d,p,T,N,G),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!N){if(p.stateNode===null)throw Error(t(166));return wr(p),null}if(d=ni(un.current),Zs(p)){N=p.stateNode,T=p.type;var Q=p.memoizedProps;switch(N[an]=p,N[hs]=Q,d=(p.mode&1)!==0,T){case"dialog":Jt("cancel",N),Jt("close",N);break;case"iframe":case"object":case"embed":Jt("load",N);break;case"video":case"audio":for(G=0;G<us.length;G++)Jt(us[G],N);break;case"source":Jt("error",N);break;case"img":case"image":case"link":Jt("error",N),Jt("load",N);break;case"details":Jt("toggle",N);break;case"input":je(N,Q),Jt("invalid",N);break;case"select":N._wrapperState={wasMultiple:!!Q.multiple},Jt("invalid",N);break;case"textarea":At(N,Q),Jt("invalid",N)}Je(T,Q),G=null;for(var ge in Q)if(Q.hasOwnProperty(ge)){var ke=Q[ge];ge==="children"?typeof ke=="string"?N.textContent!==ke&&(Q.suppressHydrationWarning!==!0&&Ws(N.textContent,ke,d),G=["children",ke]):typeof ke=="number"&&N.textContent!==""+ke&&(Q.suppressHydrationWarning!==!0&&Ws(N.textContent,ke,d),G=["children",""+ke]):s.hasOwnProperty(ge)&&ke!=null&&ge==="onScroll"&&Jt("scroll",N)}switch(T){case"input":pe(N),Xe(N,Q,!0);break;case"textarea":pe(N),X(N);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(N.onclick=js)}N=G,p.updateQueue=N,N!==null&&(p.flags|=4)}else{ge=G.nodeType===9?G:G.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=P(T)),d==="http://www.w3.org/1999/xhtml"?T==="script"?(d=ge.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof N.is=="string"?d=ge.createElement(T,{is:N.is}):(d=ge.createElement(T),T==="select"&&(ge=d,N.multiple?ge.multiple=!0:N.size&&(ge.size=N.size))):d=ge.createElementNS(d,T),d[an]=p,d[hs]=N,Yu(d,p,!1,!1),p.stateNode=d;e:{switch(ge=Be(T,N),T){case"dialog":Jt("cancel",d),Jt("close",d),G=N;break;case"iframe":case"object":case"embed":Jt("load",d),G=N;break;case"video":case"audio":for(G=0;G<us.length;G++)Jt(us[G],d);G=N;break;case"source":Jt("error",d),G=N;break;case"img":case"image":case"link":Jt("error",d),Jt("load",d),G=N;break;case"details":Jt("toggle",d),G=N;break;case"input":je(d,N),G=Fe(d,N),Jt("invalid",d);break;case"option":G=N;break;case"select":d._wrapperState={wasMultiple:!!N.multiple},G=nt({},N,{value:void 0}),Jt("invalid",d);break;case"textarea":At(d,N),G=St(d,N),Jt("invalid",d);break;default:G=N}Je(T,G),ke=G;for(Q in ke)if(ke.hasOwnProperty(Q)){var Ke=ke[Q];Q==="style"?Re(d,Ke):Q==="dangerouslySetInnerHTML"?(Ke=Ke?Ke.__html:void 0,Ke!=null&&Pe(d,Ke)):Q==="children"?typeof Ke=="string"?(T!=="textarea"||Ke!=="")&&Oe(d,Ke):typeof Ke=="number"&&Oe(d,""+Ke):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?Ke!=null&&Q==="onScroll"&&Jt("scroll",d):Ke!=null&&O(d,Q,Ke,ge))}switch(T){case"input":pe(d),Xe(d,N,!1);break;case"textarea":pe(d),X(d);break;case"option":N.value!=null&&d.setAttribute("value",""+be(N.value));break;case"select":d.multiple=!!N.multiple,Q=N.value,Q!=null?st(d,!!N.multiple,Q,!1):N.defaultValue!=null&&st(d,!!N.multiple,N.defaultValue,!0);break;default:typeof G.onClick=="function"&&(d.onclick=js)}switch(T){case"button":case"input":case"select":case"textarea":N=!!N.autoFocus;break e;case"img":N=!0;break e;default:N=!1}}N&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return wr(p),null;case 6:if(d&&p.stateNode!=null)qu(d,p,d.memoizedProps,N);else{if(typeof N!="string"&&p.stateNode===null)throw Error(t(166));if(T=ni(ys.current),ni(un.current),Zs(p)){if(N=p.stateNode,T=p.memoizedProps,N[an]=p,(Q=N.nodeValue!==T)&&(d=Dr,d!==null))switch(d.tag){case 3:Ws(N.nodeValue,T,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Ws(N.nodeValue,T,(d.mode&1)!==0)}Q&&(p.flags|=4)}else N=(T.nodeType===9?T:T.ownerDocument).createTextNode(N),N[an]=p,p.stateNode=N}return wr(p),null;case 13:if(er(nr),N=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(rr&&kr!==null&&p.mode&1&&!(p.flags&128))Ql(),ki(),p.flags|=98560,Q=!1;else if(Q=Zs(p),N!==null&&N.dehydrated!==null){if(d===null){if(!Q)throw Error(t(318));if(Q=p.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(t(317));Q[an]=p}else ki(),!(p.flags&128)&&(p.memoizedState=null),p.flags|=4;wr(p),Q=!1}else Xr!==null&&(fl(Xr),Xr=null),Q=!0;if(!Q)return p.flags&65536?p:null}return p.flags&128?(p.lanes=T,p):(N=N!==null,N!==(d!==null&&d.memoizedState!==null)&&N&&(p.child.flags|=8192,p.mode&1&&(d===null||nr.current&1?hr===0&&(hr=3):gl())),p.updateQueue!==null&&(p.flags|=4),wr(p),null);case 4:return Vi(),rl(d,p),d===null&&cs(p.stateNode.containerInfo),wr(p),null;case 10:return Pa(p.type._context),wr(p),null;case 17:return Pr(p.type)&&zs(),wr(p),null;case 19:if(er(nr),Q=p.memoizedState,Q===null)return wr(p),null;if(N=(p.flags&128)!==0,ge=Q.rendering,ge===null)if(N)Ss(Q,!1);else{if(hr!==0||d!==null&&d.flags&128)for(d=p.child;d!==null;){if(ge=so(d),ge!==null){for(p.flags|=128,Ss(Q,!1),N=ge.updateQueue,N!==null&&(p.updateQueue=N,p.flags|=4),p.subtreeFlags=0,N=T,T=p.child;T!==null;)Q=T,d=N,Q.flags&=14680066,ge=Q.alternate,ge===null?(Q.childLanes=0,Q.lanes=d,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=ge.childLanes,Q.lanes=ge.lanes,Q.child=ge.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=ge.memoizedProps,Q.memoizedState=ge.memoizedState,Q.updateQueue=ge.updateQueue,Q.type=ge.type,d=ge.dependencies,Q.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),T=T.sibling;return Zt(nr,nr.current&1|2),p.child}d=d.sibling}Q.tail!==null&&bt()>Yi&&(p.flags|=128,N=!0,Ss(Q,!1),p.lanes=4194304)}else{if(!N)if(d=so(ge),d!==null){if(p.flags|=128,N=!0,T=d.updateQueue,T!==null&&(p.updateQueue=T,p.flags|=4),Ss(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!ge.alternate&&!rr)return wr(p),null}else 2*bt()-Q.renderingStartTime>Yi&&T!==1073741824&&(p.flags|=128,N=!0,Ss(Q,!1),p.lanes=4194304);Q.isBackwards?(ge.sibling=p.child,p.child=ge):(T=Q.last,T!==null?T.sibling=ge:p.child=ge,Q.last=ge)}return Q.tail!==null?(p=Q.tail,Q.rendering=p,Q.tail=p.sibling,Q.renderingStartTime=bt(),p.sibling=null,T=nr.current,Zt(nr,N?T&1|2:T&1),p):(wr(p),null);case 22:case 23:return ml(),N=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==N&&(p.flags|=8192),N&&p.mode&1?Hr&1073741824&&(wr(p),p.subtreeFlags&6&&(p.flags|=8192)):wr(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function Xc(d,p){switch(wa(p),p.tag){case 1:return Pr(p.type)&&zs(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Vi(),er(Ir),er(Sr),Da(),d=p.flags,d&65536&&!(d&128)?(p.flags=d&-65537|128,p):null;case 5:return La(p),null;case 13:if(er(nr),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(t(340));ki()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return er(nr),null;case 4:return Vi(),null;case 10:return Pa(p.type._context),null;case 22:case 23:return ml(),null;case 24:return null;default:return null}}var mo=!1,Rr=!1,Qc=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function Wi(d,p){var T=d.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(N){sr(d,p,N)}else T.current=null}function nl(d,p,T){try{T()}catch(N){sr(d,p,N)}}var Ku=!1;function Zc(d,p){if(ma=_i,d=bl(),aa(d)){if("selectionStart"in d)var T={start:d.selectionStart,end:d.selectionEnd};else e:{T=(T=d.ownerDocument)&&T.defaultView||window;var N=T.getSelection&&T.getSelection();if(N&&N.rangeCount!==0){T=N.anchorNode;var G=N.anchorOffset,Q=N.focusNode;N=N.focusOffset;try{T.nodeType,Q.nodeType}catch{T=null;break e}var ge=0,ke=-1,Ke=-1,ct=0,_t=0,Tt=d,vt=null;t:for(;;){for(var Pt;Tt!==T||G!==0&&Tt.nodeType!==3||(ke=ge+G),Tt!==Q||N!==0&&Tt.nodeType!==3||(Ke=ge+N),Tt.nodeType===3&&(ge+=Tt.nodeValue.length),(Pt=Tt.firstChild)!==null;)vt=Tt,Tt=Pt;for(;;){if(Tt===d)break t;if(vt===T&&++ct===G&&(ke=ge),vt===Q&&++_t===N&&(Ke=ge),(Pt=Tt.nextSibling)!==null)break;Tt=vt,vt=Tt.parentNode}Tt=Pt}T=ke===-1||Ke===-1?null:{start:ke,end:Ke}}else T=null}T=T||{start:0,end:0}}else T=null;for(ga={focusedElem:d,selectionRange:T},_i=!1,Ft=p;Ft!==null;)if(p=Ft,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,Ft=d;else for(;Ft!==null;){p=Ft;try{var Lt=p.alternate;if(p.flags&1024)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Lt!==null){var $t=Lt.memoizedProps,or=Lt.memoizedState,it=p.stateNode,Ze=it.getSnapshotBeforeUpdate(p.elementType===p.type?$t:Qr(p.type,$t),or);it.__reactInternalSnapshotBeforeUpdate=Ze}break;case 3:var ut=p.stateNode.containerInfo;ut.nodeType===1?ut.textContent="":ut.nodeType===9&&ut.documentElement&&ut.removeChild(ut.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Rt){sr(p,p.return,Rt)}if(d=p.sibling,d!==null){d.return=p.return,Ft=d;break}Ft=p.return}return Lt=Ku,Ku=!1,Lt}function Ts(d,p,T){var N=p.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var G=N=N.next;do{if((G.tag&d)===d){var Q=G.destroy;G.destroy=void 0,Q!==void 0&&nl(p,T,Q)}G=G.next}while(G!==N)}}function go(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var T=p=p.next;do{if((T.tag&d)===d){var N=T.create;T.destroy=N()}T=T.next}while(T!==p)}}function il(d){var p=d.ref;if(p!==null){var T=d.stateNode;switch(d.tag){case 5:d=T;break;default:d=T}typeof p=="function"?p(d):p.current=d}}function Xu(d){var p=d.alternate;p!==null&&(d.alternate=null,Xu(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[an],delete p[hs],delete p[va],delete p[Fc],delete p[Lc])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Qu(d){return d.tag===5||d.tag===3||d.tag===4}function Zu(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Qu(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function sl(d,p,T){var N=d.tag;if(N===5||N===6)d=d.stateNode,p?T.nodeType===8?T.parentNode.insertBefore(d,p):T.insertBefore(d,p):(T.nodeType===8?(p=T.parentNode,p.insertBefore(d,T)):(p=T,p.appendChild(d)),T=T._reactRootContainer,T!=null||p.onclick!==null||(p.onclick=js));else if(N!==4&&(d=d.child,d!==null))for(sl(d,p,T),d=d.sibling;d!==null;)sl(d,p,T),d=d.sibling}function ol(d,p,T){var N=d.tag;if(N===5||N===6)d=d.stateNode,p?T.insertBefore(d,p):T.appendChild(d);else if(N!==4&&(d=d.child,d!==null))for(ol(d,p,T),d=d.sibling;d!==null;)ol(d,p,T),d=d.sibling}var Cr=null,Zr=!1;function Ln(d,p,T){for(T=T.child;T!==null;)Ju(d,p,T),T=T.sibling}function Ju(d,p,T){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(di,T)}catch{}switch(T.tag){case 5:Rr||Wi(T,p);case 6:var N=Cr,G=Zr;Cr=null,Ln(d,p,T),Cr=N,Zr=G,Cr!==null&&(Zr?(d=Cr,T=T.stateNode,d.nodeType===8?d.parentNode.removeChild(T):d.removeChild(T)):Cr.removeChild(T.stateNode));break;case 18:Cr!==null&&(Zr?(d=Cr,T=T.stateNode,d.nodeType===8?Ca(d.parentNode,T):d.nodeType===1&&Ca(d,T),qn(d)):Ca(Cr,T.stateNode));break;case 4:N=Cr,G=Zr,Cr=T.stateNode.containerInfo,Zr=!0,Ln(d,p,T),Cr=N,Zr=G;break;case 0:case 11:case 14:case 15:if(!Rr&&(N=T.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){G=N=N.next;do{var Q=G,ge=Q.destroy;Q=Q.tag,ge!==void 0&&(Q&2||Q&4)&&nl(T,p,ge),G=G.next}while(G!==N)}Ln(d,p,T);break;case 1:if(!Rr&&(Wi(T,p),N=T.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=T.memoizedProps,N.state=T.memoizedState,N.componentWillUnmount()}catch(ke){sr(T,p,ke)}Ln(d,p,T);break;case 21:Ln(d,p,T);break;case 22:T.mode&1?(Rr=(N=Rr)||T.memoizedState!==null,Ln(d,p,T),Rr=N):Ln(d,p,T);break;default:Ln(d,p,T)}}function ec(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var T=d.stateNode;T===null&&(T=d.stateNode=new Qc),p.forEach(function(N){var G=ad.bind(null,d,N);T.has(N)||(T.add(N),N.then(G,G))})}}function Jr(d,p){var T=p.deletions;if(T!==null)for(var N=0;N<T.length;N++){var G=T[N];try{var Q=d,ge=p,ke=ge;e:for(;ke!==null;){switch(ke.tag){case 5:Cr=ke.stateNode,Zr=!1;break e;case 3:Cr=ke.stateNode.containerInfo,Zr=!0;break e;case 4:Cr=ke.stateNode.containerInfo,Zr=!0;break e}ke=ke.return}if(Cr===null)throw Error(t(160));Ju(Q,ge,G),Cr=null,Zr=!1;var Ke=G.alternate;Ke!==null&&(Ke.return=null),G.return=null}catch(ct){sr(G,p,ct)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)tc(p,d),p=p.sibling}function tc(d,p){var T=d.alternate,N=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Jr(p,d),dn(d),N&4){try{Ts(3,d,d.return),go(3,d)}catch($t){sr(d,d.return,$t)}try{Ts(5,d,d.return)}catch($t){sr(d,d.return,$t)}}break;case 1:Jr(p,d),dn(d),N&512&&T!==null&&Wi(T,T.return);break;case 5:if(Jr(p,d),dn(d),N&512&&T!==null&&Wi(T,T.return),d.flags&32){var G=d.stateNode;try{Oe(G,"")}catch($t){sr(d,d.return,$t)}}if(N&4&&(G=d.stateNode,G!=null)){var Q=d.memoizedProps,ge=T!==null?T.memoizedProps:Q,ke=d.type,Ke=d.updateQueue;if(d.updateQueue=null,Ke!==null)try{ke==="input"&&Q.type==="radio"&&Q.name!=null&&rt(G,Q),Be(ke,ge);var ct=Be(ke,Q);for(ge=0;ge<Ke.length;ge+=2){var _t=Ke[ge],Tt=Ke[ge+1];_t==="style"?Re(G,Tt):_t==="dangerouslySetInnerHTML"?Pe(G,Tt):_t==="children"?Oe(G,Tt):O(G,_t,Tt,ct)}switch(ke){case"input":Ue(G,Q);break;case"textarea":j(G,Q);break;case"select":var vt=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!Q.multiple;var Pt=Q.value;Pt!=null?st(G,!!Q.multiple,Pt,!1):vt!==!!Q.multiple&&(Q.defaultValue!=null?st(G,!!Q.multiple,Q.defaultValue,!0):st(G,!!Q.multiple,Q.multiple?[]:"",!1))}G[hs]=Q}catch($t){sr(d,d.return,$t)}}break;case 6:if(Jr(p,d),dn(d),N&4){if(d.stateNode===null)throw Error(t(162));G=d.stateNode,Q=d.memoizedProps;try{G.nodeValue=Q}catch($t){sr(d,d.return,$t)}}break;case 3:if(Jr(p,d),dn(d),N&4&&T!==null&&T.memoizedState.isDehydrated)try{qn(p.containerInfo)}catch($t){sr(d,d.return,$t)}break;case 4:Jr(p,d),dn(d);break;case 13:Jr(p,d),dn(d),G=d.child,G.flags&8192&&(Q=G.memoizedState!==null,G.stateNode.isHidden=Q,!Q||G.alternate!==null&&G.alternate.memoizedState!==null||(ul=bt())),N&4&&ec(d);break;case 22:if(_t=T!==null&&T.memoizedState!==null,d.mode&1?(Rr=(ct=Rr)||_t,Jr(p,d),Rr=ct):Jr(p,d),dn(d),N&8192){if(ct=d.memoizedState!==null,(d.stateNode.isHidden=ct)&&!_t&&d.mode&1)for(Ft=d,_t=d.child;_t!==null;){for(Tt=Ft=_t;Ft!==null;){switch(vt=Ft,Pt=vt.child,vt.tag){case 0:case 11:case 14:case 15:Ts(4,vt,vt.return);break;case 1:Wi(vt,vt.return);var Lt=vt.stateNode;if(typeof Lt.componentWillUnmount=="function"){N=vt,T=vt.return;try{p=N,Lt.props=p.memoizedProps,Lt.state=p.memoizedState,Lt.componentWillUnmount()}catch($t){sr(N,T,$t)}}break;case 5:Wi(vt,vt.return);break;case 22:if(vt.memoizedState!==null){ic(Tt);continue}}Pt!==null?(Pt.return=vt,Ft=Pt):ic(Tt)}_t=_t.sibling}e:for(_t=null,Tt=d;;){if(Tt.tag===5){if(_t===null){_t=Tt;try{G=Tt.stateNode,ct?(Q=G.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(ke=Tt.stateNode,Ke=Tt.memoizedProps.style,ge=Ke!=null&&Ke.hasOwnProperty("display")?Ke.display:null,ke.style.display=fe("display",ge))}catch($t){sr(d,d.return,$t)}}}else if(Tt.tag===6){if(_t===null)try{Tt.stateNode.nodeValue=ct?"":Tt.memoizedProps}catch($t){sr(d,d.return,$t)}}else if((Tt.tag!==22&&Tt.tag!==23||Tt.memoizedState===null||Tt===d)&&Tt.child!==null){Tt.child.return=Tt,Tt=Tt.child;continue}if(Tt===d)break e;for(;Tt.sibling===null;){if(Tt.return===null||Tt.return===d)break e;_t===Tt&&(_t=null),Tt=Tt.return}_t===Tt&&(_t=null),Tt.sibling.return=Tt.return,Tt=Tt.sibling}}break;case 19:Jr(p,d),dn(d),N&4&&ec(d);break;case 21:break;default:Jr(p,d),dn(d)}}function dn(d){var p=d.flags;if(p&2){try{e:{for(var T=d.return;T!==null;){if(Qu(T)){var N=T;break e}T=T.return}throw Error(t(160))}switch(N.tag){case 5:var G=N.stateNode;N.flags&32&&(Oe(G,""),N.flags&=-33);var Q=Zu(d);ol(d,Q,G);break;case 3:case 4:var ge=N.stateNode.containerInfo,ke=Zu(d);sl(d,ke,ge);break;default:throw Error(t(161))}}catch(Ke){sr(d,d.return,Ke)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function Jc(d,p,T){Ft=d,rc(d)}function rc(d,p,T){for(var N=(d.mode&1)!==0;Ft!==null;){var G=Ft,Q=G.child;if(G.tag===22&&N){var ge=G.memoizedState!==null||mo;if(!ge){var ke=G.alternate,Ke=ke!==null&&ke.memoizedState!==null||Rr;ke=mo;var ct=Rr;if(mo=ge,(Rr=Ke)&&!ct)for(Ft=G;Ft!==null;)ge=Ft,Ke=ge.child,ge.tag===22&&ge.memoizedState!==null?sc(G):Ke!==null?(Ke.return=ge,Ft=Ke):sc(G);for(;Q!==null;)Ft=Q,rc(Q),Q=Q.sibling;Ft=G,mo=ke,Rr=ct}nc(d)}else G.subtreeFlags&8772&&Q!==null?(Q.return=G,Ft=Q):nc(d)}}function nc(d){for(;Ft!==null;){var p=Ft;if(p.flags&8772){var T=p.alternate;try{if(p.flags&8772)switch(p.tag){case 0:case 11:case 15:Rr||go(5,p);break;case 1:var N=p.stateNode;if(p.flags&4&&!Rr)if(T===null)N.componentDidMount();else{var G=p.elementType===p.type?T.memoizedProps:Qr(p.type,T.memoizedProps);N.componentDidUpdate(G,T.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var Q=p.updateQueue;Q!==null&&iu(p,Q,N);break;case 3:var ge=p.updateQueue;if(ge!==null){if(T=null,p.child!==null)switch(p.child.tag){case 5:T=p.child.stateNode;break;case 1:T=p.child.stateNode}iu(p,ge,T)}break;case 5:var ke=p.stateNode;if(T===null&&p.flags&4){T=ke;var Ke=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Ke.autoFocus&&T.focus();break;case"img":Ke.src&&(T.src=Ke.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var ct=p.alternate;if(ct!==null){var _t=ct.memoizedState;if(_t!==null){var Tt=_t.dehydrated;Tt!==null&&qn(Tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Rr||p.flags&512&&il(p)}catch(vt){sr(p,p.return,vt)}}if(p===d){Ft=null;break}if(T=p.sibling,T!==null){T.return=p.return,Ft=T;break}Ft=p.return}}function ic(d){for(;Ft!==null;){var p=Ft;if(p===d){Ft=null;break}var T=p.sibling;if(T!==null){T.return=p.return,Ft=T;break}Ft=p.return}}function sc(d){for(;Ft!==null;){var p=Ft;try{switch(p.tag){case 0:case 11:case 15:var T=p.return;try{go(4,p)}catch(Ke){sr(p,T,Ke)}break;case 1:var N=p.stateNode;if(typeof N.componentDidMount=="function"){var G=p.return;try{N.componentDidMount()}catch(Ke){sr(p,G,Ke)}}var Q=p.return;try{il(p)}catch(Ke){sr(p,Q,Ke)}break;case 5:var ge=p.return;try{il(p)}catch(Ke){sr(p,ge,Ke)}}}catch(Ke){sr(p,p.return,Ke)}if(p===d){Ft=null;break}var ke=p.sibling;if(ke!==null){ke.return=p.return,Ft=ke;break}Ft=p.return}}var ed=Math.ceil,yo=D.ReactCurrentDispatcher,al=D.ReactCurrentOwner,Yr=D.ReactCurrentBatchConfig,Kt=0,gr=null,ar=null,vr=0,Hr=0,ji=Pn(0),hr=0,ws=null,si=0,Eo=0,ll=0,Rs=null,Mr=null,ul=0,Yi=1/0,_n=null,Co=!1,cl=null,$n=null,vo=!1,Dn=null,_o=0,As=0,dl=null,So=-1,To=0;function Nr(){return Kt&6?bt():So!==-1?So:So=bt()}function kn(d){return d.mode&1?Kt&2&&vr!==0?vr&-vr:Dc.transition!==null?(To===0&&(To=Ki()),To):(d=Wt,d!==0||(d=window.event,d=d===void 0?16:Fs(d.type)),d):1}function en(d,p,T,N){if(50<As)throw As=0,dl=null,Error(t(185));Tn(d,T,N),(!(Kt&2)||d!==gr)&&(d===gr&&(!(Kt&2)&&(Eo|=T),hr===4&&Hn(d,vr)),xr(d,N),T===1&&Kt===0&&!(p.mode&1)&&(Yi=bt()+500,Ks&&Mn()))}function xr(d,p){var T=d.callbackNode;qi(d,p);var N=Sn(d,d===gr?vr:0);if(N===0)T!==null&&wt(T),d.callbackNode=null,d.callbackPriority=0;else if(p=N&-N,d.callbackPriority!==p){if(T!=null&&wt(T),p===1)d.tag===0?$c(ac.bind(null,d)):Yl(ac.bind(null,d)),Mc(function(){!(Kt&6)&&Mn()}),T=null;else{switch(Ns(N)){case 1:T=fr;break;case 4:T=ur;break;case 16:T=Qt;break;case 536870912:T=Vn;break;default:T=Qt}T=mc(T,oc.bind(null,d))}d.callbackPriority=p,d.callbackNode=T}}function oc(d,p){if(So=-1,To=0,Kt&6)throw Error(t(327));var T=d.callbackNode;if(zi()&&d.callbackNode!==T)return null;var N=Sn(d,d===gr?vr:0);if(N===0)return null;if(N&30||N&d.expiredLanes||p)p=wo(d,N);else{p=N;var G=Kt;Kt|=2;var Q=uc();(gr!==d||vr!==p)&&(_n=null,Yi=bt()+500,ai(d,p));do try{nd();break}catch(ke){lc(d,ke)}while(!0);Ia(),yo.current=Q,Kt=G,ar!==null?p=0:(gr=null,vr=0,p=hr)}if(p!==0){if(p===2&&(G=mi(d),G!==0&&(N=G,p=hl(d,G))),p===1)throw T=ws,ai(d,0),Hn(d,N),xr(d,bt()),T;if(p===6)Hn(d,N);else{if(G=d.current.alternate,!(N&30)&&!td(G)&&(p=wo(d,N),p===2&&(Q=mi(d),Q!==0&&(N=Q,p=hl(d,Q))),p===1))throw T=ws,ai(d,0),Hn(d,N),xr(d,bt()),T;switch(d.finishedWork=G,d.finishedLanes=N,p){case 0:case 1:throw Error(t(345));case 2:li(d,Mr,_n);break;case 3:if(Hn(d,N),(N&130023424)===N&&(p=ul+500-bt(),10<p)){if(Sn(d,0)!==0)break;if(G=d.suspendedLanes,(G&N)!==N){Nr(),d.pingedLanes|=d.suspendedLanes&G;break}d.timeoutHandle=Ea(li.bind(null,d,Mr,_n),p);break}li(d,Mr,_n);break;case 4:if(Hn(d,N),(N&4194240)===N)break;for(p=d.eventTimes,G=-1;0<N;){var ge=31-Er(N);Q=1<<ge,ge=p[ge],ge>G&&(G=ge),N&=~Q}if(N=G,N=bt()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*ed(N/1960))-N,10<N){d.timeoutHandle=Ea(li.bind(null,d,Mr,_n),N);break}li(d,Mr,_n);break;case 5:li(d,Mr,_n);break;default:throw Error(t(329))}}}return xr(d,bt()),d.callbackNode===T?oc.bind(null,d):null}function hl(d,p){var T=Rs;return d.current.memoizedState.isDehydrated&&(ai(d,p).flags|=256),d=wo(d,p),d!==2&&(p=Mr,Mr=T,p!==null&&fl(p)),d}function fl(d){Mr===null?Mr=d:Mr.push.apply(Mr,d)}function td(d){for(var p=d;;){if(p.flags&16384){var T=p.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var N=0;N<T.length;N++){var G=T[N],Q=G.getSnapshot;G=G.value;try{if(!Kr(Q(),G))return!1}catch{return!1}}}if(T=p.child,p.subtreeFlags&16384&&T!==null)T.return=p,p=T;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Hn(d,p){for(p&=~ll,p&=~Eo,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var T=31-Er(p),N=1<<T;d[T]=-1,p&=~N}}function ac(d){if(Kt&6)throw Error(t(327));zi();var p=Sn(d,0);if(!(p&1))return xr(d,bt()),null;var T=wo(d,p);if(d.tag!==0&&T===2){var N=mi(d);N!==0&&(p=N,T=hl(d,N))}if(T===1)throw T=ws,ai(d,0),Hn(d,p),xr(d,bt()),T;if(T===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,li(d,Mr,_n),xr(d,bt()),null}function pl(d,p){var T=Kt;Kt|=1;try{return d(p)}finally{Kt=T,Kt===0&&(Yi=bt()+500,Ks&&Mn())}}function oi(d){Dn!==null&&Dn.tag===0&&!(Kt&6)&&zi();var p=Kt;Kt|=1;var T=Yr.transition,N=Wt;try{if(Yr.transition=null,Wt=1,d)return d()}finally{Wt=N,Yr.transition=T,Kt=p,!(Kt&6)&&Mn()}}function ml(){Hr=ji.current,er(ji)}function ai(d,p){d.finishedWork=null,d.finishedLanes=0;var T=d.timeoutHandle;if(T!==-1&&(d.timeoutHandle=-1,Oc(T)),ar!==null)for(T=ar.return;T!==null;){var N=T;switch(wa(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&zs();break;case 3:Vi(),er(Ir),er(Sr),Da();break;case 5:La(N);break;case 4:Vi();break;case 13:er(nr);break;case 19:er(nr);break;case 10:Pa(N.type._context);break;case 22:case 23:ml()}T=T.return}if(gr=d,ar=d=Un(d.current,null),vr=Hr=p,hr=0,ws=null,ll=Eo=si=0,Mr=Rs=null,ri!==null){for(p=0;p<ri.length;p++)if(T=ri[p],N=T.interleaved,N!==null){T.interleaved=null;var G=N.next,Q=T.pending;if(Q!==null){var ge=Q.next;Q.next=G,N.next=ge}T.pending=N}ri=null}return d}function lc(d,p){do{var T=ar;try{if(Ia(),oo.current=co,ao){for(var N=ir.memoizedState;N!==null;){var G=N.queue;G!==null&&(G.pending=null),N=N.next}ao=!1}if(ii=0,mr=dr=ir=null,Es=!1,Cs=0,al.current=null,T===null||T.return===null){hr=1,ws=p,ar=null;break}e:{var Q=d,ge=T.return,ke=T,Ke=p;if(p=vr,ke.flags|=32768,Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var ct=Ke,_t=ke,Tt=_t.tag;if(!(_t.mode&1)&&(Tt===0||Tt===11||Tt===15)){var vt=_t.alternate;vt?(_t.updateQueue=vt.updateQueue,_t.memoizedState=vt.memoizedState,_t.lanes=vt.lanes):(_t.updateQueue=null,_t.memoizedState=null)}var Pt=xu(ge);if(Pt!==null){Pt.flags&=-257,Fu(Pt,ge,ke,Q,p),Pt.mode&1&&Mu(Q,ct,p),p=Pt,Ke=ct;var Lt=p.updateQueue;if(Lt===null){var $t=new Set;$t.add(Ke),p.updateQueue=$t}else Lt.add(Ke);break e}else{if(!(p&1)){Mu(Q,ct,p),gl();break e}Ke=Error(t(426))}}else if(rr&&ke.mode&1){var or=xu(ge);if(or!==null){!(or.flags&65536)&&(or.flags|=256),Fu(or,ge,ke,Q,p),ba(Gi(Ke,ke));break e}}Q=Ke=Gi(Ke,ke),hr!==4&&(hr=2),Rs===null?Rs=[Q]:Rs.push(Q),Q=ge;do{switch(Q.tag){case 3:Q.flags|=65536,p&=-p,Q.lanes|=p;var it=Pu(Q,Ke,p);nu(Q,it);break e;case 1:ke=Ke;var Ze=Q.type,ut=Q.stateNode;if(!(Q.flags&128)&&(typeof Ze.getDerivedStateFromError=="function"||ut!==null&&typeof ut.componentDidCatch=="function"&&($n===null||!$n.has(ut)))){Q.flags|=65536,p&=-p,Q.lanes|=p;var Rt=Ou(Q,ke,p);nu(Q,Rt);break e}}Q=Q.return}while(Q!==null)}dc(T)}catch(kt){p=kt,ar===T&&T!==null&&(ar=T=T.return);continue}break}while(!0)}function uc(){var d=yo.current;return yo.current=co,d===null?co:d}function gl(){(hr===0||hr===3||hr===2)&&(hr=4),gr===null||!(si&268435455)&&!(Eo&268435455)||Hn(gr,vr)}function wo(d,p){var T=Kt;Kt|=2;var N=uc();(gr!==d||vr!==p)&&(_n=null,ai(d,p));do try{rd();break}catch(G){lc(d,G)}while(!0);if(Ia(),Kt=T,yo.current=N,ar!==null)throw Error(t(261));return gr=null,vr=0,hr}function rd(){for(;ar!==null;)cc(ar)}function nd(){for(;ar!==null&&!Ot();)cc(ar)}function cc(d){var p=pc(d.alternate,d,Hr);d.memoizedProps=d.pendingProps,p===null?dc(d):ar=p,al.current=null}function dc(d){var p=d;do{var T=p.alternate;if(d=p.return,p.flags&32768){if(T=Xc(T,p),T!==null){T.flags&=32767,ar=T;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{hr=6,ar=null;return}}else if(T=Kc(T,p,Hr),T!==null){ar=T;return}if(p=p.sibling,p!==null){ar=p;return}ar=p=d}while(p!==null);hr===0&&(hr=5)}function li(d,p,T){var N=Wt,G=Yr.transition;try{Yr.transition=null,Wt=1,id(d,p,T,N)}finally{Yr.transition=G,Wt=N}return null}function id(d,p,T,N){do zi();while(Dn!==null);if(Kt&6)throw Error(t(327));T=d.finishedWork;var G=d.finishedLanes;if(T===null)return null;if(d.finishedWork=null,d.finishedLanes=0,T===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var Q=T.lanes|T.childLanes;if(xo(d,Q),d===gr&&(ar=gr=null,vr=0),!(T.subtreeFlags&2064)&&!(T.flags&2064)||vo||(vo=!0,mc(Qt,function(){return zi(),null})),Q=(T.flags&15990)!==0,T.subtreeFlags&15990||Q){Q=Yr.transition,Yr.transition=null;var ge=Wt;Wt=1;var ke=Kt;Kt|=4,al.current=null,Zc(d,T),tc(T,d),wc(ga),_i=!!ma,ga=ma=null,d.current=T,Jc(T),Bt(),Kt=ke,Wt=ge,Yr.transition=Q}else d.current=T;if(vo&&(vo=!1,Dn=d,_o=G),Q=d.pendingLanes,Q===0&&($n=null),hi(T.stateNode),xr(d,bt()),p!==null)for(N=d.onRecoverableError,T=0;T<p.length;T++)G=p[T],N(G.value,{componentStack:G.stack,digest:G.digest});if(Co)throw Co=!1,d=cl,cl=null,d;return _o&1&&d.tag!==0&&zi(),Q=d.pendingLanes,Q&1?d===dl?As++:(As=0,dl=d):As=0,Mn(),null}function zi(){if(Dn!==null){var d=Ns(_o),p=Yr.transition,T=Wt;try{if(Yr.transition=null,Wt=16>d?16:d,Dn===null)var N=!1;else{if(d=Dn,Dn=null,_o=0,Kt&6)throw Error(t(331));var G=Kt;for(Kt|=4,Ft=d.current;Ft!==null;){var Q=Ft,ge=Q.child;if(Ft.flags&16){var ke=Q.deletions;if(ke!==null){for(var Ke=0;Ke<ke.length;Ke++){var ct=ke[Ke];for(Ft=ct;Ft!==null;){var _t=Ft;switch(_t.tag){case 0:case 11:case 15:Ts(8,_t,Q)}var Tt=_t.child;if(Tt!==null)Tt.return=_t,Ft=Tt;else for(;Ft!==null;){_t=Ft;var vt=_t.sibling,Pt=_t.return;if(Xu(_t),_t===ct){Ft=null;break}if(vt!==null){vt.return=Pt,Ft=vt;break}Ft=Pt}}}var Lt=Q.alternate;if(Lt!==null){var $t=Lt.child;if($t!==null){Lt.child=null;do{var or=$t.sibling;$t.sibling=null,$t=or}while($t!==null)}}Ft=Q}}if(Q.subtreeFlags&2064&&ge!==null)ge.return=Q,Ft=ge;else e:for(;Ft!==null;){if(Q=Ft,Q.flags&2048)switch(Q.tag){case 0:case 11:case 15:Ts(9,Q,Q.return)}var it=Q.sibling;if(it!==null){it.return=Q.return,Ft=it;break e}Ft=Q.return}}var Ze=d.current;for(Ft=Ze;Ft!==null;){ge=Ft;var ut=ge.child;if(ge.subtreeFlags&2064&&ut!==null)ut.return=ge,Ft=ut;else e:for(ge=Ze;Ft!==null;){if(ke=Ft,ke.flags&2048)try{switch(ke.tag){case 0:case 11:case 15:go(9,ke)}}catch(kt){sr(ke,ke.return,kt)}if(ke===ge){Ft=null;break e}var Rt=ke.sibling;if(Rt!==null){Rt.return=ke.return,Ft=Rt;break e}Ft=ke.return}}if(Kt=G,Mn(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(di,d)}catch{}N=!0}return N}finally{Wt=T,Yr.transition=p}}return!1}function hc(d,p,T){p=Gi(T,p),p=Pu(d,p,1),d=Fn(d,p,1),p=Nr(),d!==null&&(Tn(d,1,p),xr(d,p))}function sr(d,p,T){if(d.tag===3)hc(d,d,T);else for(;p!==null;){if(p.tag===3){hc(p,d,T);break}else if(p.tag===1){var N=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&($n===null||!$n.has(N))){d=Gi(T,d),d=Ou(p,d,1),p=Fn(p,d,1),d=Nr(),p!==null&&(Tn(p,1,d),xr(p,d));break}}p=p.return}}function sd(d,p,T){var N=d.pingCache;N!==null&&N.delete(p),p=Nr(),d.pingedLanes|=d.suspendedLanes&T,gr===d&&(vr&T)===T&&(hr===4||hr===3&&(vr&130023424)===vr&&500>bt()-ul?ai(d,0):ll|=T),xr(d,p)}function fc(d,p){p===0&&(d.mode&1?(p=fn,fn<<=1,!(fn&130023424)&&(fn=4194304)):p=1);var T=Nr();d=En(d,p),d!==null&&(Tn(d,p,T),xr(d,T))}function od(d){var p=d.memoizedState,T=0;p!==null&&(T=p.retryLane),fc(d,T)}function ad(d,p){var T=0;switch(d.tag){case 13:var N=d.stateNode,G=d.memoizedState;G!==null&&(T=G.retryLane);break;case 19:N=d.stateNode;break;default:throw Error(t(314))}N!==null&&N.delete(p),fc(d,T)}var pc;pc=function(d,p,T){if(d!==null)if(d.memoizedProps!==p.pendingProps||Ir.current)Or=!0;else{if(!(d.lanes&T)&&!(p.flags&128))return Or=!1,qc(d,p,T);Or=!!(d.flags&131072)}else Or=!1,rr&&p.flags&1048576&&zl(p,Qs,p.index);switch(p.lanes=0,p.tag){case 2:var N=p.type;po(d,p),d=p.pendingProps;var G=Li(p,Sr.current);Bi(p,T),G=Ua(null,p,N,d,G,T);var Q=Ba();return p.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Pr(N)?(Q=!0,qs(p)):Q=!1,p.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,xa(p),G.updater=ho,p.stateNode=G,G._reactInternals=p,za(p,N,d,T),p=Qa(null,p,N,!0,Q,T)):(p.tag=0,rr&&Q&&Ta(p),br(null,p,G,T),p=p.child),p;case 16:N=p.elementType;e:{switch(po(d,p),d=p.pendingProps,G=N._init,N=G(N._payload),p.type=N,G=p.tag=ud(N),d=Qr(N,d),G){case 0:p=Xa(null,p,N,d,T);break e;case 1:p=Uu(null,p,N,d,T);break e;case 11:p=Lu(null,p,N,d,T);break e;case 14:p=$u(null,p,N,Qr(N.type,d),T);break e}throw Error(t(306,N,""))}return p;case 0:return N=p.type,G=p.pendingProps,G=p.elementType===N?G:Qr(N,G),Xa(d,p,N,G,T);case 1:return N=p.type,G=p.pendingProps,G=p.elementType===N?G:Qr(N,G),Uu(d,p,N,G,T);case 3:e:{if(Bu(p),d===null)throw Error(t(387));N=p.pendingProps,Q=p.memoizedState,G=Q.element,ru(d,p),io(p,N,null,T);var ge=p.memoizedState;if(N=ge.element,Q.isDehydrated)if(Q={element:N,isDehydrated:!1,cache:ge.cache,pendingSuspenseBoundaries:ge.pendingSuspenseBoundaries,transitions:ge.transitions},p.updateQueue.baseState=Q,p.memoizedState=Q,p.flags&256){G=Gi(Error(t(423)),p),p=Vu(d,p,N,T,G);break e}else if(N!==G){G=Gi(Error(t(424)),p),p=Vu(d,p,N,T,G);break e}else for(kr=In(p.stateNode.containerInfo.firstChild),Dr=p,rr=!0,Xr=null,T=eu(p,null,N,T),p.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(ki(),N===G){p=vn(d,p,T);break e}br(d,p,N,T)}p=p.child}return p;case 5:return su(p),d===null&&Aa(p),N=p.type,G=p.pendingProps,Q=d!==null?d.memoizedProps:null,ge=G.children,ya(N,G)?ge=null:Q!==null&&ya(N,Q)&&(p.flags|=32),Hu(d,p),br(d,p,ge,T),p.child;case 6:return d===null&&Aa(p),null;case 13:return Gu(d,p,T);case 4:return Fa(p,p.stateNode.containerInfo),N=p.pendingProps,d===null?p.child=Hi(p,null,N,T):br(d,p,N,T),p.child;case 11:return N=p.type,G=p.pendingProps,G=p.elementType===N?G:Qr(N,G),Lu(d,p,N,G,T);case 7:return br(d,p,p.pendingProps,T),p.child;case 8:return br(d,p,p.pendingProps.children,T),p.child;case 12:return br(d,p,p.pendingProps.children,T),p.child;case 10:e:{if(N=p.type._context,G=p.pendingProps,Q=p.memoizedProps,ge=G.value,Zt(eo,N._currentValue),N._currentValue=ge,Q!==null)if(Kr(Q.value,ge)){if(Q.children===G.children&&!Ir.current){p=vn(d,p,T);break e}}else for(Q=p.child,Q!==null&&(Q.return=p);Q!==null;){var ke=Q.dependencies;if(ke!==null){ge=Q.child;for(var Ke=ke.firstContext;Ke!==null;){if(Ke.context===N){if(Q.tag===1){Ke=Cn(-1,T&-T),Ke.tag=2;var ct=Q.updateQueue;if(ct!==null){ct=ct.shared;var _t=ct.pending;_t===null?Ke.next=Ke:(Ke.next=_t.next,_t.next=Ke),ct.pending=Ke}}Q.lanes|=T,Ke=Q.alternate,Ke!==null&&(Ke.lanes|=T),Oa(Q.return,T,p),ke.lanes|=T;break}Ke=Ke.next}}else if(Q.tag===10)ge=Q.type===p.type?null:Q.child;else if(Q.tag===18){if(ge=Q.return,ge===null)throw Error(t(341));ge.lanes|=T,ke=ge.alternate,ke!==null&&(ke.lanes|=T),Oa(ge,T,p),ge=Q.sibling}else ge=Q.child;if(ge!==null)ge.return=Q;else for(ge=Q;ge!==null;){if(ge===p){ge=null;break}if(Q=ge.sibling,Q!==null){Q.return=ge.return,ge=Q;break}ge=ge.return}Q=ge}br(d,p,G.children,T),p=p.child}return p;case 9:return G=p.type,N=p.pendingProps.children,Bi(p,T),G=Wr(G),N=N(G),p.flags|=1,br(d,p,N,T),p.child;case 14:return N=p.type,G=Qr(N,p.pendingProps),G=Qr(N.type,G),$u(d,p,N,G,T);case 15:return Du(d,p,p.type,p.pendingProps,T);case 17:return N=p.type,G=p.pendingProps,G=p.elementType===N?G:Qr(N,G),po(d,p),p.tag=1,Pr(N)?(d=!0,qs(p)):d=!1,Bi(p,T),Nu(p,N,G),za(p,N,G,T),Qa(null,p,N,!0,d,T);case 19:return ju(d,p,T);case 22:return ku(d,p,T)}throw Error(t(156,p.tag))};function mc(d,p){return dt(d,p)}function ld(d,p,T,N){this.tag=d,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(d,p,T,N){return new ld(d,p,T,N)}function yl(d){return d=d.prototype,!(!d||!d.isReactComponent)}function ud(d){if(typeof d=="function")return yl(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Le)return 11;if(d===xe)return 14}return 2}function Un(d,p){var T=d.alternate;return T===null?(T=zr(d.tag,p,d.key,d.mode),T.elementType=d.elementType,T.type=d.type,T.stateNode=d.stateNode,T.alternate=d,d.alternate=T):(T.pendingProps=p,T.type=d.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=d.flags&14680064,T.childLanes=d.childLanes,T.lanes=d.lanes,T.child=d.child,T.memoizedProps=d.memoizedProps,T.memoizedState=d.memoizedState,T.updateQueue=d.updateQueue,p=d.dependencies,T.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},T.sibling=d.sibling,T.index=d.index,T.ref=d.ref,T}function Ro(d,p,T,N,G,Q){var ge=2;if(N=d,typeof d=="function")yl(d)&&(ge=1);else if(typeof d=="string")ge=5;else e:switch(d){case k:return ui(T.children,G,Q,p);case K:ge=8,G|=8;break;case se:return d=zr(12,T,p,G|2),d.elementType=se,d.lanes=Q,d;case he:return d=zr(13,T,p,G),d.elementType=he,d.lanes=Q,d;case ve:return d=zr(19,T,p,G),d.elementType=ve,d.lanes=Q,d;case we:return Ao(T,G,Q,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case re:ge=10;break e;case Ce:ge=9;break e;case Le:ge=11;break e;case xe:ge=14;break e;case Ie:ge=16,N=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return p=zr(ge,T,p,G),p.elementType=d,p.type=N,p.lanes=Q,p}function ui(d,p,T,N){return d=zr(7,d,N,p),d.lanes=T,d}function Ao(d,p,T,N){return d=zr(22,d,N,p),d.elementType=we,d.lanes=T,d.stateNode={isHidden:!1},d}function El(d,p,T){return d=zr(6,d,null,p),d.lanes=T,d}function Cl(d,p,T){return p=zr(4,d.children!==null?d.children:[],d.key,p),p.lanes=T,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function cd(d,p,T,N,G){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gi(0),this.expirationTimes=gi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.identifierPrefix=N,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function vl(d,p,T,N,G,Q,ge,ke,Ke){return d=new cd(d,p,T,ke,Ke),p===1?(p=1,Q===!0&&(p|=8)):p=0,Q=zr(3,null,null,p),d.current=Q,Q.stateNode=d,Q.memoizedState={element:N,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},xa(Q),d}function dd(d,p,T){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:N==null?null:""+N,children:d,containerInfo:p,implementation:T}}function gc(d){if(!d)return On;d=d._reactInternals;e:{if(De(d)!==d||d.tag!==1)throw Error(t(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Pr(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(d.tag===1){var T=d.type;if(Pr(T))return Wl(d,T,p)}return p}function yc(d,p,T,N,G,Q,ge,ke,Ke){return d=vl(T,N,!0,d,G,Q,ge,ke,Ke),d.context=gc(null),T=d.current,N=Nr(),G=kn(T),Q=Cn(N,G),Q.callback=p??null,Fn(T,Q,G),d.current.lanes=G,Tn(d,G,N),xr(d,N),d}function bo(d,p,T,N){var G=p.current,Q=Nr(),ge=kn(G);return T=gc(T),p.context===null?p.context=T:p.pendingContext=T,p=Cn(Q,ge),p.payload={element:d},N=N===void 0?null:N,N!==null&&(p.callback=N),d=Fn(G,p,ge),d!==null&&(en(d,G,ge,Q),no(d,G,ge)),ge}function No(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function Ec(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var T=d.retryLane;d.retryLane=T!==0&&T<p?T:p}}function _l(d,p){Ec(d,p),(d=d.alternate)&&Ec(d,p)}var Cc=typeof reportError=="function"?reportError:function(d){console.error(d)};function Sl(d){this._internalRoot=d}Io.prototype.render=Sl.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(t(409));bo(d,p,null,null)},Io.prototype.unmount=Sl.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;oi(function(){bo(null,d,null,null)}),p[pn]=null}};function Io(d){this._internalRoot=d}Io.prototype.unstable_scheduleHydration=function(d){if(d){var p=Ei();d={blockedOn:null,target:d,priority:p};for(var T=0;T<$r.length&&p!==0&&p<$r[T].priority;T++);$r.splice(T,0,d),T===0&&Ms(d)}};function Tl(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Po(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function vc(){}function hd(d,p,T,N,G){if(G){if(typeof N=="function"){var Q=N;N=function(){var ct=No(ge);Q.call(ct)}}var ge=yc(p,N,d,0,null,!1,!1,"",vc);return d._reactRootContainer=ge,d[pn]=ge.current,cs(d.nodeType===8?d.parentNode:d),oi(),ge}for(;G=d.lastChild;)d.removeChild(G);if(typeof N=="function"){var ke=N;N=function(){var ct=No(Ke);ke.call(ct)}}var Ke=vl(d,0,!1,null,null,!1,!1,"",vc);return d._reactRootContainer=Ke,d[pn]=Ke.current,cs(d.nodeType===8?d.parentNode:d),oi(function(){bo(p,Ke,T,N)}),Ke}function Oo(d,p,T,N,G){var Q=T._reactRootContainer;if(Q){var ge=Q;if(typeof G=="function"){var ke=G;G=function(){var Ke=No(ge);ke.call(Ke)}}bo(p,ge,d,G)}else ge=hd(T,p,d,G,N);return No(ge)}Is=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var T=rn(p.pendingLanes);T!==0&&(yi(p,T|1),xr(p,bt()),!(Kt&6)&&(Yi=bt()+500,Mn()))}break;case 13:oi(function(){var N=En(d,1);if(N!==null){var G=Nr();en(N,d,1,G)}}),_l(d,1)}},Wn=function(d){if(d.tag===13){var p=En(d,134217728);if(p!==null){var T=Nr();en(p,d,134217728,T)}_l(d,134217728)}},cr=function(d){if(d.tag===13){var p=kn(d),T=En(d,p);if(T!==null){var N=Nr();en(T,d,p,N)}_l(d,p)}},Ei=function(){return Wt},Ci=function(d,p){var T=Wt;try{return Wt=d,p()}finally{Wt=T}},b=function(d,p,T){switch(p){case"input":if(Ue(d,T),p=T.name,T.type==="radio"&&p!=null){for(T=d;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<T.length;p++){var N=T[p];if(N!==d&&N.form===d.form){var G=Ys(N);if(!G)throw Error(t(90));Se(N),Ue(N,G)}}}break;case"textarea":j(d,T);break;case"select":p=T.value,p!=null&&st(d,!!T.multiple,p,!1)}},_e=pl,J=oi;var fd={usingClientEntryPoint:!1,Events:[fs,xi,Ys,z,ie,pl]},bs={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pd={bundleType:bs.bundleType,version:bs.version,rendererPackageName:bs.rendererPackageName,rendererConfig:bs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=pt(d),d===null?null:d.stateNode},findFiberByHostInstance:bs.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mo.isDisabled&&Mo.supportsFiber)try{di=Mo.inject(pd),Ur=Mo}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fd,reactDom_production_min.createPortal=function(d,p){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tl(p))throw Error(t(200));return dd(d,p,null,T)},reactDom_production_min.createRoot=function(d,p){if(!Tl(d))throw Error(t(299));var T=!1,N="",G=Cc;return p!=null&&(p.unstable_strictMode===!0&&(T=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),p=vl(d,1,!1,null,null,T,!1,N,G),d[pn]=p.current,cs(d.nodeType===8?d.parentNode:d),new Sl(p)},reactDom_production_min.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=pt(p),d=d===null?null:d.stateNode,d},reactDom_production_min.flushSync=function(d){return oi(d)},reactDom_production_min.hydrate=function(d,p,T){if(!Po(p))throw Error(t(200));return Oo(null,d,p,!0,T)},reactDom_production_min.hydrateRoot=function(d,p,T){if(!Tl(d))throw Error(t(405));var N=T!=null&&T.hydratedSources||null,G=!1,Q="",ge=Cc;if(T!=null&&(T.unstable_strictMode===!0&&(G=!0),T.identifierPrefix!==void 0&&(Q=T.identifierPrefix),T.onRecoverableError!==void 0&&(ge=T.onRecoverableError)),p=yc(p,null,d,1,T??null,G,!1,Q,ge),d[pn]=p.current,cs(d),N)for(d=0;d<N.length;d++)T=N[d],G=T._getVersion,G=G(T._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[T,G]:p.mutableSourceEagerHydrationData.push(T,G);return new Io(p)},reactDom_production_min.render=function(d,p,T){if(!Po(p))throw Error(t(200));return Oo(null,d,p,!1,T)},reactDom_production_min.unmountComponentAtNode=function(d){if(!Po(d))throw Error(t(40));return d._reactRootContainer?(oi(function(){Oo(null,null,d,!1,function(){d._reactRootContainer=null,d[pn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=pl,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(d,p,T,N){if(!Po(T))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return Oo(d,p,T,!1,N)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient(),es_error_cause={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var r=function(e){return e&&e.Math===Math&&e};return globalThis_1=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof commonjsGlobal$1=="object"&&commonjsGlobal$1)||r(typeof globalThis_1=="object"&&globalThis_1)||function(){return this}()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(r){try{return!!r()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var r=requireFails();return descriptors=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var r=requireFails();return functionBindNative=!r(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var r=requireFunctionBindNative(),e=Function.prototype.call;return functionCall=r?e.bind(e):function(){return e.apply(e,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var r={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!r.call({1:2},1);return objectPropertyIsEnumerable.f=t?function(s){var o=e(this,s);return!!o&&o.enumerable}:r,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var r=requireFunctionBindNative(),e=Function.prototype,t=e.call,n=r&&e.bind.bind(t,t);return functionUncurryThis=r?n:function(s){return function(){return t.apply(s,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var r=requireFunctionUncurryThis(),e=r({}.toString),t=r("".slice);return classofRaw=function(n){return t(e(n),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var r=requireFunctionUncurryThis(),e=requireFails(),t=requireClassofRaw(),n=Object,s=r("".split);return indexedObject=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return t(o)==="String"?s(o,""):n(o)}:n,indexedObject}var isNullOrUndefined,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined=function(r){return r==null}),isNullOrUndefined}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var r=requireIsNullOrUndefined(),e=TypeError;return requireObjectCoercible=function(t){if(r(t))throw new e("Can't call method on "+t);return t},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var r=requireIndexedObject(),e=requireRequireObjectCoercible();return toIndexedObject=function(t){return r(e(t))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var r=typeof document=="object"&&document.all;return isCallable=typeof r>"u"&&r!==void 0?function(e){return typeof e=="function"||e===r}:function(e){return typeof e=="function"},isCallable}var isObject$3,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject$3;hasRequiredIsObject=1;var r=requireIsCallable();return isObject$3=function(e){return typeof e=="object"?e!==null:r(e)},isObject$3}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var r=requireGlobalThis(),e=requireIsCallable(),t=function(n){return e(n)?n:void 0};return getBuiltIn=function(n,s){return arguments.length<2?t(r[n]):r[n]&&r[n][s]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var r=requireFunctionUncurryThis();return objectIsPrototypeOf=r({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var r=requireGlobalThis(),e=r.navigator,t=e&&e.userAgent;return environmentUserAgent=t?String(t):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var r=requireGlobalThis(),e=requireEnvironmentUserAgent(),t=r.process,n=r.Deno,s=t&&t.versions||n&&n.version,o=s&&s.v8,a,l;return o&&(a=o.split("."),l=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!l&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(l=+a[1]))),environmentV8Version=l,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var r=requireEnvironmentV8Version(),e=requireFails(),t=requireGlobalThis(),n=t.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!e(function(){var s=Symbol("symbol detection");return!n(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&r&&r<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var r=requireSymbolConstructorDetection();return useSymbolAsUid=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol;hasRequiredIsSymbol=1;var r=requireGetBuiltIn(),e=requireIsCallable(),t=requireObjectIsPrototypeOf(),n=requireUseSymbolAsUid(),s=Object;return isSymbol=n?function(o){return typeof o=="symbol"}:function(o){var a=r("Symbol");return e(a)&&t(a.prototype,s(o))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var r=String;return tryToString=function(e){try{return r(e)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var r=requireIsCallable(),e=requireTryToString(),t=TypeError;return aCallable=function(n){if(r(n))return n;throw new t(e(n)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var r=requireACallable(),e=requireIsNullOrUndefined();return getMethod=function(t,n){var s=t[n];return e(s)?void 0:r(s)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var r=requireFunctionCall(),e=requireIsCallable(),t=requireIsObject(),n=TypeError;return ordinaryToPrimitive=function(s,o){var a,l;if(o==="string"&&e(a=s.toString)&&!t(l=r(a,s))||e(a=s.valueOf)&&!t(l=r(a,s))||o!=="string"&&e(a=s.toString)&&!t(l=r(a,s)))return l;throw new n("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var r=requireGlobalThis(),e=Object.defineProperty;return defineGlobalProperty=function(t,n){try{e(r,t,{value:n,configurable:!0,writable:!0})}catch{r[t]=n}return n},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var r=requireIsPure(),e=requireGlobalThis(),t=requireDefineGlobalProperty(),n="__core-js_shared__",s=sharedStore.exports=e[n]||t(n,{});return(s.versions||(s.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var r=requireSharedStore();return shared=function(e,t){return r[e]||(r[e]=t||{})},shared}var toObject$1,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject$1;hasRequiredToObject=1;var r=requireRequireObjectCoercible(),e=Object;return toObject$1=function(t){return e(r(t))},toObject$1}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var r=requireFunctionUncurryThis(),e=requireToObject(),t=r({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(s,o){return t(e(s),o)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var r=requireFunctionUncurryThis(),e=0,t=Math.random(),n=r(1 .toString);return uid=function(s){return"Symbol("+(s===void 0?"":s)+")_"+n(++e+t,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var r=requireGlobalThis(),e=requireShared(),t=requireHasOwnProperty(),n=requireUid(),s=requireSymbolConstructorDetection(),o=requireUseSymbolAsUid(),a=r.Symbol,l=e("wks"),u=o?a.for||a:a&&a.withoutSetter||n;return wellKnownSymbol=function(c){return t(l,c)||(l[c]=s&&t(a,c)?a[c]:u("Symbol."+c)),l[c]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var r=requireFunctionCall(),e=requireIsObject(),t=requireIsSymbol(),n=requireGetMethod(),s=requireOrdinaryToPrimitive(),o=requireWellKnownSymbol(),a=TypeError,l=o("toPrimitive");return toPrimitive=function(u,c){if(!e(u)||t(u))return u;var h=n(u,l),g;if(h){if(c===void 0&&(c="default"),g=r(h,u,c),!e(g)||t(g))return g;throw new a("Can't convert object to primitive value")}return c===void 0&&(c="number"),s(u,c)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var r=requireToPrimitive(),e=requireIsSymbol();return toPropertyKey=function(t){var n=r(t,"string");return e(n)?n:n+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var r=requireGlobalThis(),e=requireIsObject(),t=r.document,n=e(t)&&e(t.createElement);return documentCreateElement=function(s){return n?t.createElement(s):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var r=requireDescriptors(),e=requireFails(),t=requireDocumentCreateElement();return ie8DomDefine=!r&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var r=requireDescriptors(),e=requireFunctionCall(),t=requireObjectPropertyIsEnumerable(),n=requireCreatePropertyDescriptor(),s=requireToIndexedObject(),o=requireToPropertyKey(),a=requireHasOwnProperty(),l=requireIe8DomDefine(),u=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=r?u:function(h,g){if(h=s(h),g=o(g),l)try{return u(h,g)}catch{}if(a(h,g))return n(!e(t.f,h,g),h[g])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var r=requireDescriptors(),e=requireFails();return v8PrototypeDefineBug=r&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var r=requireIsObject(),e=String,t=TypeError;return anObject=function(n){if(r(n))return n;throw new t(e(n)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var r=requireDescriptors(),e=requireIe8DomDefine(),t=requireV8PrototypeDefineBug(),n=requireAnObject(),s=requireToPropertyKey(),o=TypeError,a=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u="enumerable",c="configurable",h="writable";return objectDefineProperty.f=r?t?function(v,m,E){if(n(v),m=s(m),n(E),typeof v=="function"&&m==="prototype"&&"value"in E&&h in E&&!E[h]){var _=l(v,m);_&&_[h]&&(v[m]=E.value,E={configurable:c in E?E[c]:_[c],enumerable:u in E?E[u]:_[u],writable:!1})}return a(v,m,E)}:a:function(v,m,E){if(n(v),m=s(m),n(E),e)try{return a(v,m,E)}catch{}if("get"in E||"set"in E)throw new o("Accessors not supported");return"value"in E&&(v[m]=E.value),v},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var r=requireDescriptors(),e=requireObjectDefineProperty(),t=requireCreatePropertyDescriptor();return createNonEnumerableProperty=r?function(n,s,o){return e.f(n,s,t(1,o))}:function(n,s,o){return n[s]=o,n},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName$1,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName$1;hasRequiredFunctionName=1;var r=requireDescriptors(),e=requireHasOwnProperty(),t=Function.prototype,n=r&&Object.getOwnPropertyDescriptor,s=e(t,"name"),o=s&&(function(){}).name==="something",a=s&&(!r||r&&n(t,"name").configurable);return functionName$1={EXISTS:s,PROPER:o,CONFIGURABLE:a},functionName$1}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var r=requireFunctionUncurryThis(),e=requireIsCallable(),t=requireSharedStore(),n=r(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(s){return n(s)}),inspectSource=t.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var r=requireGlobalThis(),e=requireIsCallable(),t=r.WeakMap;return weakMapBasicDetection=e(t)&&/native code/.test(String(t)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var r=requireShared(),e=requireUid(),t=r("keys");return sharedKey=function(n){return t[n]||(t[n]=e(n))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var r=requireWeakMapBasicDetection(),e=requireGlobalThis(),t=requireIsObject(),n=requireCreateNonEnumerableProperty(),s=requireHasOwnProperty(),o=requireSharedStore(),a=requireSharedKey(),l=requireHiddenKeys(),u="Object already initialized",c=e.TypeError,h=e.WeakMap,g,v,m,E=function(A){return m(A)?v(A):g(A,{})},_=function(A){return function(O){var D;if(!t(O)||(D=v(O)).type!==A)throw new c("Incompatible receiver, "+A+" required");return D}};if(r||o.state){var S=o.state||(o.state=new h);S.get=S.get,S.has=S.has,S.set=S.set,g=function(A,O){if(S.has(A))throw new c(u);return O.facade=A,S.set(A,O),O},v=function(A){return S.get(A)||{}},m=function(A){return S.has(A)}}else{var w=a("state");l[w]=!0,g=function(A,O){if(s(A,w))throw new c(u);return O.facade=A,n(A,w,O),O},v=function(A){return s(A,w)?A[w]:{}},m=function(A){return s(A,w)}}return internalState={set:g,get:v,has:m,enforce:E,getterFor:_},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var r=requireFunctionUncurryThis(),e=requireFails(),t=requireIsCallable(),n=requireHasOwnProperty(),s=requireDescriptors(),o=requireFunctionName().CONFIGURABLE,a=requireInspectSource(),l=requireInternalState(),u=l.enforce,c=l.get,h=String,g=Object.defineProperty,v=r("".slice),m=r("".replace),E=r([].join),_=s&&!e(function(){return g(function(){},"length",{value:8}).length!==8}),S=String(String).split("String"),w=makeBuiltIn.exports=function(A,O,D){v(h(O),0,7)==="Symbol("&&(O="["+m(h(O),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),D&&D.getter&&(O="get "+O),D&&D.setter&&(O="set "+O),(!n(A,"name")||o&&A.name!==O)&&(s?g(A,"name",{value:O,configurable:!0}):A.name=O),_&&D&&n(D,"arity")&&A.length!==D.arity&&g(A,"length",{value:D.arity});try{D&&n(D,"constructor")&&D.constructor?s&&g(A,"prototype",{writable:!1}):A.prototype&&(A.prototype=void 0)}catch{}var Y=u(A);return n(Y,"source")||(Y.source=E(S,typeof O=="string"?O:"")),A};return Function.prototype.toString=w(function(){return t(this)&&c(this).source||a(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var r=requireIsCallable(),e=requireObjectDefineProperty(),t=requireMakeBuiltIn(),n=requireDefineGlobalProperty();return defineBuiltIn=function(s,o,a,l){l||(l={});var u=l.enumerable,c=l.name!==void 0?l.name:o;if(r(a)&&t(a,c,l),l.global)u?s[o]=a:n(o,a);else{try{l.unsafe?s[o]&&(u=!0):delete s[o]}catch{}u?s[o]=a:e.f(s,o,{value:a,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return s},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var r=Math.ceil,e=Math.floor;return mathTrunc=Math.trunc||function(n){var s=+n;return(s>0?e:r)(s)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var r=requireMathTrunc();return toIntegerOrInfinity=function(e){var t=+e;return t!==t||t===0?0:r(t)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var r=requireToIntegerOrInfinity(),e=Math.max,t=Math.min;return toAbsoluteIndex=function(n,s){var o=r(n);return o<0?e(o+s,0):t(o,s)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var r=requireToIntegerOrInfinity(),e=Math.min;return toLength=function(t){var n=r(t);return n>0?e(n,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var r=requireToLength();return lengthOfArrayLike=function(e){return r(e.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var r=requireToIndexedObject(),e=requireToAbsoluteIndex(),t=requireLengthOfArrayLike(),n=function(s){return function(o,a,l){var u=r(o),c=t(u);if(c===0)return!s&&-1;var h=e(l,c),g;if(s&&a!==a){for(;c>h;)if(g=u[h++],g!==g)return!0}else for(;c>h;h++)if((s||h in u)&&u[h]===a)return s||h||0;return!s&&-1}};return arrayIncludes={includes:n(!0),indexOf:n(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var r=requireFunctionUncurryThis(),e=requireHasOwnProperty(),t=requireToIndexedObject(),n=requireArrayIncludes().indexOf,s=requireHiddenKeys(),o=r([].push);return objectKeysInternal=function(a,l){var u=t(a),c=0,h=[],g;for(g in u)!e(s,g)&&e(u,g)&&o(h,g);for(;l.length>c;)e(u,g=l[c++])&&(~n(h,g)||o(h,g));return h},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var r=requireObjectKeysInternal(),e=requireEnumBugKeys(),t=e.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(s){return r(s,t)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var r=requireGetBuiltIn(),e=requireFunctionUncurryThis(),t=requireObjectGetOwnPropertyNames(),n=requireObjectGetOwnPropertySymbols(),s=requireAnObject(),o=e([].concat);return ownKeys=r("Reflect","ownKeys")||function(l){var u=t.f(s(l)),c=n.f;return c?o(u,c(l)):u},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var r=requireHasOwnProperty(),e=requireOwnKeys(),t=requireObjectGetOwnPropertyDescriptor(),n=requireObjectDefineProperty();return copyConstructorProperties=function(s,o,a){for(var l=e(o),u=n.f,c=t.f,h=0;h<l.length;h++){var g=l[h];!r(s,g)&&!(a&&r(a,g))&&u(s,g,c(o,g))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var r=requireFails(),e=requireIsCallable(),t=/#|\.prototype\./,n=function(u,c){var h=o[s(u)];return h===l?!0:h===a?!1:e(c)?r(c):!!c},s=n.normalize=function(u){return String(u).replace(t,".").toLowerCase()},o=n.data={},a=n.NATIVE="N",l=n.POLYFILL="P";return isForced_1=n,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var r=requireGlobalThis(),e=requireObjectGetOwnPropertyDescriptor().f,t=requireCreateNonEnumerableProperty(),n=requireDefineBuiltIn(),s=requireDefineGlobalProperty(),o=requireCopyConstructorProperties(),a=requireIsForced();return _export=function(l,u){var c=l.target,h=l.global,g=l.stat,v,m,E,_,S,w;if(h?m=r:g?m=r[c]||s(c,{}):m=r[c]&&r[c].prototype,m)for(E in u){if(S=u[E],l.dontCallGetSet?(w=e(m,E),_=w&&w.value):_=m[E],v=a(h?E:c+(g?".":"#")+E,l.forced),!v&&_!==void 0){if(typeof S==typeof _)continue;o(S,_)}(l.sham||_&&_.sham)&&t(S,"sham",!0),n(m,E,S,l)}},_export}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var r=requireFunctionBindNative(),e=Function.prototype,t=e.apply,n=e.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(r?n.bind(t):function(){return n.apply(t,arguments)}),functionApply}var functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var r=requireFunctionUncurryThis(),e=requireACallable();return functionUncurryThisAccessor=function(t,n,s){try{return r(e(Object.getOwnPropertyDescriptor(t,n)[s]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var r=requireIsObject();return isPossiblePrototype=function(e){return r(e)||e===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var r=requireIsPossiblePrototype(),e=String,t=TypeError;return aPossiblePrototype=function(n){if(r(n))return n;throw new t("Can't set "+e(n)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var r=requireFunctionUncurryThisAccessor(),e=requireIsObject(),t=requireRequireObjectCoercible(),n=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var s=!1,o={},a;try{a=r(Object.prototype,"__proto__","set"),a(o,[]),s=o instanceof Array}catch{}return function(u,c){return t(u),n(c),e(u)&&(s?a(u,c):u.__proto__=c),u}}():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var r=requireObjectDefineProperty().f;return proxyAccessor=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(s){t[n]=s}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var r=requireIsCallable(),e=requireIsObject(),t=requireObjectSetPrototypeOf();return inheritIfRequired=function(n,s,o){var a,l;return t&&r(a=s.constructor)&&a!==o&&e(l=a.prototype)&&l!==o.prototype&&t(n,l),n},inheritIfRequired}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var r=requireWellKnownSymbol(),e=r("toStringTag"),t={};return t[e]="z",toStringTagSupport=String(t)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var r=requireToStringTagSupport(),e=requireIsCallable(),t=requireClassofRaw(),n=requireWellKnownSymbol(),s=n("toStringTag"),o=Object,a=t(function(){return arguments}())==="Arguments",l=function(u,c){try{return u[c]}catch{}};return classof=r?t:function(u){var c,h,g;return u===void 0?"Undefined":u===null?"Null":typeof(h=l(c=o(u),s))=="string"?h:a?t(c):(g=t(c))==="Object"&&e(c.callee)?"Arguments":g},classof}var toString$1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString$1;hasRequiredToString=1;var r=requireClassof(),e=String;return toString$1=function(t){if(r(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(t)},toString$1}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var r=requireToString();return normalizeStringArgument=function(e,t){return e===void 0?arguments.length<2?"":t:r(e)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var r=requireIsObject(),e=requireCreateNonEnumerableProperty();return installErrorCause=function(t,n){r(n)&&"cause"in n&&e(t,"cause",n.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var r=requireFunctionUncurryThis(),e=Error,t=r("".replace),n=function(a){return String(new e(a).stack)}("zxcasd"),s=/\n\s*at [^:]*:[^\n]*/,o=s.test(n);return errorStackClear=function(a,l){if(o&&typeof a=="string"&&!e.prepareStackTrace)for(;l--;)a=t(a,s,"");return a},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var r=requireFails(),e=requireCreatePropertyDescriptor();return errorStackInstallable=!r(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",e(1,7)),t.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var r=requireCreateNonEnumerableProperty(),e=requireErrorStackClear(),t=requireErrorStackInstallable(),n=Error.captureStackTrace;return errorStackInstall=function(s,o,a,l){t&&(n?n(s,o):r(s,"stack",e(a,l)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var r=requireGetBuiltIn(),e=requireHasOwnProperty(),t=requireCreateNonEnumerableProperty(),n=requireObjectIsPrototypeOf(),s=requireObjectSetPrototypeOf(),o=requireCopyConstructorProperties(),a=requireProxyAccessor(),l=requireInheritIfRequired(),u=requireNormalizeStringArgument(),c=requireInstallErrorCause(),h=requireErrorStackInstall(),g=requireDescriptors(),v=requireIsPure();return wrapErrorConstructorWithCause=function(m,E,_,S){var w="stackTraceLimit",A=S?2:1,O=m.split("."),D=O[O.length-1],Y=r.apply(null,O);if(Y){var H=Y.prototype;if(!v&&e(H,"cause")&&delete H.cause,!_)return Y;var k=r("Error"),K=E(function(se,re){var Ce=u(S?re:se,void 0),Le=S?new Y(se):new Y;return Ce!==void 0&&t(Le,"message",Ce),h(Le,K,Le.stack,2),this&&n(H,this)&&l(Le,this,K),arguments.length>A&&c(Le,arguments[A]),Le});if(K.prototype=H,D!=="Error"?s?s(K,k):o(K,k,{name:!0}):g&&w in Y&&(a(K,Y,w),a(K,Y,"prepareStackTrace")),o(K,Y),!v)try{H.name!==D&&t(H,"name",D),H.constructor=K}catch{}return K}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var r=require_export(),e=requireGlobalThis(),t=requireFunctionApply(),n=requireWrapErrorConstructorWithCause(),s="WebAssembly",o=e[s],a=new Error("e",{cause:7}).cause!==7,l=function(c,h){var g={};g[c]=n(c,h,a),r({global:!0,constructor:!0,arity:1,forced:a},g)},u=function(c,h){if(o&&o[c]){var g={};g[c]=n(s+"."+c,h,a),r({target:s,stat:!0,constructor:!0,arity:1,forced:a},g)}};return l("Error",function(c){return function(g){return t(c,this,arguments)}}),l("EvalError",function(c){return function(g){return t(c,this,arguments)}}),l("RangeError",function(c){return function(g){return t(c,this,arguments)}}),l("ReferenceError",function(c){return function(g){return t(c,this,arguments)}}),l("SyntaxError",function(c){return function(g){return t(c,this,arguments)}}),l("TypeError",function(c){return function(g){return t(c,this,arguments)}}),l("URIError",function(c){return function(g){return t(c,this,arguments)}}),u("CompileError",function(c){return function(g){return t(c,this,arguments)}}),u("LinkError",function(c){return function(g){return t(c,this,arguments)}}),u("RuntimeError",function(c){return function(g){return t(c,this,arguments)}}),es_error_cause}requireEs_error_cause();var es_array_push={},isArray$3,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray$3;hasRequiredIsArray=1;var r=requireClassofRaw();return isArray$3=Array.isArray||function(t){return r(t)==="Array"},isArray$3}var arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var r=requireDescriptors(),e=requireIsArray(),t=TypeError,n=Object.getOwnPropertyDescriptor,s=r&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return arraySetLength=s?function(o,a){if(e(o)&&!n(o,"length").writable)throw new t("Cannot set read only .length");return o.length=a}:function(o,a){return o.length=a},arraySetLength}var doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var r=TypeError,e=9007199254740991;return doesNotExceedSafeInteger=function(t){if(t>e)throw r("Maximum allowed index exceeded");return t},doesNotExceedSafeInteger}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireArraySetLength(),s=requireDoesNotExceedSafeInteger(),o=requireFails(),a=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),l=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},u=a||!l();return r({target:"Array",proto:!0,arity:1,forced:u},{push:function(h){var g=e(this),v=t(g),m=arguments.length;s(v+m);for(var E=0;E<m;E++)g[v]=arguments[E],v++;return n(g,v),v}}),es_array_push}requireEs_array_push();var esnext_iterator_constructor={},es_iterator_constructor={},anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var r=requireObjectIsPrototypeOf(),e=TypeError;return anInstance=function(t,n){if(r(n,t))return t;throw new e("Incorrect invocation")},anInstance}var correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var r=requireFails();return correctPrototypeGetter=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var r=requireHasOwnProperty(),e=requireIsCallable(),t=requireToObject(),n=requireSharedKey(),s=requireCorrectPrototypeGetter(),o=n("IE_PROTO"),a=Object,l=a.prototype;return objectGetPrototypeOf=s?a.getPrototypeOf:function(u){var c=t(u);if(r(c,o))return c[o];var h=c.constructor;return e(h)&&c instanceof h?h.prototype:c instanceof a?l:null},objectGetPrototypeOf}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var r=requireMakeBuiltIn(),e=requireObjectDefineProperty();return defineBuiltInAccessor=function(t,n,s){return s.get&&r(s.get,n,{getter:!0}),s.set&&r(s.set,n,{setter:!0}),e.f(t,n,s)},defineBuiltInAccessor}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var r=requireDescriptors(),e=requireObjectDefineProperty(),t=requireCreatePropertyDescriptor();return createProperty=function(n,s,o){r?e.f(n,s,t(0,o)):n[s]=o},createProperty}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var r=requireObjectKeysInternal(),e=requireEnumBugKeys();return objectKeys=Object.keys||function(n){return r(n,e)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var r=requireDescriptors(),e=requireV8PrototypeDefineBug(),t=requireObjectDefineProperty(),n=requireAnObject(),s=requireToIndexedObject(),o=requireObjectKeys();return objectDefineProperties.f=r&&!e?Object.defineProperties:function(l,u){n(l);for(var c=s(u),h=o(u),g=h.length,v=0,m;g>v;)t.f(l,m=h[v++],c[m]);return l},objectDefineProperties}var html$2,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html$2;hasRequiredHtml=1;var r=requireGetBuiltIn();return html$2=r("document","documentElement"),html$2}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var r=requireAnObject(),e=requireObjectDefineProperties(),t=requireEnumBugKeys(),n=requireHiddenKeys(),s=requireHtml(),o=requireDocumentCreateElement(),a=requireSharedKey(),l=">",u="<",c="prototype",h="script",g=a("IE_PROTO"),v=function(){},m=function(A){return u+h+l+A+u+"/"+h+l},E=function(A){A.write(m("")),A.close();var O=A.parentWindow.Object;return A=null,O},_=function(){var A=o("iframe"),O="java"+h+":",D;return A.style.display="none",s.appendChild(A),A.src=String(O),D=A.contentWindow.document,D.open(),D.write(m("document.F=Object")),D.close(),D.F},S,w=function(){try{S=new ActiveXObject("htmlfile")}catch{}w=typeof document<"u"?document.domain&&S?E(S):_():E(S);for(var A=t.length;A--;)delete w[c][t[A]];return w()};return n[g]=!0,objectCreate=Object.create||function(O,D){var Y;return O!==null?(v[c]=r(O),Y=new v,v[c]=null,Y[g]=O):Y=w(),D===void 0?Y:e.f(Y,D)},objectCreate}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var r=requireFails(),e=requireIsCallable(),t=requireIsObject(),n=requireObjectCreate(),s=requireObjectGetPrototypeOf(),o=requireDefineBuiltIn(),a=requireWellKnownSymbol(),l=requireIsPure(),u=a("iterator"),c=!1,h,g,v;[].keys&&(v=[].keys(),"next"in v?(g=s(s(v)),g!==Object.prototype&&(h=g)):c=!0);var m=!t(h)||r(function(){var E={};return h[u].call(E)!==E});return m?h={}:l&&(h=n(h)),e(h[u])||o(h,u,function(){return this}),iteratorsCore={IteratorPrototype:h,BUGGY_SAFARI_ITERATORS:c},iteratorsCore}var hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var r=require_export(),e=requireGlobalThis(),t=requireAnInstance(),n=requireAnObject(),s=requireIsCallable(),o=requireObjectGetPrototypeOf(),a=requireDefineBuiltInAccessor(),l=requireCreateProperty(),u=requireFails(),c=requireHasOwnProperty(),h=requireWellKnownSymbol(),g=requireIteratorsCore().IteratorPrototype,v=requireDescriptors(),m=requireIsPure(),E="constructor",_="Iterator",S=h("toStringTag"),w=TypeError,A=e[_],O=m||!s(A)||A.prototype!==g||!u(function(){A({})}),D=function(){if(t(this,g),o(this)===g)throw new w("Abstract class Iterator not directly constructable")},Y=function(H,k){v?a(g,H,{configurable:!0,get:function(){return k},set:function(K){if(n(this),this===g)throw new w("You can't redefine this property");c(this,H)?this[H]=K:l(this,H,K)}}):g[H]=k};return c(g,S)||Y(S,_),(O||!c(g,E)||g[E]===Object)&&Y(E,D),D.prototype=g,r({global:!0,constructor:!0,forced:O},{Iterator:D}),es_iterator_constructor}var hasRequiredEsnext_iterator_constructor;function requireEsnext_iterator_constructor(){return hasRequiredEsnext_iterator_constructor||(hasRequiredEsnext_iterator_constructor=1,requireEs_iterator_constructor()),esnext_iterator_constructor}requireEsnext_iterator_constructor();var esnext_iterator_filter={},es_iterator_filter={},getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(r){return{iterator:r,next:r.next,done:!1}}),getIteratorDirect}var defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var r=requireDefineBuiltIn();return defineBuiltIns=function(e,t,n){for(var s in t)r(e,s,t[s],n);return e},defineBuiltIns}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(r,e){return{value:r,done:e}}),createIterResultObject}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var r=requireFunctionCall(),e=requireAnObject(),t=requireGetMethod();return iteratorClose=function(n,s,o){var a,l;e(n);try{if(a=t(n,"return"),!a){if(s==="throw")throw o;return o}a=r(a,n)}catch(u){l=!0,a=u}if(s==="throw")throw o;if(l)throw a;return e(a),o},iteratorClose}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var r=requireFunctionCall(),e=requireObjectCreate(),t=requireCreateNonEnumerableProperty(),n=requireDefineBuiltIns(),s=requireWellKnownSymbol(),o=requireInternalState(),a=requireGetMethod(),l=requireIteratorsCore().IteratorPrototype,u=requireCreateIterResultObject(),c=requireIteratorClose(),h=s("toStringTag"),g="IteratorHelper",v="WrapForValidIterator",m=o.set,E=function(w){var A=o.getterFor(w?v:g);return n(e(l),{next:function(){var D=A(this);if(w)return D.nextHandler();if(D.done)return u(void 0,!0);try{var Y=D.nextHandler();return D.returnHandlerResult?Y:u(Y,D.done)}catch(H){throw D.done=!0,H}},return:function(){var O=A(this),D=O.iterator;if(O.done=!0,w){var Y=a(D,"return");return Y?r(Y,D):u(void 0,!0)}if(O.inner)try{c(O.inner.iterator,"normal")}catch(H){return c(D,"throw",H)}return D&&c(D,"normal"),u(void 0,!0)}})},_=E(!0),S=E(!1);return t(S,h,"Iterator Helper"),iteratorCreateProxy=function(w,A,O){var D=function(H,k){k?(k.iterator=H.iterator,k.next=H.next):k=H,k.type=A?v:g,k.returnHandlerResult=!!O,k.nextHandler=w,k.counter=0,k.done=!1,m(this,k)};return D.prototype=A?_:S,D},iteratorCreateProxy}var callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var r=requireAnObject(),e=requireIteratorClose();return callWithSafeIterationClosing=function(t,n,s,o){try{return o?n(r(s)[0],s[1]):n(s)}catch(a){e(t,"throw",a)}},callWithSafeIterationClosing}var hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var r=require_export(),e=requireFunctionCall(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireIteratorCreateProxy(),a=requireCallWithSafeIterationClosing(),l=requireIsPure(),u=o(function(){for(var c=this.iterator,h=this.predicate,g=this.next,v,m,E;;){if(v=n(e(g,c)),m=this.done=!!v.done,m)return;if(E=v.value,a(c,h,[E,this.counter++],!0))return E}});return r({target:"Iterator",proto:!0,real:!0,forced:l},{filter:function(h){return n(this),t(h),new u(s(this),{predicate:h})}}),es_iterator_filter}var hasRequiredEsnext_iterator_filter;function requireEsnext_iterator_filter(){return hasRequiredEsnext_iterator_filter||(hasRequiredEsnext_iterator_filter=1,requireEs_iterator_filter()),esnext_iterator_filter}requireEsnext_iterator_filter();var esnext_iterator_find={},es_iterator_find={},functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var r=requireClassofRaw(),e=requireFunctionUncurryThis();return functionUncurryThisClause=function(t){if(r(t)==="Function")return e(t)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var r=requireFunctionUncurryThisClause(),e=requireACallable(),t=requireFunctionBindNative(),n=r(r.bind);return functionBindContext=function(s,o){return e(s),o===void 0?s:t?n(s,o):function(){return s.apply(o,arguments)}},functionBindContext}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var r=requireWellKnownSymbol(),e=requireIterators(),t=r("iterator"),n=Array.prototype;return isArrayIteratorMethod=function(s){return s!==void 0&&(e.Array===s||n[t]===s)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var r=requireClassof(),e=requireGetMethod(),t=requireIsNullOrUndefined(),n=requireIterators(),s=requireWellKnownSymbol(),o=s("iterator");return getIteratorMethod=function(a){if(!t(a))return e(a,o)||e(a,"@@iterator")||n[r(a)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var r=requireFunctionCall(),e=requireACallable(),t=requireAnObject(),n=requireTryToString(),s=requireGetIteratorMethod(),o=TypeError;return getIterator=function(a,l){var u=arguments.length<2?s(a):l;if(e(u))return t(r(u,a));throw new o(n(a)+" is not iterable")},getIterator}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var r=requireFunctionBindContext(),e=requireFunctionCall(),t=requireAnObject(),n=requireTryToString(),s=requireIsArrayIteratorMethod(),o=requireLengthOfArrayLike(),a=requireObjectIsPrototypeOf(),l=requireGetIterator(),u=requireGetIteratorMethod(),c=requireIteratorClose(),h=TypeError,g=function(m,E){this.stopped=m,this.result=E},v=g.prototype;return iterate=function(m,E,_){var S=_&&_.that,w=!!(_&&_.AS_ENTRIES),A=!!(_&&_.IS_RECORD),O=!!(_&&_.IS_ITERATOR),D=!!(_&&_.INTERRUPTED),Y=r(E,S),H,k,K,se,re,Ce,Le,he=function(xe){return H&&c(H,"normal",xe),new g(!0,xe)},ve=function(xe){return w?(t(xe),D?Y(xe[0],xe[1],he):Y(xe[0],xe[1])):D?Y(xe,he):Y(xe)};if(A)H=m.iterator;else if(O)H=m;else{if(k=u(m),!k)throw new h(n(m)+" is not iterable");if(s(k)){for(K=0,se=o(m);se>K;K++)if(re=ve(m[K]),re&&a(v,re))return re;return new g(!1)}H=l(m,k)}for(Ce=A?m.next:H.next;!(Le=e(Ce,H)).done;){try{re=ve(Le.value)}catch(xe){c(H,"throw",xe)}if(typeof re=="object"&&re&&a(v,re))return re}return new g(!1)},iterate}var hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{find:function(a){n(this),t(a);var l=s(this),u=0;return e(l,function(c,h){if(a(c,u++))return h(c)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var hasRequiredEsnext_iterator_find;function requireEsnext_iterator_find(){return hasRequiredEsnext_iterator_find||(hasRequiredEsnext_iterator_find=1,requireEs_iterator_find()),esnext_iterator_find}requireEsnext_iterator_find();var esnext_iterator_reduce={},es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=TypeError;return r({target:"Iterator",proto:!0,real:!0},{reduce:function(l){n(this),t(l);var u=s(this),c=arguments.length<2,h=c?void 0:arguments[1],g=0;if(e(u,function(v){c?(c=!1,h=v):h=l(h,v,g),g++},{IS_RECORD:!0}),c)throw new o("Reduce of empty iterator with no initial value");return h}}),es_iterator_reduce}var hasRequiredEsnext_iterator_reduce;function requireEsnext_iterator_reduce(){return hasRequiredEsnext_iterator_reduce||(hasRequiredEsnext_iterator_reduce=1,requireEs_iterator_reduce()),esnext_iterator_reduce}requireEsnext_iterator_reduce();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(r){hookCallback=r}function isArray$2(r){return r instanceof Array||Object.prototype.toString.call(r)==="[object Array]"}function isObject$2(r){return r!=null&&Object.prototype.toString.call(r)==="[object Object]"}function hasOwnProp(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function isObjectEmpty(r){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(r).length===0;var e;for(e in r)if(hasOwnProp(r,e))return!1;return!0}function isUndefined$2(r){return r===void 0}function isNumber(r){return typeof r=="number"||Object.prototype.toString.call(r)==="[object Number]"}function isDate$2(r){return r instanceof Date||Object.prototype.toString.call(r)==="[object Date]"}function map$1(r,e){var t=[],n,s=r.length;for(n=0;n<s;++n)t.push(e(r[n],n));return t}function extend$2(r,e){for(var t in e)hasOwnProp(e,t)&&(r[t]=e[t]);return hasOwnProp(e,"toString")&&(r.toString=e.toString),hasOwnProp(e,"valueOf")&&(r.valueOf=e.valueOf),r}function createUTC(r,e,t,n){return createLocalOrUTC(r,e,t,n,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(r){return r._pf==null&&(r._pf=defaultParsingFlags()),r._pf}var some$1;Array.prototype.some?some$1=Array.prototype.some:some$1=function(r){var e=Object(this),t=e.length>>>0,n;for(n=0;n<t;n++)if(n in e&&r.call(this,e[n],n,e))return!0;return!1};function isValid(r){var e=null,t=!1,n=r._d&&!isNaN(r._d.getTime());if(n&&(e=getParsingFlags(r),t=some$1.call(e.parsedDateParts,function(s){return s!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),r._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(r))r._isValid=n;else return n;return r._isValid}function createInvalid(r){var e=createUTC(NaN);return r!=null?extend$2(getParsingFlags(e),r):getParsingFlags(e).userInvalidated=!0,e}var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(r,e){var t,n,s,o=momentProperties.length;if(isUndefined$2(e._isAMomentObject)||(r._isAMomentObject=e._isAMomentObject),isUndefined$2(e._i)||(r._i=e._i),isUndefined$2(e._f)||(r._f=e._f),isUndefined$2(e._l)||(r._l=e._l),isUndefined$2(e._strict)||(r._strict=e._strict),isUndefined$2(e._tzm)||(r._tzm=e._tzm),isUndefined$2(e._isUTC)||(r._isUTC=e._isUTC),isUndefined$2(e._offset)||(r._offset=e._offset),isUndefined$2(e._pf)||(r._pf=getParsingFlags(e)),isUndefined$2(e._locale)||(r._locale=e._locale),o>0)for(t=0;t<o;t++)n=momentProperties[t],s=e[n],isUndefined$2(s)||(r[n]=s);return r}function Moment(r){copyConfig(this,r),this._d=new Date(r._d!=null?r._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),updateInProgress===!1&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(r){return r instanceof Moment||r!=null&&r._isAMomentObject!=null}function warn$2(r){hooks.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+r)}function deprecate(r,e){var t=!0;return extend$2(function(){if(hooks.deprecationHandler!=null&&hooks.deprecationHandler(null,r),t){var n=[],s,o,a,l=arguments.length;for(o=0;o<l;o++){if(s="",typeof arguments[o]=="object"){s+=`
[`+o+"] ";for(a in arguments[0])hasOwnProp(arguments[0],a)&&(s+=a+": "+arguments[0][a]+", ");s=s.slice(0,-2)}else s=arguments[o];n.push(s)}warn$2(r+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var deprecations={};function deprecateSimple(r,e){hooks.deprecationHandler!=null&&hooks.deprecationHandler(r,e),deprecations[r]||(warn$2(e),deprecations[r]=!0)}hooks.suppressDeprecationWarnings=!1;hooks.deprecationHandler=null;function isFunction$2(r){return typeof Function<"u"&&r instanceof Function||Object.prototype.toString.call(r)==="[object Function]"}function set$1(r){var e,t;for(t in r)hasOwnProp(r,t)&&(e=r[t],isFunction$2(e)?this[t]=e:this["_"+t]=e);this._config=r,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(r,e){var t=extend$2({},r),n;for(n in e)hasOwnProp(e,n)&&(isObject$2(r[n])&&isObject$2(e[n])?(t[n]={},extend$2(t[n],r[n]),extend$2(t[n],e[n])):e[n]!=null?t[n]=e[n]:delete t[n]);for(n in r)hasOwnProp(r,n)&&!hasOwnProp(e,n)&&isObject$2(r[n])&&(t[n]=extend$2({},t[n]));return t}function Locale(r){r!=null&&this.set(r)}var keys$1;Object.keys?keys$1=Object.keys:keys$1=function(r){var e,t=[];for(e in r)hasOwnProp(r,e)&&t.push(e);return t};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(r,e,t){var n=this._calendar[r]||this._calendar.sameElse;return isFunction$2(n)?n.call(e,t):n}function zeroFill(r,e,t){var n=""+Math.abs(r),s=e-n.length,o=r>=0;return(o?t?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(r,e,t,n){var s=n;typeof n=="string"&&(s=function(){return this[n]()}),r&&(formatTokenFunctions[r]=s),e&&(formatTokenFunctions[e[0]]=function(){return zeroFill(s.apply(this,arguments),e[1],e[2])}),t&&(formatTokenFunctions[t]=function(){return this.localeData().ordinal(s.apply(this,arguments),r)})}function removeFormattingTokens(r){return r.match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"")}function makeFormatFunction(r){var e=r.match(formattingTokens),t,n;for(t=0,n=e.length;t<n;t++)formatTokenFunctions[e[t]]?e[t]=formatTokenFunctions[e[t]]:e[t]=removeFormattingTokens(e[t]);return function(s){var o="",a;for(a=0;a<n;a++)o+=isFunction$2(e[a])?e[a].call(s,r):e[a];return o}}function formatMoment(r,e){return r.isValid()?(e=expandFormat(e,r.localeData()),formatFunctions[e]=formatFunctions[e]||makeFormatFunction(e),formatFunctions[e](r)):r.localeData().invalidDate()}function expandFormat(r,e){var t=5;function n(s){return e.longDateFormat(s)||s}for(localFormattingTokens.lastIndex=0;t>=0&&localFormattingTokens.test(r);)r=r.replace(localFormattingTokens,n),localFormattingTokens.lastIndex=0,t-=1;return r}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(r){var e=this._longDateFormat[r],t=this._longDateFormat[r.toUpperCase()];return e||!t?e:(this._longDateFormat[r]=t.match(formattingTokens).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[r])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(r){return this._ordinal.replace("%d",r)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(r,e,t,n){var s=this._relativeTime[t];return isFunction$2(s)?s(r,e,t,n):s.replace(/%d/i,r)}function pastFuture(r,e){var t=this._relativeTime[r>0?"future":"past"];return isFunction$2(t)?t(e):t.replace(/%s/i,e)}var aliases={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function normalizeUnits(r){return typeof r=="string"?aliases[r]||aliases[r.toLowerCase()]:void 0}function normalizeObjectUnits(r){var e={},t,n;for(n in r)hasOwnProp(r,n)&&(t=normalizeUnits(n),t&&(e[t]=r[n]));return e}var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function getPrioritizedUnits(r){var e=[],t;for(t in r)hasOwnProp(r,t)&&e.push({unit:t,priority:priorities[t]});return e.sort(function(n,s){return n.priority-s.priority}),e}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/,regexes;regexes={};function addRegexToken(r,e,t){regexes[r]=isFunction$2(e)?e:function(n,s){return n&&t?t:e}}function getParseRegexForToken(r,e){return hasOwnProp(regexes,r)?regexes[r](e._strict,e._locale):new RegExp(unescapeFormat(r))}function unescapeFormat(r){return regexEscape(r.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,o){return t||n||s||o}))}function regexEscape(r){return r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function absFloor(r){return r<0?Math.ceil(r)||0:Math.floor(r)}function toInt(r){var e=+r,t=0;return e!==0&&isFinite(e)&&(t=absFloor(e)),t}var tokens={};function addParseToken(r,e){var t,n=e,s;for(typeof r=="string"&&(r=[r]),isNumber(e)&&(n=function(o,a){a[e]=toInt(o)}),s=r.length,t=0;t<s;t++)tokens[r[t]]=n}function addWeekParseToken(r,e){addParseToken(r,function(t,n,s,o){s._w=s._w||{},e(t,s._w,s,o)})}function addTimeToArrayFromToken(r,e,t){e!=null&&hasOwnProp(tokens,r)&&tokens[r](e,t._a,t,r)}function isLeapYear$1(r){return r%4===0&&r%100!==0||r%400===0}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;addFormatToken("Y",0,0,function(){var r=this.year();return r<=9999?zeroFill(r,4):"+"+r});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,!0],0,"year");addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(r,e){e[YEAR]=r.length===2?hooks.parseTwoDigitYear(r):toInt(r)});addParseToken("YY",function(r,e){e[YEAR]=hooks.parseTwoDigitYear(r)});addParseToken("Y",function(r,e){e[YEAR]=parseInt(r,10)});function daysInYear(r){return isLeapYear$1(r)?366:365}hooks.parseTwoDigitYear=function(r){return toInt(r)+(toInt(r)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear$1(this.year())}function makeGetSet(r,e){return function(t){return t!=null?(set$1$1(this,r,t),hooks.updateOffset(this,e),this):get(this,r)}}function get(r,e){if(!r.isValid())return NaN;var t=r._d,n=r._isUTC;switch(e){case"Milliseconds":return n?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return n?t.getUTCSeconds():t.getSeconds();case"Minutes":return n?t.getUTCMinutes():t.getMinutes();case"Hours":return n?t.getUTCHours():t.getHours();case"Date":return n?t.getUTCDate():t.getDate();case"Day":return n?t.getUTCDay():t.getDay();case"Month":return n?t.getUTCMonth():t.getMonth();case"FullYear":return n?t.getUTCFullYear():t.getFullYear();default:return NaN}}function set$1$1(r,e,t){var n,s,o,a,l;if(!(!r.isValid()||isNaN(t))){switch(n=r._d,s=r._isUTC,e){case"Milliseconds":return void(s?n.setUTCMilliseconds(t):n.setMilliseconds(t));case"Seconds":return void(s?n.setUTCSeconds(t):n.setSeconds(t));case"Minutes":return void(s?n.setUTCMinutes(t):n.setMinutes(t));case"Hours":return void(s?n.setUTCHours(t):n.setHours(t));case"Date":return void(s?n.setUTCDate(t):n.setDate(t));case"FullYear":break;default:return}o=t,a=r.month(),l=r.date(),l=l===29&&a===1&&!isLeapYear$1(o)?28:l,s?n.setUTCFullYear(o,a,l):n.setFullYear(o,a,l)}}function stringGet(r){return r=normalizeUnits(r),isFunction$2(this[r])?this[r]():this}function stringSet(r,e){if(typeof r=="object"){r=normalizeObjectUnits(r);var t=getPrioritizedUnits(r),n,s=t.length;for(n=0;n<s;n++)this[t[n].unit](r[t[n].unit])}else if(r=normalizeUnits(r),isFunction$2(this[r]))return this[r](e);return this}function mod(r,e){return(r%e+e)%e}var indexOf$1;Array.prototype.indexOf?indexOf$1=Array.prototype.indexOf:indexOf$1=function(r){var e;for(e=0;e<this.length;++e)if(this[e]===r)return e;return-1};function daysInMonth(r,e){if(isNaN(r)||isNaN(e))return NaN;var t=mod(e,12);return r+=(e-t)/12,t===1?isLeapYear$1(r)?29:28:31-t%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(r){return this.localeData().monthsShort(this,r)});addFormatToken("MMMM",0,0,function(r){return this.localeData().months(this,r)});addRegexToken("M",match1to2,match1to2NoLeadingZero);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(r,e){return e.monthsShortRegex(r)});addRegexToken("MMMM",function(r,e){return e.monthsRegex(r)});addParseToken(["M","MM"],function(r,e){e[MONTH]=toInt(r)-1});addParseToken(["MMM","MMMM"],function(r,e,t,n){var s=t._locale.monthsParse(r,n,t._strict);s!=null?e[MONTH]=s:getParsingFlags(t).invalidMonth=r});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(r,e){return r?isArray$2(this._months)?this._months[r.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(e)?"format":"standalone"][r.month()]:isArray$2(this._months)?this._months:this._months.standalone}function localeMonthsShort(r,e){return r?isArray$2(this._monthsShort)?this._monthsShort[r.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(e)?"format":"standalone"][r.month()]:isArray$2(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(r,e,t){var n,s,o,a=r.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=createUTC([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return t?e==="MMM"?(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:null):(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:null):e==="MMM"?(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:null)):(s=indexOf$1.call(this._longMonthsParse,a),s!==-1?s:(s=indexOf$1.call(this._shortMonthsParse,a),s!==-1?s:null))}function localeMonthsParse(r,e,t){var n,s,o;if(this._monthsParseExact)return handleStrictParse.call(this,r,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=createUTC([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!t&&!this._monthsParse[n]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[n].test(r))return n;if(t&&e==="MMM"&&this._shortMonthsParse[n].test(r))return n;if(!t&&this._monthsParse[n].test(r))return n}}function setMonth(r,e){if(!r.isValid())return r;if(typeof e=="string"){if(/^\d+$/.test(e))e=toInt(e);else if(e=r.localeData().monthsParse(e),!isNumber(e))return r}var t=e,n=r.date();return n=n<29?n:Math.min(n,daysInMonth(r.year(),t)),r._isUTC?r._d.setUTCMonth(t,n):r._d.setMonth(t,n),r}function getSetMonth(r){return r!=null?(setMonth(this,r),hooks.updateOffset(this,!0),this):get(this,"Month")}function getDaysInMonth$1(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(r){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),r?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&r?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(r){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),r?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&r?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function r(u,c){return c.length-u.length}var e=[],t=[],n=[],s,o,a,l;for(s=0;s<12;s++)o=createUTC([2e3,s]),a=regexEscape(this.monthsShort(o,"")),l=regexEscape(this.months(o,"")),e.push(a),t.push(l),n.push(l),n.push(a);e.sort(r),t.sort(r),n.sort(r),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function createDate(r,e,t,n,s,o,a){var l;return r<100&&r>=0?(l=new Date(r+400,e,t,n,s,o,a),isFinite(l.getFullYear())&&l.setFullYear(r)):l=new Date(r,e,t,n,s,o,a),l}function createUTCDate(r){var e,t;return r<100&&r>=0?(t=Array.prototype.slice.call(arguments),t[0]=r+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(r)):e=new Date(Date.UTC.apply(null,arguments)),e}function firstWeekOffset(r,e,t){var n=7+e-t,s=(7+createUTCDate(r,0,n).getUTCDay()-e)%7;return-s+n-1}function dayOfYearFromWeeks(r,e,t,n,s){var o=(7+t-n)%7,a=firstWeekOffset(r,n,s),l=1+7*(e-1)+o+a,u,c;return l<=0?(u=r-1,c=daysInYear(u)+l):l>daysInYear(r)?(u=r+1,c=l-daysInYear(r)):(u=r,c=l),{year:u,dayOfYear:c}}function weekOfYear(r,e,t){var n=firstWeekOffset(r.year(),e,t),s=Math.floor((r.dayOfYear()-n-1)/7)+1,o,a;return s<1?(a=r.year()-1,o=s+weeksInYear(a,e,t)):s>weeksInYear(r.year(),e,t)?(o=s-weeksInYear(r.year(),e,t),a=r.year()+1):(a=r.year(),o=s),{week:o,year:a}}function weeksInYear(r,e,t){var n=firstWeekOffset(r,e,t),s=firstWeekOffset(r+1,e,t);return(daysInYear(r)-n+s)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addRegexToken("w",match1to2,match1to2NoLeadingZero);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2,match1to2NoLeadingZero);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(r,e,t,n){e[n.substr(0,1)]=toInt(r)});function localeWeek(r){return weekOfYear(r,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(r){var e=this.localeData().week(this);return r==null?e:this.add((r-e)*7,"d")}function getSetISOWeek(r){var e=weekOfYear(this,1,4).week;return r==null?e:this.add((r-e)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(r){return this.localeData().weekdaysMin(this,r)});addFormatToken("ddd",0,0,function(r){return this.localeData().weekdaysShort(this,r)});addFormatToken("dddd",0,0,function(r){return this.localeData().weekdays(this,r)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(r,e){return e.weekdaysMinRegex(r)});addRegexToken("ddd",function(r,e){return e.weekdaysShortRegex(r)});addRegexToken("dddd",function(r,e){return e.weekdaysRegex(r)});addWeekParseToken(["dd","ddd","dddd"],function(r,e,t,n){var s=t._locale.weekdaysParse(r,n,t._strict);s!=null?e.d=s:getParsingFlags(t).invalidWeekday=r});addWeekParseToken(["d","e","E"],function(r,e,t,n){e[n]=toInt(r)});function parseWeekday(r,e){return typeof r!="string"?r:isNaN(r)?(r=e.weekdaysParse(r),typeof r=="number"?r:null):parseInt(r,10)}function parseIsoWeekday(r,e){return typeof r=="string"?e.weekdaysParse(r)%7||7:isNaN(r)?null:r}function shiftWeekdays(r,e){return r.slice(e,7).concat(r.slice(0,e))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(r,e){var t=isArray$2(this._weekdays)?this._weekdays:this._weekdays[r&&r!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return r===!0?shiftWeekdays(t,this._week.dow):r?t[r.day()]:t}function localeWeekdaysShort(r){return r===!0?shiftWeekdays(this._weekdaysShort,this._week.dow):r?this._weekdaysShort[r.day()]:this._weekdaysShort}function localeWeekdaysMin(r){return r===!0?shiftWeekdays(this._weekdaysMin,this._week.dow):r?this._weekdaysMin[r.day()]:this._weekdaysMin}function handleStrictParse$1(r,e,t){var n,s,o,a=r.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=createUTC([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return t?e==="dddd"?(s=indexOf$1.call(this._weekdaysParse,a),s!==-1?s:null):e==="ddd"?(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1?s:null):(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null):e==="dddd"?(s=indexOf$1.call(this._weekdaysParse,a),s!==-1||(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null)):e==="ddd"?(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1||(s=indexOf$1.call(this._weekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1?s:null)):(s=indexOf$1.call(this._minWeekdaysParse,a),s!==-1||(s=indexOf$1.call(this._weekdaysParse,a),s!==-1)?s:(s=indexOf$1.call(this._shortWeekdaysParse,a),s!==-1?s:null))}function localeWeekdaysParse(r,e,t){var n,s,o;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,r,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=createUTC([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[n].test(r))return n;if(t&&e==="ddd"&&this._shortWeekdaysParse[n].test(r))return n;if(t&&e==="dd"&&this._minWeekdaysParse[n].test(r))return n;if(!t&&this._weekdaysParse[n].test(r))return n}}function getSetDayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;var e=get(this,"Day");return r!=null?(r=parseWeekday(r,this.localeData()),this.add(r-e,"d")):e}function getSetLocaleDayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return r==null?e:this.add(r-e,"d")}function getSetISODayOfWeek(r){if(!this.isValid())return r!=null?this:NaN;if(r!=null){var e=parseIsoWeekday(r,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function weekdaysRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&r?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(r){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function r(h,g){return g.length-h.length}var e=[],t=[],n=[],s=[],o,a,l,u,c;for(o=0;o<7;o++)a=createUTC([2e3,1]).day(o),l=regexEscape(this.weekdaysMin(a,"")),u=regexEscape(this.weekdaysShort(a,"")),c=regexEscape(this.weekdays(a,"")),e.push(l),t.push(u),n.push(c),s.push(l),s.push(u),s.push(c);e.sort(r),t.sort(r),n.sort(r),s.sort(r),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(r,e){addFormatToken(r,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}meridiem("a",!0);meridiem("A",!1);function matchMeridiem(r,e){return e._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2,match1to2HasZero);addRegexToken("h",match1to2,match1to2NoLeadingZero);addRegexToken("k",match1to2,match1to2NoLeadingZero);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(r,e,t){var n=toInt(r);e[HOUR]=n===24?0:n});addParseToken(["a","A"],function(r,e,t){t._isPm=t._locale.isPM(r),t._meridiem=r});addParseToken(["h","hh"],function(r,e,t){e[HOUR]=toInt(r),getParsingFlags(t).bigHour=!0});addParseToken("hmm",function(r,e,t){var n=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n)),getParsingFlags(t).bigHour=!0});addParseToken("hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n,2)),e[SECOND]=toInt(r.substr(s)),getParsingFlags(t).bigHour=!0});addParseToken("Hmm",function(r,e,t){var n=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n))});addParseToken("Hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[HOUR]=toInt(r.substr(0,n)),e[MINUTE]=toInt(r.substr(n,2)),e[SECOND]=toInt(r.substr(s))});function localeIsPM(r){return(r+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(r,e,t){return r>11?t?"pm":"PM":t?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(r,e){var t,n=Math.min(r.length,e.length);for(t=0;t<n;t+=1)if(r[t]!==e[t])return t;return n}function normalizeLocale(r){return r&&r.toLowerCase().replace("_","-")}function chooseLocale(r){for(var e=0,t,n,s,o;e<r.length;){for(o=normalizeLocale(r[e]).split("-"),t=o.length,n=normalizeLocale(r[e+1]),n=n?n.split("-"):null;t>0;){if(s=loadLocale(o.slice(0,t).join("-")),s)return s;if(n&&n.length>=t&&commonPrefix(o,n)>=t-1)break;t--}e++}return globalLocale}function isLocaleNameSane(r){return!!(r&&r.match("^[^/\\\\]*$"))}function loadLocale(r){var e=null,t;if(locales[r]===void 0&&typeof module<"u"&&module&&module.exports&&isLocaleNameSane(r))try{e=globalLocale._abbr,t=require,t("./locale/"+r),getSetGlobalLocale(e)}catch{locales[r]=null}return locales[r]}function getSetGlobalLocale(r,e){var t;return r&&(isUndefined$2(e)?t=getLocale(r):t=defineLocale(r,e),t?globalLocale=t:typeof console<"u"&&console.warn&&console.warn("Locale "+r+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(r,e){if(e!==null){var t,n=baseConfig;if(e.abbr=r,locales[r]!=null)deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=locales[r]._config;else if(e.parentLocale!=null)if(locales[e.parentLocale]!=null)n=locales[e.parentLocale]._config;else if(t=loadLocale(e.parentLocale),t!=null)n=t._config;else return localeFamilies[e.parentLocale]||(localeFamilies[e.parentLocale]=[]),localeFamilies[e.parentLocale].push({name:r,config:e}),null;return locales[r]=new Locale(mergeConfigs(n,e)),localeFamilies[r]&&localeFamilies[r].forEach(function(s){defineLocale(s.name,s.config)}),getSetGlobalLocale(r),locales[r]}else return delete locales[r],null}function updateLocale(r,e){if(e!=null){var t,n,s=baseConfig;locales[r]!=null&&locales[r].parentLocale!=null?locales[r].set(mergeConfigs(locales[r]._config,e)):(n=loadLocale(r),n!=null&&(s=n._config),e=mergeConfigs(s,e),n==null&&(e.abbr=r),t=new Locale(e),t.parentLocale=locales[r],locales[r]=t),getSetGlobalLocale(r)}else locales[r]!=null&&(locales[r].parentLocale!=null?(locales[r]=locales[r].parentLocale,r===getSetGlobalLocale()&&getSetGlobalLocale(r)):locales[r]!=null&&delete locales[r]);return locales[r]}function getLocale(r){var e;if(r&&r._locale&&r._locale._abbr&&(r=r._locale._abbr),!r)return globalLocale;if(!isArray$2(r)){if(e=loadLocale(r),e)return e;r=[r]}return chooseLocale(r)}function listLocales(){return keys$1(locales)}function checkOverflow(r){var e,t=r._a;return t&&getParsingFlags(r).overflow===-2&&(e=t[MONTH]<0||t[MONTH]>11?MONTH:t[DATE]<1||t[DATE]>daysInMonth(t[YEAR],t[MONTH])?DATE:t[HOUR]<0||t[HOUR]>24||t[HOUR]===24&&(t[MINUTE]!==0||t[SECOND]!==0||t[MILLISECOND]!==0)?HOUR:t[MINUTE]<0||t[MINUTE]>59?MINUTE:t[SECOND]<0||t[SECOND]>59?SECOND:t[MILLISECOND]<0||t[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(r)._overflowDayOfYear&&(e<YEAR||e>DATE)&&(e=DATE),getParsingFlags(r)._overflowWeeks&&e===-1&&(e=WEEK),getParsingFlags(r)._overflowWeekday&&e===-1&&(e=WEEKDAY),getParsingFlags(r).overflow=e),r}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(r){var e,t,n=r._i,s=extendedIsoRegex.exec(n)||basicIsoRegex.exec(n),o,a,l,u,c=isoDates.length,h=isoTimes.length;if(s){for(getParsingFlags(r).iso=!0,e=0,t=c;e<t;e++)if(isoDates[e][1].exec(s[1])){a=isoDates[e][0],o=isoDates[e][2]!==!1;break}if(a==null){r._isValid=!1;return}if(s[3]){for(e=0,t=h;e<t;e++)if(isoTimes[e][1].exec(s[3])){l=(s[2]||" ")+isoTimes[e][0];break}if(l==null){r._isValid=!1;return}}if(!o&&l!=null){r._isValid=!1;return}if(s[4])if(tzRegex.exec(s[4]))u="Z";else{r._isValid=!1;return}r._f=a+(l||"")+(u||""),configFromStringAndFormat(r)}else r._isValid=!1}function extractFromRFC2822Strings(r,e,t,n,s,o){var a=[untruncateYear(r),defaultLocaleMonthsShort.indexOf(e),parseInt(t,10),parseInt(n,10),parseInt(s,10)];return o&&a.push(parseInt(o,10)),a}function untruncateYear(r){var e=parseInt(r,10);return e<=49?2e3+e:e<=999?1900+e:e}function preprocessRFC2822(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(r,e,t){if(r){var n=defaultLocaleWeekdaysShort.indexOf(r),s=new Date(e[0],e[1],e[2]).getDay();if(n!==s)return getParsingFlags(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function calculateOffset(r,e,t){if(r)return obsOffsets[r];if(e)return 0;var n=parseInt(t,10),s=n%100,o=(n-s)/100;return o*60+s}function configFromRFC2822(r){var e=rfc2822.exec(preprocessRFC2822(r._i)),t;if(e){if(t=extractFromRFC2822Strings(e[4],e[3],e[2],e[5],e[6],e[7]),!checkWeekday(e[1],t,r))return;r._a=t,r._tzm=calculateOffset(e[8],e[9],e[10]),r._d=createUTCDate.apply(null,r._a),r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),getParsingFlags(r).rfc2822=!0}else r._isValid=!1}function configFromString(r){var e=aspNetJsonRegex.exec(r._i);if(e!==null){r._d=new Date(+e[1]);return}if(configFromISO(r),r._isValid===!1)delete r._isValid;else return;if(configFromRFC2822(r),r._isValid===!1)delete r._isValid;else return;r._strict?r._isValid=!1:hooks.createFromInputFallback(r)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(r){r._d=new Date(r._i+(r._useUTC?" UTC":""))});function defaults$2(r,e,t){return r??e??t}function currentDateArray(r){var e=new Date(hooks.now());return r._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function configFromArray(r){var e,t,n=[],s,o,a;if(!r._d){for(s=currentDateArray(r),r._w&&r._a[DATE]==null&&r._a[MONTH]==null&&dayOfYearFromWeekInfo(r),r._dayOfYear!=null&&(a=defaults$2(r._a[YEAR],s[YEAR]),(r._dayOfYear>daysInYear(a)||r._dayOfYear===0)&&(getParsingFlags(r)._overflowDayOfYear=!0),t=createUTCDate(a,0,r._dayOfYear),r._a[MONTH]=t.getUTCMonth(),r._a[DATE]=t.getUTCDate()),e=0;e<3&&r._a[e]==null;++e)r._a[e]=n[e]=s[e];for(;e<7;e++)r._a[e]=n[e]=r._a[e]==null?e===2?1:0:r._a[e];r._a[HOUR]===24&&r._a[MINUTE]===0&&r._a[SECOND]===0&&r._a[MILLISECOND]===0&&(r._nextDay=!0,r._a[HOUR]=0),r._d=(r._useUTC?createUTCDate:createDate).apply(null,n),o=r._useUTC?r._d.getUTCDay():r._d.getDay(),r._tzm!=null&&r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),r._nextDay&&(r._a[HOUR]=24),r._w&&typeof r._w.d<"u"&&r._w.d!==o&&(getParsingFlags(r).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(r){var e,t,n,s,o,a,l,u,c;e=r._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,a=4,t=defaults$2(e.GG,r._a[YEAR],weekOfYear(createLocal(),1,4).year),n=defaults$2(e.W,1),s=defaults$2(e.E,1),(s<1||s>7)&&(u=!0)):(o=r._locale._week.dow,a=r._locale._week.doy,c=weekOfYear(createLocal(),o,a),t=defaults$2(e.gg,r._a[YEAR],c.year),n=defaults$2(e.w,c.week),e.d!=null?(s=e.d,(s<0||s>6)&&(u=!0)):e.e!=null?(s=e.e+o,(e.e<0||e.e>6)&&(u=!0)):s=o),n<1||n>weeksInYear(t,o,a)?getParsingFlags(r)._overflowWeeks=!0:u!=null?getParsingFlags(r)._overflowWeekday=!0:(l=dayOfYearFromWeeks(t,n,s,o,a),r._a[YEAR]=l.year,r._dayOfYear=l.dayOfYear)}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(r){if(r._f===hooks.ISO_8601){configFromISO(r);return}if(r._f===hooks.RFC_2822){configFromRFC2822(r);return}r._a=[],getParsingFlags(r).empty=!0;var e=""+r._i,t,n,s,o,a,l=e.length,u=0,c,h;for(s=expandFormat(r._f,r._locale).match(formattingTokens)||[],h=s.length,t=0;t<h;t++)o=s[t],n=(e.match(getParseRegexForToken(o,r))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&getParsingFlags(r).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),u+=n.length),formatTokenFunctions[o]?(n?getParsingFlags(r).empty=!1:getParsingFlags(r).unusedTokens.push(o),addTimeToArrayFromToken(o,n,r)):r._strict&&!n&&getParsingFlags(r).unusedTokens.push(o);getParsingFlags(r).charsLeftOver=l-u,e.length>0&&getParsingFlags(r).unusedInput.push(e),r._a[HOUR]<=12&&getParsingFlags(r).bigHour===!0&&r._a[HOUR]>0&&(getParsingFlags(r).bigHour=void 0),getParsingFlags(r).parsedDateParts=r._a.slice(0),getParsingFlags(r).meridiem=r._meridiem,r._a[HOUR]=meridiemFixWrap(r._locale,r._a[HOUR],r._meridiem),c=getParsingFlags(r).era,c!==null&&(r._a[YEAR]=r._locale.erasConvertYear(c,r._a[YEAR])),configFromArray(r),checkOverflow(r)}function meridiemFixWrap(r,e,t){var n;return t==null?e:r.meridiemHour!=null?r.meridiemHour(e,t):(r.isPM!=null&&(n=r.isPM(t),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function configFromStringAndArray(r){var e,t,n,s,o,a,l=!1,u=r._f.length;if(u===0){getParsingFlags(r).invalidFormat=!0,r._d=new Date(NaN);return}for(s=0;s<u;s++)o=0,a=!1,e=copyConfig({},r),r._useUTC!=null&&(e._useUTC=r._useUTC),e._f=r._f[s],configFromStringAndFormat(e),isValid(e)&&(a=!0),o+=getParsingFlags(e).charsLeftOver,o+=getParsingFlags(e).unusedTokens.length*10,getParsingFlags(e).score=o,l?o<n&&(n=o,t=e):(n==null||o<n||a)&&(n=o,t=e,a&&(l=!0));extend$2(r,t||e)}function configFromObject(r){if(!r._d){var e=normalizeObjectUnits(r._i),t=e.day===void 0?e.date:e.day;r._a=map$1([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),configFromArray(r)}}function createFromConfig(r){var e=new Moment(checkOverflow(prepareConfig(r)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function prepareConfig(r){var e=r._i,t=r._f;return r._locale=r._locale||getLocale(r._l),e===null||t===void 0&&e===""?createInvalid({nullInput:!0}):(typeof e=="string"&&(r._i=e=r._locale.preparse(e)),isMoment(e)?new Moment(checkOverflow(e)):(isDate$2(e)?r._d=e:isArray$2(t)?configFromStringAndArray(r):t?configFromStringAndFormat(r):configFromInput(r),isValid(r)||(r._d=null),r))}function configFromInput(r){var e=r._i;isUndefined$2(e)?r._d=new Date(hooks.now()):isDate$2(e)?r._d=new Date(e.valueOf()):typeof e=="string"?configFromString(r):isArray$2(e)?(r._a=map$1(e.slice(0),function(t){return parseInt(t,10)}),configFromArray(r)):isObject$2(e)?configFromObject(r):isNumber(e)?r._d=new Date(e):hooks.createFromInputFallback(r)}function createLocalOrUTC(r,e,t,n,s){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(t===!0||t===!1)&&(n=t,t=void 0),(isObject$2(r)&&isObjectEmpty(r)||isArray$2(r)&&r.length===0)&&(r=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=s,o._l=t,o._i=r,o._f=e,o._strict=n,createFromConfig(o)}function createLocal(r,e,t,n){return createLocalOrUTC(r,e,t,n,!1)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=createLocal.apply(null,arguments);return this.isValid()&&r.isValid()?r<this?this:r:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=createLocal.apply(null,arguments);return this.isValid()&&r.isValid()?r>this?this:r:createInvalid()});function pickBy(r,e){var t,n;if(e.length===1&&isArray$2(e[0])&&(e=e[0]),!e.length)return createLocal();for(t=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][r](t))&&(t=e[n]);return t}function min(){var r=[].slice.call(arguments,0);return pickBy("isBefore",r)}function max(){var r=[].slice.call(arguments,0);return pickBy("isAfter",r)}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(r){var e,t=!1,n,s=ordering.length;for(e in r)if(hasOwnProp(r,e)&&!(indexOf$1.call(ordering,e)!==-1&&(r[e]==null||!isNaN(r[e]))))return!1;for(n=0;n<s;++n)if(r[ordering[n]]){if(t)return!1;parseFloat(r[ordering[n]])!==toInt(r[ordering[n]])&&(t=!0)}return!0}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(r){var e=normalizeObjectUnits(r),t=e.year||0,n=e.quarter||0,s=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,l=e.hour||0,u=e.minute||0,c=e.second||0,h=e.millisecond||0;this._isValid=isDurationValid(e),this._milliseconds=+h+c*1e3+u*6e4+l*1e3*60*60,this._days=+a+o*7,this._months=+s+n*3+t*12,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(r){return r instanceof Duration}function absRound(r){return r<0?Math.round(-1*r)*-1:Math.round(r)}function compareArrays(r,e,t){var n=Math.min(r.length,e.length),s=Math.abs(r.length-e.length),o=0,a;for(a=0;a<n;a++)toInt(r[a])!==toInt(e[a])&&o++;return o+s}function offset$1(r,e){addFormatToken(r,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+zeroFill(~~(t/60),2)+e+zeroFill(~~t%60,2)})}offset$1("Z",":");offset$1("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(r,e,t){t._useUTC=!0,t._tzm=offsetFromString(matchShortOffset,r)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(r,e){var t=(e||"").match(r),n,s,o;return t===null?null:(n=t[t.length-1]||[],s=(n+"").match(chunkOffset)||["-",0,0],o=+(s[1]*60)+toInt(s[2]),o===0?0:s[0]==="+"?o:-o)}function cloneWithOffset(r,e){var t,n;return e._isUTC?(t=e.clone(),n=(isMoment(r)||isDate$2(r)?r.valueOf():createLocal(r).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),hooks.updateOffset(t,!1),t):createLocal(r).local()}function getDateOffset(r){return-Math.round(r._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(r,e,t){var n=this._offset||0,s;if(!this.isValid())return r!=null?this:NaN;if(r!=null){if(typeof r=="string"){if(r=offsetFromString(matchShortOffset,r),r===null)return this}else Math.abs(r)<16&&!t&&(r=r*60);return!this._isUTC&&e&&(s=getDateOffset(this)),this._offset=r,this._isUTC=!0,s!=null&&this.add(s,"m"),n!==r&&(!e||this._changeInProgress?addSubtract(this,createDuration(r-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:getDateOffset(this)}function getSetZone(r,e){return r!=null?(typeof r!="string"&&(r=-r),this.utcOffset(r,e),this):-this.utcOffset()}function setOffsetToUTC(r){return this.utcOffset(0,r)}function setOffsetToLocal(r){return this._isUTC&&(this.utcOffset(0,r),this._isUTC=!1,r&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var r=offsetFromString(matchOffset,this._i);r!=null?this.utcOffset(r):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(r){return this.isValid()?(r=r?createLocal(r).utcOffset():0,(this.utcOffset()-r)%60===0):!1}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$2(this._isDSTShifted))return this._isDSTShifted;var r={},e;return copyConfig(r,this),r=prepareConfig(r),r._a?(e=r._isUTC?createUTC(r._a):createLocal(r._a),this._isDSTShifted=this.isValid()&&compareArrays(r._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:!1}function isUtcOffset(){return this.isValid()?this._isUTC:!1}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(r,e){var t=r,n=null,s,o,a;return isDuration(r)?t={ms:r._milliseconds,d:r._days,M:r._months}:isNumber(r)||!isNaN(+r)?(t={},e?t[e]=+r:t.milliseconds=+r):(n=aspNetRegex.exec(r))?(s=n[1]==="-"?-1:1,t={y:0,d:toInt(n[DATE])*s,h:toInt(n[HOUR])*s,m:toInt(n[MINUTE])*s,s:toInt(n[SECOND])*s,ms:toInt(absRound(n[MILLISECOND]*1e3))*s}):(n=isoRegex.exec(r))?(s=n[1]==="-"?-1:1,t={y:parseIso(n[2],s),M:parseIso(n[3],s),w:parseIso(n[4],s),d:parseIso(n[5],s),h:parseIso(n[6],s),m:parseIso(n[7],s),s:parseIso(n[8],s)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(a=momentsDifference(createLocal(t.from),createLocal(t.to)),t={},t.ms=a.milliseconds,t.M=a.months),o=new Duration(t),isDuration(r)&&hasOwnProp(r,"_locale")&&(o._locale=r._locale),isDuration(r)&&hasOwnProp(r,"_isValid")&&(o._isValid=r._isValid),o}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(r,e){var t=r&&parseFloat(r.replace(",","."));return(isNaN(t)?0:t)*e}function positiveMomentsDifference(r,e){var t={};return t.months=e.month()-r.month()+(e.year()-r.year())*12,r.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+r.clone().add(t.months,"M"),t}function momentsDifference(r,e){var t;return r.isValid()&&e.isValid()?(e=cloneWithOffset(e,r),r.isBefore(e)?t=positiveMomentsDifference(r,e):(t=positiveMomentsDifference(e,r),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function createAdder(r,e){return function(t,n){var s,o;return n!==null&&!isNaN(+n)&&(deprecateSimple(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=t,t=n,n=o),s=createDuration(t,n),addSubtract(this,s,r),this}}function addSubtract(r,e,t,n){var s=e._milliseconds,o=absRound(e._days),a=absRound(e._months);r.isValid()&&(n=n??!0,a&&setMonth(r,get(r,"Month")+a*t),o&&set$1$1(r,"Date",get(r,"Date")+o*t),s&&r._d.setTime(r._d.valueOf()+s*t),n&&hooks.updateOffset(r,o||a))}var add$2=createAdder(1,"add"),subtract$1=createAdder(-1,"subtract");function isString$1(r){return typeof r=="string"||r instanceof String}function isMomentInput(r){return isMoment(r)||isDate$2(r)||isString$1(r)||isNumber(r)||isNumberOrStringArray(r)||isMomentInputObject(r)||r===null||r===void 0}function isMomentInputObject(r){var e=isObject$2(r)&&!isObjectEmpty(r),t=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,o,a=n.length;for(s=0;s<a;s+=1)o=n[s],t=t||hasOwnProp(r,o);return e&&t}function isNumberOrStringArray(r){var e=isArray$2(r),t=!1;return e&&(t=r.filter(function(n){return!isNumber(n)&&isString$1(r)}).length===0),e&&t}function isCalendarSpec(r){var e=isObject$2(r)&&!isObjectEmpty(r),t=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,o;for(s=0;s<n.length;s+=1)o=n[s],t=t||hasOwnProp(r,o);return e&&t}function getCalendarFormat(r,e){var t=r.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function calendar$1(r,e){arguments.length===1&&(arguments[0]?isMomentInput(arguments[0])?(r=arguments[0],e=void 0):isCalendarSpec(arguments[0])&&(e=arguments[0],r=void 0):(r=void 0,e=void 0));var t=r||createLocal(),n=cloneWithOffset(t,this).startOf("day"),s=hooks.calendarFormat(this,n)||"sameElse",o=e&&(isFunction$2(e[s])?e[s].call(this,t):e[s]);return this.format(o||this.localeData().calendar(s,this,createLocal(t)))}function clone$2(){return new Moment(this)}function isAfter(r,e){var t=isMoment(r)?r:createLocal(r);return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function isBefore(r,e){var t=isMoment(r)?r:createLocal(r);return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function isBetween(r,e,t,n){var s=isMoment(r)?r:createLocal(r),o=isMoment(e)?e:createLocal(e);return this.isValid()&&s.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(s,t):!this.isBefore(s,t))&&(n[1]===")"?this.isBefore(o,t):!this.isAfter(o,t))):!1}function isSame(r,e){var t=isMoment(r)?r:createLocal(r),n;return this.isValid()&&t.isValid()?(e=normalizeUnits(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(n=t.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function isSameOrAfter(r,e){return this.isSame(r,e)||this.isAfter(r,e)}function isSameOrBefore(r,e){return this.isSame(r,e)||this.isBefore(r,e)}function diff(r,e,t){var n,s,o;if(!this.isValid())return NaN;if(n=cloneWithOffset(r,this),!n.isValid())return NaN;switch(s=(n.utcOffset()-this.utcOffset())*6e4,e=normalizeUnits(e),e){case"year":o=monthDiff(this,n)/12;break;case"month":o=monthDiff(this,n);break;case"quarter":o=monthDiff(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-s)/864e5;break;case"week":o=(this-n-s)/6048e5;break;default:o=this-n}return t?o:absFloor(o)}function monthDiff(r,e){if(r.date()<e.date())return-monthDiff(e,r);var t=(e.year()-r.year())*12+(e.month()-r.month()),n=r.clone().add(t,"months"),s,o;return e-n<0?(s=r.clone().add(t-1,"months"),o=(e-n)/(n-s)):(s=r.clone().add(t+1,"months"),o=(e-n)/(s-n)),-(t+o)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(r){if(!this.isValid())return null;var e=r!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?formatMoment(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$2(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(t,"Z")):formatMoment(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var r="moment",e="",t,n,s,o;return this.isLocal()||(r=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+r+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(t+n+s+o)}function format$2(r){r||(r=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var e=formatMoment(this,r);return this.localeData().postformat(e)}function from(r,e){return this.isValid()&&(isMoment(r)&&r.isValid()||createLocal(r).isValid())?createDuration({to:this,from:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function fromNow(r){return this.from(createLocal(),r)}function to(r,e){return this.isValid()&&(isMoment(r)&&r.isValid()||createLocal(r).isValid())?createDuration({from:this,to:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function toNow(r){return this.to(createLocal(),r)}function locale(r){var e;return r===void 0?this._locale._abbr:(e=getLocale(r),e!=null&&(this._locale=e),this)}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(r){return r===void 0?this.localeData():this.locale(r)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(r,e){return(r%e+e)%e}function localStartOfDate(r,e,t){return r<100&&r>=0?new Date(r+400,e,t)-MS_PER_400_YEARS:new Date(r,e,t).valueOf()}function utcStartOfDate(r,e,t){return r<100&&r>=0?Date.UTC(r+400,e,t)-MS_PER_400_YEARS:Date.UTC(r,e,t)}function startOf(r){var e,t;if(r=normalizeUnits(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?utcStartOfDate:localStartOfDate,r){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":e=this._d.valueOf(),e-=mod$1(e,MS_PER_MINUTE);break;case"second":e=this._d.valueOf(),e-=mod$1(e,MS_PER_SECOND);break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function endOf(r){var e,t;if(r=normalizeUnits(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?utcStartOfDate:localStartOfDate,r){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=MS_PER_HOUR-mod$1(e+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":e=this._d.valueOf(),e+=MS_PER_MINUTE-mod$1(e,MS_PER_MINUTE)-1;break;case"second":e=this._d.valueOf(),e+=MS_PER_SECOND-mod$1(e,MS_PER_SECOND)-1;break}return this._d.setTime(e),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var r=this;return[r.year(),r.month(),r.date(),r.hour(),r.minute(),r.second(),r.millisecond()]}function toObject(){var r=this;return{years:r.year(),months:r.month(),date:r.date(),hours:r.hours(),minutes:r.minutes(),seconds:r.seconds(),milliseconds:r.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend$2({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(r,e,t,n){var s=t._locale.erasParse(r,n,t._strict);s?getParsingFlags(t).era=s:getParsingFlags(t).invalidEra=r});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(r,e,t,n){var s;t._locale._eraYearOrdinalRegex&&(s=r.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[YEAR]=t._locale.eraYearOrdinalParse(r,s):e[YEAR]=parseInt(r,10)});function localeEras(r,e){var t,n,s,o=this._eras||getLocale("en")._eras;for(t=0,n=o.length;t<n;++t){switch(typeof o[t].since){case"string":s=hooks(o[t].since).startOf("day"),o[t].since=s.valueOf();break}switch(typeof o[t].until){case"undefined":o[t].until=1/0;break;case"string":s=hooks(o[t].until).startOf("day").valueOf(),o[t].until=s.valueOf();break}}return o}function localeErasParse(r,e,t){var n,s,o=this.eras(),a,l,u;for(r=r.toUpperCase(),n=0,s=o.length;n<s;++n)if(a=o[n].name.toUpperCase(),l=o[n].abbr.toUpperCase(),u=o[n].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(l===r)return o[n];break;case"NNNN":if(a===r)return o[n];break;case"NNNNN":if(u===r)return o[n];break}else if([a,l,u].indexOf(r)>=0)return o[n]}function localeErasConvertYear(r,e){var t=r.since<=r.until?1:-1;return e===void 0?hooks(r.since).year():hooks(r.since).year()+(e-r.offset)*t}function getEraName(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].name;return""}function getEraNarrow(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].narrow;return""}function getEraAbbr(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].abbr;return""}function getEraYear(){var r,e,t,n,s=this.localeData().eras();for(r=0,e=s.length;r<e;++r)if(t=s[r].since<=s[r].until?1:-1,n=this.clone().startOf("day").valueOf(),s[r].since<=n&&n<=s[r].until||s[r].until<=n&&n<=s[r].since)return(this.year()-hooks(s[r].since).year())*t+s[r].offset;return this.year()}function erasNameRegex(r){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),r?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(r){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),r?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(r){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),r?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(r,e){return e.erasAbbrRegex(r)}function matchEraName(r,e){return e.erasNameRegex(r)}function matchEraNarrow(r,e){return e.erasNarrowRegex(r)}function matchEraYearOrdinal(r,e){return e._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var r=[],e=[],t=[],n=[],s,o,a,l,u,c=this.eras();for(s=0,o=c.length;s<o;++s)a=regexEscape(c[s].name),l=regexEscape(c[s].abbr),u=regexEscape(c[s].narrow),e.push(a),r.push(l),t.push(u),n.push(a),n.push(l),n.push(u);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(r,e){addFormatToken(0,[r,r.length],0,e)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(r,e,t,n){e[n.substr(0,2)]=toInt(r)});addWeekParseToken(["gg","GG"],function(r,e,t,n){e[n]=hooks.parseTwoDigitYear(r)});function getSetWeekYear(r){return getSetWeekYearHelper.call(this,r,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(r){return getSetWeekYearHelper.call(this,r,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var r=this.localeData()._week;return weeksInYear(this.year(),r.dow,r.doy)}function getWeeksInWeekYear(){var r=this.localeData()._week;return weeksInYear(this.weekYear(),r.dow,r.doy)}function getSetWeekYearHelper(r,e,t,n,s){var o;return r==null?weekOfYear(this,n,s).year:(o=weeksInYear(r,n,s),e>o&&(e=o),setWeekAll.call(this,r,e,t,n,s))}function setWeekAll(r,e,t,n,s){var o=dayOfYearFromWeeks(r,e,t,n,s),a=createUTCDate(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}addFormatToken("Q",0,"Qo","quarter");addRegexToken("Q",match1);addParseToken("Q",function(r,e){e[MONTH]=(toInt(r)-1)*3});function getSetQuarter(r){return r==null?Math.ceil((this.month()+1)/3):this.month((r-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addRegexToken("D",match1to2,match1to2NoLeadingZero);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(r,e){return r?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(r,e){e[DATE]=toInt(r.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(r,e,t){t._dayOfYear=toInt(r)});function getSetDayOfYear(r){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return r==null?e:this.add(r-e,"d")}addFormatToken("m",["mm",2],0,"minute");addRegexToken("m",match1to2,match1to2HasZero);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second");addRegexToken("s",match1to2,match1to2HasZero);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(r,e){e[MILLISECOND]=toInt(("0."+r)*1e3)}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add$2;proto.calendar=calendar$1;proto.clone=clone$2;proto.diff=diff;proto.endOf=endOf;proto.format=format$2;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract$1;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;typeof Symbol<"u"&&Symbol.for!=null&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth$1;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(r){return createLocal(r*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(r){return r}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set$1;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(r,e,t,n){var s=getLocale(),o=createUTC().set(n,e);return s[t](o,r)}function listMonthsImpl(r,e,t){if(isNumber(r)&&(e=r,r=void 0),r=r||"",e!=null)return get$1(r,e,t,"month");var n,s=[];for(n=0;n<12;n++)s[n]=get$1(r,n,t,"month");return s}function listWeekdaysImpl(r,e,t,n){typeof r=="boolean"?(isNumber(e)&&(t=e,e=void 0),e=e||""):(e=r,t=e,r=!1,isNumber(e)&&(t=e,e=void 0),e=e||"");var s=getLocale(),o=r?s._week.dow:0,a,l=[];if(t!=null)return get$1(e,(t+o)%7,n,"day");for(a=0;a<7;a++)l[a]=get$1(e,(a+o)%7,n,"day");return l}function listMonths(r,e){return listMonthsImpl(r,e,"months")}function listMonthsShort(r,e){return listMonthsImpl(r,e,"monthsShort")}function listWeekdays(r,e,t){return listWeekdaysImpl(r,e,t,"weekdays")}function listWeekdaysShort(r,e,t){return listWeekdaysImpl(r,e,t,"weekdaysShort")}function listWeekdaysMin(r,e,t){return listWeekdaysImpl(r,e,t,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(r){var e=r%10,t=toInt(r%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return r+t}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs$1(){var r=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),r.milliseconds=mathAbs(r.milliseconds),r.seconds=mathAbs(r.seconds),r.minutes=mathAbs(r.minutes),r.hours=mathAbs(r.hours),r.months=mathAbs(r.months),r.years=mathAbs(r.years),this}function addSubtract$1(r,e,t,n){var s=createDuration(e,t);return r._milliseconds+=n*s._milliseconds,r._days+=n*s._days,r._months+=n*s._months,r._bubble()}function add$1$1(r,e){return addSubtract$1(this,r,e,1)}function subtract$1$1(r,e){return addSubtract$1(this,r,e,-1)}function absCeil(r){return r<0?Math.floor(r):Math.ceil(r)}function bubble(){var r=this._milliseconds,e=this._days,t=this._months,n=this._data,s,o,a,l,u;return r>=0&&e>=0&&t>=0||r<=0&&e<=0&&t<=0||(r+=absCeil(monthsToDays(t)+e)*864e5,e=0,t=0),n.milliseconds=r%1e3,s=absFloor(r/1e3),n.seconds=s%60,o=absFloor(s/60),n.minutes=o%60,a=absFloor(o/60),n.hours=a%24,e+=absFloor(a/24),u=absFloor(daysToMonths(e)),t+=u,e-=absCeil(monthsToDays(u)),l=absFloor(t/12),t%=12,n.days=e,n.months=t,n.years=l,this}function daysToMonths(r){return r*4800/146097}function monthsToDays(r){return r*146097/4800}function as(r){if(!this.isValid())return NaN;var e,t,n=this._milliseconds;if(r=normalizeUnits(r),r==="month"||r==="quarter"||r==="year")switch(e=this._days+n/864e5,t=this._months+daysToMonths(e),r){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(monthsToDays(this._months)),r){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+r)}}function makeAs(r){return function(){return this.as(r)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y"),valueOf$1=asMilliseconds;function clone$1$1(){return createDuration(this)}function get$2(r){return r=normalizeUnits(r),this.isValid()?this[r+"s"]():NaN}function makeGetter(r){return function(){return this.isValid()?this._data[r]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(r,e,t,n,s){return s.relativeTime(e||1,!!t,r,n)}function relativeTime$1(r,e,t,n){var s=createDuration(r).abs(),o=round(s.as("s")),a=round(s.as("m")),l=round(s.as("h")),u=round(s.as("d")),c=round(s.as("M")),h=round(s.as("w")),g=round(s.as("y")),v=o<=t.ss&&["s",o]||o<t.s&&["ss",o]||a<=1&&["m"]||a<t.m&&["mm",a]||l<=1&&["h"]||l<t.h&&["hh",l]||u<=1&&["d"]||u<t.d&&["dd",u];return t.w!=null&&(v=v||h<=1&&["w"]||h<t.w&&["ww",h]),v=v||c<=1&&["M"]||c<t.M&&["MM",c]||g<=1&&["y"]||["yy",g],v[2]=e,v[3]=+r>0,v[4]=n,substituteTimeAgo.apply(null,v)}function getSetRelativeTimeRounding(r){return r===void 0?round:typeof r=="function"?(round=r,!0):!1}function getSetRelativeTimeThreshold(r,e){return thresholds[r]===void 0?!1:e===void 0?thresholds[r]:(thresholds[r]=e,r==="s"&&(thresholds.ss=e-1),!0)}function humanize(r,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,n=thresholds,s,o;return typeof r=="object"&&(e=r,r=!1),typeof r=="boolean"&&(t=r),typeof e=="object"&&(n=Object.assign({},thresholds,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),s=this.localeData(),o=relativeTime$1(this,!t,n,s),t&&(o=s.pastFuture(+this,o)),s.postformat(o)}var abs$1$1=Math.abs;function sign(r){return(r>0)-(r<0)||+r}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var r=abs$1$1(this._milliseconds)/1e3,e=abs$1$1(this._days),t=abs$1$1(this._months),n,s,o,a,l=this.asSeconds(),u,c,h,g;return l?(n=absFloor(r/60),s=absFloor(n/60),r%=60,n%=60,o=absFloor(t/12),t%=12,a=r?r.toFixed(3).replace(/\.?0+$/,""):"",u=l<0?"-":"",c=sign(this._months)!==sign(l)?"-":"",h=sign(this._days)!==sign(l)?"-":"",g=sign(this._milliseconds)!==sign(l)?"-":"",u+"P"+(o?c+o+"Y":"")+(t?c+t+"M":"")+(e?h+e+"D":"")+(s||n||r?"T":"")+(s?g+s+"H":"")+(n?g+n+"M":"")+(r?g+a+"S":"")):"P0D"}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs$1;proto$2.add=add$1$1;proto$2.subtract=subtract$1$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(r,e,t){t._d=new Date(parseFloat(r)*1e3)});addParseToken("x",function(r,e,t){t._d=new Date(toInt(r))});//! moment.js
hooks.version="2.30.1";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate$2;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var r=requireFunctionUncurryThis(),e=Set.prototype;return setHelpers={Set,add:r(e.add),has:r(e.has),remove:r(e.delete),proto:e},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var r=requireSetHelpers().has;return aSet=function(e){return r(e),e},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var r=requireFunctionCall();return iterateSimple=function(e,t,n){for(var s=n?e:e.iterator,o=e.next,a,l;!(a=r(o,s)).done;)if(l=t(a.value),l!==void 0)return l},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var r=requireFunctionUncurryThis(),e=requireIterateSimple(),t=requireSetHelpers(),n=t.Set,s=t.proto,o=r(s.forEach),a=r(s.keys),l=a(new n).next;return setIterate=function(u,c,h){return h?e({iterator:a(u),next:l},c):o(u,c)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var r=requireSetHelpers(),e=requireSetIterate(),t=r.Set,n=r.add;return setClone=function(s){var o=new t;return e(s,function(a){n(o,a)}),o},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var r=requireFunctionUncurryThisAccessor(),e=requireSetHelpers();return setSize=r(e.proto,"size","get")||function(t){return t.size},setSize}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var r=requireACallable(),e=requireAnObject(),t=requireFunctionCall(),n=requireToIntegerOrInfinity(),s=requireGetIteratorDirect(),o="Invalid size",a=RangeError,l=TypeError,u=Math.max,c=function(h,g){this.set=h,this.size=u(g,0),this.has=r(h.has),this.keys=r(h.keys)};return c.prototype={getIterator:function(){return s(e(t(this.keys,this.set)))},includes:function(h){return t(this.has,this.set,h)}},getSetRecord=function(h){e(h);var g=+h.size;if(g!==g)throw new l(o);var v=n(g);if(v<0)throw new a(o);return new c(h,v)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetClone(),n=requireSetSize(),s=requireGetSetRecord(),o=requireSetIterate(),a=requireIterateSimple(),l=e.has,u=e.remove;return setDifference=function(h){var g=r(this),v=s(h),m=t(g);return n(g)<=v.size?o(g,function(E){v.includes(E)&&u(m,E)}):a(v.getIterator(),function(E){l(g,E)&&u(m,E)}),m},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var r=requireGetBuiltIn(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},t=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(n,s){var o=r("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!s)return!0;try{return new o()[n](t(-1/0)),!1}catch{var a=new o;return a.add(1),a.add(2),s(a[n](t(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var r=require_export(),e=requireSetDifference(),t=requireSetMethodAcceptSetLike(),n=!t("difference",function(s){return s.size===0});return r({target:"Set",proto:!0,real:!0,forced:n},{difference:e}),es_set_difference_v2}requireEs_set_difference_v2();var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetSize(),n=requireGetSetRecord(),s=requireSetIterate(),o=requireIterateSimple(),a=e.Set,l=e.add,u=e.has;return setIntersection=function(h){var g=r(this),v=n(h),m=new a;return t(g)>v.size?o(v.getIterator(),function(E){u(g,E)&&l(m,E)}):s(g,function(E){v.includes(E)&&l(m,E)}),m},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var r=require_export(),e=requireFails(),t=requireSetIntersection(),n=requireSetMethodAcceptSetLike(),s=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return r({target:"Set",proto:!0,real:!0,forced:s},{intersection:t}),es_set_intersection_v2}requireEs_set_intersection_v2();var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var r=requireASet(),e=requireSetHelpers().has,t=requireSetSize(),n=requireGetSetRecord(),s=requireSetIterate(),o=requireIterateSimple(),a=requireIteratorClose();return setIsDisjointFrom=function(u){var c=r(this),h=n(u);if(t(c)<=h.size)return s(c,function(v){if(h.includes(v))return!1},!0)!==!1;var g=h.getIterator();return o(g,function(v){if(e(c,v))return a(g,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var r=require_export(),e=requireSetIsDisjointFrom(),t=requireSetMethodAcceptSetLike(),n=!t("isDisjointFrom",function(s){return!s});return r({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),es_set_isDisjointFrom_v2}requireEs_set_isDisjointFrom_v2();var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var r=requireASet(),e=requireSetSize(),t=requireSetIterate(),n=requireGetSetRecord();return setIsSubsetOf=function(o){var a=r(this),l=n(o);return e(a)>l.size?!1:t(a,function(u){if(!l.includes(u))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var r=require_export(),e=requireSetIsSubsetOf(),t=requireSetMethodAcceptSetLike(),n=!t("isSubsetOf",function(s){return s});return r({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),es_set_isSubsetOf_v2}requireEs_set_isSubsetOf_v2();var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var r=requireASet(),e=requireSetHelpers().has,t=requireSetSize(),n=requireGetSetRecord(),s=requireIterateSimple(),o=requireIteratorClose();return setIsSupersetOf=function(l){var u=r(this),c=n(l);if(t(u)<c.size)return!1;var h=c.getIterator();return s(h,function(g){if(!e(u,g))return o(h,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var r=require_export(),e=requireSetIsSupersetOf(),t=requireSetMethodAcceptSetLike(),n=!t("isSupersetOf",function(s){return!s});return r({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),es_set_isSupersetOf_v2}requireEs_set_isSupersetOf_v2();var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var r=requireASet(),e=requireSetHelpers(),t=requireSetClone(),n=requireGetSetRecord(),s=requireIterateSimple(),o=e.add,a=e.has,l=e.remove;return setSymmetricDifference=function(c){var h=r(this),g=n(c).getIterator(),v=t(h);return s(g,function(m){a(h,m)?l(v,m):o(v,m)}),v},setSymmetricDifference}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var r=require_export(),e=requireSetSymmetricDifference(),t=requireSetMethodAcceptSetLike();return r({target:"Set",proto:!0,real:!0,forced:!t("symmetricDifference")},{symmetricDifference:e}),es_set_symmetricDifference_v2}requireEs_set_symmetricDifference_v2();var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var r=requireASet(),e=requireSetHelpers().add,t=requireSetClone(),n=requireGetSetRecord(),s=requireIterateSimple();return setUnion=function(a){var l=r(this),u=n(a).getIterator(),c=t(l);return s(u,function(h){e(c,h)}),c},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var r=require_export(),e=requireSetUnion(),t=requireSetMethodAcceptSetLike();return r({target:"Set",proto:!0,real:!0,forced:!t("union")},{union:e}),es_set_union_v2}requireEs_set_union_v2();function to2dArray(r){const e=r.length;let t=0;for(;t<e;)r[t]=[r[t]],t+=1}function extendArray(r,e){const t=e.length;let n=0;for(;n<t;)r.push(e[n]),n+=1}function pivot(r){const e=[];if(!r||r.length===0||!r[0]||r[0].length===0)return e;const t=r.length,n=r[0].length;for(let s=0;s<t;s++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][s]=r[s][o];return e}function arrayReduce(r,e,t,n){let s=-1,o=r,a=t;Array.isArray(r)||(o=Array.from(r));const l=o.length;for(s+=1;s<l;)a=e(a,o[s],s,o),s+=1;return a}function arrayFilter(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,o=[];let a=-1;for(;t<s;){const l=n[t];e(l,t,n)&&(a+=1,o[a]=l),t+=1}return o}function arrayMap(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,o=[];let a=-1;for(;t<s;){const l=n[t];a+=1,o[a]=e(l,t,n),t+=1}return o}function arrayEach(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length;for(;t<s&&e(n[t],t,n)!==!1;)t+=1;return r}function arrayUnique(r){const e=[];return arrayEach(r,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function getDifferenceOfArrays(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const[n,...s]=[...e];let o=n;return arrayEach(s,a=>{o=o.filter(l=>!a.includes(l))}),o}function stringToArray(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return r.split(e)}function toSingleLine(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return arrayReduce(r,(o,a,l)=>{const u=a.replace(/\r?\n\s*/g,""),c=t[l]?t[l]:"";return o+u+c},"").trim()}function stringify$1(r){let e;switch(typeof r){case"string":case"number":e=`${r}`;break;case"object":e=r===null?"":r.toString();break;case"undefined":e="";break;default:e=r.toString();break}return e}function isDefined(r){return typeof r<"u"}function isUndefined$1(r){return typeof r>"u"}function isEmpty$1(r){return r===null||r===""||isUndefined$1(r)}function isRegExp$1(r){return Object.prototype.toString.call(r)==="[object RegExp]"}const _m="length",_hd$1=r=>parseInt(r,16),_pi$1=r=>parseInt(r,10),_ss$1=(r,e,t)=>r.substr(e,t),_cp$1=r=>r.codePointAt(0)-65,_norm=r=>`${r}`.replace(/\-/g,""),_extractTime=r=>_hd$1(_ss$1(_norm(r),_hd$1("12"),_cp$1("F")))/(_hd$1(_ss$1(_norm(r),_cp$1("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified$1=!1;const consoleMessages$1={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return toSingleLine`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(r,e){const t=!isEmpty$1(r),n=typeof r=="string"&&r.toLowerCase()==="non-commercial-and-evaluation",s="15.0.0";let o,a="invalid",l="invalid";r=_norm(r||"");const u=_checkKeySchema(r);if(t||n||u)if(u){const c=hooks("16/12/2024","DD/MM/YYYY"),h=Math.floor(c.toDate().getTime()/864e5),g=_extractTime(r);o=hooks((g+1)*864e5,"x").format("MMMM DD, YYYY"),h>g?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(_ignored()&&(a="valid",l="valid"),!_notified$1&&a!=="valid"&&(consoleMessages$1[a]({keyValidityDate:o,hotVersion:s})&&console[a==="non_commercial"?"info":"warn"](consoleMessages$1[a]({keyValidityDate:o,hotVersion:s})),_notified$1=!0),l!=="valid"&&e.parentNode&&domMessages[l]({keyValidityDate:o,hotVersion:s})){const h=document.createElement("div");h.className="handsontable hot-display-license-info",h.innerHTML=domMessages[l]({keyValidityDate:o,hotVersion:s}),e.parentNode.insertBefore(h,e.nextSibling)}}function _checkKeySchema(r){let e=[][_m],t=e;if(r[_m]!==_cp$1("Z"))return!1;for(let n="",s="B<H4P+".split(""),o=_cp$1(s.shift());o;o=_cp$1(s.shift()||"A"))--o<""[_m]?t=t|(_pi$1(`${_pi$1(_hd$1(n)+(_hd$1(_ss$1(r,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_ss$1(r,o,o?s[_m]===1?9:8:6);return t===e}var es_json_stringify={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var r=requireFunctionUncurryThis();return arraySlice=r([].slice),arraySlice}var getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var r=requireFunctionUncurryThis(),e=requireIsArray(),t=requireIsCallable(),n=requireClassofRaw(),s=requireToString(),o=r([].push);return getJsonReplacerFunction=function(a){if(t(a))return a;if(e(a)){for(var l=a.length,u=[],c=0;c<l;c++){var h=a[c];typeof h=="string"?o(u,h):(typeof h=="number"||n(h)==="Number"||n(h)==="String")&&o(u,s(h))}var g=u.length,v=!0;return function(m,E){if(v)return v=!1,E;if(e(this))return E;for(var _=0;_<g;_++)if(u[_]===m)return E}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var r=require_export(),e=requireGetBuiltIn(),t=requireFunctionApply(),n=requireFunctionCall(),s=requireFunctionUncurryThis(),o=requireFails(),a=requireIsCallable(),l=requireIsSymbol(),u=requireArraySlice(),c=requireGetJsonReplacerFunction(),h=requireSymbolConstructorDetection(),g=String,v=e("JSON","stringify"),m=s(/./.exec),E=s("".charAt),_=s("".charCodeAt),S=s("".replace),w=s(1 .toString),A=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,D=/^[\uDC00-\uDFFF]$/,Y=!h||o(function(){var se=e("Symbol")("stringify detection");return v([se])!=="[null]"||v({a:se})!=="{}"||v(Object(se))!=="{}"}),H=o(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),k=function(se,re){var Ce=u(arguments),Le=c(re);if(!(!a(Le)&&(se===void 0||l(se))))return Ce[1]=function(he,ve){if(a(Le)&&(ve=n(Le,this,g(he),ve)),!l(ve))return ve},t(v,null,Ce)},K=function(se,re,Ce){var Le=E(Ce,re-1),he=E(Ce,re+1);return m(O,se)&&!m(D,he)||m(D,se)&&!m(O,Le)?"\\u"+w(_(se,0),16):se};return v&&r({target:"JSON",stat:!0,arity:3,forced:Y||H},{stringify:function(re,Ce,Le){var he=u(arguments),ve=t(Y?k:v,null,he);return H&&typeof ve=="string"?S(ve,A,K):ve}}),es_json_stringify}requireEs_json_stringify();var esnext_iterator_forEach={},es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{forEach:function(a){n(this),t(a);var l=s(this),u=0;e(l,function(c){a(c,u++)},{IS_RECORD:!0})}}),es_iterator_forEach}var hasRequiredEsnext_iterator_forEach;function requireEsnext_iterator_forEach(){return hasRequiredEsnext_iterator_forEach||(hasRequiredEsnext_iterator_forEach=1,requireEs_iterator_forEach()),esnext_iterator_forEach}requireEsnext_iterator_forEach();function duckSchema(r){let e;return Array.isArray(r)?e=r.length?new Array(r.length).fill(null):[]:(e={},objectEach(r,(t,n)=>{n!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[n]=duckSchema(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[n]=[duckSchema(t[0])]:e[n]=[]:e[n]=null)})),e}function inherit(r,e){return e.prototype.constructor=e,r.prototype=new e,r.prototype.constructor=r,r}function extend$1(r,e,t){const n=Array.isArray(t);return objectEach(e,(s,o)=>{(n===!1||t.includes(o))&&(r[o]=s)}),r}function deepExtend(r,e){objectEach(e,(t,n)=>{e[n]&&typeof e[n]=="object"?(r[n]||(Array.isArray(e[n])?r[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?r[n]=e[n]:r[n]={}),deepExtend(r[n],e[n])):r[n]=e[n]})}function deepClone(r){return typeof r=="object"?JSON.parse(JSON.stringify(r)):r}function clone$1(r){const e={};return objectEach(r,(t,n)=>{e[n]=t}),e}function mixin(r){r.MIXINS||(r.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return arrayEach(t,s=>{r.MIXINS.push(s.MIXIN_NAME),objectEach(s,(o,a)=>{if(r.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof o=="function")r.prototype[a]=o;else{const l=function(h,g){const v=`_${h}`,m=E=>{let _=E;return(Array.isArray(_)||isObject$1(_))&&(_=deepClone(_)),_};return function(){return this[v]===void 0&&(this[v]=m(g)),this[v]}},u=function(h){const g=`_${h}`;return function(v){this[g]=v}};Object.defineProperty(r.prototype,a,{get:l(a,o),set:u(a),configurable:!0})}})}),r}function isObjectEqual(r,e){return JSON.stringify(r)===JSON.stringify(e)}function isObject$1(r){return Object.prototype.toString.call(r)==="[object Object]"}function defineGetter(r,e,t,n){n.value=t,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(r,e,n)}function objectEach(r,e){for(const t in r)if((!r.hasOwnProperty||r.hasOwnProperty&&Object.prototype.hasOwnProperty.call(r,t))&&e(r[t],t,r)===!1)break;return r}function getProperty(r,e){const t=e.split(".");let n=r;return objectEach(t,s=>{if(n=n[s],n===void 0)return n=void 0,!1}),n}function setProperty(r,e,t){const n=e.split(".");let s=r;n.forEach((o,a)=>{a!==n.length-1?(hasOwnProperty(s,o)||(s[o]={}),s=s[o]):s[o]=t})}function deepObjectSize(r){if(!isObject$1(r))return 0;const e=function(t){let n=0;return isObject$1(t)?objectEach(t,(s,o)=>{o!=="__children"&&(n+=e(s))}):n+=1,n};return e(r)}function createObjectPropListener(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,n={_touched:!1,[t]:r,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[t]},set(s){this._touched=!0,this[t]=s},enumerable:!0,configurable:!0}),n}function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}const MIXIN_NAME$6="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(r,e){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,e),this._hooksStorage[r].push(e),this},removeHooksByKey(r){arrayEach(this._hooksStorage[r]||[],e=>{this.hot.removeHook(r,e)})},clearHooks(){objectEach(this._hooksStorage,(r,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply||(apply=function(e,t,n){return e.apply(t,n)});construct||(construct=function(e,t){return new e(...t)});const arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return apply(r,e,n)}}function unconstruct(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return construct(r,t)}}function addToSet(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const o=t(s);o!==s&&(isFrozen(e)||(e[n]=o),s=o)}r[s]=!0}return r}function cleanArray(r){for(let e=0;e<r.length;e++)objectHasOwnProperty(r,e)||(r[e]=null);return r}function clone(r){const e=create(null);for(const[t,n]of entries(r))objectHasOwnProperty(r,t)&&(Array.isArray(n)?e[t]=cleanArray(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=clone(n):e[t]=n);return e}function lookupGetter(r,e){for(;r!==null;){const n=getOwnPropertyDescriptor(r,e);if(n){if(n.get)return unapply(n.get);if(typeof n.value=="function")return unapply(n.value)}r=getPrototypeOf(r)}function t(){return null}return t}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*}/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},_createHooksMap=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=pt=>createDOMPurify(pt);if(e.version="3.2.3",e.removed=[],!r||!r.document||r.document.nodeType!==NODE_TYPE.document)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:l,Element:u,NodeFilter:c,NamedNodeMap:h=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:g,DOMParser:v,trustedTypes:m}=r,E=u.prototype,_=lookupGetter(E,"cloneNode"),S=lookupGetter(E,"remove"),w=lookupGetter(E,"nextSibling"),A=lookupGetter(E,"childNodes"),O=lookupGetter(E,"parentNode");if(typeof a=="function"){const pt=t.createElement("template");pt.content&&pt.content.ownerDocument&&(t=pt.content.ownerDocument)}let D,Y="";const{implementation:H,createNodeIterator:k,createDocumentFragment:K,getElementsByTagName:se}=t,{importNode:re}=n;let Ce=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof O=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Le,ERB_EXPR:he,TMPLIT_EXPR:ve,DATA_ATTR:xe,ARIA_ATTR:Ie,IS_SCRIPT_OR_DATA:we,ATTR_WHITESPACE:Ne,CUSTOM_ELEMENT:at}=EXPRESSIONS;let{IS_ALLOWED_URI:nt}=EXPRESSIONS,B=null;const te=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let V=null;const ue=addToSet({},[...html,...svg,...mathMl,...xml]);let Ae=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ve=null,He=null,be=!0,qe=!0,le=!1,pe=!0,Se=!1,Ye=!0,Fe=!1,je=!1,rt=!1,Ue=!1,Xe=!1,et=!1,Qe=!0,st=!1;const St="user-content-";let At=!0,j=!1,X={},P=null;const R=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ae=null;const Pe=addToSet({},["audio","video","img","source","image","track"]);let Oe=null;const oe=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ee="http://www.w3.org/1998/Math/MathML",fe="http://www.w3.org/2000/svg",Re="http://www.w3.org/1999/xhtml";let $e=Re,Je=!1,Be=null;const ot=addToSet({},[ee,fe,Re],stringToString);let gt=addToSet({},["mi","mo","mn","ms","mtext"]),b=addToSet({},["annotation-xml"]);const q=addToSet({},["title","style","font","a","script"]);let F=null;const W=["application/xhtml+xml","text/html"],z="text/html";let ie=null,_e=null;const J=t.createElement("form"),me=function(Me){return Me instanceof RegExp||Me instanceof Function},L=function(){let Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(_e&&_e===Me)){if((!Me||typeof Me!="object")&&(Me={}),Me=clone(Me),F=W.indexOf(Me.PARSER_MEDIA_TYPE)===-1?z:Me.PARSER_MEDIA_TYPE,ie=F==="application/xhtml+xml"?stringToString:stringToLowerCase,B=objectHasOwnProperty(Me,"ALLOWED_TAGS")?addToSet({},Me.ALLOWED_TAGS,ie):te,V=objectHasOwnProperty(Me,"ALLOWED_ATTR")?addToSet({},Me.ALLOWED_ATTR,ie):ue,Be=objectHasOwnProperty(Me,"ALLOWED_NAMESPACES")?addToSet({},Me.ALLOWED_NAMESPACES,stringToString):ot,Oe=objectHasOwnProperty(Me,"ADD_URI_SAFE_ATTR")?addToSet(clone(oe),Me.ADD_URI_SAFE_ATTR,ie):oe,ae=objectHasOwnProperty(Me,"ADD_DATA_URI_TAGS")?addToSet(clone(Pe),Me.ADD_DATA_URI_TAGS,ie):Pe,P=objectHasOwnProperty(Me,"FORBID_CONTENTS")?addToSet({},Me.FORBID_CONTENTS,ie):R,Ve=objectHasOwnProperty(Me,"FORBID_TAGS")?addToSet({},Me.FORBID_TAGS,ie):{},He=objectHasOwnProperty(Me,"FORBID_ATTR")?addToSet({},Me.FORBID_ATTR,ie):{},X=objectHasOwnProperty(Me,"USE_PROFILES")?Me.USE_PROFILES:!1,be=Me.ALLOW_ARIA_ATTR!==!1,qe=Me.ALLOW_DATA_ATTR!==!1,le=Me.ALLOW_UNKNOWN_PROTOCOLS||!1,pe=Me.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=Me.SAFE_FOR_TEMPLATES||!1,Ye=Me.SAFE_FOR_XML!==!1,Fe=Me.WHOLE_DOCUMENT||!1,Ue=Me.RETURN_DOM||!1,Xe=Me.RETURN_DOM_FRAGMENT||!1,et=Me.RETURN_TRUSTED_TYPE||!1,rt=Me.FORCE_BODY||!1,Qe=Me.SANITIZE_DOM!==!1,st=Me.SANITIZE_NAMED_PROPS||!1,At=Me.KEEP_CONTENT!==!1,j=Me.IN_PLACE||!1,nt=Me.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,$e=Me.NAMESPACE||Re,gt=Me.MATHML_TEXT_INTEGRATION_POINTS||gt,b=Me.HTML_INTEGRATION_POINTS||b,Ae=Me.CUSTOM_ELEMENT_HANDLING||{},Me.CUSTOM_ELEMENT_HANDLING&&me(Me.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ae.tagNameCheck=Me.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Me.CUSTOM_ELEMENT_HANDLING&&me(Me.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ae.attributeNameCheck=Me.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Me.CUSTOM_ELEMENT_HANDLING&&typeof Me.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ae.allowCustomizedBuiltInElements=Me.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(qe=!1),Xe&&(Ue=!0),X&&(B=addToSet({},text),V=[],X.html===!0&&(addToSet(B,html$1),addToSet(V,html)),X.svg===!0&&(addToSet(B,svg$1),addToSet(V,svg),addToSet(V,xml)),X.svgFilters===!0&&(addToSet(B,svgFilters),addToSet(V,svg),addToSet(V,xml)),X.mathMl===!0&&(addToSet(B,mathMl$1),addToSet(V,mathMl),addToSet(V,xml))),Me.ADD_TAGS&&(B===te&&(B=clone(B)),addToSet(B,Me.ADD_TAGS,ie)),Me.ADD_ATTR&&(V===ue&&(V=clone(V)),addToSet(V,Me.ADD_ATTR,ie)),Me.ADD_URI_SAFE_ATTR&&addToSet(Oe,Me.ADD_URI_SAFE_ATTR,ie),Me.FORBID_CONTENTS&&(P===R&&(P=clone(P)),addToSet(P,Me.FORBID_CONTENTS,ie)),At&&(B["#text"]=!0),Fe&&addToSet(B,["html","head","body"]),B.table&&(addToSet(B,["tbody"]),delete Ve.tbody),Me.TRUSTED_TYPES_POLICY){if(typeof Me.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Me.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');D=Me.TRUSTED_TYPES_POLICY,Y=D.createHTML("")}else D===void 0&&(D=_createTrustedTypesPolicy(m,s)),D!==null&&typeof Y=="string"&&(Y=D.createHTML(""));freeze&&freeze(Me),_e=Me}},Z=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),de=addToSet({},[...mathMl$1,...mathMlDisallowed]),Ee=function(Me){let dt=O(Me);(!dt||!dt.tagName)&&(dt={namespaceURI:$e,tagName:"template"});const wt=stringToLowerCase(Me.tagName),Ot=stringToLowerCase(dt.tagName);return Be[Me.namespaceURI]?Me.namespaceURI===fe?dt.namespaceURI===Re?wt==="svg":dt.namespaceURI===ee?wt==="svg"&&(Ot==="annotation-xml"||gt[Ot]):!!Z[wt]:Me.namespaceURI===ee?dt.namespaceURI===Re?wt==="math":dt.namespaceURI===fe?wt==="math"&&b[Ot]:!!de[wt]:Me.namespaceURI===Re?dt.namespaceURI===fe&&!b[Ot]||dt.namespaceURI===ee&&!gt[Ot]?!1:!de[wt]&&(q[wt]||!Z[wt]):!!(F==="application/xhtml+xml"&&Be[Me.namespaceURI]):!1},ye=function(Me){arrayPush(e.removed,{element:Me});try{O(Me).removeChild(Me)}catch{S(Me)}},Ge=function(Me,dt){try{arrayPush(e.removed,{attribute:dt.getAttributeNode(Me),from:dt})}catch{arrayPush(e.removed,{attribute:null,from:dt})}if(dt.removeAttribute(Me),Me==="is")if(Ue||Xe)try{ye(dt)}catch{}else try{dt.setAttribute(Me,"")}catch{}},tt=function(Me){let dt=null,wt=null;if(rt)Me="<remove></remove>"+Me;else{const bt=stringMatch(Me,/^[\r\n\t ]+/);wt=bt&&bt[0]}F==="application/xhtml+xml"&&$e===Re&&(Me='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Me+"</body></html>");const Ot=D?D.createHTML(Me):Me;if($e===Re)try{dt=new v().parseFromString(Ot,F)}catch{}if(!dt||!dt.documentElement){dt=H.createDocument($e,"template",null);try{dt.documentElement.innerHTML=Je?Y:Ot}catch{}}const Bt=dt.body||dt.documentElement;return Me&&wt&&Bt.insertBefore(t.createTextNode(wt),Bt.childNodes[0]||null),$e===Re?se.call(dt,Fe?"html":"body")[0]:Fe?dt.documentElement:Bt},ft=function(Me){return k.call(Me.ownerDocument||Me,Me,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},We=function(Me){return Me instanceof g&&(typeof Me.nodeName!="string"||typeof Me.textContent!="string"||typeof Me.removeChild!="function"||!(Me.attributes instanceof h)||typeof Me.removeAttribute!="function"||typeof Me.setAttribute!="function"||typeof Me.namespaceURI!="string"||typeof Me.insertBefore!="function"||typeof Me.hasChildNodes!="function")},yt=function(Me){return typeof l=="function"&&Me instanceof l};function Ct(pt,Me,dt){arrayForEach(pt,wt=>{wt.call(e,Me,dt,_e)})}const Mt=function(Me){let dt=null;if(Ct(Ce.beforeSanitizeElements,Me,null),We(Me))return ye(Me),!0;const wt=ie(Me.nodeName);if(Ct(Ce.uponSanitizeElement,Me,{tagName:wt,allowedTags:B}),Me.hasChildNodes()&&!yt(Me.firstElementChild)&&regExpTest(/<[/\w]/g,Me.innerHTML)&&regExpTest(/<[/\w]/g,Me.textContent)||Me.nodeType===NODE_TYPE.progressingInstruction||Ye&&Me.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,Me.data))return ye(Me),!0;if(!B[wt]||Ve[wt]){if(!Ve[wt]&&ht(wt)&&(Ae.tagNameCheck instanceof RegExp&&regExpTest(Ae.tagNameCheck,wt)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(wt)))return!1;if(At&&!P[wt]){const Ot=O(Me)||Me.parentNode,Bt=A(Me)||Me.childNodes;if(Bt&&Ot){const bt=Bt.length;for(let lr=bt-1;lr>=0;--lr){const fr=_(Bt[lr],!0);fr.__removalCount=(Me.__removalCount||0)+1,Ot.insertBefore(fr,w(Me))}}}return ye(Me),!0}return Me instanceof u&&!Ee(Me)||(wt==="noscript"||wt==="noembed"||wt==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,Me.innerHTML)?(ye(Me),!0):(Se&&Me.nodeType===NODE_TYPE.text&&(dt=Me.textContent,arrayForEach([Le,he,ve],Ot=>{dt=stringReplace(dt,Ot," ")}),Me.textContent!==dt&&(arrayPush(e.removed,{element:Me.cloneNode()}),Me.textContent=dt)),Ct(Ce.afterSanitizeElements,Me,null),!1)},De=function(Me,dt,wt){if(Qe&&(dt==="id"||dt==="name")&&(wt in t||wt in J))return!1;if(!(qe&&!He[dt]&&regExpTest(xe,dt))){if(!(be&&regExpTest(Ie,dt))){if(!V[dt]||He[dt]){if(!(ht(Me)&&(Ae.tagNameCheck instanceof RegExp&&regExpTest(Ae.tagNameCheck,Me)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(Me))&&(Ae.attributeNameCheck instanceof RegExp&&regExpTest(Ae.attributeNameCheck,dt)||Ae.attributeNameCheck instanceof Function&&Ae.attributeNameCheck(dt))||dt==="is"&&Ae.allowCustomizedBuiltInElements&&(Ae.tagNameCheck instanceof RegExp&&regExpTest(Ae.tagNameCheck,wt)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(wt))))return!1}else if(!Oe[dt]){if(!regExpTest(nt,stringReplace(wt,Ne,""))){if(!((dt==="src"||dt==="xlink:href"||dt==="href")&&Me!=="script"&&stringIndexOf(wt,"data:")===0&&ae[Me])){if(!(le&&!regExpTest(we,stringReplace(wt,Ne,"")))){if(wt)return!1}}}}}}return!0},ht=function(Me){return Me!=="annotation-xml"&&stringMatch(Me,at)},mt=function(Me){Ct(Ce.beforeSanitizeAttributes,Me,null);const{attributes:dt}=Me;if(!dt||We(Me))return;const wt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V,forceKeepAttr:void 0};let Ot=dt.length;for(;Ot--;){const Bt=dt[Ot],{name:bt,namespaceURI:lr,value:fr}=Bt,ur=ie(bt);let Qt=bt==="value"?fr:stringTrim(fr);if(wt.attrName=ur,wt.attrValue=Qt,wt.keepAttr=!0,wt.forceKeepAttr=void 0,Ct(Ce.uponSanitizeAttribute,Me,wt),Qt=wt.attrValue,st&&(ur==="id"||ur==="name")&&(Ge(bt,Me),Qt=St+Qt),Ye&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Qt)){Ge(bt,Me);continue}if(wt.forceKeepAttr||(Ge(bt,Me),!wt.keepAttr))continue;if(!pe&&regExpTest(/\/>/i,Qt)){Ge(bt,Me);continue}Se&&arrayForEach([Le,he,ve],Vn=>{Qt=stringReplace(Qt,Vn," ")});const ci=ie(Me.nodeName);if(De(ci,ur,Qt)){if(D&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!lr)switch(m.getAttributeType(ci,ur)){case"TrustedHTML":{Qt=D.createHTML(Qt);break}case"TrustedScriptURL":{Qt=D.createScriptURL(Qt);break}}try{lr?Me.setAttributeNS(lr,bt,Qt):Me.setAttribute(bt,Qt),We(Me)?ye(Me):arrayPop(e.removed)}catch{}}}Ct(Ce.afterSanitizeAttributes,Me,null)},Nt=function pt(Me){let dt=null;const wt=ft(Me);for(Ct(Ce.beforeSanitizeShadowDOM,Me,null);dt=wt.nextNode();)Ct(Ce.uponSanitizeShadowNode,dt,null),Mt(dt),mt(dt),dt.content instanceof o&&pt(dt.content);Ct(Ce.afterSanitizeShadowDOM,Me,null)};return e.sanitize=function(pt){let Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},dt=null,wt=null,Ot=null,Bt=null;if(Je=!pt,Je&&(pt="<!-->"),typeof pt!="string"&&!yt(pt))if(typeof pt.toString=="function"){if(pt=pt.toString(),typeof pt!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return pt;if(je||L(Me),e.removed=[],typeof pt=="string"&&(j=!1),j){if(pt.nodeName){const fr=ie(pt.nodeName);if(!B[fr]||Ve[fr])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(pt instanceof l)dt=tt("<!---->"),wt=dt.ownerDocument.importNode(pt,!0),wt.nodeType===NODE_TYPE.element&&wt.nodeName==="BODY"||wt.nodeName==="HTML"?dt=wt:dt.appendChild(wt);else{if(!Ue&&!Se&&!Fe&&pt.indexOf("<")===-1)return D&&et?D.createHTML(pt):pt;if(dt=tt(pt),!dt)return Ue?null:et?Y:""}dt&&rt&&ye(dt.firstChild);const bt=ft(j?pt:dt);for(;Ot=bt.nextNode();)Mt(Ot),mt(Ot),Ot.content instanceof o&&Nt(Ot.content);if(j)return pt;if(Ue){if(Xe)for(Bt=K.call(dt.ownerDocument);dt.firstChild;)Bt.appendChild(dt.firstChild);else Bt=dt;return(V.shadowroot||V.shadowrootmode)&&(Bt=re.call(n,Bt,!0)),Bt}let lr=Fe?dt.outerHTML:dt.innerHTML;return Fe&&B["!doctype"]&&dt.ownerDocument&&dt.ownerDocument.doctype&&dt.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,dt.ownerDocument.doctype.name)&&(lr="<!DOCTYPE "+dt.ownerDocument.doctype.name+`>
`+lr),Se&&arrayForEach([Le,he,ve],fr=>{lr=stringReplace(lr,fr," ")}),D&&et?D.createHTML(lr):lr},e.setConfig=function(){let pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};L(pt),je=!0},e.clearConfig=function(){_e=null,je=!1},e.isValidAttribute=function(pt,Me,dt){_e||L({});const wt=ie(pt),Ot=ie(Me);return De(wt,Ot,dt)},e.addHook=function(pt,Me){typeof Me=="function"&&arrayPush(Ce[pt],Me)},e.removeHook=function(pt){return arrayPop(Ce[pt])},e.removeHooks=function(pt){Ce[pt]=[]},e.removeAllHooks=function(){Ce=_createHooksMap()},e}var purify=createDOMPurify();function toUpperCaseFirst(r){return r[0].toUpperCase()+r.substr(1)}function randomString(){function r(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return r()+r()+r()+r()}function isPercentValue(r){return/^([0-9][0-9]?%$)|(^100%$)/.test(r)}function substitute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${r}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,n)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[n]===void 0?"":e[n])}function stripTags(r){return sanitize(`${r}`,{ALLOWED_TAGS:[]})}function sanitize(r,e){return purify.sanitize(r,e)}const A11Y_TABINDEX=r=>["tabindex",r],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=r=>["aria-label",r],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=r=>["aria-haspopup",r],A11Y_ROWCOUNT=r=>["aria-rowcount",r],A11Y_COLCOUNT=r=>["aria-colcount",r],A11Y_ROWINDEX=r=>["aria-rowindex",r],A11Y_COLINDEX=r=>["aria-colindex",r],A11Y_EXPANDED=r=>["aria-expanded",r],A11Y_SORT=r=>["aria-sort",r],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=r=>["aria-checked",r],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=r=>["aria-controls",r],A11Y_ACTIVEDESCENDANT=r=>["aria-activedescendant",r],A11Y_LIVE=r=>["aria-live",r],A11Y_RELEVANT=r=>["aria-relevant",r],A11Y_SETSIZE=r=>["aria-setsize",r],A11Y_POSINSET=r=>["aria-posinset",r];function getParent(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,n=null,s=r;for(;s!==null;){if(t===e){n=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(t+=1,s=s.parentNode)}return n}function isThisHotChild(r,e){const t=r.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function getFrameElement(r){return Object.getPrototypeOf(r.parent)&&r.frameElement}function getParentWindow(r){return getFrameElement(r)&&r.parent}function closest(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:s}=Node;let o=r;for(;o!=null&&o!==t;){const{nodeType:a,nodeName:l}=o;if(a===n&&(e.includes(l)||e.includes(o)))return o;const{host:u}=o;u&&a===s?o=u:o=o.parentNode}return null}function closestDown(r,e,t){const n=[];let s=r;for(;s&&(s=closest(s,e,t),!(!s||t&&!t.contains(s)));)n.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const o=n.length;return o?n[o-1]:null}function findFirstParentWithClass(r,e){const t={element:void 0,classNames:[]};let n=r;for(;n!==null&&n!==r.ownerDocument.documentElement&&!t.element;){if(typeof e=="string"&&n.classList.contains(e))t.element=n,t.classNames.push(e);else if(e instanceof RegExp){const s=Array.from(n.classList).filter(o=>e.test(o));s.length&&(t.element=n,t.classNames.push(...s))}n=n.parentElement}return t}function isChildOf(r,e){let t=r.parentNode,n=[];for(typeof e=="string"?r.defaultView?n=Array.prototype.slice.call(r.querySelectorAll(e),0):n=Array.prototype.slice.call(r.ownerDocument.querySelectorAll(e),0):n.push(e);t!==null;){if(n.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function index(r){let e=0,t=r;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function overlayContainsElement(r,e,t){const n=t.parentElement.querySelector(`.ht_clone_${r}`);return n?n.contains(e):null}function filterEmptyClassNames(r){return!r||!r.length?[]:r.filter(e=>!!e)}function filterRegexes(r,e){if(!r||!r.length)return{regexFree:[],regexes:[]};const t=[],n=[];return n.push(...r.filter(s=>{const o=s instanceof RegExp;return o&&e&&t.push(s),!o})),{regexFree:n,regexes:t}}function hasClass$1(r,e){return r.classList===void 0||typeof e!="string"||e===""?!1:r.classList.contains(e)}function addClass$1(r,e){typeof e=="string"&&(e=e.split(" ")),e=filterEmptyClassNames(e),e.length>0&&r.classList.add(...e)}function removeClass$1(r,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:n}=filterRegexes(e,!0);t=filterEmptyClassNames(t),t.length>0&&r.classList.remove(...t),n.forEach(s=>{r.classList.forEach(o=>{s.test(o)&&r.classList.remove(o)})})}function setAttribute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&r.setAttribute(...n)})}function removeAttribute(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:n}=filterRegexes(e,!0);t.forEach(s=>{s!==""&&r.removeAttribute(s)}),n.forEach(s=>{r.getAttributeNames().forEach(o=>{s.test(o)&&r.removeAttribute(o)})})}function removeTextNodes(r){if(r.nodeType===3)r.parentNode.removeChild(r);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(r.nodeName)>-1){const e=r.childNodes;for(let t=e.length-1;t>=0;t--)removeTextNodes(e[t])}}function empty$1(r){let e;for(;e=r.lastChild;)r.removeChild(e)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(e)?r.innerHTML=t?sanitize(e):e:fastInnerText(r,e)}function fastInnerText(r,e){const t=r.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(empty$1(r),r.appendChild(r.ownerDocument.createTextNode(e)))}function isVisible(r){const e=r.ownerDocument.documentElement,t=r.ownerDocument.defaultView;let n=r;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return isVisible(n.host.impl);if(n.host)return isVisible(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function offset(r){const e=r.ownerDocument,t=e.defaultView,n=e.documentElement;let s=r,o,a,l;for(o=s.offsetLeft,a=s.offsetTop,l=s;(s=s.offsetParent)&&!(s===e.body||!("offsetLeft"in s));)o+=s.offsetLeft,a+=s.offsetTop,l=s;return l&&l.style.position==="fixed"&&(o+=t.pageXOffset||n.scrollLeft,a+=t.pageYOffset||n.scrollTop),{left:o,top:a}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?getWindowScrollTop(e):r.scrollTop}function getScrollLeft(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?getWindowScrollLeft(e):r.scrollLeft}function getScrollableElement(r){let e=r.ownerDocument,t=e?e.defaultView:void 0;e||(e=r.document?r.document:r,t=e.defaultView);const n=["auto","scroll"];let s=r.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:o,overflowX:a,overflowY:l}=s.style;if([o,a,l].includes("scroll"))return s;if({overflow:o,overflowX:a,overflowY:l}=t.getComputedStyle(s),n.includes(o)||n.includes(a)||n.includes(l)||s.clientHeight<=s.scrollHeight+1&&(n.includes(l)||n.includes(o))||s.clientWidth<=s.scrollWidth+1&&(n.includes(a)||n.includes(o)))return s;s=s.parentNode}return t}function getMaximumScrollTop(r){return r.scrollHeight-r.clientHeight}function getMaximumScrollLeft(r){return r.scrollWidth-r.clientWidth}function getTrimmingContainer(r){const e=r.ownerDocument,t=e.defaultView;let n=r.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const s=t.getComputedStyle(n),o=["scroll","hidden","auto"],a=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(l)||o.includes(u))return n;n=n.parentNode}return t}function getStyle(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(r){if(r===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const n=r.style[e];if(n!==""&&n!==void 0)return n;const s=t.getComputedStyle(r);if(s[e]!==""&&s[e]!==void 0)return s[e]}function outerWidth(r){return r.offsetWidth}function outerHeight(r){return r.offsetHeight}function innerHeight(r){return r.clientHeight||r.innerHeight}function innerWidth(r){return r.clientWidth||r.innerWidth}function getCaretPosition(r){return r.selectionStart?r.selectionStart:0}function getSelectionEndPosition(r){return r.selectionEnd?r.selectionEnd:0}function clearTextSelection(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;r.getSelection&&(r.getSelection().empty?r.getSelection().empty():r.getSelection().removeAllRanges&&r.getSelection().removeAllRanges())}function setCaretPosition(r,e,t){if(t===void 0&&(t=e),r.setSelectionRange){r.focus();try{r.setSelectionRange(e,t)}catch{const s=r.parentNode,o=s.style.display;s.style.display="block",r.setSelectionRange(e,t),s.style.display=o}}}let cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=r.createElement("div");e.style.height="200px",e.style.width="100%";const t=r.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(r.body||r.documentElement).appendChild(t);const n=e.offsetWidth;t.style.overflow="scroll";let s=e.offsetWidth;return n===s&&(s=t.clientWidth),(r.body||r.documentElement).removeChild(t),n-s}function getScrollbarWidth(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(r)),cachedScrollbarWidth}function hasVerticalScrollbar(r){return r.offsetWidth!==r.clientWidth}function hasHorizontalScrollbar(r){return r.offsetHeight!==r.clientHeight}function setOverlayPosition(r,e,t){r.style.transform=`translate3d(${e},${t},0)`}function resetCssTransform(r){r.style.transform&&r.style.transform!==""&&(r.style.transform="")}function isInput(r){return r&&(["INPUT","SELECT","TEXTAREA"].indexOf(r.nodeName)>-1||r.contentEditable==="true")}function isOutsideInput(r){return isInput(r)&&r.hasAttribute("data-hot-input")===!1}function isDetached(r){return!r.parentNode}function observeVisibilityChangeOnce(r,e){new IntersectionObserver((n,s)=>{n.forEach(o=>{o.isIntersecting&&r.offsetParent!==null&&(e(),s.unobserve(r))})},{root:r.ownerDocument.body}).observe(r)}function makeElementContentEditableAndSelectItsContent(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=r.ownerDocument,s=n.createRange(),o=n.defaultView.getSelection();setAttribute(r,"contenteditable",!0),t&&setAttribute(r,...A11Y_HIDDEN()),e&&addClass$1(r,"invisibleSelection"),s.selectNodeContents(r),o.removeAllRanges(),o.addRange(s)}function removeContentEditableFromElementAndDeselect(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=r.ownerDocument.defaultView.getSelection();r.hasAttribute("aria-hidden")&&r.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&removeClass$1(r,"invisibleSelection"),r.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(r,t),e(),removeContentEditableFromElementAndDeselect(r,t)}function _defineProperty$1W(r,e,t){return(e=_toPropertyKey$1X(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1X(r){var e=_toPrimitive$1X(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1X(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$a="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$a}constructor(e){_defineProperty$1W(this,"hot",void 0),_defineProperty$1W(this,"state",EDITOR_STATE.VIRGIN),_defineProperty$1W(this,"_opened",!1),_defineProperty$1W(this,"_fullEditMode",!1),_defineProperty$1W(this,"_closeCallback",null),_defineProperty$1W(this,"TD",null),_defineProperty$1W(this,"row",null),_defineProperty$1W(this,"col",null),_defineProperty$1W(this,"prop",null),_defineProperty$1W(this,"originalValue",null),_defineProperty$1W(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,s,o,a){this.TD=s,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,s,o,a;if(t){const u=this.hot.getSelectedLast();n=Math.max(Math.min(u[0],u[2]),0),s=Math.max(Math.min(u[1],u[3]),0),o=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[n,s,o,a]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",n,s,!1,"meta");Array.isArray(l)&&([n,s]=l),this.hot.populateFromArray(n,s,e,o,a,"edit")}beginEditing(e,t){if(this.state!==EDITOR_STATE.VIRGIN)return;const n=this.hot,s=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const u=typeof e=="string"?e:stringify$1(this.originalValue);this.setValue(u)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),n.view.scrollViewport(n._createCellCoords(s,o))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,t,n){let s;if(n){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),n(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:s=[[o]],this.state=EDITOR_STATE.WAITING,this.saveValue(s,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(a)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(e){this.state===EDITOR_STATE.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:s}=this.hot.view._wt,o=this.hot.rootWindow,a=offset(t),l=outerWidth(t),u=offset(this.hot.rootElement),c=outerWidth(this.hot.rootElement),h=n.topOverlay.holder,g=n.inlineStartOverlay.holder,v=h!==o?h.scrollTop:0,m=g!==o?g.scrollLeft:0,E=o.innerWidth-u.left-c,{wtTable:_}=(e=n.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,S=_.name,w=["master","inline_start"].includes(S)?v:0,A=["master","top","bottom"].includes(S)?m:0,O=a.top===u.top?0:1;let D=a.top-u.top-O-w,Y=0;this.hot.isRtl()?Y=o.innerWidth-a.left-l-E-1+A:Y=a.left-u.left-1-A,["top","top_inline_start_corner"].includes(S)&&(D+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(Y+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),K=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),re=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&k<=0||k===re)&&(D+=1),K<=0&&(Y+=1);const Ce=s.rowsRenderCalculator.startPosition,Le=s.columnsRenderCalculator.startPosition,he=Math.abs(n.inlineStartOverlay.getScrollPosition()),ve=n.topOverlay.getScrollPosition(),xe=getScrollbarWidth(this.hot.rootDocument);let Ie=t.offsetTop;if(["inline_start","master"].includes(S)&&(Ie+=Ce-ve),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:be,wtTable:qe}=n.bottomOverlay.clone;Ie+=be.getWorkspaceHeight()-qe.getHeight()-xe}let we=t.offsetLeft;this.hot.isRtl()?(we>=0?we=_.getWidth()-t.offsetLeft:we=Math.abs(we),we+=Le-he-l):["top","master","bottom"].includes(S)&&(we+=Le-he);const Ne=o.getComputedStyle(this.TD),at=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",nt=parseInt(Ne[at],10)>0?0:1,B=parseInt(Ne.borderTopWidth,10)>0?0:1,te=outerWidth(t)+nt,V=outerHeight(t)+B,ue=hasVerticalScrollbar(h)?xe:0,Ae=hasHorizontalScrollbar(g)?xe:0,Ve=this.hot.view.maximumVisibleElementWidth(we)-ue+nt,He=Math.max(this.hot.view.maximumVisibleElementHeight(Ie)-Ae+B,this.hot.view.getDefaultRowHeight());return{top:D,start:Y,height:V,maxHeight:He,width:te,maxWidth:Ve}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}mixin(BaseEditor,hooksRefRegisterer);function stopImmediatePropagation(r){r.isImmediatePropagationEnabled=!1,r.cancelBubble=!0}function isImmediatePropagationStopped(r){return r.isImmediatePropagationEnabled===!1}function isRightClick(r){return r.button===2}function isLeftClick(r){return r.button===0}function isTouchEvent(r){return r instanceof TouchEvent}function offsetRelativeTo(r,e){const t={x:r.offsetX,y:r.offsetY};let n=r.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return t;for(;n!==e;)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;return t}function _defineProperty$1V(r,e,t){return(e=_toPropertyKey$1W(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1W(r){var e=_toPrimitive$1W(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1W(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class EventManager{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1V(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){n.call(this,extendEvent(a))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:o,options:s,eventManager:this}),e.addEventListener(t,o,s),()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===t&&a.element===e){if(n&&n!==a.callback||s&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,s=e;n||(n=e.ownerDocument?e.ownerDocument:e,s=n.defaultView);const o={bubbles:!0,cancelable:t!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):a=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}}function extendEvent(r){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=function(){e.apply(this),stopImmediatePropagation(this)},r}function requestAnimationFrame$1(r){return window.requestAnimationFrame(r)}function cancelAnimationFrame(r){window.cancelAnimationFrame(r)}function isTouchSupported(){return"ontouchstart"in window}function isCSR$1(){return typeof window<"u"}let comparisonFunction;function getComparisonFunction(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(r,e).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(t,n)=>`${t}`.localeCompare(n):comparisonFunction=(t,n)=>t===n?0:t>n?-1:1,comparisonFunction)}const tester=r=>{const e={value:!1};return e.test=(t,n)=>{e.value=r(t,n)},e},browsers={chrome:tester((r,e)=>/Chrome/.test(r)&&/Google/.test(e)),chromeWebKit:tester(r=>/CriOS/.test(r)),edge:tester(r=>/Edge/.test(r)),edgeWebKit:tester(r=>/EdgiOS/.test(r)),firefox:tester(r=>/Firefox/.test(r)),firefoxWebKit:tester(r=>/FxiOS/.test(r)),mobile:tester(r=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)),safari:tester((r,e)=>/Safari/.test(r)&&/Apple Computer/.test(e))},platforms={mac:tester(r=>/^Mac/.test(r)),win:tester(r=>/^Win/.test(r)),linux:tester(r=>/^Linux/.test(r)),ios:tester(r=>/iPhone|iPad|iPod/i.test(r))};function setBrowserMeta(){let{userAgent:r=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,t=>{let{test:n}=t;return void n(r,e)})}function setPlatformMeta(){let{platform:r=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,e=>{let{test:t}=e;return void t(r)})}isCSR$1()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return r>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}var esnext_iterator_map={},es_iterator_map={},iteratorMap,hasRequiredIteratorMap;function requireIteratorMap(){if(hasRequiredIteratorMap)return iteratorMap;hasRequiredIteratorMap=1;var r=requireFunctionCall(),e=requireACallable(),t=requireAnObject(),n=requireGetIteratorDirect(),s=requireIteratorCreateProxy(),o=requireCallWithSafeIterationClosing(),a=s(function(){var l=this.iterator,u=t(r(this.next,l)),c=this.done=!!u.done;if(!c)return o(l,this.mapper,[u.value,this.counter++],!0)});return iteratorMap=function(u){return t(this),e(u),new a(n(this),{mapper:u})},iteratorMap}var hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var r=require_export(),e=requireIteratorMap(),t=requireIsPure();return r({target:"Iterator",proto:!0,real:!0,forced:t},{map:e}),es_iterator_map}var hasRequiredEsnext_iterator_map;function requireEsnext_iterator_map(){return hasRequiredEsnext_iterator_map||(hasRequiredEsnext_iterator_map=1,requireEs_iterator_map()),esnext_iterator_map}requireEsnext_iterator_map();function isNumeric(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof r;if(t==="number")return!isNaN(r)&&isFinite(r);if(t==="string"){if(r.length===0)return!1;if(r.length===1)return/\d/.test(r);const n=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(r.trim())}else if(t==="object")return!!r&&typeof r.valueOf()=="number"&&!(r instanceof Date);return!1}function isNumericLike(r){return isNumeric(r,[","])}function rangeEach(r,e,t){let n=-1;for(typeof e=="function"?(t=e,e=r):n=r-1;++n<=e&&t(n)!==!1;);}function rangeEachReverse(r,e,t){let n=r+1;for(typeof e=="function"&&(t=e,e=0);--n>=e&&t(n)!==!1;);}function valueAccordingPercent(r,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(r*e/100,10)}function clamp(r,e,t){return Math.min(r,e)===r?e:Math.max(r,t)===r?t:r}function observe(r,e,t){r.addEventListener(e,t,!1)}function unObserve(r,e,t){r.removeEventListener(e,t,!1)}function getComputedStyle$1(r){return r.ownerDocument.defaultView.getComputedStyle(r)}function createInputElementResizer(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:g=>g.value,...e},n=r.body,s=r.createTextNode(""),o=r.createElement("span");let a;function l(){var g,v;s.textContent=t.textContent(a),o.style.position="absolute",o.style.fontSize=getComputedStyle$1(a).fontSize,o.style.fontFamily=getComputedStyle$1(a).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const m=parseInt(((g=getComputedStyle$1(a))===null||g===void 0?void 0:g.paddingInlineStart)||0,10),E=parseInt(((v=getComputedStyle$1(a))===null||v===void 0?void 0:v.paddingInlineEnd)||0,10),_=o.clientWidth+2+m+E;n.removeChild(o);const S=a.style;S.height=`${t.minHeight}px`,t.minWidth>_?S.width=`${t.minWidth}px`:_>t.maxWidth?S.width=`${t.maxWidth}px`:S.width=`${_}px`;const w=a.scrollHeight?a.scrollHeight-1:0;t.minHeight>w?S.height=`${t.minHeight}px`:t.maxHeight<w?(S.height=`${t.maxHeight}px`,S.overflowY="visible"):S.height=`${w}px`}function u(){r.defaultView.setTimeout(l,0)}function c(g){if(g&&g.minHeight)if(g.minHeight==="inherit")t.minHeight=a.clientHeight;else{const v=parseInt(g.minHeight,10);isNaN(v)||(t.minHeight=v)}if(g&&g.maxHeight)if(g.maxHeight==="inherit")t.maxHeight=a.clientHeight;else{const v=parseInt(g.maxHeight,10);isNaN(v)||(t.maxHeight=v)}if(g&&g.minWidth)if(g.minWidth==="inherit")t.minWidth=a.clientWidth;else{const v=parseInt(g.minWidth,10);isNaN(v)||(t.minWidth=v)}if(g&&g.maxWidth)if(g.maxWidth==="inherit")t.maxWidth=a.clientWidth;else{const v=parseInt(g.maxWidth,10);isNaN(v)||(t.maxWidth=v)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(s))}function h(g,v){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=g,c(v),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${t.minHeight}px`,a.style.minWidth=`${t.minWidth}px`,a.style.maxWidth=`${t.maxWidth}px`,a.style.overflowY="hidden"),m&&(observe(a,"input",l),observe(a,"keydown",u)),l()}return{init:h,resize:l,unObserve(){unObserve(a,"input",l),unObserve(a,"keydown",u)}}}function updateCaretPosition(r,e){const t=getCaretPosition(e),n=e.value.split(`
`);let s=t,o=0;for(let a=0;a<n.length;a++){const l=n[a];a!==0&&(o+=n[a-1].length+1);const u=o+l.length;if(r==="home"?s=o:r==="end"&&(s=u),t<=u)break}setCaretPosition(e,s)}function _defineProperty$1U(r,e,t){return(e=_toPropertyKey$1V(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1V(r){var e=_toPrimitive$1V(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1V(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$f="textEditor",EDITOR_TYPE$9="text";class TextEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$9}constructor(e){super(e),_defineProperty$1U(this,"eventManager",new EventManager(this)),_defineProperty$1U(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty$1U(this,"TEXTAREA",void 0),_defineProperty$1U(this,"textareaStyle",void 0),_defineProperty$1U(this,"TEXTAREA_PARENT",void 0),_defineProperty$1U(this,"textareaParentStyle",void 0),_defineProperty$1U(this,"layerClass",void 0),this.eventManager=new EventManager(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),isThisHotChild(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,s,o,a){const l=this.state;if(super.prepare(e,t,n,s,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),l!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass$1(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass$1(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass$1(this.TEXTAREA_PARENT,this.layerClass)&&removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;rangeEach(e.length-1,n=>{const s=e[n];if(hasClass$1(s,"handsontableEditor"))return t=!0,!1}),hasClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),t?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass$1(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass$1(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:n,width:s,maxWidth:o,height:a,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const u=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(s,o),minHeight:Math.min(a,l),maxWidth:o,maxHeight:l},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP$f},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(s(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[l]=a;updateCaretPosition(l,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[l]=a;updateCaretPosition(l,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$f)}}const GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor",command$E={name:"editorCloseAndSave",callback(r){r._getEditorManager().closeEditorAndSaveChanges()}},command$D={name:"editorCloseAndSaveByArrowKeys",callback(r,e,t){const n=r._getEditorManager(),s=n.getActiveEditor();s.isInFullEditMode()&&s.state===EDITOR_STATE.EDITING||(n.closeEditorAndSaveChanges(),r.getSelected()&&(t.includes("arrowdown")?r.selection.transformStart(1,0):t.includes("arrowup")?r.selection.transformStart(-1,0):t.includes("arrowleft")?r.selection.transformStart(0,-1*r.getDirectionFactor()):t.includes("arrowright")&&r.selection.transformStart(0,r.getDirectionFactor())),e.preventDefault())}},command$C={name:"editorCloseAndSaveByEnter",callback(r,e){const t=r._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},command$B={name:"editorCloseWithoutSaving",callback(r){const e=r._getEditorManager();e.closeEditorAndRestoreOriginalValue(r.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},command$A={name:"editorFastOpen",callback(r,e){const{highlight:t}=r.getSelectedRangeLast();t.isHeader()||r._getEditorManager().openEditor(null,e,!0)}},command$z={name:"editorOpen",callback(r,e,t){const n=r._getEditorManager(),s=r.getSelectedRangeLast(),{highlight:o}=s;if(r.selection.isMultiple()&&!s.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0){const a=r.getSettings(),l=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;t.includes("shift")?r.selection.transformFocus(-l.row,-l.col):r.selection.transformFocus(l.row,l.col);return}o.isHeader()||(r.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),stopImmediatePropagation(e))}};function getAllCommands$2(){return[command$E,command$D,command$C,command$B,command$A,command$z]}const command$y={name:"extendCellsSelectionDown",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(1,0)}},command$x={name:"extendCellsSelectionDownByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.min(e.row+r.countVisibleRows(),r.countRows()-1),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(n!==null){const s=r._createCellCoords(n,e.col),o=e.row-r.getFirstFullyVisibleRow(),a=Math.min(s.row-o,r.countRows()-1);r.selection.setRangeEnd(s),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}},command$w={name:"extendCellsSelectionLeft",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,-1*r.getDirectionFactor())}},command$v={name:"extendCellsSelectionRight",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,r.getDirectionFactor())}},command$u={name:"extendCellsSelectionToColumns",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByRowHeader()?r.selection.selectAll(!0,!0):r.selectColumns(t.col,n.col,e)}},command$t={name:"extendCellsSelectionToMostBottom",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(r.countRows()-1,-1),u=s.clone();u.row=n.row,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(l,o.col))}}},command$s={name:"extendCellsSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const a=t.getNearestNotHiddenIndex(r.countCols()-1,-1),l=s.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(o.row,a))}}},command$r={name:"extendCellsSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const a=parseInt(r.getSettings().fixedColumnsStart,10),l=t.getNearestNotHiddenIndex(a,1),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$q={name:"extendCellsSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$p={name:"extendCellsSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]),u=s.clone();u.col=n.col,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(o.row,l))}}},command$o={name:"extendCellsSelectionToMostTop",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:o}=r.getSelectedRangeLast(),a=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||a){const l=t.getNearestNotHiddenIndex(0,1),u=s.clone();u.row=n.row,e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(l,o.col))}}},command$n={name:"extendCellsSelectionToRows",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByColumnHeader()?r.selection.selectAll(!0,!0):r.selectRows(t.row,n.row,e)}},command$m={name:"extendCellsSelectionUp",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(-1,0)}},command$l={name:"extendCellsSelectionUpByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.max(e.row-r.countVisibleRows(),0),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(n!==null){const s=r._createCellCoords(n,e.col),o=e.row-r.getFirstFullyVisibleRow(),a=Math.max(s.row-o,0);r.selection.setRangeEnd(s),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands$1(){return[command$y,command$x,command$w,command$v,command$u,command$t,command$s,command$r,command$q,command$p,command$o,command$n,command$m,command$l]}const command$k={name:"moveCellSelectionDown",callback(r){let{selection:e}=r;e.transformStart(1,0)}},command$j={name:"moveCellSelectionDownByViewportHeight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=r.countVisibleRows()+t;n===r.countRows()-1?s=1:n+s>r.countRows()&&(s=r.countRows()-n-1),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}},command$i={name:"moveCellSelectionInlineEnd",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(-s.row,-s.col):r.selection.transformStart(-s.row,-s.col)}},command$h={name:"moveCellSelectionInlineStart",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(s.row,s.col):r.selection.transformStart(s.row,s.col)}},command$g={name:"moveCellSelectionLeft",callback(r){r.selection.transformStart(0,-1*r.getDirectionFactor())}},command$f={name:"moveCellSelectionRight",callback(r){r.selection.transformStart(0,r.getDirectionFactor())}},command$e={name:"moveCellSelectionToMostBottom",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);t===null&&(t=-1),r.selection.setRangeStart(r._createCellCoords(t,e))}},command$d={name:"moveCellSelectionToMostBottomInlineEnd",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsBottom,10),o=t.getNearestNotHiddenIndex(r.countRows()-s-1,-1),a=n.getNearestNotHiddenIndex(r.countCols()-1,-1);e.setRangeStart(r._createCellCoords(o,a))}},command$c={name:"moveCellSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r;e.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},command$b={name:"moveCellSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,n=parseInt(r.getSettings().fixedColumnsStart,10),s=r.getSelectedRangeLast().highlight.row,o=t.getNearestNotHiddenIndex(n,1);e.setRangeStart(r._createCellCoords(s,o))}},command$a={name:"moveCellSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,n=r.getSelectedRangeLast().highlight.row;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);s===null&&(s=r.isRtl()?-1:-r.countRowHeaders()),e.setRangeStart(r._createCellCoords(n,s))}},command$9={name:"moveCellSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{row:n}=r.getSelectedRangeLast().highlight;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);s===null&&(s=r.isRtl()?-r.countRowHeaders():-1),e.setRangeStart(r._createCellCoords(n,s))}},command$8={name:"moveCellSelectionToMostTop",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-r.countColHeaders()),r.selection.setRangeStart(r._createCellCoords(t,e))}},command$7={name:"moveCellSelectionToMostTopInlineStart",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsTop,10),o=parseInt(r.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(s,1),l=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(r._createCellCoords(a,l))}},command$6={name:"moveCellSelectionUp",callback(r){let{selection:e}=r;e.transformStart(-1,0)}},command$5={name:"moveCellSelectionUpByViewportHight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=-(r.countVisibleRows()+t);n===-t?s=-1:n+s<t&&(s=-(n+t)),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}};function getAllCommands(){return[command$k,command$j,command$i,command$h,command$g,command$f,command$e,command$d,command$c,command$b,command$a,command$9,command$8,command$7,command$6,command$5]}const command$4={name:"emptySelectedCells",callback(r){r.emptySelectedCells(),r._getEditorManager().prepareEditor()}},command$3={name:"scrollToFocusedCell",callback(r){const{highlight:e}=r.getSelectedRangeLast(),t=r.getFirstFullyVisibleRow()-1,n=r.getFirstFullyVisibleColumn()-1,s=r.getLastFullyVisibleRow()+1,o=r.getLastFullyVisibleColumn()+1,a=r._createCellCoords(t,n),l=r._createCellCoords(s,o);if(!r._createCellRange(a,a,l).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const h=Math.floor(r.countVisibleCols()/2);c.col=Math.max(e.col-h,0)}if(e.row>=0){const h=Math.floor(r.countVisibleRows()/2);c.row=Math.max(e.row-h,0)}r.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},command$2={name:"selectAllCells",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},command$1={name:"selectAllCellsAndHeaders",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},command={name:"populateSelectedCellsData",callback(r){const e=r.getSelectedRange(),{row:t,col:n}=e[e.length-1].highlight.normalize(),s=r.getDataAtCell(t,n),o=new Map;for(let a=0;a<e.length;a++)e[a].forAll((l,u)=>{if(l>=0&&u>=0&&(l!==t||u!==n)){const{readOnly:c}=r.getCellMeta(l,u);c||o.set(`${l}x${u}`,[l,u,s])}});r.setDataAtCell(Array.from(o.values()))}},allCommands=[...getAllCommands$2(),...getAllCommands$1(),...getAllCommands(),command$4,command$3,command$2,command$1,command];function createKeyboardShortcutCommandsPool(r){const e={};return allCommands.forEach(t=>{let{name:n,callback:s}=t;e[n]=function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return s(r,...a)}}),e}function shortcutsEditorContext(r){const e=r.getShortcutManager().addContext("editor"),t=createKeyboardShortcutCommandsPool(r),n={group:EDITOR_EDIT_GROUP};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>t.editorCloseAndSaveByEnter(s,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(s,o)=>t.editorCloseAndSaveByEnter(s,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:r.getShortcutManager().getContext("grid"),callback:(s,o)=>t.editorCloseAndSave(s,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(s,o)=>t.editorCloseAndSaveByArrowKeys(s,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],n)}function shortcutsGridContext(r){const e=r.getShortcutManager().addContext("grid"),t=createKeyboardShortcutCommandsPool(r),n={runOnlyIf:()=>{const{navigableHeaders:s}=r.getSettings();return isDefined(r.getSelected())&&(s||!s&&r.countRenderedRows()>0&&r.countRenderedCols()>0)},group:GRID_GROUP};e.addShortcuts([{keys:[["F2"]],callback:s=>t.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>t.editorOpen(s,o)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(r.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var s;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=r.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var s,o;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())&&((o=r.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],n)}function registerAllShortcutContexts(r){[shortcutsGridContext,shortcutsEditorContext].forEach(e=>e(r))}const SHORTCUTS_GROUP$e="handsontableEditor",EDITOR_TYPE$8="handsontable";class HandsontableEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a);const l=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,h){const g=this.getSourceData(h.row,h.col);g!==void 0&&l.setValue(g),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$1(u,a.handsontable),this.htOptions=u}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.htEditor.useTheme(e)})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:SHORTCUTS_GROUP$e,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},s=(o,a)=>{const l=this.htEditor;if(o!==void 0&&(o<0||l.flipped&&o>l.countRows()-1?l.deselectCell():l.selectCell(o,0),l.getData().length))return a.preventDefault(),stopImmediatePropagation(a),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let l,u;return!a.getSelectedLast()&&a.flipped?l=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(u=a.getSelectedLast()[0],l=Math.max(0,u-1)):(u=a.getSelectedLast()[0],l=u-1)),s(l,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let l,u;if(!a.getSelectedLast()&&!a.flipped)l=0;else if(a.getSelectedLast()){if(a.flipped)l=a.getSelectedLast()[0]+1;else if(!a.flipped){const c=a.countRows()-1;u=a.getSelectedLast()[0],l=Math.min(c,u+1)}}return s(l,o)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$e)}}const KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(r){return r===32||r>=48&&r<=57||r>=96&&r<=111||r>=186&&r<=192||r>=219&&r<=222||r>=226||r>=65&&r<=90}function isFunctionKey(r){return FUNCTION_KEYS.includes(r)}function isCtrlMetaKey(r){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(r)}function isKey(r,e){const t=e.split("|");let n=!1;return arrayEach(t,s=>{if(r===KEY_CODES[s])return n=!0,!1}),n}const RENDERER_TYPE$b="base";function baseRenderer(r,e,t,n,s,o,a){const l=a.ariaTags,u=[],c=[],h=[],g=[];a.className&&addClass$1(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),l&&g.push(A11Y_READONLY())):l&&h.push(A11Y_READONLY()[0]),a.valid===!1&&a.invalidCellClassName?(u.push(a.invalidCellClassName),l&&g.push(A11Y_INVALID())):(c.push(a.invalidCellClassName),l&&h.push(A11Y_INVALID()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!o&&a.placeholder&&u.push(a.placeholderCellClassName),removeClass$1(e,c),addClass$1(e,u),removeAttribute(e,h),setAttribute(e,g)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$b;const RENDERER_TYPE$a="text";function textRenderer(r,e,t,n,s,o,a){baseRenderer.apply(this,[r,e,t,n,s,o,a]);let l=o;if(!l&&a.placeholder&&(l=a.placeholder),l=stringify$1(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){empty$1(e);const u=r.rootDocument.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=r.getSourceDataAtRow(t),e.appendChild(u)}else fastInnerText(e,l)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$a;function _classPrivateFieldInitSpec$T(r,e,t){_checkPrivateRedeclaration$1a(r,e),e.set(r,t)}function _checkPrivateRedeclaration$1a(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1T(r,e,t){return(e=_toPropertyKey$1U(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1U(r){var e=_toPrimitive$1U(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1U(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$T(r,e){return r.get(_assertClassBrand$1a(r,e))}function _assertClassBrand$1a(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$7="autocomplete";var _idPrefix=new WeakMap;class AutocompleteEditor extends HandsontableEditor{constructor(){super(...arguments),_defineProperty$1T(this,"query",null),_defineProperty$1T(this,"strippedChoices",[]),_defineProperty$1T(this,"rawChoices",[]),_classPrivateFieldInitSpec$T(this,_idPrefix,this.hot.guid.slice(0,9)),_defineProperty$1T(this,"sortByRelevance",function(e,t,n){const s=[],o=[],a=e.length;let l=t.length,u,c,h,g;if(a===0){for(h=0;h<l;h++)o.push(h);return o}for(h=0;h<l;h++){if(c=stripTags(stringify$1(t[h])),n)g=c.indexOf(e);else{const v=this.cellProperties.locale;g=c.toLocaleLowerCase(v).indexOf(e.toLocaleLowerCase(v))}g!==-1&&(u=c.length-g-a,s.push({baseIndex:h,index:g,charsLeft:u,value:c}))}for(s.sort((v,m)=>{if(m.index===-1)return-1;if(v.index===-1)return 1;if(v.index<m.index)return-1;if(m.index<v.index)return 1;if(v.index===m.index){if(v.charsLeft<m.charsLeft)return-1;if(v.charsLeft>m.charsLeft)return 1}return 0}),h=0,l=s.length;h<l;h++)o.push(s[h].baseIndex);return o})}static get EDITOR_TYPE(){return EDITOR_TYPE$7}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return isDefined(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),addClass$1(this.htContainer,"autocompleteEditor"),addClass$1(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet$T(_idPrefix,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=n==null?void 0:n.length,{row:o,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[outerWidth(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(l,u,c,h,g,v,m)=>{textRenderer(l,u,c,h,g,v,m);const{filteringCaseSensitive:E,allowHtml:_,locale:S}=this.cellProperties,w=this.query;let A=stringify$1(v),O,D;A&&!_&&(O=E===!0?A.indexOf(w):A.toLocaleLowerCase(S).indexOf(w.toLocaleLowerCase(S)),O!==-1&&(D=A.substr(O,w.length),A=A.replace(D,`<strong>${D}</strong>`))),t&&setAttribute(u,[A11Y_OPTION(),...n?[A11Y_SETSIZE(s)]:[],...n?[A11Y_POSINSET(n.indexOf(v)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=A},afterSelectionEnd:(l,u)=>{if(t){const c=this.htEditor.getCell(l,u,!0);setAttribute(c,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(c.id))}}}),t&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet$T(_idPrefix,this)}-listbox-${o}-${a}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=getCaretPosition(this.TEXTAREA),n=getSelectionEndPosition(this.TEXTAREA),s=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,l=null,u=e;s&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(a)?a.length:0;if(o===!1)c&&(l=a[0]);else{const h=[];for(let g=0,v=u.length;g<v&&!(s&&c<=g);g++)c?h.push(u[a[g]]):h.push(u[g]);l=0,u=h}this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),setCaretPosition(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=getTrimmingContainer(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||n==="horizontal"))return!1;const s=offset(this.TEXTAREA),o=outerHeight(this.TEXTAREA),a=this.getHeight(),l=e.scrollTop,u=outerHeight(this.hot.view._wt.wtTable.THEAD),c=offset(e),h=s.top-c.top-u+l,g=e.scrollHeight-h-u-o,v=a>g&&h>g;return v?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(v?h:g,a),v}limitDropdownIfNeeded(e,t){if(t>e){let n=0,s=0,o=0,a=null;do o=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),n+=o,s+=1;while(n<e);a=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-a}px`),this.setDropdownHeight(n-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+getScrollbarWidth(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(o,a)=>a).reduce((o,a)=>o+this.htEditor.getRowHeight(a),0)+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=arrayMap(e,o=>stringify$1(o));return arrayMap(n,o=>t?o:stripTags(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n={row:t?t.from.row:-1};let s=!1;return e===KEY_CODES.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(s=!0),e===KEY_CODES.ARROW_UP&&n.row>-1&&(s=!0),s}onBeforeKeyDown(e){if(isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){let t=10;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const EDITOR_TYPE$6="checkbox";class CheckboxEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$6}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');hasClass$1(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const getWindow=()=>window,getDocument=()=>window.document,sto=(r,e)=>window.setTimeout(r,e),addEvent=function(r,e,t,n){r.addEventListener(e,t,!!n)},removeEvent=function(r,e,t,n){r.removeEventListener(e,t,!!n)},trim=function(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")},hasClass=function(r,e){return(" "+r.className+" ").indexOf(" "+e+" ")!==-1},addClass=function(r,e){hasClass(r,e)||(r.className=r.className===""?e:r.className+" "+e)},removeClass=function(r,e){r.className=trim((" "+r.className+" ").replace(" "+e+" "," "))},isArray$1=function(r){return/Array/.test(Object.prototype.toString.call(r))},isDate$1=function(r){return/Date/.test(Object.prototype.toString.call(r))&&!isNaN(r.getTime())},isWeekend=function(r){let e=r.getDay();return e===0||e===6},isLeapYear=function(r){return r%4===0&&r%100!==0||r%400===0},getDaysInMonth=function(r,e){return[31,isLeapYear(r)?29:28,31,30,31,30,31,31,30,31,30,31][e]},setToStartOfDay=function(r){isDate$1(r)&&r.setHours(0,0,0,0)},compareDates=function(r,e){return r.getTime()===e.getTime()},extend=function(r,e,t){let n,s;for(n in e)s=r[n]!==void 0,s&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?isDate$1(e[n])?t&&(r[n]=new Date(e[n].getTime())):isArray$1(e[n])?t&&(r[n]=e[n].slice(0)):r[n]=extend({},e[n],t):(t||!s)&&(r[n]=e[n]);return r},fireEvent=function(r,e,t){let n=getDocument().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=extend(n,t),r.dispatchEvent(n)},adjustCalendar=function(r){return r.month<0&&(r.year-=Math.ceil(Math.abs(r.month)/12),r.month+=12),r.month>11&&(r.year+=Math.floor(Math.abs(r.month)/12),r.month-=12),r},defaults$1={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(r,e,t){for(e+=r.firstDay;e>=7;)e-=7;return t?r.i18n.weekdaysShort[e]:r.i18n.weekdays[e]},renderDay=function(r){let e=[],t="false";if(r.isEmpty)if(r.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),r.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return r.isDisabled&&e.push("is-disabled"),r.isToday&&e.push("is-today"),r.isSelected&&(e.push("is-selected"),t="true"),r.hasEvent&&e.push("has-event"),r.isInRange&&e.push("is-inrange"),r.isStartRange&&e.push("is-startrange"),r.isEndRange&&e.push("is-endrange"),'<td data-day="'+r.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+r.year+'" data-pika-month="'+r.month+'" data-pika-day="'+r.day+'">'+r.day+"</button></td>"},isoWeek=function(r,e){r.setHours(0,0,0,0);let t=r.getDate(),n=r.getDay(),s=e,o=s-1,a=7,l=function(v){return(v+a-1)%a};r.setDate(t+o-l(n));let u=new Date(r.getFullYear(),0,s),c=24*60*60*1e3,h=(r.getTime()-u.getTime())/c;return 1+Math.round((h-o+l(u.getDay()))/a)},renderWeek=function(r,e,t,n,s){let o=new Date(n,t,e);return'<td class="pika-week">'+(r.hasMoment?r.moment(o).isoWeek():isoWeek(o,s))+"</td>"},renderRow=function(r,e,t,n){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?r.reverse():r).join("")+"</tr>"},renderBody=function(r){return"<tbody>"+r.join("")+"</tbody>"},renderHead=function(r){let e,t=[];for(r.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+renderDayName(r,e)+'">'+renderDayName(r,e,!0)+"</abbr></th>");return"<thead><tr>"+(r.isRTL?t.reverse():t).join("")+"</tr></thead>"},renderTitle=function(r,e,t,n,s,o){let a,l,u,c=r._o,h=t===c.minYear,g=t===c.maxYear,v='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',m,E,_=!0,S=!0;for(u=[],a=0;a<12;a++)u.push('<option value="'+(t===s?a-e:12+a-e)+'"'+(a===n?' selected="selected"':"")+(h&&a<c.minMonth||g&&a>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[a]+"</option>");for(m='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+u.join("")+"</select></div>",isArray$1(c.yearRange)?(a=c.yearRange[0],l=c.yearRange[1]+1):(a=t-c.yearRange,l=1+t+c.yearRange),u=[];a<l&&a<=c.maxYear;a++)a>=c.minYear&&u.push('<option value="'+a+'"'+(a===t?' selected="selected"':"")+">"+a+"</option>");return E='<div class="pika-label">'+t+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+u.join("")+"</select></div>",c.showMonthAfterYear?v+=E+m:v+=m+E,h&&(n===0||c.minMonth>=n)&&(_=!1),g&&(n===11||c.maxMonth<=n)&&(S=!1),e===0&&(v+='<button class="pika-prev'+(_?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===r._o.numberOfMonths-1&&(v+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),v+="</div>"},renderTable=function(r,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+renderHead(r)+renderBody(e)+"</table>"};function Pikaday(r){let e=this,t=e.config(r);e._onMouseDown=function(s){if(!e._v)return;s=s||getWindow().event;let o=s.target||s.srcElement;if(o)if(hasClass(o,"is-disabled")||(hasClass(o,"pika-button")&&!hasClass(o,"is-empty")&&!hasClass(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),t.bound&&sto(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):hasClass(o,"pika-prev")?e.prevMonth():hasClass(o,"pika-next")&&e.nextMonth()),hasClass(o,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||getWindow().event;let o=s.target||s.srcElement;o&&(hasClass(o,"pika-select-month")?e.gotoMonth(o.value):hasClass(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(s){if(s=s||getWindow().event,e.isVisible())switch(s.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let s=this.moment(t.field.value,t.format,t.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(s){let o;s.firedBy!==e&&(o=e._parseFieldValue(),isDate$1(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=getDocument().activeElement;do if(hasClass(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=sto(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||getWindow().event;let o=s.target||s.srcElement,a=o;if(o){!hasEventListeners&&hasClass(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),addEvent(o,"change",e._onChange)));do if(hasClass(a,"pika-single")||a===t.trigger)return;while(a=a.parentNode);e._v&&o!==t.trigger&&a!==t.trigger&&e.hide()}},e.el=getDocument().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),addEvent(e.el,"mousedown",e._onMouseDown,!0),addEvent(e.el,"touchend",e._onMouseDown,!0),addEvent(e.el,"change",e._onChange),t.keyboardInput&&addEvent(getDocument(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?getDocument().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),addEvent(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let n=t.defaultDate;isDate$1(n)?t.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",addEvent(t.trigger,"click",e._onInputClick),addEvent(t.trigger,"focus",e._onInputFocus),addEvent(t.trigger,"blur",e._onInputBlur)):this.show()}Pikaday.prototype={config:function(r){this._o||(this._o=extend({},defaults$1,!0));let e=extend(this._o,r,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,isDate$1(e.minDate)||(e.minDate=!1),isDate$1(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),isArray$1(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||defaults$1.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(r){return r=r||this._o.format,isDate$1(this._d)?this._o.toString?this._o.toString(this._d,r):this.hasMoment?this.moment(this._d).format(r):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(r,e){this.hasMoment&&this.moment.isMoment(r)&&this.setDate(r.toDate(),e)},useMoment:function(r){this.hasMoment=!0,this.moment=r},getDate:function(){return isDate$1(this._d)?new Date(this._d.getTime()):null},setDate:function(r,e){if(!r)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof r=="string"&&(r=new Date(Date.parse(r))),!isDate$1(r))return;let t=this._o.minDate,n=this._o.maxDate;isDate$1(t)&&r<t?r=t:isDate$1(n)&&r>n&&(r=n),this._d=new Date(r.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(r){let e=!0;if(isDate$1(r)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=r.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=s<t.getTime()||n.getTime()<s}e&&(this.calendars=[{month:r.getMonth(),year:r.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(r,e){let t=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,s;r==="add"?s=new Date(t.valueOf()+n):r==="subtract"&&(s=new Date(t.valueOf()-n)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let r=1;r<this._o.numberOfMonths;r++)this.calendars[r]=adjustCalendar({month:this.calendars[0].month+r,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(r){isNaN(r)||(this.calendars[0].month=parseInt(r,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(r){isNaN(r)||(this.calendars[0].year=parseInt(r,10),this.adjustCalendars())},setMinDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.minDate=r,this._o.minYear=r.getFullYear(),this._o.minMonth=r.getMonth()):(this._o.minDate=defaults$1.minDate,this._o.minYear=defaults$1.minYear,this._o.minMonth=defaults$1.minMonth,this._o.startRange=defaults$1.startRange),this.draw()},setMaxDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.maxDate=r,this._o.maxYear=r.getFullYear(),this._o.maxMonth=r.getMonth()):(this._o.maxDate=defaults$1.maxDate,this._o.maxYear=defaults$1.maxYear,this._o.maxMonth=defaults$1.maxMonth,this._o.endRange=defaults$1.endRange),this.draw()},setStartRange:function(r){this._o.startRange=r},setEndRange:function(r){this._o.endRange=r},draw:function(r){if(!this._v&&!r)return;let e=this._o,t=e.minYear,n=e.maxYear,s=e.minMonth,o=e.maxMonth,a="",l;this._y<=t&&(this._y=t,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=n&&(this._y=n,!isNaN(o)&&this._m>o&&(this._m=o));for(let u=0;u<e.numberOfMonths;u++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+renderTitle(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,l)+this.render(this.calendars[u].year,this.calendars[u].month,l)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&sto(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let r,e,t,n,s,o,a,l,u,c,h;this._o.container||(this.el.style.position="absolute",r=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,n=getWindow().innerWidth||getDocument().documentElement.clientWidth,s=getWindow().innerHeight||getDocument().documentElement.clientHeight,o=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,c=!0,h=!0,u=r.getBoundingClientRect(),a=u.left+getWindow().pageXOffset,l=u.bottom+getWindow().pageYOffset,(this._o.reposition&&a+e>n||this._o.position.indexOf("right")>-1&&a-e+r.offsetWidth>0)&&(a=a-e+r.offsetWidth,c=!1),(this._o.reposition&&l+t>s+o||this._o.position.indexOf("top")>-1&&l-t-r.offsetHeight>0)&&(l=l-t-r.offsetHeight,h=!1),a<0&&(a=0),l<0&&(l=0),this.el.style.left=a+"px",this.el.style.top=l+"px",addClass(this.el,c?"left-aligned":"right-aligned"),addClass(this.el,h?"bottom-aligned":"top-aligned"),removeClass(this.el,c?"right-aligned":"left-aligned"),removeClass(this.el,h?"top-aligned":"bottom-aligned"))},render:function(r,e,t){let n=this._o,s=new Date,o=getDaysInMonth(r,e),a=new Date(r,e,1).getDay(),l=[],u=[];setToStartOfDay(s),n.firstDay>0&&(a-=n.firstDay,a<0&&(a+=7));let c=e===0?11:e-1,h=e===11?0:e+1,g=e===0?r-1:r,v=e===11?r+1:r,m=getDaysInMonth(g,c),E=o+a,_=E;for(;_>7;)_-=7;E+=7-_;let S=!1;for(let w=0,A=0;w<E;w++){let O=new Date(r,e,1+(w-a)),D=isDate$1(this._d)?compareDates(O,this._d):!1,Y=compareDates(O,s),H=n.events.indexOf(O.toDateString())!==-1,k=w<a||w>=o+a,K=1+(w-a),se=e,re=r,Ce=n.startRange&&compareDates(n.startRange,O),Le=n.endRange&&compareDates(n.endRange,O),he=n.startRange&&n.endRange&&n.startRange<O&&O<n.endRange,ve=n.minDate&&O<n.minDate||n.maxDate&&O>n.maxDate||n.disableWeekends&&isWeekend(O)||n.disableDayFn&&n.disableDayFn(O);k&&(w<a?(K=m+K,se=c,re=g):(K=K-o,se=h,re=v));let xe={day:K,month:se,year:re,hasEvent:H,isSelected:D,isToday:Y,isDisabled:ve,isEmpty:k,isStartRange:Ce,isEndRange:Le,isInRange:he,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&D&&(S=!0),u.push(renderDay(xe)),++A===7&&(n.showWeekNumber&&u.unshift(renderWeek(this,w-a,e,r,n.firstWeekOfYearMinDays)),l.push(renderRow(u,n.isRTL,n.pickWholeWeek,S)),u=[],A=0,S=!1)}return renderTable(n,l,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let r=this._v;r!==!1&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,r!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let r=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),r.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),r.field&&(removeEvent(r.field,"change",this._onInputChange),r.bound&&(removeEvent(r.trigger,"click",this._onInputClick),removeEvent(r.trigger,"focus",this._onInputFocus),removeEvent(r.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _defineProperty$1S(r,e,t){return(e=_toPropertyKey$1T(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1T(r){var e=_toPrimitive$1T(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1T(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor";class DateEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1S(this,"defaultDateFormat","DD/MM/YYYY"),_defineProperty$1S(this,"parentDestroyed",!1),_defineProperty$1S(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE$5}init(){if(typeof hooks!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||(removeClass$1(this.datePicker,/ht-theme-.*/g),addClass$1(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass$1(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();removeClass$1(this.datePicker,/ht-theme-.*/g),addClass$1(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{hasClass$1(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),s=e?isFunctionKey(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(hooks),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,hooks(o,t,!0).isValid()&&this.$datePicker.setMoment(hooks(o,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!n&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,hooks(o,t,!0).isValid()&&this.$datePicker.setMoment(hooks(o,t),!0),!s&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(t,this.cellProperties.datePickerConfig);const n=t.onSelect,s=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=hooks(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),n&&n()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:s}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(t=o.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,l=n.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),u=n.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),c=s.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),h=s.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=l&&this.row<=u&&this.col>=c&&this.col<=h){const g=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+g.top+outerHeight(this.TD)}px`;let v=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?v+=g.right-outerWidth(this.datePicker):v+=g.left,this.datePickerStyle.left=`${v}px`}else this.hideDatepicker()}}function warn$1(){isDefined(console)&&console.warn(...arguments)}function error(){isDefined(console)&&console.error(...arguments)}function isFunction$1(r){return typeof r=="function"}function debounce(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,n;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(()=>{n=r.apply(this,a)},e),n}return s}function partial(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return r.apply(this,t.concat(a))}}function curry(r){const e=r.length;function t(n){return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=n.concat(a);let c;return u.length>=e?c=r.apply(this,u):c=t(u),c}}return t([])}function fastCall(r,e,t,n,s,o,a,l){return isDefined(l)?r.call(e,t,n,s,o,a,l):isDefined(a)?r.call(e,t,n,s,o,a):isDefined(o)?r.call(e,t,n,s,o):isDefined(s)?r.call(e,t,n,s):isDefined(n)?r.call(e,t,n):isDefined(t)?r.call(e,t):r.call(e)}const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]);var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var r=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(e,t,n){for(var s=0,o=arguments.length>2?n:r(t),a=new e(o);o>s;)a[s]=t[s++];return a},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var r=requireGlobalThis();return getBuiltInPrototypeMethod=function(e,t){var n=r[e],s=n&&n.prototype;return s&&s[t]},getBuiltInPrototypeMethod}var addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var r=requireWellKnownSymbol(),e=requireObjectCreate(),t=requireObjectDefineProperty().f,n=r("unscopables"),s=Array.prototype;return s[n]===void 0&&t(s,n,{configurable:!0,value:e(null)}),addToUnscopables=function(o){s[n][o]=!0},addToUnscopables}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var r=require_export(),e=requireFunctionUncurryThis(),t=requireACallable(),n=requireToIndexedObject(),s=requireArrayFromConstructorAndList(),o=requireGetBuiltInPrototypeMethod(),a=requireAddToUnscopables(),l=Array,u=e(o("Array","sort"));return r({target:"Array",proto:!0},{toSorted:function(h){h!==void 0&&t(h);var g=n(this),v=s(l,g);return u(v,h)}}),a("toSorted"),es_array_toSorted}requireEs_array_toSorted();function _classPrivateMethodInitSpec$Q(r,e){_checkPrivateRedeclaration$19(r,e),e.add(r)}function _classPrivateFieldInitSpec$S(r,e,t){_checkPrivateRedeclaration$19(r,e),e.set(r,t)}function _checkPrivateRedeclaration$19(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$P(r,e,t){return r.set(_assertClassBrand$19(r,e),t),t}function _classPrivateFieldGet$S(r,e){return r.get(_assertClassBrand$19(r,e))}function _assertClassBrand$19(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const MAX_SKIPPED_HOOKS_COUNT=100;var _hooks$1=new WeakMap,_skippedHooksCount=new WeakMap,_needsSort=new WeakMap,_HooksBucket_brand=new WeakSet;class HooksBucket{constructor(){_classPrivateMethodInitSpec$Q(this,_HooksBucket_brand),_classPrivateFieldInitSpec$S(this,_hooks$1,new Map),_classPrivateFieldInitSpec$S(this,_skippedHooksCount,new Map),_classPrivateFieldInitSpec$S(this,_needsSort,new Set),REGISTERED_HOOKS.forEach(e=>_assertClassBrand$19(_HooksBucket_brand,this,_createHooksCollection).call(this,e))}getHooks(e){var t;return(t=_classPrivateFieldGet$S(_hooks$1,this).get(e))!==null&&t!==void 0?t:[]}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classPrivateFieldGet$S(_hooks$1,this).has(e)||(_assertClassBrand$19(_HooksBucket_brand,this,_createHooksCollection).call(this,e),REGISTERED_HOOKS.push(e));const s=_classPrivateFieldGet$S(_hooks$1,this).get(e);if(s.find(c=>c.callback===t))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,l=!!n.initialHook;let u=!1;if(l){const c=s.find(h=>h.initialHook);c&&(c.callback=t,u=!0)}if(!u){s.push({callback:t,orderIndex:o,runOnce:a,initialHook:l,skip:!1});let c=_classPrivateFieldGet$S(_needsSort,this).has(e);!c&&o!==0&&(c=!0,_classPrivateFieldGet$S(_needsSort,this).add(e)),c&&s.length>1&&_classPrivateFieldGet$S(_hooks$1,this).set(e,s.toSorted((h,g)=>h.orderIndex-g.orderIndex))}}has(e){return _classPrivateFieldGet$S(_hooks$1,this).has(e)&&_classPrivateFieldGet$S(_hooks$1,this).get(e).length>0}remove(e,t){if(!_classPrivateFieldGet$S(_hooks$1,this).has(e))return!1;const n=_classPrivateFieldGet$S(_hooks$1,this).get(e),s=n.find(o=>o.callback===t);if(s){let o=_classPrivateFieldGet$S(_skippedHooksCount,this).get(e);return s.skip=!0,o+=1,o>MAX_SKIPPED_HOOKS_COUNT&&(_classPrivateFieldGet$S(_hooks$1,this).set(e,n.filter(a=>!a.skip)),o=0),_classPrivateFieldGet$S(_skippedHooksCount,this).set(e,o),!0}return!1}destroy(){_classPrivateFieldGet$S(_hooks$1,this).clear(),_classPrivateFieldGet$S(_skippedHooksCount,this).clear(),_classPrivateFieldSet$P(_hooks$1,this,null),_classPrivateFieldSet$P(_skippedHooksCount,this,null)}}function _createHooksCollection(r){_classPrivateFieldGet$S(_hooks$1,this).set(r,[]),_classPrivateFieldGet$S(_skippedHooksCount,this).set(r,0)}function _defineProperty$1R(r,e,t){return(e=_toPropertyKey$1S(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1S(r){var e=_toPrimitive$1S(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1S(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Hooks{constructor(){_defineProperty$1R(this,"globalBucket",new HooksBucket)}static getSingleton(){return getGlobalSingleton()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new HooksBucket),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?arrayEach(t,o=>this.add(e,o,n)):(REMOVED_HOOKS.has(e)&&warn$1(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn$1(DEPRECATED_HOOKS.get(e)),this.getBucket(n).add(e,t,{orderIndex:s,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?arrayEach(t,o=>this.once(e,o,n)):this.getBucket(n).add(e,t,{orderIndex:s,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(t)?arrayEach(t,s=>this.addAsFixed(e,s,n)):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,s,o,a,l,u){{const c=this.getBucket().getHooks(t),h=c?c.length:0;let g=0;if(h)for(;g<h;){if(!c[g]||c[g].skip){g+=1;continue}const v=fastCall(c[g].callback,e,n,s,o,a,l,u);v!==void 0&&(n=v),c[g]&&c[g].runOnce&&this.remove(t,c[g].callback),g+=1}}{const c=this.getBucket(e).getHooks(t),h=c?c.length:0;let g=0;if(h)for(;g<h;){if(!c[g]||c[g].skip){g+=1;continue}const v=fastCall(c[g].callback,e,n,s,o,a,l,u);v!==void 0&&(n=v),c[g]&&c[g].runOnce&&this.remove(t,c[g].callback,e),g+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}deregister(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}isDeprecated(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}isRegistered(e){return REGISTERED_HOOKS.indexOf(e)>=0}getRegistered(){return REGISTERED_HOOKS}}const globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}const EDITOR_TYPE$4="dropdown";class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$4}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Hooks.getSingleton().add("beforeValidate",function(r,e,t){const n=this.propToCol(t);if(Number.isInteger(n)){const s=this.getCellMeta(e,n);s.editor===DropdownEditor&&s.strict===void 0&&(s.filter=!1,s.strict=!0)}});const EDITOR_TYPE$3="numeric";class NumericEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$3}}function _defineProperty$1Q(r,e,t){return(e=_toPropertyKey$1R(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1R(r){var e=_toPrimitive$1R(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1R(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const EDITOR_TYPE$2="password";class PasswordEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1Q(this,"autoResize",createInputElementResizer(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return EDITOR_TYPE$2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty$1(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$d="selectEditor",EDITOR_TYPE$1="select";class SelectEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$1}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...A11Y_HIDDEN()),e.appendChild(this.hot.rootDocument.createTextNode("")),addClass$1(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",hasClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)&&removeClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a);const l=this.cellProperties.selectOptions;let u;typeof l=="function"?u=this.prepareOptions(l(this.row,this.col,this.prop)):u=this.prepareOptions(l),empty$1(this.select),objectEach(u,(c,h)=>{const g=this.hot.rootDocument.createElement("OPTION");g.value=h,fastInnerHTML(g,c),this.select.appendChild(g)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,s=e.length;n<s;n++)t[e[n]]=e[n];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:n,height:s}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${s}px`,o.width=`${n}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",addClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={group:SHORTCUTS_GROUP$d};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$d)}}const EDITOR_TYPE="time";class TimeEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE}prepare(e,t,n,s,o,a){super.prepare(e,t,n,s,o,a),this.TEXTAREA.dir="ltr"}}const collection=new Map;function staticRegister(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(r)||collection.set(r,new Map);const e=collection.get(r);function t(l,u){e.set(l,u)}function n(l){return e.get(l)}function s(l){return e.has(l)}function o(){return[...e.keys()]}function a(){return[...e.values()]}return{register:t,getItem:n,hasItem:s,getNames:o,getValues:a}}const registeredEditorClasses=new WeakMap,{register:register$4,getItem:getItem$3,hasItem:hasItem$3,getNames:getNames$3,getValues:getValues$3}=staticRegister("editors");function RegisteredEditor(r){const e={},t=r;this.getConstructor=function(){return r},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new t(n)),e[n.guid]},Hooks.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function _getEditorInstance(r,e){let t;if(typeof r=="function")registeredEditorClasses.get(r)||_register$3(null,r),t=registeredEditorClasses.get(r);else if(typeof r=="string")t=getItem$3(r);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${r}"`);return t.getInstance(e)}function _getItem$3(r){if(typeof r=="function")return r;if(!hasItem$3(r))throw Error(`No registered editor found under "${r}" name`);return getItem$3(r).getConstructor()}function _register$3(r,e){r&&typeof r!="string"&&(e=r,r=e.EDITOR_TYPE);const t=new RegisteredEditor(e);typeof r=="string"&&register$4(r,t),registeredEditorClasses.set(e,t)}function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}const RENDERER_TYPE$9="html";function htmlRenderer(r,e,t,n,s,o,a){baseRenderer.apply(this,[r,e,t,n,s,o,a]),fastInnerHTML(e,o??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$9;const RENDERER_TYPE$8="autocomplete";function autocompleteRenderer(r,e,t,n,s,o,a){const{rootDocument:l}=r,u=a.allowHtml?htmlRenderer:textRenderer,c=l.createElement("DIV"),h=r.getSettings().ariaTags;if(c.className="htAutocompleteArrow",h&&c.setAttribute(...A11Y_HIDDEN()),c.appendChild(l.createTextNode("")),u.apply(this,[r,e,t,n,s,o,a]),e.firstChild||e.appendChild(l.createTextNode("")),e.insertBefore(c,e.firstChild),addClass$1(e,"htAutocomplete"),!r.acArrowListener){const g=new EventManager(r);r.acArrowListener=function(v){hasClass$1(v.target,"htAutocompleteArrow")&&r.view._wt.getSetting("onCellDblClick",null,r._createCellCoords(t,n),e)},g.addEventListener(r.rootElement,"mousedown",r.acArrowListener),r.addHookOnce("afterDestroy",()=>{g.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$8;const RENDERER_TYPE$7="dropdown";function dropdownRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE$7;var esnext_iterator_every={},es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{every:function(a){n(this),t(a);var l=s(this),u=0;return!e(l,function(c,h){if(!a(c,u++))return h()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var hasRequiredEsnext_iterator_every;function requireEsnext_iterator_every(){return hasRequiredEsnext_iterator_every||(hasRequiredEsnext_iterator_every=1,requireEs_iterator_every()),esnext_iterator_every}requireEsnext_iterator_every();const CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,_dictionaryKeys=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS},Symbol.toStringTag,{value:"Module"})),isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$c="checkboxRenderer",RENDERER_TYPE$6="checkbox";Hooks.getSingleton().add("modifyAutoColumnSizeSeed",function(r,e,t){const{label:n,type:s,row:o,column:a,prop:l}=e;if(s===RENDERER_TYPE$6){if(n){const{value:u,property:c}=n;let h=t;if(u)h=typeof u=="function"?u(o,a,l,t):u;else if(c){const g=this.getDataAtRowProp(o,c);h=g!==null?g:t}r=h}return r}});function checkboxRenderer(r,e,t,n,s,o,a){const{rootDocument:l}=r,u=r.getSettings().ariaTags;baseRenderer.apply(this,[r,e,t,n,s,o,a]),registerEvents(r);let c=createInput(l);const h=a.label;let g=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),empty$1(e),o===a.checkedTemplate||stringify$1(o).toLocaleLowerCase(a.locale)===stringify$1(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:o===a.uncheckedTemplate||stringify$1(o).toLocaleLowerCase(a.locale)===stringify$1(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:isEmpty$1(o)?addClass$1(c,"noValue"):(c.style.display="none",addClass$1(c,BAD_VALUE_CLASS),g=!0),setAttribute(c,[[ATTR_ROW,t],[ATTR_COLUMN,n]]),u&&setAttribute(c,[A11Y_LABEL(c.checked?r.getTranslatedPhrase(CHECKBOX_CHECKED):r.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(c.checked),A11Y_CHECKBOX()]),!g&&h){let _="";if(h.value)_=typeof h.value=="function"?h.value.call(this,t,n,s,o):h.value;else if(h.property){const w=r.getDataAtRowProp(t,h.property);_=w!==null?w:""}const S=createLabel(l,_,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(S),e.appendChild(c)):(S.appendChild(c),c=S):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(c),e.appendChild(S)):(S.insertBefore(c,S.firstChild),c=S))}(!h||h&&!h.separated)&&e.appendChild(c),g&&e.appendChild(l.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(r)||(isListeningKeyDownEvent.set(r,!0),v());function v(){const S=r.getShortcutManager().getContext("grid"),w={group:SHORTCUTS_GROUP$c,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};S.addShortcuts([{keys:[["space"]],callback:()=>(m(),!E()),runOnlyIf:()=>{var A;return(A=r.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}},{keys:[["enter"]],callback:()=>(m(),!E()),runOnlyIf:()=>{const A=r.getSelectedRangeLast();return r.getSettings().enterBeginsEditing&&(A==null?void 0:A.highlight.isCell())&&!r.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!E()),runOnlyIf:()=>{var A;return(A=r.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}}],w)}function m(){let _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=r.getSelectedRange(),w=[],A=new Map;let O=[],D=0;if(S){for(let Y=0;Y<S.length;Y++){const{row:H,col:k}=S[Y].getTopStartCorner(),{row:K,col:se}=S[Y].getBottomEndCorner();for(let re=H;re<=K;re+=1)for(let Ce=k;Ce<=se;Ce+=1){const Le=r.getCellMeta(re,Ce);if(Le.hidden)continue;const he={checkedTemplate:Le.checkedTemplate,uncheckedTemplate:Le.uncheckedTemplate};if(Le.type!=="checkbox"){_===!0&&!Le.readOnly&&(A.has(w.length)?A.set(w.length,[...A.get(w.length),[re,Ce,null]]):A.set(w.length,[[re,Ce,null]]));continue}if(Le.readOnly===!0)continue;typeof Le.checkedTemplate>"u"&&(Le.checkedTemplate=!0),typeof Le.uncheckedTemplate>"u"&&(Le.uncheckedTemplate=!1);const ve=r.getDataAtCell(re,Ce);_===!1?[Le.checkedTemplate,Le.checkedTemplate.toString()].includes(ve)?O.push([re,Ce,Le.uncheckedTemplate,he]):[Le.uncheckedTemplate,Le.uncheckedTemplate.toString(),null,void 0].includes(ve)&&O.push([re,Ce,Le.checkedTemplate,he]):O.push([re,Ce,Le.uncheckedTemplate,he]),D+=1}w.push(D),D=0}O.every(Y=>{let[,,H]=Y;return H===O[0][2]})?O=O.map(Y=>{let[H,k,K]=Y;return[H,k,K]}):O=O.map(Y=>{let[H,k,,K]=Y;return[H,k,K.checkedTemplate]}),O.length>0&&w.forEach((Y,H)=>{let k=O.splice(0,Y);A.size&&A.has(H)&&(k=[...k,...A.get(H)]),r.setDataAtCell(k)})}}function E(){const _=r.getSelectedRange();if(_){for(let S=0;S<_.length;S++){const w=_[S].getTopStartCorner(),A=_[S].getBottomEndCorner();for(let O=w.row;O<=A.row;O++)for(let D=w.col;D<=A.col;D++){if(r.getCellMeta(O,D).readOnly)continue;const H=r.getCell(O,D);if(H instanceof HTMLElement&&H.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$6;function registerEvents(r){let e=isCheckboxListenerAdded.get(r);if(!e){const{rootElement:t}=r;e=new EventManager(r),e.addEventListener(t,"click",n=>onClick(n,r)),e.addEventListener(t,"mouseup",n=>onMouseUp(n,r)),e.addEventListener(t,"change",n=>onChange(n,r)),isCheckboxListenerAdded.set(r,e)}return e}function createInput(r){const e=r.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function createLabel(r,e,t){const n=r.createElement("label");return n.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,n.appendChild(r.createTextNode(e)),n.cloneNode(!0)}function onMouseUp(r,e){const{target:t}=r;isCheckboxInput(t)&&(!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN)||setTimeout(e.listen,10))}function onClick(r,e){const{target:t}=r;if(!isCheckboxInput(t)||!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN))return;const n=parseInt(t.getAttribute(ATTR_ROW),10),s=parseInt(t.getAttribute(ATTR_COLUMN),10);e.getCellMeta(n,s).readOnly&&r.preventDefault()}function onChange(r,e){const{target:t}=r;if(!isCheckboxInput(t)||!t.hasAttribute(ATTR_ROW)||!t.hasAttribute(ATTR_COLUMN))return;const n=parseInt(t.getAttribute(ATTR_ROW),10),s=parseInt(t.getAttribute(ATTR_COLUMN),10),o=e.getCellMeta(n,s);if(!o.readOnly){let a=null;r.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(n,s,a)}}function isCheckboxInput(r){return r.tagName==="INPUT"&&r.getAttribute("type")==="checkbox"}const RENDERER_TYPE$5="handsontable";function handsontableRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(r){return r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var enUS,hasRequiredEnUS;function requireEnUS(){return hasRequiredEnUS||(hasRequiredEnUS=1,enUS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){let e=r%10;return~~(r%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),enUS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var unformatting,hasRequiredUnformatting;function requireUnformatting(){if(hasRequiredUnformatting)return unformatting;hasRequiredUnformatting=1;const r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(u){return u.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function t(u,c,h,g,v,m,E){if(!isNaN(+u))return+u;let _="",S=u.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(S!==u)return-1*t(S,c,h,g,v,m);for(let H=0;H<r.length;H++){let k=r[H];if(_=u.replace(RegExp(`([0-9 ])(${k.key})$`),"$1"),_!==u)return t(_,c,h,g,v,m)*k.factor}if(_=u.replace("%",""),_!==u)return t(_,c,h,g,v,m)/100;let w=parseFloat(u);if(isNaN(w))return;let A=g(w);if(A&&A!=="."&&(_=u.replace(new RegExp(`${e(A)}$`),""),_!==u))return t(_,c,h,g,v,m);let O={};Object.keys(m).forEach(H=>{O[m[H]]=H});let D=Object.keys(O).sort().reverse(),Y=D.length;for(let H=0;H<Y;H++){let k=D[H],K=O[k];if(_=u.replace(k,""),_!==u){let se;switch(K){case"thousand":se=Math.pow(10,3);break;case"million":se=Math.pow(10,6);break;case"billion":se=Math.pow(10,9);break;case"trillion":se=Math.pow(10,12);break}return t(_,c,h,g,v,m)*se}}}function n(u,c,h){let g=u.replace(h,"");return g=g.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),g=g.replace(c.decimal,"."),g}function s(u,c,h="",g,v,m,E){if(u==="")return;if(u===v)return 0;let _=n(u,c,h);return t(_,c,h,g,v,m)}function o(u,c){if(!(u.indexOf(":")&&c.thousands!==":"))return!1;let g=u.split(":");if(g.length!==3)return!1;let v=+g[0],m=+g[1],E=+g[2];return!isNaN(v)&&!isNaN(m)&&!isNaN(E)}function a(u){let c=u.split(":"),h=+c[0],g=+c[1];return+c[2]+60*g+3600*h}function l(u,c){const h=requireGlobalState();let g=h.currentDelimiters(),v=h.currentCurrency().symbol,m=h.currentOrdinal(),E=h.getZeroFormat(),_=h.currentAbbreviations(),S;if(typeof u=="string")o(u,g)?S=a(u):S=s(u,g,v,m,E,_);else if(typeof u=="number")S=u;else return;if(S!==void 0)return S}return unformatting={unformat:l},unformatting}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var validating$1,hasRequiredValidating;function requireValidating(){if(hasRequiredValidating)return validating$1;hasRequiredValidating=1;let r=requireUnformatting();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,t=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],o=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:t},base:{type:"string",validValues:["decimal","binary","general"],restriction:(S,w)=>w.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:S=>S.output==="byte"},characteristic:{type:"number",restriction:S=>S>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(S,w)=>w.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:S=>S>=0,message:"value must be positive"},{restriction:(S,w)=>!w.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:S=>S>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(S,w)=>w.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},h={languageTag:{type:"string",mandatory:!0,restriction:S=>S.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function g(S,w){let A=v(S),O=E(w);return A&&O}function v(S){return r.unformat(S)!==void 0}function m(S,w,A,O=!1){let D=Object.keys(S).map(Y=>{if(!w[Y])return console.error(`${A} Invalid key: ${Y}`),!1;let H=S[Y],k=w[Y];if(typeof k=="string"&&(k={type:k}),k.type==="format"){if(!m(H,c,`[Validate ${Y}]`,!0))return!1}else if(typeof H!==k.type)return console.error(`${A} ${Y} type mismatched: "${k.type}" expected, "${typeof H}" provided`),!1;if(k.restrictions&&k.restrictions.length){let K=k.restrictions.length;for(let se=0;se<K;se++){let{restriction:re,message:Ce}=k.restrictions[se];if(!re(H,S))return console.error(`${A} ${Y} invalid value: ${Ce}`),!1}}return k.restriction&&!k.restriction(H,S)?(console.error(`${A} ${Y} invalid value: ${k.message}`),!1):k.validValues&&k.validValues.indexOf(H)===-1?(console.error(`${A} ${Y} invalid value: must be among ${JSON.stringify(k.validValues)}, "${H}" provided`),!1):!(k.children&&!m(H,k.children,`[Validate ${Y}]`))});return O||D.push(...Object.keys(w).map(Y=>{let H=w[Y];if(typeof H=="string"&&(H={type:H}),H.mandatory){let k=H.mandatory;if(typeof k=="function"&&(k=k(S)),k&&S[Y]===void 0)return console.error(`${A} Missing mandatory key "${Y}"`),!1}return!0})),D.reduce((Y,H)=>Y&&H,!0)}function E(S){return m(S,c,"[Validate format]")}function _(S){return m(S,h,"[Validate language]")}return validating$1={validate:g,validateFormat:E,validateInput:v,validateLanguage:_},validating$1}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function parsePrefix(r,e){let t=r.match(/^{([^}]*)}/);return t?(e.prefix=t[1],r.slice(t[0].length)):r}function parsePostfix(r,e){let t=r.match(/{([^}]*)}$/);return t?(e.postfix=t[1],r.slice(0,-t[0].length)):r}function parseOutput(r,e){if(r.indexOf("$")!==-1){e.output="currency";return}if(r.indexOf("%")!==-1){e.output="percent";return}if(r.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(r.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(r.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(r.indexOf(":")!==-1){e.output="time";return}r.indexOf("o")!==-1&&(e.output="ordinal")}function parseThousandSeparated(r,e){r.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function parseSpaceSeparated(r,e){r.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function parseTotalLength(r,e){let t=r.match(/[1-9]+[0-9]*/);t&&(e.totalLength=+t[0])}function parseCharacteristic(r,e){let n=r.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function parseMantissa(r,e){let t=r.split(".")[1];if(t){let n=t.match(/0+/);n&&(e.mantissa=n[0].length)}}function parseTrimMantissa(r,e){const t=r.split(".")[1];t&&(e.trimMantissa=t.indexOf("[")!==-1)}function parseAverage(r,e){r.indexOf("a")!==-1&&(e.average=!0)}function parseForceAverage(r,e){r.indexOf("K")!==-1?e.forceAverage="thousand":r.indexOf("M")!==-1?e.forceAverage="million":r.indexOf("B")!==-1?e.forceAverage="billion":r.indexOf("T")!==-1&&(e.forceAverage="trillion")}function parseOptionalMantissa(r,e){r.match(/\[\.]/)?e.optionalMantissa=!0:r.match(/\./)&&(e.optionalMantissa=!1)}function parseOptionalCharacteristic(r,e){if(r.indexOf(".")!==-1){let t=r.split(".")[0];e.optionalCharacteristic=t.indexOf("0")===-1}}function parseNegative(r,e){r.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),r.match(/^\+?-/)&&(e.negative="sign")}function parseForceSign(r,e){r.match(/^\+/)&&(e.forceSign=!0)}function parseFormat(r,e={}){return typeof r!="string"?r:(r=parsePrefix(r,e),r=parsePostfix(r,e),parseOutput(r,e),parseTotalLength(r,e),parseCharacteristic(r,e),parseOptionalCharacteristic(r,e),parseAverage(r,e),parseForceAverage(r,e),parseMantissa(r,e),parseOptionalMantissa(r,e),parseTrimMantissa(r,e),parseThousandSeparated(r,e),parseSpaceSeparated(r,e),parseNegative(r,e),parseForceSign(r,e),e)}var parsing$2={parseFormat};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var globalState$2,hasRequiredGlobalState;function requireGlobalState(){if(hasRequiredGlobalState)return globalState$2;hasRequiredGlobalState=1;const r=requireEnUS(),e=requireValidating(),t=parsing$2;let n={},s,o={},a=null,l={};function u(h){s=h}function c(){return o[s]}return n.languages=()=>Object.assign({},o),n.currentLanguage=()=>s,n.currentBytes=()=>c().bytes||{},n.currentCurrency=()=>c().currency,n.currentAbbreviations=()=>c().abbreviations,n.currentDelimiters=()=>c().delimiters,n.currentOrdinal=()=>c().ordinal,n.currentDefaults=()=>Object.assign({},c().defaults,l),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().timeFormat),n.setDefaults=h=>{h=t.parseFormat(h),e.validateFormat(h)&&(l=h)},n.getZeroFormat=()=>a,n.setZeroFormat=h=>a=typeof h=="string"?h:null,n.hasZeroFormat=()=>a!==null,n.languageData=h=>{if(h){if(o[h])return o[h];throw new Error(`Unknown tag "${h}"`)}return c()},n.registerLanguage=(h,g=!1)=>{if(!e.validateLanguage(h))throw new Error("Invalid language data");o[h.languageTag]=h,g&&u(h.languageTag)},n.setLanguage=(h,g=r.languageTag)=>{if(!o[h]){let v=h.split("-")[0],m=Object.keys(o).find(E=>E.split("-")[0]===v);if(!o[m]){u(g);return}u(m);return}u(h)},n.registerLanguage(r),s=r.languageTag,globalState$2=n,globalState$2}function commonjsRequire$1(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function loadLanguagesInNode(r,e){r.forEach(t=>{let n;try{n=commonjsRequire$1(`../languages/${t}`)}catch{console.error(`Unable to load "${t}". No matching language file found.`)}n&&e.registerLanguage(n)})}var loading=r=>({loadLanguagesInNode:e=>loadLanguagesInNode(e,r)}),bignumber={exports:{}};(function(r){(function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,o=Math.floor,a="[BigNumber Error] ",l=a+"Number primitive has more than 15 significant digits: ",u=1e14,c=14,h=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,m=1e9;function E(H){var k,K,se,re=ue.prototype={constructor:ue,toString:null,valueOf:null},Ce=new ue(1),Le=20,he=4,ve=-7,xe=21,Ie=-1e7,we=1e7,Ne=!1,at=1,nt=0,B={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},te="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function ue(le,pe){var Se,Ye,Fe,je,rt,Ue,Xe,et,Qe=this;if(!(Qe instanceof ue))return new ue(le,pe);if(pe==null){if(le&&le._isBigNumber===!0){Qe.s=le.s,!le.c||le.e>we?Qe.c=Qe.e=null:le.e<Ie?Qe.c=[Qe.e=0]:(Qe.e=le.e,Qe.c=le.c.slice());return}if((Ue=typeof le=="number")&&le*0==0){if(Qe.s=1/le<0?(le=-le,-1):1,le===~~le){for(je=0,rt=le;rt>=10;rt/=10,je++);je>we?Qe.c=Qe.e=null:(Qe.e=je,Qe.c=[le]);return}et=String(le)}else{if(!n.test(et=String(le)))return se(Qe,et,Ue);Qe.s=et.charCodeAt(0)==45?(et=et.slice(1),-1):1}(je=et.indexOf("."))>-1&&(et=et.replace(".","")),(rt=et.search(/e/i))>0?(je<0&&(je=rt),je+=+et.slice(rt+1),et=et.substring(0,rt)):je<0&&(je=et.length)}else{if(A(pe,2,te.length,"Base"),pe==10&&V)return Qe=new ue(le),be(Qe,Le+Qe.e+1,he);if(et=String(le),Ue=typeof le=="number"){if(le*0!=0)return se(Qe,et,Ue,pe);if(Qe.s=1/le<0?(et=et.slice(1),-1):1,ue.DEBUG&&et.replace(/^0\.0*|\./,"").length>15)throw Error(l+le)}else Qe.s=et.charCodeAt(0)===45?(et=et.slice(1),-1):1;for(Se=te.slice(0,pe),je=rt=0,Xe=et.length;rt<Xe;rt++)if(Se.indexOf(Ye=et.charAt(rt))<0){if(Ye=="."){if(rt>je){je=Xe;continue}}else if(!Fe&&(et==et.toUpperCase()&&(et=et.toLowerCase())||et==et.toLowerCase()&&(et=et.toUpperCase()))){Fe=!0,rt=-1,je=0;continue}return se(Qe,String(le),Ue,pe)}Ue=!1,et=K(et,pe,10,Qe.s),(je=et.indexOf("."))>-1?et=et.replace(".",""):je=et.length}for(rt=0;et.charCodeAt(rt)===48;rt++);for(Xe=et.length;et.charCodeAt(--Xe)===48;);if(et=et.slice(rt,++Xe)){if(Xe-=rt,Ue&&ue.DEBUG&&Xe>15&&(le>h||le!==o(le)))throw Error(l+Qe.s*le);if((je=je-rt-1)>we)Qe.c=Qe.e=null;else if(je<Ie)Qe.c=[Qe.e=0];else{if(Qe.e=je,Qe.c=[],rt=(je+1)%c,je<0&&(rt+=c),rt<Xe){for(rt&&Qe.c.push(+et.slice(0,rt)),Xe-=c;rt<Xe;)Qe.c.push(+et.slice(rt,rt+=c));rt=c-(et=et.slice(rt)).length}else rt-=Xe;for(;rt--;et+="0");Qe.c.push(+et)}}else Qe.c=[Qe.e=0]}ue.clone=E,ue.ROUND_UP=0,ue.ROUND_DOWN=1,ue.ROUND_CEIL=2,ue.ROUND_FLOOR=3,ue.ROUND_HALF_UP=4,ue.ROUND_HALF_DOWN=5,ue.ROUND_HALF_EVEN=6,ue.ROUND_HALF_CEIL=7,ue.ROUND_HALF_FLOOR=8,ue.EUCLID=9,ue.config=ue.set=function(le){var pe,Se;if(le!=null)if(typeof le=="object"){if(le.hasOwnProperty(pe="DECIMAL_PLACES")&&(Se=le[pe],A(Se,0,m,pe),Le=Se),le.hasOwnProperty(pe="ROUNDING_MODE")&&(Se=le[pe],A(Se,0,8,pe),he=Se),le.hasOwnProperty(pe="EXPONENTIAL_AT")&&(Se=le[pe],Se&&Se.pop?(A(Se[0],-1e9,0,pe),A(Se[1],0,m,pe),ve=Se[0],xe=Se[1]):(A(Se,-1e9,m,pe),ve=-(xe=Se<0?-Se:Se))),le.hasOwnProperty(pe="RANGE"))if(Se=le[pe],Se&&Se.pop)A(Se[0],-1e9,-1,pe),A(Se[1],1,m,pe),Ie=Se[0],we=Se[1];else if(A(Se,-1e9,m,pe),Se)Ie=-(we=Se<0?-Se:Se);else throw Error(a+pe+" cannot be zero: "+Se);if(le.hasOwnProperty(pe="CRYPTO"))if(Se=le[pe],Se===!!Se)if(Se)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ne=Se;else throw Ne=!Se,Error(a+"crypto unavailable");else Ne=Se;else throw Error(a+pe+" not true or false: "+Se);if(le.hasOwnProperty(pe="MODULO_MODE")&&(Se=le[pe],A(Se,0,9,pe),at=Se),le.hasOwnProperty(pe="POW_PRECISION")&&(Se=le[pe],A(Se,0,m,pe),nt=Se),le.hasOwnProperty(pe="FORMAT"))if(Se=le[pe],typeof Se=="object")B=Se;else throw Error(a+pe+" not an object: "+Se);if(le.hasOwnProperty(pe="ALPHABET"))if(Se=le[pe],typeof Se=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Se))V=Se.slice(0,10)=="0123456789",te=Se;else throw Error(a+pe+" invalid: "+Se)}else throw Error(a+"Object expected: "+le);return{DECIMAL_PLACES:Le,ROUNDING_MODE:he,EXPONENTIAL_AT:[ve,xe],RANGE:[Ie,we],CRYPTO:Ne,MODULO_MODE:at,POW_PRECISION:nt,FORMAT:B,ALPHABET:te}},ue.isBigNumber=function(le){if(!le||le._isBigNumber!==!0)return!1;if(!ue.DEBUG)return!0;var pe,Se,Ye=le.c,Fe=le.e,je=le.s;e:if({}.toString.call(Ye)=="[object Array]"){if((je===1||je===-1)&&Fe>=-1e9&&Fe<=m&&Fe===o(Fe)){if(Ye[0]===0){if(Fe===0&&Ye.length===1)return!0;break e}if(pe=(Fe+1)%c,pe<1&&(pe+=c),String(Ye[0]).length==pe){for(pe=0;pe<Ye.length;pe++)if(Se=Ye[pe],Se<0||Se>=u||Se!==o(Se))break e;if(Se!==0)return!0}}}else if(Ye===null&&Fe===null&&(je===null||je===1||je===-1))return!0;throw Error(a+"Invalid BigNumber: "+le)},ue.maximum=ue.max=function(){return Ve(arguments,-1)},ue.minimum=ue.min=function(){return Ve(arguments,1)},ue.random=function(){var le=9007199254740992,pe=Math.random()*le&2097151?function(){return o(Math.random()*le)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Se){var Ye,Fe,je,rt,Ue,Xe=0,et=[],Qe=new ue(Ce);if(Se==null?Se=Le:A(Se,0,m),rt=s(Se/c),Ne)if(crypto.getRandomValues){for(Ye=crypto.getRandomValues(new Uint32Array(rt*=2));Xe<rt;)Ue=Ye[Xe]*131072+(Ye[Xe+1]>>>11),Ue>=9e15?(Fe=crypto.getRandomValues(new Uint32Array(2)),Ye[Xe]=Fe[0],Ye[Xe+1]=Fe[1]):(et.push(Ue%1e14),Xe+=2);Xe=rt/2}else if(crypto.randomBytes){for(Ye=crypto.randomBytes(rt*=7);Xe<rt;)Ue=(Ye[Xe]&31)*281474976710656+Ye[Xe+1]*1099511627776+Ye[Xe+2]*4294967296+Ye[Xe+3]*16777216+(Ye[Xe+4]<<16)+(Ye[Xe+5]<<8)+Ye[Xe+6],Ue>=9e15?crypto.randomBytes(7).copy(Ye,Xe):(et.push(Ue%1e14),Xe+=7);Xe=rt/7}else throw Ne=!1,Error(a+"crypto unavailable");if(!Ne)for(;Xe<rt;)Ue=pe(),Ue<9e15&&(et[Xe++]=Ue%1e14);for(rt=et[--Xe],Se%=c,rt&&Se&&(Ue=g[c-Se],et[Xe]=o(rt/Ue)*Ue);et[Xe]===0;et.pop(),Xe--);if(Xe<0)et=[je=0];else{for(je=-1;et[0]===0;et.splice(0,1),je-=c);for(Xe=1,Ue=et[0];Ue>=10;Ue/=10,Xe++);Xe<c&&(je-=c-Xe)}return Qe.e=je,Qe.c=et,Qe}}(),ue.sum=function(){for(var le=1,pe=arguments,Se=new ue(pe[0]);le<pe.length;)Se=Se.plus(pe[le++]);return Se},K=function(){var le="0123456789";function pe(Se,Ye,Fe,je){for(var rt,Ue=[0],Xe,et=0,Qe=Se.length;et<Qe;){for(Xe=Ue.length;Xe--;Ue[Xe]*=Ye);for(Ue[0]+=je.indexOf(Se.charAt(et++)),rt=0;rt<Ue.length;rt++)Ue[rt]>Fe-1&&(Ue[rt+1]==null&&(Ue[rt+1]=0),Ue[rt+1]+=Ue[rt]/Fe|0,Ue[rt]%=Fe)}return Ue.reverse()}return function(Se,Ye,Fe,je,rt){var Ue,Xe,et,Qe,st,St,At,j,X=Se.indexOf("."),P=Le,R=he;for(X>=0&&(Qe=nt,nt=0,Se=Se.replace(".",""),j=new ue(Ye),St=j.pow(Se.length-X),nt=Qe,j.c=pe(Y(S(St.c),St.e,"0"),10,Fe,le),j.e=j.c.length),At=pe(Se,Ye,Fe,rt?(Ue=te,le):(Ue=le,te)),et=Qe=At.length;At[--Qe]==0;At.pop());if(!At[0])return Ue.charAt(0);if(X<0?--et:(St.c=At,St.e=et,St.s=je,St=k(St,j,P,R,Fe),At=St.c,st=St.r,et=St.e),Xe=et+P+1,X=At[Xe],Qe=Fe/2,st=st||Xe<0||At[Xe+1]!=null,st=R<4?(X!=null||st)&&(R==0||R==(St.s<0?3:2)):X>Qe||X==Qe&&(R==4||st||R==6&&At[Xe-1]&1||R==(St.s<0?8:7)),Xe<1||!At[0])Se=st?Y(Ue.charAt(1),-P,Ue.charAt(0)):Ue.charAt(0);else{if(At.length=Xe,st)for(--Fe;++At[--Xe]>Fe;)At[Xe]=0,Xe||(++et,At=[1].concat(At));for(Qe=At.length;!At[--Qe];);for(X=0,Se="";X<=Qe;Se+=Ue.charAt(At[X++]));Se=Y(Se,et,Ue.charAt(0))}return Se}}(),k=function(){function le(Ye,Fe,je){var rt,Ue,Xe,et,Qe=0,st=Ye.length,St=Fe%v,At=Fe/v|0;for(Ye=Ye.slice();st--;)Xe=Ye[st]%v,et=Ye[st]/v|0,rt=At*Xe+et*St,Ue=St*Xe+rt%v*v+Qe,Qe=(Ue/je|0)+(rt/v|0)+At*et,Ye[st]=Ue%je;return Qe&&(Ye=[Qe].concat(Ye)),Ye}function pe(Ye,Fe,je,rt){var Ue,Xe;if(je!=rt)Xe=je>rt?1:-1;else for(Ue=Xe=0;Ue<je;Ue++)if(Ye[Ue]!=Fe[Ue]){Xe=Ye[Ue]>Fe[Ue]?1:-1;break}return Xe}function Se(Ye,Fe,je,rt){for(var Ue=0;je--;)Ye[je]-=Ue,Ue=Ye[je]<Fe[je]?1:0,Ye[je]=Ue*rt+Ye[je]-Fe[je];for(;!Ye[0]&&Ye.length>1;Ye.splice(0,1));}return function(Ye,Fe,je,rt,Ue){var Xe,et,Qe,st,St,At,j,X,P,R,ae,Pe,Oe,oe,ee,fe,Re,$e=Ye.s==Fe.s?1:-1,Je=Ye.c,Be=Fe.c;if(!Je||!Je[0]||!Be||!Be[0])return new ue(!Ye.s||!Fe.s||(Je?Be&&Je[0]==Be[0]:!Be)?NaN:Je&&Je[0]==0||!Be?$e*0:$e/0);for(X=new ue($e),P=X.c=[],et=Ye.e-Fe.e,$e=je+et+1,Ue||(Ue=u,et=_(Ye.e/c)-_(Fe.e/c),$e=$e/c|0),Qe=0;Be[Qe]==(Je[Qe]||0);Qe++);if(Be[Qe]>(Je[Qe]||0)&&et--,$e<0)P.push(1),st=!0;else{for(oe=Je.length,fe=Be.length,Qe=0,$e+=2,St=o(Ue/(Be[0]+1)),St>1&&(Be=le(Be,St,Ue),Je=le(Je,St,Ue),fe=Be.length,oe=Je.length),Oe=fe,R=Je.slice(0,fe),ae=R.length;ae<fe;R[ae++]=0);Re=Be.slice(),Re=[0].concat(Re),ee=Be[0],Be[1]>=Ue/2&&ee++;do{if(St=0,Xe=pe(Be,R,fe,ae),Xe<0){if(Pe=R[0],fe!=ae&&(Pe=Pe*Ue+(R[1]||0)),St=o(Pe/ee),St>1)for(St>=Ue&&(St=Ue-1),At=le(Be,St,Ue),j=At.length,ae=R.length;pe(At,R,j,ae)==1;)St--,Se(At,fe<j?Re:Be,j,Ue),j=At.length,Xe=1;else St==0&&(Xe=St=1),At=Be.slice(),j=At.length;if(j<ae&&(At=[0].concat(At)),Se(R,At,ae,Ue),ae=R.length,Xe==-1)for(;pe(Be,R,fe,ae)<1;)St++,Se(R,fe<ae?Re:Be,ae,Ue),ae=R.length}else Xe===0&&(St++,R=[0]);P[Qe++]=St,R[0]?R[ae++]=Je[Oe]||0:(R=[Je[Oe]],ae=1)}while((Oe++<oe||R[0]!=null)&&$e--);st=R[0]!=null,P[0]||P.splice(0,1)}if(Ue==u){for(Qe=1,$e=P[0];$e>=10;$e/=10,Qe++);be(X,je+(X.e=Qe+et*c-1)+1,rt,st)}else X.e=et,X.r=+st;return X}}();function Ae(le,pe,Se,Ye){var Fe,je,rt,Ue,Xe;if(Se==null?Se=he:A(Se,0,8),!le.c)return le.toString();if(Fe=le.c[0],rt=le.e,pe==null)Xe=S(le.c),Xe=Ye==1||Ye==2&&(rt<=ve||rt>=xe)?D(Xe,rt):Y(Xe,rt,"0");else if(le=be(new ue(le),pe,Se),je=le.e,Xe=S(le.c),Ue=Xe.length,Ye==1||Ye==2&&(pe<=je||je<=ve)){for(;Ue<pe;Xe+="0",Ue++);Xe=D(Xe,je)}else if(pe-=rt,Xe=Y(Xe,je,"0"),je+1>Ue){if(--pe>0)for(Xe+=".";pe--;Xe+="0");}else if(pe+=je-Ue,pe>0)for(je+1==Ue&&(Xe+=".");pe--;Xe+="0");return le.s<0&&Fe?"-"+Xe:Xe}function Ve(le,pe){for(var Se,Ye,Fe=1,je=new ue(le[0]);Fe<le.length;Fe++)Ye=new ue(le[Fe]),(!Ye.s||(Se=w(je,Ye))===pe||Se===0&&je.s===pe)&&(je=Ye);return je}function He(le,pe,Se){for(var Ye=1,Fe=pe.length;!pe[--Fe];pe.pop());for(Fe=pe[0];Fe>=10;Fe/=10,Ye++);return(Se=Ye+Se*c-1)>we?le.c=le.e=null:Se<Ie?le.c=[le.e=0]:(le.e=Se,le.c=pe),le}se=function(){var le=/^(-?)0([xbo])(?=\w[\w.]*$)/i,pe=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,Ye=/^-?(Infinity|NaN)$/,Fe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(je,rt,Ue,Xe){var et,Qe=Ue?rt:rt.replace(Fe,"");if(Ye.test(Qe))je.s=isNaN(Qe)?null:Qe<0?-1:1;else{if(!Ue&&(Qe=Qe.replace(le,function(st,St,At){return et=(At=At.toLowerCase())=="x"?16:At=="b"?2:8,!Xe||Xe==et?St:st}),Xe&&(et=Xe,Qe=Qe.replace(pe,"$1").replace(Se,"0.$1")),rt!=Qe))return new ue(Qe,et);if(ue.DEBUG)throw Error(a+"Not a"+(Xe?" base "+Xe:"")+" number: "+rt);je.s=null}je.c=je.e=null}}();function be(le,pe,Se,Ye){var Fe,je,rt,Ue,Xe,et,Qe,st=le.c,St=g;if(st){e:{for(Fe=1,Ue=st[0];Ue>=10;Ue/=10,Fe++);if(je=pe-Fe,je<0)je+=c,rt=pe,Xe=st[et=0],Qe=o(Xe/St[Fe-rt-1]%10);else if(et=s((je+1)/c),et>=st.length)if(Ye){for(;st.length<=et;st.push(0));Xe=Qe=0,Fe=1,je%=c,rt=je-c+1}else break e;else{for(Xe=Ue=st[et],Fe=1;Ue>=10;Ue/=10,Fe++);je%=c,rt=je-c+Fe,Qe=rt<0?0:o(Xe/St[Fe-rt-1]%10)}if(Ye=Ye||pe<0||st[et+1]!=null||(rt<0?Xe:Xe%St[Fe-rt-1]),Ye=Se<4?(Qe||Ye)&&(Se==0||Se==(le.s<0?3:2)):Qe>5||Qe==5&&(Se==4||Ye||Se==6&&(je>0?rt>0?Xe/St[Fe-rt]:0:st[et-1])%10&1||Se==(le.s<0?8:7)),pe<1||!st[0])return st.length=0,Ye?(pe-=le.e+1,st[0]=St[(c-pe%c)%c],le.e=-pe||0):st[0]=le.e=0,le;if(je==0?(st.length=et,Ue=1,et--):(st.length=et+1,Ue=St[c-je],st[et]=rt>0?o(Xe/St[Fe-rt]%St[rt])*Ue:0),Ye)for(;;)if(et==0){for(je=1,rt=st[0];rt>=10;rt/=10,je++);for(rt=st[0]+=Ue,Ue=1;rt>=10;rt/=10,Ue++);je!=Ue&&(le.e++,st[0]==u&&(st[0]=1));break}else{if(st[et]+=Ue,st[et]!=u)break;st[et--]=0,Ue=1}for(je=st.length;st[--je]===0;st.pop());}le.e>we?le.c=le.e=null:le.e<Ie&&(le.c=[le.e=0])}return le}function qe(le){var pe,Se=le.e;return Se===null?le.toString():(pe=S(le.c),pe=Se<=ve||Se>=xe?D(pe,Se):Y(pe,Se,"0"),le.s<0?"-"+pe:pe)}return re.absoluteValue=re.abs=function(){var le=new ue(this);return le.s<0&&(le.s=1),le},re.comparedTo=function(le,pe){return w(this,new ue(le,pe))},re.decimalPlaces=re.dp=function(le,pe){var Se,Ye,Fe,je=this;if(le!=null)return A(le,0,m),pe==null?pe=he:A(pe,0,8),be(new ue(je),le+je.e+1,pe);if(!(Se=je.c))return null;if(Ye=((Fe=Se.length-1)-_(this.e/c))*c,Fe=Se[Fe])for(;Fe%10==0;Fe/=10,Ye--);return Ye<0&&(Ye=0),Ye},re.dividedBy=re.div=function(le,pe){return k(this,new ue(le,pe),Le,he)},re.dividedToIntegerBy=re.idiv=function(le,pe){return k(this,new ue(le,pe),0,1)},re.exponentiatedBy=re.pow=function(le,pe){var Se,Ye,Fe,je,rt,Ue,Xe,et,Qe,st=this;if(le=new ue(le),le.c&&!le.isInteger())throw Error(a+"Exponent not an integer: "+qe(le));if(pe!=null&&(pe=new ue(pe)),Ue=le.e>14,!st.c||!st.c[0]||st.c[0]==1&&!st.e&&st.c.length==1||!le.c||!le.c[0])return Qe=new ue(Math.pow(+qe(st),Ue?le.s*(2-O(le)):+qe(le))),pe?Qe.mod(pe):Qe;if(Xe=le.s<0,pe){if(pe.c?!pe.c[0]:!pe.s)return new ue(NaN);Ye=!Xe&&st.isInteger()&&pe.isInteger(),Ye&&(st=st.mod(pe))}else{if(le.e>9&&(st.e>0||st.e<-1||(st.e==0?st.c[0]>1||Ue&&st.c[1]>=24e7:st.c[0]<8e13||Ue&&st.c[0]<=9999975e7)))return je=st.s<0&&O(le)?-0:0,st.e>-1&&(je=1/je),new ue(Xe?1/je:je);nt&&(je=s(nt/c+2))}for(Ue?(Se=new ue(.5),Xe&&(le.s=1),et=O(le)):(Fe=Math.abs(+qe(le)),et=Fe%2),Qe=new ue(Ce);;){if(et){if(Qe=Qe.times(st),!Qe.c)break;je?Qe.c.length>je&&(Qe.c.length=je):Ye&&(Qe=Qe.mod(pe))}if(Fe){if(Fe=o(Fe/2),Fe===0)break;et=Fe%2}else if(le=le.times(Se),be(le,le.e+1,1),le.e>14)et=O(le);else{if(Fe=+qe(le),Fe===0)break;et=Fe%2}st=st.times(st),je?st.c&&st.c.length>je&&(st.c.length=je):Ye&&(st=st.mod(pe))}return Ye?Qe:(Xe&&(Qe=Ce.div(Qe)),pe?Qe.mod(pe):je?be(Qe,nt,he,rt):Qe)},re.integerValue=function(le){var pe=new ue(this);return le==null?le=he:A(le,0,8),be(pe,pe.e+1,le)},re.isEqualTo=re.eq=function(le,pe){return w(this,new ue(le,pe))===0},re.isFinite=function(){return!!this.c},re.isGreaterThan=re.gt=function(le,pe){return w(this,new ue(le,pe))>0},re.isGreaterThanOrEqualTo=re.gte=function(le,pe){return(pe=w(this,new ue(le,pe)))===1||pe===0},re.isInteger=function(){return!!this.c&&_(this.e/c)>this.c.length-2},re.isLessThan=re.lt=function(le,pe){return w(this,new ue(le,pe))<0},re.isLessThanOrEqualTo=re.lte=function(le,pe){return(pe=w(this,new ue(le,pe)))===-1||pe===0},re.isNaN=function(){return!this.s},re.isNegative=function(){return this.s<0},re.isPositive=function(){return this.s>0},re.isZero=function(){return!!this.c&&this.c[0]==0},re.minus=function(le,pe){var Se,Ye,Fe,je,rt=this,Ue=rt.s;if(le=new ue(le,pe),pe=le.s,!Ue||!pe)return new ue(NaN);if(Ue!=pe)return le.s=-pe,rt.plus(le);var Xe=rt.e/c,et=le.e/c,Qe=rt.c,st=le.c;if(!Xe||!et){if(!Qe||!st)return Qe?(le.s=-pe,le):new ue(st?rt:NaN);if(!Qe[0]||!st[0])return st[0]?(le.s=-pe,le):new ue(Qe[0]?rt:he==3?-0:0)}if(Xe=_(Xe),et=_(et),Qe=Qe.slice(),Ue=Xe-et){for((je=Ue<0)?(Ue=-Ue,Fe=Qe):(et=Xe,Fe=st),Fe.reverse(),pe=Ue;pe--;Fe.push(0));Fe.reverse()}else for(Ye=(je=(Ue=Qe.length)<(pe=st.length))?Ue:pe,Ue=pe=0;pe<Ye;pe++)if(Qe[pe]!=st[pe]){je=Qe[pe]<st[pe];break}if(je&&(Fe=Qe,Qe=st,st=Fe,le.s=-le.s),pe=(Ye=st.length)-(Se=Qe.length),pe>0)for(;pe--;Qe[Se++]=0);for(pe=u-1;Ye>Ue;){if(Qe[--Ye]<st[Ye]){for(Se=Ye;Se&&!Qe[--Se];Qe[Se]=pe);--Qe[Se],Qe[Ye]+=u}Qe[Ye]-=st[Ye]}for(;Qe[0]==0;Qe.splice(0,1),--et);return Qe[0]?He(le,Qe,et):(le.s=he==3?-1:1,le.c=[le.e=0],le)},re.modulo=re.mod=function(le,pe){var Se,Ye,Fe=this;return le=new ue(le,pe),!Fe.c||!le.s||le.c&&!le.c[0]?new ue(NaN):!le.c||Fe.c&&!Fe.c[0]?new ue(Fe):(at==9?(Ye=le.s,le.s=1,Se=k(Fe,le,0,3),le.s=Ye,Se.s*=Ye):Se=k(Fe,le,0,at),le=Fe.minus(Se.times(le)),!le.c[0]&&at==1&&(le.s=Fe.s),le)},re.multipliedBy=re.times=function(le,pe){var Se,Ye,Fe,je,rt,Ue,Xe,et,Qe,st,St,At,j,X,P,R=this,ae=R.c,Pe=(le=new ue(le,pe)).c;if(!ae||!Pe||!ae[0]||!Pe[0])return!R.s||!le.s||ae&&!ae[0]&&!Pe||Pe&&!Pe[0]&&!ae?le.c=le.e=le.s=null:(le.s*=R.s,!ae||!Pe?le.c=le.e=null:(le.c=[0],le.e=0)),le;for(Ye=_(R.e/c)+_(le.e/c),le.s*=R.s,Xe=ae.length,st=Pe.length,Xe<st&&(j=ae,ae=Pe,Pe=j,Fe=Xe,Xe=st,st=Fe),Fe=Xe+st,j=[];Fe--;j.push(0));for(X=u,P=v,Fe=st;--Fe>=0;){for(Se=0,St=Pe[Fe]%P,At=Pe[Fe]/P|0,rt=Xe,je=Fe+rt;je>Fe;)et=ae[--rt]%P,Qe=ae[rt]/P|0,Ue=At*et+Qe*St,et=St*et+Ue%P*P+j[je]+Se,Se=(et/X|0)+(Ue/P|0)+At*Qe,j[je--]=et%X;j[je]=Se}return Se?++Ye:j.splice(0,1),He(le,j,Ye)},re.negated=function(){var le=new ue(this);return le.s=-le.s||null,le},re.plus=function(le,pe){var Se,Ye=this,Fe=Ye.s;if(le=new ue(le,pe),pe=le.s,!Fe||!pe)return new ue(NaN);if(Fe!=pe)return le.s=-pe,Ye.minus(le);var je=Ye.e/c,rt=le.e/c,Ue=Ye.c,Xe=le.c;if(!je||!rt){if(!Ue||!Xe)return new ue(Fe/0);if(!Ue[0]||!Xe[0])return Xe[0]?le:new ue(Ue[0]?Ye:Fe*0)}if(je=_(je),rt=_(rt),Ue=Ue.slice(),Fe=je-rt){for(Fe>0?(rt=je,Se=Xe):(Fe=-Fe,Se=Ue),Se.reverse();Fe--;Se.push(0));Se.reverse()}for(Fe=Ue.length,pe=Xe.length,Fe-pe<0&&(Se=Xe,Xe=Ue,Ue=Se,pe=Fe),Fe=0;pe;)Fe=(Ue[--pe]=Ue[pe]+Xe[pe]+Fe)/u|0,Ue[pe]=u===Ue[pe]?0:Ue[pe]%u;return Fe&&(Ue=[Fe].concat(Ue),++rt),He(le,Ue,rt)},re.precision=re.sd=function(le,pe){var Se,Ye,Fe,je=this;if(le!=null&&le!==!!le)return A(le,1,m),pe==null?pe=he:A(pe,0,8),be(new ue(je),le,pe);if(!(Se=je.c))return null;if(Fe=Se.length-1,Ye=Fe*c+1,Fe=Se[Fe]){for(;Fe%10==0;Fe/=10,Ye--);for(Fe=Se[0];Fe>=10;Fe/=10,Ye++);}return le&&je.e+1>Ye&&(Ye=je.e+1),Ye},re.shiftedBy=function(le){return A(le,-9007199254740991,h),this.times("1e"+le)},re.squareRoot=re.sqrt=function(){var le,pe,Se,Ye,Fe,je=this,rt=je.c,Ue=je.s,Xe=je.e,et=Le+4,Qe=new ue("0.5");if(Ue!==1||!rt||!rt[0])return new ue(!Ue||Ue<0&&(!rt||rt[0])?NaN:rt?je:1/0);if(Ue=Math.sqrt(+qe(je)),Ue==0||Ue==1/0?(pe=S(rt),(pe.length+Xe)%2==0&&(pe+="0"),Ue=Math.sqrt(+pe),Xe=_((Xe+1)/2)-(Xe<0||Xe%2),Ue==1/0?pe="5e"+Xe:(pe=Ue.toExponential(),pe=pe.slice(0,pe.indexOf("e")+1)+Xe),Se=new ue(pe)):Se=new ue(Ue+""),Se.c[0]){for(Xe=Se.e,Ue=Xe+et,Ue<3&&(Ue=0);;)if(Fe=Se,Se=Qe.times(Fe.plus(k(je,Fe,et,1))),S(Fe.c).slice(0,Ue)===(pe=S(Se.c)).slice(0,Ue))if(Se.e<Xe&&--Ue,pe=pe.slice(Ue-3,Ue+1),pe=="9999"||!Ye&&pe=="4999"){if(!Ye&&(be(Fe,Fe.e+Le+2,0),Fe.times(Fe).eq(je))){Se=Fe;break}et+=4,Ue+=4,Ye=1}else{(!+pe||!+pe.slice(1)&&pe.charAt(0)=="5")&&(be(Se,Se.e+Le+2,1),le=!Se.times(Se).eq(je));break}}return be(Se,Se.e+Le+1,he,le)},re.toExponential=function(le,pe){return le!=null&&(A(le,0,m),le++),Ae(this,le,pe,1)},re.toFixed=function(le,pe){return le!=null&&(A(le,0,m),le=le+this.e+1),Ae(this,le,pe)},re.toFormat=function(le,pe,Se){var Ye,Fe=this;if(Se==null)le!=null&&pe&&typeof pe=="object"?(Se=pe,pe=null):le&&typeof le=="object"?(Se=le,le=pe=null):Se=B;else if(typeof Se!="object")throw Error(a+"Argument not an object: "+Se);if(Ye=Fe.toFixed(le,pe),Fe.c){var je,rt=Ye.split("."),Ue=+Se.groupSize,Xe=+Se.secondaryGroupSize,et=Se.groupSeparator||"",Qe=rt[0],st=rt[1],St=Fe.s<0,At=St?Qe.slice(1):Qe,j=At.length;if(Xe&&(je=Ue,Ue=Xe,Xe=je,j-=je),Ue>0&&j>0){for(je=j%Ue||Ue,Qe=At.substr(0,je);je<j;je+=Ue)Qe+=et+At.substr(je,Ue);Xe>0&&(Qe+=et+At.slice(je)),St&&(Qe="-"+Qe)}Ye=st?Qe+(Se.decimalSeparator||"")+((Xe=+Se.fractionGroupSize)?st.replace(new RegExp("\\d{"+Xe+"}\\B","g"),"$&"+(Se.fractionGroupSeparator||"")):st):Qe}return(Se.prefix||"")+Ye+(Se.suffix||"")},re.toFraction=function(le){var pe,Se,Ye,Fe,je,rt,Ue,Xe,et,Qe,st,St,At=this,j=At.c;if(le!=null&&(Ue=new ue(le),!Ue.isInteger()&&(Ue.c||Ue.s!==1)||Ue.lt(Ce)))throw Error(a+"Argument "+(Ue.isInteger()?"out of range: ":"not an integer: ")+qe(Ue));if(!j)return new ue(At);for(pe=new ue(Ce),et=Se=new ue(Ce),Ye=Xe=new ue(Ce),St=S(j),je=pe.e=St.length-At.e-1,pe.c[0]=g[(rt=je%c)<0?c+rt:rt],le=!le||Ue.comparedTo(pe)>0?je>0?pe:et:Ue,rt=we,we=1/0,Ue=new ue(St),Xe.c[0]=0;Qe=k(Ue,pe,0,1),Fe=Se.plus(Qe.times(Ye)),Fe.comparedTo(le)!=1;)Se=Ye,Ye=Fe,et=Xe.plus(Qe.times(Fe=et)),Xe=Fe,pe=Ue.minus(Qe.times(Fe=pe)),Ue=Fe;return Fe=k(le.minus(Se),Ye,0,1),Xe=Xe.plus(Fe.times(et)),Se=Se.plus(Fe.times(Ye)),Xe.s=et.s=At.s,je=je*2,st=k(et,Ye,je,he).minus(At).abs().comparedTo(k(Xe,Se,je,he).minus(At).abs())<1?[et,Ye]:[Xe,Se],we=rt,st},re.toNumber=function(){return+qe(this)},re.toPrecision=function(le,pe){return le!=null&&A(le,1,m),Ae(this,le,pe,2)},re.toString=function(le){var pe,Se=this,Ye=Se.s,Fe=Se.e;return Fe===null?Ye?(pe="Infinity",Ye<0&&(pe="-"+pe)):pe="NaN":(le==null?pe=Fe<=ve||Fe>=xe?D(S(Se.c),Fe):Y(S(Se.c),Fe,"0"):le===10&&V?(Se=be(new ue(Se),Le+Fe+1,he),pe=Y(S(Se.c),Se.e,"0")):(A(le,2,te.length,"Base"),pe=K(Y(S(Se.c),Fe,"0"),10,le,Ye,!0)),Ye<0&&Se.c[0]&&(pe="-"+pe)),pe},re.valueOf=re.toJSON=function(){return qe(this)},re._isBigNumber=!0,H!=null&&ue.set(H),ue}function _(H){var k=H|0;return H>0||H===k?k:k-1}function S(H){for(var k,K,se=1,re=H.length,Ce=H[0]+"";se<re;){for(k=H[se++]+"",K=c-k.length;K--;k="0"+k);Ce+=k}for(re=Ce.length;Ce.charCodeAt(--re)===48;);return Ce.slice(0,re+1||1)}function w(H,k){var K,se,re=H.c,Ce=k.c,Le=H.s,he=k.s,ve=H.e,xe=k.e;if(!Le||!he)return null;if(K=re&&!re[0],se=Ce&&!Ce[0],K||se)return K?se?0:-he:Le;if(Le!=he)return Le;if(K=Le<0,se=ve==xe,!re||!Ce)return se?0:!re^K?1:-1;if(!se)return ve>xe^K?1:-1;for(he=(ve=re.length)<(xe=Ce.length)?ve:xe,Le=0;Le<he;Le++)if(re[Le]!=Ce[Le])return re[Le]>Ce[Le]^K?1:-1;return ve==xe?0:ve>xe^K?1:-1}function A(H,k,K,se){if(H<k||H>K||H!==o(H))throw Error(a+(se||"Argument")+(typeof H=="number"?H<k||H>K?" out of range: ":" not an integer: ":" not a primitive number: ")+String(H))}function O(H){var k=H.c.length-1;return _(H.e/c)==k&&H.c[k]%2!=0}function D(H,k){return(H.length>1?H.charAt(0)+"."+H.slice(1):H)+(k<0?"e":"e+")+k}function Y(H,k,K){var se,re;if(k<0){for(re=K+".";++k;re+=K);H=re+H}else if(se=H.length,++k>se){for(re=K,k-=se;--k;re+=K);H+=re}else k<se&&(H=H.slice(0,k)+"."+H.slice(k));return H}t=E(),t.default=t.BigNumber=t,r.exports?r.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(commonjsGlobal)})(bignumber);var bignumberExports=bignumber.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const globalState$1=requireGlobalState(),validating=requireValidating(),parsing$1=parsing$2,BigNumber$1=bignumberExports,powers={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},defaultOptions={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes,decimalSuffixes}=globalState$1.currentBytes(),bytes={general:{scale:1024,suffixes:decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:decimalSuffixes,marker:"d"}};function format$1(r,e={},t){if(typeof e=="string"&&(e=parsing$1.parseFormat(e)),!validating.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",o=e.postfix||"",a=formatNumbro(r,e,t);return a=insertPrefix(a,s),a=insertPostfix(a,o),a}function formatNumbro(r,e,t){switch(e.output){case"currency":return e=formatOrDefault(e,globalState$1.currentCurrencyDefaultFormat()),formatCurrency(r,e,globalState$1);case"percent":return e=formatOrDefault(e,globalState$1.currentPercentageDefaultFormat()),formatPercentage(r,e,globalState$1,t);case"byte":return e=formatOrDefault(e,globalState$1.currentByteDefaultFormat()),formatByte(r,e,globalState$1,t);case"time":return e=formatOrDefault(e,globalState$1.currentTimeDefaultFormat()),formatTime(r);case"ordinal":return e=formatOrDefault(e,globalState$1.currentOrdinalDefaultFormat()),formatOrdinal(r,e,globalState$1);case"number":default:return formatNumber$1({instance:r,providedFormat:e,numbro:t})}}function getDecimalByteUnit(r){let e=bytes.decimal;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getBinaryByteUnit(r){let e=bytes.binary;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getByteUnit(r){let e=bytes.general;return getFormatByteUnits(r._value,e.suffixes,e.scale).suffix}function getFormatByteUnits(r,e,t){let n=e[0],s=Math.abs(r);if(s>=t){for(let o=1;o<e.length;++o){let a=Math.pow(t,o),l=Math.pow(t,o+1);if(s>=a&&s<l){n=e[o],r=r/a;break}}n===e[0]&&(r=r/Math.pow(t,e.length-1),n=e[e.length-1])}return{value:r,suffix:n}}function formatByte(r,e,t,n){let s=e.base||"binary",o=Object.assign({},defaultOptions,e);const{binarySuffixes:a,decimalSuffixes:l}=t.currentBytes();let c={general:{scale:1024,suffixes:l||decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:a||binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:l||decimalSuffixes,marker:"d"}}[s],{value:h,suffix:g}=getFormatByteUnits(r._value,c.suffixes,c.scale);return`${formatNumber$1({instance:n(h),providedFormat:e,state:t,defaults:t.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${g}`}function formatOrdinal(r,e,t){let n=t.currentOrdinal(),s=Object.assign({},defaultOptions,e),o=formatNumber$1({instance:r,providedFormat:e,state:t}),a=n(r._value);return`${o}${s.spaceSeparated?" ":""}${a}`}function formatTime(r){let e=Math.floor(r._value/60/60),t=Math.floor((r._value-e*60*60)/60),n=Math.round(r._value-e*60*60-t*60);return`${e}:${t<10?"0":""}${t}:${n<10?"0":""}${n}`}function formatPercentage(r,e,t,n){let s=e.prefixSymbol,o=formatNumber$1({instance:n(r._value*100),providedFormat:e,state:t}),a=Object.assign({},defaultOptions,e);return s?`%${a.spaceSeparated?" ":""}${o}`:`${o}${a.spaceSeparated?" ":""}%`}function formatCurrency(r,e,t){const n=t.currentCurrency();let s=Object.assign({},e),o=Object.assign({},defaultOptions,s),a,l="",u=!!o.totalLength||!!o.forceAverage||o.average,c=s.currencyPosition||n.position,h=s.currencySymbol||n.symbol;const g=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),g&&(l=" "),c==="infix"&&(a=l+h+l);let v=formatNumber$1({instance:r,providedFormat:s,state:t,decimalSeparator:a});return c==="prefix"&&(r._value<0&&o.negative==="sign"?v=`-${l}${h}${v.slice(1)}`:r._value>0&&o.forceSign?v=`+${l}${h}${v.slice(1)}`:v=h+l+v),(!c||c==="postfix")&&(l=!o.spaceSeparatedAbbreviation&&u?"":l,v=v+l+h),v}function computeAverage({value:r,forceAverage:e,lowPrecision:t=!0,abbreviations:n,spaceSeparated:s=!1,totalLength:o=0,roundingFunction:a=Math.round}){let l="",u=Math.abs(r),c=-1;if(e&&n[e]&&powers[e]?(l=n[e],r=r/powers[e]):u>=powers.trillion||t&&a(u/powers.trillion)===1?(l=n.trillion,r=r/powers.trillion):u<powers.trillion&&u>=powers.billion||t&&a(u/powers.billion)===1?(l=n.billion,r=r/powers.billion):u<powers.billion&&u>=powers.million||t&&a(u/powers.million)===1?(l=n.million,r=r/powers.million):(u<powers.million&&u>=powers.thousand||t&&a(u/powers.thousand)===1)&&(l=n.thousand,r=r/powers.thousand),l&&(l=(s?" ":"")+l),o){let g=r<0,v=r.toString().split(".")[0],m=g?v.length-1:v.length;c=Math.max(o-m,0)}return{value:r,abbreviation:l,mantissaPrecision:c}}function computeExponential({value:r,characteristicPrecision:e}){let[t,n]=r.toExponential().split("e"),s=+t;if(!e)return{value:s,abbreviation:`e${n}`};let o=1;return o<e&&(s=s*Math.pow(10,e-o),n=+n-(e-o),n=n>=0?`+${n}`:n),{value:s,abbreviation:`e${n}`}}function zeroes(r){let e="";for(let t=0;t<r;t++)e+="0";return e}function toFixedLarge(r,e){let t=r.toString(),[n,s]=t.split("e"),[o,a=""]=n.split(".");if(+s>0)t=o+a+zeroes(s-a.length);else{let l=".";+o<0?l=`-0${l}`:l=`0${l}`;let u=(zeroes(-s-1)+Math.abs(o)+a).substr(0,e);u.length<e&&(u+=zeroes(e-u.length)),t=l+u}return+s>0&&e>0&&(t+=`.${zeroes(e)}`),t}function toFixed(r,e,t=Math.round){return r.toString().indexOf("e")!==-1?toFixedLarge(r,e):new BigNumber$1(t(+`${r}e+${e}`)/Math.pow(10,e)).toFixed(e)}function setMantissaPrecision(r,e,t,n,s,o){if(n===-1)return r;let a=toFixed(e,n,o),[l,u=""]=a.toString().split(".");if(u.match(/^0+$/)&&(t||s))return l;let c=u.match(/0+$/);return s&&c?`${l}.${u.toString().slice(0,c.index)}`:a.toString()}function setCharacteristicPrecision(r,e,t,n){let s=r,[o,a]=s.toString().split(".");if(o.match(/^-?0$/)&&t)return a?`${o.replace("0","")}.${a}`:o.replace("0","");const l=e<0&&o.indexOf("-")===0;if(l&&(o=o.slice(1),s=s.slice(1)),o.length<n){let u=n-o.length;for(let c=0;c<u;c++)s=`0${s}`}return l&&(s=`-${s}`),s.toString()}function indexesOfGroupSpaces(r,e){let t=[],n=0;for(let s=r;s>0;s--)n===e&&(t.unshift(s),n=0),n++;return t}function replaceDelimiters(r,e,t,n,s){let o=n.currentDelimiters(),a=o.thousands;s=s||o.decimal;let l=o.thousandsSize||3,u=r.toString(),c=u.split(".")[0],h=u.split(".")[1];const g=e<0&&c.indexOf("-")===0;return t&&(g&&(c=c.slice(1)),indexesOfGroupSpaces(c.length,l).forEach((m,E)=>{c=c.slice(0,m+E)+a+c.slice(m+E)}),g&&(c=`-${c}`)),h?u=c+s+h:u=c,u}function insertAbbreviation(r,e){return r+e}function insertSign(r,e,t){return e===0?r:+r==0?r.replace("-",""):e>0?`+${r}`:t==="sign"?r:`(${r.replace("-","")})`}function insertPrefix(r,e){return e+r}function insertPostfix(r,e){return r+e}function formatNumber$1({instance:r,providedFormat:e,state:t=globalState$1,decimalSeparator:n,defaults:s=t.currentDefaults()}){let o=r._value;if(o===0&&t.hasZeroFormat())return t.getZeroFormat();if(!isFinite(o))return o.toString();let a=Object.assign({},defaultOptions,s,e),l=a.totalLength,u=l?0:a.characteristic,c=a.optionalCharacteristic,h=a.forceAverage,g=a.lowPrecision,v=!!l||!!h||a.average,m=l?-1:v&&e.mantissa===void 0?0:a.mantissa,E=l?!1:e.optionalMantissa===void 0?m===-1:a.optionalMantissa,_=a.trimMantissa,S=a.thousandSeparated,w=a.spaceSeparated,A=a.negative,O=a.forceSign,D=a.exponential,Y=a.roundingFunction,H="";if(v){let K=computeAverage({value:o,forceAverage:h,lowPrecision:g,abbreviations:t.currentAbbreviations(),spaceSeparated:w,roundingFunction:Y,totalLength:l});o=K.value,H+=K.abbreviation,l&&(m=K.mantissaPrecision)}if(D){let K=computeExponential({value:o,characteristicPrecision:u});o=K.value,H=K.abbreviation+H}let k=setMantissaPrecision(o.toString(),o,E,m,_,Y);return k=setCharacteristicPrecision(k,o,c,u),k=replaceDelimiters(k,o,S,t,n),(v||D)&&(k=insertAbbreviation(k,H)),(O||o<0)&&(k=insertSign(k,o,A)),k}function formatOrDefault(r,e){if(!r)return e;let t=Object.keys(r);return t.length===1&&t[0]==="output"?e:r}var formatting=r=>({format:(...e)=>format$1(...e,r),getByteUnit:(...e)=>getByteUnit(...e,r),getBinaryByteUnit:(...e)=>getBinaryByteUnit(...e,r),getDecimalByteUnit:(...e)=>getDecimalByteUnit(...e,r),formatOrDefault});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const BigNumber=bignumberExports;function add$1(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.plus(s).toNumber(),r}function subtract(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.minus(s).toNumber(),r}function multiply(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.times(s).toNumber(),r}function divide(r,e,t){let n=new BigNumber(r._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new BigNumber(s),r._value=n.dividedBy(s).toNumber(),r}function set(r,e,t){let n=e;return t.isNumbro(e)&&(n=e._value),r._value=n,r}function difference$1(r,e,t){let n=t(r._value);return subtract(n,e,t),Math.abs(n._value)}var manipulating=r=>({add:(e,t)=>add$1(e,t,r),subtract:(e,t)=>subtract(e,t,r),multiply:(e,t)=>multiply(e,t,r),divide:(e,t)=>divide(e,t,r),set:(e,t)=>set(e,t,r),difference:(e,t)=>difference$1(e,t,r),BigNumber});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const VERSION="2.5.0",globalState=requireGlobalState(),validator=requireValidating(),loader=loading(numbro),unformatter=requireUnformatting();let formatter=formatting(numbro),manipulate=manipulating(numbro);const parsing=parsing$2;class Numbro{constructor(e){this._value=e}clone(){return numbro(this._value)}format(e={}){return formatter.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=parsing.parseFormat(e)),e=formatter.formatOrDefault(e,globalState.currentCurrencyDefaultFormat()),e.output="currency",formatter.format(this,e)}formatTime(e={}){return e.output="time",formatter.format(this,e)}binaryByteUnits(){return formatter.getBinaryByteUnit(this)}decimalByteUnits(){return formatter.getDecimalByteUnit(this)}byteUnits(){return formatter.getByteUnit(this)}difference(e){return manipulate.difference(this,e)}add(e){return manipulate.add(this,e)}subtract(e){return manipulate.subtract(this,e)}multiply(e){return manipulate.multiply(this,e)}divide(e){return manipulate.divide(this,e)}set(e){return manipulate.set(this,normalizeInput(e))}value(){return this._value}valueOf(){return this._value}}function normalizeInput(r){let e=r;return numbro.isNumbro(r)?e=r._value:typeof r=="string"?e=numbro.unformat(r):isNaN(r)&&(e=NaN),e}function numbro(r){return new Numbro(normalizeInput(r))}numbro.version=VERSION;numbro.isNumbro=function(r){return r instanceof Numbro};numbro.language=globalState.currentLanguage;numbro.registerLanguage=globalState.registerLanguage;numbro.setLanguage=globalState.setLanguage;numbro.languages=globalState.languages;numbro.languageData=globalState.languageData;numbro.zeroFormat=globalState.setZeroFormat;numbro.defaultFormat=globalState.currentDefaults;numbro.setDefaults=globalState.setDefaults;numbro.defaultCurrencyFormat=globalState.currentCurrencyDefaultFormat;numbro.validate=validator.validate;numbro.loadLanguagesInNode=loader.loadLanguagesInNode;numbro.unformat=unformatter.unformat;numbro.BigNumber=manipulate.BigNumber;var numbro_1=numbro,numbro$1=getDefaultExportFromCjs$1(numbro_1);const RENDERER_TYPE$4="numeric";function getRenderedValue(r,e){if(isNumeric(r)){const t=e.numericFormat,n=t&&t.culture||"-",s=t&&t.pattern;if(typeof n<"u"&&!numbro$1.languages()[n]){const o=n.replace("-",""),a=numbro$1.allLanguages?numbro$1.allLanguages[n]:numbro$1[o];a&&numbro$1.registerLanguage(a)}numbro$1.setLanguage(n),r=numbro$1(r).format(s||"0")}return r}function numericRenderer(r,e,t,n,s,o,a){let l=o;if(isNumeric(l)){const u=a.className||"",c=u.length?u.split(" "):[];l=getRenderedValue(l,a),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),a.className=c.join(" "),e.dir="ltr"}textRenderer(r,e,t,n,s,l,a)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$4;const RENDERER_TYPE$3="password";function passwordRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a]);const l=a.hashLength||e.innerHTML.length,u=a.hashSymbol||"*";let c="";rangeEach(l-1,()=>{c+=u}),fastInnerHTML(e,c)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$3;const RENDERER_TYPE$2="select";function selectRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE$2;const RENDERER_TYPE$1="time";function timeRenderer(r,e,t,n,s,o,a){textRenderer.apply(this,[r,e,t,n,s,o,a]),e.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE$1;const{register:register$3,getItem:getItem$2,hasItem:hasItem$2,getNames:getNames$2,getValues:getValues$2}=staticRegister("renderers");function _getItem$2(r){if(typeof r=="function")return r;if(!hasItem$2(r))throw Error(`No registered renderer found under "${r}" name`);return getItem$2(r)}function _register$2(r,e){typeof r!="string"&&(e=r,r=e.RENDERER_TYPE),register$3(r,e)}function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(dropdownRenderer),_register$2(handsontableRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(selectRenderer),_register$2(textRenderer),_register$2(timeRenderer)}const VALIDATOR_TYPE$4="autocomplete";function autocompleteValidator(r,e){let t=r;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,process(t,e)):process(t,e)(this.source):e(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$4;function process(r,e){const t=r;return function(n){let s=!1;for(let o=0,a=n.length;o<a;o++)if(t===n[o]){s=!0;break}e(s)}}function getNormalizedDate(r){const e=new Date(r);return isNaN(new Date(`${r}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const VALIDATOR_TYPE$3="date";function dateValidator(r,e){const t=_getEditorInstance(EDITOR_TYPE$5,this.instance);let n=r,s=!0;n==null&&(n="");let o=hooks(n,this.dateFormat||t.defaultDateFormat,!0).isValid(),a=hooks(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(s=!1),!a&&o&&(s=!0),a&&!o)if(this.correctFormat===!0){const l=correctFormat(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,l,"dateValidator"),s=!0}else s=!1;e(s)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function correctFormat(r,e){const t=hooks(getNormalizedDate(r)),n=hooks(r,e),s=r.search(/[A-z]/g)>-1;let o;return t.isValid()&&t.format("x")===n.format("x")||!n.isValid()||s?o=t:o=n,o.format(e)}const VALIDATOR_TYPE$2="dropdown";function dropdownValidator(r,e){autocompleteValidator.apply(this,[r,e])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;const VALIDATOR_TYPE$1="numeric";function numericValidator(r,e){let t=r;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:isNumeric(r))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(r,e){const t=this.timeFormat||"h:mm:ss a";let n=!0,s=r;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const o=/^\d{1,2}$/.test(s);o&&(s+=":00");const a=hooks(s,STRICT_FORMATS,!0).isValid()?hooks(s):hooks(s,t);let l=a.isValid(),u=hooks(s,t,!0).isValid()&&!o;if(this.allowEmpty&&s===""&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(this.correctFormat===!0){const c=a.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;const{register:register$2,getItem:getItem$1,hasItem:hasItem$1,getNames:getNames$1,getValues:getValues$1}=staticRegister("validators");function _getItem$1(r){if(typeof r=="function")return r;if(!hasItem$1(r))throw Error(`No registered validator found under "${r}" name`);return getItem$1(r)}function _register$1(r,e){typeof r!="string"&&(e=r,r=e.VALIDATOR_TYPE),register$2(r,e)}function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dropdownValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}const CELL_TYPE$9="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$9,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$8="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$8,editor:CheckboxEditor,renderer:checkboxRenderer},RENDERER_TYPE="date";function dateRenderer(r,e,t,n,s,o,a){autocompleteRenderer.apply(this,[r,e,t,n,s,o,a])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE;const CELL_TYPE$7="date",DateCellType={CELL_TYPE:CELL_TYPE$7,editor:DateEditor,renderer:dateRenderer,validator:dateValidator},CELL_TYPE$6="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$6,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator},CELL_TYPE$5="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$5,editor:HandsontableEditor,renderer:handsontableRenderer},CELL_TYPE$4="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$4,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE$3="password",PasswordCellType={CELL_TYPE:CELL_TYPE$3,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE$2="select",SelectCellType={CELL_TYPE:CELL_TYPE$2,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE$1="text",TextCellType={CELL_TYPE:CELL_TYPE$1,editor:TextEditor,renderer:textRenderer},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator},{register:register$1,getItem,hasItem,getNames,getValues}=staticRegister("cellTypes");function _getItem(r){if(!hasItem(r))throw Error(`You declared cell type "${r}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem(r)}function _register(r,e){typeof r!="string"&&(e=r,r=e.CELL_TYPE);const{editor:t,renderer:n,validator:s}=e;t&&_register$3(r,t),n&&_register$2(r,n),s&&_register$1(r,s),register$1(r,e)}function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(SelectCellType),_register(TextCellType),_register(TimeCellType)}const ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=r=>`The priority '${r}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=r=>`The priority '${r}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:r,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;r=isFunction$1(r)?r:DEFAULT_ERROR_PRIORITY_EXISTS,e=isFunction$1(e)?e:DEFAULT_ERROR_PRIORITY_NAN;function n(o,a){if(!isNumeric(o))throw new Error(e(o));if(t.has(o))throw new Error(r(o));t.set(o,a)}function s(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[a,l]=ORDER_MAP.get(o)||ORDER_MAP.get(ASC);return[...t].sort((u,c)=>u[0]<c[0]?a:l).map(u=>u[1])}return{addItem:n,getItems:s}}const DEFAULT_ERROR_ID_EXISTS=r=>`The id '${r}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;r=isFunction$1(r)?r:DEFAULT_ERROR_ID_EXISTS;function t(c,h){if(u(c))throw new Error(r(c));e.set(c,h)}function n(c){return e.delete(c)}function s(){e.clear()}function o(c){const[h]=l().find(g=>{let[v,m]=g;return c===m?v:!1})||[null];return h}function a(c){return e.get(c)}function l(){return[...e]}function u(c){return e.has(c)}return{addItem:t,clear:s,getId:o,getItem:a,getItems:l,hasItem:u,removeItem:n}}const DEFAULT_ERROR_ITEM_EXISTS=r=>`'${r}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;r=isFunction$1(r)?r:DEFAULT_ERROR_ITEM_EXISTS;function t(o){if(e.has(o))throw new Error(r(o));e.add(o)}function n(){return[...e]}function s(){e.clear()}return{addItem:t,clear:s,getItems:n}}const ERROR_PLUGIN_REGISTERED=r=>`There is already registered "${r}" plugin.`,ERROR_PRIORITY_REGISTERED=r=>`There is already registered plugin on priority "${r}".`,ERROR_PRIORITY_NAN=r=>`The priority "${r}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(r){const e=toUpperCaseFirst(r);return uniquePluginsList.getItem(e)}function hasPlugin(r){return!!getPlugin(r)}function registerPlugin(r,e,t){[r,e,t]=unifyPluginArguments(r,e,t),getPlugin(r)===void 0&&_registerPlugin(r,e,t)}function _registerPlugin(r,e,t){const n=toUpperCaseFirst(r);if(uniquePluginsList.hasItem(n))throw new Error(ERROR_PLUGIN_REGISTERED(n));t===void 0?uniquePluginsQueue.addItem(n):priorityPluginsQueue.addItem(t,n),uniquePluginsList.addItem(n,e)}function unifyPluginArguments(r,e,t){return typeof r=="function"&&(e=r,r=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[r,e,t]}function _classPrivateMethodInitSpec$P(r,e){_checkPrivateRedeclaration$18(r,e),e.add(r)}function _classPrivateFieldInitSpec$R(r,e,t){_checkPrivateRedeclaration$18(r,e),e.set(r,t)}function _checkPrivateRedeclaration$18(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1P(r,e,t){return(e=_toPropertyKey$1Q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1Q(r){var e=_toPrimitive$1Q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1Q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$R(r,e){return r.get(_assertClassBrand$18(r,e))}function _assertClassBrand$18(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),defaultMainSettingSymbol=Symbol("mainSetting"),PLUGIN_KEY$y="base",missingDepsMsgs=[];let initializedPlugins=null;var _hooks=new WeakMap,_BasePlugin_brand=new WeakSet;class BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$y}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){_classPrivateMethodInitSpec$P(this,_BasePlugin_brand),_defineProperty$1P(this,"eventManager",new EventManager(this)),_defineProperty$1P(this,"pluginName",null),_defineProperty$1P(this,"pluginsInitializedCallbacks",[]),_defineProperty$1P(this,"isPluginsReady",!1),_defineProperty$1P(this,"enabled",!1),_defineProperty$1P(this,"initialized",!1),_classPrivateFieldInitSpec$R(this,_hooks,{}),defineGetter(this,"hot",e,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const s=[];if(t.forEach(o=>{const[a,l]=o.split(":");if(!DEPS_TYPE_CHECKERS.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);DEPS_TYPE_CHECKERS.get(a)(l)||s.push(` - ${l} (${a})`)}),s.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");missingDepsMsgs.push(o)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf("UndoRedo")>=0&&initializedPlugins.splice(initializedPlugins.indexOf("UndoRedo"),1),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const s=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw missingDepsMsgs.length=0,new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return t;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(t)||isObject$1(t))&&n[defaultMainSettingSymbol]===e){var s;return Array.isArray(t)?t:(s=t[e])!==null&&s!==void 0?s:n[e]}if(isObject$1(t)){var o;return(o=t[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,t,n){_classPrivateFieldGet$R(_hooks,this)[e]=_classPrivateFieldGet$R(_hooks,this)[e]||[];const s=_classPrivateFieldGet$R(_hooks,this)[e];this.hot.addHook(e,t,n),s.push(t),_classPrivateFieldGet$R(_hooks,this)[e]=s}removeHooks(e){arrayEach(_classPrivateFieldGet$R(_hooks,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=_classPrivateFieldGet$R(_hooks,this);objectEach(e,(t,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){arrayEach(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=_assertClassBrand$18(_BasePlugin_brand,this,_isRelevantToSettings).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),objectEach(this,(t,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function _isRelevantToSettings(r){if(!r)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(r[e[t]]!==void 0)return!0;return!1}function _defineProperty$1O(r,e,t){return(e=_toPropertyKey$1P(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1P(r){var e=_toPrimitive$1P(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1P(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}let GhostTable$1=class{constructor(e){_defineProperty$1O(this,"hot",null),_defineProperty$1O(this,"container",null),_defineProperty$1O(this,"injected",!1),_defineProperty$1O(this,"rows",[]),_defineProperty$1O(this,"columns",[]),_defineProperty$1O(this,"samples",null),_defineProperty$1O(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),arrayEach(this.rows,t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),arrayEach(this.columns,t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{arrayEach(n.strings,s=>{t.appendChild(this.createColElement(s.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),n.appendChild(s)),this.samples.forEach(o=>{arrayEach(o.strings,a=>{const l=a.col,u=this.hot.getCellMeta(e,l),c=this.hot.getCellRenderer(u),h=t.createElement("td");h.setAttribute("ghost-table",1),c(this.hot,h,e,l,this.hot.colToProp(l),a.value,u),n.appendChild(h)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");n.push([-1,s]),t.appendChild(s)}this.samples.forEach(s=>{arrayEach(s.strings,o=>{const a=o.col,l=e.createElement("th");n.push([a,l]),t.appendChild(l)})}),this.table.tHead.appendChild(t),arrayEach(n,s=>{const[o,a]=s;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach(s=>{arrayEach(s.strings,o=>{const a=o.row,l=this.hot.getCellMeta(a,e),u=this.hot.getCellRenderer(l),c=t.createElement("td"),h=t.createElement("tr");c.setAttribute("ghost-table",1),u(this.hot,c,a,e,this.hot.colToProp(e),o.value,l),h.appendChild(c),n.appendChild(h)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let s=0;t>=0&&e>=0&&(s=this.hot.getCellMeta(t,e).colspan);let o=this.hot.getColWidth(e);if(s>1)for(let a=e+1;a<e+s;a++)o+=this.hot.getColWidth(a);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("table"),o=t.createElement("thead"),a=t.createElement("tbody"),l=t.createElement("colgroup"),u=t.createElement("tr"),c=t.createElement("th");return this.isVertical()&&s.appendChild(l),this.isHorizontal()&&(u.appendChild(c),o.appendChild(u),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(o),this.isVertical()&&a.appendChild(u),s.appendChild(a),addClass$1(s,e),n.appendChild(s),{fragment:n,table:s,tHead:o,tBody:a,colGroup:l,tr:u,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),s=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return addClass$1(s,o),n.appendChild(s),{fragment:n,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function _defineProperty$1N(r,e,t){return(e=_toPropertyKey$1O(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1O(r){var e=_toPrimitive$1O(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1O(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(e){_defineProperty$1N(this,"samples",null),_defineProperty$1N(this,"dataFactory",null),_defineProperty$1N(this,"customSampleCount",null),_defineProperty$1N(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const s=new Map,{from:o,to:a}=typeof n=="number"?{from:n,to:n}:n;return rangeEach(o,a,l=>{const u=this.generateSample(e,t,l);s.set(l,u)}),s}generateSample(e,t,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,o=e==="row"?"col":"row",a=[];return rangeEach(t.from,t.to,l=>{const u=e==="row"?this.dataFactory(n,l):this.dataFactory(l,n);if(u===!1)return;const{value:c,bundleSeed:h}=u,g=typeof h=="string"&&h.length>0;let v;g?v=h:isObject$1(c)?v=`${Object.keys(c).length}`:Array.isArray(c)?v=`${c.length}`:v=`${stringify$1(c).length}`,s.has(v)||s.set(v,{needed:this.getSampleCount(),strings:[]});const m=s.get(v);m.needed&&(!(a.indexOf(c)>-1)||this.allowDuplicates||g)&&(m.strings.push({value:c,[o]:l}),a.push(c),m.needed-=1)}),s}}var es_array_at={},hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireToIntegerOrInfinity(),s=requireAddToUnscopables();return r({target:"Array",proto:!0},{at:function(a){var l=e(this),u=t(l),c=n(a),h=c>=0?c:u+c;return h<0||h>=u?void 0:l[h]}}),s("at"),es_array_at}requireEs_array_at();var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var r=require_export(),e=requireFunctionUncurryThis(),t=requireRequireObjectCoercible(),n=requireToIntegerOrInfinity(),s=requireToString(),o=requireFails(),a=e("".charAt),l=o(function(){return"".at(-2)!=="\uD842"});return r({target:"String",proto:!0,forced:l},{at:function(c){var h=s(t(this)),g=h.length,v=n(c),m=v>=0?v:g+v;return m<0||m>=g?void 0:a(h,m)}}),es_string_atAlternative}requireEs_string_atAlternative();function _defineProperty$1M(r,e,t){return(e=_toPropertyKey$1N(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1N(r){var e=_toPrimitive$1N(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1N(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class FullyVisibleColumnsCalculationType{constructor(){_defineProperty$1M(this,"count",0),_defineProperty$1M(this,"startColumn",null),_defineProperty$1M(this,"endColumn",null),_defineProperty$1M(this,"startPosition",null),_defineProperty$1M(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:o,columnWidth:a}=t,l=s>0?o+1:o;n>=s&&n+a<=s+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:l,needReverse:u,startPositions:c,columnWidth:h}=e;if(this.endColumn===l-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const E=c[this.endColumn]+h-c[this.startColumn-1];if(E<=s&&(this.startColumn-=1),E>=s)break}this.startPosition=(t=c[this.startColumn])!==null&&t!==void 0?t:null;const g=a>0?s+1:s,v=n+s-g,m=this.startColumn===null?0:e.getColumnWidth(this.startColumn);v<-1*o||n>c.at(-1)||-1*n-s>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1L(r,e,t){return(e=_toPropertyKey$1M(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1M(r){var e=_toPrimitive$1M(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1M(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class FullyVisibleRowsCalculationType{constructor(){_defineProperty$1L(this,"count",0),_defineProperty$1L(this,"startRow",null),_defineProperty$1L(this,"endRow",null),_defineProperty$1L(this,"startPosition",null),_defineProperty$1L(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:o,rowHeight:a}=t;n>=s&&n+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:o,totalRows:a,needReverse:l,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const v=u[this.endRow]+c-u[this.startRow-1];if(v<=s-o&&(this.startRow-=1),v>=s-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null;const h=n+s-o,g=this.startRow===null?0:e.getRowHeight(this.startRow);h<g||n>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1K(r,e,t){return(e=_toPropertyKey$1L(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1L(r){var e=_toPrimitive$1L(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1L(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class PartiallyVisibleColumnsCalculationType{constructor(){_defineProperty$1K(this,"count",0),_defineProperty$1K(this,"startColumn",null),_defineProperty$1K(this,"endColumn",null),_defineProperty$1K(this,"startPosition",null),_defineProperty$1K(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:o}=t;n<=s&&(this.startColumn=e);const a=s>0?o+1:o;n>=s&&n<=s+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:l,needReverse:u,startPositions:c,columnWidth:h}=e;if(this.endColumn===l-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=c[this.endColumn]+h-c[this.startColumn-1];if(this.startColumn-=1,m>s)break}this.startPosition=(t=c[this.startColumn])!==null&&t!==void 0?t:null;const g=a>0?s+1:s;n+s-g<-1*o||n>c.at(-1)+h||-1*n-s>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1J(r,e,t){return(e=_toPropertyKey$1K(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1K(r){var e=_toPrimitive$1K(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1K(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class PartiallyVisibleRowsCalculationType{constructor(){_defineProperty$1J(this,"count",0),_defineProperty$1J(this,"startRow",null),_defineProperty$1J(this,"endRow",null),_defineProperty$1J(this,"startPosition",null),_defineProperty$1J(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:o}=t;n<=s&&(this.startRow=e),n>=s&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:o,totalRows:a,needReverse:l,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const g=u[this.endRow]+c-u[this.startRow-1];if(this.startRow-=1,g>=s-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null,n+s-o<0||n>u.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1I(r,e,t){return(e=_toPropertyKey$1J(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1J(r){var e=_toPrimitive$1J(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1J(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedAllColumnsCalculationType{constructor(){_defineProperty$1I(this,"count",0),_defineProperty$1I(this,"startColumn",0),_defineProperty$1I(this,"endColumn",0),_defineProperty$1I(this,"startPosition",0),_defineProperty$1I(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function _defineProperty$1H(r,e,t){return(e=_toPropertyKey$1I(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1I(r){var e=_toPrimitive$1I(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1I(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedAllRowsCalculationType{constructor(){_defineProperty$1H(this,"count",0),_defineProperty$1H(this,"startRow",0),_defineProperty$1H(this,"endRow",0),_defineProperty$1H(this,"startPosition",0),_defineProperty$1H(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function _defineProperty$1G(r,e,t){return(e=_toPropertyKey$1H(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1H(r){var e=_toPrimitive$1H(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1H(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{constructor(){super(...arguments),_defineProperty$1G(this,"columnStartOffset",0),_defineProperty$1G(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:s,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const a=this.startColumn,l=this.endColumn;n(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-l}this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=o[this.startColumn])!==null&&t!==void 0?t:null,s<this.endColumn&&(this.endColumn=s-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$1F(r,e,t){return(e=_toPropertyKey$1G(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1G(r){var e=_toPrimitive$1G(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1G(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{constructor(){super(...arguments),_defineProperty$1F(this,"rowStartOffset",0),_defineProperty$1F(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:s,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const a=this.startRow,l=this.endRow;n(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-l}this.startRow<0&&(this.startRow=0),this.startPosition=(t=o[this.startRow])!==null&&t!==void 0?t:null,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$1E(r,e,t){return(e=_toPropertyKey$1F(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1F(r){var e=_toPrimitive$1F(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1F(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewportBaseCalculator{constructor(e){_defineProperty$1E(this,"calculationTypes",[]),_defineProperty$1E(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[n,s]=t;this.calculationResults.set(n,s),s.initialize(e)})}_process(e,t){this.calculationTypes.forEach(n=>{let[,s]=n;return s.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,n]=t;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function _defineProperty$1D(r,e,t){return(e=_toPropertyKey$1E(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1E(r){var e=_toPrimitive$1E(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1E(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const DEFAULT_WIDTH=50;class ViewportColumnsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:s,totalColumns:o,columnWidthFn:a,overrideFn:l,inlineStartOffset:u}=e;super(t),_defineProperty$1D(this,"viewportWidth",0),_defineProperty$1D(this,"scrollOffset",0),_defineProperty$1D(this,"zeroBasedScrollOffset",0),_defineProperty$1D(this,"totalColumns",0),_defineProperty$1D(this,"columnWidthFn",null),_defineProperty$1D(this,"columnWidth",0),_defineProperty$1D(this,"overrideFn",null),_defineProperty$1D(this,"inlineStartOffset",0),_defineProperty$1D(this,"totalCalculatedWidth",0),_defineProperty$1D(this,"startPositions",[]),_defineProperty$1D(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=l,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?DEFAULT_WIDTH:t}}function _defineProperty$1C(r,e,t){return(e=_toPropertyKey$1D(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1D(r){var e=_toPrimitive$1D(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1D(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewportRowsCalculator extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:s,totalRows:o,defaultRowHeight:a,rowHeightFn:l,overrideFn:u,horizontalScrollbarHeight:c}=e;super(t),_defineProperty$1C(this,"viewportHeight",0),_defineProperty$1C(this,"scrollOffset",0),_defineProperty$1C(this,"zeroBasedScrollOffset",0),_defineProperty$1C(this,"totalRows",0),_defineProperty$1C(this,"rowHeightFn",null),_defineProperty$1C(this,"rowHeight",0),_defineProperty$1C(this,"overrideFn",null),_defineProperty$1C(this,"horizontalScrollbarHeight",0),_defineProperty$1C(this,"innerViewportHeight",0),_defineProperty$1C(this,"totalCalculatedHeight",0),_defineProperty$1C(this,"startPositions",[]),_defineProperty$1C(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalRows=o,this.rowHeightFn=l,this.overrideFn=u,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function _classPrivateFieldInitSpec$Q(r,e,t){_checkPrivateRedeclaration$17(r,e),e.set(r,t)}function _checkPrivateRedeclaration$17(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1B(r,e,t){return(e=_toPropertyKey$1C(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1C(r){var e=_toPrimitive$1C(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1C(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$Q(r,e){return r.get(_assertClassBrand$17(r,e))}function _classPrivateFieldSet$O(r,e,t){return r.set(_assertClassBrand$17(r,e),t),t}function _assertClassBrand$17(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _isRtl$2=new WeakMap;class CellCoords{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty$1B(this,"row",null),_defineProperty$1B(this,"col",null),_classPrivateFieldInitSpec$Q(this,_isRtl$2,!1),_classPrivateFieldSet$O(_isRtl$2,this,n),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:s,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-s||this.row>=t||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet$Q(_isRtl$2,this)}isSouthEastOf(e){return this.row>=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(_classPrivateFieldGet$Q(_isRtl$2,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof CellCoords&&_classPrivateFieldSet$O(_isRtl$2,this,e.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet$Q(_isRtl$2,this))}toObject(){return{row:this.row,col:this.col}}}function _classPrivateFieldInitSpec$P(r,e,t){_checkPrivateRedeclaration$16(r,e),e.set(r,t)}function _checkPrivateRedeclaration$16(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1A(r,e,t){return(e=_toPropertyKey$1B(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1B(r){var e=_toPrimitive$1B(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1B(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$P(r,e){return r.get(_assertClassBrand$16(r,e))}function _classPrivateFieldSet$N(r,e,t){return r.set(_assertClassBrand$16(r,e),t),t}function _assertClassBrand$16(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _isRtl$1=new WeakMap;class CellRange{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty$1A(this,"highlight",null),_defineProperty$1A(this,"from",null),_defineProperty$1A(this,"to",null),_classPrivateFieldInitSpec$P(this,_isRtl$1,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),_classPrivateFieldSet$N(_isRtl$1,this,s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,s=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return s.row<=t&&o.row>=t&&s.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),o=this.getDirection(),a=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),u=Math.min(n.row,a.row),c=Math.min(n.col,a.col),h=Math.max(s.row,l.row),g=Math.max(s.col,l.col),v=this._createCellCoords(u,c),m=this._createCellCoords(h,g);return this.from=v,this.to=m,this.setDirection(o),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet$P(_isRtl$1,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof CellCoords))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return t.top===n.top&&s.push("top"),t.right===n.right&&s.push(_classPrivateFieldGet$P(_isRtl$1,this)?"left":"right"),t.bottom===n.bottom&&s.push("bottom"),t.left===n.left&&s.push(_classPrivateFieldGet$P(_isRtl$1,this)?"right":"left"),s}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)!(this.from.row===s&&this.from.col===o)&&!(this.to.row===s&&this.to.col===o)&&n.push(this._createCellCoords(s,o));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)e.row===s&&e.col===o?n.push(e):t.row===s&&t.col===o?n.push(t):n.push(this._createCellCoords(s,o));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let s=t.row;s<=n.row;s++)for(let o=t.col;o<=n.col;o++)if(e(s,o)===!1)return}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet$P(_isRtl$1,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new CellCoords(e,t,_classPrivateFieldGet$P(_isRtl$1,this))}}function _classPrivateFieldInitSpec$O(r,e,t){_checkPrivateRedeclaration$15(r,e),e.set(r,t)}function _checkPrivateRedeclaration$15(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$O(r,e){return r.get(_assertClassBrand$15(r,e))}function _classPrivateFieldSet$M(r,e,t){return r.set(_assertClassBrand$15(r,e),t),t}function _assertClassBrand$15(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap;let Event$1=class{constructor(e,t,n,s,o,a){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec$O(this,_wtSettings,void 0),_classPrivateFieldInitSpec$O(this,_domBindings,void 0),_classPrivateFieldInitSpec$O(this,_wtTable,void 0),_classPrivateFieldInitSpec$O(this,_selectionManager,void 0),_classPrivateFieldInitSpec$O(this,_parent,void 0),_classPrivateFieldInitSpec$O(this,_eventManager,void 0),_classPrivateFieldInitSpec$O(this,_facadeGetter,void 0),_classPrivateFieldInitSpec$O(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec$O(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec$O(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet$M(_wtSettings,this,n),_classPrivateFieldSet$M(_domBindings,this,t),_classPrivateFieldSet$M(_wtTable,this,o),_classPrivateFieldSet$M(_selectionManager,this,a),_classPrivateFieldSet$M(_parent,this,l),_classPrivateFieldSet$M(_eventManager,this,s),_classPrivateFieldSet$M(_facadeGetter,this,e),this.registerEvents()}registerEvents(){_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"contextmenu",n=>this.onContextMenu(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).TABLE,"mouseover",n=>this.onMouseOver(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"touchstart",n=>this.onTouchStart(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet$O(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet$O(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"mouseup",n=>this.onMouseUp(n)),_classPrivateFieldGet$O(_eventManager,this).addEventListener(_classPrivateFieldGet$O(_wtTable,this).holder,"mousedown",n=>this.onMouseDown(n))};isMobileBrowser()?e():(isTouchSupported()&&e(),t())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this)&&n){const[s,o]=[n.row,_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this).from.row],[a,l]=[n.col,_classPrivateFieldGet$O(_selectedCellBeforeTouchEnd,this).from.col];return s===o&&a===l}return!1}parentCell(e){const t={},n=_classPrivateFieldGet$O(_wtTable,this).TABLE,s=closestDown(e,["TD","TH"],n);return s?(t.coords=_classPrivateFieldGet$O(_wtTable,this).getCoords(s),t.TD=s):hasClass$1(e,"wtBorder")&&hasClass$1(e,"current")?(t.coords=_classPrivateFieldGet$O(_selectionManager,this).getFocusSelection().cellRange.highlight,t.TD=_classPrivateFieldGet$O(_wtTable,this).getCell(t.coords)):hasClass$1(e,"wtBorder")&&hasClass$1(e,"area")&&_classPrivateFieldGet$O(_selectionManager,this).getAreaSelection().cellRange&&(t.coords=_classPrivateFieldGet$O(_selectionManager,this).getAreaSelection().cellRange.to,t.TD=_classPrivateFieldGet$O(_wtTable,this).getCell(t.coords)),t}onMouseDown(e){const t=_classPrivateFieldGet$O(_domBindings,this).rootDocument.activeElement,n=partial(getParent,e.target),s=e.target;if(!["TD","TH"].includes(t.nodeName)&&(s===t||n(0)===t||n(1)===t))return;const o=this.parentCell(s);hasClass$1(s,"corner")?_classPrivateFieldGet$O(_wtSettings,this).getSetting("onCellCornerMouseDown",e,s):o.TD&&_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=o.TD,clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[0]),_classPrivateFieldGet$O(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(e){if(_classPrivateFieldGet$O(_wtSettings,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseOver"))return;const t=_classPrivateFieldGet$O(_wtTable,this).TABLE,n=closestDown(e.target,["TD","TH"],t),s=_classPrivateFieldGet$O(_parent,this)||this;n&&n!==s.lastMouseOver&&isChildOf(n,t)&&(s.lastMouseOver=n,this.callListener("onCellMouseOver",e,_classPrivateFieldGet$O(_wtTable,this).getCoords(n),n))}onMouseOut(e){if(!_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseOut"))return;const t=_classPrivateFieldGet$O(_wtTable,this).TABLE,n=closestDown(e.target,["TD","TH"],t),s=closestDown(e.relatedTarget,["TD","TH"],t),o=_classPrivateFieldGet$O(_parent,this)||this;n&&n!==s&&isChildOf(n,t)&&(this.callListener("onCellMouseOut",e,_classPrivateFieldGet$O(_wtTable,this).getCoords(n),n),s===null&&(o.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&_classPrivateFieldGet$O(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[0]&&t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[1]?(hasClass$1(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),_classPrivateFieldGet$O(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=null):t.TD===_classPrivateFieldGet$O(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=t.TD,clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[1]),_classPrivateFieldGet$O(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet$O(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(e){_classPrivateFieldSet$M(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet$O(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,s=(t=this.parentCell(n))===null||t===void 0?void 0:t.coords,o=isDefined(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&o&&_classPrivateFieldGet$O(_wtSettings,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(n)&&!l.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,s){const o=_classPrivateFieldGet$O(_wtSettings,this).getSettingPure(e);o&&o(t,n,s,_classPrivateFieldGet$O(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet$O(_dblClickTimeout,this)[1]),_classPrivateFieldGet$O(_eventManager,this).destroy()}};function _defineProperty$1z(r,e,t){return(e=_toPropertyKey$1A(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1A(r){var e=_toPrimitive$1A(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1A(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ColumnFilter{constructor(e,t,n){_defineProperty$1z(this,"offset",void 0),_defineProperty$1z(this,"total",void 0),_defineProperty$1z(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _defineProperty$1y(r,e,t){return(e=_toPropertyKey$1z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1z(r){var e=_toPrimitive$1z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowFilter{constructor(e,t,n){_defineProperty$1y(this,"offset",void 0),_defineProperty$1y(this,"total",void 0),_defineProperty$1y(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _defineProperty$1x(r,e,t){return(e=_toPropertyKey$1y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1y(r){var e=_toPrimitive$1y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewSize{constructor(){_defineProperty$1x(this,"currentSize",0),_defineProperty$1x(this,"nextSize",0),_defineProperty$1x(this,"currentOffset",0),_defineProperty$1x(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function _defineProperty$1w(r,e,t){return(e=_toPropertyKey$1x(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1x(r){var e=_toPrimitive$1x(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1x(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ViewSizeSet{constructor(){_defineProperty$1w(this,"size",new ViewSize),_defineProperty$1w(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty$1w(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ViewSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}function _defineProperty$1v(r,e,t){return(e=_toPropertyKey$1w(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1w(r){var e=_toPrimitive$1w(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1w(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class OrderView{constructor(e,t,n){_defineProperty$1v(this,"rootNode",void 0),_defineProperty$1v(this,"nodesPool",void 0),_defineProperty$1v(this,"sizeSet",new ViewSizeSet),_defineProperty$1v(this,"childNodeType",void 0),_defineProperty$1v(this,"visualIndex",0),_defineProperty$1v(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(WORKING_SPACE_TOP))break;s=s.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:s}=t.getViewSize();let o=this.getRenderedChildCount();for(;o<s;){const l=this.nodesPool();!n||n&&t.isPlaceOn(WORKING_SPACE_BOTTOM)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}const a=n&&t.isPlaceOn(WORKING_SPACE_TOP);for(;o>s;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(WORKING_SPACE_BOTTOM)&&(n+=t.sharedSize.nextSize);let s=e.childNodes[n];if(s.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,s),s=o}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class SharedOrderView extends OrderView{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function _defineProperty$1u(r,e,t){return(e=_toPropertyKey$1v(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1v(r){var e=_toPrimitive$1v(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1v(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class NodesPool{constructor(e){_defineProperty$1u(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function _defineProperty$1t(r,e,t){return(e=_toPropertyKey$1u(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1u(r){var e=_toPrimitive$1u(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1u(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseRenderer{constructor(e,t){_defineProperty$1t(this,"nodesPool",null),_defineProperty$1t(this,"nodeType",void 0),_defineProperty$1t(this,"rootNode",void 0),_defineProperty$1t(this,"table",null),_defineProperty$1t(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new NodesPool(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function _defineProperty$1s(r,e,t){return(e=_toPropertyKey$1t(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1t(r){var e=_toPrimitive$1t(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1t(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),_defineProperty$1s(this,"orderViews",new WeakMap),_defineProperty$1s(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:s,cells:o}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=s.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=o.obtainOrderView(u);c.appendView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<n;g++){c.render();const v=c.getCurrentNode();v.className="",v.removeAttribute("style"),removeAttribute(v,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(v,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(g+1),A11Y_TABINDEX(-1)]),t[g](l,v,g)}c.end()}}}class ColumnHeadersRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,o=s+t;for(let l=0,u=e;l<u;l++){for(n=this.rootNode.childNodes[l],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let l=e;l<a;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&empty$1(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:n,columnsToRender:s,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&setAttribute(a,[A11Y_ROW(),A11Y_ROWINDEX(t+1)]);for(let l=-1*o;l<s;l+=1){const u=this.table.renderedColumnToSource(l),c=a.childNodes[l+o];c.className="",c.removeAttribute("style"),removeAttribute(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(c,[A11Y_COLINDEX(l+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...l>=0?[A11Y_SCOPE_COL()]:[A11Y_ROW()]]),n[t](u,c,t)}}}}let performanceWarningAppeared$1=!1;class ColGroupRenderer extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!performanceWarningAppeared$1&&e>1e3&&(performanceWarningAppeared$1=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let s=0;s<t;s++){const o=this.table.renderedColumnToSource(s),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[s].style.width=`${a}px`}for(let s=0;s<e;s++){const o=this.table.renderedColumnToSource(s),a=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[s+t].style.width=`${a}px`}const n=this.rootNode.firstChild;n&&addClass$1(n,"rowHeader")}}function _defineProperty$1r(r,e,t){return(e=_toPropertyKey$1s(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1s(r){var e=_toPrimitive$1s(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1s(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let performanceWarningAppeared=!1;class RowsRenderer extends BaseRenderer{constructor(e){super("TR",e),_defineProperty$1r(this,"orderView",void 0),this.orderView=new OrderView(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let s=0;s<e;s++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(s);if(this.table.isAriaEnabled()){var t,n;setAttribute(o,[A11Y_ROW(),A11Y_ROWINDEX(a+((t=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}removeClass$1(o,[ROW_CLASSNAMES.rowEven,ROW_CLASSNAMES.rowOdd]),(a+1)%2===0?addClass$1(o,ROW_CLASSNAMES.rowEven):addClass$1(o,ROW_CLASSNAMES.rowOdd)}this.orderView.end()}}function _defineProperty$1q(r,e,t){return(e=_toPropertyKey$1r(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1r(r){var e=_toPrimitive$1r(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1r(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CellsRenderer extends BaseRenderer{constructor(){super("TD"),_defineProperty$1q(this,"orderViews",new WeakMap),_defineProperty$1q(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:s}=this.table;for(let l=0;l<e;l++){const u=this.table.renderedRowToSource(l),c=n.getRenderedNode(l);this.sourceRowIndex=u;const h=this.obtainOrderView(c),g=s.obtainOrderView(c);h.prependView(g).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let v=0;v<t;v++){h.render();const m=h.getCurrentNode(),E=this.table.renderedColumnToSource(v);if(hasClass$1(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),removeAttribute(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,E,m),this.table.isAriaEnabled()){var o,a;setAttribute(m,[...m.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(E+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}h.end()}}}function _defineProperty$1p(r,e,t){return(e=_toPropertyKey$1q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1q(r){var e=_toPrimitive$1q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TableRenderer{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty$1p(this,"rootNode",void 0),_defineProperty$1p(this,"rootDocument",void 0),_defineProperty$1p(this,"rowHeaders",null),_defineProperty$1p(this,"columnHeaders",null),_defineProperty$1p(this,"colGroup",null),_defineProperty$1p(this,"rows",null),_defineProperty$1p(this,"cells",null),_defineProperty$1p(this,"rowFilter",null),_defineProperty$1p(this,"columnFilter",null),_defineProperty$1p(this,"rowUtils",null),_defineProperty$1p(this,"columnUtils",null),_defineProperty$1p(this,"rowsToRender",0),_defineProperty$1p(this,"columnsToRender",0),_defineProperty$1p(this,"rowHeaderFunctions",[]),_defineProperty$1p(this,"rowHeadersCount",0),_defineProperty$1p(this,"columnHeaderFunctions",[]),_defineProperty$1p(this,"columnHeadersCount",0),_defineProperty$1p(this,"cellRenderer",void 0),_defineProperty$1p(this,"activeOverlayName",void 0),_defineProperty$1p(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:s,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),s.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=s,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const s=t.getRenderedNode(n),o=this.rowUtils;if(s.firstChild){const a=this.renderedRowToSource(n),l=o.getHeightByOverlayName(a,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;l?s.firstChild.style.height=`${l-c}px`:s.firstChild.style.height=""}}}}class Renderer{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:s,rowUtils:o,columnUtils:a,cellRenderer:l,stylesHandler:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(e,{cellRenderer:l,stylesHandler:u}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(t),colGroup:new ColGroupRenderer(n),rows:new RowsRenderer(s),cells:new CellsRenderer}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _defineProperty$1o(r,e,t){return(e=_toPropertyKey$1p(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1p(r){var e=_toPrimitive$1p(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1p(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ColumnUtils{constructor(e,t){_defineProperty$1o(this,"dataAccessObject",void 0),_defineProperty$1o(this,"wtSettings",void 0),_defineProperty$1o(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const n=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let a=Array.isArray(t)?t[o]:t;a=a??s,this.headerWidths.set(o,a)}}}}function _defineProperty$1n(r,e,t){return(e=_toPropertyKey$1o(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1o(r){var e=_toPrimitive$1o(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1o(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowUtils{constructor(e,t){_defineProperty$1n(this,"dataAccessObject",void 0),_defineProperty$1n(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(t=t===void 0?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(n=n===void 0?s:Math.max(n,s)),n}}function _defineProperty$1m(r,e,t){return(e=_toPropertyKey$1n(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1n(r){var e=_toPrimitive$1n(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1n(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Table{constructor(e,t,n,s,o){_defineProperty$1m(this,"wtSettings",null),_defineProperty$1m(this,"domBindings",void 0),_defineProperty$1m(this,"TBODY",null),_defineProperty$1m(this,"THEAD",null),_defineProperty$1m(this,"COLGROUP",null),_defineProperty$1m(this,"hasTableHeight",!0),_defineProperty$1m(this,"hasTableWidth",!0),_defineProperty$1m(this,"isTableVisible",!1),_defineProperty$1m(this,"tableOffset",0),_defineProperty$1m(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}createHider(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}createHolder(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(n.parentNode,[A11Y_PRESENTATION()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(n,[A11Y_PRESENTATION()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:n,wtViewport:s}=this.dataAccessObject,o=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),u=l.length,c=t.getSetting("columnHeaders"),h=c.length;let g=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=offset(this.holder),g=s.createCalculators(g),u&&!t.getSetting("fixedColumnsStart"))){const m=n.inlineStartOverlay.getScrollPosition(),E=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,E!==this.correctHeaderWidth&&(g=!1)}if(g)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=o>0?this.getFirstRenderedRow():0,E=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new RowFilter(m,o,h),this.columnFilter=new ColumnFilter(E,a,u);let _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const S={};this.wtSettings.getSetting("beforeDraw",!0,S),_=S.skipRender!==!0}_&&(this.tableRenderer.setHeaderContentRenderers(l,c),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||s.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let v=!1;return this.isMaster&&(v=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(v=n.bottomOverlay.resetFixedPosition()||v),v=n.inlineStartOverlay.resetFixedPosition()||v,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),v?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(g),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const s=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,a,l;const u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),a=this.getColumnHeader(t,n),a&&(l=innerHeight(a),(!o&&s<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),Array.isArray(u)?u[n]!==null&&u[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(u[n]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]||u))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let o=0,a=s.length;o<a;o++)if(n[o]){if(!t[o]||t[o].childNodes.length===0)return;t[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let s=0;s<n;s++){const o=this.rowFilter.renderedToSource(s);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}}getCell(e){let t=e.row,n=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(s&&Array.isArray(s)&&([t,n]=s),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,n=null;if(e<0){var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return t!==void 0&&n!==void 0?n.childNodes.length<t+1?!1:n.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[t];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const o=s.childNodes[n];o&&t.push(o)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(t>=n)return;const s=this.rowFilter.sourceToRendered(e),o=s<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):s,l=(s<0?this.THEAD:this.TBODY).childNodes[o];return l==null?void 0:l.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<n;s++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o==null?void 0:o.childNodes[s];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=closest(t,["TD","TH"])),t===null)return null;const n=t.parentNode,s=n.parentNode;let o=index(n),a=t.cellIndex;overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_TOP,t,this.wtRootElement)?s.nodeName==="THEAD"&&(o-=s.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-s.childNodes.length+o:s===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a);const l=this.wtSettings.getSetting("onModifyGetCoordsElement",o,a);return l&&Array.isArray(l)&&([o,a]=l),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=innerHeight(this.TBODY)-1,s=this.wot.stylesHandler.areCellsBorderBox(),o=s?outerHeight:innerHeight,a=s?0:1,l=s?1:0;let u,c,h,g,v;if(!(t===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),g=this.getTrForRow(h),v=g.querySelector("th");const m=h===0?l:0;v?c=o(v):c=o(g)-a,(!u&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<c-m||u<c)&&(s||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const e=outerWidth(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=outerHeight(this.hider);return e!==0?e:this.getHeight()}isVisible(){return isVisible(this.TABLE)}_modifyRowHeaderWidth(e){let t=isFunction$1(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const MIXIN_NAME$5="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const r=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=r-e;return r===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});const MIXIN_NAME$4="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const r=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});class BottomInlineStartCornerOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_BOTTOM_INLINE_START_CORNER)}}mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom);mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart);const CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]);function _classPrivateMethodInitSpec$O(r,e){_checkPrivateRedeclaration$14(r,e),e.add(r)}function _checkPrivateRedeclaration$14(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1l(r,e,t){return(e=_toPropertyKey$1m(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1m(r){var e=_toPrimitive$1m(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1m(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$14(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet;class Scroll{constructor(e){_classPrivateMethodInitSpec$O(this,_Scroll_brand),_defineProperty$1l(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const s=this.scrollViewportHorizontally(e.col,t),o=this.scrollViewportVertically(e.row,n);return s||o}scrollViewportHorizontally(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:s}=this.dataAccessObject;if(!n)return!1;const o=createObjectPropListener(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>s)return!1;t=o.value;const{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject,u=t==="auto";if(u&&e<a)return!1;const c=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let g=!1;return(u&&(e<c||e>h)||!u)&&(g=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleColumn():t==="end")),g}scrollViewportVertically(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:s}=this.dataAccessObject;if(!n)return!1;const o=createObjectPropListener(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>s)return!1;t=o.value;const{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject,c=t==="auto";if(c&&(e<l||e>s-a-1))return!1;const h=this.getFirstVisibleRow(),g=this.getLastVisibleRow();let v=!1;return(c&&(e<h||e>g)||!c)&&(v=u.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():t==="bottom")),v}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand$14(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand$14(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand$14(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand$14(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function _getLastColumnIndex(r){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:s,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(t.mainTableScrollableElement===a){const l=e.getSetting("rtlMode");let u=null;if(l){const h=n.TABLE.getBoundingClientRect(),v=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-v)}else u=offset(n.wtRootElement).left;const c=Math.abs(getScrollLeft(a,a));if(u>c){const h=innerWidth(a);let g=s.getRowHeaderWidth();for(let v=1;v<=o;v++)if(g+=t.sumCellSizes(v-1,v),u+g-c>=h){r=v-2;break}}}return r}function _getLastRowIndex(r){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:s,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const a=offset(t.wtRootElement),l=getScrollTop(o,o);if(a.top>l){const u=innerHeight(o);let c=n.getColumnHeaderHeight();for(let h=1;h<=s;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){r=h-2;break}}}return r}function _defineProperty$1k(r,e,t){return(e=_toPropertyKey$1l(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1l(r){var e=_toPrimitive$1l(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1l(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CoreAbstract{get eventManager(){return new EventManager(this)}constructor(e,t){_defineProperty$1k(this,"wtTable",void 0),_defineProperty$1k(this,"wtScroll",void 0),_defineProperty$1k(this,"wtViewport",void 0),_defineProperty$1k(this,"wtOverlays",void 0),_defineProperty$1k(this,"selectionManager",void 0),_defineProperty$1k(this,"wtEvent",void 0),_defineProperty$1k(this,"guid",`wt_${randomString()}`),_defineProperty$1k(this,"drawInterrupted",!1),_defineProperty$1k(this,"drawn",!1),_defineProperty$1k(this,"activeOverlayName","master"),_defineProperty$1k(this,"domBindings",void 0),_defineProperty$1k(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Scroll(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){fastInnerText(n,e[t])}])}}createCellCoords(e,t){return new CellCoords(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new CellRange(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _defineProperty$1j(r,e,t){return(e=_toPropertyKey$1k(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1k(r){var e=_toPrimitive$1k(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1k(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Clone extends CoreAbstract{constructor(e,t,n){super(e,t),_defineProperty$1j(this,"cloneSource",void 0),_defineProperty$1j(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new Event$1(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function _defineProperty$1i(r,e,t){return(e=_toPropertyKey$1j(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1j(r){var e=_toPrimitive$1j(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1j(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Overlay{constructor(e,t,n,s,o){_defineProperty$1i(this,"wtSettings",null),defineGetter(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=s;const{TABLE:a,hider:l,spreader:u,holder:c,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=h,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE)}getRelativeCellPosition(e,t,n){if(this.clone.wtTable.holder.contains(e)===!1){warn$1(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let g=null;return s?g=this.getRelativeCellPositionWithinWindow(a,o,h,c):g=this.getRelativeCellPositionWithinHolder(a,l,o,h,c),g}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,s){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,l=0;if(!t)a=s.start;else{let u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+getScrollbarWidth())),a=u<=0?-1*u:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:l=s.top,{start:n.start+a,top:n.top+l}}getRelativeCellPositionWithinHolder(e,t,n,s,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,u=0;if(n||(l=a.horizontal-o.start),t){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(u=a.vertical-o.top);return{start:s.start-l,top:s.top-u}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,o=n.createElement("div"),a=n.createElement("table"),l=e.wtRootElement.parentNode;o.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&setAttribute(o,[A11Y_PRESENTATION()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),l.appendChild(o);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===CLONE_TOP||c==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=s:s.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE),new Clone(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,s=t.style,o=e.parentNode.style;[n,s,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BottomInlineStartCornerOverlay extends Overlay{constructor(e,t,n,s,o,a){super(e,t,CLONE_BOTTOM_INLINE_START_CORNER,n,s),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new BottomInlineStartCornerOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${o}px`,t.style.bottom=`${a}px`}else resetCssTransform(t),this.repositionOverlay();let n=outerHeight(this.clone.wtTable.TABLE);const s=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(n)),s.style.bottom=`${o}px`}}const MIXIN_NAME$3="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const r=this.dataAccessObject.startColumnRendered;return r===null?-1:r},getFirstVisibleColumn(){const r=this.dataAccessObject.startColumnVisible;return r===null?-1:r},getFirstPartiallyVisibleColumn(){const r=this.dataAccessObject.startColumnPartiallyVisible;return r===null?-1:r},getLastRenderedColumn(){const r=this.dataAccessObject.endColumnRendered;return r===null?-1:r},getLastVisibleColumn(){const r=this.dataAccessObject.endColumnVisible;return r===null?-1:r},getLastPartiallyVisibleColumn(){const r=this.dataAccessObject.endColumnPartiallyVisible;return r===null?-1:r},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});class BottomOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_BOTTOM)}}mixin(BottomOverlayTable,stickyRowsBottom);mixin(BottomOverlayTable,calculatedColumns);function _defineProperty$1h(r,e,t){return(e=_toPropertyKey$1i(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1i(r){var e=_toPrimitive$1i(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1i(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BottomOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_BOTTOM,n,s),_defineProperty$1h(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new BottomOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(n=this.getOverlayOffset(),t.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(n)),s.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(getWindowScrollLeft(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,stylesHandler:s}=this.wot,o=s.getDefaultRowHeight();let a=e,l=0;for(;a<t;){const u=n.getRowHeight(a);l+=u===void 0?o:u,a+=1}return l}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let c=t.getWorkspaceWidth();t.hasVerticalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;t&&o.offsetHeight!==o.clientHeight&&(a=getScrollbarWidth(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=a,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=s-o,l=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+s,0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,s=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||t===0)&&s.length>0){const a=this.wot.wtTable.holder.parentNode,l=hasClass$1(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(addClass$1(a,"innerBorderBottom"),o=!l):(removeClass$1(a,"innerBorderBottom"),o=l)}return o}}const MIXIN_NAME$2="calculatedRows",calculatedRows={getFirstRenderedRow(){const r=this.dataAccessObject.startRowRendered;return r===null?-1:r},getFirstVisibleRow(){const r=this.dataAccessObject.startRowVisible;return r===null?-1:r},getFirstPartiallyVisibleRow(){const r=this.dataAccessObject.startRowPartiallyVisible;return r===null?-1:r},getLastRenderedRow(){const r=this.dataAccessObject.endRowRendered;return r===null?-1:r},getLastVisibleRow(){const r=this.dataAccessObject.endRowVisible;return r===null?-1:r},getLastPartiallyVisibleRow(){const r=this.dataAccessObject.endRowPartiallyVisible;return r===null?-1:r},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});class InlineStartOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_INLINE_START)}}mixin(InlineStartOverlayTable,calculatedRows);mixin(InlineStartOverlayTable,stickyColumnsStart);const MIXIN_NAME$1="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(r,e){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(e),this},runLocalHooks(r,e,t,n,s,o,a){if(this._localHooks[r]){const l=this._localHooks[r].length;for(let u=0;u<l;u++)fastCall(this._localHooks[r][u],this,e,t,n,s,o,a)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});let Selection$1=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection$1,localHooks);const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",getCornerStyle=r=>{const e=r.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const t=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),s=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:t,height:t,borderWidth:n,borderStyle:"solid",borderColor:s})};var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var r=requireAddToUnscopables();return r("flat"),es_array_unscopables_flat}requireEs_array_unscopables_flat();function _classPrivateMethodInitSpec$N(r,e){_checkPrivateRedeclaration$13(r,e),e.add(r)}function _classPrivateFieldInitSpec$N(r,e,t){_checkPrivateRedeclaration$13(r,e),e.set(r,t)}function _checkPrivateRedeclaration$13(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$N(r,e){return r.get(_assertClassBrand$13(r,e))}function _classPrivateFieldSet$L(r,e,t){return r.set(_assertClassBrand$13(r,e),t),t}function _assertClassBrand$13(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot$1=new WeakMap,_SelectionScanner_brand=new WeakSet;class SelectionScanner{constructor(){_classPrivateMethodInitSpec$N(this,_SelectionScanner_brand),_classPrivateFieldInitSpec$N(this,_selection,void 0),_classPrivateFieldInitSpec$N(this,_activeOverlaysWot$1,void 0)}setActiveOverlay(e){return _classPrivateFieldSet$L(_activeOverlaysWot$1,this,e),this}setActiveSelection(e){return _classPrivateFieldSet$L(_selection,this,e),this}scan(){const e=_classPrivateFieldGet$N(_selection,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="area"?this.scanCellsRange(n=>t.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n)),this.scanCellsRange(n=>t.add(n))):e==="fill"?this.scanCellsRange(n=>t.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>t.add(n)),this.scanRowsInCellsRange(n=>t.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanColumnsInCellsRange(n=>t.add(n))),t}scanColumnsInHeadersRange(e){const[t,n,s,o]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),l=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount();let c=0;for(let h=-a.getRowHeadersCount();h<l;h++){const g=a.columnFilter.renderedToSource(h);if(!(g<n||g>o)){for(let v=-u;v<0;v++){if(v<t||v>s)continue;const m=v+u;let E=a.getColumnHeader(g,m);const _=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingColumnHeader",g,m,{selectionType:_classPrivateFieldGet$N(_selection,this).settings.selectionType,columnCursor:c,selectionWidth:o-n+1});_!==null&&(_!==g&&(E=a.getColumnHeader(_,m)),e(E))}c+=1}}}scanRowsInHeadersRange(e){const[t,n,s,o]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),l=a.getRenderedRowsCount(),u=a.getRowHeadersCount();let c=0;for(let h=-a.getColumnHeadersCount();h<l;h++){const g=a.rowFilter.renderedToSource(h);if(!(g<t||g>s)){for(let v=-u;v<0;v++){if(v<n||v>o)continue;const m=v+u;let E=a.getRowHeader(g,m);const _=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingRowHeader",g,m,{selectionType:_classPrivateFieldGet$N(_selection,this).settings.selectionType,rowCursor:c,selectionHeight:s-t+1});_!==null&&(_!==g&&(E=a.getRowHeader(_,m)),e(E))}c+=1}}}scanCellsRange(e){const{wtTable:t}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanCellsRange).call(this,(n,s)=>{const o=t.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(n,s)),a=_classPrivateFieldGet$N(_activeOverlaysWot$1,this).getSetting("onAfterDrawSelection",n,s,_classPrivateFieldGet$N(_selection,this).settings.layerLevel);typeof a=="string"&&addClass$1(o,a),e(o)})}scanRowsInCellsRange(e){const[t,,n]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:s}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanViewportRange).call(this,(o,a)=>{if(o>=t&&o<=n){const l=s.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(o,a));e(l)}})}scanColumnsInCellsRange(e){const[,t,,n]=_classPrivateFieldGet$N(_selection,this).getCorners(),{wtTable:s}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this);_assertClassBrand$13(_SelectionScanner_brand,this,_scanViewportRange).call(this,(o,a)=>{if(a>=t&&a<=n){const l=s.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(o,a));e(l)}})}}function _scanCellsRange(r){let[e,t,n,s]=_classPrivateFieldGet$N(_selection,this).getCorners();if(e<0&&n<0||t<0&&s<0)return;const{wtTable:o}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),a=e!==n||t!==s;if(t=Math.max(t,0),s=Math.max(s,0),e=Math.max(e,0),n=Math.max(n,0),a){if(t=Math.max(t,o.getFirstRenderedColumn()),s=Math.min(s,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),s<t||n<e)return}else if(!(o.getCell(_classPrivateFieldGet$N(_activeOverlaysWot$1,this).createCellCoords(e,t))instanceof HTMLElement))return;for(let l=e;l<=n;l+=1)for(let u=t;u<=s;u+=1)r(l,u)}function _scanViewportRange(r){const{wtTable:e}=_classPrivateFieldGet$N(_activeOverlaysWot$1,this),t=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let s=0;s<t;s+=1){const o=e.rowFilter.renderedToSource(s);for(let a=0;a<n;a+=1)r(o,e.columnFilter.renderedToSource(a))}}class Border{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=getCornerStyle(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const s=this.main.childNodes[t];this.eventManager.addEventListener(s,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),stopImmediatePropagation(e);const n=this,s=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none";function a(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){a(u)&&(n.eventManager.removeEventListener(s,"mousemove",l),t.style.display="block")}this.eventManager.addEventListener(s,"mousemove",l)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let l=0;l<5;l++){const u=n[l],c=t.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(c.className+=" hidden"),s=c.style,s.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,s.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,s.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};objectEach(s,(a,l)=>{this.selectionHandles.styles.bottomHitArea[l]=a,this.selectionHandles.styles.topHitArea[l]=a});const o={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};objectEach(o,(a,l)=>{this.selectionHandles.styles.bottom[l]=a,this.selectionHandles.styles.top[l]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,n,s,o,a){const u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:h,bottom:g,bottomHitArea:v}=this.selectionHandles.styles,m=parseInt(c.borderWidth,10),E=parseInt(c.width,10),_=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();c.top=`${parseInt(n-E-1,10)}px`,c[u]=`${parseInt(s-E-1,10)}px`,h.top=`${parseInt(n-_/4*3,10)}px`,h[u]=`${parseInt(s-_/4*3,10)}px`;const A=Math.min(parseInt(s+o,10),S-E-m*2),O=Math.min(parseInt(s+o-_/4,10),S-_-m*2);g[u]=`${A}px`,v[u]=`${O}px`;const D=Math.min(parseInt(n+a,10),w-E-m*2),Y=Math.min(parseInt(n+a-_/4,10),w-_-m*2);g.top=`${D}px`,v.top=`${Y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(e,t)?(g.display="none",v.display="none"):(g.display="block",v.display="block")):(c.display="none",g.display="none",h.display="none",v.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}appear(e){if(this.disabled)return;let[t,n,s,o]=e;if(t<0&&s<0||n<0&&o<0){this.disappear();return}const{wtTable:a,rootDocument:l,rootWindow:u}=this.wot,c=t!==s||n!==o,h=a.getFirstRenderedRow(),g=a.getLastRenderedRow(),v=a.getFirstRenderedColumn(),m=a.getLastRenderedColumn();let E;if(c){if(n=Math.max(n,v),o=Math.min(o,m),t=Math.max(t,h),s=Math.min(s,g),o<n||s<t){this.disappear();return}E=a.getCell(this.wot.createCellCoords(t,n))}else if(E=a.getCell(this.wot.createCellCoords(t,n)),!(E instanceof HTMLElement)){this.disappear();return}const _=c?a.getCell(this.wot.createCellCoords(s,o)):E,S=offset(E),w=c?offset(_):S,A=offset(a.TABLE),O=S.top,D=S.left,Y=this.wot.wtSettings.getSetting("rtlMode");let H=0,k=0;if(Y){const we=outerWidth(a.TABLE),Ne=outerWidth(E),at=u.innerWidth-A.left-we;k=D+Ne-w.left,H=u.innerWidth-D-Ne-at-1}else k=w.left+outerWidth(_)-D,H=D-A.left-1;if(this.isEntireColumnSelected(t,s)){const we=t,Ne=this.getDimensionsFromHeader("columns",n,o,we,A);let at=null;Ne&&([at,H,k]=Ne),at&&(E=at)}let K=O-A.top-1,se=w.top+outerHeight(_)-O;if(this.isEntireRowSelected(n,o)){const we=n,Ne=this.getDimensionsFromHeader("rows",t,s,we,A);let at=null;Ne&&([at,K,se]=Ne),at&&(E=at)}const re=u.getComputedStyle(E);parseInt(re.borderTopWidth,10)>0&&(K+=1,se=se>0?se-1:0),parseInt(re[Y?"borderRightWidth":"borderLeftWidth"],10)>0&&(H+=1,k=k>0?k-1:0);const Ce=Y?"right":"left";this.topStyle.top=`${K}px`,this.topStyle[Ce]=`${H}px`,this.topStyle.width=`${k}px`,this.topStyle.display="block",this.startStyle.top=`${K}px`,this.startStyle[Ce]=`${H}px`,this.startStyle.height=`${se}px`,this.startStyle.display="block";const Le=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${K+se-Le}px`,this.bottomStyle[Ce]=`${H}px`,this.bottomStyle.width=`${k}px`,this.bottomStyle.display="block",this.endStyle.top=`${K}px`,this.endStyle[Ce]=`${H+k-Le}px`,this.endStyle.height=`${se+1}px`,this.endStyle.display="block";let he=this.settings.border.cornerVisible;he=typeof he=="function"?he(this.settings.layerLevel):he;const ve=this.wot.getSetting("onModifyGetCellCoords",s,o,!1,"render");let[xe,Ie]=[s,o];if(ve&&Array.isArray(ve)&&([,,xe,Ie]=ve),isMobileBrowser()||!he||this.isPartRange(xe,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${K+se+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Ce]=`${H+k+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let we=getTrimmingContainer(a.TABLE);const Ne=we===u;Ne&&(we=l.documentElement);const at=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,nt=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),B=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const te=Ne?_.getBoundingClientRect().left:_.offsetLeft;let V=!1,ue=0;Y?(ue=te-parseInt(this.cornerDefaultStyle.width,10)/2,V=ue<0):(ue=te+outerWidth(_)+parseInt(this.cornerDefaultStyle.width,10)/2,V=ue>=innerWidth(we)),V&&(this.cornerStyle[Ce]=`${Math.floor(H+k+this.cornerCenterPointOffset-nt-at)}px`,this.cornerStyle[Y?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(Ne?_.getBoundingClientRect().top:_.offsetTop)+outerHeight(_)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight(we)&&(this.cornerStyle.top=`${Math.floor(K+se+this.cornerCenterPointOffset-B-at)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,o,K,H,k,se)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,s,o){const{wtTable:a}=this.wot,l=a.wtRootElement.parentNode;let u=null,c=null,h=null,g=null,v=null,m=null,E=null,_=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},c=function(){return outerHeight(...arguments)},h="ht__selection--rows",m="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},c=function(){return outerWidth(...arguments)},h="ht__selection--columns",m="left";break}if(l.classList.contains(h)){const S=this.wot.getSetting("columnHeaders").length;if(E=u(t,S-s),_=u(n,S-s),!E||!_)return!1;const w=offset(E),A=offset(_);return E&&_&&(g=w[m]-o[m]-1,v=A[m]+c(_)-w[m]),[E,g,v]}return!1}changeBorderStyle(e,t){const n=this[e].style,s=t[e];!s||s.hide?addClass$1(this[e],"hidden"):(hasClass$1(this[e],"hidden")&&removeClass$1(this[e],"hidden"),n.backgroundColor=s.color,(e==="top"||e==="bottom")&&(n.height=`${s.width}px`),(e==="start"||e==="end")&&(n.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width=`${t.width}px`,n.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?addClass$1(this[e],"hidden"):removeClass$1(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _classPrivateMethodInitSpec$M(r,e){_checkPrivateRedeclaration$12(r,e),e.add(r)}function _classPrivateFieldInitSpec$M(r,e,t){_checkPrivateRedeclaration$12(r,e),e.set(r,t)}function _checkPrivateRedeclaration$12(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$M(r,e){return r.get(_assertClassBrand$12(r,e))}function _classPrivateFieldSet$K(r,e,t){return r.set(_assertClassBrand$12(r,e),t),t}function _assertClassBrand$12(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet;class SelectionManager{constructor(e){_classPrivateMethodInitSpec$M(this,_SelectionManager_brand),_classPrivateFieldInitSpec$M(this,_activeOverlaysWot,void 0),_classPrivateFieldInitSpec$M(this,_selections,void 0),_classPrivateFieldInitSpec$M(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec$M(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec$M(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec$M(this,_selectionBorders,new Map),_classPrivateFieldSet$K(_selections,this,e)}setActiveOverlay(e){return _classPrivateFieldSet$K(_activeOverlaysWot,this,e),_classPrivateFieldGet$M(_scanner,this).setActiveOverlay(_classPrivateFieldGet$M(_activeOverlaysWot,this)),_classPrivateFieldGet$M(_appliedClasses,this).has(_classPrivateFieldGet$M(_activeOverlaysWot,this))||_classPrivateFieldGet$M(_appliedClasses,this).set(_classPrivateFieldGet$M(_activeOverlaysWot,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet$M(_selections,this)!==null?_classPrivateFieldGet$M(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet$M(_selections,this)!==null?_classPrivateFieldGet$M(_selections,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_classPrivateFieldGet$M(_selectionBorders,this).has(e)){const n=_classPrivateFieldGet$M(_selectionBorders,this).get(e);if(n.has(_classPrivateFieldGet$M(_activeOverlaysWot,this)))return n.get(_classPrivateFieldGet$M(_activeOverlaysWot,this));const s=new Border(_classPrivateFieldGet$M(_activeOverlaysWot,this),e.settings);return n.set(_classPrivateFieldGet$M(_activeOverlaysWot,this),s),s}const t=new Border(_classPrivateFieldGet$M(_activeOverlaysWot,this),e.settings);return _classPrivateFieldGet$M(_selectionBorders,this).set(e,new Map([[_classPrivateFieldGet$M(_activeOverlaysWot,this),t]])),t}getBorderInstances(e){var t,n;return Array.from((t=(n=_classPrivateFieldGet$M(_selectionBorders,this).get(e))===null||n===void 0?void 0:n.values())!==null&&t!==void 0?t:[])}destroyBorders(e){_classPrivateFieldGet$M(_selectionBorders,this).get(e).forEach(t=>t.destroy()),_classPrivateFieldGet$M(_selectionBorders,this).delete(e)}render(e){if(_classPrivateFieldGet$M(_selections,this)===null)return;e&&_assertClassBrand$12(_SelectionManager_brand,this,_resetCells).call(this);const t=Array.from(_classPrivateFieldGet$M(_selections,this)),n=new Map,s=new Map;for(let o=0;o<t.length;o++){const a=t[o],{className:l,headerAttributes:u,createLayers:c,selectionType:h}=a.settings;_classPrivateFieldGet$M(_destroyListeners,this).has(a)||(_classPrivateFieldGet$M(_destroyListeners,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const g=this.getBorderInstance(a);if(a.isEmpty()){g==null||g.disappear();continue}l&&_classPrivateFieldGet$M(_scanner,this).setActiveSelection(a).scan().forEach(E=>{if(n.has(E)){const _=n.get(E);_.has(l)&&c===!0?_.set(l,_.get(l)+1):_.set(l,1)}else n.set(E,new Map([[l,1]]));u&&(s.has(E)||s.set(E,[]),E.nodeName==="TH"&&s.get(E).push(...u))});const v=a.getCorners();_classPrivateFieldGet$M(_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",v,h),g==null||g.appear(v)}n.forEach((o,a)=>{var l;const u=Array.from(o).map(c=>{let[h,g]=c;return g===1?h:[h,...Array.from({length:g-1},(v,m)=>`${h}-${m+1}`)]}).flat();u.forEach(c=>_classPrivateFieldGet$M(_appliedClasses,this).get(_classPrivateFieldGet$M(_activeOverlaysWot,this)).add(c)),addClass$1(a,u),a.nodeName==="TD"&&Array.isArray((l=_classPrivateFieldGet$M(_selections,this).options)===null||l===void 0?void 0:l.cellAttributes)&&setAttribute(a,_classPrivateFieldGet$M(_selections,this).options.cellAttributes)}),Array.from(s.keys()).forEach(o=>{setAttribute(o,[...s.get(o)])})}}function _resetCells(){const r=_classPrivateFieldGet$M(_appliedClasses,this).get(_classPrivateFieldGet$M(_activeOverlaysWot,this)),e=_classPrivateFieldGet$M(_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)r.add(e[t]);r.forEach(t=>{var n,s;const o=_classPrivateFieldGet$M(_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${t}`);let a=[];Array.isArray((n=_classPrivateFieldGet$M(_selections,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(a=_classPrivateFieldGet$M(_selections,this).options.cellAttributes.map(l=>l[0])),Array.isArray((s=_classPrivateFieldGet$M(_selections,this).options)===null||s===void 0?void 0:s.headerAttributes)&&(a=[...a,..._classPrivateFieldGet$M(_selections,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,u=o.length;l<u;l++)removeClass$1(o[l],t),removeAttribute(o[l],a)}),r.clear()}class InlineStartOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_INLINE_START,n,s)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new InlineStartOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===t&&(!s||s!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(n,`${o}px`,"0px")):(o=this.getScrollPosition(),resetCssTransform(n));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,getWindowScrollTop(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let s=e,o=0;for(;s<t;)o+=this.wot.wtTable.getColumnWidth(s)||n,s+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="vertical"){let c=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollHeight),a.height=`${c}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const u=outerWidth(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=getCornerStyle(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,s=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=o===0&&s.length>0&&!hasClass$1(l.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),h=0;if(t){const g=this.wot.wtTable.getColumnWidth(e),v=this.wot.wtViewport.getViewportWidth();g>v&&(t=!1)}return t&&l.offsetWidth!==l.clientWidth&&(h=getScrollbarWidth(this.domBindings.rootDocument)),t?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=u):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=h,getMaximumScrollLeft(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=s-o;n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,s=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),a=t.getSetting("totalRows"),l=t.getSetting("preventOverflow")==="vertical";a?removeClass$1(n,"emptyRows"):addClass$1(n,"emptyRows");let u=!1;if(!l){if(o&&!s.length)addClass$1(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&s.length){const c=hasClass$1(n,"innerBorderInlineStart");e?(addClass$1(n,"innerBorderLeft innerBorderInlineStart"),u=!c):(removeClass$1(n,"innerBorderLeft innerBorderInlineStart"),u=c)}}return u}}const MIXIN_NAME="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});class TopInlineStartCornerOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_TOP_INLINE_START_CORNER)}}mixin(TopInlineStartCornerOverlayTable,stickyRowsTop);mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart);function _defineProperty$1g(r,e,t){return(e=_toPropertyKey$1h(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1h(r){var e=_toPrimitive$1h(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1h(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TopInlineStartCornerOverlay extends Overlay{constructor(e,t,n,s,o,a){super(e,t,CLONE_TOP_INLINE_START_CORNER,n,s),_defineProperty$1g(this,"topOverlay",void 0),_defineProperty$1g(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new TopInlineStartCornerOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();setOverlayPosition(e,`${s}px`,`${o}px`)}else resetCssTransform(e);let t=outerHeight(this.clone.wtTable.TABLE);const n=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class TopOverlayTable extends Table{constructor(e,t,n,s){super(e,t,n,s,CLONE_TOP)}}mixin(TopOverlayTable,stickyRowsTop);mixin(TopOverlayTable,calculatedColumns);function _defineProperty$1f(r,e,t){return(e=_toPropertyKey$1g(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1g(r){var e=_toPrimitive$1g(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1g(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TopOverlay extends Overlay{constructor(e,t,n,s){super(e,t,CLONE_TOP,n,s),_defineProperty$1f(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new TopOverlayTable(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let s=0,o=!1;if(this.trimmingContainer===t&&(!n||n!=="vertical")){const{wtTable:l}=this.wot,u=l.hider.getBoundingClientRect(),c=Math.ceil(u.bottom),h=e.offsetHeight;o=c===h,s=this.getOverlayOffset(),setOverlayPosition(e,"0px",`${s}px`)}else s=this.getScrollPosition(),resetCssTransform(e);const a=this.adjustHeaderBordersPosition(s,o);return this.adjustElementsSize(),a}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(getWindowScrollLeft(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wot.stylesHandler.getDefaultRowHeight();let s=e,o=0;for(;s<t;){const a=this.wot.wtTable.getRowHeight(s);o+=a===void 0?n:a,s+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let c=t.getWorkspaceWidth();t.hasVerticalScroll()&&(c-=getScrollbarWidth(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=getCornerStyle(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:s}=this,a=(n.cloneSource?n.cloneSource:n).wtTable.holder,l=s.getSetting("columnHeaders"),c=s.getSetting("fixedRowsTop")===0&&l.length>0&&!hasClass$1(a.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),g=0;if(t){const v=this.wot.wtTable.getRowHeight(e),m=this.wot.wtViewport.getViewportHeight();v>m&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(g=getScrollbarWidth(this.domBindings.rootDocument)),t){const v=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");h+=this.sumCellSizes(0,e+1),h-=n.wtViewport.getViewportHeight()-this.sumCellSizes(m-v,m),h+=1,h+=c}else h+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return h+=g,getMaximumScrollTop(this.mainTableScrollableElement)===h-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=s-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,s=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),a=n.getSetting("preventOverflow")==="horizontal";o?removeClass$1(s,"emptyColumns"):addClass$1(s,"emptyColumns");let l=!1;if(!t&&!a){const u=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,h=n.getSetting("columnHeaders");if((c||u===0)&&h.length>0){const g=hasClass$1(s,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(addClass$1(s,"innerBorderTop"),l=!g):(removeClass$1(s,"innerBorderTop"),l=g)}}return l}}function _classPrivateFieldInitSpec$L(r,e,t){_checkPrivateRedeclaration$11(r,e),e.set(r,t)}function _checkPrivateRedeclaration$11(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1e(r,e,t){return(e=_toPropertyKey$1f(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1f(r){var e=_toPrimitive$1f(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1f(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$J(r,e,t){return r.set(_assertClassBrand$11(r,e),t),t}function _classPrivateFieldGet$L(r,e){return r.get(_assertClassBrand$11(r,e))}function _assertClassBrand$11(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap;class Overlays{constructor(e,t,n,s,o,a){_defineProperty$1e(this,"wot",null),_classPrivateFieldInitSpec$L(this,_overlays,[]),_defineProperty$1e(this,"topOverlay",null),_defineProperty$1e(this,"bottomOverlay",null),_defineProperty$1e(this,"inlineStartOverlay",null),_defineProperty$1e(this,"topInlineStartCornerOverlay",null),_defineProperty$1e(this,"bottomInlineStartCornerOverlay",null),_defineProperty$1e(this,"browserLineHeight",void 0),_defineProperty$1e(this,"wtSettings",null),_classPrivateFieldInitSpec$L(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec$L(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec$L(this,_containerDomResizeCountTimeout,null),_defineProperty$1e(this,"resizeObserver",new ResizeObserver(h=>{requestAnimationFrame$1(()=>{!Array.isArray(h)||!h.length||(_classPrivateFieldSet$J(_containerDomResizeCount,this,_classPrivateFieldGet$L(_containerDomResizeCount,this)+1),_classPrivateFieldGet$L(_containerDomResizeCount,this)===100&&(warn$1("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet$L(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet$L(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet$J(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=s,this.domBindings=n,this.facadeGetter=t,this.wtTable=a;const{rootDocument:l,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=getScrollbarWidth(l);const c=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:getScrollableElement(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[..._classPrivateFieldGet$L(_overlays,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),s=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=s||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...e),this.bottomOverlay=new BottomOverlay(...e),this.inlineStartOverlay=new InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet$J(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet$J(_hasRenderingStateChanged,this,_classPrivateFieldGet$L(_overlays,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),_classPrivateFieldGet$L(_overlays,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet$L(_overlays,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",g=>this.onKeyDown(g)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",g=>this.onTableScroll(g),{passive:!0}),n!==s&&this.eventManager.addEventListener(s,"scroll",g=>this.onTableScroll(g),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,l=this.wtSettings.getSetting("preventWheel"),u={passive:a};(l||o||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",g=>this.onCloneWheel(g,l),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(g=>{if(g&&g.needFullRender){const{holder:v}=g.clone.wtTable;this.eventManager.addEventListener(v,"wheel",m=>this.onCloneWheel(m,l),u)}});let h;this.eventManager.addEventListener(t,"resize",()=>{requestAnimationFrame$1(()=>{clearTimeout(h),this.wtSettings.getSetting("onWindowResize"),h=setTimeout(()=>{_classPrivateFieldSet$J(_containerDomResizeCount,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(s!==t&&o!==t&&!e.target.contains(s)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,l=o!==n&&a!==n&&!a.contains(o),u=s!==n&&a!==n&&!a.contains(s);if(this.keyPressed&&(l||u)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=isKey(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const s=this.scrollVertically(t),o=this.scrollHorizontally(n);return s||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[s,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=s;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=s)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet$L(_hasRenderingStateChanged,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),_classPrivateFieldSet$J(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=getScrollableElement(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,s=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),s}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,s=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,h=l+this.inlineStartOverlay.sumCellSizes(0,o),v=t.hider.style,m=()=>s?!1:this.scrollableElement.scrollTop>Math.max(0,c-t.holder.clientHeight),E=()=>s?!1:this.scrollableElement.scrollLeft>Math.max(0,h-t.holder.clientWidth),_=m()?1:0,S=E()?1:0;v.width=`${h+S}px`,v.height=`${c+_}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return arrayEach(t,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(n=s.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(t,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function _defineProperty$1d(r,e,t){return(e=_toPropertyKey$1e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1e(r){var e=_toPrimitive$1e(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1e(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Settings{constructor(e){_defineProperty$1d(this,"settings",{}),_defineProperty$1d(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(t,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(t===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const s=this.getSetting("data",e,t);fastInnerText(n,s??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?objectEach(e,(n,s)=>{this.settings[s]=n}):this.settings[e]=t,this}getSetting(e,t,n,s,o){return typeof this.settings[e]=="function"?this.settings[e](t,n,s,o):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class MasterTable extends Table{constructor(e,t,n,s){super(e,t,n,s,"master")}alignOverlaysWithTrimmingContainer(){const e=getTrimmingContainer(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,s=getStyle(e,"height",t),o=getStyle(e,"overflow",t),a=this.holder.style,{scrollWidth:l,scrollHeight:u}=e;let c=e.offsetWidth,h=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const v=e.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",e.nextElementSibling?n.insertBefore(v,e.nextElementSibling):n.appendChild(v);const m=parseInt(t.getComputedStyle(v).height,10);n.removeChild(v),m===0&&(h=0)}h=Math.min(h,u),a.height=s==="auto"?"auto":`${h}px`,c=Math.min(c,l),a.width=`${c}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:h>0,this.hasTableWidth=c>0}this.isTableVisible=isVisible(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[n]){const l=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let c=0;c<o;c++)for(let h=-1*l;h<u;h++)this.markIfOversizedColumnHeader(h);t.hasOversizedColumnHeadersMarked[n]=!0}}}mixin(MasterTable,calculatedRows);mixin(MasterTable,calculatedColumns);class Viewport{constructor(e,t,n,s,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=outerHeight(t)>0&&t.clientHeight>0?t.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let s;if(n===t){const o=this.wtSettings.getSetting("totalColumns");s=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>s&&(s=e.documentElement.clientWidth)}else s=n.clientWidth;return s}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,s=e;for(;s<t;)n+=this.wtTable.getColumnWidth(s),s+=1;return n}getWorkspaceOffset(){return offset(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,s=t.length;n<s;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,o=t.length;s<o;s++)n?(this.rowHeaderWidth+=outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const u=t.getSetting("fixedRowsTop"),c=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return u&&l>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=a,s-=a),c&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(h-c,h),s-=a),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:e.map(g=>[g,this.rowsCalculatorTypes.get(g)()]),viewportHeight:s,scrollOffset:l,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:g=>n.getRowHeight(g),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=t.getSetting("fixedColumnsStart");if(a&&o>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=l,s-=l}return n.holder.clientWidth!==n.holder.offsetWidth&&(s-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:e.map(l=>[l,this.columnsCalculatorTypes.get(l)()]),viewportWidth:s,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:l=>n.getColumnWidth(l),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,n=this.createRowsCalculator(),s=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!t.getSetting("renderAllColumns")){const o=s.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=s.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=s.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:s,endRow:o,rowStartOffset:a,rowEndOffset:l}=this.rowsRenderCalculator,u=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(t=Math.max(0,t-Math.min(a,c)),n=Math.min(u,n+Math.min(l,c))):c==="auto"&&(t=Math.max(0,t-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(l/2))),t<s||t===s&&t>0?!1:!(n>o||n===o&&n<u)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:s,endColumn:o,columnStartOffset:a,columnEndOffset:l}=this.columnsRenderCalculator,u=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(t=Math.max(0,t-Math.min(a,c)),n=Math.min(u,n+Math.min(l,c))):c==="auto"&&(t=Math.max(0,t-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(l/2))),t<s||t===s&&t>0?!1:!(n>o||n===o&&n<u)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}function _classPrivateMethodInitSpec$L(r,e){_checkPrivateRedeclaration$10(r,e),e.add(r)}function _classPrivateFieldInitSpec$K(r,e,t){_checkPrivateRedeclaration$10(r,e),e.set(r,t)}function _checkPrivateRedeclaration$10(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$K(r,e){return r.get(_assertClassBrand$10(r,e))}function _classPrivateFieldSet$I(r,e,t){return r.set(_assertClassBrand$10(r,e),t),t}function _assertClassBrand$10(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const CLASSIC_THEME_DEFAULT_HEIGHT=23;var _themeName=new WeakMap,_rootElement=new WeakMap,_rootComputedStyle=new WeakMap,_rootDocument$1=new WeakMap,_isClassicTheme=new WeakMap,_cssVars=new WeakMap,_computedStyles=new WeakMap,_StylesHandler_brand=new WeakSet;class StylesHandler{constructor(e){_classPrivateMethodInitSpec$L(this,_StylesHandler_brand),_classPrivateFieldInitSpec$K(this,_themeName,void 0),_classPrivateFieldInitSpec$K(this,_rootElement,void 0),_classPrivateFieldInitSpec$K(this,_rootComputedStyle,void 0),_classPrivateFieldInitSpec$K(this,_rootDocument$1,void 0),_classPrivateFieldInitSpec$K(this,_isClassicTheme,!0),_classPrivateFieldInitSpec$K(this,_cssVars,{}),_classPrivateFieldInitSpec$K(this,_computedStyles,{}),_classPrivateFieldSet$I(_rootElement,this,e.rootTable.parentElement.parentElement),_classPrivateFieldSet$I(_rootDocument$1,this,e.rootDocument)}isClassicTheme(){return _classPrivateFieldGet$K(_isClassicTheme,this)}getCSSVariableValue(e){var t;if(_classPrivateFieldGet$K(_isClassicTheme,this))return null;if(_classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`])return _classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`];const n=(t=_assertClassBrand$10(_StylesHandler_brand,this,_getParsedNumericCSSValue).call(this,`--ht-${e}`))!==null&&t!==void 0?t:_assertClassBrand$10(_StylesHandler_brand,this,_getCSSValue).call(this,`--ht-${e}`);if(n!==null)return _classPrivateFieldGet$K(_cssVars,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var t;return(t=_classPrivateFieldGet$K(_computedStyles,this))===null||t===void 0?void 0:t.td[e]}getDefaultRowHeight(){if(_classPrivateFieldGet$K(_isClassicTheme,this))return CLASSIC_THEME_DEFAULT_HEIGHT;const e=_assertClassBrand$10(_StylesHandler_brand,this,_calculateRowHeight).call(this);return!e&&hasClass$1(_classPrivateFieldGet$K(_rootElement,this),"ht-wrapper")?(warn$1(`The "${_classPrivateFieldGet$K(_themeName,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),_classPrivateFieldSet$I(_isClassicTheme,this,!0),this.useTheme(),CLASSIC_THEME_DEFAULT_HEIGHT):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){_assertClassBrand$10(_StylesHandler_brand,this,_cacheStylesheetValues).call(this),_classPrivateFieldSet$I(_isClassicTheme,this,!0),_classPrivateFieldSet$I(_themeName,this,e||void 0);return}e&&e!==_classPrivateFieldGet$K(_themeName,this)&&(_classPrivateFieldGet$K(_themeName,this)&&_assertClassBrand$10(_StylesHandler_brand,this,_clearCachedValues).call(this),_classPrivateFieldSet$I(_themeName,this,e),_classPrivateFieldSet$I(_isClassicTheme,this,!1),_assertClassBrand$10(_StylesHandler_brand,this,_applyClassNames).call(this),_assertClassBrand$10(_StylesHandler_brand,this,_cacheStylesheetValues).call(this))}getThemeName(){return _classPrivateFieldGet$K(_themeName,this)}removeClassNames(){hasClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))&&removeClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))}}function _calculateRowHeight(){const r=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),t=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return r===null||e===null||isNaN(t)?null:r+2*e+t}function _applyClassNames(){removeClass$1(_classPrivateFieldGet$K(_rootElement,this),/ht-theme-.*/g),addClass$1(_classPrivateFieldGet$K(_rootElement,this),_classPrivateFieldGet$K(_themeName,this))}function _cacheStylesheetValues(){this.isClassicTheme()||_classPrivateFieldSet$I(_rootComputedStyle,this,getComputedStyle(_classPrivateFieldGet$K(_rootElement,this)));const r=_assertClassBrand$10(_StylesHandler_brand,this,_getStylesForTD).call(this,["box-sizing","border-bottom-width"]);_classPrivateFieldGet$K(_computedStyles,this).td={..._classPrivateFieldGet$K(_computedStyles,this).td,"box-sizing":r["box-sizing"],"border-bottom-width":r["border-bottom-width"]}}function _getStylesForTD(r){const e=_classPrivateFieldGet$K(_rootDocument$1,this),t=_classPrivateFieldGet$K(_rootElement,this),n=e.createElement("table"),s=e.createElement("tbody"),o=e.createElement("tr"),a=e.createElement("tr"),l=e.createElement("td");a.appendChild(l),s.appendChild(o),s.appendChild(a),n.appendChild(s),t.appendChild(n);const u=getComputedStyle(l),c={};return r.forEach(h=>{c[h]=u.getPropertyValue(h)}),t.removeChild(n),c}function _getParsedNumericCSSValue(r){const e=Math.ceil(parseFloat(_assertClassBrand$10(_StylesHandler_brand,this,_getCSSValue).call(this,r)));return Number.isNaN(e)?null:e}function _getCSSValue(r){const e=_classPrivateFieldGet$K(_rootComputedStyle,this).getPropertyValue(r);return e===""?null:e}function _clearCachedValues(){_classPrivateFieldSet$I(_computedStyles,this,{}),_classPrivateFieldSet$I(_cssVars,this,{}),_classPrivateFieldSet$I(_isClassicTheme,this,!0)}class Walkontable extends CoreAbstract{constructor(e,t){super(e,new Settings(t)),this.stylesHandler=new StylesHandler(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new MasterTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Viewport(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new Event$1(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Overlays(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],n=[];objectEach(e,(s,o)=>{this.wtSettings.getSetting(o).length&&n.push(s),t.push(s)}),removeClass$1(this.wtTable.wtRootElement.parentNode,t),addClass$1(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var t;if(!CLONE_TYPES.includes(e))return null;const n=e.replace(/_([a-z])/g,s=>s[1].toUpperCase());return(t=this.wtOverlays[`${n}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class WalkontableFacade{constructor(e){e instanceof CoreAbstract?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const n=new WalkontableFacade(t);return()=>n},this._wot=new Walkontable(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,s,o){return this._wot.wtSettings.getSetting(e,t,n,s,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}var esnext_iterator_some={},es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var r=require_export(),e=requireIterate(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect();return r({target:"Iterator",proto:!0,real:!0},{some:function(a){n(this),t(a);var l=s(this),u=0;return e(l,function(c,h){if(a(c,u++))return h()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var hasRequiredEsnext_iterator_some;function requireEsnext_iterator_some(){return hasRequiredEsnext_iterator_some||(hasRequiredEsnext_iterator_some=1,requireEs_iterator_some()),esnext_iterator_some}requireEsnext_iterator_some();function _defineProperty$1c(r,e,t){return(e=_toPropertyKey$1d(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1d(r){var e=_toPrimitive$1d(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1d(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class IndexMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1c(this,"indexedValues",[]),_defineProperty$1c(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction$1(this.initValueOrFn)?rangeEach(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):rangeEach(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mixin(IndexMap,localHooks);function getListWithInsertedItems$3(r,e,t,n){const s=t.length?t[0]:void 0;return[...r.slice(0,s),...t.map((o,a)=>isFunction$1(n)?n(o,a):n),...s===void 0?[]:r.slice(s)]}function getListWithRemovedItems$3(r,e){return arrayFilter(r,(t,n)=>e.includes(n)===!1)}class PhysicalIndexToValueMap extends IndexMap{insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),super.remove(e)}}class HidingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return arrayReduce(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function getListWithInsertedItems$2(r,e,t){return[...r.slice(0,e),...t,...r.slice(e)]}function getListWithRemovedItems$2(r,e){return arrayFilter(r,t=>e.includes(t)===!1)}function getDecreasedIndexes(r,e){return arrayMap(r,t=>t-e.filter(n=>n<t).length)}function getIncreasedIndexes(r,e){const t=e[0],n=e.length;return arrayMap(r,s=>s>=t?s+n:s)}function _defineProperty$1b(r,e,t){return(e=_toPropertyKey$1c(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1c(r){var e=_toPrimitive$1c(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1c(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class LinkedPhysicalIndexToValueMap extends IndexMap{constructor(){super(...arguments),_defineProperty$1b(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[e]),isFunction$1(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,e),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class TrimmingMap extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=r=>{if(alterStrategies.has(r)===!1)throw new Error(`Alter strategy with ID '${r}' does not exist.`);return alterStrategies.get(r)};class IndexesSequence extends IndexMap{constructor(){super(e=>e)}insert(e,t){const n=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$2(n,e,t),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}}const availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(r))throw new Error(`The provided map type ("${r}") does not exist.`);return new(availableIndexMapTypes.get(r))(e)}function _defineProperty$1a(r,e,t){return(e=_toPropertyKey$1b(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1b(r){var e=_toPrimitive$1b(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1b(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class MapCollection{constructor(){_defineProperty$1a(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);isDefined(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return isUndefined$1(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}mixin(MapCollection,localHooks);function _defineProperty$19(r,e,t){return(e=_toPropertyKey$1a(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1a(r){var e=_toPrimitive$1a(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1a(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class AggregatedCollection extends MapCollection{constructor(e,t){super(),_defineProperty$19(this,"mergedValuesCache",[]),_defineProperty$19(this,"aggregationFunction",void 0),_defineProperty$19(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=arrayMap(this.get(),o=>o.getValues()),n=[],s=isDefined(t[0])&&t[0].length||0;for(let o=0;o<s;o+=1){const a=[];for(let l=0;l<this.getLength();l+=1)a.push(t[l][o]);n.push(a)}return arrayMap(n,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return isDefined(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function _classPrivateFieldInitSpec$J(r,e,t){_checkPrivateRedeclaration$$(r,e),e.set(r,t)}function _checkPrivateRedeclaration$$(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$H(r,e,t){return r.set(_assertClassBrand$$(r,e),t),t}function _classPrivateFieldGet$J(r,e){return r.get(_assertClassBrand$$(r,e))}function _assertClassBrand$$(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap;class ChangesObserver{constructor(){_classPrivateFieldInitSpec$J(this,_currentInitialChanges,[])}subscribe(e){return this.addLocalHook("change",e),this._write(_classPrivateFieldGet$J(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_classPrivateFieldSet$H(_currentInitialChanges,this,e)}}mixin(ChangesObserver,localHooks);function arrayDiff(r,e){const t=[];let n=0,s=0;for(;n<r.length&&s<e.length;n++,s++)r[n]!==e[s]&&t.push({op:"replace",index:s,oldValue:r[n],newValue:e[s]});for(;n<e.length;n++)t.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;s<r.length;s++)t.push({op:"remove",index:s,oldValue:r[s],newValue:void 0});return t}function _classPrivateFieldInitSpec$I(r,e,t){_checkPrivateRedeclaration$_(r,e),e.set(r,t)}function _checkPrivateRedeclaration$_(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$I(r,e){return r.get(_assertClassBrand$_(r,e))}function _classPrivateFieldSet$G(r,e,t){return r.set(_assertClassBrand$_(r,e),t),t}function _assertClassBrand$_(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap;class ChangesObservable{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec$I(this,_observers,new Set),_classPrivateFieldInitSpec$I(this,_indexMatrix,[]),_classPrivateFieldInitSpec$I(this,_currentIndexState,[]),_classPrivateFieldInitSpec$I(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec$I(this,_initialIndexValue,!1),_classPrivateFieldSet$G(_initialIndexValue,this,e??!1)}createObserver(){const e=new ChangesObserver;return _classPrivateFieldGet$I(_observers,this).add(e),e.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet$I(_observers,this).delete(e)}),e._writeInitialChanges(arrayDiff(_classPrivateFieldGet$I(_indexMatrix,this),_classPrivateFieldGet$I(_currentIndexState,this))),e}emit(e){let t=_classPrivateFieldGet$I(_currentIndexState,this);(!_classPrivateFieldGet$I(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet$I(_indexMatrix,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(_classPrivateFieldGet$I(_initialIndexValue,this)):_classPrivateFieldSet$G(_indexMatrix,this,new Array(e.length).fill(_classPrivateFieldGet$I(_initialIndexValue,this))),_classPrivateFieldGet$I(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet$G(_isMatrixIndexesInitialized,this,!0),t=_classPrivateFieldGet$I(_indexMatrix,this)));const n=arrayDiff(t,e);_classPrivateFieldGet$I(_observers,this).forEach(s=>s._write(n)),_classPrivateFieldSet$G(_currentIndexState,this,e)}}function _defineProperty$18(r,e,t){return(e=_toPropertyKey$19(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$19(r){var e=_toPrimitive$19(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$19(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class IndexMapper{constructor(){_defineProperty$18(this,"indexesSequence",new IndexesSequence),_defineProperty$18(this,"trimmingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$18(this,"hidingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$18(this,"variousMapsCollection",new MapCollection),_defineProperty$18(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty$18(this,"notTrimmedIndexesCache",[]),_defineProperty$18(this,"notHiddenIndexesCache",[]),_defineProperty$18(this,"isBatched",!1),_defineProperty$18(this,"indexesSequenceChanged",!1),_defineProperty$18(this,"indexesChangeSource",void 0),_defineProperty$18(this,"trimmedIndexesChanged",!1),_defineProperty$18(this,"hiddenIndexesChanged",!1),_defineProperty$18(this,"renderablePhysicalIndexesCache",[]),_defineProperty$18(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty$18(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,createIndexMap(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof TrimmingMap?this.trimmingMapsCollection.register(e,t):t instanceof HidingMap?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return isDefined(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return isDefined(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return t>0?a=o.findIndex(l=>l>e):a=o.reverse().findIndex(l=>l<e),a===-1?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(n)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const n=arrayMap(e,c=>this.getPhysicalFromVisualIndex(c)),s=this.getNotTrimmedIndexesLength(),o=e.length,a=getListWithRemovedItems$2(this.getIndexesSequence(),n),l=a.filter(c=>this.isTrimmed(c)===!1);let u=a.indexOf(l[l.length-1])+1;if(t+o<s){const c=l[t];u=a.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems$2(a,u,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],s=isDefined(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=arrayMap(new Array(t).fill(s),(l,u)=>l+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromRenderableIndex(t),s=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(s,t)}}}mixin(IndexMapper,localHooks);function _classPrivateMethodInitSpec$K(r,e){_checkPrivateRedeclaration$Z(r,e),e.add(r)}function _classPrivateFieldInitSpec$H(r,e,t){_checkPrivateRedeclaration$Z(r,e),e.set(r,t)}function _checkPrivateRedeclaration$Z(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$17(r,e,t){return(e=_toPropertyKey$18(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$18(r){var e=_toPrimitive$18(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$18(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$H(r,e){return r.get(_assertClassBrand$Z(r,e))}function _classPrivateFieldSet$F(r,e,t){return r.set(_assertClassBrand$Z(r,e),t),t}function _assertClassBrand$Z(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutoColumnSizeSeed");const PLUGIN_KEY$x="autoColumnSize",PLUGIN_PRIORITY$w=10,COLUMN_SIZE_MAP_NAME="autoColumnSize";var _cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet;class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$x}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$w}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),_classPrivateMethodInitSpec$K(this,_AutoColumnSize_brand),_defineProperty$17(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$17(this,"samplesGenerator",new SamplesGenerator((t,n)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o))return!1;const a=this.hot.getCellMeta(t,n);let l="";a.spanned||(l=this.hot.getDataAtCell(t,n));let u="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=this.hot.runHooks("modifyAutoColumnSizeSeed",u,a,l)),{value:l,bundleSeed:u}})),_defineProperty$17(this,"inProgress",!1),_defineProperty$17(this,"measuredColumns",0),_defineProperty$17(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$H(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec$H(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,n,s)=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,t,n,s))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$x]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onAfterLoadData$7).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onBeforeChange$1).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$Z(_AutoColumnSize_brand,e,_onAfterFormulasValuesUpdate$1).call(e,...s)}),this.addHook("beforeRender",()=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeRender$2).call(this)),this.addHook("modifyColWidth",(n,s)=>this.getColumnWidth(s,n)),this.addHook("init",()=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onInit$3).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet$F(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>_assertClassBrand$Z(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,e,t,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;rangeEach(s.from,s.to,a=>{let l=this.hot.toPhysicalColumn(a);l===null&&(l=a),(n||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l))&&this.samplesGenerator.generateColumnSamples(a,o).forEach((c,h)=>this.ghostTable.addColumn(h,c))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,l)=>{const u=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(u,l)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const s=this.hot.countCols()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){cancelAnimationFrame(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+AutoColumnSize.CALCULATION_STEP,s)},e,t),n=n+AutoColumnSize.CALCULATION_STEP+1,n<s?o=requestAnimationFrame$1(a):(cancelAnimationFrame(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateColumnsWidth({from:0,to:l},e,t),n=l+1),n<s?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$x];let t=AutoColumnSize.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return isObject$1(e)&&(t=e.syncLimit,isPercentValue(t)?t=valueAccordingPercent(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof s=="number"&&(s=Math.max(s,DEFAULT_WIDTH))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,s,o)=>{const a=_classPrivateFieldGet$H(_cachedColumnHeaders,this).length;return(a-1<o||_classPrivateFieldGet$H(_cachedColumnHeaders,this)[o]!==s)&&n.push(this.hot.toVisualColumn(o)),a-1<o?_classPrivateFieldGet$H(_cachedColumnHeaders,this).push(s):_classPrivateFieldGet$H(_cachedColumnHeaders,this)[o]=s,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificColumnsWidth(r){const e={from:0,to:this.hot.countRows()-1};r.forEach(t=>{const n=this.hot.toPhysicalColumn(t);n!==null&&(this.hot._getColWidthFromSettings(n)||this.samplesGenerator.generateColumnSamples(t,e).forEach((o,a)=>this.ghostTable.addColumn(a,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,n)=>{const s=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(s,n)})},!0),this.ghostTable.clean())}function _onBeforeRender$2(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand$Z(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet$H(_visualColumnsToRefresh,this)),_classPrivateFieldSet$F(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData$7(r,e){e||this.recalculateAllColumnsWidth()}function _onBeforeChange$1(r){const e=r.reduce((t,n)=>{let[,s]=n;const o=this.hot.propToCol(s);return Number.isInteger(o)&&t.indexOf(o)===-1&&t.push(o),t},[]);_classPrivateFieldGet$H(_visualColumnsToRefresh,this).push(...e)}function _onBeforeColumnResize$1(r,e,t){let n=r;return t&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function _onInit$3(){_classPrivateFieldSet$F(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate$1(r){const e=r.reduce((t,n)=>{var s;const o=(s=n.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(o)){const a=this.hot.toVisualColumn(o);t.indexOf(a)===-1&&t.push(a)}return t},[]);_classPrivateFieldGet$H(_visualColumnsToRefresh,this).push(...e)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(r,e,t){let n,s,o;return e[0]===r[0]&&e[1]<r[1]?(o="left",n=t(e[0],e[1]),s=t(e[2],r[1]-1)):e[2]===r[2]&&e[0]===r[0]&&e[3]>r[3]?(o="right",n=t(e[0],r[3]+1),s=t(e[2],e[3])):e[0]<r[0]&&e[1]===r[1]?(o="up",n=t(e[0],e[1]),s=t(r[0]-1,e[3])):e[2]>r[2]&&e[1]===r[1]&&(o="down",n=t(r[2]+1,e[1]),s=t(e[2],e[3])),n&&n.normalize(),s&&s.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:s}}function getMappedFillHandleSetting(r){const e={};return r===!0?(e.directions=Object.keys(DIRECTIONS),e.autoInsertRow=!0):isObject$1(r)?(isDefined(r.autoInsertRow)?r.direction===DIRECTIONS.horizontal?e.autoInsertRow=!1:e.autoInsertRow=r.autoInsertRow:e.autoInsertRow=!1,isDefined(r.direction)?e.directions=[r.direction]:e.directions=Object.keys(DIRECTIONS)):typeof r=="string"?(e.directions=[r],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function _classPrivateMethodInitSpec$J(r,e){_checkPrivateRedeclaration$Y(r,e),e.add(r)}function _checkPrivateRedeclaration$Y(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$16(r,e,t){return(e=_toPropertyKey$17(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$17(r){var e=_toPrimitive$17(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$17(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$Y(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutofillRange");Hooks.getSingleton().register("beforeAutofill");Hooks.getSingleton().register("afterAutofill");const PLUGIN_KEY$w="autofill",PLUGIN_PRIORITY$v=20,SETTING_KEYS$3=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200;var _Autofill_brand=new WeakSet;class Autofill extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$J(this,_Autofill_brand),_defineProperty$16(this,"addingStarted",!1),_defineProperty$16(this,"mouseDownOnCellCorner",!1),_defineProperty$16(this,"mouseDragOutside",!1),_defineProperty$16(this,"handleDraggedCells",0),_defineProperty$16(this,"directions",[]),_defineProperty$16(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$w}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$v}static get SETTING_KEYS(){return[PLUGIN_KEY$w,...SETTING_KEYS$3]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$Y(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_assertClassBrand$Y(_Autofill_brand,this,_onCellCornerDblClick).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>_assertClassBrand$Y(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:s,endCol:o}]),l=[],u=[],c=[];return arrayEach(a,h=>{for(let g=h.startRow;g<=h.endRow;g+=1)l.indexOf(g)===-1&&l.push(g);for(let g=h.startCol;g<=h.endCol;g+=1)u.indexOf(g)===-1&&u.push(g)}),arrayEach(l,h=>{const g=[];arrayEach(u,v=>{g.push(this.hot.getCopyableData(h,v))}),c.push(g)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,s]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),l=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const u=[a.row,a.col,l.row,l.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,t),Math.max(l.row,n),Math.max(l.col,s)],u),{directionOfDrag:h,startOfDragCoords:g,endOfDragCoords:v}=getDragDirectionAndRange(u,c,(m,E)=>this.hot._createCellCoords(m,E));if(g&&g.row>-1&&g.col>-1){const m=this.getSelectionData(),E=o.clone(),_=this.hot._createCellRange(g,g,v),S=this.hot.runHooks("beforeAutofill",m,E,_,h);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=S;const A=S;if(["up","left"].indexOf(h)>-1&&!(A.length===1&&A[0].length===0))if(w=[],h==="up"){const O=v.row-g.row+1,D=O%A.length;for(let Y=0;Y<O;Y++)w.push(A[(Y+(A.length-D))%A.length])}else{const O=v.col-g.col+1,D=O%A[0].length;for(let Y=0;Y<A.length;Y++){w.push([]);for(let H=0;H<O;H++)w[Y].push(A[Y][(H+(A[Y].length-D))%A[Y].length])}}this.hot.populateFromArray(g.row,g.col,w,v.row,v.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",w,E,_,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let s=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const o=t.getTopStartCorner();(n.col<=e.col||o.col>=e.col)&&(s=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(s=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(DIRECTIONS.vertical))s=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(DIRECTIONS.horizontal))s=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let s;for(let o=e[2]+1;o<n;o++){for(let u=e[1];u<=e[3];u++){const c=t[o][u];if(!isEmpty$1(c))return-1}const a=t[o][e[1]-1],l=t[o][e[3]+1];(!isEmpty$1(a)||!isEmpty$1(l))&&(s=o)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...arrayMap(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+outerHeight(this.hot.table),s=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+outerWidth(this.hot.table);return e.clientY>n&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$Y(_Autofill_brand,this,_onMouseUp$5).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$Y(_Autofill_brand,this,_onMouseMove$4).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(r){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(r),this.addNewRowIfNeeded())}function _onMouseUp$5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove$4(r){const e=this.getIfMouseWasDraggedOutside(r);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _classPrivateMethodInitSpec$I(r,e){_checkPrivateRedeclaration$X(r,e),e.add(r)}function _classPrivateFieldInitSpec$G(r,e,t){_checkPrivateRedeclaration$X(r,e),e.set(r,t)}function _checkPrivateRedeclaration$X(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$15(r,e,t){return(e=_toPropertyKey$16(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$16(r){var e=_toPrimitive$16(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$16(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$E(r,e,t){return r.set(_assertClassBrand$X(r,e),t),t}function _classPrivateFieldGet$G(r,e){return r.get(_assertClassBrand$X(r,e))}function _assertClassBrand$X(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$v="autoRowSize",PLUGIN_PRIORITY$u=40,ROW_WIDTHS_MAP_NAME="autoRowSize";var _visualRowsToRefresh=new WeakMap,_AutoRowSize_brand=new WeakSet;class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$v}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$u}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_classPrivateMethodInitSpec$I(this,_AutoRowSize_brand),_defineProperty$15(this,"headerHeight",null),_defineProperty$15(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$15(this,"samplesGenerator",new SamplesGenerator((t,n)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o)||t>=0&&n>=0&&this.hot.getCellMeta(t,n).hidden)return!1;let a;return t>=0?a=this.hot.getDataAtCell(t,n):t===-1&&(a=this.hot.getColHeader(n)),{value:a}})),_defineProperty$15(this,"inProgress",!1),_defineProperty$15(this,"measuredRows",0),_defineProperty$15(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$G(this,_visualRowsToRefresh,[]),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(t,n,s)=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,t,n,s))}isEnabled(){const e=this.hot.getSettings()[PLUGIN_KEY$v];return e===!0||isObject$1(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onAfterLoadData$6).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onBeforeChange).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$X(_AutoRowSize_brand,e,_onAfterFormulasValuesUpdate).call(e,...s)}),this.addHook("beforeRender",()=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRender$1).call(this)),this.addHook("modifyRowHeight",(n,s)=>this.getRowHeight(s,n)),this.addHook("init",()=>_assertClassBrand$X(_AutoRowSize_brand,this,_onInit$2).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,n)=>_assertClassBrand$X(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,e,t,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(a.get(-1))}rangeEach(s.from,s.to,a=>{let l=this.hot.toPhysicalRow(a);l===null&&(l=a),(n||this.rowHeightsMap.getValueAtIndex(l)===null)&&this.samplesGenerator.generateRowSamples(a,o).forEach((c,h)=>this.ghostTable.addRow(h,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,l)=>{a<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),l)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const s=this.hot.countRows()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){cancelAnimationFrame(o),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+AutoRowSize.CALCULATION_STEP,s)},e,t),n=n+AutoRowSize.CALCULATION_STEP+1,n<s?o=requestAnimationFrame$1(a):(cancelAnimationFrame(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateRowsHeight({from:0,to:l},e,t),n=l+1),n<s?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[PLUGIN_KEY$v];let t=AutoRowSize.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return isObject$1(e)&&(t=e.syncLimit,isPercentValue(t)?t=valueAccordingPercent(n,t):t>>=0),Math.min(t,n)}getRowHeight(e,t){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=t;return n!==null&&n>(t||0)&&(s=n),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{rangeEach(Math.min(t,n),Math.max(t,n),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificRowsHeight(r){const e={from:0,to:this.hot.countCols()-1};r.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((s,o)=>this.ghostTable.addRow(o,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,n)=>{const s=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(s,n)})},!0),this.ghostTable.clean())}function _onBeforeRender$1(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand$X(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet$G(_visualRowsToRefresh,this)),_classPrivateFieldSet$E(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(r,e,t){let n=r;return t&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function _onAfterLoadData$6(r,e){e||this.recalculateAllRowsHeight()}function _onBeforeChange(r){const e=r.reduce((t,n)=>{let[s]=n;return t.indexOf(s)===-1&&t.push(s),t},[]);_classPrivateFieldGet$G(_visualRowsToRefresh,this).push(...e)}function _onInit$2(){this.recalculateAllRowsHeight()}function _onAfterFormulasValuesUpdate(r){const e=r.reduce((t,n)=>{var s;const o=(s=n.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(o)){const a=this.hot.toVisualRow(o);t.indexOf(a)===-1&&t.push(a)}return t},[]);_classPrivateFieldGet$G(_visualRowsToRefresh,this).push(...e)}const{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}=alterUtilsFactory("physicallyIndexed");class LooseBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,t){const n=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$1(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$1(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}}const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class StrictBindsMap extends IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,t,(n,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function _classPrivateMethodInitSpec$H(r,e){_checkPrivateRedeclaration$W(r,e),e.add(r)}function _checkPrivateRedeclaration$W(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$14(r,e,t){return(e=_toPropertyKey$15(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$15(r){var e=_toPrimitive$15(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$15(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$W(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$u="bindRowsWithHeaders",PLUGIN_PRIORITY$t=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]);var _BindRowsWithHeaders_brand=new WeakSet;class BindRowsWithHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$H(this,_BindRowsWithHeaders_brand),_defineProperty$14(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$u}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$t}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$u]}enablePlugin(){var e;if(this.enabled)return;const t=(e=bindTypeToMapStrategy.get(this.getSetting()))!==null&&e!==void 0?e:bindTypeToMapStrategy.get(DEFAULT_BIND);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",n=>_assertClassBrand$W(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function _onModifyRowHeader(r){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(r))}function _classPrivateMethodInitSpec$G(r,e){_checkPrivateRedeclaration$V(r,e),e.add(r)}function _classPrivateFieldInitSpec$F(r,e,t){_checkPrivateRedeclaration$V(r,e),e.set(r,t)}function _checkPrivateRedeclaration$V(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$13(r,e,t){return(e=_toPropertyKey$14(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$14(r){var e=_toPrimitive$14(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$14(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$F(r,e){return r.get(_assertClassBrand$V(r,e))}function _classPrivateFieldSet$D(r,e,t){return r.set(_assertClassBrand$V(r,e),t),t}function _assertClassBrand$V(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$t="collapsibleColumns",PLUGIN_PRIORITY$s=290,SETTING_KEYS$2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP$b=PLUGIN_KEY$t,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet;class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$G(this,_CollapsibleColumns_brand),_defineProperty$13(this,"nestedHeadersPlugin",null),_defineProperty$13(this,"headerStateManager",null),_classPrivateFieldInitSpec$F(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$t}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$s}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY$t,...SETTING_KEYS$2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$t]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||warn$1("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$D(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand$V(_CollapsibleColumns_brand,this,_onInit$1).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$V(_CollapsibleColumns_brand,e,_onAfterLoadData$5).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$V(_CollapsibleColumns_brand,e,_onAfterGetColHeader$4).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(n,s,o)=>_assertClassBrand$V(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown$6).call(this,n,s,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$D(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(t,n))!==null&&e!==void 0?e:{};if(s)return o?this.expandSection({row:t,col:a}):this.collapseSection({row:t,col:a}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:SHORTCUTS_GROUP$b,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$b)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};rangeEach(0,e-1,a=>{const l=t.childNodes[a],u=n.childNodes[a],c=s?s.childNodes[a]:null;rangeEach(0,l.childNodes.length-1,h=>{let g=l.childNodes[h].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);o(g),u&&u.childNodes[h]&&(g=u.childNodes[h].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(g)),s&&c&&c.childNodes[h]&&(g=c.childNodes[h].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(g))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(n=>{const{collapsible:s,origColspan:o,headerLevel:a,columnIndex:l,isCollapsed:u}=n;if(s===!0&&o>1&&(u&&e==="expand"||!u&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:l}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!actionDictionary.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=arrayFilter(e,m=>{let{row:E}=m;return E<0});let s=n.length>0;arrayEach(n,m=>{var E;let{row:_,col:S}=m;const{collapsible:w,isCollapsed:A}=(E=this.headerStateManager.getHeaderSettings(_,S))!==null&&E!==void 0?E:{};if(!w||A&&t==="collapse"||!A&&t==="expand")return s=!1,!1});const o=[],a=[];s&&arrayEach(n,m=>{let{row:E,col:_}=m;const{colspanCompensation:S,affectedColumns:w,rollbackModification:A}=this.headerStateManager.triggerNodeModification(t,E,_);S>0&&(a.push(...w),o.push(A))});const l=this.getCollapsedColumns();let u=[];t==="collapse"?u=arrayUnique([...l,...a]):t==="expand"&&(u=arrayFilter(l,m=>!a.includes(m)));const c=actionDictionary.get(t);if(this.hot.runHooks(c.beforeHook,l,u,s)===!1){arrayEach(o,m=>{m()});return}this.hot.batchExecution(()=>{arrayEach(a,m=>{_classPrivateFieldGet$F(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(m),c.hideColumn)})},!0);const g=this.getCollapsedColumns().length!==l.length,v=this.hot.getSelectedRangeLast();if(t==="collapse"&&g&&v){const{row:m,col:E}=v.highlight;if((this.hot.rowIndexMapper.isHidden(m)||this.hot.columnIndexMapper.isHidden(E))&&a.includes(E)){const S=m>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(m,1,!0):m,w=E>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(E,1,!0):E;S!==null&&w!==null&&this.hot.selectCell(S,w)}}this.hot.runHooks(c.afterHook,l,u,s,g),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return _classPrivateFieldGet$F(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet$D(_collapsedColumnsMap,this,null),super.destroy()}}function _onAfterGetColHeader$4(r,e,t){var n;const{collapsible:s,origColspan:o,isCollapsed:a}=(n=this.headerStateManager.getHeaderSettings(t,r))!==null&&n!==void 0?n:{},l=s&&o>1&&r>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(e,[A11Y_EXPANDED("")[0]]),l)c||(c=this.hot.rootDocument.createElement("div"),addClass$1(c,COLLAPSIBLE_ELEMENT_CLASS),e.querySelector("div:first-child").appendChild(c)),removeClass$1(c,["collapsed","expanded"]),a?(addClass$1(c,"collapsed"),fastInnerText(c,"+"),u&&setAttribute(e,...A11Y_EXPANDED(!1))):(addClass$1(c,"expanded"),fastInnerText(c,"-"),u&&setAttribute(e,...A11Y_EXPANDED(!0))),u&&setAttribute(c,...A11Y_HIDDEN());else{var h;(h=c)===null||h===void 0||h.remove()}}function _onBeforeOnCellMouseDown$6(r,e){hasClass$1(r.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass$1(r.target,"expanded")?(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):hasClass$1(r.target,"collapsed")&&(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),stopImmediatePropagation(r))}function _onInit$1(){this.updatePlugin()}function _onAfterLoadData$5(r,e){e||this.updatePlugin()}function _defineProperty$12(r,e,t){return(e=_toPropertyKey$13(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$13(r){var e=_toPrimitive$13(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$13(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0;class ColumnStatesManager{constructor(e,t){_defineProperty$12(this,"hot",void 0),_defineProperty$12(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty$12(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty$12(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty$12(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty$12(this,"compareFunctionFactory",void 0),_defineProperty$12(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){isObject$1(e)&&objectEach(e,(t,n)=>{inheritedColumnProperties.includes(n)&&(this[n]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[n]=t;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return isObject$1(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[n,s]=t;return{column:this.hot.toVisualColumn(n),...s}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(isDefined(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function compareFunctionFactory$4(r,e,t){const n=e.locale;return function(s,o){const{sortEmptyCells:a}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),s===o?DO_NOT_SWAP:isEmpty$1(s)?isEmpty$1(o)?DO_NOT_SWAP:a&&r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty$1(o)?a&&r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(s)&&!isNaN(o)?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(s)&&isNaN(o)||(isNaN(s)||isNaN(o)||(s=parseFloat(s),o=parseFloat(o)),s<o)?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:s>o?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$4="default";function compareFunctionFactory$3(r,e,t){return function(n,s){const o=parseFloat(n),a=parseFloat(s),{sortEmptyCells:l}=t;if(o===a||isNaN(o)&&isNaN(a))return DO_NOT_SWAP;if(l){if(isEmpty$1(n))return r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty$1(s))return r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(o)?FIRST_AFTER_SECOND:isNaN(a)?FIRST_BEFORE_SECOND:o<a?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>a?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$3="numeric";function compareFunctionFactory$2(r,e,t){const n=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:o}=t;return function(a,l){const u=isEmpty$1(a),c=isEmpty$1(l),h=u?s:a,g=c?s:l,v=h===s||h===n,m=g===s||g===n;if(o===!1){if(u&&c===!1)return FIRST_AFTER_SECOND;if(u===!1&&c)return FIRST_BEFORE_SECOND}return v===!1&&m?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:v&&m===!1?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:v===!1&&m===!1?compareFunctionFactory$4(r,e,t)(a,l):h===s&&g===n?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:h===n&&g===s?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$2="checkbox";function compareFunctionFactory$1(r,e,t){return createDateTimeCompareFunction(r,e.dateFormat,t)}const COLUMN_DATA_TYPE$1="date";function compareFunctionFactory(r,e,t){return createDateTimeCompareFunction(r,e.timeFormat,t)}const COLUMN_DATA_TYPE="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(r){return hasGloballyCompareFunctionFactory(r)?getGloballyCompareFunctionFactory(r):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$4)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2);registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1);registerCompareFunctionFactory(COLUMN_DATA_TYPE$4,compareFunctionFactory$4);registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3);registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(r,e){const t=getRootComparator(e);for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o];r.sort(t(...s))}const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(r){if(isObject$1(r)===!1)return!1;const{column:e,sortOrder:t}=r;return Number.isInteger(e)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(t)}function areValidSortStates(r){if(r.some(t=>isValidColumnState(t)===!1))return!1;const e=r.map(t=>{let{column:n}=t;return n});return new Set(e).size===e.length}function getNextSortOrder(r){if(r!==DESC_SORT_STATE)return r===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(r){return r.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(r,e){if(r<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function wasHeaderClickedProperly(r,e,t){return r===-1&&e>=0&&isRightClick(t)===!1}function createDateTimeCompareFunction(r,e,t){return function(n,s){const{sortEmptyCells:o}=t;if(n===s)return DO_NOT_SWAP;if(isEmpty$1(n))return isEmpty$1(s)?DO_NOT_SWAP:o&&r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty$1(s))return o&&r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const a=hooks(n,e),l=hooks(s,e);return a.isValid()?l.isValid()?l.isAfter(a)?r==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:l.isBefore(a)?r==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}const HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(r,e,t,n){const s=[HEADER_SORT_CLASS];if(n&&s.push(HEADER_ACTION_CLASS),t===!1)return s.push(HEADER_CLASS_INDICATOR_DISABLED),s;const o=r.getSortOrderOfColumn(e);return isDefined(o)&&s.push(orderToCssClass.get(o)),s}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator$1(r,e){return function(t,n){const[,...s]=t,[,...o]=n;return function(l){const u=r[l],c=e[l],h=s[l],g=o[l],v=c.columnSorting;return(v.compareFunctionFactory?v.compareFunctionFactory:getCompareFunctionFactory(c.type))(u,c,v)(h,g)}(0)}}function _classPrivateMethodInitSpec$F(r,e){_checkPrivateRedeclaration$U(r,e),e.add(r)}function _checkPrivateRedeclaration$U(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$11(r,e,t){return(e=_toPropertyKey$12(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$12(r){var e=_toPrimitive$12(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$12(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$U(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$s="columnSorting",PLUGIN_PRIORITY$r=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP$a=PLUGIN_KEY$s;registerRootComparator(PLUGIN_KEY$s,rootComparator$1);Hooks.getSingleton().register("beforeColumnSort");Hooks.getSingleton().register("afterColumnSort");var _ColumnSorting_brand=new WeakSet;class ColumnSorting extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$F(this,_ColumnSorting_brand),_defineProperty$11(this,"columnStatesManager",null),_defineProperty$11(this,"columnMetaCache",null),_defineProperty$11(this,"pluginKey",PLUGIN_KEY$s),_defineProperty$11(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$s}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$r}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(t=>{let n=this.hot.toVisualColumn(t);return n===null&&(n=t),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$U(_ColumnSorting_brand,this,_onAfterGetColHeader$3).call(this,t,n)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$U(_ColumnSorting_brand,e,_onBeforeOnCellMouseDown$5).call(e,...n)}),this.addHook("afterOnCellMouseDown",(t,n)=>this.onAfterOnCellMouseDown(t,n)),this.addHook("afterInit",()=>_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$U(_ColumnSorting_brand,e,_onAfterLoadData$4).call(e,...n)}),this.hot.view&&_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,n)=>{const s=getHeaderSpanElement(n);isFirstLevelColumnHeader(t,n)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$a})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$a)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",t,n,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,s?n:t,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return isDefined(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return areValidSortStates(e)&&e.every(n=>{let{column:s}=n;return s<=t&&s>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),n=s=>{let{column:o,...a}=s;return{column:this.hot.toPhysicalColumn(o),...a}};t.initialConfig=arrayMap(e,n),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=s=>{let{column:o,...a}=s;return{column:this.hot.toVisualColumn(o),...a}};return isDefined(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=arrayMap(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(isDefined(t)){const s=getNextSortOrder(t);return isDefined(s)?{column:e,sortOrder:s}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:getNextSortOrder()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=n!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(s){if(isUndefined$1(a))return[...o.slice(0,n),...o.slice(n+1)];if(t===APPEND_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,n),...o.slice(n+1),a];if(t===REPLACE_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,n),a,...o.slice(n+1)]}return isDefined(a)?o.concat(a):o}getPluginColumnConfig(e){if(isObject$1(e)){const t=e[this.pluginKey];if(isObject$1(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(s);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):isFunction$1(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],n=this.hot.countRows(),s=c=>arrayMap(e,h=>this.hot.getDataAtCell(c,h.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)t.push([this.hot.toPhysicalRow(c)].concat(s(c)));const o=arrayMap(t,c=>c[0]);sort(t,this.pluginKey,arrayMap(e,c=>c.sortOrder),arrayMap(e,c=>this.getFirstCellSettings(c.column)));for(let c=t.length;c<n;c+=1)t.push([c].concat(s(c)));const a=arrayMap(t,c=>c[0]),l=new Map(arrayMap(o,(c,h)=>[c,a[h]])),u=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),c=>l.has(c)?l.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(u)}sortBySettings(e){if(isObject$1(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||isObject$1(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(removeClass$1(e,getClassesToRemove$1()),this.enabled!==!1){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];addClass$1(e,getClassesToAdd$1(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&hasClass$1(e.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,t){if(wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const n=this.hot.getActiveEditor(),s=this.getColumnNextConfig(t.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function _loadOrSortBySettings(){const r=this.getAllSavedSortSettings();if(isObject$1(r))this.sortBySettings(r);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function _onAfterGetColHeader$3(r,e){const t=getHeaderSpanElement(e);if(isFirstLevelColumnHeader(r,e)===!1||t===null)return;const n=this.getFirstCellSettings(r)[this.pluginKey],s=n.indicator,o=n.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,r,s,o),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(r);setAttribute(e,...A11Y_SORT(a?`${a}ending`:"none"))}}function _onAfterLoadData$4(r){r===!0&&this.hot.view&&_assertClassBrand$U(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown$5(r,e,t,n){wasHeaderClickedProperly(e.row,e.col,r)!==!1&&this.wasClickableHeaderClicked(r,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function _defineProperty$10(r,e,t){return(e=_toPropertyKey$11(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$11(r){var e=_toPrimitive$11(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$11(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Endpoints{constructor(e,t){_defineProperty$10(this,"plugin",void 0),_defineProperty$10(this,"hot",void 0),_defineProperty$10(this,"endpoints",[]),_defineProperty$10(this,"settings",void 0),_defineProperty$10(this,"settingsType","array"),_defineProperty$10(this,"currentEndpoint",null),_defineProperty$10(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),arrayEach(n,s=>{const o={};this.assignSetting(s,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,o,"reversedRowCoords",!1),this.assignSetting(s,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"sourceColumn",s.destinationColumn),this.assignSetting(s,o,"type","sum"),this.assignSetting(s,o,"forceNumeric",!1),this.assignSetting(s,o,"suppressDataTypeErrors",!0),this.assignSetting(s,o,"customFunction",null),this.assignSetting(s,o,"readOnly",!0),this.assignSetting(s,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,n,s){if(n==="ranges"&&e[n]===void 0){t[n]=s;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(s instanceof Error)throw s;t[n]=s}else n==="destinationRow"&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}resetSetupBeforeStructureAlteration(e,t,n){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();arrayEach(o,a=>{s==="row"&&a.destinationRow>=t&&(e==="insert_row"?a.alterRowOffset=n:e==="remove_row"&&(a.alterRowOffset=-1*n)),s==="col"&&a.destinationColumn>=t&&(e==="insert_col"?a.alterColumnOffset=n:e==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,n,s,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const v=()=>(this.hot.removeHook("beforeViewRender",v),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",v);return}const l=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),h=e.indexOf("move_row")===0,g=t;arrayEach(c,v=>{l==="row"&&v.destinationRow>=g&&(v.alterRowOffset=u*n),l==="col"&&v.destinationColumn>=g&&(v.alterColumnOffset=u*n)}),this.resetAllEndpoints(c,!h),h?arrayEach(c,v=>{this.extendEndpointRanges(v,g,s[0],s.length),this.recreatePhysicalRanges(v),this.clearOffsetInformation(v)}):arrayEach(c,v=>{this.shiftEndpointCoordinates(v,g)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,s){arrayEach(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?n>o[1]?o[1]+=s:n<o[0]&&(o[0]-=s):n>=o[0]&&n<=o[1]&&(o[1]-=s,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,n=[],s=[];arrayEach(t,o=>{const a=[];if(o[1])for(let l=o[0];l<=o[1];l++)a.push(this.hot.toPhysicalRow(l));else a.push(this.hot.toPhysicalRow(o[0]));s.push(a)}),arrayEach(s,o=>{let a=[];arrayEach(o,(l,u)=>{u===0?a.push(l):o[u]!==o[u-1]+1&&(a.push(o[u-1]),n.push(a),a=[],a.push(l)),u===o.length-1&&(a.push(l),n.push(a))})}),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,arrayEach(e.ranges,n=>{arrayEach(n,(s,o)=>{s>=t&&(n[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const o=s.alterRowOffset||0,a=s.alterColumnOffset||0;return s.destinationRow+o>=this.hot.countRows()||s.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],arrayEach(e,(n,s,o)=>{`${n[2]||""}`!=`${n[3]}`&&arrayEach(this.getAllEndpoints(),(a,l)=>{this.hot.propToCol(o[s][1])===a.sourceColumn&&t.indexOf(l)===-1&&t.push(l)})}),arrayEach(t,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let l=0;Number.isInteger(a)&&(l=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(l)}n?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn$1("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function isNullishOrNaN(r){return r==null||isNaN(r)}function _classPrivateMethodInitSpec$E(r,e){_checkPrivateRedeclaration$T(r,e),e.add(r)}function _checkPrivateRedeclaration$T(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$$(r,e,t){return(e=_toPropertyKey$10(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$10(r){var e=_toPrimitive$10(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$10(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$T(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$r="columnSummary",PLUGIN_PRIORITY$q=220;var _ColumnSummary_brand=new WeakSet;class ColumnSummary extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$E(this,_ColumnSummary_brand),_defineProperty$$(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$r}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$q}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$r]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$r],this.endpoints=new Endpoints(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterInit$3).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterChange$2).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterUpdateSettings).call(e,...n)}),this.addHook("beforeCreateRow",(t,n,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,s)),this.addHook("beforeCreateCol",(t,n,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(t,n,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,s)),this.addHook("afterCreateCol",(t,n,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$T(_ColumnSummary_brand,e,_onAfterRowMove).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return objectEach(e.ranges,n=>{t+=this.getPartialSum(n,e.sourceColumn)}),t}getPartialSum(e,t){let n=0,s=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(s,t),o=isNullishOrNaN(o)?null:o,o!==null){const l=(`${o}`.split(".")[1]||[]).length||1;l>a&&(a=l)}n+=o||0,s-=1}while(s>=e[0]);return Math.round(n*10**a)/10**a}calculateMinMax(e,t){let n=null;return objectEach(e.ranges,s=>{const o=this.getPartialMinMax(s,e.sourceColumn,t);if(n===null&&o!==null&&(n=o),o!==null)switch(t){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o);break}}),n===null?"Not enough data":n}getPartialMinMax(e,t,n){let s=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,t),a=isNullishOrNaN(a)?null:a,s===null)s=a;else if(a!==null)switch(n){case"min":s=Math.min(s,a);break;case"max":s=Math.max(s,a);break}o-=1}while(o>=e[0]);return s}countEmpty(e,t){let n,s=0,o=e[1]||e[0];do n=this.getCellValue(o,t),n=isNullishOrNaN(n)?null:n,n===null&&(s+=1),o-=1;while(o>=e[0]);return s}countEntries(e){let t=0;const n=e.ranges;return objectEach(n,s=>{const o=s[1]===void 0?1:s[1]-s[0]+1,a=this.countEmpty(s,e.sourceColumn);t+=o,t-=a}),t}calculateAverage(e){const t=this.calculateSum(e),n=this.countEntries(e);return t/n}getCellValue(e,t){const n=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),a="";if(n!==null&&s!==null&&(a=this.hot.getCellMeta(n,s).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function _onAfterInit$3(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(r){r.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange$2(r,e){r&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(r)}function _onAfterRowMove(r,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",r[0],r.length,r,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,r.length,r,this.pluginName)}function _classPrivateMethodInitSpec$D(r,e){_checkPrivateRedeclaration$S(r,e),e.add(r)}function _classPrivateFieldInitSpec$E(r,e,t){_checkPrivateRedeclaration$S(r,e),e.set(r,t)}function _checkPrivateRedeclaration$S(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$E(r,e){return r.get(_assertClassBrand$S(r,e))}function _classPrivateFieldSet$C(r,e,t){return r.set(_assertClassBrand$S(r,e),t),t}function _assertClassBrand$S(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet;class EditorResizeObserver{constructor(){_classPrivateMethodInitSpec$D(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec$E(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec$E(this,_observedElement,null),_classPrivateFieldInitSpec$E(this,_observer,new ResizeObserver(e=>_assertClassBrand$S(_EditorResizeObserver_brand,this,_onResize).call(this,e)))}setObservedElement(e){_classPrivateFieldSet$C(_observedElement,this,e)}unobserve(){_classPrivateFieldGet$E(_observer,this).unobserve(_classPrivateFieldGet$E(_observedElement,this))}observe(){_classPrivateFieldSet$C(_ignoreInitialCall,this,!0),_classPrivateFieldGet$E(_observer,this).observe(_classPrivateFieldGet$E(_observedElement,this))}destroy(){_classPrivateFieldGet$E(_observer,this).disconnect()}}function _onResize(r){if(_classPrivateFieldGet$E(_ignoreInitialCall,this)||!Array.isArray(r)||!r.length){_classPrivateFieldSet$C(_ignoreInitialCall,this,!1);return}r.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:s}=t[0];this.runLocalHooks("resize",n,s)})}mixin(EditorResizeObserver,localHooks);function _classPrivateFieldInitSpec$D(r,e,t){_checkPrivateRedeclaration$R(r,e),e.set(r,t)}function _checkPrivateRedeclaration$R(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$D(r,e){return r.get(_assertClassBrand$R(r,e))}function _classPrivateFieldSet$B(r,e,t){return r.set(_assertClassBrand$R(r,e),t),t}function _assertClassBrand$R(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rootDocument=new WeakMap,_isRtl=new WeakMap,_container$1=new WeakMap,_editor$1=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver$1=new WeakMap;class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;_classPrivateFieldInitSpec$D(this,_rootDocument,void 0),_classPrivateFieldInitSpec$D(this,_isRtl,!1),_classPrivateFieldInitSpec$D(this,_container$1,null),_classPrivateFieldInitSpec$D(this,_editor$1,void 0),_classPrivateFieldInitSpec$D(this,_editorStyle,void 0),_classPrivateFieldInitSpec$D(this,_hidden,!0),_classPrivateFieldInitSpec$D(this,_resizeObserver$1,new EditorResizeObserver),_classPrivateFieldSet$B(_rootDocument,this,e),_classPrivateFieldSet$B(_isRtl,this,t),_classPrivateFieldSet$B(_editor$1,this,this.createEditor()),_classPrivateFieldSet$B(_editorStyle,this,_classPrivateFieldGet$D(_editor$1,this).style),_classPrivateFieldGet$D(_resizeObserver$1,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet$D(_resizeObserver$1,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,t){_classPrivateFieldGet$D(_editorStyle,this).left=`${e}px`,_classPrivateFieldGet$D(_editorStyle,this).top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet$D(_resizeObserver$1,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){_classPrivateFieldGet$D(_editorStyle,this).display="block",_classPrivateFieldSet$B(_hidden,this,!1)}hide(){_classPrivateFieldGet$D(_resizeObserver$1,this).unobserve(),_classPrivateFieldGet$D(_hidden,this)||(_classPrivateFieldGet$D(_editorStyle,this).display="none"),_classPrivateFieldSet$B(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet$D(_editorStyle,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet$D(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=_classPrivateFieldGet$D(_rootDocument,this).createElement("div"),t=_classPrivateFieldGet$D(_rootDocument,this).createElement("textarea");return e.style.display="none",_classPrivateFieldSet$B(_container$1,this,_classPrivateFieldGet$D(_rootDocument,this).createElement("div")),_classPrivateFieldGet$D(_container$1,this).setAttribute("dir",_classPrivateFieldGet$D(_isRtl,this)?"rtl":"ltr"),addClass$1(_classPrivateFieldGet$D(_container$1,this),CommentEditor.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet$D(_rootDocument,this).body.appendChild(_classPrivateFieldGet$D(_container$1,this)),addClass$1(e,CommentEditor.CLASS_EDITOR),addClass$1(t,CommentEditor.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),_classPrivateFieldGet$D(_container$1,this).appendChild(e),e}getInputElement(){return _classPrivateFieldGet$D(_editor$1,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}getEditorElement(){return _classPrivateFieldGet$D(_editor$1,this)}destroy(){const e=_classPrivateFieldGet$D(_container$1,this)?_classPrivateFieldGet$D(_container$1,this).parentNode:null;_classPrivateFieldGet$D(_editor$1,this).parentNode.removeChild(_classPrivateFieldGet$D(_editor$1,this)),_classPrivateFieldSet$B(_editor$1,this,null),_classPrivateFieldSet$B(_editorStyle,this,null),_classPrivateFieldGet$D(_resizeObserver$1,this).destroy(),e&&e.removeChild(_classPrivateFieldGet$D(_container$1,this))}}mixin(CommentEditor,localHooks);function _defineProperty$_(r,e,t){return(e=_toPropertyKey$$(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$$(r){var e=_toPrimitive$$(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$$(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250;class DisplaySwitch{constructor(e){_defineProperty$_(this,"wasLastActionShow",!0),_defineProperty$_(this,"showDebounced",null),_defineProperty$_(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}mixin(DisplaySwitch,localHooks);function prepareVerticalAlignClass(r,e){return r.indexOf(e)!==-1?r:`${r.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function prepareHorizontalAlignClass(r,e){return r.indexOf(e)!==-1?r:`${r.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function getAlignmentClasses(r,e){const t={};return arrayEach(r,n=>{n.forAll((s,o)=>{s>=0&&o>=0&&(t[s]||(t[s]=[]),t[s][o]=e(s,o))})}),t}function align(r,e,t,n,s){arrayEach(r,o=>{o.forAll((a,l)=>{a>=0&&l>=0&&applyAlignClassName(a,l,e,t,n,s)})})}function applyAlignClassName(r,e,t,n,s,o){const a=s(r,e);let l=n;a.className&&(t==="vertical"?l=prepareVerticalAlignClass(a.className,n):l=prepareHorizontalAlignClass(a.className,n)),o(r,e,"className",l)}function markLabelAsSelected(r){return`<span class="selected"></span>${r}`}function checkSelectionConsistency(r,e){let t=!1;return Array.isArray(r)&&arrayEach(r,n=>(n.forAll((s,o)=>{if(s>=0&&o>=0&&e(s,o))return t=!0,!1}),t)),t}function getDocumentOffsetByElement(r,e){const t={top:0,left:0};if(e!==r.ownerDocument){const{frameElement:n}=e.defaultView,{top:s,left:o}=n.getBoundingClientRect();t.top=s,t.left=o}return t}const KEY$c="---------";function separatorItem(){return{name:KEY$c}}const KEY$b="alignment";function alignmentItem(){return{key:KEY$b,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY$b}:left`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:center`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:right`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:justify`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{name:KEY$c},{key:`${KEY$b}:top`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:middle`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1},{key:`${KEY$b}:bottom`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const r=this.getSelectedRange(),e=getAlignmentClasses(r,(s,o)=>this.getCellMeta(s,o).className),t="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,r,t,n),align(r,t,n,(s,o)=>this.getCellMeta(s,o),(s,o,a,l)=>this.setCellMeta(s,o,a,l)),this.render()},disabled:!1}]}}}const KEY$a="clear_column";function clearColumnItem(){return{key:KEY$a,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(r,e){const t=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const KEY$9="col_left";function columnLeftItem(){return{key:KEY$9,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const r=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,r.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$8="col_right";function columnRightItem(){return{key:KEY$8,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const r=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,r.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$7="make_read_only";function readOnlyItem(){return{key:KEY$7,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(t,n)=>this.getCellMeta(t,n).readOnly)&&(r=markLabelAsSelected(r)),r},callback(){const r=this.getSelectedRange(),e=checkSelectionConsistency(r,(t,n)=>this.getCellMeta(t,n).readOnly);arrayEach(r,t=>{t.forAll((n,s)=>{n>=0&&s>=0&&this.setCellMeta(n,s,"readOnly",!e)})}),this.render()},disabled(){const r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const KEY$6="redo";function redoItem(){return{key:KEY$6,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){const r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(e!==rootCall&&e!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(r),n=e===rootCall;let s=SELECTION_TYPE_UNRECOGNIZED;if(t){const o=r[0];r.length===0?s=SELECTION_TYPE_EMPTY:n&&o instanceof CellRange?s=SELECTION_TYPE_OBJECT:n&&Array.isArray(o)?s=detectSelectionType(o,childCall):r.length>=2&&r.length<=4&&!r.some((l,u)=>!ARRAY_TYPE_PATTERN[u].includes(typeof l))&&(s=SELECTION_TYPE_ARRAY)}return s}function normalizeSelectionFactory(r){let{createCellCoords:e,createCellRange:t,keepDirection:n=!1,propToCol:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(r))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=r===SELECTION_TYPE_OBJECT;let l=a?o.from.row:o[0],u=a?o.from.col:o[1],c=a?o.to.row:o[2],h=a?o.to.col:o[3];if(typeof s=="function"&&(typeof u=="string"&&(u=s(u)),typeof h=="string"&&(h=s(h))),isUndefined$1(c)&&(c=l),isUndefined$1(h)&&(h=u),!n){const m=l,E=u,_=c,S=h;l=Math.min(m,_),u=Math.min(E,S),c=Math.max(m,_),h=Math.max(E,S)}const g=e(l,u),v=e(c,h);return t(g,g,v)}}function transformSelectionToColumnDistance(r){const e=detectSelectionType(r.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const t=normalizeSelectionFactory(e,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),n=new Set;arrayEach(r.getSelected(),a=>{const{from:l,to:u}=t(a),c=Math.max(l.col,0),h=u.col-c+1;arrayEach(Array.from(new Array(h),(g,v)=>c+v),g=>{n.has(g)||n.add(g)})});const s=Array.from(n).sort((a,l)=>a-l);return arrayReduce(s,(a,l,u,c)=>(u!==0&&l===c[u-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}function transformSelectionToRowDistance(r){const e=detectSelectionType(r.getSelected());if(e===SELECTION_TYPE_UNRECOGNIZED||e===SELECTION_TYPE_EMPTY)return[];const t=normalizeSelectionFactory(e,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),n=new Set;arrayEach(r.getSelected(),a=>{const{from:l,to:u}=t(a),c=Math.max(l.row,0),h=u.row-c+1;arrayEach(Array.from(new Array(h),(g,v)=>c+v),g=>{n.has(g)||n.add(g)})});const s=Array.from(n).sort((a,l)=>a-l);return arrayReduce(s,(a,l,u,c)=>(u!==0&&l===c[u-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}const KEY$5="remove_col";function removeColumnItem(){return{key:KEY$5,name(){const r=this.getSelected();let e=0;if(r)if(r.length>1)e=1;else{const[,t,,n]=r[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const KEY$4="remove_row";function removeRowItem(){return{key:KEY$4,name(){const r=this.getSelected();let e=0;if(r)if(r.length>1)e=1;else{const[t,,n]=r[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KEY$3="row_above";function rowAboveItem(){return{key:KEY$3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const r=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",r.row,1,"ContextMenu.rowAbove")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$2="row_below";function rowBelowItem(){return{key:KEY$2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const r=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",r.row,1,"ContextMenu.rowBelow")},disabled(){const r=this.getSelectedRangeLast();return!r||r.isSingleHeader()&&r.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$1="no_items";function noItemsItem(){return{key:KEY$1,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const KEY="undo";function undoItem(){return{key:KEY,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){const r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ITEMS=[KEY$3,KEY$2,KEY$9,KEY$8,KEY$a,KEY$4,KEY$5,KEY,KEY$6,KEY$7,KEY$b,KEY$c,KEY$1],_predefinedItems={[KEY$c]:separatorItem,[KEY$1]:noItemsItem,[KEY$3]:rowAboveItem,[KEY$2]:rowBelowItem,[KEY$9]:columnLeftItem,[KEY$8]:columnRightItem,[KEY$a]:clearColumnItem,[KEY$4]:removeRowItem,[KEY$5]:removeColumnItem,[KEY]:undoItem,[KEY$6]:redoItem,[KEY$7]:readOnlyItem,[KEY$b]:alignmentItem};function predefinedItems(){const r={};return objectEach(_predefinedItems,(e,t)=>{r[t]=e()}),r}function addEditCommentItem(r){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&r.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const e=this.getSelectedRangeLast();r.setRange(e),r.show(),r.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(r){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((t,n)=>{t>=0&&n>=0&&r.removeCommentAtCell(t,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(r){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(n,s)=>r.getCommentMeta(n,s,META_READONLY))?markLabelAsSelected(e):e},callback(){this.getSelectedRangeLast().forAll((t,n)=>{if(t>=0&&n>=0){const s=!!r.getCommentMeta(t,n,META_READONLY);r.updateCommentMeta(t,n,{[META_READONLY]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!r.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _classPrivateMethodInitSpec$C(r,e){_checkPrivateRedeclaration$Q(r,e),e.add(r)}function _classPrivateFieldInitSpec$C(r,e,t){_checkPrivateRedeclaration$Q(r,e),e.set(r,t)}function _checkPrivateRedeclaration$Q(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$Z(r,e,t){return(e=_toPropertyKey$_(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$_(r){var e=_toPrimitive$_(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$_(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$A(r,e,t){return r.set(_assertClassBrand$Q(r,e),t),t}function _classPrivateFieldGet$C(r,e){return r.get(_assertClassBrand$Q(r,e))}function _assertClassBrand$Q(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$q="comments",PLUGIN_PRIORITY$p=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP$9=PLUGIN_KEY$q,SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY$q}`;var _editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet;class Comments extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$C(this,_Comments_brand),_defineProperty$Z(this,"range",{}),_classPrivateFieldInitSpec$C(this,_editor,null),_classPrivateFieldInitSpec$C(this,_displaySwitch,null),_classPrivateFieldInitSpec$C(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec$C(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec$C(this,_cellBelowCursor,null),_classPrivateFieldInitSpec$C(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY$q}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$p}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$q]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$C(_editor,this)||(_classPrivateFieldSet$A(_editor,this,new CommentEditor(this.hot.rootDocument,this.hot.isRtl())),_classPrivateFieldGet$C(_editor,this).addLocalHook("resize",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$Q(_Comments_brand,e,_onEditorResize).call(e,...n)})),_classPrivateFieldGet$C(_displaySwitch,this)||_classPrivateFieldSet$A(_displaySwitch,this,new DisplaySwitch(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,n,s,o,a,l)=>_assertClassBrand$Q(_Comments_brand,this,_onAfterRenderer).call(this,t,l)),this.addHook("afterScroll",()=>_assertClassBrand$Q(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>_assertClassBrand$Q(_Comments_brand,this,_onAfterDocumentKeyDown$1).call(this,t)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$Q(_Comments_brand,e,_updateEditorThemeClassName).call(e,...n)}),_classPrivateFieldGet$C(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet$C(_displaySwitch,this).addLocalHook("show",(t,n)=>this.showAtCell(t,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$C(_displaySwitch,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(SHORTCUTS_CONTEXT_NAME);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();_classPrivateFieldSet$A(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(SHORTCUTS_CONTEXT_NAME),this.hot._registerTimeout(()=>{_classPrivateFieldSet$A(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:SHORTCUTS_GROUP$9}),n.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet$C(_editor,this).setValue(_classPrivateFieldGet$C(_commentValueBeforeSave,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$C(_editor,this).isVisible()&&_classPrivateFieldGet$C(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$C(_editor,this).isVisible()&&_classPrivateFieldGet$C(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$9)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>_assertClassBrand$Q(_Comments_brand,this,_onMouseOver$2).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>_assertClassBrand$Q(_Comments_brand,this,_onMouseDown$2).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$Q(_Comments_brand,this,_onMouseUp$4).call(this)),this.eventManager.addEventListener(t,"focus",()=>_assertClassBrand$Q(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(t,"blur",()=>_assertClassBrand$Q(_Comments_brand,this,_onEditorBlur).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=closest(e.target,"TD","TBODY");return!!(t&&hasClass$1(t,"htCommentCell")&&closest(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=_classPrivateFieldGet$C(_editor,this).getValue();let n="";e!=null?n=e:t!=null&&(n=t);const s=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(s,o,{[META_COMMENT_VALUE]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,META_COMMENT_VALUE)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,META_COMMENT_VALUE)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:n}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _classPrivateFieldGet$C(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet$C(_editor,this).setValue((e=s[META_COMMENT]?s[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&e!==void 0?e:""),_classPrivateFieldGet$C(_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){_classPrivateFieldGet$C(_editor,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet$C(_editor,this).isVisible()))return;const{rowIndexMapper:s,columnIndexMapper:o}=this.hot,{row:a,col:l}=this.range.from;let u=s.getRenderableFromVisualIndex(a),c=o.getRenderableFromVisualIndex(l);const h=u===null;_classPrivateFieldGet$C(_editor,this).setPosition(0,0),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1))),c===null&&(c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1)));const g=u===null,v=c===null;u=(e=u)!==null&&e!==void 0?e:0,c=(t=c)!==null&&t!==void 0?t:0;const{rootWindow:m,view:{_wt:E}}=this.hot,{wtTable:_}=E,S=E.getCell({row:u,col:c},!0),w=this.getCommentMeta(a,l,META_STYLE);w?_classPrivateFieldGet$C(_editor,this).setSize(w.width,w.height):_classPrivateFieldGet$C(_editor,this).resetSize();const A=v?0:_.getColumnWidth(c),O=h&&!g?outerHeight(S):0,{left:D,top:Y,width:H,height:k}=S.getBoundingClientRect(),{width:K,height:se}=_classPrivateFieldGet$C(_editor,this).getSize(),{innerWidth:re,innerHeight:Ce}=this.hot.rootWindow,Le=this.hot.rootDocument.documentElement;let he=D+m.scrollX+A,ve=Y+m.scrollY+O;this.hot.isRtl()&&(he-=K+A),this.hot.isLtr()&&D+H+K>re?he=D+m.scrollX-K-1:this.hot.isRtl()&&he<-(Le.scrollWidth-Le.clientWidth)&&(he=D+m.scrollX+A+1),Y+se>Ce&&(ve-=se-k+1),_classPrivateFieldGet$C(_editor,this).setPosition(he,ve),_classPrivateFieldGet$C(_editor,this).setReadOnlyState(this.getCommentMeta(a,l,META_READONLY)),_classPrivateFieldGet$C(_editor,this).observeSize()}focusEditor(){_classPrivateFieldGet$C(_editor,this).focus()}updateCommentMeta(e,t,n){const s=this.hot.getCellMeta(e,t)[META_COMMENT];let o;s?(o=deepClone(s),deepExtend(o,n)):o=n,this.hot.setCellMeta(e,t,META_COMMENT,o)}getCommentMeta(e,t,n){const s=this.hot.getCellMeta(e,t);if(s[META_COMMENT])return s[META_COMMENT][n]}addToContextMenu(e){e.items.push({name:KEY$c},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getEditorInputElement(){return _classPrivateFieldGet$C(_editor,this).getInputElement()}destroy(){var e,t;(e=_classPrivateFieldGet$C(_editor,this))===null||e===void 0||e.destroy(),(t=_classPrivateFieldGet$C(_displaySwitch,this))===null||t===void 0||t.destroy(),super.destroy()}}function _onMouseDown$2(r){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet$C(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(r)){const e=closest(r.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function _onMouseOver$2(r){const{rootDocument:e}=this.hot;if(!(_classPrivateFieldGet$C(_preventEditorAutoSwitch,this)||_classPrivateFieldGet$C(_editor,this).isFocused()||hasClass$1(r.target,"wtBorder")||_classPrivateFieldGet$C(_cellBelowCursor,this)===r.target||!_classPrivateFieldGet$C(_editor,this)))if(_classPrivateFieldSet$A(_cellBelowCursor,this,e.elementFromPoint(r.clientX,r.clientY)),this.targetIsCellWithComment(r)){const t=this.hot._createCellRange(this.hot.getCoords(r.target));_classPrivateFieldGet$C(_displaySwitch,this).show(t)}else isChildOf(r.target,e)&&!this.targetIsCommentTextArea(r)&&_classPrivateFieldGet$C(_displaySwitch,this).hide()}function _onMouseUp$4(){_classPrivateFieldSet$A(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(r,e){e[META_COMMENT]&&e[META_COMMENT][META_COMMENT_VALUE]&&addClass$1(r,e.commentedCellClassName)}function _onEditorBlur(){_classPrivateFieldSet$A(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet$A(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME)}function _onEditorResize(r,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width:r,height:e}})}function _onAfterDocumentKeyDown$1(r){_classPrivateFieldGet$C(_editor,this).isFocused()&&stopImmediatePropagation(r)}function _onAfterScroll(){_classPrivateFieldGet$C(_preventEditorHiding,this)||this.hide()}function _updateEditorThemeClassName(){const r=_classPrivateFieldGet$C(_editor,this).getEditorElement();removeClass$1(r,/ht-theme-.*/g),addClass$1(r,this.hot.getCurrentThemeName())}var es_array_unshift={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var r=requireTryToString(),e=TypeError;return deletePropertyOrThrow=function(t,n){if(!delete t[n])throw new e("Cannot delete property "+r(n)+" of "+r(t))},deletePropertyOrThrow}var hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var r=require_export(),e=requireToObject(),t=requireLengthOfArrayLike(),n=requireArraySetLength(),s=requireDeletePropertyOrThrow(),o=requireDoesNotExceedSafeInteger(),a=[].unshift(0)!==1,l=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},u=a||!l();return r({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(h){var g=e(this),v=t(g),m=arguments.length;if(m){o(v+m);for(var E=v;E--;){var _=E+m;E in g?g[_]=g[E]:s(g,_)}for(var S=0;S<m;S++)g[S]=arguments[S]}return n(g,v+m)}}),es_array_unshift}requireEs_array_unshift();function _defineProperty$Y(r,e,t){return(e=_toPropertyKey$Z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Z(r){var e=_toPrimitive$Z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CommandExecutor{constructor(e){_defineProperty$Y(this,"hot",void 0),_defineProperty$Y(this,"commands",{}),_defineProperty$Y(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const o=e.split(":"),a=o[0],l=o.length===2?o[1]:null;let u=this.commands[a];if(!u)throw new Error(`Menu command '${a}' not exists.`);if(l&&u.submenu&&(u=findSubCommand(l,u.submenu.items)),u.disabled===!0||typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0||hasOwnProperty(u,"submenu"))return;const c=[];typeof u.callback=="function"&&c.push(u.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(o.join(":")),arrayEach(c,h=>h.apply(this.hot,n))}}function findSubCommand(r,e){let t;return arrayEach(e,n=>{const s=n.key?n.key.split(":"):null;if(Array.isArray(s)&&s[1]===r)return t=n,!1}),t}function _defineProperty$X(r,e,t){return(e=_toPropertyKey$Y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Y(r){var e=_toPrimitive$Y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ItemsFactory{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty$X(this,"hot",void 0),_defineProperty$X(this,"predefinedItems",predefinedItems()),_defineProperty$X(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,objectEach(e,(n,s)=>{let o="";n.name===KEY$c?(t[KEY$c]=n,o=KEY$c):isNaN(parseInt(s,10))?(n.key=n.key===void 0?s:n.key,t[s]=n,o=n.key):(t[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(e,this.defaultOrderPattern,this.predefinedItems)}}function getItems(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let s=r;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),isObject$1(s)?objectEach(s,(o,a)=>{let l=t[typeof o=="string"?o:a];l||(l=o),isObject$1(o)?extend$1(l,o):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):arrayEach(s,(o,a)=>{let l=t[o];!l&&ITEMS.indexOf(o)>=0||(l||(l={name:o,key:`${a}`}),isObject$1(o)&&extend$1(l,o),l.key===void 0&&(l.key=a),n.push(l))}),n}function _defineProperty$W(r,e,t){return(e=_toPropertyKey$X(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$X(r){var e=_toPrimitive$X(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$X(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Cursor{constructor(e,t){_defineProperty$W(this,"top",void 0),_defineProperty$W(this,"topRelative",void 0),_defineProperty$W(this,"left",void 0),_defineProperty$W(this,"leftRelative",void 0),_defineProperty$W(this,"scrollTop",void 0),_defineProperty$W(this,"scrollLeft",void 0),_defineProperty$W(this,"cellHeight",void 0),_defineProperty$W(this,"cellWidth",void 0);const n=t.scrollY,s=t.scrollX;let o,a,l,u,c,h;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),l=parseInt(e.left,10),c=e.height||0,h=e.width||0,a=o,u=l,o+=n,l+=s):this.type==="event"&&(o=parseInt(e.pageY,10),l=parseInt(e.pageX,10),c=e.target.clientHeight,h=e.target.clientWidth,a=o-n,u=l-s),this.top=o,this.topRelative=a,this.left=l,this.leftRelative=u,this.scrollTop=n,this.scrollLeft=s,this.cellHeight=c,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _classPrivateFieldInitSpec$B(r,e,t){_checkPrivateRedeclaration$P(r,e),e.set(r,t)}function _checkPrivateRedeclaration$P(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$B(r,e){return r.get(_assertClassBrand$P(r,e))}function _classPrivateFieldSet$z(r,e,t){return r.set(_assertClassBrand$P(r,e),t),t}function _assertClassBrand$P(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset$1=new WeakMap;class Positioner{constructor(e){_classPrivateFieldInitSpec$B(this,_container,void 0),_classPrivateFieldInitSpec$B(this,_parentContainer,void 0),_classPrivateFieldInitSpec$B(this,_cursor,void 0),_classPrivateFieldInitSpec$B(this,_keepInViewport,!1),_classPrivateFieldInitSpec$B(this,_offset$1,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet$z(_keepInViewport,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet$B(_offset$1,this)[e]=t,this}setElement(e){return _classPrivateFieldSet$z(_container,this,e),this}setParentElement(e){return _classPrivateFieldSet$z(_parentContainer,this,e),this}updatePosition(e){_classPrivateFieldSet$z(_cursor,this,new Cursor(e,_classPrivateFieldGet$B(_container,this).ownerDocument.defaultView)),_classPrivateFieldGet$B(_keepInViewport,this)?(_classPrivateFieldGet$B(_cursor,this).fitsBelow(_classPrivateFieldGet$B(_container,this))?this.setPositionBelowCursor():_classPrivateFieldGet$B(_cursor,this).fitsAbove(_classPrivateFieldGet$B(_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet$B(_container,this).dir==="rtl"?_classPrivateFieldGet$B(_cursor,this).fitsOnLeft(_classPrivateFieldGet$B(_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet$B(_cursor,this).fitsOnRight(_classPrivateFieldGet$B(_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).above+_classPrivateFieldGet$B(_cursor,this).top-_classPrivateFieldGet$B(_container,this).offsetHeight;_classPrivateFieldGet$B(_parentContainer,this)&&(e=_classPrivateFieldGet$B(_cursor,this).top+_classPrivateFieldGet$B(_cursor,this).cellHeight-_classPrivateFieldGet$B(_container,this).offsetHeight+3),_classPrivateFieldGet$B(_container,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).below+_classPrivateFieldGet$B(_cursor,this).top+1;_classPrivateFieldGet$B(_parentContainer,this)&&(e=_classPrivateFieldGet$B(_cursor,this).top-1),_classPrivateFieldGet$B(_container,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_classPrivateFieldGet$B(_cursor,this).left;if(_classPrivateFieldGet$B(_parentContainer,this)){const t=_classPrivateFieldGet$B(_parentContainer,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(_classPrivateFieldGet$B(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);e+=_classPrivateFieldGet$B(_cursor,this).cellWidth+n}else e+=_classPrivateFieldGet$B(_offset$1,this).right;_classPrivateFieldGet$B(_container,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_classPrivateFieldGet$B(_offset$1,this).left+_classPrivateFieldGet$B(_cursor,this).left-_classPrivateFieldGet$B(_container,this).offsetWidth;if(_classPrivateFieldGet$B(_parentContainer,this)){const t=_classPrivateFieldGet$B(_parentContainer,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(_classPrivateFieldGet$B(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}_classPrivateFieldGet$B(_container,this).style.left=`${e}px`}}function createPaginator(r){let{initialPage:e=-1,size:t=()=>0,onItemSelect:n=()=>{},onClear:s=()=>{}}=r;const o=new Set;let a=clamp(e,-1,E()-1);function l(S,w){const A=E()-1;return S<0&&(S=A),S>A&&(S=0),o.has(S)?-1:(o.add(S),n(S,!1)===!1&&(S=l(w===1?++S:--S,w)),S)}function u(S){S>-1&&S<E()&&n(S,!0)!==!1&&(a=S)}function c(){return a}function h(){E()>0&&(o.clear(),a=l(0,1))}function g(){E()>0&&(o.clear(),a=l(E()-1,-1))}function v(){E()>0&&(o.clear(),a=l(++a,1))}function m(){E()>0&&(o.clear(),a=l(--a,-1))}function E(){return Math.max(t(),0)}function _(){o.clear(),a=e,s()}return{setCurrentPage:u,getCurrentPage:c,toFirstItem:h,toLastItem:g,toNextItem:v,toPreviousItem:m,getSize:E,clear:_}}function normalizeSelection(r){return arrayMap(r,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function isItemSubMenu(r){return hasOwnProperty(r,"submenu")}function isItemSeparator(r){return new RegExp(KEY$c,"i").test(r.name)}function isItemDisabled(r,e){return r.disabled===!0||typeof r.disabled=="function"&&r.disabled.call(e)===!0}function isItemSelectionDisabled(r){return hasOwnProperty(r,"disableSelection")}function isSeparator(r){return hasClass$1(r,"htSeparator")}function hasSubMenu(r){return hasClass$1(r,"htSubmenu")}function isDisabled(r){return hasClass$1(r,"htDisabled")}function isSelectionDisabled(r){return hasClass$1(r,"htSelectionDisabled")}function isItemHidden(r,e){return!r.hidden||!(typeof r.hidden=="function"&&r.hidden.call(e))}function shiftSeparators(r,e){const t=r.slice(0);for(let n=0;n<t.length&&t[n].name===e;)t.shift();return t}function popSeparators(r,e){let t=r.slice(0);return t.reverse(),t=shiftSeparators(t,e),t.reverse(),t}function removeDuplicatedSeparators(r){const e=[];return arrayEach(r,(t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function filterSeparators(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$c,t=r.slice(0);return t=shiftSeparators(t,e),t=popSeparators(t,e),t=removeDuplicatedSeparators(t),t}function isItemCheckable(r){return r.checkable===!0}function createMenuNavigator(r){return createPaginator({size:()=>r.countRows(),onItemSelect(e,t){const n=r.getCell(e,0);if(!n||isSeparator(n)||isDisabled(n)||isSelectionDisabled(n))return!1;r.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){r.deselectCell()}})}function createDefaultShortcutsList(r){const{hot:e,hotMenu:t}=r;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>r.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,s)=>{const o=e.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;s.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),r.close(!0)}},{keys:[["Escape"]],callback:()=>r.close()},{keys:[["ArrowDown"]],callback:()=>r.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>r.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const n=t.getSelectedLast();if(n){const s=r.openSubMenu(n[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&r.isSubMenu()&&(r.close(),r.isSubMenu()&&r.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>r.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>r.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const s=t.getSelectedLast();s&&(t.getSourceDataAtRow(s[0]).submenu?r.openSubMenu(s[0]).getNavigator().toFirstItem():(r.executeCommand(n),r.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):r.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):r.getNavigator().toLastItem()}}]}const SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$8=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];n(createDefaultShortcutsList(r)),e.forEach(c=>{let{shortcuts:h,contextName:g}=c;s(h,g)});function n(c,h){l(h).addShortcuts(c,{group:SHORTCUTS_CONTEXT})}function s(c,h){const g=l(h);c.forEach(v=>{let{keys:m}=v;m.forEach(E=>g.removeShortcutsByKeys(E))}),t.push({shortcuts:c,contextName:h}),n(c,h)}function o(){return[...t]}function a(c){return c?`${SHORTCUTS_GROUP$8}:${c}`:SHORTCUTS_GROUP$8}function l(c){var h;const g=r.hotMenu.getShortcutManager(),v=a(c);return(h=g.getContext(v))!==null&&h!==void 0?h:g.addContext(v)}function u(c){r.hotMenu.getShortcutManager().setActiveContextName(a(c))}return{addCustomShortcuts:s,getCustomShortcuts:o,getContext:l,listen:u}}function createMenuItemRenderer(r){return(e,t,n,s,o,a)=>{const l=e.getSourceDataAtRow(n),u=r.rootDocument.createElement("div"),c=typeof a=="function"?a.call(r):a,h=typeof l.ariaLabel=="function"?l.ariaLabel.call(r):l.ariaLabel,g=typeof l.ariaChecked=="function"?l.ariaChecked.call(r):l.ariaChecked;if(empty$1(t),addClass$1(u,"htItemWrapper"),r.getSettings().ariaTags){const v=!isItemDisabled(l,r)&&!isItemSelectionDisabled(l)&&!isItemSeparator(l);setAttribute(t,[...isItemCheckable(l)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(h),A11Y_CHECKED(g)]:[A11Y_MENU_ITEM(),A11Y_LABEL(c)],...v?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(l,r)?[A11Y_DISABLED()]:[],...isItemSubMenu(l)?[A11Y_EXPANDED(!1)]:[]])}t.className="",t.appendChild(u),isItemSeparator(l)?addClass$1(t,"htSeparator"):typeof l.renderer=="function"?(addClass$1(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,u,n,s,o,c))):fastInnerHTML(u,c),isItemDisabled(l,r)?addClass$1(t,"htDisabled"):isItemSelectionDisabled(l)?addClass$1(t,"htSelectionDisabled"):isItemSubMenu(l)&&addClass$1(t,"htSubmenu")}}function _classPrivateFieldInitSpec$A(r,e,t){_checkPrivateRedeclaration$O(r,e),e.set(r,t)}function _checkPrivateRedeclaration$O(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$V(r,e,t){return(e=_toPropertyKey$W(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$W(r){var e=_toPrimitive$W(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$W(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$y(r,e,t){return r.set(_assertClassBrand$O(r,e),t),t}function _classPrivateFieldGet$A(r,e){return r.get(_assertClassBrand$O(r,e))}function _assertClassBrand$O(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const MIN_WIDTH=215;var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap;class Menu{get tableBorderWidth(){return _classPrivateFieldGet$A(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet$y(_tableBorderWidth,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet$A(_tableBorderWidth,this)}constructor(e,t){var n=this;_defineProperty$V(this,"hot",void 0),_defineProperty$V(this,"options",void 0),_defineProperty$V(this,"eventManager",new EventManager(this)),_defineProperty$V(this,"container",void 0),_defineProperty$V(this,"positioner",void 0),_defineProperty$V(this,"hotMenu",null),_defineProperty$V(this,"hotSubMenus",{}),_defineProperty$V(this,"parentMenu",void 0),_defineProperty$V(this,"menuItems",null),_defineProperty$V(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec$A(this,_navigator,void 0),_classPrivateFieldInitSpec$A(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec$A(this,_tableBorderWidth,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(s,o)=>{if(!o){var a;(a=this.hotMenu)===null||a===void 0||a.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=getParentWindow(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return _classPrivateFieldGet$A(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet$A(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=debounce(l=>this.openSubMenu(l),300),t=this.options.minWidth||MIN_WIDTH;let n=!1,s=arrayFilter(this.menuItems,l=>(l.key===KEY$1&&(n=!0),isItemHidden(l,this.hot)));if(s.length<1&&!n)s.push(predefinedItems()[KEY$1]);else if(s.length===0)return;s=filterSeparators(s,KEY$c);let o=!1;const a={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(l){return isDefined(l)&&l<t?t:l},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(l,u)=>{_classPrivateFieldGet$A(_navigator,this).setCurrentPage(u.row)},afterOnCellMouseOver:(l,u)=>{this.isAllSubMenusClosed()?e(u.row):this.openSubMenu(u.row)},rowHeights:l=>s[l].name===KEY$c?1:void 0,afterOnCellContextMenu:l=>{l.preventDefault(),isWindowsOS()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(l,u,c,h,g)=>{this.hotMenu.view.isMouseDown()&&(g.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:l=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(l))},afterOnCellMouseUp:l=>{(!isWindowsOS()||!isRightClick(l))&&o&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet$y(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet$y(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet$A(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet$A(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const n=this.parentMenu.hotMenu.getCell(t[0],0);setAttribute(n,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!hasSubMenu(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),s=new Menu(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(n.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=s,this.hot.getSettings().ariaTags&&setAttribute(t,[A11Y_EXPANDED(!0)]),s}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&setAttribute(s,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),s=n?normalizeSelection(n):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){return e.isCommand===!1||isItemSeparator(e)||isItemDisabled(e,this.hot)||isItemSubMenu(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,n=e.hider.style,s=e.holder.style,o=parseInt(n.width,10),a=arrayReduce(t,(l,u,c)=>{const g=this.hotMenu.getCell(c,0)?outerHeight(this.hotMenu.getCell(c,0)):0;return l+(u.name===KEY$c?1:g)},0);s.width=`${o}px`,s.height=`${a}px`,n.height=s.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let n=e,s;return n&&(isFunction$1(n)&&(n=n.call(this.hot),n===null||isUndefined$1(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,s=t.querySelector(`.${this.options.className}.${n}`)),s||(s=t.createElement("div"),addClass$1(s,`htMenu ${this.options.className}`),n&&addClass$1(s,n),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&hasClass$1(e.target,"htCore")&&isChildOf(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mixin(Menu,localHooks);function _classPrivateMethodInitSpec$B(r,e){_checkPrivateRedeclaration$N(r,e),e.add(r)}function _checkPrivateRedeclaration$N(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$U(r,e,t){return(e=_toPropertyKey$V(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$V(r){var e=_toPrimitive$V(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$V(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$N(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$p="contextMenu",PLUGIN_PRIORITY$o=70,SHORTCUTS_GROUP$7=PLUGIN_KEY$p;Hooks.getSingleton().register("afterContextMenuDefaultOptions");Hooks.getSingleton().register("beforeContextMenuShow");Hooks.getSingleton().register("afterContextMenuShow");Hooks.getSingleton().register("afterContextMenuHide");Hooks.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet;class ContextMenu extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$B(this,_ContextMenu_brand),_defineProperty$U(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$U(this,"itemsFactory",null),_defineProperty$U(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$p}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$o}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$3,KEY$2,KEY$c,KEY$9,KEY$8,KEY$c,KEY$4,KEY$5,KEY$c,KEY,KEY$6,KEY$c,KEY$7,KEY$c,KEY$b]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$p]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$p];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuBeforeOpen$1).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuAfterOpen$1).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$N(_ContextMenu_brand,this,_onMenuAfterClose$1).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",n=>_assertClassBrand$N(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$7})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$7)}open(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),objectEach(n,(o,a)=>{this.menu.setOffset(a,o)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);const e=this.hot.getSettings()[PLUGIN_KEY$p],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),arrayEach(n,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _onAfterOnCellContextMenu(r){const e=this.hot.getSettings(),t=e.rowHeaders,n=e.colHeaders;function s(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const o=r.target;if(this.close(),hasClass$1(o,"handsontableInput")||(r.preventDefault(),r.stopPropagation(),!(t||n)&&!s(o)&&!(hasClass$1(o,"current")&&hasClass$1(o,"wtBorder"))))return;const a=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:r.clientY+a.top,left:r.clientX+a.left})}function _onMenuBeforeOpen$1(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen$1(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose$1(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY$c};const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(r){const e=[[""]];if(r.length===0)return e;let t=0,n=0,s;for(;r.length>0&&s!==r.length;)if(s=r.length,r.match(regNextEmptyCell))r=r.replace(regNextEmptyCell,""),t+=1,e[n][t]="";else if(r.match(regUniversalNewLine))r=r.replace(regUniversalNewLine,""),t=0,n+=1,e[n]=[""];else{let o="";if(r.startsWith('"')){let a=0,l=!0;for(;l;){const u=r.slice(0,1);u==='"'&&(a+=1),o+=u,r=r.slice(1),(r.length===0||r.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,u=>new Array(Math.floor(u.length/2)).fill('"').join(""))}else{const a=r.match(regNextCellNoQuotes);o=a?a[0]:"",r=r.slice(o.length)}e[n][t]=o}return e}function stringify(r){let e,t,n,s,o="",a;for(e=0,t=r.length;e<t;e+=1){for(s=r[e].length,n=0;n<s;n+=1)n>0&&(o+="	"),a=r[e][n],typeof a=="string"?a.indexOf(`
`)>-1?o+=`"${a.replace(/"/g,'""')}"`:o+=a:a==null?o+="":o+=a;e!==t-1&&(o+=`
`)}return o}function copyItem(r){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){r.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(r){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,t)},callback(){r.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(r){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,t)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function copyWithColumnHeadersItem(r){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?clamp(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,t)},callback(){r.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function cutItem(r){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){r.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class ClipboardData{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}}function _classPrivateMethodInitSpec$A(r,e){_checkPrivateRedeclaration$M(r,e),e.add(r)}function _classPrivateFieldInitSpec$z(r,e,t){_checkPrivateRedeclaration$M(r,e),e.set(r,t)}function _checkPrivateRedeclaration$M(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$z(r,e){return r.get(_assertClassBrand$M(r,e))}function _classPrivateFieldSet$x(r,e,t){return r.set(_assertClassBrand$M(r,e),t),t}function _assertClassBrand$M(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet;class CopyableRangesFactory{constructor(e){let{countRows:t,countColumns:n,rowsLimit:s,columnsLimit:o,countColumnHeaders:a}=e;_classPrivateMethodInitSpec$A(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec$z(this,_selectedRange,void 0),_classPrivateFieldInitSpec$z(this,_countRows,void 0),_classPrivateFieldInitSpec$z(this,_countColumns,void 0),_classPrivateFieldInitSpec$z(this,_rowsLimit,void 0),_classPrivateFieldInitSpec$z(this,_columnsLimit$1,void 0),_classPrivateFieldInitSpec$z(this,_countColumnHeaders,void 0),_classPrivateFieldSet$x(_countRows,this,t),_classPrivateFieldSet$x(_countColumns,this,n),_classPrivateFieldSet$x(_rowsLimit,this,s),_classPrivateFieldSet$x(_columnsLimit$1,this,o),_classPrivateFieldSet$x(_countColumnHeaders,this,a)}setSelectedRange(e){_classPrivateFieldSet$x(_selectedRange,this,e)}getCellsRange(){if(_classPrivateFieldGet$z(_countRows,this).call(this)===0||_classPrivateFieldGet$z(_countColumns,this).call(this)===0)return null;const{row:e,col:t}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{row:n,col:s}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),o=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,e,n),a=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,t,s);return{isRangeTrimmed:n!==o||s!==a,startRow:e,startCol:t,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet$z(_countColumns,this).call(this)===0||_classPrivateFieldGet$z(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),n=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(_classPrivateFieldGet$z(_countColumns,this).call(this)===0||_classPrivateFieldGet$z(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$z(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$z(_selectedRange,this).getBottomEndCorner(),n=_assertClassBrand$M(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-_classPrivateFieldGet$z(_countColumnHeaders,this).call(this),startCol:e,endRow:-1,endCol:n}}}function _trimColumnsRange(r,e){return Math.min(e,Math.max(r+_classPrivateFieldGet$z(_columnsLimit$1,this).call(this)-1,r))}function _trimRowsRange(r,e){return Math.min(e,Math.max(r+_classPrivateFieldGet$z(_rowsLimit,this).call(this)-1,r))}function normalizeRanges(r){const e=[],t=[];return arrayEach(r,n=>{const s=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);rangeEach(s,o,u=>{e.indexOf(u)===-1&&e.push(u)});const a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);rangeEach(a,l,u=>{t.indexOf(u)===-1&&t.push(u)})}),{rows:e,columns:t}}var es_string_replaceAll={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var r=requireIsObject(),e=requireClassofRaw(),t=requireWellKnownSymbol(),n=t("match");return isRegexp=function(s){var o;return r(s)&&((o=s[n])!==void 0?!!o:e(s)==="RegExp")},isRegexp}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var r=requireAnObject();return regexpFlags=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var r=requireFunctionCall(),e=requireHasOwnProperty(),t=requireObjectIsPrototypeOf(),n=requireRegexpFlags(),s=RegExp.prototype;return regexpGetFlags=function(o){var a=o.flags;return a===void 0&&!("flags"in s)&&!e(o,"flags")&&t(s,o)?r(n,o):a},regexpGetFlags}var getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var r=requireFunctionUncurryThis(),e=requireToObject(),t=Math.floor,n=r("".charAt),s=r("".replace),o=r("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(u,c,h,g,v,m){var E=h+u.length,_=g.length,S=l;return v!==void 0&&(v=e(v),S=a),s(m,S,function(w,A){var O;switch(n(A,0)){case"$":return"$";case"&":return u;case"`":return o(c,0,h);case"'":return o(c,E);case"<":O=v[o(A,1,-1)];break;default:var D=+A;if(D===0)return w;if(D>_){var Y=t(D/10);return Y===0?w:Y<=_?g[Y-1]===void 0?n(A,1):g[Y-1]+n(A,1):w}O=g[D-1]}return O===void 0?"":O})},getSubstitution}var hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var r=require_export(),e=requireFunctionCall(),t=requireFunctionUncurryThis(),n=requireRequireObjectCoercible(),s=requireIsCallable(),o=requireIsNullOrUndefined(),a=requireIsRegexp(),l=requireToString(),u=requireGetMethod(),c=requireRegexpGetFlags(),h=requireGetSubstitution(),g=requireWellKnownSymbol(),v=requireIsPure(),m=g("replace"),E=TypeError,_=t("".indexOf),S=t("".replace),w=t("".slice),A=Math.max;return r({target:"String",proto:!0},{replaceAll:function(D,Y){var H=n(this),k,K,se,re,Ce,Le,he,ve,xe,Ie,we=0,Ne="";if(!o(D)){if(k=a(D),k&&(K=l(n(c(D))),!~_(K,"g")))throw new E("`.replaceAll` does not allow non-global regexes");if(se=u(D,m),se)return e(se,D,H,Y);if(v&&k)return S(l(H),D,Y)}for(re=l(H),Ce=l(D),Le=s(Y),Le||(Y=l(Y)),he=Ce.length,ve=A(1,he),xe=_(re,Ce);xe!==-1;)Ie=Le?l(Y(Ce,xe,re)):h(Ce,re,xe,[],void 0,Y),Ne+=w(re,we,xe)+Ie,we=xe+he,xe=xe+ve>re.length?-1:_(re,Ce,xe+ve);return we<re.length&&(Ne+=w(re,we)),Ne}}),es_string_replaceAll}requireEs_string_replaceAll();const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(r=>`(${r})`).join("|"),"gi");function isHTMLTable(r){return(r&&r.nodeName||"")==="TABLE"}function instanceToHTML(r){const e=r.hasColHeaders(),t=r.hasRowHeaders(),n=[e?-1:0,t?-1:0,r.countRows()-1,r.countCols()-1],s=r.getData(...n),o=s.length,a=o>0?s[0].length:0,l=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],h=t?1:0,g=e?1:0;for(let v=0;v<o;v+=1){const m=e&&v===0,E=[];for(let S=0;S<a;S+=1){const w=!m&&t&&S===0;let A="";if(m)A=`<th>${r.getColHeader(S-h)}</th>`;else if(w)A=`<th>${r.getRowHeader(v-g)}</th>`;else{const O=s[v][S],{hidden:D,rowspan:Y,colspan:H}=r.getCellMeta(v-g,S-h);if(!D){const k=[];if(Y&&k.push(`rowspan="${Y}"`),H&&k.push(`colspan="${H}"`),isEmpty$1(O))A=`<td ${k.join(" ")}></td>`;else{const K=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A=`<td ${k.join(" ")}>${K}</td>`}}}E.push(A)}const _=["<tr>",...E,"</tr>"].join("");m?u.splice(1,0,_):c.splice(-1,0,_)}return l.splice(1,0,u.join(""),c.join("")),l.join("")}function _dataToHTML(r){const e=r.length,t=["<table>"];for(let n=0;n<e;n+=1){const s=r[n],o=s.length,a=[];n===0&&t.push("<tbody>");for(let l=0;l<o;l+=1){const u=s[l],c=isEmpty$1(u)?"":u.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,h=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(h.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${c}</td>`)}t.push("<tr>",...a,"</tr>"),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function htmlToGridSettings(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},n=e.createDocumentFragment(),s=e.createElement("div");n.appendChild(s);let o=r;if(typeof o=="string"){const O=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,D=>{const Y=D.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,k=D.substring(Y.length,D.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${Y}${k}</td>`});s.insertAdjacentHTML("afterbegin",`${O}`),o=s.querySelector("table")}if(!o||!isHTMLTable(o))return;const a=s.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce((O,D)=>O+D.colSpan,0)-(l?1:0):0,h=o.tFoot&&Array.from(o.tFoot.rows)||[],g=[];let v=!1,m=0,E=0;if(o.tHead){const O=Array.from(o.tHead.rows).filter(D=>{const Y=D.querySelector("td")!==null;return Y&&g.push(D),!Y});m=O.length,v=m>0,m>1?t.nestedHeaders=Array.from(O).reduce((D,Y)=>{const H=Array.from(Y.cells).reduce((k,K,se)=>{if(l&&se===0)return k;const{colSpan:re,innerHTML:Ce}=K,Le=re>1?{label:Ce,colspan:re}:Ce;return k.push(Le),k},[]);return D.push(H),D},[]):v&&(t.colHeaders=Array.from(O[0].children).reduce((D,Y,H)=>(l&&H===0||D.push(Y.innerHTML),D),[]))}g.length&&(t.fixedRowsTop=g.length),h.length&&(t.fixedRowsBottom=h.length);const _=[...g,...Array.from(o.tBodies).reduce((O,D)=>(O.push(...Array.from(D.rows)),O),[]),...h];E=_.length;const S=new Array(E);for(let O=0;O<E;O++)S[O]=new Array(c);const w=[],A=[];for(let O=0;O<E;O++){const D=_[O],Y=Array.from(D.cells),H=Y.length;for(let k=0;k<H;k++){const K=Y[k],{nodeName:se,innerHTML:re,rowSpan:Ce,colSpan:Le}=K,he=S[O].findIndex(ve=>ve===void 0);if(se==="TD"){if(Ce>1||Le>1){for(let we=O;we<O+Ce;we++)if(we<E)for(let Ne=he;Ne<he+Le;Ne++)S[we][Ne]=null;const xe=K.getAttribute("style");xe&&xe.includes("mso-ignore:colspan")||w.push({col:he,row:O,rowspan:Ce,colspan:Le})}let ve="";a&&/excel/gi.test(a.content)?ve=re.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ve=re.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[O][he]=ve.replace(regEscapedChars,xe=>ESCAPED_HTML_CHARS[xe])}else A.push(re)}}return w.length&&(t.mergeCells=w),A.length&&(t.rowHeaders=A),S.length&&(t.data=S),t}function _classPrivateMethodInitSpec$z(r,e){_checkPrivateRedeclaration$L(r,e),e.add(r)}function _classPrivateFieldInitSpec$y(r,e,t){_checkPrivateRedeclaration$L(r,e),e.set(r,t)}function _checkPrivateRedeclaration$L(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$T(r,e,t){return(e=_toPropertyKey$U(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$U(r){var e=_toPrimitive$U(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$U(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$y(r,e){return r.get(_assertClassBrand$L(r,e))}function _classPrivateFieldSet$w(r,e,t){return r.set(_assertClassBrand$L(r,e),t),t}function _assertClassBrand$L(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterCopyLimit");Hooks.getSingleton().register("modifyCopyableRange");Hooks.getSingleton().register("beforeCut");Hooks.getSingleton().register("afterCut");Hooks.getSingleton().register("beforePaste");Hooks.getSingleton().register("afterPaste");Hooks.getSingleton().register("beforeCopy");Hooks.getSingleton().register("afterCopy");const PLUGIN_KEY$o="copyPaste",PLUGIN_PRIORITY$n=80,SETTING_KEYS$1=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet;class CopyPaste extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$z(this,_CopyPaste_brand),_defineProperty$T(this,"columnsLimit",1/0),_defineProperty$T(this,"rowsLimit",1/0),_defineProperty$T(this,"pasteMode","overwrite"),_defineProperty$T(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec$y(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec$y(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec$y(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec$y(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec$y(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec$y(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec$y(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec$y(this,_preventViewportScrollOnPaste,!1),_defineProperty$T(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$o}static get SETTING_KEYS(){return[PLUGIN_KEY$o,...SETTING_KEYS$1]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$n}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$o]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),_classPrivateFieldSet$w(_enableCopyColumnHeaders,this,this.getSetting("copyColumnHeaders")),_classPrivateFieldSet$w(_enableCopyColumnGroupHeaders,this,this.getSetting("copyColumnGroupHeaders")),_classPrivateFieldSet$w(_enableCopyColumnHeadersOnly,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(t=this.getSetting("uiContainer"))!==null&&t!==void 0?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>_assertClassBrand$L(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions$4).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onAfterSelection).call(n,...o)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand$L(_CopyPaste_brand,this,_onAfterSelectionEnd$1).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),isSafari()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onSafariMouseEnter).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$L(_CopyPaste_brand,n,_onSafariMouseLeave).call(n,...o)}),this.addHook("afterSelection",()=>_assertClassBrand$L(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$w(_copyMode,this,e),_classPrivateFieldSet$w(_isTriggeredByCopy,this,!0),_assertClassBrand$L(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet$w(_isTriggeredByCut,this,!0),_assertClassBrand$L(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(e){return stringify(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:s}=normalizeRanges(e);return arrayEach(n,o=>{const a=[];arrayEach(s,l=>{o<0?a.push(this.hot.getColHeader(l,o)):a.push(this.hot.getCopyableData(o,l))}),t.push(a)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const n=new PasteEvent;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet$y(_copyableRangesFactory,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$y(_copyMode,this)==="column-headers-only"?t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$y(_copyMode,this)==="with-column-headers"?t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$y(_copyMode,this)==="with-column-group-headers"&&t.set("headers",_classPrivateFieldGet$y(_copyableRangesFactory,this).getAllColumnHeadersRange()),t.set("cells",_classPrivateFieldGet$y(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:o,startCol:a,endRow:l,endCol:u}=s;return{startRow:o,startCol:a,endRow:l,endCol:u}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:s,startCol:o,endRow:a,endCol:l}=n;this.hot.runHooks("afterCopyLimit",a-s+1,l-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,s=e[0].length,o=[],{row:a,col:l}=t.getTopStartCorner(),{row:u,col:c}=t.getBottomEndCorner();let h=a,g=l,v=a,m=l;for(;o.length<n||h<=u;){const{skipRowOnPaste:E,visualRow:_}=this.hot.getCellMeta(h,l);if(h=_+1,E===!0)continue;v=_,g=l;const S=[],w=o.length%n;for(;S.length<s||g<=c;){const{skipColumnOnPaste:A,visualCol:O}=this.hot.getCellMeta(a,g);if(g=O+1,A===!0)continue;m=O;const D=S.length%s;S.push(e[w][D])}o.push(S)}return _classPrivateFieldSet$w(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,v,m]}onCopy(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$y(_isTriggeredByCopy,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$w(_isTriggeredByCopy,this,!1);const o=this.getRangedData(this.copyableRanges),a=_assertClassBrand$L(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)){const u=stringify(o);if(e&&e.clipboardData){const c=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[META_HEAD,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}_classPrivateFieldSet$w(_copyMode,this,"cells-only")}onCut(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$y(_isTriggeredByCut,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$w(_isTriggeredByCut,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const l=stringify(o);if(e&&e.clipboardData){const u=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[META_HEAD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==n||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const h=sanitize(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});h&&/(<table)|(<TABLE)/g.test(h)?o=htmlToGridSettings(h,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=parse(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o);this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function _ensureClipboardEventsGetTriggered(r){if(isSafari()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,s=this.hot.getCell(t,n,!0);s&&runWithSelectedContendEditableElement(s,()=>{this.hot.rootDocument.execCommand(r)})}}else this.hot.rootDocument.execCommand(r)}function _countCopiedHeaders(r){const{rows:e}=normalizeRanges(r);let t=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)t+=1;return{columnHeadersCount:t}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const r=this.hot.getSelectedRangeLast();if(r){const{row:e,col:t}=r.highlight,n=this.hot.getCell(e,t,!0);n&&makeElementContentEditableAndSelectItsContent(n)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const r=this.hot.getSelectedRangeLast();if(r){const{row:e,col:t}=r.highlight,n=this.hot.getCell(e,t,!0);n!=null&&n.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(n)}}}function _onAfterContextMenuDefaultOptions$4(r){r.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$y(_enableCopyColumnHeaders,this)&&r.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$y(_enableCopyColumnGroupHeaders,this)&&r.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$y(_enableCopyColumnHeadersOnly,this)&&r.items.push(copyColumnHeadersOnlyItem(this)),r.items.push(cutItem(this))}function _onAfterSelection(r,e,t,n,s){_classPrivateFieldGet$y(_preventViewportScrollOnPaste,this)&&(s.value=!0),_classPrivateFieldSet$w(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd$1(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand$L(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand$L(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand$L(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(r,e){return`border_row${r}col${e}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(r){if(isDefined(r.start)||isDefined(r.left)){var e;r.start=(e=r.start)!==null&&e!==void 0?e:r.left}if(isDefined(r.end)||isDefined(r.right)){var t;r.end=(t=r.end)!==null&&t!==void 0?t:r.right}return delete r.left,delete r.right,r}function denormalizeBorder(r){return isDefined(r.start)&&(r.left=r.start),isDefined(r.end)&&(r.right=r.end),r}function createEmptyBorders(r,e){return{id:createId(r,e),border:createDefaultHtBorder(),row:r,col:e,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(r,e){return hasOwnProperty(e,"border")&&e.border&&(r.border=e.border),hasOwnProperty(e,"top")&&isDefined(e.top)&&(e.top?(isObject$1(e.top)||(e.top=createDefaultCustomBorder()),r.top=e.top):(e.top=createSingleEmptyBorder(),r.top=e.top)),hasOwnProperty(e,"bottom")&&isDefined(e.bottom)&&(e.bottom?(isObject$1(e.bottom)||(e.bottom=createDefaultCustomBorder()),r.bottom=e.bottom):(e.bottom=createSingleEmptyBorder(),r.bottom=e.bottom)),hasOwnProperty(e,"start")&&isDefined(e.start)&&(e.start?(isObject$1(e.start)||(e.start=createDefaultCustomBorder()),r.start=e.start):(e.start=createSingleEmptyBorder(),r.start=e.start)),hasOwnProperty(e,"end")&&isDefined(e.end)&&(e.end?(isObject$1(e.end)||(e.end=createDefaultCustomBorder()),r.end=e.end):(e.end=createSingleEmptyBorder(),r.end=e.end)),r}function checkSelectionBorders(r,e){let t=!1;return arrayEach(r.getSelectedRange(),n=>{n.forAll((s,o)=>{if(s<0||o<0)return;const a=r.getCellMeta(s,o).borders;if(a)if(e){if(!hasOwnProperty(a[e],"hide")||a[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function markSelected(r){return`<span class="selected"></span>${r}`}function hasLeftRightTypeOptions(r){return r.some(e=>isDefined(e.left)||isDefined(e.right))}function hasStartEndTypeOptions(r){return r.some(e=>isDefined(e.start)||isDefined(e.end))}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(r){var e;return(e=physicalToInlinePropNames.get(r))!==null&&e!==void 0?e:r}function bottom(r){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(e=markSelected(e)),e},callback(e,t){const n=checkSelectionBorders(this,"bottom");r.prepareBorder(t,"bottom",n)}}}function left(r){const e=r.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,e)&&(t=markSelected(t)),t},callback(t,n){const s=checkSelectionBorders(this,e);r.prepareBorder(n,e,s)}}}function noBorders(r){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){r.prepareBorder(t,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right(r){const e=r.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,e)&&(t=markSelected(t)),t},callback(t,n){const s=checkSelectionBorders(this,e);r.prepareBorder(n,e,s)}}}function top(r){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(e=markSelected(e)),e},callback(e,t){const n=checkSelectionBorders(this,"top");r.prepareBorder(t,"top",n)}}}function _defineProperty$S(r,e,t){return(e=_toPropertyKey$T(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$T(r){var e=_toPrimitive$T(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$T(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class VisualSelection extends Selection$1{constructor(e,t){super(e,null),_defineProperty$S(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,s=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);return s===null||o===null?null:((s.row>o.row||s.col>o.col)&&(s=t,o=n),this.settings.createCellRange(s,s,o))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(s===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(s,o)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(t,n,s)),a!==null&&e.overlaps(a)){const l=e.highlight.clone();if(l.row>=0&&(l.row=a.row),l.col>=0&&(l.col=a.col),this.cellRange===null){const u=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(t);return n.row===null||n.col===null||s.row===null||s.col===null?null:this.settings.createCellRange(n,n,s)}}function createHighlight$8(r){let{activeHeaderClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight$7(r){let{areaCornerVisible:e,...t}=r;return new VisualSelection({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:AREA_TYPE})}function createHighlight$6(r){let{...e}=r;return new VisualSelection({className:"highlight",...e,selectionType:AREA_TYPE})}function createHighlight$5(r){let{columnClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:COLUMN_TYPE})}function createHighlight$4(r){let{cellCornerVisible:e,...t}=r;return new VisualSelection({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:FOCUS_TYPE})}function createHighlight$3(r){let{border:e,visualCellRange:t,...n}=r;return new VisualSelection({...e,...n,selectionType:CUSTOM_SELECTION_TYPE},t)}function createHighlight$2(r){let{...e}=r;return new VisualSelection({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:FILL_TYPE})}function createHighlight$1(r){let{headerClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:HEADER_TYPE})}function createHighlight(r){let{rowClassName:e,...t}=r;return new VisualSelection({className:e,...t,selectionType:ROW_TYPE})}function _classPrivateMethodInitSpec$y(r,e){_checkPrivateRedeclaration$K(r,e),e.add(r)}function _checkPrivateRedeclaration$K(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$R(r,e,t){return(e=_toPropertyKey$S(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$S(r){var e=_toPrimitive$S(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$S(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$K(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet;class Highlight{constructor(e){_classPrivateMethodInitSpec$y(this,_Highlight_brand),_defineProperty$R(this,"options",void 0),_defineProperty$R(this,"layerLevel",0),_defineProperty$R(this,"focus",void 0),_defineProperty$R(this,"fill",void 0),_defineProperty$R(this,"layeredAreas",new Map),_defineProperty$R(this,"areas",new Map),_defineProperty$R(this,"rowHeaders",new Map),_defineProperty$R(this,"columnHeaders",new Map),_defineProperty$R(this,"activeRowHeaders",new Map),_defineProperty$R(this,"activeColumnHeaders",new Map),_defineProperty$R(this,"activeCornerHeaders",new Map),_defineProperty$R(this,"rowHighlights",new Map),_defineProperty$R(this,"columnHighlights",new Map),_defineProperty$R(this,"customSelections",[]),this.options=e,this.focus=createHighlight$4(e),this.fill=createHighlight$2(e)}isEnabledFor(e,t){let n=e;e===FOCUS_TYPE&&(n="current");let s=this.options.disabledCellSelection(t.row,t.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight$7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight$6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight$1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight$1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight$8)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight$8)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight$8)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand$K(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight$5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(createHighlight$3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach(this.areas.values(),e=>void e.clear()),arrayEach(this.layeredAreas.values(),e=>void e.clear()),arrayEach(this.rowHeaders.values(),e=>void e.clear()),arrayEach(this.columnHeaders.values(),e=>void e.clear()),arrayEach(this.activeRowHeaders.values(),e=>void e.clear()),arrayEach(this.activeColumnHeaders.values(),e=>void e.clear()),arrayEach(this.activeCornerHeaders.values(),e=>void e.clear()),arrayEach(this.rowHighlights.values(),e=>void e.clear()),arrayEach(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _createHighlight(r,e){const t=this.layerLevel;if(r.has(t))return r.get(t);const n=e({layerLevel:t,...this.options});return r.set(t,n),n}function _defineProperty$Q(r,e,t){return(e=_toPropertyKey$R(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$R(r){var e=_toPrimitive$R(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$R(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SelectionRange{constructor(e){_defineProperty$Q(this,"ranges",[]),_defineProperty$Q(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _classPrivateMethodInitSpec$x(r,e){_checkPrivateRedeclaration$J(r,e),e.add(r)}function _classPrivateFieldInitSpec$x(r,e,t){_checkPrivateRedeclaration$J(r,e),e.set(r,t)}function _checkPrivateRedeclaration$J(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$x(r,e){return r.get(_assertClassBrand$J(r,e))}function _classPrivateFieldSet$v(r,e,t){return r.set(_assertClassBrand$J(r,e),t),t}function _assertClassBrand$J(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset=new WeakMap,_Transformation_brand=new WeakSet;class Transformation{constructor(e,t){_classPrivateMethodInitSpec$x(this,_Transformation_brand),_classPrivateFieldInitSpec$x(this,_range,void 0),_classPrivateFieldInitSpec$x(this,_options,void 0),_classPrivateFieldInitSpec$x(this,_offset,{x:0,y:0}),_classPrivateFieldSet$v(_range,this,e),_classPrivateFieldSet$v(_options,this,t)}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=_classPrivateFieldGet$x(_options,this).createCellCoords(e,t);let o=_classPrivateFieldGet$x(_range,this).current().highlight;const a=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(o);let l=0,u=0;if(this.runLocalHooks("beforeTransformStart",s),a.row!==null&&a.col!==null){const{width:c,height:h}=_assertClassBrand$J(_Transformation_brand,this,_getTableSize).call(this),{row:g,col:v}=_assertClassBrand$J(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,o),m=_classPrivateFieldGet$x(_options,this).fixedRowsBottom(),E=_classPrivateFieldGet$x(_options,this).minSpareRows(),_=_classPrivateFieldGet$x(_options,this).minSpareCols(),S=_classPrivateFieldGet$x(_options,this).autoWrapRow(),w=_classPrivateFieldGet$x(_options,this).autoWrapCol(),A=_classPrivateFieldGet$x(_options,this).createCellCoords(g+s.row,v+s.col);if(A.row>=h){const Y=createObjectPropListener(n&&E>0&&m===0),H=A.col+1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(A.row-h,H>=c?H-c:H);this.runLocalHooks("beforeColumnWrap",Y,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),H>=c),Y.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet$x(_options,this).countRenderableRows()):w&&A.assign(k)}else if(A.row<0){const Y=createObjectPropListener(w),H=A.col-1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(h+A.row,H<0?c+H:H);this.runLocalHooks("beforeColumnWrap",Y,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),H<0),w&&A.assign(k)}if(A.col>=c){const Y=createObjectPropListener(n&&_>0),H=A.row+1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(H>=h?H-h:H,A.col-c);this.runLocalHooks("beforeRowWrap",Y,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),H>=h),Y.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet$x(_options,this).countRenderableColumns()):S&&A.assign(k)}else if(A.col<0){const Y=createObjectPropListener(S),H=A.row-1,k=_classPrivateFieldGet$x(_options,this).createCellCoords(H<0?h+H:H,c+A.col);this.runLocalHooks("beforeRowWrap",Y,_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,k),H<0),S&&A.assign(k)}const{rowDir:O,colDir:D}=_assertClassBrand$J(_Transformation_brand,this,_clampCoords).call(this,A);l=O,u=D,o=_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,A)}return this.runLocalHooks("afterTransformStart",o,l,u),o}transformEnd(e,t){const n=_classPrivateFieldGet$x(_options,this).createCellCoords(e,t),s=_classPrivateFieldGet$x(_range,this).current(),o=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(s.highlight),a=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,s.to.row,s.from.row),l=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,s.to.col,s.from.col),u=s.to.clone();let c=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&a!==null&&l!==null){const{row:g,col:v}=_assertClassBrand$J(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,s.highlight),m=_classPrivateFieldGet$x(_options,this).createCellCoords(a+n.row,l+n.col),E=s.getTopStartCorner(),_=s.getTopEndCorner(),S=s.getBottomEndCorner();if(n.col<0&&l>=v&&m.col<v){const D=m.col-v;m.col=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,E.col,_.col)+D}else if(n.col>0&&l<=v&&m.col>v){const D=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,_.col,E.col),Y=Math.max(m.col-D,1);m.col=D+Y}if(n.row<0&&a>=g&&m.row<g){const D=m.row-g;m.row=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,E.row,S.row)+D}else if(n.row>0&&a<=g&&m.row>g){const D=_assertClassBrand$J(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,S.row,E.row),Y=Math.max(m.row-D,1);m.row=D+Y}const{rowDir:w,colDir:A}=_assertClassBrand$J(_Transformation_brand,this,_clampCoords).call(this,m);c=w,h=A;const O=_assertClassBrand$J(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,m);n.row===0&&n.col!==0?u.col=O.col:n.row!==0&&n.col===0?u.row=O.row:(u.row=O.row,u.col=O.col)}return this.runLocalHooks("afterTransformEnd",u,c,h),u}setOffsetSize(e){let{x:t,y:n}=e;_classPrivateFieldSet$v(_offset,this,{x:t,y:n})}resetOffsetSize(){_classPrivateFieldSet$v(_offset,this,{x:0,y:0})}}function _clampCoords(r){const{width:e,height:t}=_assertClassBrand$J(_Transformation_brand,this,_getTableSize).call(this);let n=0,s=0;return r.row<0?(n=-1,r.row=0):r.row>0&&r.row>=t&&(n=1,r.row=t-1),r.col<0?(s=-1,r.col=0):r.col>0&&r.col>=e&&(s=1,r.col=e-1),{rowDir:n,colDir:s}}function _getTableSize(){return{width:_classPrivateFieldGet$x(_offset,this).x+_classPrivateFieldGet$x(_options,this).countRenderableColumns(),height:_classPrivateFieldGet$x(_offset,this).y+_classPrivateFieldGet$x(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(r,e){const t=_classPrivateFieldGet$x(_options,this).findFirstNonHiddenRenderableRow(r,e);return t===null?null:_classPrivateFieldGet$x(_offset,this).y+t}function _findFirstNonHiddenZeroBasedColumn(r,e){const t=_classPrivateFieldGet$x(_options,this).findFirstNonHiddenRenderableColumn(r,e);return t===null?null:_classPrivateFieldGet$x(_offset,this).x+t}function _visualToZeroBasedCoords(r){const{row:e,col:t}=_classPrivateFieldGet$x(_options,this).visualToRenderableCoords(r);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return _classPrivateFieldGet$x(_options,this).createCellCoords(_classPrivateFieldGet$x(_offset,this).y+e,_classPrivateFieldGet$x(_offset,this).x+t)}function _zeroBasedToVisualCoords(r){const e=r.clone();return e.col=r.col-_classPrivateFieldGet$x(_offset,this).x,e.row=r.row-_classPrivateFieldGet$x(_offset,this).y,_classPrivateFieldGet$x(_options,this).renderableToVisualCoords(e)}mixin(Transformation,localHooks);function _classPrivateFieldInitSpec$w(r,e,t){_checkPrivateRedeclaration$I(r,e),e.set(r,t)}function _checkPrivateRedeclaration$I(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$P(r,e,t){return(e=_toPropertyKey$Q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$Q(r){var e=_toPrimitive$Q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$Q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$w(r,e){return r.get(_assertClassBrand$I(r,e))}function _classPrivateFieldSet$u(r,e,t){return r.set(_assertClassBrand$I(r,e),t),t}function _assertClassBrand$I(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap;class Selection{constructor(e,t){var n=this;_defineProperty$P(this,"settings",void 0),_defineProperty$P(this,"tableProps",void 0),_defineProperty$P(this,"inProgress",!1),_defineProperty$P(this,"selectedRange",new SelectionRange((s,o,a)=>this.tableProps.createCellRange(s,o,a))),_defineProperty$P(this,"highlight",void 0),_classPrivateFieldInitSpec$w(this,_transformation,void 0),_classPrivateFieldInitSpec$w(this,_focusTransformation,void 0),_defineProperty$P(this,"selectedByRowHeader",new Set),_defineProperty$P(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec$w(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec$w(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec$w(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec$w(this,_expectedLayersCount,-1),this.settings=e,this.tableProps=t,this.highlight=new Highlight({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(s,o)=>this.tableProps.isDisabledCellSelection(s,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),createCellRange:(s,o,a)=>this.tableProps.createCellRange(s,o,a)}),_classPrivateFieldSet$u(_transformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),_classPrivateFieldSet$u(_focusTransformation,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformStart",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformStart",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformEnd",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("insertRowRequire",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("insertRowRequire",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("insertColRequire",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("insertColRequire",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeRowWrap",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeRowWrap",...o)}),_classPrivateFieldGet$w(_transformation,this).addLocalHook("beforeColumnWrap",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeColumnWrap",...o)}),_classPrivateFieldGet$w(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),_classPrivateFieldGet$w(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){_classPrivateFieldSet$u(_selectionSource,this,e)}markEndSource(){_classPrivateFieldSet$u(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet$w(_selectionSource,this)}setExpectedLayers(e){_classPrivateFieldSet$u(_expectedLayersCount,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet$u(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=isUndefined$1(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,l=e.clone();_classPrivateFieldSet$u(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,l),(!o||o&&!a&&isUndefined$1(t))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(s.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||s>0)&&(n===0&&t.col<0&&!o||s===0&&t.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(t),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}n>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const l=_classPrivateFieldGet$w(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet$w(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),s=this.tableProps.countCols();t<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),E=>void E.clear()),arrayEach(this.highlight.getLayeredAreas(),E=>void E.clear()),arrayEach(this.highlight.getRowHeaders(),E=>void E.clear()),arrayEach(this.highlight.getColumnHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveRowHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveColumnHeaders(),E=>void E.clear()),arrayEach(this.highlight.getActiveCornerHeaders(),E=>void E.clear()),arrayEach(this.highlight.getRowHighlights(),E=>void E.clear()),arrayEach(this.highlight.getColumnHighlights(),E=>void E.clear())),this.highlight.useLayerLevel(t);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),g.clear(),v.clear(),m.clear(),this.highlight.isEnabledFor(AREA_TYPE,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),t===1)){const E=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(E.from).commit().syncWith(E),this.highlight.createLayeredArea().add(E.from).commit().syncWith(E),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(HEADER_TYPE,e.highlight)){if(!e.isSingleHeader()){const S=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),w=this.tableProps.createCellCoords(e.to.row,-1),A=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),O=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(l.add(S).commit(),u.add(A).commit(),v.add(S).commit(),m.add(A).commit()):(l.add(S).add(w).commit(),u.add(A).add(O).commit(),v.add(S).add(w).commit(),m.add(A).add(O).commit())}const E=!_classPrivateFieldGet$w(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(s>0&&s===e.getWidth()||s===0&&this.isSelectedByRowHeader()),_=!_classPrivateFieldGet$w(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());E&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),_&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),E&&_&&g.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(_classPrivateFieldSet$u(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_classPrivateFieldGet$w(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$w(_transformation,this).resetOffsetSize(),this.setRangeStart(_classPrivateFieldGet$w(_transformation,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?_classPrivateFieldGet$w(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$w(_transformation,this).resetOffsetSize(),this.setRangeEnd(_classPrivateFieldGet$w(_transformation,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:s,col:o}=n.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,o-1),l=this.tableProps.countRenderableRowsInRange(0,s-1);n.highlight.isHeader()?_classPrivateFieldGet$w(_focusTransformation,this).setOffsetSize({x:o<0?Math.abs(o):-a,y:s<0?Math.abs(s):-l}):_classPrivateFieldGet$w(_focusTransformation,this).setOffsetSize({x:o<0?0:-a,y:s<0?0:-l});const u=_classPrivateFieldGet$w(_focusTransformation,this).transformStart(e,t);this.setRangeFocus(u.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:s,to:o,highlight:a}=n,l=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),h=c?-1:0,g=c?0:t;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(clamp(s.row+g,h,l-1),s.col),m=this.tableProps.createCellCoords(clamp(o.row+t,h,l-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(clamp(a.row+t,0,l-1),a.col)):this.setRangeStartOnly(v,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:s,to:o,highlight:a}=n,l=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),h=u?-1:0,g=u?0:t;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(s.row,clamp(s.col+g,h,l-1)),m=this.tableProps.createCellCoords(o.row,clamp(o.col+t,h,l-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(a.row,clamp(a.col+t,0,l-1))):this.setRangeStartOnly(v,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet$w(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{col:o}=s.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(a>0&&o<0||a===0)&&s.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{row:o}=s.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(a>0&&o<0||a===0)&&s.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),c=n?-u:0,h=t?-l:0;if(c===0&&h===0&&(o===0||a===0))return;let g=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:v,disableHeadersHighlight:m}=s;_classPrivateFieldSet$u(_disableHeadersHighlight,this,m),v&&Number.isInteger(v==null?void 0:v.row)&&Number.isInteger(v==null?void 0:v.col)&&(g=this.tableProps.createCellCoords(clamp(v.row,c,o-1),clamp(v.col,h,a-1)));const E=this.tableProps.createCellCoords(c,h),_=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.setRangeStartOnly(E,void 0,g),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.finish(),_classPrivateFieldSet$u(_disableHeadersHighlight,this,!1)}selectCells(e){var t=this;const n=detectSelectionType(e);if(n===SELECTION_TYPE_EMPTY)return!1;if(n===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=normalizeSelectionFactory(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},l=!e.some(u=>{const c=s(u),h=c.isValid(a);return!(h&&!c.containsHeaders()||h&&c.containsHeaders()&&c.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),arrayEach(e,u=>{const{from:c,to:h}=s(u);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(h.clone())}),this.finish()),l}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countRows(),l=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),c=u===0?0:-u,h=this.tableProps.createCellCoords(c,s),g=this.tableProps.createCellCoords(a-1,o),v=this.tableProps.createCellRange(h,h,g).isValid({countRows:a,countCols:l,countRowHeaders:0,countColHeaders:u});if(v){let m=0,E=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(m=clamp(n.row,c,a-1),E=clamp(n.col,Math.min(s,o),Math.max(s,o))):(m=clamp(n,c,a-1),E=s);const _=this.tableProps.createCellCoords(m,E),S=u===0?0:clamp(_.row,c,-1),w=a-1,A=this.tableProps.createCellCoords(S,s),O=this.tableProps.createCellCoords(w,o);this.runLocalHooks("beforeSelectColumns",A,O,_),A.row=S,O.row=w,this.setRangeStartOnly(A,void 0,_),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.runLocalHooks("afterSelectColumns",A,O,_),this.finish()}return v}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=a===0?0:-a,u=this.tableProps.createCellCoords(e,l),c=this.tableProps.createCellCoords(t,o-1),h=this.tableProps.createCellRange(u,u,c).isValid({countRows:s,countCols:o,countRowHeaders:a,countColHeaders:0});if(h){let g=0,v=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(g=clamp(n.row,Math.min(e,t),Math.max(e,t)),v=clamp(n.col,l,o-1)):(g=e,v=clamp(n,l,o-1));const m=this.tableProps.createCellCoords(g,v),E=a===0?0:clamp(m.col,l,-1),_=o-1,S=this.tableProps.createCellCoords(e,E),w=this.tableProps.createCellCoords(t,_);this.runLocalHooks("beforeSelectRows",S,w,m),S.col=E,w.col=_,this.setRangeStartOnly(S,void 0,m),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",S,w,m),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:s,to:o,highlight:a}=n;this.clear(),a.assign({row:clamp(a.row,-1/0,e-1),col:clamp(a.col,-1/0,t-1)}),s.assign({row:clamp(s.row,-1/0,e-1),col:clamp(s.col,-1/0,t-1)}),o.assign({row:clamp(o.row,0,e-1),col:clamp(o.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(a).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const t=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(FOCUS_TYPE,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),g.commit(),v.commit(),m.commit()}this.highlight.useLayerLevel(t)}}mixin(Selection,localHooks);function mouseDown(r){let{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:s,selection:o,controller:a,cellCoordsFactory:l}=r;const u=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),h=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&u)s.row>=0&&s.col>=0&&!a.cell?o.setRangeEnd(s):(c||h)&&s.row>=0&&s.col>=0&&!a.cell?o.setRangeEnd(l(s.row,s.col)):c&&s.row<0&&!a.column?o.setRangeEnd(l(u.to.row,s.col)):h&&s.col<0&&!a.row?o.setRangeEnd(l(s.row,u.to.col)):(!c&&!h&&s.col<0||c&&s.col<0)&&!a.row?o.selectRows(Math.max(u.from.row,0),s.row,s.col):(!c&&!h&&s.row<0||h&&s.row<0)&&!a.column&&o.selectColumns(Math.max(u.from.col,0),s.col,s.row);else{const g=!o.inInSelection(s),v=t||n&&g;s.row<0&&s.col>=0&&!a.column?v&&o.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!a.row?v&&o.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!a.cell?v&&o.setRangeStart(s):s.col<0&&s.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function mouseOver(r){let{isLeftClick:e,coords:t,selection:n,controller:s,cellCoordsFactory:o}=r;if(!e)return;const a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),u=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),l&&!s.column?n.setRangeEnd(o(c-1,t.col)):a&&!s.row?n.setRangeEnd(o(t.row,u-1)):s.cell||n.setRangeEnd(t),n.markEndSource()}const handlers=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(r,e){let{coords:t,selection:n,controller:s,cellCoordsFactory:o}=e;handlers.get(r.type)({coords:t,selection:n,controller:s,cellCoordsFactory:o,isShiftKey:r.shiftKey,isLeftClick:isLeftClick(r)||r.type==="touchstart",isRightClick:isRightClick(r)})}function _classPrivateMethodInitSpec$w(r,e){_checkPrivateRedeclaration$H(r,e),e.add(r)}function _checkPrivateRedeclaration$H(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$O(r,e,t){return(e=_toPropertyKey$P(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$P(r){var e=_toPrimitive$P(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$P(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$H(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$n="customBorders",PLUGIN_PRIORITY$m=90;var _CustomBorders_brand=new WeakSet;class CustomBorders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$w(this,_CustomBorders_brand),_defineProperty$O(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$n}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$m}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$n]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$H(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions$3).call(this,e)),this.addHook("init",()=>_assertClassBrand$H(_CustomBorders_brand,this,_onAfterInit$2).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),s=normalizeBorder(t));const o=detectSelectionType(e),a=normalizeSelectionFactory(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach(e,l=>{a(l).forAll((u,c)=>{arrayEach(n,h=>{this.prepareBorderFromCustomAdded(u,c,s,toInlinePropName(h))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=detectSelectionType(e),n=normalizeSelectionFactory(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return arrayEach(e,o=>{n(o).forAll((a,l)=>{arrayEach(this.savedBorders,u=>{u.row===a&&u.col===l&&s.push(denormalizeBorder(u))})})}),s}clearBorders(e){e?this.setBorders(e):(arrayEach(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,n,s){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||t>=a)return;let l=createEmptyBorders(e,t);n&&(l=extendDefaultBorder(l,n),arrayEach(this.hot.selection.highlight.customSelections,u=>{if(l.id===u.settings.id)return Object.assign(u.settings,n),l.id=u.settings.id,l.top=u.settings.top,l.bottom=u.settings.bottom,l.start=u.settings.start,l.end=u.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(l)),this.insertBorderIntoSettings(l,s)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);rangeEach(e.from.row,n,o=>{rangeEach(e.from.col,s,a=>{const l=createEmptyBorders(o,a);let u=0;o===e.from.row&&hasOwnProperty(t,"top")&&(u+=1,l.top=t.top),o===e.to.row&&hasOwnProperty(t,"bottom")&&(u+=1,l.bottom=t.bottom),a===e.from.col&&hasOwnProperty(t,"start")&&(u+=1,l.start=t.start),a===e.to.col&&hasOwnProperty(t,"end")&&(u+=1,l.end=t.end),u>0&&(this.hot.setCellMeta(o,a,"borders",denormalizeBorder(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,t){const n=createId(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,s){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=createEmptyBorders(e,t):o=normalizeBorder(o),s?(o[n]=createSingleEmptyBorder(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,n,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))):(o[n]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(o,n,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))}prepareBorder(e,t,n){arrayEach(e,s=>{let{start:o,end:a}=s;if(o.row===a.row&&o.col===a.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":rangeEach(o.col,a.col,l=>{rangeEach(o.row,a.row,u=>{this.removeAllBorders(u,l)})});break;case"top":rangeEach(o.col,a.col,l=>{this.setBorder(o.row,l,t,n)});break;case"bottom":rangeEach(o.col,a.col,l=>{this.setBorder(a.row,l,t,n)});break;case"start":rangeEach(o.row,a.row,l=>{this.setBorder(l,o.col,t,n)});break;case"end":rangeEach(o.row,a.row,l=>{this.setBorder(l,a.col,t,n)});break}})}createCustomBorders(e){arrayEach(e,t=>{const n=normalizeBorder(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,n):this.prepareBorderFromCustomAdded(t.row,t.col,n)})}countHide(e){const{top:t,bottom:n,start:s,end:o}=e;return arrayReduce([t,n,s,o],(l,u)=>{let c=l;return u&&u.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const t=arrayMap(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){arrayEach(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){arrayEach(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=arrayMap(this.savedBorders,n=>n.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):arrayEach(this.savedBorders,(s,o)=>{if(e.id===s.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,n){let s=!1;return arrayEach(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return arrayEach(a,l=>{l.toggleHiddenClass(t,n)}),s=!0,!1}}),s}checkCustomSelections(e,t,n){const s=this.countHide(e);let o=!1;return s===4?(this.removeAllBorders(e.row,e.col),o=!0):arrayEach(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=t,a.commit(),n){const l=this.hot.view._wt.selectionManager.getBorderInstances(a);arrayEach(l,u=>{u.changeBorderStyle(n,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[PLUGIN_KEY$n];if(Array.isArray(e)){const t=deepClone(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=hasLeftRightTypeOptions(e),n=hasStartEndTypeOptions(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _onAfterContextMenuDefaultOptions$3(r){this.hot.getSettings()[PLUGIN_KEY$n]&&r.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top(this),right(this),bottom(this),left(this),noBorders(this)]}})}function _onAfterInit$2(){this.changeBorderSettings()}function _classPrivateMethodInitSpec$v(r,e){_checkPrivateRedeclaration$G(r,e),e.add(r)}function _checkPrivateRedeclaration$G(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$N(r,e,t){return(e=_toPropertyKey$O(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$O(r){var e=_toPrimitive$O(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$O(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$G(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$m="dragToScroll",PLUGIN_PRIORITY$l=100;var _DragToScroll_brand=new WeakSet;class DragToScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$v(this,_DragToScroll_brand),_defineProperty$N(this,"boundaries",null),_defineProperty$N(this,"callback",null),_defineProperty$N(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$m}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$l}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$m]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_assertClassBrand$G(_DragToScroll_brand,this,_setupListening).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$G(_DragToScroll_brand,this,_setupListening).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",n=>this.onMouseMove(n)),t=getParentWindow(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function _setupListening(r){if(isRightClick(r))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,n)=>{var s,o;const a=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,l=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(a+Math.sign(t)*50,l+Math.sign(n)*20)}),this.listen()}function _classPrivateMethodInitSpec$u(r,e){_checkPrivateRedeclaration$F(r,e),e.add(r)}function _classPrivateFieldInitSpec$v(r,e,t){_checkPrivateRedeclaration$F(r,e),e.set(r,t)}function _checkPrivateRedeclaration$F(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$M(r,e,t){return(e=_toPropertyKey$N(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$N(r){var e=_toPrimitive$N(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$N(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$v(r,e){return r.get(_assertClassBrand$F(r,e))}function _classPrivateFieldSet$t(r,e,t){return r.set(_assertClassBrand$F(r,e),t),t}function _assertClassBrand$F(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterDropdownMenuDefaultOptions");Hooks.getSingleton().register("beforeDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuShow");Hooks.getSingleton().register("afterDropdownMenuHide");Hooks.getSingleton().register("afterDropdownMenuExecute");const PLUGIN_KEY$l="dropdownMenu",PLUGIN_PRIORITY$k=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP$6=PLUGIN_KEY$l;var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet;class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$l}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$k}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$9,KEY$8,KEY$c,KEY$5,KEY$c,KEY$a,KEY$c,KEY$7,KEY$c,KEY$b]}constructor(e){super(e),_classPrivateMethodInitSpec$u(this,_DropdownMenu_brand),_defineProperty$M(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$M(this,"itemsFactory",null),_defineProperty$M(this,"menu",null),_classPrivateFieldInitSpec$v(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$F(_DropdownMenu_brand,this,_onAfterGetColHeader$2).call(this,t,n))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$l]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$F(_DropdownMenu_brand,e,_onBeforeOnCellMouseDown$4).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$F(_DropdownMenu_brand,e,_onBeforeViewportScrollHorizontally$1).call(e,...o)});const t=this.hot.getSettings()[PLUGIN_KEY$l],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>_assertClassBrand$F(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,o)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$F(_DropdownMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.executeCommand.call(e,...a)}),arrayEach(s,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),o=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,s.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),l=a.getBoundingClientRect();this.open({left:l.left+o.left,top:l.top+a.offsetHeight+o.top},{left:l.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var n;const s=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP$6},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var n;const s=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$6}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$6)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_assertClassBrand$F(_DropdownMenu_brand,this,_onTableClick).call(this,e))}open(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),objectEach(n,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _addCustomShortcuts(r){r.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(r){if(hasClass$1(r.target,BUTTON_CLASS_NAME)){const e=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),t=r.target.getBoundingClientRect();r.stopPropagation(),_classPrivateFieldSet$t(_isButtonClicked,this,!1),this.open({left:t.left+e.left,top:t.top+r.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function _onAfterGetColHeader$2(r,e){const t=e.parentNode;if(!t)return;const n=t.parentNode.childNodes,s=Array.prototype.indexOf.call(n,t);if(r<0||s!==n.length-1)return;const o=e.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=BUTTON_CLASS_NAME,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(a,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(e,[A11Y_HASPOPUP("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function _onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand$F(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(r){_assertClassBrand$F(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,r)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally$1(r){return _classPrivateFieldGet$v(_isButtonClicked,this)?null:r}function _onBeforeOnCellMouseDown$4(r){hasClass$1(r.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet$t(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY$c};function _defineProperty$L(r,e,t){return(e=_toPropertyKey$M(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$M(r){var e=_toPrimitive$M(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$M(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataProvider{constructor(e){_defineProperty$L(this,"hot",void 0),_defineProperty$L(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:s}=this._getDataRange(),o=this.options,a=[];return rangeEach(e,n,l=>{const u=[];!o.exportHiddenRows&&this._isHiddenRow(l)||(rangeEach(t,s,c=>{!o.exportHiddenColumns&&this._isHiddenColumn(c)||u.push(this.hot.getDataAtCell(l,c))}),a.push(u))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),s=this.hot.getRowHeader();rangeEach(t,n,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(s[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),s=this.hot.getColHeader();rangeEach(t,n,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(s[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,s=0,o=t,a=e]=this.options.range;return n=Math.max(n,0),s=Math.max(s,0),o=Math.min(o,t),a=Math.min(a,e),{startRow:n,startCol:s,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function _defineProperty$K(r,e,t){return(e=_toPropertyKey$L(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$L(r){var e=_toPrimitive$L(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$L(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){_defineProperty$K(this,"dataProvider",void 0),_defineProperty$K(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=clone$1(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=extend$1(clone$1(BaseType.DEFAULT_OPTIONS),t),t=extend$1(t,e),t.filename=substitute(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`;class Csv extends BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const s=n.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let l=e.bom?"\uFEFF":"";return s&&(n=arrayMap(n,u=>this._escapeCell(u,!0)),a&&(l+=e.columnDelimiter),l+=n.join(e.columnDelimiter),l+=e.rowDelimiter),arrayEach(t,(u,c)=>{c>0&&(l+=e.rowDelimiter),a&&(l+=this._escapeCell(o[c])+e.columnDelimiter),l+=u.map(h=>this._escapeCell(h)).join(e.columnDelimiter)}),l}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=stringify$1(e);return n!==""&&(t||n.indexOf(CHAR_CARRIAGE_RETURN)>=0||n.indexOf(CHAR_DOUBLE_QUOTES)>=0||n.indexOf(CHAR_LINE_FEED)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:Csv};function typeFactory(r,e,t){return typeof EXPORT_TYPES[r]=="function"?new EXPORT_TYPES[r](e,t):null}const PLUGIN_KEY$k="exportFile",PLUGIN_PRIORITY$j=240;class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$k}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$j}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:s}=this.hot,o=this._createTypeFormatter(e,t),a=this._createBlob(o),l=s.URL||s.webkitURL,u=n.createElement("a"),c=`${o.options.filename}.${o.options.fileExtension}`;if(u.download!==void 0){const h=l.createObjectURL(a);u.style.display="none",u.setAttribute("href",h),u.setAttribute("download",c),n.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),n.body.removeChild(u),setTimeout(()=>{l.revokeObjectURL(h)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,c)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error(`Export format type "${e}" is not supported.`);return typeFactory(e,new DataProvider(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function _defineProperty$J(r,e,t){return(e=_toPropertyKey$K(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$K(r){var e=_toPrimitive$K(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$K(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseComponent{constructor(e,t){let{id:n,stateless:s=!0}=t;_defineProperty$J(this,"hot",void 0),_defineProperty$J(this,"id",void 0),_defineProperty$J(this,"elements",[]),_defineProperty$J(this,"hidden",!1),_defineProperty$J(this,"stateId",""),_defineProperty$J(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mixin(BaseComponent,localHooks);const conditions={};function getCondition(r,e){if(!conditions[r])throw Error(`Filter condition "${r}" does not exist.`);const{condition:t,descriptor:n}=conditions[r];let s=e;return n.inputValuesDecorator&&(s=n.inputValuesDecorator(s)),function(o){return t.apply(o.meta.instance,[].concat([o],[s]))}}function getConditionDescriptor(r){if(!conditions[r])throw Error(`Filter condition "${r}" does not exist.`);return conditions[r].descriptor}function registerCondition(r,e,t){t.key=r,conditions[r]={condition:e,descriptor:t}}const CONDITION_NAME$k="none";function condition$k(){return!0}registerCondition(CONDITION_NAME$k,condition$k,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const CONDITION_NAME$j="empty";function condition$j(r){return isEmpty$1(r.value)}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$i="not_empty";function condition$i(r,e){return!getCondition(CONDITION_NAME$j,e)(r)}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$h="eq";function condition$h(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale)===stringify$1(t)}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$g="neq";function condition$g(r,e){return!getCondition(CONDITION_NAME$h,e)(r)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$f="gt";function condition$f(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value>n}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$e="gte";function condition$e(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value>=n}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$d="lt";function condition$d(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value<n}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$c="lte";function condition$c(r,e){let[t]=e,n=t;return r.meta.type==="numeric"&&(n=parseFloat(n,10)),r.value<=n}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$b="date_after";function condition$b(r,e){let[t]=e;const n=hooks(r.value,r.meta.dateFormat),s=hooks(t,r.meta.dateFormat);return!n.isValid()||!s.isValid()?!1:n.diff(s)>=0}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});const CONDITION_NAME$a="date_before";function condition$a(r,e){let[t]=e;const n=hooks(r.value,r.meta.dateFormat),s=hooks(t,r.meta.dateFormat);return!n.isValid()||!s.isValid()?!1:n.diff(s)<=0}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const CONDITION_NAME$9="between";function condition$9(r,e){let[t,n]=e,s=t,o=n;if(r.meta.type==="numeric"){const a=parseFloat(s,10),l=parseFloat(o,10);s=Math.min(a,l),o=Math.max(a,l)}else if(r.meta.type==="date"){const a=getCondition(CONDITION_NAME$a,[o]),l=getCondition(CONDITION_NAME$b,[s]);return a(r)&&l(r)}return r.value>=s&&r.value<=o}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$8="not_between";function condition$8(r,e){return!getCondition(CONDITION_NAME$9,e)(r)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$7="begins_with";function condition$7(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).startsWith(stringify$1(t))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$6="ends_with";function condition$6(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).endsWith(stringify$1(t))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$5="contains";function condition$5(r,e){let[t]=e;return stringify$1(r.value).toLocaleLowerCase(r.meta.locale).indexOf(stringify$1(t))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const CONDITION_NAME$4="not_contains";function condition$4(r,e){return!getCondition(CONDITION_NAME$5,e)(r)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});const CONDITION_NAME$3="date_tomorrow";function condition$3(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});const CONDITION_NAME$2="date_today";function condition$2(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});const CONDITION_NAME$1="date_yesterday";function condition$1(r){const e=hooks(r.value,r.meta.dateFormat);return e.isValid()?e.isSame(hooks().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});getComparisonFunction();function toVisualValue(r,e){let t=r;return t===""&&(t=`(${e})`),t}const SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&typeof Array.from=="function";function createArrayAssertion(r){let e=r;return SUPPORT_SET_CONSTRUCTOR&&(e=new Set(e)),function(t){let n;return SUPPORT_SET_CONSTRUCTOR?n=e.has(t):n=!!~e.indexOf(t),n}}function toEmptyString(r){return r??""}function unifyColumnValues(r){let e=r;return SUPPORT_FAST_DEDUPE?e=Array.from(new Set(e)):e=arrayUnique(e),e=e.sort((t,n)=>typeof t=="number"&&typeof n=="number"?t-n:t===n?0:t>n?1:-1),e}function intersectValues(r,e,t,n){const s=[],o=r===e;let a;return o||(a=createArrayAssertion(e)),arrayEach(r,l=>{let u=!1;(o||a(l))&&(u=!0);const c={checked:u,value:l,visualValue:toVisualValue(l,t)};n&&n(c),s.push(c)}),s}const CONDITION_NAME="by_value";function condition(r,e){let[t]=e;return t(r.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator(r){let[e]=r;return[createArrayAssertion(e)]},showOperators:!1});const operations={};function getOperationFunc(r){if(!operations[r])throw Error(`Operation with id "${r}" does not exist.`);const e=operations[r].func;return function(t,n){return e(t,n)}}function getOperationName(r){return operations[r].name}function registerOperation(r,e,t){operations[r]={name:e,func:t}}const OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(r,e){return r.every(t=>t.func(e))}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);const OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(r,e){return r.some(t=>t.func(e))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);const OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(r,e){if(r.length<3)throw Error("Operation doesn't work on less then three conditions.");return r.slice(0,r.length-1).some(t=>t.func(e))&&r[r.length-1].func(e)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$f,CONDITION_NAME$e,CONDITION_NAME$d,CONDITION_NAME$c,CONDITION_NAME$9,CONDITION_NAME$8],[TYPE_TEXT]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$7,CONDITION_NAME$6,KEY$c,CONDITION_NAME$5,CONDITION_NAME$4],[TYPE_DATE]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$a,CONDITION_NAME$b,CONDITION_NAME$9,KEY$c,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]};function getOptionsList(r){const e=[];let t=r;return TYPES[t]||(t=TYPE_TEXT),arrayEach(TYPES[t],n=>{let s;n===KEY$c?s={name:KEY$c}:s=clone$1(getConditionDescriptor(n)),e.push(s)}),e}function _defineProperty$I(r,e,t){return(e=_toPropertyKey$J(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$J(r){var e=_toPrimitive$J(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$J(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];let BaseUI$3=class _c{static get DEFAULTS(){return clone$1({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){_defineProperty$I(this,"hot",void 0),_defineProperty$I(this,"eventManager",new EventManager(this)),_defineProperty$I(this,"options",void 0),_defineProperty$I(this,"_element",void 0),_defineProperty$I(this,"buildState",void 0),this.hot=e,this.options=extend$1(_c.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}isBuilt(){return this.buildState===STATE_BUILT$2}translateIfPossible(e){return typeof e=="string"&&e.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,n)=>{this.eventManager.addEventListener(t,n,s=>this.runLocalHooks(n,s,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass$1(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),objectEach(this.options,(n,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(n))}),this._element.appendChild(t),arrayEach(EVENTS_TO_REGISTER,n=>e(t,n))}else arrayEach(EVENTS_TO_REGISTER,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI$3,localHooks);function _classPrivateMethodInitSpec$t(r,e){_checkPrivateRedeclaration$E(r,e),e.add(r)}function _classPrivateFieldInitSpec$u(r,e,t){_checkPrivateRedeclaration$E(r,e),e.set(r,t)}function _checkPrivateRedeclaration$E(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$u(r,e){return r.get(_assertClassBrand$E(r,e))}function _classPrivateFieldSet$s(r,e,t){return r.set(_assertClassBrand$E(r,e),t),t}function _assertClassBrand$E(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _input$1=new WeakMap,_InputUI_brand=new WeakSet;class InputUI extends BaseUI$3{static get DEFAULTS(){return clone$1({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,extend$1(InputUI.DEFAULTS,t)),_classPrivateMethodInitSpec$t(this,_InputUI_brand),_classPrivateFieldInitSpec$u(this,_input$1,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>_assertClassBrand$E(_InputUI_brand,this,_onKeyup).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");_classPrivateFieldSet$s(_input$1,this,this._element.firstChild),addClass$1(this._element,"htUIInput"),addClass$1(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$u(_input$1,this).type=this.options.type,_classPrivateFieldGet$u(_input$1,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet$u(_input$1,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet$u(_input$1,this).focus()}}function _onKeyup(r){this.options.value=r.target.value}function _classPrivateMethodInitSpec$s(r,e){_checkPrivateRedeclaration$D(r,e),e.add(r)}function _classPrivateFieldInitSpec$t(r,e,t){_checkPrivateRedeclaration$D(r,e),e.set(r,t)}function _checkPrivateRedeclaration$D(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$r(r,e,t){return r.set(_assertClassBrand$D(r,e),t),t}function _classPrivateFieldGet$t(r,e){return r.get(_assertClassBrand$D(r,e))}function _assertClassBrand$D(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items$1=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet;class SelectUI extends BaseUI$3{static get DEFAULTS(){return clone$1({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,extend$1(SelectUI.DEFAULTS,t)),_classPrivateMethodInitSpec$s(this,_SelectUI_brand),_classPrivateFieldInitSpec$t(this,_menu,null),_classPrivateFieldInitSpec$t(this,_items$1,[]),_classPrivateFieldInitSpec$t(this,_caption,void 0),_classPrivateFieldInitSpec$t(this,_captionElement,void 0),_classPrivateFieldInitSpec$t(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet$t(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand$D(_SelectUI_brand,this,_onClick).call(this))}setItems(e){_classPrivateFieldSet$r(_items$1,this,this.translateNames(e)),_classPrivateFieldGet$t(_menu,this)&&_classPrivateFieldGet$t(_menu,this).setMenuItems(_classPrivateFieldGet$t(_items$1,this))}translateNames(e){return arrayEach(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),_classPrivateFieldSet$r(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet$t(_menu,this).setMenuItems(_classPrivateFieldGet$t(_items$1,this));const e=new BaseUI$3(this.hot,{className:"htUISelectCaption"}),t=new BaseUI$3(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet$r(_caption,this,e),_classPrivateFieldSet$r(_captionElement,this,e.element),_classPrivateFieldSet$r(_dropdown,this,t),this.hot.getSettings().ariaTags&&(setAttribute(t.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach([e,t],n=>this._element.appendChild(n.element)),_classPrivateFieldGet$t(_menu,this).addLocalHook("select",n=>_assertClassBrand$D(_SelectUI_brand,this,_onMenuSelect).call(this,n)),_classPrivateFieldGet$t(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand$D(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=_classPrivateFieldGet$t(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet$t(_captionElement,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();_classPrivateFieldGet$t(_menu,this)&&(_classPrivateFieldGet$t(_menu,this).open(),_classPrivateFieldGet$t(_menu,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),_classPrivateFieldGet$t(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet$t(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet$t(_menu,this)&&_classPrivateFieldGet$t(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet$t(_menu,this)&&(_classPrivateFieldGet$t(_menu,this).destroy(),_classPrivateFieldSet$r(_menu,this,null)),_classPrivateFieldGet$t(_caption,this)&&_classPrivateFieldGet$t(_caption,this).destroy(),_classPrivateFieldGet$t(_dropdown,this)&&_classPrivateFieldGet$t(_dropdown,this).destroy(),super.destroy()}}function _onMenuSelect(r){r.name!==KEY$c&&(this.options.value=r,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function _classPrivateMethodInitSpec$r(r,e){_checkPrivateRedeclaration$C(r,e),e.add(r)}function _checkPrivateRedeclaration$C(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$H(r,e,t){return(e=_toPropertyKey$I(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$I(r){var e=_toPrimitive$I(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$I(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$C(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet;class ConditionComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$r(this,_ConditionComponent_brand),_defineProperty$H(this,"name",""),_defineProperty$H(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_assertClassBrand$C(_ConditionComponent_brand,this,_onConditionSelect).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),arrayEach(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>_assertClassBrand$C(_ConditionComponent_brand,this,_onInputKeyDown$2).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=clone$1(e.command);t.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),arrayEach(e.args,(n,s)=>{if(s>t.inputsCount-1)return!1;const o=this.getInputElement(s);o.setValue(n),o[t.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$k),t=[];return arrayEach(this.getInputElements(),(n,s)=>{e.inputsCount>s&&t.push(n.getValue())}),{command:e,args:t}}updateState(e,t){const n=getConditionDescriptor(e?e.name:CONDITION_NAME$k);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||arrayEach(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof SelectUI)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,s,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass$1(t.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return addClass$1(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[getConditionDescriptor(CONDITION_NAME$k)];if(e!==null){const{visualIndex:n}=e;t=getOptionsList(this.hot.getDataType(0,n,this.hot.countRows(),n))}arrayEach(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function _onConditionSelect(r){arrayEach(this.getInputElements(),(e,t)=>{e[r.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",r)}function _onInputKeyDown$2(r){isKey(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(r))}function _classPrivateFieldInitSpec$s(r,e,t){_checkPrivateRedeclaration$B(r,e),e.set(r,t)}function _checkPrivateRedeclaration$B(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$s(r,e){return r.get(_assertClassBrand$B(r,e))}function _classPrivateFieldSet$q(r,e,t){return r.set(_assertClassBrand$B(r,e),t),t}function _assertClassBrand$B(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_label=new WeakMap;class RadioInputUI extends BaseUI$3{static get DEFAULTS(){return clone$1({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,extend$1(RadioInputUI.DEFAULTS,t)),_classPrivateFieldInitSpec$s(this,_input,void 0),_classPrivateFieldInitSpec$s(this,_label,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet$q(_label,this,e),_classPrivateFieldSet$q(_input,this,this._element.firstChild),_classPrivateFieldGet$s(_input,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$s(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet$s(_input,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet$s(_input,this).checked=e)}focus(){this.isBuilt()&&_classPrivateFieldGet$s(_input,this).focus()}}function _classPrivateMethodInitSpec$q(r,e){_checkPrivateRedeclaration$A(r,e),e.add(r)}function _checkPrivateRedeclaration$A(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$G(r,e,t){return(e=_toPropertyKey$H(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$H(r){var e=_toPrimitive$H(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$H(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$A(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const SELECTED_AT_START_ELEMENT_INDEX=0;var _OperatorsComponent_brand=new WeakSet;class OperatorsComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$q(this,_OperatorsComponent_brand),_defineProperty$G(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass$1(t.parentNode,"htFiltersMenuOperators"),arrayEach(this.elements,n=>t.appendChild(n.element)),t)}}buildOperatorsElement(){const e=[OPERATION_ID$2,OPERATION_ID$1];arrayEach(e,t=>{const n=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:t,textContent:getOperationName(t)},value:t,checked:t===e[SELECTED_AT_START_ELEMENT_INDEX],id:t});n.addLocalHook("change",s=>_assertClassBrand$A(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,s)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(toSingleLine`Radio button with index ${e} doesn't exist.`);arrayEach(this.elements,(t,n)=>{t.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof RadioInputUI&&t.isChecked());return e?e.getValue():OPERATION_ID$2}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,t=arguments.length>1?arguments[1]:void 0,n=e;n===OPERATION_ID&&(n=OPERATION_ID$1),this.state.setValueAtIndex(t,n)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}}function _onRadioInputChange(r){this.setState(r.target.value)}const COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(r){let e=r+1,t="",n;for(;e>0;)n=(e-1)%COLUMN_LABEL_BASE_LENGTH,t=String.fromCharCode(65+n)+t,e=parseInt((e-n)/COLUMN_LABEL_BASE_LENGTH,10);return t}function dataRowToChangesArray(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=r;const n=[];return(!Array.isArray(r)||!Array.isArray(r[0]))&&(t=[r]),t.forEach((s,o)=>{Array.isArray(s)?s.forEach((a,l)=>{n.push([o+e,l,a])}):Object.keys(s).forEach(a=>{n.push([o+e,a,s[a]])})}),n}function countFirstRowKeys(r){let e=0;return Array.isArray(r)&&(r[0]&&Array.isArray(r[0])?e=r[0].length:r[0]&&isObject$1(r[0])&&(e=deepObjectSize(r[0]))),e}function isArrayOfArrays(r){return!!(Array.isArray(r)&&r.length&&r.every(e=>Array.isArray(e)))}function isArrayOfObjects(r){return!!(Array.isArray(r)&&r.length&&r.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function _classPrivateFieldInitSpec$r(r,e,t){_checkPrivateRedeclaration$z(r,e),e.set(r,t)}function _checkPrivateRedeclaration$z(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$r(r,e){return r.get(_assertClassBrand$z(r,e))}function _classPrivateFieldSet$p(r,e,t){return r.set(_assertClassBrand$z(r,e),t),t}function _assertClassBrand$z(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap;class LinkUI extends BaseUI$3{static get DEFAULTS(){return clone$1({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,extend$1(LinkUI.DEFAULTS,t)),_classPrivateFieldInitSpec$r(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet$p(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet$r(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet$r(_link,this).focus()}activate(){_classPrivateFieldGet$r(_link,this).click()}}function _classPrivateMethodInitSpec$p(r,e){_checkPrivateRedeclaration$y(r,e),e.add(r)}function _classPrivateFieldInitSpec$q(r,e,t){_checkPrivateRedeclaration$y(r,e),e.set(r,t)}function _checkPrivateRedeclaration$y(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$q(r,e){return r.get(_assertClassBrand$y(r,e))}function _classPrivateFieldSet$o(r,e,t){return r.set(_assertClassBrand$y(r,e),t),t}function _assertClassBrand$y(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$5="multipleSelect.itemBox";var _items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet;class MultipleSelectUI extends BaseUI$3{static get DEFAULTS(){return clone$1({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,extend$1(MultipleSelectUI.DEFAULTS,t)),_classPrivateMethodInitSpec$p(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec$q(this,_items,[]),_classPrivateFieldInitSpec$q(this,_itemsBox,void 0),_classPrivateFieldInitSpec$q(this,_locale,void 0),_classPrivateFieldInitSpec$q(this,_searchInput,void 0),_classPrivateFieldInitSpec$q(this,_selectAllUI,void 0),_classPrivateFieldInitSpec$q(this,_clearAllUI,void 0),_classPrivateFieldSet$o(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet$o(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet$o(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet$q(_itemsBox,this)}registerHooks(){_classPrivateFieldGet$q(_searchInput,this).addLocalHook("keydown",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onInputKeyDown$1).call(this,e)),_classPrivateFieldGet$q(_searchInput,this).addLocalHook("input",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onInput).call(this,e)),_classPrivateFieldGet$q(_selectAllUI,this).addLocalHook("click",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,e)),_classPrivateFieldGet$q(_clearAllUI,this).addLocalHook("click",e=>_assertClassBrand$y(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,e))}setItems(e){var t;_classPrivateFieldSet$o(_items,this,e),(t=_classPrivateFieldGet$q(_itemsBox,this))===null||t===void 0||t.loadData(_classPrivateFieldGet$q(_items,this))}setLocale(e){_classPrivateFieldSet$o(_locale,this,e)}getLocale(){return _classPrivateFieldGet$q(_locale,this)}getItems(){return[..._classPrivateFieldGet$q(_items,this)]}getValue(){return itemsToValue(_classPrivateFieldGet$q(_items,this))}getSearchInputElement(){return _classPrivateFieldGet$q(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet$q(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet$q(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet$q(_items,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new BaseUI$3(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet$q(_selectAllUI,this),_classPrivateFieldGet$q(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet$q(_searchInput,this).element),this._element.appendChild(n.element),this._element.appendChild(t);const s=o=>{var a;if(!this._element)return;(a=_classPrivateFieldGet$q(_itemsBox,this))===null||a===void 0||a.destroy(),addClass$1(o,"htUIMultipleSelectHot"),_classPrivateFieldSet$o(_itemsBox,this,new this.hot.constructor(o,{data:_classPrivateFieldGet$q(_items,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,h,g,v,m,E)=>{c.title=E.instance.getDataAtRowProp(h,E.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet$q(_itemsBox,this).listen()},colWidths:()=>_classPrivateFieldGet$q(_itemsBox,this).container.scrollWidth-getScrollbarWidth(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet$q(_itemsBox,this).init(),this.hot.addHook("afterSetTheme",(c,h)=>{h||_classPrivateFieldGet$q(_itemsBox,this).useTheme(c)});const u=_classPrivateFieldGet$q(_itemsBox,this).getShortcutManager().getContext("grid");u.removeShortcutsByKeys(["Tab"]),u.removeShortcutsByKeys(["Shift","Tab"]),u.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:SHORTCUTS_GROUP$5}),u.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{_classPrivateFieldGet$q(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:SHORTCUTS_GROUP$5})};s(t),this.hot._registerTimeout(()=>s(t),100)}focus(){this.isBuilt()&&_classPrivateFieldGet$q(_itemsBox,this).listen()}reset(){_classPrivateFieldGet$q(_searchInput,this).reset(),_classPrivateFieldGet$q(_selectAllUI,this).reset(),_classPrivateFieldGet$q(_clearAllUI,this).reset()}update(){this.isBuilt()&&(_classPrivateFieldGet$q(_itemsBox,this).loadData(valueToItems(_classPrivateFieldGet$q(_items,this),this.options.value)),super.update())}destroy(){var e;(e=_classPrivateFieldGet$q(_itemsBox,this))===null||e===void 0||e.destroy(),_classPrivateFieldGet$q(_searchInput,this).destroy(),_classPrivateFieldGet$q(_clearAllUI,this).destroy(),_classPrivateFieldGet$q(_selectAllUI,this).destroy(),_classPrivateFieldSet$o(_searchInput,this,null),_classPrivateFieldSet$o(_clearAllUI,this,null),_classPrivateFieldSet$o(_selectAllUI,this,null),_classPrivateFieldSet$o(_itemsBox,this,null),_classPrivateFieldSet$o(_items,this,null),super.destroy()}}function _onInput(r){const e=r.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[..._classPrivateFieldGet$q(_items,this)]:t=_classPrivateFieldGet$q(_items,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),_classPrivateFieldGet$q(_itemsBox,this).loadData(t)}function _onInputKeyDown$1(r){this.runLocalHooks("keydown",r,this),partial(isKey,r.keyCode)("ARROW_DOWN")&&(r.preventDefault(),stopImmediatePropagation(r),_classPrivateFieldGet$q(_itemsBox,this).listen(),_classPrivateFieldGet$q(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(r){const e=[];r.preventDefault(),_classPrivateFieldGet$q(_itemsBox,this).getSourceData().forEach((t,n)=>{t.checked=!0,e.push(dataRowToChangesArray(t,n)[0])}),_classPrivateFieldGet$q(_itemsBox,this).setSourceDataAtCell(e)}function _onClearAllClick(r){const e=[];r.preventDefault(),_classPrivateFieldGet$q(_itemsBox,this).getSourceData().forEach((t,n)=>{t.checked=!1,e.push(dataRowToChangesArray(t,n)[0])}),_classPrivateFieldGet$q(_itemsBox,this).setSourceDataAtCell(e)}function valueToItems(r,e){const t=createArrayAssertion(e);return r.map(n=>(n.checked=t(n.value),n))}function itemsToValue(r){const e=[];return r.forEach(t=>{t.checked&&e.push(t.value)}),e}function _classPrivateMethodInitSpec$o(r,e){_checkPrivateRedeclaration$x(r,e),e.add(r)}function _checkPrivateRedeclaration$x(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$F(r,e,t){return(e=_toPropertyKey$G(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$G(r){var e=_toPrimitive$G(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$G(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$x(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet;class ValueComponent extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$o(this,_ValueComponent_brand),_defineProperty$F(this,"name",""),this.name=t.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_assertClassBrand$x(_ValueComponent_brand,this,_onInputKeyDown).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>_assertClassBrand$x(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===CONDITION_NAME){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?CONDITION_NAME$k:CONDITION_NAME},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(n,s,o,a,l)=>{const[u]=arrayFilter(s,g=>g.name===CONDITION_NAME),c={},h=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(u){const g=a(n,l),v=arrayMap(g,A=>A.value),m=new Map(g.map(A=>[A.value,this.hot.getCellMeta(A.meta.visualRow,A.meta.visualCol)])),E=unifyColumnValues(v);o&&(u.args[0]=o);const _=[],S=intersectValues(E,u.args[0],h,A=>{A.checked&&_.push(A.value),_assertClassBrand$x(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,A,m)}),w=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,w).locale,c.args=[_],c.command=getConditionDescriptor(CONDITION_NAME),c.itemsSnapshot=S}else c.args=[],c.command=getConditionDescriptor(CONDITION_NAME$k);this.state.setValueAtIndex(n,c)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,s,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return addClass$1(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),n=t.map(u=>u.value),s=new Map(t.map(u=>[u.value,u.meta])),o=unifyColumnValues(n),a=intersectValues(o,o,e,u=>{_assertClassBrand$x(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,u,s)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:arrayMap(this.hot.getDataAtCol(e.visualIndex),(t,n)=>({value:toEmptyString(t),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function _onInputKeyDown(r){isKey(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(r))}function _triggerModifyMultipleSelectionValueHook(r,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(r.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",r.visualValue,e.get(r.value)))}function _onModifyDisplayedValue(r,e){switch(e.type){case"numeric":return getRenderedValue(r,e);default:return r}}var _ActionBarComponent;function _classPrivateMethodInitSpec$n(r,e){_checkPrivateRedeclaration$w(r,e),e.add(r)}function _checkPrivateRedeclaration$w(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$E(r,e,t){return(e=_toPropertyKey$F(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$F(r){var e=_toPrimitive$F(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$F(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$w(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet;class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),_classPrivateMethodInitSpec$n(this,_ActionBarComponent_brand),_defineProperty$E(this,"name",""),this.name=t.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach(this.elements,e=>{e.addLocalHook("click",(t,n)=>_assertClassBrand$w(_ActionBarComponent_brand,this,_onButtonClick).call(this,t,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass$1(t.parentNode,"htFiltersMenuActionBar"),arrayEach(this.elements,n=>t.appendChild(n.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_ActionBarComponent=ActionBarComponent;function _onButtonClick(r,e){e.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function _defineProperty$D(r,e,t){return(e=_toPropertyKey$E(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$E(r){var e=_toPrimitive$E(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$E(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const MAP_NAME="ConditionCollection.filteringStates";class ConditionCollection{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty$D(this,"hot",void 0),_defineProperty$D(this,"isMapRegistrable",void 0),_defineProperty$D(this,"filteringStates",new LinkedPhysicalIndexToValueMap),_defineProperty$D(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var n;const s=this.filteringStates.getValueAtIndex(t),o=(n=s==null?void 0:s.conditions)!==null&&n!==void 0?n:[],a=s==null?void 0:s.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return e.length?getOperationFunc(n)(e,t):!0}addCondition(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,s=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=arrayMap(t.args,h=>typeof h=="string"?h.toLocaleLowerCase(o):h),l=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const u=this.getOperation(e);if(u){if(u!==n)throw Error(toSingleLine`The column of index ${e} has been already applied with a \`${u}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined$1(operations[n]))throw new Error(toSingleLine`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:l,args:a,func:getCondition(l,a)}]},s):c.push({name:l,args:a,func:getCondition(l,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return(t=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return arrayReduce(this.filteringStates.getEntries(),(e,t)=>{let[n,{operation:s,conditions:o}]=t;return e.push({column:n,operation:s,conditions:arrayMap(o,a=>{let{name:l,args:u}=a;return{name:l,args:u}})}),e},[])}importAllConditions(e){this.clean(),arrayEach(e,t=>{arrayEach(t.conditions,n=>this.addCondition(t.column,n))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some(s=>s.name===t):n.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}mixin(ConditionCollection,localHooks);function _defineProperty$C(r,e,t){return(e=_toPropertyKey$D(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$D(r){var e=_toPrimitive$D(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$D(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataFilter{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty$C(this,"conditionCollection",void 0),_defineProperty$C(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return arrayEach(this.conditionCollection.getFilteredColumns(),(t,n)=>{let s=this.columnDataFactory(t);n&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return arrayEach(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&n.push(s)}),n}_getIntersectData(e,t){const n=[];return arrayEach(t,s=>{const o=s.meta.visualRow;e[o]!==void 0&&(n[o]=e[o])}),n}}function _classPrivateMethodInitSpec$m(r,e){_checkPrivateRedeclaration$v(r,e),e.add(r)}function _checkPrivateRedeclaration$v(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$B(r,e,t){return(e=_toPropertyKey$C(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$C(r){var e=_toPrimitive$C(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$C(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$v(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet;class ConditionUpdateObserver{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec$m(this,_ConditionUpdateObserver_brand),_defineProperty$B(this,"hot",void 0),_defineProperty$B(this,"conditionCollection",void 0),_defineProperty$B(this,"columnDataFactory",void 0),_defineProperty$B(this,"changes",[]),_defineProperty$B(this,"grouping",!1),_defineProperty$B(this,"latestEditedColumnPosition",-1),_defineProperty$B(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",s=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand$v(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=s.slice(0,o),l=s.slice(o);l.length&&l[0].column===e&&l.shift();const u=curry(function(h,g){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new ConditionCollection(n.hot,!1),E=[].concat(h,v);m.importAllConditions(E);const _=n.columnDataFactory(g);let S;m.isEmpty()?S=_:S=new DataFilter(m,A=>n.columnDataFactory(A)).filter(),S=arrayMap(S,A=>A.meta.visualRow);const w=createArrayAssertion(S);return m.destroy(),arrayFilter(_,A=>w(A.meta.visualRow))})(a),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),objectEach(this,(e,t)=>{this[t]=null})}}function _onConditionBeforeModify(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach(this.latestOrderStack,r=>{this.updateStatesAtColumn(r)})}mixin(ConditionUpdateObserver,localHooks);function createFocusNavigator(r){return createPaginator({initialPage:0,size:()=>r.length,onItemSelect:(t,n)=>{const s=r[t];if(s instanceof MultipleSelectUI)return n;if(s.element&&!isVisible(s.element))return!1;s.focus()}})}const SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(r,e){let t=-1,n;const s=createFocusNavigator(e),o=g=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),s.setCurrentPage(e.indexOf(g))};e.forEach(g=>{g instanceof BaseUI$3&&(g.addLocalHook("click",o(g)),g.addLocalHook("focus",o(g)),g.addLocalHook("afterClose",o(g)))}),u(r);function a(g){const v=n.getKeyboardShortcutsCtrl(),m=g.getKeyboardShortcutsCtrl();s.clear(),m.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:v.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{g.isSubMenu()&&g.close(),v.listen(SHORTCUTS_MENU_CONTEXT)}}]),!g.isSubMenu()&&v.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:E=>{const _=n.getNavigator();_.getCurrentPage()>-1&&(t=_.getCurrentPage()),_.clear(),E.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:E=>{const _=e[s.getCurrentPage()];_ instanceof SelectUI&&(_.openOptions(),E.preventDefault()),_ instanceof LinkUI&&(_.activate(),E.preventDefault()),_ instanceof BaseUI$3||E.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}function l(){n.focus(),n.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function u(g){g.addLocalHook("afterSelectionChange",v=>{v.key.startsWith("filter_")||s.clear()}),g.addLocalHook("afterSubmenuOpen",a),g.addLocalHook("afterOpen",a),n=g}function c(){return n}function h(){return t}return{...s,listen:l,setMenu:u,getMenu:c,getLastMenuPage:h}}function _classPrivateMethodInitSpec$l(r,e){_checkPrivateRedeclaration$u(r,e),e.add(r)}function _classPrivateFieldInitSpec$p(r,e,t){_checkPrivateRedeclaration$u(r,e),e.set(r,t)}function _checkPrivateRedeclaration$u(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$A(r,e,t){return(e=_toPropertyKey$B(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$B(r){var e=_toPrimitive$B(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$B(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$n(r,e,t){return r.set(_assertClassBrand$u(r,e),t),t}function _classPrivateFieldGet$p(r,e){return r.get(_assertClassBrand$u(r,e))}function _assertClassBrand$u(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$j="filters",PLUGIN_PRIORITY$i=250,SHORTCUTS_GROUP$4=PLUGIN_KEY$j;var _menuFocusNavigator=new WeakMap,_dropdownMenuTraces=new WeakMap,_Filters_brand=new WeakSet;class Filters extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$j}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$i}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),_classPrivateMethodInitSpec$l(this,_Filters_brand),_defineProperty$A(this,"dropdownMenuPlugin",null),_defineProperty$A(this,"conditionCollection",null),_defineProperty$A(this,"conditionUpdateObserver",null),_defineProperty$A(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty$A(this,"filtersRowsMap",null),_classPrivateFieldInitSpec$p(this,_menuFocusNavigator,void 0),_classPrivateFieldInitSpec$p(this,_dropdownMenuTraces,new WeakSet),this.hot.addHook("afterGetColHeader",(t,n)=>_assertClassBrand$u(_Filters_brand,this,_onAfterGetColHeader$1).call(this,t,n))}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$j]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,s=l=>(l.addLocalHook("accept",()=>_assertClassBrand$u(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),l.addLocalHook("cancel",()=>_assertClassBrand$u(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),l.addLocalHook("change",u=>_assertClassBrand$u(_Filters_brand,this,_onComponentChange).call(this,l,u)),l),o=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,a=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const l=new ConditionComponent(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:n});l.addLocalHook("afterClose",()=>_assertClassBrand$u(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",s(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const l=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});l.addLocalHook("afterClose",()=>_assertClassBrand$u(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",s(l))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new ValueComponent(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.hot,this.conditionCollection,l=>this.getDataMapAtColumn(l)),this.conditionUpdateObserver.addLocalHook("update",l=>_assertClassBrand$u(_Filters_brand,this,_updateComponents).call(this,l))),this.components.forEach(l=>l.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return _assertClassBrand$u(_Filters_brand,e,_onAfterDropdownMenuDefaultOptions).call(e,...u)}),this.addHook("beforeDropdownMenuShow",()=>_assertClassBrand$u(_Filters_brand,this,_onBeforeDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand$u(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand$u(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",l=>_assertClassBrand$u(_Filters_brand,this,_onAfterChange$1).call(this,l)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet$p(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const l=[{focus:()=>{const c=_classPrivateFieldGet$p(_menuFocusNavigator,this).getMenu(),h=c.getNavigator(),g=_classPrivateFieldGet$p(_menuFocusNavigator,this).getLastMenuPage();c.focus(),g>0?h.setCurrentPage(g):h.toFirstItem()}},...Array.from(this.components).map(c=>{let[,h]=c;return h.getElements()}).flat()];_classPrivateFieldSet$n(_menuFocusNavigator,this,createMenuFocusController(this.dropdownMenuPlugin.menu,l));const u=c=>{_classPrivateFieldGet$p(_menuFocusNavigator,this).listen(),c.preventDefault(),isKey(c.keyCode,"TAB")&&(c.shiftKey?_classPrivateFieldGet$p(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet$p(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",u),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",u)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,n)=>{t.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:SHORTCUTS_GROUP$4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$4)}addCondition(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},s)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let s=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack)!==!1)if(n){const l=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=arrayMap(t.filter(),c=>c.meta.visualRow);const u=createArrayAssertion(s);rangeEach(this.hot.countSourceRows()-1,c=>{u(c)||l.push(c)}),arrayEach(l,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!s.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return arrayEach(this.hot.getSourceDataAtCol(t),(s,o)=>{var a;const{row:l,col:u,visualCol:c,visualRow:h,type:g,instance:v,dateFormat:m,locale:E}=this.hot.getCellMeta(o,t),_=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&a!==void 0?a:s;n.push({meta:{row:l,col:u,visualCol:c,visualRow:h,type:g,instance:v,dateFormat:m,locale:E},value:toEmptyString(_)})}),n}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),n=unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var t;const n=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,s){let o=e;return o===OPERATION_ID$1&&t.command.key!==CONDITION_NAME$k&&n.command.key!==CONDITION_NAME$k&&s.command.key!==CONDITION_NAME$k?o=OPERATION_ID:s.command.key!==CONDITION_NAME$k&&(t.command.key===CONDITION_NAME$k||n.command.key===CONDITION_NAME$k)&&(o=OPERATION_ID$2),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new DataFilter(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return arrayEach(s,a=>{arrayEach(t.menuItems,(l,u)=>{l.key===a.getMenuItemDescriptor().key&&e.push(u)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,s=n.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];const u=this.getIndexesOfComponents(...a);e?s.showRows(u):s.hideRows(u),n.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function _onAfterChange$1(r){r&&arrayEach(r,e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function _onAfterDropdownMenuShow(){const r=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),r.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onBeforeDropdownMenuShow(){const r=this.dropdownMenuPlugin.menu;_classPrivateFieldGet$p(_dropdownMenuTraces,this).has(r)||_classPrivateFieldGet$p(_menuFocusNavigator,this).setMenu(r),_classPrivateFieldGet$p(_dropdownMenuTraces,this).add(r)}function _onAfterDropdownMenuDefaultOptions(r){r.items.push({name:KEY$c}),this.components.forEach(e=>{r.items.push(e.getMenuItemDescriptor())})}function _onActionBarSubmit(r){var e;if(r==="accept"){const n=this.getSelectedColumn();if(n===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:s}=n,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,l);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(s);c===-1&&(c=void 0),this.conditionCollection.removeConditions(s),o.command.key!==CONDITION_NAME$k&&(this.conditionCollection.addCondition(s,o,u,c),a.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(s,a,u,c)),l.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(s,l,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function _onComponentChange(r,e){const t=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),r.constructor===ConditionComponent&&!e.inputsCount&&this.setListeningDropdownMenu(),t.updateMenuDimensions()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader$1(r,e){const t=this.hot.toPhysicalColumn(r);this.enabled&&this.conditionCollection.hasConditions(t)?addClass$1(e,"htFiltersActive"):removeClass$1(e,"htFiltersActive")}function _updateComponents(r){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:n}}=r,s=t.filter(a=>a.name===CONDITION_NAME),o=t.filter(a=>a.name!==CONDITION_NAME);if(s.length>=2||o.length>=3)warn$1(toSingleLine`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(r)}}const DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(r){var e;return{maxColumns:r.maxColumns,maxRows:r.maxRows,language:(e=r[PLUGIN_KEY$i])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function cleanEngineSettings(r){return Object.keys(r).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=r[t]),e),{})}function getEngineSettingsWithDefaultsAndOverrides(r){var e;const t=r[PLUGIN_KEY$i],n=cleanEngineSettings(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=getEngineSettingsOverrides(r);return{...DEFAULT_SETTINGS,...n,...s}}function getEngineSettingsWithOverrides(r){var e;const t=r[PLUGIN_KEY$i],n=cleanEngineSettings(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=getEngineSettingsOverrides(r);return{...n,...s}}function haveEngineSettingsChanged(r,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==r[t])}function getEngineRelationshipRegistry(){const r="engine_relationship",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(r)||e.register(r,new Map),e.getItem(r)}function getSharedEngineUsageRegistry(){const r="shared_engine_usage",e=staticRegister(PLUGIN_KEY$i);return e.hasItem(r)||e.register(r,new Map),e.getItem(r)}function setupEngine(r){const e=r.getSettings(),t=e[PLUGIN_KEY$i],n=t==null?void 0:t.engine;if(t===!0||isUndefined$1(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var s;return registerEngine((s=n.hyperformula)!==null&&s!==void 0?s:n,e,r)}else if(typeof n=="object"&&isUndefined$1(n.hyperformula)){const o=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(r),a&&a.push(r.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(n.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(n.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn$1(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function registerEngine(r,e,t){const n=e[PLUGIN_KEY$i],s=getEngineSettingsWithDefaultsAndOverrides(e),o=getEngineRelationshipRegistry(),a=getSharedEngineUsageRegistry();registerCustomFunctions(r,n.functions),registerLanguage(r,n.language);const l=r.buildEmpty(s);return o.set(l,[t]),a.set(l,[t.guid]),registerNamedExpressions(l,n.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function getRegisteredHotInstances(r){var e;const t=getEngineRelationshipRegistry(),n=t.size===0?[]:Array.from((e=t.get(r))!==null&&e!==void 0?e:[]);return new Map(n.map(s=>[s.getPlugin("formulas").sheetId,s]))}function unregisterEngine(r,e){if(r){const t=getEngineRelationshipRegistry(),n=t.get(r),s=getSharedEngineUsageRegistry(),o=s.get(r);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&t.delete(r)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(s.delete(r),r.destroy()))}}function registerCustomFunctions(r,e){e&&e.forEach(t=>{const{name:n,plugin:s,translations:o}=t;try{r.registerFunction(n,s,o)}catch(a){warn$1(a.message)}})}function registerLanguage(r,e){if(e){const{langCode:t}=e;try{r.registerLanguage(t,e)}catch(n){warn$1(n.message)}}}function registerNamedExpressions(r,e){e&&(r.suspendEvaluation(),e.forEach(t=>{const{name:n,expression:s,scope:o,options:a}=t;try{r.addNamedExpression(n,s,o,a)}catch(l){warn$1(l.message)}}),r.resumeEvaluation())}function setupSheet(r,e){return(isUndefined$1(e)||!r.doesSheetExist(e))&&(e=r.addSheet(e)),e}const DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(r){return typeof r=="string"&&r.charAt(0)==="'"&&r.charAt(1)==="="}function unescapeFormulaExpression(r){return isEscapedFormulaExpression(r)?r.substr(1):r}function isFormula$1(r){return typeof r=="string"&&r.startsWith("=")}function isDate(r,e){return typeof r=="string"&&e==="date"}function isDateValid(r,e){return hooks(r,e,!0).isValid()}function getDateInHfFormat(r,e){return hooks(r,e,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(r,e){return hooks(r,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(e)}function getDateFromExcelDate(r,e){const n=new Date(Date.UTC(0,0,r+-1));return hooks(n).format(e)}function getMoveLine(r,e,t){const n=Array.from(Array(t).keys()).filter(o=>r.includes(o)===!1);if(e===0){var s;return(s=n[e])!==null&&s!==void 0?s:0}return n[e-1]+1}function getInitiallyCalculatedMoves(r,e){const t=[];return r.forEach(n=>{const s={from:n,to:e};t.forEach(o=>{const a=o.from>o.to,l=o.to<=s.from;o.from>s.from&&l&&a&&(s.from+=1)}),s.from>=e&&(e+=1),t.push(s)}),t}function adjustedCalculatedMoves(r){return r.forEach((e,t)=>{r.slice(t+1).forEach(s=>{const o=s.from<s.to;s.from>e.from&&o&&(s.from-=1)})}),r}function getMoves(r,e,t){const n=getInitiallyCalculatedMoves(r,getMoveLine(r,e,t));return adjustedCalculatedMoves(n)}function _classPrivateFieldInitSpec$o(r,e,t){_checkPrivateRedeclaration$t(r,e),e.set(r,t)}function _checkPrivateRedeclaration$t(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$o(r,e){return r.get(_assertClassBrand$t(r,e))}function _classPrivateFieldSet$m(r,e,t){return r.set(_assertClassBrand$t(r,e),t),t}function _assertClassBrand$t(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap;class AxisSyncer{constructor(e,t,n){_classPrivateFieldInitSpec$o(this,_axis,void 0),_classPrivateFieldInitSpec$o(this,_indexMapper,void 0),_classPrivateFieldInitSpec$o(this,_indexSyncer,void 0),_classPrivateFieldInitSpec$o(this,_indexesSequence,[]),_classPrivateFieldInitSpec$o(this,_movedIndexes,[]),_classPrivateFieldInitSpec$o(this,_finalIndex,void 0),_classPrivateFieldInitSpec$o(this,_removedIndexes,[]),_classPrivateFieldSet$m(_axis,this,e),_classPrivateFieldSet$m(_indexMapper,this,t),_classPrivateFieldSet$m(_indexSyncer,this,n)}setRemovedHfIndexes(e){return _classPrivateFieldSet$m(_removedIndexes,this,e.map(t=>{const n=_classPrivateFieldGet$o(_indexMapper,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(n)})),_classPrivateFieldGet$o(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet$o(_removedIndexes,this)}getHfIndexFromVisualIndex(e){const t=_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence(),n=_classPrivateFieldGet$o(_indexMapper,this).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const n=`move${toUpperCaseFirst(_classPrivateFieldGet$o(_axis,this))}s`;_classPrivateFieldGet$o(_indexSyncer,this).getEngine().batch(()=>{e.forEach(s=>{const o=s.from!==s.to,a=s.from+1!==s.to;o&&a&&_classPrivateFieldGet$o(_indexSyncer,this).getEngine()[n](_classPrivateFieldGet$o(_indexSyncer,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,n){n!==!1&&(_classPrivateFieldSet$m(_movedIndexes,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),_classPrivateFieldSet$m(_finalIndex,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(_classPrivateFieldGet$o(_indexSyncer,this).isPerformingUndoRedo()||e===!1||t===!1)return;const n=getMoves(_classPrivateFieldGet$o(_movedIndexes,this),_classPrivateFieldGet$o(_finalIndex,this),_classPrivateFieldGet$o(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet$o(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet$o(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${toUpperCaseFirst(_classPrivateFieldGet$o(_axis,this))}Order`;return t=>{if(_classPrivateFieldGet$o(_indexSyncer,this).isPerformingUndoRedo())return;const n=_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence();if(t==="update"&&n.length>0){const s=_classPrivateFieldGet$o(_indexesSequence,this).map(u=>n.indexOf(u)),o=_classPrivateFieldGet$o(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet$o(_indexSyncer,this).getSheetId());let a;_classPrivateFieldGet$o(_axis,this)==="row"?a=o.height:a=o.width;const l=s.length;for(let u=l;u<a;u+=1)s.push(u);_classPrivateFieldGet$o(_indexSyncer,this).getEngine()[e](_classPrivateFieldGet$o(_indexSyncer,this).getSheetId(),s)}_classPrivateFieldSet$m(_indexesSequence,this,n)}}init(){_classPrivateFieldSet$m(_indexesSequence,this,_classPrivateFieldGet$o(_indexMapper,this).getIndexesSequence())}}function _classPrivateFieldInitSpec$n(r,e,t){_checkPrivateRedeclaration$s(r,e),e.set(r,t)}function _checkPrivateRedeclaration$s(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$n(r,e){return r.get(_assertClassBrand$s(r,e))}function _classPrivateFieldSet$l(r,e,t){return r.set(_assertClassBrand$s(r,e),t),t}function _assertClassBrand$s(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap;class IndexSyncer{constructor(e,t,n){_classPrivateFieldInitSpec$n(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec$n(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec$n(this,_postponeAction,void 0),_classPrivateFieldInitSpec$n(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec$n(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec$n(this,_engine,null),_classPrivateFieldInitSpec$n(this,_sheetId,null),_classPrivateFieldSet$l(_rowIndexSyncer,this,new AxisSyncer("row",e,this)),_classPrivateFieldSet$l(_columnIndexSyncer,this,new AxisSyncer("column",t,this)),_classPrivateFieldSet$l(_postponeAction,this,n)}getForAxis(e){return e==="row"?_classPrivateFieldGet$n(_rowIndexSyncer,this):_classPrivateFieldGet$n(_columnIndexSyncer,this)}setPerformUndo(e){_classPrivateFieldSet$l(_isPerformingUndo,this,e)}setPerformRedo(e){_classPrivateFieldSet$l(_isPerformingRedo,this,e)}isPerformingUndoRedo(){return _classPrivateFieldGet$n(_isPerformingUndo,this)||_classPrivateFieldGet$n(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet$n(_sheetId,this)}getEngine(){return _classPrivateFieldGet$n(_engine,this)}getPostponeAction(){return _classPrivateFieldGet$n(_postponeAction,this)}setupSyncEndpoint(e,t){_classPrivateFieldSet$l(_engine,this,e),_classPrivateFieldSet$l(_sheetId,this,t),_classPrivateFieldGet$n(_rowIndexSyncer,this).init(),_classPrivateFieldGet$n(_columnIndexSyncer,this).init()}}function _classPrivateMethodInitSpec$k(r,e){_checkPrivateRedeclaration$r(r,e),e.add(r)}function _defineProperty$z(r,e,t){return(e=_toPropertyKey$A(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$A(r){var e=_toPrimitive$A(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$A(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldInitSpec$m(r,e,t){_checkPrivateRedeclaration$r(r,e),e.set(r,t)}function _checkPrivateRedeclaration$r(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$k(r,e,t){return r.set(_assertClassBrand$r(r,e),t),t}function _classPrivateFieldGet$m(r,e){return r.get(_assertClassBrand$r(r,e))}function _assertClassBrand$r(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$i="formulas",SETTING_KEYS=["maxRows","maxColumns","language"],PLUGIN_PRIORITY$h=260;Hooks.getSingleton().register("afterNamedExpressionAdded");Hooks.getSingleton().register("afterNamedExpressionRemoved");Hooks.getSingleton().register("afterSheetAdded");Hooks.getSingleton().register("afterSheetRemoved");Hooks.getSingleton().register("afterSheetRenamed");Hooks.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=r=>r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto";var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet;class Formulas extends BasePlugin{constructor(){var e;super(...arguments),e=this,_classPrivateMethodInitSpec$k(this,_Formulas_brand),_classPrivateFieldInitSpec$m(this,_internalOperationPending,!1),_classPrivateFieldInitSpec$m(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec$m(this,_engineListeners,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineValuesUpdated).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineNamedExpressionsAdded).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineNamedExpressionsRemoved).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetAdded).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetRenamed).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$r(_Formulas_brand,e,_onEngineSheetRemoved).call(e,...n)}]]),_defineProperty$z(this,"staticRegister",staticRegister("formulas")),_defineProperty$z(this,"engine",null),_defineProperty$z(this,"sheetName",null),_defineProperty$z(this,"indexSyncer",null),_defineProperty$z(this,"rowAxisSyncer",null),_defineProperty$z(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$i}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$h}static get SETTING_KEYS(){return[PLUGIN_KEY$i,...SETTING_KEYS]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$i]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=setupEngine(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){warn$1("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...s)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterLoadData$3).call(t,...s)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...s)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterLoadData$3).call(t,...s)}),this.addHook("modifyData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onModifyData).call(t,...s)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onModifySourceData).call(t,...s)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeValidate).call(t,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetSourceDataAtCell).call(t,...s)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...s)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeCreateRow).call(t,...s)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeCreateCol).call(t,...s)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCreateRow$2).call(t,...s)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCreateCol$1).call(t,...s)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeRemoveRow$1).call(t,...s)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeRemoveCol).call(t,...s)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterRemoveRow$2).call(t,...s)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterRemoveCol$1).call(t,...s)}),this.indexSyncer=new IndexSyncer(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,s,o,a)=>{this.rowAxisSyncer.storeMovesInformation(n,s,a)}),this.hot.addHook("beforeColumnMove",(n,s,o,a)=>{this.columnAxisSyncer.storeMovesInformation(n,s,a)}),this.hot.addHook("afterRowMove",(n,s,o,a,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("afterColumnMove",(n,s,o,a,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("beforeColumnFreeze",(n,s)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(n,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(n,s)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(n,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterCellMetaReset).call(t,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onAfterDetachChild$1).call(t,...s)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$r(_Formulas_brand,t,_onBeforeAutofill).call(t,...s)}),_classPrivateFieldGet$m(_engineListeners,this).forEach(n=>{let[s,o]=n;return this.engine.on(s,o)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet$m(_engineListeners,this).forEach(e=>{let[t,n]=e;return this.engine.off(t,n)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[PLUGIN_KEY$i];if(isDefined(n)&&isDefined(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[PLUGIN_KEY$i].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){_classPrivateFieldGet$m(_engineListeners,this).forEach(e=>{var t;let[n,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(n,s)}),_classPrivateFieldSet$k(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(isDefined(t)&&!isArrayOfArrays(t))return warn$1("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return warn$1("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(n){return warn$1(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){error(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${toUpperCaseFirst(PLUGIN_KEY$i)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return s!==null&&o!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(s=>{var o;const a=s==null||(o=s.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(n.has(a)||n.add(a))}),getRegisteredHotInstances(this.engine).forEach((s,o)=>{if((t||o!==this.sheetId)&&n.has(o)){var a;s.render(),(a=s.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=o=>{var a;const{row:l,col:u,sheet:c}=(a=o==null?void 0:o.address)!==null&&a!==void 0?a:{};return isDefined(c)?`${c}:${l}x${u}`:""},s=new Set(t.map(o=>n(o)));e.forEach(o=>{var a,l;const{row:u,col:c}=(a=o.address)!==null&&a!==void 0?a:{};if(isDefined(u)===!1||isDefined(c)===!1||u>=this.hot.countRows()||c>=this.hot.countCols())return;const h=o==null||(l=o.address)===null||l===void 0?void 0:l.sheet,g=n(o);if(h!==void 0&&!s.has(g)){const v=getRegisteredHotInstances(this.engine).get(h);if(!v)return;v.validateCell(v.getDataAtCell(u,c),v.getCellMeta(u,c),()=>{})}})}syncChangeWithEngine(e,t,n){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){warn$1(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const o=this.hot.getCellMeta(e,t);return isDate(n,o.type)&&(isDateValid(n,o.dateFormat)?n=getDateInHfFormat(n,o.dateFormat):isFormula$1(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(s,n)}}function _onBeforeValidate(r,e,t){const n=this.hot.propToCol(t);if(this.isFormulaCellType(e,n)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let a=this.engine.getCellValue(s);return o.type==="date"&&isNumeric(a)&&(a=getDateFromExcelDate(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return r}function _onBeforeAutofill(r,e,t){const{row:n,col:s}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),{row:l,col:u}=t.getTopStartCorner(),{row:c,col:h}=t.getBottomEndCorner(),g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},v={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(v)===!1)return!1;const m=this.engine.getFillRangeData(g,v),{row:E,col:_}=g.start,{row:S,col:w}=g.end,A=S-E+1,O=w-_+1;for(let D=0;D<m.length;D+=1)for(let Y=0;Y<m[D].length;Y+=1){const H=m[D][Y],k=E+D%A,K=_+Y%O,se=this.hot.getCellMeta(k,K);isDate(H,se.type)&&(H.startsWith("'")?m[D][Y]=H.slice(1):this.isFormulaCellType(k,K,this.sheetId)===!1&&(m[D][Y]=getDateInHotFormat(H,se.dateFormat)))}return m}function _onBeforeLoadData$1(r,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$i))||_classPrivateFieldSet$k(_hotWasInitializedWithEmptyData,this,isUndefined$1(this.hot.getSettings().data))}function _onAfterCellMetaReset(){const r=this.hot.getSourceDataArray();let e=!1;r.forEach((t,n)=>{t.forEach((s,o)=>{const a=this.hot.getCellMeta(n,o),l=a.dateFormat;isDate(s,a.type)&&(e=!0,isDateValid(s,l)?r[n][o]=getDateInHfFormat(s,l):this.isFormulaCellType(n,o)===!1&&(r[n][o]=`'${s}`))})}),e===!0&&(_classPrivateFieldSet$k(_internalOperationPending,this,!0),this.engine.setSheetContent(this.sheetId,r),_classPrivateFieldSet$k(_internalOperationPending,this,!1))}function _onAfterLoadData$3(r,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$i)))if(this.sheetName=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$i].sheetName),_classPrivateFieldGet$m(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){_classPrivateFieldSet$k(_internalOperationPending,this,!0);const s=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),_classPrivateFieldSet$k(_internalOperationPending,this,!1)}}}function _onModifyData(r,e,t,n){if(n!=="get"||_classPrivateFieldGet$m(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(r);if(s===null||e===null)return;if(!this.isFormulaCellType(s,e)&&this.getCellType(s,e)!=="ARRAY"){isEscapedFormulaExpression(t.value)&&(t.value=unescapeFormulaExpression(t.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(a),u=this.hot.getCellsMeta().find(h=>h.visualRow===s&&h.visualCol===e);u===void 0&&(u={}),u.type==="date"&&isNumeric(l)&&(l=getDateFromExcelDate(l,u.dateFormat));const c=typeof l=="object"&&l!==null?l.value:l;t.value=c}function _onModifySourceData(r,e,t,n){if(n!=="get"||_classPrivateFieldGet$m(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(r),o=this.hot.propToCol(e);if(s===null||o===null||!this.isFormulaCellType(s,o)&&this.getCellType(s,o)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};t.value=this.engine.getCellSerialized(u)}function _onAfterSetDataAtCell(r,e){if(isBlockedSource(e))return;const t=[],n=[],s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,,u]=o;const c=this.hot.propToCol(l),h=this.hot.toPhysicalRow(a),g=this.hot.toPhysicalColumn(c),v={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};h!==null&&g!==null?this.syncChangeWithEngine(a,c,u):t.push([a,c,u]),n.push({address:v})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{t.forEach(a=>{let[l,u,c]=a;this.syncChangeWithEngine(l,u,c)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,n)}function _onAfterSetSourceDataAtCell(r,e){if(isBlockedSource(e))return;const t=[],n=[];r.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a);if(!isNumeric(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){warn$1(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),t.push(...this.engine.setCellContents(c,l))}),this.renderDependentSheets(t),this.validateDependentCells(t,n)}function _onBeforeCreateRow(r,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countRows()&&(t=r),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function _onBeforeCreateCol(r,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countCols()&&(t=r),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function _onBeforeRemoveRow$1(r,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function _onBeforeRemoveCol(r,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function _onAfterCreateRow$2(r,e,t){if(isBlockedSource(t))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(r),e]);this.renderDependentSheets(n)}function _onAfterCreateCol$1(r,e,t){if(isBlockedSource(t))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(r),e]);this.renderDependentSheets(n)}function _onAfterRemoveRow$2(r,e,t,n){if(isBlockedSource(n))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,l)=>l-a),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function _onAfterRemoveCol$1(r,e,t,n){if(isBlockedSource(n))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,l)=>l-a),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function _onAfterDetachChild$1(r,e,t){var n;_classPrivateFieldSet$k(_internalOperationPending,this,!0);const s=this.hot.getSourceDataArray(t,0,t+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$k(_internalOperationPending,this,!1),s.forEach((o,a)=>{o.forEach((l,u)=>{this.engine.setCellContents({col:u,row:t+a,sheet:this.sheetId},[[l]])})})}function _onEngineValuesUpdated(r){this.hot.runHooks("afterFormulasValuesUpdate",r)}function _onEngineNamedExpressionsAdded(r,e){this.hot.runHooks("afterNamedExpressionAdded",r,e)}function _onEngineNamedExpressionsRemoved(r,e){this.hot.runHooks("afterNamedExpressionRemoved",r,e)}function _onEngineSheetAdded(r){this.hot.runHooks("afterSheetAdded",r)}function _onEngineSheetRenamed(r,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",r,e)}function _onEngineSheetRemoved(r,e){this.hot.runHooks("afterSheetRemoved",r,e)}function hideColumnItem(r){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,s]=e;n-s!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),o=[];for(let u=n;u<=s;u+=1)o.push(u);r.hideColumns(o);const a=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function showColumnItem(r){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback(){var t,n;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&n!==void 0?n:this.countCols()-1,r.showColumns(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countCols()||this.selectColumns(s,o)},disabled:!1,hidden(){const t=arrayMap(r.getHiddenColumns(),g=>this.toPhysicalColumn(g));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().col,o=n.getBottomEndCorner().col,a=this.columnIndexMapper,l=a.getRenderableFromVisualIndex(s),u=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),h=[];if(s!==o){const g=o-s+1,v=u-l+1;if(g>v){const m=c.slice(s,o+1);h.push(...m.filter(E=>t.includes(E)))}}else if(l===0&&l<s)h.push(...c.slice(0,s));else if(l===null)h.push(...c.slice(0,this.countCols()));else{const g=this.countCols()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(g,-1));u===v&&g>o&&h.push(...c.slice(o+1))}return arrayEach(h,g=>{e.push(this.toVisualColumn(g))}),e.length===0}}}function _classPrivateMethodInitSpec$j(r,e){_checkPrivateRedeclaration$q(r,e),e.add(r)}function _classPrivateFieldInitSpec$l(r,e,t){_checkPrivateRedeclaration$q(r,e),e.set(r,t)}function _checkPrivateRedeclaration$q(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$l(r,e){return r.get(_assertClassBrand$q(r,e))}function _classPrivateFieldSet$j(r,e,t){return r.set(_assertClassBrand$q(r,e),t),t}function _assertClassBrand$q(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideColumns");Hooks.getSingleton().register("afterHideColumns");Hooks.getSingleton().register("beforeUnhideColumns");Hooks.getSingleton().register("afterUnhideColumns");const PLUGIN_KEY$h="hiddenColumns",PLUGIN_PRIORITY$g=310;var _hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet;class HiddenColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$j(this,_HiddenColumns_brand),_classPrivateFieldInitSpec$l(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$h}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$g}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$h]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$j(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet$l(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand$q(_HiddenColumns_brand,this,_onMapInit$4).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$l(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$q(_HiddenColumns_brand,e,_onAfterContextMenuDefaultOptions$2).call(e,...n)}),this.addHook("afterGetCellMeta",(t,n,s)=>_assertClassBrand$q(_HiddenColumns_brand,this,_onAfterGetCellMeta$2).call(this,t,n,s)),this.addHook("modifyColWidth",(t,n)=>_assertClassBrand$q(_HiddenColumns_brand,this,_onModifyColWidth$3).call(this,t,n),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$q(_HiddenColumns_brand,e,_onAfterGetColHeader).call(e,...n)}),this.addHook("modifyCopyableRange",t=>_assertClassBrand$q(_HiddenColumns_brand,this,_onModifyCopyableRange$1).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let s=t;const o=_classPrivateFieldGet$l(_hiddenColumnsMap,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalColumn(c));arrayEach(u,c=>{o[c]=!1}),s=arrayReduce(o,(c,h,g)=>(h&&c.push(this.hot.toVisualColumn(g)),c),[])}this.hot.runHooks("beforeUnhideColumns",t,s,n&&a)!==!1&&(n&&a&&_classPrivateFieldGet$l(_hiddenColumnsMap,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,n&&a,n&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet$l(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,n,n&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return arrayMap(_classPrivateFieldGet$l(_hiddenColumnsMap,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _classPrivateFieldGet$l(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){_classPrivateFieldSet$j(_hiddenColumnsMap,this,null),super.destroy()}}function _onModifyColWidth$3(r,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof r=="number"&&this.hot.hasColHeaders())return r+15}function _onAfterGetCellMeta$2(r,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const n=t.className.split(" ");if(n.length>0){const s=n.indexOf("afterHiddenColumn");s>-1&&n.splice(s,1),t.className=n.join(" ")}}}function _onModifyCopyableRange$1(r){if(this.getSetting("copyPasteEnabled"))return r;const e=[],t=(n,s,o,a)=>{e.push({startRow:n,endRow:s,startCol:o,endCol:a})};return arrayEach(r,n=>{let s=!0,o=0;rangeEach(n.startCol,n.endCol,a=>{this.isHidden(a)?(s||t(n.startRow,n.endRow,o,a-1),s=!0):(s&&(o=a),a===n.endCol&&t(n.startRow,n.endRow,o,a),s=!1)})}),e}function _onAfterGetColHeader(r,e){if(!this.getSetting("indicators")||r<0)return;const t=[];r>=1&&this.isHidden(r-1)&&t.push("afterHiddenColumn"),r<this.hot.countCols()-1&&this.isHidden(r+1)&&t.push("beforeHiddenColumn"),addClass$1(e,t)}function _onAfterContextMenuDefaultOptions$2(r){r.items.push({name:KEY$c},hideColumnItem(this),showColumnItem(this))}function _onMapInit$4(){const r=this.getSetting("columns");Array.isArray(r)&&this.hideColumns(r)}function hideRowItem(r){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,s]=e;n-s!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),o=[];for(let u=n;u<=s;u+=1)o.push(u);r.hideRows(o);const a=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function showRowItem(r){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var t,n;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&n!==void 0?n:this.countRows()-1,r.showRows(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countRows()||this.selectRows(s,o)},disabled:!1,hidden(){const t=arrayMap(r.getHiddenRows(),g=>this.toPhysicalRow(g));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().row,o=n.getBottomEndCorner().row,a=this.rowIndexMapper,l=a.getRenderableFromVisualIndex(s),u=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),h=[];if(s!==o){const g=o-s+1,v=u-l+1;if(g>v){const m=c.slice(s,o+1);h.push(...m.filter(E=>t.includes(E)))}}else if(l===0&&l<s)h.push(...c.slice(0,s));else if(l===null)h.push(...c.slice(0,this.countRows()));else{const g=this.countRows()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(g,-1));u===v&&g>o&&h.push(...c.slice(o+1))}return arrayEach(h,g=>{e.push(this.toVisualRow(g))}),e.length===0}}}function _classPrivateMethodInitSpec$i(r,e){_checkPrivateRedeclaration$p(r,e),e.add(r)}function _classPrivateFieldInitSpec$k(r,e,t){_checkPrivateRedeclaration$p(r,e),e.set(r,t)}function _checkPrivateRedeclaration$p(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$k(r,e){return r.get(_assertClassBrand$p(r,e))}function _classPrivateFieldSet$i(r,e,t){return r.set(_assertClassBrand$p(r,e),t),t}function _assertClassBrand$p(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideRows");Hooks.getSingleton().register("afterHideRows");Hooks.getSingleton().register("beforeUnhideRows");Hooks.getSingleton().register("afterUnhideRows");const PLUGIN_KEY$g="hiddenRows",PLUGIN_PRIORITY$f=320;var _hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet;class HiddenRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$i(this,_HiddenRows_brand),_classPrivateFieldInitSpec$k(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$g}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$f}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$g]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$i(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet$k(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand$p(_HiddenRows_brand,this,_onMapInit$3).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$k(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$p(_HiddenRows_brand,e,_onAfterContextMenuDefaultOptions$1).call(e,...n)}),this.addHook("afterGetCellMeta",(t,n,s)=>_assertClassBrand$p(_HiddenRows_brand,this,_onAfterGetCellMeta$1).call(this,t,n,s)),this.addHook("modifyRowHeight",(t,n)=>_assertClassBrand$p(_HiddenRows_brand,this,_onModifyRowHeight$1).call(this,t,n)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$p(_HiddenRows_brand,e,_onAfterGetRowHeader$1).call(e,...n)}),this.addHook("modifyCopyableRange",t=>_assertClassBrand$p(_HiddenRows_brand,this,_onModifyCopyableRange).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let s=t;const o=_classPrivateFieldGet$k(_hiddenRowsMap,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalRow(c));arrayEach(u,c=>{o[c]=!1}),s=arrayReduce(o,(c,h,g)=>(h&&c.push(this.hot.toVisualRow(g)),c),[])}this.hot.runHooks("beforeUnhideRows",t,s,n&&a)!==!1&&(n&&a&&_classPrivateFieldGet$k(_hiddenRowsMap,this).setValues(o),this.hot.runHooks("afterUnhideRows",t,s,n&&a,n&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet$k(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,n,n&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return arrayMap(_classPrivateFieldGet$k(_hiddenRowsMap,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _classPrivateFieldGet$k(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_classPrivateFieldSet$i(_hiddenRowsMap,this,null),super.destroy()}}function _onModifyRowHeight$1(r,e){return this.isHidden(e)?0:r}function _onAfterGetCellMeta$1(r,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(r)&&(t.skipRowOnPaste=!0),this.isHidden(r-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const n=t.className.split(" ");if(n.length>0){const s=n.indexOf("afterHiddenRow");s>-1&&n.splice(s,1),t.className=n.join(" ")}}}function _onModifyCopyableRange(r){if(this.getSetting("copyPasteEnabled"))return r;const e=[],t=(n,s,o,a)=>{e.push({startRow:n,endRow:s,startCol:o,endCol:a})};return arrayEach(r,n=>{let s=!0,o=0;rangeEach(n.startRow,n.endRow,a=>{this.isHidden(a)?(s||t(o,a-1,n.startCol,n.endCol),s=!0):(s&&(o=a),a===n.endRow&&t(o,a,n.startCol,n.endCol),s=!1)})}),e}function _onAfterGetRowHeader$1(r,e){if(!this.getSetting("indicators")||r<0)return;const t=[];r>=1&&this.isHidden(r-1)&&t.push("afterHiddenRow"),r<this.hot.countRows()-1&&this.isHidden(r+1)&&t.push("beforeHiddenRow"),addClass$1(e,t)}function _onAfterContextMenuDefaultOptions$1(r){r.items.push({name:KEY$c},hideRowItem(this),showRowItem(this))}function _onMapInit$3(){const r=this.getSetting("rows");Array.isArray(r)&&this.hideRows(r)}function freezeColumnItem(r){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,t){const[{start:{col:n}}]=t;r.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function unfreezeColumnItem(r){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){const[{start:{col:n}}]=t;r.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function _classPrivateMethodInitSpec$h(r,e){_checkPrivateRedeclaration$o(r,e),e.add(r)}function _classPrivateFieldInitSpec$j(r,e,t){_checkPrivateRedeclaration$o(r,e),e.set(r,t)}function _checkPrivateRedeclaration$o(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$j(r,e){return r.get(_assertClassBrand$o(r,e))}function _classPrivateFieldSet$h(r,e,t){return r.set(_assertClassBrand$o(r,e),t),t}function _assertClassBrand$o(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnFreeze");Hooks.getSingleton().register("afterColumnFreeze");Hooks.getSingleton().register("beforeColumnUnfreeze");Hooks.getSingleton().register("afterColumnUnfreeze");const PLUGIN_KEY$f="manualColumnFreeze",PLUGIN_PRIORITY$e=110;var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet;class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$h(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec$j(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$f}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$e}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$f]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$o(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>_assertClassBrand$o(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,e,t)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet$h(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;_classPrivateFieldGet$j(_afterFirstUse,this)||_classPrivateFieldSet$h(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;_classPrivateFieldGet$j(_afterFirstUse,this)||_classPrivateFieldSet$h(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function _addContextMenuEntry(r){r.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(r,e){if(_classPrivateFieldGet$j(_afterFirstUse,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||r.some(n=>n<t))return!1}}function _defineProperty$y(r,e,t){return(e=_toPropertyKey$z(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$z(r){var e=_toPrimitive$z(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$z(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px";let BaseUI$2=class{constructor(e){_defineProperty$y(this,"hot",void 0),_defineProperty$y(this,"_element",null),_defineProperty$y(this,"state",STATE_INITIALIZED$1),_defineProperty$y(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED$1}build(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}isAppended(){return this.state===STATE_APPENDED$1}isBuilt(){return this.state>=STATE_BUILT$1}setPosition(e,t){isNumeric(e)&&(this._element.style.top=e+UNIT$1),isNumeric(t)&&(this._element.style[this.inlineProperty]=t+UNIT$1)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){isNumeric(e)&&(this._element.style.width=e+UNIT$1),isNumeric(t)&&(this._element.style.height=t+UNIT$1)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){isNumeric(e)&&(this._element.style.marginTop=e+UNIT$1),isNumeric(t)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=t+UNIT$1)}getOffset(){const e=this._element.style,t=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const CSS_CLASSNAME$3="ht__manualColumnMove--backlight";let BacklightUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$3)}};const CSS_CLASSNAME$2="ht__manualColumnMove--guideline";let GuidelineUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$2)}};function _classPrivateMethodInitSpec$g(r,e){_checkPrivateRedeclaration$n(r,e),e.add(r)}function _classPrivateFieldInitSpec$i(r,e,t){_checkPrivateRedeclaration$n(r,e),e.set(r,t)}function _checkPrivateRedeclaration$n(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$g(r,e,t){return r.set(_assertClassBrand$n(r,e),t),t}function _classPrivateFieldGet$i(r,e){return r.get(_assertClassBrand$n(r,e))}function _assertClassBrand$n(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnMove");Hooks.getSingleton().register("afterColumnMove");const PLUGIN_KEY$e="manualColumnMove",PLUGIN_PRIORITY$d=120,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns";var _backlight$1=new WeakMap,_guideline$1=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed$3=new WeakMap,_target$1=new WeakMap,_cachedDropIndex$1=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet;class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$g(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec$i(this,_backlight$1,new BacklightUI$1(this.hot)),_classPrivateFieldInitSpec$i(this,_guideline$1,new GuidelineUI$1(this.hot)),_classPrivateFieldInitSpec$i(this,_columnsToMove,[]),_classPrivateFieldInitSpec$i(this,_countCols,0),_classPrivateFieldInitSpec$i(this,_pressed$3,!1),_classPrivateFieldInitSpec$i(this,_target$1,{}),_classPrivateFieldInitSpec$i(this,_cachedDropIndex$1,void 0),_classPrivateFieldInitSpec$i(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec$i(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec$i(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec$i(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$e}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$d}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$e]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onBeforeOnCellMouseDown$3).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onBeforeOnCellMouseOver$2).call(e,...n)}),this.addHook("afterScrollVertically",()=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$n(_ManualColumnMove_brand,e,_onAfterLoadData$2).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),_classPrivateFieldGet$i(_backlight$1,this).destroy(),_classPrivateFieldGet$i(_guideline$1,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=_classPrivateFieldGet$i(_cachedDropIndex$1,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,n,s);if(_classPrivateFieldSet$g(_cachedDropIndex$1,this,void 0),o===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=s&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,s,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return _classPrivateFieldSet$g(_cachedDropIndex$1,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>n,o=t<0,a=e.some(u=>u<0),l=e.some(u=>u>=n);return!(s||o||a||l)}isColumnOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}countFinalIndex(e,t){const n=arrayReduce(e,(s,o)=>(o<t&&(s+=1),s),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let s=0;for(let o=e;o<=t;o+=1){const a=n.getRenderableFromVisualIndex(o);o<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$e];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return rangeEach(e,t,s=>{n.push(s)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet$i(_hoveredColumn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet$i(_hoveredColumn,this)-1);const a=t.hider.offsetWidth,l=t.TBODY.offsetLeft,u=_classPrivateFieldGet$i(_backlight$1,this).getOffset().start,c=_classPrivateFieldGet$i(_backlight$1,this).getSize().width;let h=0,g=0;if(this.hot.isRtl()){const E=this.hot.rootWindow,_=outerWidth(this.hot.rootElement),S=E.innerWidth-_classPrivateFieldGet$i(_rootElementOffset,this)-_;g=E.innerWidth-_classPrivateFieldGet$i(_target$1,this).eventPageX-S-(n.scrollX===void 0?s:0)}else g=_classPrivateFieldGet$i(_target$1,this).eventPageX-(_classPrivateFieldGet$i(_rootElementOffset,this)-(n.scrollX===void 0?s:0));if(_classPrivateFieldGet$i(_hasRowHeaders,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet$i(_hoveredColumn,this))&&(o+=s),o+=h,_classPrivateFieldGet$i(_hoveredColumn,this)<0)_classPrivateFieldGet$i(_fixedColumnsStart,this)>0?_classPrivateFieldGet$i(_target$1,this).col=0:_classPrivateFieldGet$i(_target$1,this).col=e>0?e-1:e;else if(_classPrivateFieldGet$i(_target$1,this).TD.offsetWidth/2+o<=g){const E=_classPrivateFieldGet$i(_hoveredColumn,this)>=_classPrivateFieldGet$i(_countCols,this)?_classPrivateFieldGet$i(_countCols,this)-1:_classPrivateFieldGet$i(_hoveredColumn,this);_classPrivateFieldGet$i(_target$1,this).col=E+1,o+=_classPrivateFieldGet$i(_target$1,this).TD.offsetWidth}else _classPrivateFieldGet$i(_target$1,this).col=_classPrivateFieldGet$i(_hoveredColumn,this);let v=g,m=o;g+c+u>=a?v=a-c-u:g+u<l+h&&(v=l+h+Math.abs(u)),o>=a-1?m=a-1:m===0?m=1:n.scrollX!==void 0&&_classPrivateFieldGet$i(_hoveredColumn,this)<_classPrivateFieldGet$i(_fixedColumnsStart,this)&&(m-=_classPrivateFieldGet$i(_rootElementOffset,this)<=n.scrollX?_classPrivateFieldGet$i(_rootElementOffset,this):0),_classPrivateFieldGet$i(_backlight$1,this).setPosition(null,v),_classPrivateFieldGet$i(_guideline$1,this).setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onMouseMove$3).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$n(_ManualColumnMove_brand,this,_onMouseUp$3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$i(_backlight$1,this).build(),_classPrivateFieldGet$i(_guideline$1,this).build()}destroy(){_classPrivateFieldGet$i(_backlight$1,this).destroy(),_classPrivateFieldGet$i(_guideline$1,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$3(r,e,t,n){const s=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=hasClass$1(r.target,"sortAction");if(!a||!o||_classPrivateFieldGet$i(_pressed$3,this)||r.button!==0||l){_classPrivateFieldSet$g(_pressed$3,this,!1),_classPrivateFieldGet$i(_columnsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}const u=_classPrivateFieldGet$i(_guideline$1,this).isBuilt()&&!_classPrivateFieldGet$i(_guideline$1,this).isAppended(),c=_classPrivateFieldGet$i(_backlight$1,this).isBuilt()&&!_classPrivateFieldGet$i(_backlight$1,this).isAppended();u&&c&&(_classPrivateFieldGet$i(_guideline$1,this).appendTo(s.hider),_classPrivateFieldGet$i(_backlight$1,this).appendTo(s.hider));const{from:h,to:g}=a,v=Math.min(h.col,g.col),m=Math.max(h.col,g.col);if(e.row<0&&e.col>=v&&e.col<=m){n.column=!0,_classPrivateFieldSet$g(_pressed$3,this,!0);const E=t.firstChild?offsetRelativeTo(r,t.firstChild).x:r.offsetX;_classPrivateFieldGet$i(_target$1,this).eventPageX=r.pageX,_classPrivateFieldSet$g(_hoveredColumn,this,e.col),_classPrivateFieldGet$i(_target$1,this).TD=t,_classPrivateFieldGet$i(_target$1,this).col=e.col,_classPrivateFieldSet$g(_columnsToMove,this,this.prepareColumnsToMoving(v,m)),_classPrivateFieldSet$g(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet$g(_countCols,this,this.hot.countCols()),_classPrivateFieldSet$g(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet$g(_rootElementOffset,this,offset(this.hot.rootElement).left);const _=_classPrivateFieldGet$i(_hasRowHeaders,this)?-1:0,S=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,w=e.col<_classPrivateFieldGet$i(_fixedColumnsStart,this),A=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(E-(this.hot.isRtl()?t.offsetWidth:0)),D=this.getColumnsWidth(v,e.col-1)+O,Y=this.getColumnsWidth(_,v-1)+(w?A:0)+D;_classPrivateFieldGet$i(_backlight$1,this).setPosition(S,Y),_classPrivateFieldGet$i(_backlight$1,this).setSize(this.getColumnsWidth(v,m),s.hider.offsetHeight-S),_classPrivateFieldGet$i(_backlight$1,this).setOffset(null,-D),addClass$1(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),_classPrivateFieldSet$g(_pressed$3,this,!1),_classPrivateFieldGet$i(_columnsToMove,this).length=0}function _onMouseMove$3(r){_classPrivateFieldGet$i(_pressed$3,this)&&(_classPrivateFieldGet$i(_target$1,this).eventPageX=r.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver$2(r,e,t,n){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$i(_pressed$3,this)||(_classPrivateFieldGet$i(_columnsToMove,this).indexOf(e.col)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI$1):addClass$1(this.hot.rootElement,CSS_SHOW_UI$1),n.row=!0,n.column=!0,n.cell=!0,_classPrivateFieldSet$g(_hoveredColumn,this,e.col),_classPrivateFieldGet$i(_target$1,this).TD=t)}function _onMouseUp$3(){const r=_classPrivateFieldGet$i(_target$1,this).col,e=_classPrivateFieldGet$i(_columnsToMove,this).length;if(_classPrivateFieldSet$g(_hoveredColumn,this,void 0),_classPrivateFieldSet$g(_pressed$3,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),e<1||r===void 0)return;const t=_classPrivateFieldGet$i(_columnsToMove,this)[0],n=this.hot.toPhysicalColumn(t),s=this.dragColumns(_classPrivateFieldGet$i(_columnsToMove,this),r);if(_classPrivateFieldGet$i(_columnsToMove,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(n),a=o+e-1;this.hot.selectColumns(o,a)}}function _onAfterScrollVertically(){const r=this.hot.view._wt.wtTable,e=r.getColumnHeaderHeight(0)+1,t=r.holder.scrollTop,n=e+t;_classPrivateFieldGet$i(_backlight$1,this).setPosition(n),_classPrivateFieldGet$i(_backlight$1,this).setSize(null,r.hider.offsetHeight-n)}function _onAfterLoadData$2(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$f(r,e){_checkPrivateRedeclaration$m(r,e),e.add(r)}function _classPrivateFieldInitSpec$h(r,e,t){_checkPrivateRedeclaration$m(r,e),e.set(r,t)}function _checkPrivateRedeclaration$m(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$f(r,e,t){return r.set(_assertClassBrand$m(r,e),t),t}function _classPrivateFieldGet$h(r,e){return r.get(_assertClassBrand$m(r,e))}function _assertClassBrand$m(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$d="manualColumnResize",PLUGIN_PRIORITY$c=130,PERSISTENT_STATE_KEY$1="manualColumnWidths";var _currentTH$1=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize$1=new WeakMap,_startY$1=new WeakMap,_startWidth=new WeakMap,_startOffset$1=new WeakMap,_handle$1=new WeakMap,_guide$1=new WeakMap,_pressed$2=new WeakMap,_isTriggeredByRMB$1=new WeakMap,_dblclick$1=new WeakMap,_autoresizeTimeout$1=new WeakMap,_columnWidthsMap=new WeakMap,_config$1=new WeakMap,_ManualColumnResize_brand=new WeakSet;class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$d}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$c}constructor(e){super(e),_classPrivateMethodInitSpec$f(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec$h(this,_currentTH$1,null),_classPrivateFieldInitSpec$h(this,_currentCol,null),_classPrivateFieldInitSpec$h(this,_selectedCols,[]),_classPrivateFieldInitSpec$h(this,_currentWidth,null),_classPrivateFieldInitSpec$h(this,_newSize$1,null),_classPrivateFieldInitSpec$h(this,_startY$1,null),_classPrivateFieldInitSpec$h(this,_startWidth,null),_classPrivateFieldInitSpec$h(this,_startOffset$1,null),_classPrivateFieldInitSpec$h(this,_handle$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$h(this,_guide$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$h(this,_pressed$2,null),_classPrivateFieldInitSpec$h(this,_isTriggeredByRMB$1,!1),_classPrivateFieldInitSpec$h(this,_dblclick$1,0),_classPrivateFieldInitSpec$h(this,_autoresizeTimeout$1,null),_classPrivateFieldInitSpec$h(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec$h(this,_config$1,void 0),addClass$1(_classPrivateFieldGet$h(_handle$1,this),"manualColumnResizer"),addClass$1(_classPrivateFieldGet$h(_guide$1,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$d]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldSet$f(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$h(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMapInit$2).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$h(_columnWidthsMap,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onModifyColWidth$2).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onBeforeStretchingColumnWidth).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$m(_ManualColumnResize_brand,e,_onBeforeColumnResize).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$f(_config$1,this,_classPrivateFieldGet$h(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,_classPrivateFieldGet$h(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,e),e.value}setManualSize(e,t){const n=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return _classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(s,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;_classPrivateFieldSet$f(_currentTH$1,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(_classPrivateFieldGet$h(_currentTH$1,this)),s=n.col;if(s<0)return;const o=outerHeight(_classPrivateFieldGet$h(_currentTH$1,this)),a=_classPrivateFieldGet$h(_currentTH$1,this).getBoundingClientRect(),l=s<t.getSetting("fixedColumnsStart");let u;l&&(u=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$h(_currentTH$1,this),n.row,n.col)),u||(u=t.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet$h(_currentTH$1,this),n.row,n.col)),_classPrivateFieldSet$f(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),_classPrivateFieldSet$f(_selectedCols,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const h=this.hot.getSelectedRange();arrayEach(h,g=>{const v=g.getTopStartCorner().col,m=g.getBottomEndCorner().col;rangeEach(v,m,E=>{_classPrivateFieldGet$h(_selectedCols,this).includes(E)||_classPrivateFieldGet$h(_selectedCols,this).push(E)})})}_classPrivateFieldGet$h(_selectedCols,this).includes(_classPrivateFieldGet$h(_currentCol,this))||_classPrivateFieldSet$f(_selectedCols,this,[_classPrivateFieldGet$h(_currentCol,this)]),_classPrivateFieldSet$f(_startOffset$1,this,u.start-6),_classPrivateFieldSet$f(_startWidth,this,parseInt(a.width,10)),_classPrivateFieldGet$h(_handle$1,this).style.top=`${u.top}px`,_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$h(_startOffset$1,this)+_classPrivateFieldGet$h(_startWidth,this)}px`,_classPrivateFieldGet$h(_handle$1,this).style.height=`${o}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$h(_handle$1,this))}refreshHandlePosition(){_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$h(_startOffset$1,this)+_classPrivateFieldGet$h(_currentWidth,this)}px`}setupGuidePosition(){const e=parseInt(outerHeight(_classPrivateFieldGet$h(_handle$1,this)),10),t=parseInt(_classPrivateFieldGet$h(_handle$1,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass$1(_classPrivateFieldGet$h(_handle$1,this),"active"),addClass$1(_classPrivateFieldGet$h(_guide$1,this),"active"),_classPrivateFieldGet$h(_guide$1,this).style.top=`${t}px`,this.refreshGuidePosition(),_classPrivateFieldGet$h(_guide$1,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$h(_guide$1,this))}refreshGuidePosition(){_classPrivateFieldGet$h(_guide$1,this).style[this.inlineDir]=_classPrivateFieldGet$h(_handle$1,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$h(_handle$1,this),"active"),removeClass$1(_classPrivateFieldGet$h(_guide$1,this),"active")}checkIfColumnHeader(e){const t=closest(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(n,s)=>{const o=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$h(_newSize$1,this),n,!0);o!==void 0&&_classPrivateFieldSet$f(_newSize$1,this,o),this.setManualSize(n,_classPrivateFieldGet$h(_newSize$1,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$h(_newSize$1,this),n,!0),s&&e()};_classPrivateFieldGet$h(_dblclick$1,this)>=2&&(_classPrivateFieldGet$h(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$h(_selectedCols,this),s=>{t(s)}),e()):arrayEach(_classPrivateFieldGet$h(_selectedCols,this),s=>{t(s,!0)})),_classPrivateFieldSet$f(_dblclick$1,this,0),_classPrivateFieldSet$f(_autoresizeTimeout$1,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseOver$1).call(this,n)),this.eventManager.addEventListener(t,"mousedown",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseDown$1).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseMove$2).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onMouseUp$2).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$h(_handle$1,this),"contextmenu",()=>_assertClassBrand$m(_ManualColumnResize_brand,this,_onContextMenu$1).call(this))}destroy(){super.destroy()}}function _onMapInit$2(){const r=this.hot.getSettings()[PLUGIN_KEY$d],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0):Array.isArray(r)?(this.hot.batchExecution(()=>{r.forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0),_classPrivateFieldSet$f(_config$1,this,r)):r===!0&&Array.isArray(_classPrivateFieldGet$h(_config$1,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet$h(_config$1,this).forEach((t,n)=>{_classPrivateFieldGet$h(_columnWidthsMap,this).setValueAtIndex(n,t)})},!0)}function _onMouseOver$1(r){if(!isDetached(r.target)&&_classPrivateFieldGet$h(_isTriggeredByRMB$1,this)!==!0&&this.checkIfColumnHeader(r.target)){const e=this.getClosestTHParent(r.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(_classPrivateFieldGet$h(_pressed$2,this)||this.setupHandlePosition(e))}}function _onMouseDown$1(r){r.target.parentNode===this.hot.rootElement&&hasClass$1(r.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$h(_currentTH$1,this)),this.setupGuidePosition(),_classPrivateFieldSet$f(_pressed$2,this,!0),_classPrivateFieldGet$h(_autoresizeTimeout$1,this)===null&&(_classPrivateFieldSet$f(_autoresizeTimeout$1,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$h(_autoresizeTimeout$1,this))),_classPrivateFieldSet$f(_dblclick$1,this,_classPrivateFieldGet$h(_dblclick$1,this)+1),this.startX=r.pageX,_classPrivateFieldSet$f(_newSize$1,this,_classPrivateFieldGet$h(_startWidth,this)))}function _onMouseMove$2(r){if(_classPrivateFieldGet$h(_pressed$2,this)){const e=(r.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet$f(_currentWidth,this,_classPrivateFieldGet$h(_startWidth,this)+e),arrayEach(_classPrivateFieldGet$h(_selectedCols,this),t=>{_classPrivateFieldSet$f(_newSize$1,this,this.setManualSize(t,_classPrivateFieldGet$h(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp$2(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,n)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$h(_newSize$1,this),t,!1),n&&r(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$h(_newSize$1,this),t,!1)};_classPrivateFieldGet$h(_pressed$2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$f(_pressed$2,this,!1),_classPrivateFieldGet$h(_newSize$1,this)!==_classPrivateFieldGet$h(_startWidth,this)&&(_classPrivateFieldGet$h(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$h(_selectedCols,this),n=>{e(n)}),r()):arrayEach(_classPrivateFieldGet$h(_selectedCols,this),n=>{e(n,!0)})),this.setupHandlePosition(_classPrivateFieldGet$h(_currentTH$1,this)))}function _onContextMenu$1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$h(_handle$1,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$h(_guide$1,this)),_classPrivateFieldSet$f(_pressed$2,this,!1),_classPrivateFieldSet$f(_isTriggeredByRMB$1,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$f(_isTriggeredByRMB$1,this,!1)})}function _onModifyColWidth$2(r,e){let t=r;if(this.enabled){const n=this.hot.toPhysicalColumn(e),s=_classPrivateFieldGet$h(_columnWidthsMap,this).getValueAtIndex(n);this.hot.getSettings()[PLUGIN_KEY$d]&&s&&(t=s)}return t}function _onBeforeStretchingColumnWidth(r,e){const t=_classPrivateFieldGet$h(_columnWidthsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof t=="number"?t:r}function _onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function _defineProperty$x(r,e,t){return(e=_toPropertyKey$y(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$y(r){var e=_toPrimitive$y(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$y(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px";let BaseUI$1=class{constructor(e){_defineProperty$x(this,"hot",void 0),_defineProperty$x(this,"_element",null),_defineProperty$x(this,"state",STATE_INITIALIZED),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT}setPosition(e,t){e!==void 0&&(this._element.style.top=e+UNIT),t!==void 0&&(this._element.style.left=t+UNIT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+UNIT),t&&(this._element.style.height=t+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+UNIT),t&&(this._element.style.marginLeft=t+UNIT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const CSS_CLASSNAME$1="ht__manualRowMove--backlight";class BacklightUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$1)}}const CSS_CLASSNAME="ht__manualRowMove--guideline";class GuidelineUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME)}}function _classPrivateMethodInitSpec$e(r,e){_checkPrivateRedeclaration$l(r,e),e.add(r)}function _classPrivateFieldInitSpec$g(r,e,t){_checkPrivateRedeclaration$l(r,e),e.set(r,t)}function _checkPrivateRedeclaration$l(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$e(r,e,t){return r.set(_assertClassBrand$l(r,e),t),t}function _classPrivateFieldGet$g(r,e){return r.get(_assertClassBrand$l(r,e))}function _assertClassBrand$l(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeRowMove");Hooks.getSingleton().register("afterRowMove");const PLUGIN_KEY$c="manualRowMove",PLUGIN_PRIORITY$b=140,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows";var _backlight=new WeakMap,_guideline=new WeakMap,_rowsToMove=new WeakMap,_pressed$1=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet;class ManualRowMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$e(this,_ManualRowMove_brand),_classPrivateFieldInitSpec$g(this,_backlight,new BacklightUI(this.hot)),_classPrivateFieldInitSpec$g(this,_guideline,new GuidelineUI(this.hot)),_classPrivateFieldInitSpec$g(this,_rowsToMove,[]),_classPrivateFieldInitSpec$g(this,_pressed$1,void 0),_classPrivateFieldInitSpec$g(this,_target,{}),_classPrivateFieldInitSpec$g(this,_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$c}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$b}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$c]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onBeforeOnCellMouseDown$2).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onBeforeOnCellMouseOver$1).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand$l(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$l(_ManualRowMove_brand,e,_onAfterLoadData$1).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet$g(_backlight,this).destroy(),_classPrivateFieldGet$g(_guideline,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=_classPrivateFieldGet$g(_cachedDropIndex,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,n,s);if(_classPrivateFieldSet$e(_cachedDropIndex,this,void 0),o===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=s&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,s,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return _classPrivateFieldSet$e(_cachedDropIndex,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>n,o=t<0,a=e.some(u=>u<0),l=e.some(u=>u>=n);return!(s||o||a||l)}isRowOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}countFinalIndex(e,t){const n=arrayReduce(e,(s,o)=>(o<t&&(s+=1),s),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let s=0;for(let o=e;o<=t;o++){const a=n.getRenderableFromVisualIndex(o);a!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$c];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:s}=e,o=Math.min(n.row,s.row),a=Math.max(n.row,s.row);return rangeEach(o,a,l=>{t.push(l)}),t}refreshPositions(){const e=_classPrivateFieldGet$g(_target,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=_classPrivateFieldGet$g(_target,this).TD,l=this.hot.rootElement,u=offset(l),c=getTrimmingContainer(l),h=o.holder.scrollTop,g=this.hot.rootWindow!==c?c.scrollTop:0,v=u.top-g,m=_classPrivateFieldGet$g(_target,this).eventPageY-v+h,E=o.hider.offsetHeight,_=o.TBODY.offsetTop,S=_classPrivateFieldGet$g(_backlight,this).getOffset().top,w=_classPrivateFieldGet$g(_backlight,this).getSize().height,A=a.offsetHeight/2,O=a.offsetHeight;let D=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const Y=m>=D+A;this.isFixedRowTop(e.row)&&(D+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_classPrivateFieldGet$g(_target,this).row=t>0?t-1:t:Y?(_classPrivateFieldGet$g(_target,this).row=e.row+1,D+=e.row===0?O-1:O):_classPrivateFieldGet$g(_target,this).row=e.row;let H=m,k=D;m+w+S>=E?H=E-w-S:m+S<_&&(H=_+Math.abs(S)),D>=E-1&&(k=E-1),_classPrivateFieldGet$g(_backlight,this).setPosition(H),_classPrivateFieldGet$g(_guideline,this).setPosition(k)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$l(_ManualRowMove_brand,this,_onMouseMove$1).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$l(_ManualRowMove_brand,this,_onMouseUp$1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$g(_backlight,this).build(),_classPrivateFieldGet$g(_guideline,this).build()}destroy(){_classPrivateFieldGet$g(_backlight,this).destroy(),_classPrivateFieldGet$g(_guideline,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$2(r,e,t,n){const{wtTable:s,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!a||_classPrivateFieldGet$g(_pressed$1,this)||r.button!==0){_classPrivateFieldSet$e(_pressed$1,this,!1),_classPrivateFieldGet$g(_rowsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const u=_classPrivateFieldGet$g(_guideline,this).isBuilt()&&!_classPrivateFieldGet$g(_guideline,this).isAppended(),c=_classPrivateFieldGet$g(_backlight,this).isBuilt()&&!_classPrivateFieldGet$g(_backlight,this).isAppended();u&&c&&(_classPrivateFieldGet$g(_guideline,this).appendTo(s.hider),_classPrivateFieldGet$g(_backlight,this).appendTo(s.hider));const{from:h,to:g}=l,v=Math.min(h.row,g.row),m=Math.max(h.row,g.row);if(e.col<0&&e.row>=v&&e.row<=m){n.row=!0,_classPrivateFieldSet$e(_pressed$1,this,!0),_classPrivateFieldGet$g(_target,this).eventPageY=r.pageY,_classPrivateFieldGet$g(_target,this).coords=e,_classPrivateFieldGet$g(_target,this).TD=t,_classPrivateFieldSet$e(_rowsToMove,this,this.prepareRowsToMoving());const E=s.holder.scrollLeft+o.getRowHeaderWidth(),_=this.getRowsHeight(v,e.row-1)+r.offsetY;_classPrivateFieldGet$g(_backlight,this).setPosition(null,E),_classPrivateFieldGet$g(_backlight,this).setSize(s.hider.offsetWidth-E,this.getRowsHeight(v,m)),_classPrivateFieldGet$g(_backlight,this).setOffset(-_,null),addClass$1(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet$e(_pressed$1,this,!1),_classPrivateFieldGet$g(_rowsToMove,this).length=0}function _onMouseMove$1(r){_classPrivateFieldGet$g(_pressed$1,this)&&(_classPrivateFieldGet$g(_target,this).eventPageY=r.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver$1(r,e,t,n){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$g(_pressed$1,this)||(_classPrivateFieldGet$g(_rowsToMove,this).indexOf(e.row)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI):addClass$1(this.hot.rootElement,CSS_SHOW_UI),n.row=!0,n.column=!0,n.cell=!0,_classPrivateFieldGet$g(_target,this).coords=e,_classPrivateFieldGet$g(_target,this).TD=t)}function _onMouseUp$1(){const r=_classPrivateFieldGet$g(_target,this).row,e=_classPrivateFieldGet$g(_rowsToMove,this).length;if(_classPrivateFieldSet$e(_pressed$1,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),e<1||r===void 0)return;const t=_classPrivateFieldGet$g(_rowsToMove,this)[0],n=this.hot.toPhysicalRow(t),s=this.dragRows(_classPrivateFieldGet$g(_rowsToMove,this),r);if(_classPrivateFieldGet$g(_rowsToMove,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(n),a=o+e-1;this.hot.selectRows(o,a)}}function _onAfterScrollHorizontally(){const r=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=r.holder.scrollLeft,n=e+t;_classPrivateFieldGet$g(_backlight,this).setPosition(null,n),_classPrivateFieldGet$g(_backlight,this).setSize(r.hider.offsetWidth-n)}function _onAfterLoadData$1(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$d(r,e){_checkPrivateRedeclaration$k(r,e),e.add(r)}function _classPrivateFieldInitSpec$f(r,e,t){_checkPrivateRedeclaration$k(r,e),e.set(r,t)}function _checkPrivateRedeclaration$k(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$d(r,e,t){return r.set(_assertClassBrand$k(r,e),t),t}function _classPrivateFieldGet$f(r,e){return r.get(_assertClassBrand$k(r,e))}function _assertClassBrand$k(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$b="manualRowResize",PLUGIN_PRIORITY$a=30,PERSISTENT_STATE_KEY="manualRowHeights";var _currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startHeight=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,_config=new WeakMap,_ManualRowResize_brand=new WeakSet;class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$b}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$a}constructor(e){super(e),_classPrivateMethodInitSpec$d(this,_ManualRowResize_brand),_classPrivateFieldInitSpec$f(this,_currentTH,null),_classPrivateFieldInitSpec$f(this,_currentRow,null),_classPrivateFieldInitSpec$f(this,_selectedRows,[]),_classPrivateFieldInitSpec$f(this,_currentHeight,null),_classPrivateFieldInitSpec$f(this,_newSize,null),_classPrivateFieldInitSpec$f(this,_startY,null),_classPrivateFieldInitSpec$f(this,_startHeight,null),_classPrivateFieldInitSpec$f(this,_startOffset,null),_classPrivateFieldInitSpec$f(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$f(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$f(this,_pressed,!1),_classPrivateFieldInitSpec$f(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec$f(this,_dblclick,0),_classPrivateFieldInitSpec$f(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec$f(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec$f(this,_config,void 0),addClass$1(_classPrivateFieldGet$f(_handle,this),"manualRowResizer"),addClass$1(_classPrivateFieldGet$f(_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$b]}enablePlugin(){this.enabled||(_classPrivateFieldSet$d(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$f(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMapInit$1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$f(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(e,t)=>_assertClassBrand$k(_ManualRowResize_brand,this,_onModifyRowHeight).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$d(_config,this,_classPrivateFieldGet$f(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet$f(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),s=Math.max(t,this.hot.view.getDefaultRowHeight());return _classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,s),s}getLastDesiredRowHeight(){return _classPrivateFieldGet$f(_currentHeight,this)}setupHandlePosition(e){_classPrivateFieldSet$d(_currentTH,this,e);const{view:t}=this.hot,{_wt:n}=t,s=n.wtTable.getCoords(_classPrivateFieldGet$f(_currentTH,this)),o=s.row;if(o<0)return;const a=outerWidth(_classPrivateFieldGet$f(_currentTH,this)),l=_classPrivateFieldGet$f(_currentTH,this).getBoundingClientRect(),u=o<n.getSetting("fixedRowsTop"),c=o>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;u?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col):c&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet$f(_currentTH,this),s.row,s.col)),_classPrivateFieldSet$d(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),_classPrivateFieldSet$d(_selectedRows,this,[]);const g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){const v=this.hot.getSelectedRange();arrayEach(v,m=>{const E=m.getTopStartCorner().row,_=m.getBottomStartCorner().row;rangeEach(E,_,S=>{_classPrivateFieldGet$f(_selectedRows,this).includes(S)||_classPrivateFieldGet$f(_selectedRows,this).push(S)})})}_classPrivateFieldGet$f(_selectedRows,this).includes(_classPrivateFieldGet$f(_currentRow,this))||_classPrivateFieldSet$d(_selectedRows,this,[_classPrivateFieldGet$f(_currentRow,this)]),_classPrivateFieldSet$d(_startOffset,this,h.top-6),_classPrivateFieldSet$d(_startHeight,this,parseInt(l.height,10)),_classPrivateFieldGet$f(_handle,this).style.top=`${_classPrivateFieldGet$f(_startOffset,this)+_classPrivateFieldGet$f(_startHeight,this)}px`,_classPrivateFieldGet$f(_handle,this).style[this.inlineDir]=`${h.start}px`,_classPrivateFieldGet$f(_handle,this).style.width=`${a}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$f(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet$f(_handle,this).style.top=`${_classPrivateFieldGet$f(_startOffset,this)+_classPrivateFieldGet$f(_currentHeight,this)}px`}setupGuidePosition(){const e=parseInt(outerWidth(_classPrivateFieldGet$f(_handle,this)),10),t=parseInt(_classPrivateFieldGet$f(_handle,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass$1(_classPrivateFieldGet$f(_handle,this),"active"),addClass$1(_classPrivateFieldGet$f(_guide,this),"active"),_classPrivateFieldGet$f(_guide,this).style.top=_classPrivateFieldGet$f(_handle,this).style.top,_classPrivateFieldGet$f(_guide,this).style[this.inlineDir]=`${t}px`,_classPrivateFieldGet$f(_guide,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$f(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet$f(_guide,this).style.top=_classPrivateFieldGet$f(_handle,this).style.top}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$f(_handle,this),"active"),removeClass$1(_classPrivateFieldGet$f(_guide,this),"active")}checkIfRowHeader(e){const t=closest(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,s.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&_classPrivateFieldGet$f(_newSize,this)<t?t:_classPrivateFieldGet$f(_newSize,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(n,s)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);o!==void 0&&_classPrivateFieldSet$d(_newSize,this,o),this.setManualSize(n,_classPrivateFieldGet$f(_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),s&&e()};_classPrivateFieldGet$f(_dblclick,this)>=2&&(_classPrivateFieldGet$f(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$f(_selectedRows,this),s=>{t(s)}),e()):arrayEach(_classPrivateFieldGet$f(_selectedRows,this),s=>{t(s,!0)})),_classPrivateFieldSet$d(_dblclick,this,0),_classPrivateFieldSet$d(_autoresizeTimeout,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseOver).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseDown).call(this,n)),this.eventManager.addEventListener(t,"mousemove",n=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseMove).call(this,n)),this.eventManager.addEventListener(t,"mouseup",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$f(_handle,this),"contextmenu",()=>_assertClassBrand$k(_ManualRowResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}}function _onMouseOver(r){if(!isDetached(r.target)&&_classPrivateFieldGet$f(_isTriggeredByRMB,this)!==!0&&this.checkIfRowHeader(r.target)){const e=this.getClosestTHParent(r.target);e&&(_classPrivateFieldGet$f(_pressed,this)||this.setupHandlePosition(e))}}function _onMouseDown(r){hasClass$1(r.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$f(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet$d(_pressed,this,!0),_classPrivateFieldGet$f(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet$d(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$f(_autoresizeTimeout,this))),_classPrivateFieldSet$d(_dblclick,this,_classPrivateFieldGet$f(_dblclick,this)+1),_classPrivateFieldSet$d(_startY,this,r.pageY),_classPrivateFieldSet$d(_newSize,this,_classPrivateFieldGet$f(_startHeight,this)))}function _onMouseMove(r){_classPrivateFieldGet$f(_pressed,this)&&(_classPrivateFieldSet$d(_currentHeight,this,_classPrivateFieldGet$f(_startHeight,this)+(r.pageY-_classPrivateFieldGet$f(_startY,this))),arrayEach(_classPrivateFieldGet$f(_selectedRows,this),e=>{_classPrivateFieldSet$d(_newSize,this,this.setManualSize(e,_classPrivateFieldGet$f(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&r(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};_classPrivateFieldGet$f(_pressed,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$d(_pressed,this,!1),_classPrivateFieldGet$f(_newSize,this)!==_classPrivateFieldGet$f(_startHeight,this)&&(_classPrivateFieldGet$f(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$f(_selectedRows,this),n=>{e(n)}),r()):arrayEach(_classPrivateFieldGet$f(_selectedRows,this),n=>{e(n,!0)})),this.setupHandlePosition(_classPrivateFieldGet$f(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$f(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$f(_guide,this)),_classPrivateFieldSet$d(_pressed,this,!1),_classPrivateFieldSet$d(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$d(_isTriggeredByRMB,this,!1)})}function _onModifyRowHeight(r,e){let t=r;if(this.enabled){const n=this.hot.toPhysicalRow(e),s=_classPrivateFieldGet$f(_rowHeightsMap,this).getValueAtIndex(n);this.hot.getSettings()[PLUGIN_KEY$b]&&s&&(t=s)}return t}function _onMapInit$1(){const r=this.hot.getSettings()[PLUGIN_KEY$b],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)}):Array.isArray(r)?(r.forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)}),_classPrivateFieldSet$d(_config,this,r)):r===!0&&Array.isArray(_classPrivateFieldGet$f(_config,this))&&_classPrivateFieldGet$f(_config,this).forEach((t,n)=>{_classPrivateFieldGet$f(_rowHeightsMap,this).setValueAtIndex(n,t)})},!0)}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var r=requireAddToUnscopables();return r("flatMap"),es_array_unscopables_flatMap}requireEs_array_unscopables_flatMap();var esnext_iterator_flatMap={},es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var r=requireFunctionCall(),e=requireAnObject(),t=requireGetIteratorDirect(),n=requireGetIteratorMethod();return getIteratorFlattenable=function(s,o){(!o||typeof s!="string")&&e(s);var a=n(s);return t(e(a!==void 0?r(a,s):s))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var r=require_export(),e=requireFunctionCall(),t=requireACallable(),n=requireAnObject(),s=requireGetIteratorDirect(),o=requireGetIteratorFlattenable(),a=requireIteratorCreateProxy(),l=requireIteratorClose(),u=requireIsPure(),c=a(function(){for(var h=this.iterator,g=this.mapper,v,m;;){if(m=this.inner)try{if(v=n(e(m.next,m.iterator)),!v.done)return v.value;this.inner=null}catch(E){l(h,"throw",E)}if(v=n(e(this.next,h)),this.done=!!v.done)return;try{this.inner=o(g(v.value,this.counter++),!1)}catch(E){l(h,"throw",E)}}});return r({target:"Iterator",proto:!0,real:!0,forced:u},{flatMap:function(g){return n(this),t(g),new c(s(this),{mapper:g,inner:null})}}),es_iterator_flatMap}var hasRequiredEsnext_iterator_flatMap;function requireEsnext_iterator_flatMap(){return hasRequiredEsnext_iterator_flatMap||(hasRequiredEsnext_iterator_flatMap=1,requireEs_iterator_flatMap()),esnext_iterator_flatMap}requireEsnext_iterator_flatMap();function _classPrivateFieldInitSpec$e(r,e,t){_checkPrivateRedeclaration$j(r,e),e.set(r,t)}function _checkPrivateRedeclaration$j(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$w(r,e,t){return(e=_toPropertyKey$x(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$x(r){var e=_toPrimitive$x(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$x(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$e(r,e){return r.get(_assertClassBrand$j(r,e))}function _classPrivateFieldSet$c(r,e,t){return r.set(_assertClassBrand$j(r,e),t),t}function _assertClassBrand$j(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap;class MergedCellCoords{constructor(e,t,n,s,o,a){_defineProperty$w(this,"row",void 0),_defineProperty$w(this,"col",void 0),_defineProperty$w(this,"rowspan",void 0),_defineProperty$w(this,"colspan",void 0),_defineProperty$w(this,"removed",!1),_defineProperty$w(this,"cellCoordsFactory",void 0),_defineProperty$w(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec$e(this,_cellRange,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=s,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:s,colspan:o}=e;return toSingleLine`The merged cell declared with {row: ${t}, col: ${n},\x20
      rowspan: ${s}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:n,rowspan:s,colspan:o}=e;return t<0||n<0||s<0||o<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return n===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return n===0||t===0}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),_classPrivateFieldSet$c(_cellRange,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",l=Math.min(t,s),u=Math.max(t,s),c=this[a],h=this[a]+this[o]-1;if(c>=t&&(this[a]+=n),n>0)t<=h&&t>c&&(this[o]+=n);else if(n<0){if(l<=c&&u>=h)return this.removed=!0,_classPrivateFieldSet$c(_cellRange,this,null),!1;if(c>=l&&c<=u){const g=u-c+1,v=Math.abs(n)-g;this[a]-=v+n,this[o]-=g}else if(c<=l&&h>=u)this[o]+=n;else if(c<=l&&h>=l&&h<u){const g=h-l+1;this[o]-=g}}return _classPrivateFieldSet$c(_cellRange,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet$e(_cellRange,this)||_classPrivateFieldSet$c(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet$e(_cellRange,this)}}function _classPrivateMethodInitSpec$c(r,e){_checkPrivateRedeclaration$i(r,e),e.add(r)}function _checkPrivateRedeclaration$i(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$v(r,e,t){return(e=_toPropertyKey$w(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$w(r){var e=_toPrimitive$w(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$w(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$i(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet;class MergedCellsCollection{constructor(e){_classPrivateMethodInitSpec$c(this,_MergedCellsCollection_brand),_defineProperty$v(this,"plugin",void 0),_defineProperty$v(this,"mergedCells",[]),_defineProperty$v(this,"mergedCellsMatrix",new Map),_defineProperty$v(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return toSingleLine`The merged cell declared at [${t}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(t))!==null&&n!==void 0?n:!1}getByRange(e){let t=!1;return arrayEach(this.mergedCells,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(t=n,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(s=>{const{row:o,col:a,colspan:l,rowspan:u}=s;for(let c=o;c<o+u;c++)for(let h=a;h<a+l;h++)t.add(`r${c},c${h}`)}),e.filter(s=>{const{row:o,col:a,colspan:l,rowspan:u}=s,c=new Set;let h=!1;for(let g=o;g<o+u;g++){for(let v=a;v<a+l;v++){const m=`r${g},c${v}`;if(t.has(m)){warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(s)),h=!0;break}c.add(m)}if(h)break}return h||t.add(...c),!h})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:s}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),l=[];for(let u=n;u<=o;u++)for(let c=s;c<=a;c++){const h=this.get(u,c);h&&(t||!t&&h.row===u&&h.col===c)&&l.push(h)}return l}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,s=e.col,o=e.rowspan,a=e.colspan,l=new MergedCellCoords(n,s,o,a,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(n,s),c=t?!1:this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),this.mergedCells.push(l),_assertClassBrand$i(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,l),l):(warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,t){const n=this.get(e,t),s=n?this.mergedCells.indexOf(n):-1;return n&&s!==-1?(this.mergedCells.splice(s,1),_assertClassBrand$i(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,n),n):!1}clear(){arrayEach(this.mergedCells,e=>{let{row:t,col:n,rowspan:s,colspan:o}=e;rangeEach(t,t+s,a=>{rangeEach(n,n+o,l=>{const u=this.hot.getCell(a,l);u&&(u.removeAttribute("rowspan"),u.removeAttribute("colspan"),u.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:s,col:o,rowspan:a,colspan:l}=n,u=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleColumn(),g=clamp(c,s,s+a-1),v=clamp(h,o,o+l-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(v,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(s,o)}getStartMostColumnIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",-1);let s=t;for(let o=0;o<n.length;o++)if(n[o]<=t){s=n[o];break}return s}getEndMostColumnIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"col",1);let s=t;for(let o=0;o<n.length;o++)if(n[o]>=t){s=n[o];break}return s}getTopMostRowIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",-1);let s=t;for(let o=0;o<n.length;o++)if(n[o]<=t){s=n[o];break}return s}getBottomMostRowIndex(e,t){const n=_assertClassBrand$i(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,e,"row",1);let s=t;for(let o=0;o<n.length;o++)if(n[o]>=t){s=n[o];break}return s}shiftCollections(e,t,n){const s=[0,0];switch(e){case"right":s[0]+=n;break;case"left":s[0]-=n;break;case"down":s[1]+=n;break;case"up":s[1]-=n;break}const o=[];this.mergedCells.forEach(a=>{a.shift(s,t),a.removed&&o.push(a)}),o.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{_assertClassBrand$i(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,a)})}}function _getNonIntersectingIndexes(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,s=t===1?r.getTopStartCorner():r.getBottomEndCorner(),o=t===1?r.getBottomEndCorner():r.getTopStartCorner();for(let a=s.row;t===1?a<=o.row:a>=o.row;a+=t)for(let l=s.col;t===1?l<=o.col:l>=o.col;l+=t){const u=e==="row"?a:l,c=this.get(a,l);let h=u;c&&(h=t===1?c[e]+c[`${e}span`]-1:c[e]),n.has(u)||n.set(u,new Set),n.get(u).add(h)}return Array.from(new Set(Array.from(n.entries()).filter(a=>{let[,l]=a;return l.size===1}).flatMap(a=>{let[,l]=a;return Array.from(l)})))}function _addMergedCellToMatrix(r){for(let e=r.row;e<r.row+r.rowspan;e++)for(let t=r.col;t<r.col+r.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,r)}function _removeMergedCellFromMatrix(r){for(let e=r.row;e<r.row+r.rowspan;e++)for(let t=r.col;t<r.col+r.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function _defineProperty$u(r,e,t){return(e=_toPropertyKey$v(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$v(r){var e=_toPrimitive$v(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$v(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class AutofillCalculations{constructor(e){_defineProperty$u(this,"plugin",void 0),_defineProperty$u(this,"mergedCellsCollection",void 0),_defineProperty$u(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let n=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?n="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?n="up":t[1]===e[1]&&t[2]===e[2]?n="right":n="left",n}snapDragArea(e,t,n,s){const o=t.slice(0),a=this.getAutofillSize(e,t,n),[l,u,c,h]=e,v=["up","down"].indexOf(n)>-1?c-l+1:h-u+1,m=Math.floor(a/v)*v,E=a-m,_=this.getFarthestCollection(e,t,n,s);if(_){if(n==="down"){const S=_.row+_.rowspan-l-E;o[2]+S>=this.plugin.hot.countRows()?o[2]-=E:o[2]+=E?S:0}else if(n==="right"){const S=_.col+_.colspan-u-E;o[3]+S>=this.plugin.hot.countCols()?o[3]-=E:o[3]+=E?S:0}else if(n==="up"){const S=c-E-_.row+1;o[0]+S<0?o[0]+=E:o[0]-=E?S:0}else if(n==="left"){const S=h-E-_.col+1;o[1]+S<0?o[1]+=E:o[1]-=E?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:s,fillSize:a,dragArea:o,cycleLength:v}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),extend$1(this.currentFillData,e)}getAutofillSize(e,t,n){const[s,o,a,l]=e,[u,c,h,g]=t;switch(n){case"up":return s-u;case"down":return h-a;case"left":return o-c;case"right":return g-l;default:return null}}getDragArea(e,t,n){const[s,o,a,l]=e,[u,c,h,g]=t;switch(n){case"up":return[u,c,s-1,l];case"down":return[a+1,o,h,l];case"left":return[u,c,a,o-1];case"right":return[s,l+1,h,g];default:return null}}getFarthestCollection(e,t,n,s){const[o,a,l,u]=e,c=["up","down"].indexOf(n)>-1,h=c?l:u,g=c?o:a,v=this.getAutofillSize(e,t,n),m=c?l-o+1:u-a+1,E=Math.floor(v/m)*m,_=v-E;let S=null,w=null,A=null;switch(n){case"up":S="includesVertically",A=h-_+1;break;case"left":S="includesHorizontally",A=h-_+1;break;case"down":S="includesVertically",A=g+_-1;break;case"right":S="includesHorizontally",A=g+_-1;break}return arrayEach(s,O=>{O[S](A)&&O.isFarther(w,n)&&(w=O)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,o=(c,h)=>{switch(s){case"up":return c.row-h>=t.from.row;case"down":return c.row+c.rowspan-1+h<=t.to.row;case"left":return c.col-h>=t.from.column;case"right":return c.col+c.colspan-1+h<=t.to.column;default:return null}};let a=0,l=null,u=1;do for(let c=0;c<n.length;c+=1){if(l=n[c],a=u*this.currentFillData.cycleLength,o(l,a))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:l.row-a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-a,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+a,colspan:l.colspan});break}c===n.length-1&&(u+=1)}while(o(l,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return arrayEach(e,s=>{const o=s[0],a=this.plugin.hot.propToCol(s[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a)}),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const s=this.getDragArea(e,t,n),[o,a,l,u]=s,c=this.plugin.hot._createCellCoords(o,a),h=this.plugin.hot._createCellCoords(l,u),g=this.plugin.hot._createCellRange(c,c,h);return this.mergedCellsCollection.getWithinRange(g,!0).length>0}}function _defineProperty$t(r,e,t){return(e=_toPropertyKey$u(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$u(r){var e=_toPrimitive$u(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$u(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SelectionCalculations{constructor(e){_defineProperty$t(this,"plugin",void 0),_defineProperty$t(this,"hot",void 0),_defineProperty$t(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,s){const o=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const h=this.plugin.mergedCellsCollection.get(e,t);if(!h)return;const g=h.getLastRow(),v=h.getLastColumn();if(o<=h.row&&a<=h.col&&l>=g&&u>=v)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+s,e.col+o));for(let s=0;s<n.length;s+=1){const o=[];for(let a=0;a<t.length;a+=1)o[a]=t[a].includes(n[s]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function toggleMergeItem(r){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=r.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;r.toggleMerge(e),this.selectCell(t.row,t.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?MergedCellCoords.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function _defineProperty$s(r,e,t){return(e=_toPropertyKey$t(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$t(r){var e=_toPrimitive$t(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$t(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class NodeStructure{constructor(e){_defineProperty$s(this,"data",void 0),_defineProperty$s(this,"next",null),_defineProperty$s(this,"prev",null),this.data=e}}class LinkedList{constructor(){_defineProperty$s(this,"first",null),_defineProperty$s(this,"last",null)}push(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const n=this.last;this.last=t,t.prev=n,n.next=t}return t}unshift(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const n=this.first;this.first=t,t.next=n,n.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||n===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,n,s;for(;t;){if(t.data===e)return n=t.next,s=t.prev,n&&(n.prev=s),s&&(s.next=n),t===this.first&&(this.first=n),t===this.last&&(this.last=s),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,s){s&&(e(s,s.next),s.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,n;for(;e;)n=e.next,e.next=t,t.prev=e,t=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=t,this.last=n}}function _classPrivateMethodInitSpec$b(r,e){_checkPrivateRedeclaration$h(r,e),e.add(r)}function _classPrivateFieldInitSpec$d(r,e,t){_checkPrivateRedeclaration$h(r,e),e.set(r,t)}function _checkPrivateRedeclaration$h(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$d(r,e){return r.get(_assertClassBrand$h(r,e))}function _classPrivateFieldSet$b(r,e,t){return r.set(_assertClassBrand$h(r,e),t),t}function _assertClassBrand$h(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet;class FocusOrder{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:s}=e;_classPrivateMethodInitSpec$b(this,_FocusOrder_brand),_classPrivateFieldInitSpec$d(this,_cellsHorizontalOrder,new LinkedList),_classPrivateFieldInitSpec$d(this,_cellsVerticalOrder,new LinkedList),_classPrivateFieldInitSpec$d(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec$d(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec$d(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec$d(this,_rowIndexMapper,null),_classPrivateFieldInitSpec$d(this,_columnIndexMapper,null),_classPrivateFieldSet$b(_mergedCellsGetter,this,t),_classPrivateFieldSet$b(_rowIndexMapper,this,n),_classPrivateFieldSet$b(_columnIndexMapper,this,s)}getCurrentVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet$d(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet$d(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet$d(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,_classPrivateFieldGet$d(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,_classPrivateFieldGet$d(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$d(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),n=e.getBottomEndCorner(),s=new WeakSet;_classPrivateFieldSet$b(_cellsHorizontalOrder,this,new LinkedList);for(let a=t.row;a<=n.row;a++)if(!_classPrivateFieldGet$d(_rowIndexMapper,this).isHidden(a))for(let l=t.col;l<=n.col;l++){if(_classPrivateFieldGet$d(_columnIndexMapper,this).isHidden(l))continue;const u=_assertClassBrand$h(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$d(_cellsHorizontalOrder,this),s,a,l);u&&_classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,u)}_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet$d(_cellsHorizontalOrder,this).last,_classPrivateFieldGet$d(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet$d(_cellsHorizontalOrder,this).first);const o=new WeakSet;_classPrivateFieldSet$b(_cellsVerticalOrder,this,new LinkedList);for(let a=t.col;a<=n.col;a++)if(!_classPrivateFieldGet$d(_columnIndexMapper,this).isHidden(a))for(let l=t.row;l<=n.row;l++){if(_classPrivateFieldGet$d(_rowIndexMapper,this).isHidden(l))continue;const u=_assertClassBrand$h(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$d(_cellsVerticalOrder,this),o,l,a);u&&_classPrivateFieldSet$b(_currentVerticalLinkedNode,this,u)}_classPrivateFieldGet$d(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet$d(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet$d(_cellsVerticalOrder,this).last,_classPrivateFieldGet$d(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet$d(_cellsVerticalOrder,this).first)}setActiveNode(e,t){return _classPrivateFieldGet$d(_cellsHorizontalOrder,this).inorder(n=>{const{rowStart:s,rowEnd:o,colStart:a,colEnd:l}=n.data;if(e>=s&&e<=o&&t>=a&&t<=l)return _classPrivateFieldSet$b(_currentHorizontalLinkedNode,this,n),!1}),_classPrivateFieldGet$d(_cellsVerticalOrder,this).inorder(n=>{const{rowStart:s,rowEnd:o,colStart:a,colEnd:l}=n.data;if(e>=s&&e<=o&&t>=a&&t<=l)return _classPrivateFieldSet$b(_currentVerticalLinkedNode,this,n),!1}),this}}function _pushOrderNode(r,e,t,n,s){const o=r.getTopStartCorner(),a=r.getBottomEndCorner(),l=r.highlight.clone().normalize(),u=_classPrivateFieldGet$d(_mergedCellsGetter,this).call(this,n,s);if(u&&t.has(u))return null;const c={colStart:s,colEnd:s,rowStart:n,rowEnd:n};if(u){if(t.add(u),u.row<o.row||u.row+u.rowspan-1>a.row||u.col<o.col||u.col+u.colspan-1>a.col)return null;c.colStart=u.col,c.colEnd=u.col+u.colspan-1,c.rowStart=u.row,c.rowEnd=u.row+u.rowspan-1}const h=e.push(c);return n===l.row&&s===l.col||u&&l.row>=u.row&&l.row<=u.row+u.rowspan-1&&l.col>=u.col&&l.col<=u.col+u.colspan-1?h:null}function createMergeCellRenderer(r){const{hot:e}=r,{rowIndexMapper:t,columnIndexMapper:n}=e;function s(){}function o(a,l,u){const c=r.mergedCellsCollection.get(l,u);if(!isObject$1(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="";return}const{row:h,col:g,colspan:v,rowspan:m}=c,[E,_]=r.translateMergedCellToRenderable(h,m,g,v),S=r.getSetting("virtualized"),w=t.getRenderableFromVisualIndex(l),A=n.getRenderableFromVisualIndex(u),O=E-w+1,D=_-A+1;let Y=t.getNearestNotHiddenIndex(h,1),H=n.getNearestNotHiddenIndex(g,1);if(S){const se=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(se)||(Y=Math.max(Y,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(se)||(H=Math.max(H,e.getFirstRenderedVisibleColumn()))}const k=Math.min(m,O),K=Math.min(v,D);Y===l&&H===u?(a.setAttribute("rowspan",k),a.setAttribute("colspan",K)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function _classPrivateMethodInitSpec$a(r,e){_checkPrivateRedeclaration$g(r,e),e.add(r)}function _classPrivateFieldInitSpec$c(r,e,t){_checkPrivateRedeclaration$g(r,e),e.set(r,t)}function _checkPrivateRedeclaration$g(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$r(r,e,t){return(e=_toPropertyKey$s(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$s(r){var e=_toPrimitive$s(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$s(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldSet$a(r,e,t){return r.set(_assertClassBrand$g(r,e),t),t}function _classPrivateFieldGet$c(r,e){return r.get(_assertClassBrand$g(r,e))}function _assertClassBrand$g(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeMergeCells");Hooks.getSingleton().register("afterMergeCells");Hooks.getSingleton().register("beforeUnmergeCells");Hooks.getSingleton().register("afterUnmergeCells");const PLUGIN_KEY$a="mergeCells",PLUGIN_PRIORITY$9=150,SHORTCUTS_GROUP$3=PLUGIN_KEY$a;var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet;class MergeCells extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$a(this,_MergeCells_brand),_defineProperty$r(this,"mergedCellsCollection",null),_defineProperty$r(this,"autofillCalculations",null),_defineProperty$r(this,"selectionCalculations",null),_classPrivateFieldInitSpec$c(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec$c(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec$c(this,_focusOrder,new FocusOrder({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec$c(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY$a}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$9}static get DEFAULT_SETTINGS(){return{[defaultMainSettingSymbol]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$a]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new AutofillCalculations(this),this.selectionCalculations=new SelectionCalculations(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterInit$1).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformFocus).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformStart$1).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyTransformEnd).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSelectionHighlightSet$1).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeSelectionFocusSet).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterSelectionFocusSet).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterSelectionEnd).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterIsMultipleSelection).call(e,...n)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet$c(_cellRenderer,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_addMergeActionsToContextMenu).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterGetCellMeta).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterViewportRowCalculatorOverride).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterViewportColumnCalculatorOverride$1).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyAutofillRange).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterCreateCol).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterRemoveCol).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterCreateRow$1).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterRemoveRow$1).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterChange).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeDrawAreaBorders).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onAfterDrawSelection).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeRemoveCellClassNames).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onBeforeBeginEditing).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$g(_MergeCells_brand,e,_onModifyRowHeightByOverlayName).call(e,...n)}),this.addHook("beforeUndoStackChange",(t,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:s,rowspan:o}=n;for(let a=s+1;a<s+o;a++)t.push(a)}),t=[...new Set(t)],t.forEach(n=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(s);a&&(a.style.background=getStyle(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=getStyle(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?MergedCellCoords.containsNegativeValues(e)?(warn$1(MergedCellCoords.NEGATIVE_VALUES_WARNING(e)),!1):MergedCellCoords.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn$1(MergedCellCoords.IS_OUT_OF_BOUNDS_WARNING(e)),!1):MergedCellCoords.isSingleCell(e)?(warn$1(MergedCellCoords.IS_SINGLE_CELL(e)),!1):MergedCellCoords.containsZeroSpan(e)?(warn$1(MergedCellCoords.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,c=this.hot._createCellCoords(o,a),h=this.hot._createCellCoords(o+l-1,a+u-1),g=this.hot._createCellRange(c,c,h);this.mergeRange(g,!0,!0);for(let v=o;v<o+l;v++)for(let m=a;m<a+u;m++)(v!==o||m!==a)&&n.push([v,m,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:s.row,col:s.col,rowspan:o.row-s.row+1,colspan:o.col-s.col+1},l=[];let u=null;return this.canMergeRange(a,t)?(this.hot.runHooks("beforeMergeCells",e,t),rangeEach(0,a.rowspan-1,h=>{rangeEach(0,a.colspan-1,g=>{let v=null;l[h]||(l[h]=[]),h===0&&g===0?v=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+h,a.col+g,"hidden",!0),l[h][g]=v})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,t)?(n?u=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,t),u):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),arrayEach(n,s=>{this.mergedCellsCollection.remove(s.row,s.col),rangeEach(0,s.rowspan-1,o=>{rangeEach(0,s.colspan-1,a=>{this.hot.removeCellMeta(s.row+o,s.col+a,"hidden"),this.hot.removeCellMeta(s.row+o,s.col+a,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,s){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(n,s);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,t,n,s){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(n,s);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:SHORTCUTS_GROUP$3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$3)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,s=n.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(s,o);if(isObject$1(a)){const l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,s=n.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(s,o);if(isObject$1(a)){const l=a.row+a.rowspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1));if(u>e.endRow){e.endRow=u,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,s=n.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,s);if(isObject$1(a)){const l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,s=n.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,s);if(isObject$1(a)){const l=a.col+a.colspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1));if(u>e.endColumn){e.endColumn=u,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,n,s){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let l,u;t===0?l=o.getNearestNotHiddenIndex(e,1):l=o.getNearestNotHiddenIndex(e+t-1,-1),s===0?u=a.getNearestNotHiddenIndex(n,1):u=a.getNearestNotHiddenIndex(n+s-1,-1);const c=e>=0?o.getRenderableFromVisualIndex(l):e,h=n>=0?a.getRenderableFromVisualIndex(u):n;return[c,h]}}function _onAfterInit$1(){this.generateFromSettings(),this.hot.render()}function _onAfterIsMultipleSelection(r){if(r){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),s=t.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(n.row===e[o].row&&n.col===e[o].col&&s.row===e[o].row+e[o].rowspan-1&&s.col===e[o].col+e[o].colspan-1)return!1}return r}function _onModifyTransformFocus(r){_classPrivateFieldGet$c(_lastFocusDelta,this).row=r.row,_classPrivateFieldGet$c(_lastFocusDelta,this).col=r.col}function _onModifyTransformStart$1(r){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:n,rowIndexMapper:s}=this.hot;_classPrivateFieldGet$c(_lastSelectedFocus,this)&&(s.getRenderableFromVisualIndex(_classPrivateFieldGet$c(_lastSelectedFocus,this).row)!==null&&(t.row=_classPrivateFieldGet$c(_lastSelectedFocus,this).row),n.getRenderableFromVisualIndex(_classPrivateFieldGet$c(_lastSelectedFocus,this).col)!==null&&(t.col=_classPrivateFieldGet$c(_lastSelectedFocus,this).col),_classPrivateFieldSet$a(_lastSelectedFocus,this,null));const o=this.mergedCellsCollection.get(t.row,t.col);if(!o)return;const a=o.col,l=o.col+o.colspan-1;if(r.col<0){const h=t.col>=a&&t.col<=l?a-1:l,g=n.getNearestNotHiddenIndex(h,-1);g===null?r.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(g,t.col)-1,1)}else if(r.col>0){const h=t.col>=a&&t.col<=l?l+1:a,g=n.getNearestNotHiddenIndex(h,1);g===null?r.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,g)-1,1)}const u=o.row,c=o.row+o.rowspan-1;if(r.row<0){const h=t.row>=u&&t.row<=c?u-1:c,g=s.getNearestNotHiddenIndex(h,-1);g===null?r.row=-this.hot.view.countRenderableRowsInRange(0,t.row):r.row=-Math.max(this.hot.view.countRenderableRowsInRange(g,t.row)-1,1)}else if(r.row>0){const h=t.row>=u&&t.row<=c?c+1:u,g=s.getNearestNotHiddenIndex(h,1);g===null?r.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):r.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,g)-1,1)}}function _onModifyTransformEnd(r){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:n}=e,{columnIndexMapper:s,rowIndexMapper:o}=this.hot,a=(l,u)=>{t.expand(this.hot._createCellCoords(l,u));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(r.col<0){let l=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+r.col;a(n.row,l),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(l=t.getTopStartCorner().col);const u=s.getNearestNotHiddenIndex(l,1);u!==null&&(r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,n.col)-1,1))}else if(r.col>0){let l=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+r.col;a(n.row,l),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(l=t.getBottomEndCorner().col);const u=s.getNearestNotHiddenIndex(l,-1);u!==null&&(r.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,u)-1,1))}if(r.row<0){let l=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+r.row;a(l,n.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(l=t.getTopStartCorner().row);const u=o.getNearestNotHiddenIndex(l,1);u!==null&&(r.row=-Math.max(this.hot.view.countRenderableRowsInRange(u,n.row)-1,1))}else if(r.row>0){let l=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+r.row;a(l,n.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(l=t.getBottomStartCorner().row);const u=o.getNearestNotHiddenIndex(l,-1);u!==null&&(r.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,u)-1,1))}}function _onBeforeSelectionHighlightSet$1(){const r=this.hot.getSelectedRangeLast(),{highlight:e}=r;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet$a(_lastSelectedFocus,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);_classPrivateFieldSet$a(_lastSelectedFocus,this,e.clone()),t&&e.assign(t)}function _onModifyGetCellCoords(r,e,t,n){if(r<0||e<0)return;const s=this.mergedCellsCollection.get(r,e);if(!s)return;const{row:o,col:a,colspan:l,rowspan:u}=s,c=o,h=a,g=o+u-1,v=a+l-1;if(n==="render"&&this.getSetting("virtualized")){const m=this.hot.view.getActiveOverlayName(),E=["top","top_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleRow(),_=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleColumn();return[clamp(E,c,g),clamp(_,h,v),clamp(this.hot.getLastRenderedVisibleRow(),c,g),clamp(this.hot.getLastRenderedVisibleColumn(),h,v)]}return[c,h,g,v]}function _addMergeActionsToContextMenu(r){r.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet$a(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet$c(_lastSelectedFocus,this).isCell())return;const r=this.hot.getSelectedRangeLast(),e=r.getVerticalDirection(),t=r.getHorizontalDirection(),n=_classPrivateFieldGet$c(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet$c(_focusOrder,this).setActiveNode(n.row,n.col),_classPrivateFieldGet$c(_lastFocusDelta,this).row>0||_classPrivateFieldGet$c(_lastFocusDelta,this).col>0?_classPrivateFieldGet$c(_focusOrder,this).setPrevNodeAsActive():(t==="E-W"&&_classPrivateFieldGet$c(_lastFocusDelta,this).col<0||e==="S-N"&&_classPrivateFieldGet$c(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet$c(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(r,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:s}=this.hot;let o=null,a=null;if(_classPrivateFieldGet$c(_lastFocusDelta,this).col<0){const{rowEnd:l,colEnd:u}=_classPrivateFieldGet$c(_focusOrder,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(u,-1),o=s.getNearestNotHiddenIndex(l,-1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).col>0){const{rowStart:l,colStart:u}=_classPrivateFieldGet$c(_focusOrder,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(u,1),o=s.getNearestNotHiddenIndex(l,1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).row<0){const{rowEnd:l,colEnd:u}=_classPrivateFieldGet$c(_focusOrder,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(u,-1),o=s.getNearestNotHiddenIndex(l,-1)}else if(_classPrivateFieldGet$c(_lastFocusDelta,this).row>0){const{rowStart:l,colStart:u}=_classPrivateFieldGet$c(_focusOrder,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(u,1),o=s.getNearestNotHiddenIndex(l,1)}if(o!==null||a!==null){const l=this.hot._createCellCoords(o,a),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();r=l.row,e=l.col,u?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):t.highlight.assign(l),c.clear(),c.add(l).commit()}_classPrivateFieldGet$c(_focusOrder,this).setActiveNode(r,e),_classPrivateFieldSet$a(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd(){this.hot.getSelectedRangeLast().isHeader()||_classPrivateFieldGet$c(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _onAfterGetCellMeta(r,e,t){const n=this.mergedCellsCollection.get(r,e);n&&(n.row!==r||n.col!==e?t.copyable=!1:(t.rowspan=n.rowspan,t.colspan=n.colspan))}function _onAfterViewportRowCalculatorOverride(r){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(r,e),this.modifyViewportRowEnd(r,e)}function _onAfterViewportColumnCalculatorOverride$1(r){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(r,e),this.modifyViewportColumnEnd(r,e)}function _onModifyAutofillRange(r,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,r);let n=r;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,t))return n=e,n;const s=this.hot._createCellCoords(e[0],e[1]),o=this.hot._createCellCoords(e[2],e[3]),a=this.hot._createCellRange(s,s,o),l=this.mergedCellsCollection.getWithinRange(a);return l.length===0||(n=this.autofillCalculations.snapDragArea(e,n,t,l)),n}function _onAfterCreateCol(r,e){this.mergedCellsCollection.shiftCollections("right",r,e)}function _onAfterRemoveCol(r,e){this.mergedCellsCollection.shiftCollections("left",r,e)}function _onAfterCreateRow$1(r,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",r,e)}function _onAfterRemoveRow$1(r,e){this.mergedCellsCollection.shiftCollections("up",r,e)}function _onAfterChange(r,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(r)}function _onBeforeDrawAreaBorders(r,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(t);arrayEach(n,s=>{t.getBottomEndCorner().row===s.getLastRow()&&t.getBottomEndCorner().col===s.getLastColumn()&&(r[2]=s.row,r[3]=s.col)})}}function _onAfterDrawSelection(r,e,t,n){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(r,e,t,n)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(r,e,t,n){if(!(n instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(s);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(a,a,l))}function _onModifyRowHeightByOverlayName(r,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return r;let n,s;if(t==="master")n=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const v=this.hot.view.getOverlayByName(t);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return r;const a=this.hot._createCellCoords(e,n),l=this.hot._createCellCoords(e,s),u=this.hot._createCellRange(a,a,l),c=this.mergedCellsCollection.getWithinRange(u,!0),h=c.reduce((v,m)=>{let{rowspan:E}=m;return Math.max(v,E)},1);let g=0;return c.length>1&&c[0].rowspan<h&&(g=h-c[0].rowspan),c.forEach(v=>{var m;let{rowspan:E}=v,_=0;t==="top"||t==="top_inline_start_corner"?_=Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):_=E-g,r=Math.max((m=r)!==null&&m!==void 0?m:0,_assertClassBrand$g(_MergeCells_brand,this,_sumCellsHeights).call(this,e,_))}),r}function _sumCellsHeights(r,e){const t=this.hot.view.getDefaultRowHeight(),n=this.hot.getPlugin("autoRowSize");let s=0;for(let a=r;a<r+e;a++)if(!this.hot.rowIndexMapper.isHidden(a)){var o;s+=(o=n==null?void 0:n.getRowHeight(a))!==null&&o!==void 0?o:t}return s}function rootComparator(r,e){return function(t,n){const[,...s]=t,[,...o]=n;return function a(l){const u=r[l],c=e[l],h=s[l],g=o[l],v=c.multiColumnSorting,E=(v.compareFunctionFactory?v.compareFunctionFactory:getCompareFunctionFactory(c.type))(u,c,v)(h,g);if(E===DO_NOT_SWAP){const _=l+1;if(typeof e[_]<"u")return a(_)}return E}(0)}}function warnAboutPluginsConflict(){warn$1(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(r,e,t){const n=[];return t===!1||r.isColumnSorted(e)&&r.getNumberOfSortedColumns()>1&&n.push(`${COLUMN_ORDER_PREFIX}-${r.getIndexOfColumnInSortQueue(e)+1}`),n}function getClassesToRemove(r){const e=r.className.split(" "),t=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return e.filter(n=>t.test(n))}function _defineProperty$q(r,e,t){return(e=_toPropertyKey$r(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$r(r){var e=_toPrimitive$r(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$r(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const PLUGIN_KEY$9="multiColumnSorting",PLUGIN_PRIORITY$8=170,CONFLICTED_PLUGIN_KEY="columnSorting",SHORTCUTS_GROUP$2=PLUGIN_KEY$9;registerRootComparator(PLUGIN_KEY$9,rootComparator);class MultiColumnSorting extends ColumnSorting{constructor(){super(...arguments),_defineProperty$q(this,"pluginKey",PLUGIN_KEY$9)}static get PLUGIN_KEY(){return PLUGIN_KEY$9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$8}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&(warnAboutPluginsConflict(),this.hot.getPlugin(CONFLICTED_PLUGIN_KEY).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$2})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$2)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];super.updateHeaderClasses(e,...n),removeClass$1(e,getClassesToRemove(e)),this.enabled!==!1&&addClass$1(e,getClassesToAdd(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(t.col)))}}function _defineProperty$p(r,e,t){return(e=_toPropertyKey$q(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$q(r){var e=_toPrimitive$q(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$q(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const PLUGIN_KEY$8="multipleSelectionHandles",PLUGIN_PRIORITY$7=160;class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),_defineProperty$p(this,"dragged",[]),_defineProperty$p(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$7}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(s);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let o;if(hasClass$1(s.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1;if(hasClass$1(s.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if(hasClass$1(s.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(hasClass$1(s.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{const{rootDocument:o}=this.hot;let a,l,u,c,h,g;if(e.dragged.length===0)return;const v=o.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!v||v===e.lastSetCell||((v.nodeName==="TD"||v.nodeName==="TH")&&(a=e.hot.getCoords(v),a.col===-1&&(a.col=0),l=e.hot.getSelectedRangeLast(),u=l.getWidth(),c=l.getHeight(),h=l.getDirection(),u===1&&c===1&&e.hot.selection.setRangeEnd(a),g=e.getCurrentRangeCoords(l,a,e.touchStartRange.direction,h,e.dragged[0]),g.start!==null&&e.hot.selection.setRangeStart(g.start),e.hot.selection.setRangeEnd(g.end),e.lastSetCell=v),s.preventDefault())})}getCurrentRangeCoords(e,t,n,s,o){const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.getBottomStartCorner(),c=e.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":o==="top"?h={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(u.row,t.col)}:h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SE-NW":o==="bottom"&&(h={start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,a.col)});break}break;case"NW-SE":switch(s){case"NE-SW":o==="top"?h={start:t,end:u}:h.end=t;break;case"NW-SE":o==="top"?h={start:t,end:l}:h.end=t;break;case"SE-NW":o==="top"?h={start:t,end:a}:h.end=t;break;case"SW-NE":o==="top"?h={start:t,end:c}:h.end=t;break}break;case"SW-NE":switch(s){case"NW-SE":o==="bottom"?h={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(u.row,t.col)}:h={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SW-NE":o==="top"?h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)}:h={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(a.row,t.col)};break;case"SE-NW":o==="bottom"?h={start:this.hot._createCellCoords(t.row,c.col),end:this.hot._createCellCoords(a.row,t.col)}:o==="top"&&(h={start:u,end:t});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(h.end=t);break;case"SE-NW":o==="top"?h.end=t:h={start:t,end:a};break}break}return h}isDragged(){return this.dragged.length>0}}function createDefaultHeaderSettings(){let{label:r="",colspan:e=1,origColspan:t=1,collapsible:n=!1,crossHiddenColumns:s=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:l=!1,isPlaceholder:u=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:r,colspan:e,origColspan:t,collapsible:n,isCollapsed:o,crossHiddenColumns:s,isHidden:a,isRoot:l,isPlaceholder:u,headerClassNames:c}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function normalizeSettings(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;arrayEach(r,s=>{const o=[];let a=0;t.push(o),arrayEach(s,l=>{const u=createDefaultHeaderSettings();if(isObject$1(l)){const{label:h,colspan:g,headerClassName:v}=l;u.label=stringify$1(h),typeof g=="number"&&g>1&&(u.colspan=g,u.origColspan=g),typeof v=="string"&&(u.headerClassNames=[...v.split(" ")])}else u.label=stringify$1(l);a+=u.origColspan;let c=!1;if(a>=e&&(u.colspan=u.origColspan-(a-e),u.origColspan=u.colspan,c=!0),o.push(u),u.colspan>1)for(let h=0;h<u.colspan-1;h++)o.push(createPlaceholderHeaderSettings());return!c})});const n=Math.max(...arrayMap(t,s=>s.length));return arrayEach(t,s=>{if(s.length<n){const o=arrayMap(new Array(n-s.length),()=>createDefaultHeaderSettings());s.splice(s.length,0,...o)}}),t}function _classPrivateFieldInitSpec$b(r,e,t){_checkPrivateRedeclaration$f(r,e),e.set(r,t)}function _checkPrivateRedeclaration$f(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$b(r,e){return r.get(_assertClassBrand$f(r,e))}function _classPrivateFieldSet$9(r,e,t){return r.set(_assertClassBrand$f(r,e),t),t}function _assertClassBrand$f(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap;class SourceSettings{constructor(){_classPrivateFieldInitSpec$b(this,_data,[]),_classPrivateFieldInitSpec$b(this,_dataLength,0),_classPrivateFieldInitSpec$b(this,_columnsLimit,1/0)}setColumnsLimit(e){_classPrivateFieldSet$9(_columnsLimit,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$9(_data,this,normalizeSettings(e,_classPrivateFieldGet$b(_columnsLimit,this))),_classPrivateFieldSet$9(_dataLength,this,_classPrivateFieldGet$b(_data,this).length)}getData(){return _classPrivateFieldGet$b(_data,this)}mergeWith(e){arrayEach(e,t=>{let{row:n,col:s,...o}=t;const a=this.getHeaderSettings(n,s);a!==null&&extend$1(a,o,HEADER_CONFIGURABLE_PROPS)})}map(e){arrayEach(_classPrivateFieldGet$b(_data,this),t=>{arrayEach(t,n=>{const s=e({...n});isObject$1(s)&&extend$1(n,s,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(e,t){var n;if(e>=_classPrivateFieldGet$b(_dataLength,this)||e<0)return null;const s=_classPrivateFieldGet$b(_data,this)[e];return Array.isArray(s)===!1||t>=s.length?null:(n=s[t])!==null&&n!==void 0?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=_classPrivateFieldGet$b(_dataLength,this)||e<0)return s;const o=_classPrivateFieldGet$b(_data,this)[e];let a=0;for(let l=t;l<o.length;l++){const u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=u.colspan,s.push(u),u.colspan>1&&(l+=u.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return _classPrivateFieldGet$b(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet$b(_dataLength,this)>0?_classPrivateFieldGet$b(_data,this)[0].length:0}clear(){_classPrivateFieldSet$9(_data,this,[]),_classPrivateFieldSet$9(_dataLength,this,0)}}function _defineProperty$o(r,e,t){return(e=_toPropertyKey$p(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$p(r){var e=_toPrimitive$p(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$p(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(r,e){let t=r.call(e,this);for(let n=0;n<this.childs.length;n++){if(t===!1)return!1;t=depthFirstPreOrder.call(this.childs[n],r,e)}return t}const TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(r,e){for(let t=0;t<this.childs.length;t++)if(depthFirstPostOrder.call(this.childs[t],r,e)===!1)return!1;return r.call(e,this)}const TRAVERSAL_BF="BF";function breadthFirst(r,e){const t=[this];function n(){if(t.length===0)return;const s=t.shift();t.push(...s.childs),r.call(e,s)!==!1&&n()}n()}const DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]);class TreeNode{constructor(e){_defineProperty$o(this,"data",{}),_defineProperty$o(this,"parent",null),_defineProperty$o(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new TreeNode({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);TRAVERSAL_STRATEGIES.get(t).call(this,e,this)}walkUp(e){const t=this,n=s=>{e.call(t,s)!==!1&&s.parent!==null&&n(s.parent)};n(this)}}function _classPrivateFieldInitSpec$a(r,e,t){_checkPrivateRedeclaration$e(r,e),e.set(r,t)}function _checkPrivateRedeclaration$e(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$a(r,e){return r.get(_assertClassBrand$e(r,e))}function _classPrivateFieldSet$8(r,e,t){return r.set(_assertClassBrand$e(r,e),t),t}function _assertClassBrand$e(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap;class HeadersTree{constructor(e){_classPrivateFieldInitSpec$a(this,_rootNodes,new Map),_classPrivateFieldInitSpec$a(this,_rootsIndex,new Map),_classPrivateFieldInitSpec$a(this,_sourceSettings$1,null),_classPrivateFieldSet$8(_sourceSettings$1,this,e)}getRoots(){return Array.from(_classPrivateFieldGet$a(_rootNodes,this).values())}getRootByColumn(e){let t;return _classPrivateFieldGet$a(_rootsIndex,this).has(e)&&(t=_classPrivateFieldGet$a(_rootNodes,this).get(_classPrivateFieldGet$a(_rootsIndex,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const s=t-_classPrivateFieldGet$a(_rootsIndex,this).get(t);let o=0,a;return n.walkDown(l=>{const{data:{origColspan:u,headerLevel:c}}=l;if(e===c){if(s>=o&&s<=o+u-1)return a=l,a.data.isRoot=t===a.data.columnIndex,!1;o+=u}}),a}rebuildTreeIndex(){let e=0;_classPrivateFieldGet$a(_rootsIndex,this).clear(),arrayEach(_classPrivateFieldGet$a(_rootNodes,this),t=>{let[,{data:{colspan:n}}]=t;for(let s=e;s<e+n;s++)_classPrivateFieldGet$a(_rootsIndex,this).set(s,e);e+=n})}buildTree(){this.clear();const e=_classPrivateFieldGet$a(_sourceSettings$1,this).getColumnsCount();let t=0;for(;t<e;){const n=_classPrivateFieldGet$a(_sourceSettings$1,this).getHeaderSettings(0,t),s=new TreeNode;_classPrivateFieldGet$a(_rootNodes,this).set(t,s),this.buildLeaves(s,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=_classPrivateFieldGet$a(_sourceSettings$1,this).getHeadersSettings(n,t,s);n+=1,arrayEach(o,a=>{const l={...a,headerLevel:n-1,columnIndex:t};let u;n===1?(e.data=l,u=e):(u=new TreeNode(l),e.addChild(u)),n<_classPrivateFieldGet$a(_sourceSettings$1,this).getLayersCount()&&this.buildLeaves(u,t,n,a.origColspan),t+=a.origColspan})}clear(){_classPrivateFieldGet$a(_rootNodes,this).clear(),_classPrivateFieldGet$a(_rootsIndex,this).clear()}}function traverseHiddenNodeColumnIndexes(r,e){r.walkDown(t=>{let{data:n,childs:s}=t;if(!n.isHidden&&(e(n.columnIndex),s.length===0))for(let o=1;o<n.colspan;o++)e(n.columnIndex+o)})}function getFirstChildProperty(r,e){let{childs:t}=r;if(t.length!==0)return t[0].data[e]}function isNodeReflectsFirstChildColspan(r){return getFirstChildProperty(r,"origColspan")===r.data.origColspan}function expandNode(r){const{data:e,childs:t}=r;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(r))return expandNode(t[0]);e.isCollapsed=!1;const s=t.slice(1),o=new Set;let a=0;if(s.length>0)arrayEach(s,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const u=l.data;a+=u.colspan,traverseHiddenNodeColumnIndexes(l,c=>{o.add(c)})});else{const{colspan:l,origColspan:u,columnIndex:c}=e;a=u-l;for(let h=1;h<u;h++)o.add(c+h)}return r.walkUp(l=>{const{data:u}=l;u.colspan+=a,u.colspan>=u.origColspan?(u.colspan=u.origColspan,u.isCollapsed=!1):isNodeReflectsFirstChildColspan(l)&&(u.isCollapsed=getFirstChildProperty(l,"isCollapsed"))}),{rollbackModification:()=>collapseNode(r),affectedColumns:Array.from(o),colspanCompensation:a}}function collapseNode(r){var e;const{data:t,childs:n}=r;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(r))return collapseNode(n[0]);t.isCollapsed=!0;const o=n.slice(1),a=new Set;if(o.length>0)arrayEach(o,u=>{traverseHiddenNodeColumnIndexes(u,c=>{a.add(c)}),u.data.clonedTree=u.cloneTree(),u.walkDown(c=>{let{data:h}=c;h.isHidden=!0})});else{const{origColspan:u,columnIndex:c}=t;for(let h=1;h<u;h++){const g=c+h;a.add(g)}}const l=t.colspan-((e=getFirstChildProperty(r,"colspan"))!==null&&e!==void 0?e:1);return r.walkUp(u=>{const{data:c}=u;c.colspan-=l,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):isNodeReflectsFirstChildColspan(u)&&(c.isCollapsed=getFirstChildProperty(u,"isCollapsed"))}),{rollbackModification:()=>expandNode(r),affectedColumns:Array.from(a),colspanCompensation:l}}function hideColumn(r,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=r.data;if(t.includes(e))return;let n=!1;r.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return n=!0,!1}),!n&&r.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function showColumn(r,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=r.data;if(!t.includes(e))return;let n=!1;r.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return n=!0,!1}),!n&&r.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(r,e,t){if(!availableModifiers.has(r))throw new Error(`The node modifier action ("${r}") does not exist.`);return availableModifiers.get(r)(e,t)}function generateMatrix(r){const e=[];return arrayEach(r,t=>{t.walkDown(n=>{const s=n.data,{origColspan:o,columnIndex:a,headerLevel:l,crossHiddenColumns:u}=s,c=createNestedArrayIfNecessary(e,l);let h=!1;for(let g=a;g<a+o;g++)if(u.includes(g)||h)c.push(createPlaceholderHeaderSettings());else{const m=createHeaderSettings(s);m.isRoot=!0,c.push(m),h=!0}})}),e}function createHeaderSettings(r){const{crossHiddenColumns:e,...t}=createDefaultHeaderSettings(r);return t}function createNestedArrayIfNecessary(r,e){let t;return Array.isArray(r[e])?t=r[e]:(t=[],r[e]=t),t}function _classPrivateFieldInitSpec$9(r,e,t){_checkPrivateRedeclaration$d(r,e),e.set(r,t)}function _checkPrivateRedeclaration$d(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$7(r,e,t){return r.set(_assertClassBrand$d(r,e),t),t}function _classPrivateFieldGet$9(r,e){return r.get(_assertClassBrand$d(r,e))}function _assertClassBrand$d(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap;class StateManager{constructor(){_classPrivateFieldInitSpec$9(this,_sourceSettings,new SourceSettings),_classPrivateFieldInitSpec$9(this,_headersTree,new HeadersTree(_classPrivateFieldGet$9(_sourceSettings,this))),_classPrivateFieldInitSpec$9(this,_stateMatrix,[[]])}setState(e){_classPrivateFieldGet$9(_sourceSettings,this).setData(e);let t=!1;try{_classPrivateFieldGet$9(_headersTree,this).buildTree()}catch{_classPrivateFieldGet$9(_headersTree,this).clear(),_classPrivateFieldGet$9(_sourceSettings,this).clear(),t=!0}return _classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots())),t}setColumnsLimit(e){_classPrivateFieldGet$9(_sourceSettings,this).setColumnsLimit(e)}mergeStateWith(e){const t=arrayMap(e,n=>{let{row:s,...o}=n;return{row:s<0?this.rowCoordsToLevel(s):s,...o}});_classPrivateFieldGet$9(_sourceSettings,this).mergeWith(t),_classPrivateFieldGet$9(_headersTree,this).buildTree(),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))}mapState(e){_classPrivateFieldGet$9(_sourceSettings,this).map(e),_classPrivateFieldGet$9(_headersTree,this).buildTree(),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))}mapNodes(e){return arrayReduce(_classPrivateFieldGet$9(_headersTree,this).getRoots(),(t,n)=>(n.walkDown(s=>{const o=e(s.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const s=_classPrivateFieldGet$9(_headersTree,this).getNode(t,n);let o;return s&&(o=triggerNodeModification(e,s,n),_classPrivateFieldSet$7(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$9(_headersTree,this).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(s=_classPrivateFieldGet$9(_stateMatrix,this)[e])===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?{...n.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=_classPrivateFieldGet$9(_headersTree,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const s=n-e+1;let o=!1,a=null;for(let l=e;l<=n;l++){const u=_classPrivateFieldGet$9(_headersTree,this).getRootByColumn(l);if(!u)break;o=!0,u.walkDown(c=>{const{columnIndex:h,headerLevel:g,origColspan:v,isHidden:m}=c.data;m||v<=s&&h>=e&&h+v-1<=n&&(a===null||g<a)&&(a=g)},TRAVERSAL_DF_PRE)}return o&&a===null?-1:this.levelToRowCoords((t=a)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:s}=(n=this.getHeaderSettings(e,t))!==null&&n!==void 0?n:{isRoot:!0};if(s)return t;let o=t-1;for(;o>=0;){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o-=1}return o}findRightMostColumnIndex(e,t){var n;const{isRoot:s,origColspan:o}=(n=this.getHeaderSettings(e,t))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(s)return t+o-1;let a=t+1;for(;a<this.getColumnsCount();){var l;const{isRoot:u}=(l=this.getHeaderSettings(e,a))!==null&&l!==void 0?l:{isRoot:!0};if(u)break;a+=1}return a-1}getLayersCount(){return _classPrivateFieldGet$9(_sourceSettings,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet$9(_sourceSettings,this).getColumnsCount()}clear(){_classPrivateFieldSet$7(_stateMatrix,this,[]),_classPrivateFieldGet$9(_sourceSettings,this).clear(),_classPrivateFieldGet$9(_headersTree,this).clear()}}function _defineProperty$n(r,e,t){return(e=_toPropertyKey$o(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$o(r){var e=_toPrimitive$o(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$o(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class GhostTable{constructor(e,t){_defineProperty$n(this,"hot",void 0),_defineProperty$n(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$n(this,"layersCount",0),_defineProperty$n(this,"container",void 0),_defineProperty$n(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let n=0;n<t;n++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=n.getRenderableIndexesLength();for(let u=0;u<this.layersCount;u++){const c=t.createElement("tr");for(let h=0;h<l;h++){let g=n.getVisualFromRenderableIndex(h);g===null&&(g=h);const v=t.createElement("th"),m=this.nestedHeaderSettingsGetter(u,g);if(m&&(!m.isPlaceholder||m.isHidden)){let E=m.label;a&&(E+='<button class="changeType"></button>'),fastInnerHTML(v,E),v.colSpan=m.colspan,c.appendChild(v)}}o.appendChild(c)}s.appendChild(o),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function _classPrivateMethodInitSpec$9(r,e){_checkPrivateRedeclaration$c(r,e),e.add(r)}function _defineProperty$m(r,e,t){return(e=_toPropertyKey$n(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$n(r){var e=_toPrimitive$n(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$n(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldInitSpec$8(r,e,t){_checkPrivateRedeclaration$c(r,e),e.set(r,t)}function _checkPrivateRedeclaration$c(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$6(r,e,t){return r.set(_assertClassBrand$c(r,e),t),t}function _classPrivateFieldGet$8(r,e){return r.get(_assertClassBrand$c(r,e))}function _assertClassBrand$c(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$7="nestedHeaders",PLUGIN_PRIORITY$6=280;var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_recentlyHighlightCoords=new WeakMap,_NestedHeaders_brand=new WeakSet;class NestedHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$9(this,_NestedHeaders_brand),_classPrivateFieldInitSpec$8(this,_stateManager,new StateManager),_classPrivateFieldInitSpec$8(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec$8(this,_focusInitialCoords,null),_classPrivateFieldInitSpec$8(this,_isColumnsSelectionInProgress,!1),_classPrivateFieldInitSpec$8(this,_recentlyHighlightCoords,null),_defineProperty$m(this,"ghostTable",new GhostTable(this.hot,(e,t)=>this.getHeaderSettings(e,t))),_defineProperty$m(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$6}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$7]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&warn$1(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_onInit).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterLoadData).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseDown$1).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterOnCellMouseDown).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseOver).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeOnCellMouseUp).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeSelectionHighlightSet).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyTransformStart).call(e,...s)}),this.addHook("afterSelection",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeViewportScrollHorizontally).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",n=>_assertClassBrand$c(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyColWidth$1).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyColumnHeaderValue).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeHighlightingColumnHeader).call(e,...s)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeCopy).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onBeforeSelectColumns).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onAfterViewportColumnCalculatorOverride).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$c(_NestedHeaders_brand,e,_onModifyFocusedElement).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$c(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_classPrivateFieldGet$8(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$8(_stateManager,this).setState(e)),this.detectedOverlappedHeaders&&warn$1(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,n)=>{const s=t===!0?"hide-column":"show-column";_classPrivateFieldGet$8(_stateManager,this).triggerColumnModification(s,n)}),!_classPrivateFieldGet$8(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet$6(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(n=>{let{op:s,index:o,newValue:a}=n;if(s==="replace"){const l=a===!0?"hide-column":"show-column";_classPrivateFieldGet$8(_stateManager,this).triggerColumnModification(l,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_classPrivateFieldGet$8(_stateManager,this).clear(),_classPrivateFieldGet$8(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$6(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet$8(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet$8(_stateManager,this).getLayersCount()}getHeaderSettings(e,t){return _classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<t;a++){const l=n.childNodes[a];if(!l)break;const u=s.childNodes[a],c=o?o.childNodes[a]:null;for(let h=0,g=l.childNodes.length;h<g;h++)l.childNodes[h].removeAttribute("colspan"),removeClass$1(l.childNodes[h],"hiddenHeader"),u&&u.childNodes[h]&&(u.childNodes[h].removeAttribute("colspan"),removeClass$1(u.childNodes[h],"hiddenHeader")),o&&c&&c.childNodes[h]&&(c.childNodes[h].removeAttribute("colspan"),removeClass$1(c.childNodes[h],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,o)=>{var a;const{columnIndexMapper:l,view:u}=this.hot;let c=l.getVisualFromRenderableIndex(s);c===null&&(c=s),o.removeAttribute("colspan"),removeClass$1(o,"hiddenHeader");const{colspan:h,isHidden:g,isPlaceholder:v,headerClassNames:m}=(a=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,c))!==null&&a!==void 0?a:{label:""};if(v||g)addClass$1(o,"hiddenHeader");else if(h>1){var E,_;const{wtOverlays:S}=u._wt,w=(E=S.topInlineStartCornerOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(o),A=(_=S.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(o),O=w||A?Math.min(h,n-s):h;O>1&&o.setAttribute("colspan",O)}if(this.hot.view.appendColHeader(c,o,function(){return t.getColumnHeaderValue(...arguments)},e),!v&&!g){const S=o.querySelector("div.relative");S&&m&&m.length>0&&(removeClass$1(S,this.hot.getColumnMeta(c).headerClassName),addClass$1(S,m))}}}getColumnHeaderValue(e,t){var n;const{isHidden:s,isPlaceholder:o}=(n=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(t,e))!==null&&n!==void 0?n:{};return o||s?"":this.hot.getColHeader(e,t)}destroy(){_classPrivateFieldSet$6(_stateManager,this,null),_classPrivateFieldGet$8(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet$8(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$6(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(e.row,e.col)}}function _updateFocusHighlightPosition(){var r;const e=(r=this.hot)===null||r===void 0?void 0:r.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const s=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(t.row,t.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}}function _onBeforeViewportScrollHorizontally(r,e){var t;const n=this.hot.getSelectedRangeLast();if(!n)return r;const{highlight:s}=n,{navigableHeaders:o}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),l=o?s.row:(t=_classPrivateFieldGet$8(_recentlyHighlightCoords,this))===null||t===void 0?void 0:t.row,u=a?r:s.col,c=l<0&&u>=0;if(_classPrivateFieldSet$6(_recentlyHighlightCoords,this,null),!c)return r;const h=this.hot.getFirstFullyVisibleColumn(),g=this.hot.getLastFullyVisibleColumn(),v=g-h+1,m=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(l,u),E=_classPrivateFieldGet$8(_stateManager,this).findRightMostColumnIndex(l,u),_=E-m+1;if(m<h&&E>g)return m;if(a){let S=null;return m>=h&&E>g?_>v?(e.value="start",S=m):(e.value="end",S=E):m<h&&E<=g&&(_>v?(e.value="end",S=E):(e.value="start",S=m)),S}return m<=h?m:E}function _onBeforeHighlightingColumnHeader(r,e,t){const n=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(e,r);if(!n)return r;const{columnCursor:s,selectionType:o,selectionWidth:a}=t,{isRoot:l,colspan:u}=_classPrivateFieldGet$8(_stateManager,this).getHeaderSettings(e,r);if(o===HEADER_TYPE){if(!l)return n.columnIndex}else if(o===ACTIVE_HEADER_TYPE&&(u>a-s||!l))return null;return r}function _onBeforeCopy(r,e,t){let{columnHeadersCount:n}=t;if(n!==0)for(let o=0;o<e.length;o++){const{startRow:a,startCol:l,endRow:u,endCol:c}=e[o],h=u-a+1,g=l-c+1;if(a>=0||g===1)break;for(let v=l;v<=c;v++)for(let m=a;m<=u;m++){var s;const E=h+m,_=v-l;if(_===0)continue;((s=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(m,v))===null||s===void 0?void 0:s.isRoot)===!1&&(r[E][_]="")}}}function _onBeforeOnCellMouseDown$1(r,e,t,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function _onAfterOnCellMouseDown(r,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;_classPrivateFieldSet$6(_focusInitialCoords,this,e.clone()),_classPrivateFieldSet$6(_isColumnsSelectionInProgress,this,!0);const{selection:n}=this.hot,s=n.isSelected()?n.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:l}=t,u=!n.inInSelection(e);r.shiftKey&&s?e.col<s.from.col?o.push(s.getTopEndCorner().col,a,e.row):e.col>s.from.col?o.push(s.getTopStartCorner().col,a+l-1,e.row):o.push(a,a+l-1,e.row):(isLeftClick(r)||isRightClick(r)&&u||isTouchEvent(r))&&o.push(a,a+l-1,e.row),n.selectColumns(...o)}function _onBeforeOnCellMouseOver(r,e,t,n){if(!this.hot.view.isMouseDown()||n.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:o,origColspan:a}=s,l=this.hot.getSelectedRangeLast(),u=l.getTopStartCorner(),c=l.getBottomEndCorner(),{from:h}=l;n.column=!0,n.cell=!0;const g=[],v=clamp(e.row,-1/0,-1);e.col<h.col?g.push(c.col,o,v):e.col>h.col?g.push(u.col,o+a-1,v):g.push(o,o+a-1,v),this.hot.selection.selectColumns(...g)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet$6(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet(){const{navigableHeaders:r}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet$8(_isColumnsSelectionInProgress,this)||!r)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:s,origColspan:o}=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet$8(_focusInitialCoords,this).row,_classPrivateFieldGet$8(_focusInitialCoords,this).col);if(e.setHighlight(_classPrivateFieldGet$8(_focusInitialCoords,this)),o>e.getWidth()||s<t||s+o-1>n){const a=_classPrivateFieldGet$8(_stateManager,this).findTopMostEntireHeaderLevel(clamp(t,s,s+o-1),clamp(n,s,s+o-1));e.highlight.row=a,e.highlight.col=e.from.col}}function _onModifyTransformStart(r){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+r.row,e.col+r.col);if(!(t.isHeader()&&t.col>=0))return;const s=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(t.row,t.col),o=_classPrivateFieldGet$8(_stateManager,this).findRightMostColumnIndex(t.row,t.col);if(r.col<0){const a=e.col>=s&&e.col<=o?s-1:o,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);l===null?r.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,e.col)-1,1)}else if(r.col>0){const a=e.col>=s&&e.col<=o?o+1:s,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);l===null?r.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,l)-1,1)}}function _onBeforeSelectColumns(r,e,t){const n=r.row,s=this._getHeaderTreeNodeDataByCoords({row:n,col:r.col}),o=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});_classPrivateFieldSet$6(_recentlyHighlightCoords,this,t.clone()),e.col<r.col?(s&&(r.col=s.columnIndex+s.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=r.col&&(s&&(r.col=s.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function _onAfterGetColumnHeaderRenderers(r){r.length=0;for(let e=0;e<_classPrivateFieldGet$8(_stateManager,this).getLayersCount();e++)r.push(this.headerRendererFactory(e))}function _onAfterViewportColumnCalculatorOverride(r){const e=_classPrivateFieldGet$8(_stateManager,this).getLayersCount();let t=r.startColumn,n=!!e;for(let s=0;s<e;s++){const o=_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(s,r.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(n=!1),isNumeric(a)&&a<r.startColumn){t=a;break}}r.startColumn=n?_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(0,t).columnIndex:t}function _onModifyColWidth$1(r,e){const t=this.ghostTable.getWidth(e);return r>t?r:t}function _onModifyColumnHeaderValue(r,e,t){var n;const{label:s}=(n=_classPrivateFieldGet$8(_stateManager,this).getHeaderTreeNodeData(t,e))!==null&&n!==void 0?n:{label:""};return s}function _onModifyFocusedElement(r,e){if(r<0)return this.hot.getCell(r,_classPrivateFieldGet$8(_stateManager,this).findLeftMostColumnIndex(r,e),!0)}function _onInit(){this.updatePlugin()}function _onAfterLoadData(r,e){e||this.updatePlugin()}function _defineProperty$l(r,e,t){return(e=_toPropertyKey$m(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$m(r){var e=_toPrimitive$m(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$m(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataManager{constructor(e,t){_defineProperty$l(this,"hot",void 0),_defineProperty$l(this,"data",null),_defineProperty$l(this,"plugin",void 0),_defineProperty$l(this,"parentReference",new WeakMap),_defineProperty$l(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&arrayEach(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,n,s){let o=!1,a=t;if(isNaN(a)&&a.end)return a;let l=e;return l||(l={__children:this.data},o=!0,a-=1),n!=null&&a===n?{result:l,end:!0}:s!=null&&l===s?{result:a,end:!0}:(a+=1,l.__children&&arrayEach(l.__children,u=>{if(this.parentReference.set(u,o?null:l),a=this.readTreeNodes(u,a,n,s),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return objectEach(this.data[0],(t,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(arrayEach(n.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var n;return((n=e.__children)===null||n===void 0?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((t=n.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();const a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let s=n,o;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){const l=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);s=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),s=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(s,o+1,null);break;case"above":this.addChildAtIndex(s,o,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const s=[];Array.isArray(e)?(rangeEach(e[0],e[2],v=>{const m=this.translateTrimmedRow(v);s.push(this.getDataObject(m))}),rangeEach(0,s.length-2,v=>{this.detachFromParent(s[v],!1)}),n=s[s.length-1]):n=e;const o=this.getRowIndex(n),a=this.countChildren(n),l=this.getRowIndexWithinParent(n),u=this.getRowParent(n),c=this.getRowParent(u),h=this.getRowIndex(c);let g=null;if(this.hot.runHooks("beforeDetachChild",u,n),l!=null){const v=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,v,this.plugin.pluginName),u.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,v,this.plugin.pluginName),c){g=h+this.countChildren(c);const m=this.getChild(c,this.countChildren(c)-1),E=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",E+1,a+1,this.plugin.pluginName),c.__children.push(n)}else g=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",g-2,a+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",g-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const s=[];arrayEach(n,o=>{s.push(this.getDataObject(o))}),arrayEach(s,o=>{const a=this.getRowIndexWithinParent(o),l=this.getRowParent(o);l===null?this.data.splice(a,1):l.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,t,n){const s=this.getDataObject(e-1);let o=null,a=e;s&&s.__children&&s.__children.length===0?(o=s,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?n?o.__children.splice(a,t,...n):o.__children.splice(a,t):n?this.data.splice(a,t,...n):this.data.splice(a,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do n=this.getRowParent(n),n!==null&&(t=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,s){const o=t===this.hot.countRows(),a=this.getRowParent(e),l=this.getRowIndexWithinParent(e),u=a.__children.slice(l,l+1),c=e>t;let h=o?this.getRowParent(t-1):this.getRowParent(t);h==null&&(h=this.getRowParent(t-1)),h==null&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const g=o||n||s?h.__children.length:this.getRowIndexWithinParent(t),v=a===h;h.__children.splice(g,0,u[0]),a.__children.splice(l+(c&&v?1:0),1),this.syncRowWithRawSource(a),v||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function _defineProperty$k(r,e,t){return(e=_toPropertyKey$l(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$l(r){var e=_toPrimitive$l(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$l(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class BaseUI{constructor(e,t){_defineProperty$k(this,"hot",void 0),_defineProperty$k(this,"plugin",void 0),this.hot=t,this.plugin=e}}class HeadersUI extends BaseUI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(n),o=this.dataManager.getDataObject(n),a=t.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),u=a.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(arrayEach(u,h=>{h&&a.removeChild(h)}),addClass$1(t,HeadersUI.CSS_CLASSES.indicatorContainer),s){const{rootDocument:h}=this.hot,g=l.cloneNode(!0);a.innerHTML="",rangeEach(0,s-1,()=>{const v=h.createElement("SPAN");addClass$1(v,HeadersUI.CSS_CLASSES.emptyIndicator),a.appendChild(v)}),a.appendChild(g)}if(this.dataManager.hasChildren(o)){const h=this.hot.rootDocument.createElement("DIV");c&&setAttribute(h,[A11Y_HIDDEN()]),addClass$1(t,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(addClass$1(h,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),c&&setAttribute(t,[A11Y_EXPANDED(!1)])):(addClass$1(h,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),c&&setAttribute(t,[A11Y_EXPANDED(!0)])),a.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let s=11;n.isClassicTheme()||(s=n.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*t+25),this.hot.render()}}class CollapsingUI extends BaseUI{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,s)},shiftStash:function(s,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),arrayEach(n.lastCollapsedRows,(l,u)=>{l>=s&&l<o&&(n.lastCollapsedRows[u]=l+a)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,s),n.lastCollapsedRows=void 0},trimStash:(s,o)=>{rangeEach(s,s+o-1,a=>{const l=this.lastCollapsedRows.indexOf(a);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,a=null,l=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{s.push(this.dataManager.getRowIndex(u))}),l=this.collapseRows(s,!0,!1),n&&this.trimRows(l),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),l}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];arrayEach(e,o=>{s.push(...this.collapseChildren(o,!1,!1))}),n&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return arrayEach(e,o=>{s.push(o),t&&this.collapseChildRows(o,s)}),n&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);arrayEach(s.__children,o=>{const a=this.dataManager.getRowIndex(o);t.push(a),this.collapseChildRows(a,t)})}n&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return arrayEach(e,o=>{s.push(o),t&&this.expandChildRows(o,s)}),n&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);arrayEach(s.__children,o=>{if(!this.isAnyParentCollapsed(o)){const a=this.dataManager.getRowIndex(o);t.push(a),this.expandChildRows(a,t)}})}n&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,a=null,l=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{const c=this.dataManager.getRowIndex(u);s.push(c)}),l=this.expandRows(s,!0,!1),n&&this.untrimRows(l),t&&this.renderAndAdjust(),l}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];arrayEach(e,o=>{s.push(...this.expandChildren(o,!1,!1))}),n&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&arrayEach(t.__children,s=>{const o=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return n=!1,!1}),n}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);hasClass$1(e.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),stopImmediatePropagation(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function _classPrivateFieldInitSpec$7(r,e,t){_checkPrivateRedeclaration$b(r,e),e.set(r,t)}function _checkPrivateRedeclaration$b(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$j(r,e,t){return(e=_toPropertyKey$k(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$k(r){var e=_toPrimitive$k(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$k(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$7(r,e){return r.get(_assertClassBrand$b(r,e))}function _assertClassBrand$b(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap;class ContextMenuUI extends BaseUI{constructor(){super(...arguments),_defineProperty$j(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec$7(this,_menuEntries,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(n);this.dataManager.addChild(s)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(s)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,n=>{if(n===0)return arrayEach(t,(s,o)=>{e.items.splice(n+o,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return rangeEach(0,e.items.length-1,t=>{const n=_classPrivateFieldGet$7(_menuEntries,this)[e.items[t].key];n!=null&&(e.items[t].callback=n)}),e}}function _defineProperty$i(r,e,t){return(e=_toPropertyKey$j(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$j(r){var e=_toPrimitive$j(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$j(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class RowMoveController{constructor(e){_defineProperty$i(this,"plugin",void 0),_defineProperty$i(this,"hot",void 0),_defineProperty$i(this,"dataManager",void 0),_defineProperty$i(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:s}))return!1;this.movedToCollapsed=!1;const a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let u=!0;const c=e.map(E=>{if(!u)return!1;const _=this.dataManager.translateTrimmedRow(E);return u=this.shouldAllowMoving(_,l),_}),h=c.indexOf(l)===-1;if(!u||!h)return!1;const g=this.getBaseParent(c),v=this.getTargetParent(a,l),m=g===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,l,m),this.moveRows(c,l,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:s,movePossible:o}=e;let a=!1;return isUndefined$1(s)&&(warn$1(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,s,o,!1),a=!0),a}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return n==null&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const s=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){const n=[],s=Math.max(...e)<t;e.forEach(o=>{n.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let s=0,o=0,a=null,l=null;if(this.movedToCollapsed){let u=null;e[n-1]<t?u=this.dataManager.translateTrimmedRow(t-n):u=this.dataManager.translateTrimmedRow(t);const c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),h=this.dataManager.getRowIndex(c);s=this.dataManager.untranslateTrimmedRow(h),o=s}else e[n-1]<t?(o=t-1,s=o-n+1):(s=t,o=s+n-1);a=this.hot.selection,l=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(s,0)),a.setRangeEnd(this.hot._createCellCoords(o,l),!0)}isRowOrderChanged(e,t){return e.some((n,s)=>n-s!==t)}}function _classPrivateMethodInitSpec$8(r,e){_checkPrivateRedeclaration$a(r,e),e.add(r)}function _classPrivateFieldInitSpec$6(r,e,t){_checkPrivateRedeclaration$a(r,e),e.set(r,t)}function _checkPrivateRedeclaration$a(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$h(r,e,t){return(e=_toPropertyKey$i(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$i(r){var e=_toPrimitive$i(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$i(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$6(r,e){return r.get(_assertClassBrand$a(r,e))}function _classPrivateFieldSet$5(r,e,t){return r.set(_assertClassBrand$a(r,e),t),t}function _assertClassBrand$a(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$6="nestedRows",PLUGIN_PRIORITY$5=300,SHORTCUTS_GROUP$1=PLUGIN_KEY$6,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet;class NestedRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$8(this,_NestedRows_brand),_defineProperty$h(this,"dataManager",null),_defineProperty$h(this,"headersUI",null),_defineProperty$h(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec$6(this,_skipRender,!1),_classPrivateFieldInitSpec$6(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$5}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$6]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager(this,this.hot),this.collapsingUI=new CollapsingUI(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new ContextMenuUI(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterInit).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeViewRender).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onFilterData).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterContextMenuDefaultOptions).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterGetRowHeader).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeOnCellMouseDown).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeRemoveRow).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterRemoveRow).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeAddChild).call(e,...n)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterAddChild).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeDetachChild).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterDetachChild).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onModifyRowHeaderWidth).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onAfterCreateRow).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$a(_NestedRows_brand,e,_onBeforeRowMove).call(e,...n)}),this.addHook("beforeLoadData",t=>_assertClassBrand$a(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.addHook("beforeUpdateData",t=>_assertClassBrand$a(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:SHORTCUTS_GROUP$1,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$1)}disableCoreAPIModifiers(){_classPrivateFieldSet$5(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet$5(_skipCoreAPIModifiers,this,!1)}onModifyRowData(e){if(!_classPrivateFieldGet$6(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_classPrivateFieldGet$6(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return _classPrivateFieldGet$6(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function _onBeforeRowMove(r,e,t,n){return this.rowMoveController.onBeforeRowMove(r,e,t,n)}function _onBeforeOnCellMouseDown(r,e,t){this.collapsingUI.toggleState(r,e,t)}function _onFilterData(r,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(r,e,t),_classPrivateFieldSet$5(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions(r){return this.contextMenuUI.appendOptions(r)}function _onAfterGetRowHeader(r,e){this.headersUI.appendLevelIndicators(r,e)}function _onModifyRowHeaderWidth(r){return Math.max(this.headersUI.rowHeaderWidthCache,r)}function _onAfterRemoveRow(r,e,t,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet$5(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow(r,e,t){const n=Array.from(t.reduce((s,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return s.add(o),Array.isArray(a)&&a.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(o)},new Set));t.length=0,t.push(...n)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(r,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild(r,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow(){this.dataManager.rewriteCache()}function _onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(r,e){_classPrivateFieldGet$6(_skipRender,this)&&(e.skipRender=!0)}function _onBeforeLoadData(r){if(!isArrayOfObjects(r)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$6]=!1,this.disablePlugin();return}this.dataManager.setData(r),this.dataManager.rewriteCache()}function _defineProperty$g(r,e,t){return(e=_toPropertyKey$h(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$h(r){var e=_toPrimitive$h(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$h(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Storage{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty$g(this,"rootWindow",void 0),_defineProperty$g(this,"prefix",void 0),_defineProperty$g(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=typeof e>"u"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){arrayEach(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function _defineProperty$f(r,e,t){return(e=_toPropertyKey$g(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$g(r){var e=_toPrimitive$g(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$g(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}Hooks.getSingleton().register("persistentStateSave");Hooks.getSingleton().register("persistentStateLoad");Hooks.getSingleton().register("persistentStateReset");const PLUGIN_KEY$5="persistentState",PLUGIN_PRIORITY$4=0;class PersistentState extends BasePlugin{constructor(){super(...arguments),_defineProperty$f(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$4}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$5]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Storage(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function _classPrivateMethodInitSpec$7(r,e){_checkPrivateRedeclaration$9(r,e),e.add(r)}function _checkPrivateRedeclaration$9(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$e(r,e,t){return(e=_toPropertyKey$f(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$f(r){var e=_toPrimitive$f(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$f(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$9(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$4="search",PLUGIN_PRIORITY$3=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(r,e,t,n,s){r.getCellMeta(e,t).isSearchResult=s},DEFAULT_QUERY_METHOD=function(r,e,t){return isUndefined$1(r)||r===null||!r.toLocaleLowerCase||r.length===0||isUndefined$1(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(r.toLocaleLowerCase(t.locale))!==-1};var _Search_brand=new WeakSet;class Search extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$7(this,_Search_brand),_defineProperty$e(this,"callback",DEFAULT_CALLBACK),_defineProperty$e(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty$e(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY$4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$3}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$4]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$4];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$9(_Search_brand,e,_onBeforeRenderer).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return _assertClassBrand$9(_Search_brand,e,_onBeforeRenderer).call(e,...s)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),o=this.hot.countCols(),a=[],l=this.hot;return rangeEach(0,s-1,u=>{rangeEach(0,o-1,c=>{const h=this.hot.getDataAtCell(u,c),g=this.hot.getCellMeta(u,c),v=g.search.callback||t,E=(g.search.queryMethod||n)(e,h,g);if(E){const _={row:u,col:c,data:h};a.push(_)}v&&v(l,u,c,h,E)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){isObject$1(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _onBeforeRenderer(r,e,t,n,s,o){const a=o.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}function _defineProperty$d(r,e,t){return(e=_toPropertyKey$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$e(r){var e=_toPrimitive$e(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$e(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class StretchStrategy{constructor(e){_defineProperty$d(this,"viewportWidth",void 0),_defineProperty$d(this,"overwriteColumnWidthFn",void 0),_defineProperty$d(this,"baseWidths",new Map),_defineProperty$d(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class StretchAllStrategy extends StretchStrategy{calculate(){const e=Array.from(this.baseWidths).reduce((g,v)=>{let[,m]=v;return g+m},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,s=[],o=[];let a=this.viewportWidth,l=0;if(this.baseWidths.forEach((g,v)=>{const m=Math.round(g*n),E=this.overwriteColumnWidthFn(m,v);m===E&&m>=DEFAULT_WIDTH?(s.push([v,E]),l+=E):m!==E&&(s.push([v,E]),o.push(v),a-=E)}),a<=DEFAULT_WIDTH){this.stretchedWidths.clear();return}const u=a/l;let c=-1,h=0;s.forEach((g,v)=>{let[m,E]=g,_=E;o.includes(m)||(_=Math.round(E*u)),this.stretchedWidths.set(m,_),c=m,v<s.length-1&&(h+=_)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-h))}}function _classPrivateFieldInitSpec$5(r,e,t){_checkPrivateRedeclaration$8(r,e),e.set(r,t)}function _checkPrivateRedeclaration$8(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$5(r,e){return r.get(_assertClassBrand$8(r,e))}function _classPrivateFieldSet$4(r,e,t){return r.set(_assertClassBrand$8(r,e),t),t}function _assertClassBrand$8(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _lastColumnWidth=new WeakMap,_lastColumnIndex=new WeakMap;class StretchLastStrategy extends StretchStrategy{constructor(){super(...arguments),_classPrivateFieldInitSpec$5(this,_lastColumnWidth,0),_classPrivateFieldInitSpec$5(this,_lastColumnIndex,-1)}prepare(e){super.prepare(e),_classPrivateFieldSet$4(_lastColumnWidth,this,0),_classPrivateFieldSet$4(_lastColumnIndex,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),_classPrivateFieldSet$4(_lastColumnIndex,this,e),_classPrivateFieldSet$4(_lastColumnWidth,this,t)}calculate(){if(_classPrivateFieldGet$5(_lastColumnIndex,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,s)=>{let[,o]=s;return n+o},0),t=Math.max(this.viewportWidth-e+_classPrivateFieldGet$5(_lastColumnWidth,this),0);this.stretchedWidths.set(_classPrivateFieldGet$5(_lastColumnIndex,this),t)}}function _classPrivateMethodInitSpec$6(r,e){_checkPrivateRedeclaration$7(r,e),e.add(r)}function _classPrivateFieldInitSpec$4(r,e,t){_checkPrivateRedeclaration$7(r,e),e.set(r,t)}function _checkPrivateRedeclaration$7(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$4(r,e){return r.get(_assertClassBrand$7(r,e))}function _classPrivateFieldSet$3(r,e,t){return r.set(_assertClassBrand$7(r,e),t),t}function _assertClassBrand$7(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const STRETCH_WIDTH_MAP_NAME="stretchColumns";var _hot$1=new WeakMap,_widthsMap=new WeakMap,_stretchStrategies=new WeakMap,_activeStrategy=new WeakMap,_StretchCalculator_brand=new WeakSet;class StretchCalculator{constructor(e){_classPrivateMethodInitSpec$6(this,_StretchCalculator_brand),_classPrivateFieldInitSpec$4(this,_hot$1,void 0),_classPrivateFieldInitSpec$4(this,_widthsMap,void 0),_classPrivateFieldInitSpec$4(this,_stretchStrategies,new Map([["all",new StretchAllStrategy(_assertClassBrand$7(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))],["last",new StretchLastStrategy(_assertClassBrand$7(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))]])),_classPrivateFieldInitSpec$4(this,_activeStrategy,"none"),_classPrivateFieldSet$3(_hot$1,this,e),_classPrivateFieldSet$3(_widthsMap,this,_classPrivateFieldGet$4(_hot$1,this).columnIndexMapper.createAndRegisterIndexMap(STRETCH_WIDTH_MAP_NAME,"physicalIndexToValue"))}useStrategy(e){_classPrivateFieldSet$3(_activeStrategy,this,_classPrivateFieldGet$4(_stretchStrategies,this).has(e)?e:"none")}refreshStretching(){if(_classPrivateFieldGet$4(_activeStrategy,this)==="none"){_classPrivateFieldGet$4(_widthsMap,this).clear();return}_classPrivateFieldGet$4(_hot$1,this).batchExecution(()=>{_classPrivateFieldGet$4(_widthsMap,this).clear();const e=_classPrivateFieldGet$4(_stretchStrategies,this).get(_classPrivateFieldGet$4(_activeStrategy,this));let n=_classPrivateFieldGet$4(_hot$1,this).view.getViewportWidth();_assertClassBrand$7(_StretchCalculator_brand,this,_willVerticalScrollAppear).call(this)&&(n-=getScrollbarWidth(_classPrivateFieldGet$4(_hot$1,this).rootDocument)),e.prepare({viewportWidth:n});for(let s=0;s<_classPrivateFieldGet$4(_hot$1,this).countCols();s++)_classPrivateFieldGet$4(_hot$1,this).columnIndexMapper.isHidden(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,_assertClassBrand$7(_StretchCalculator_brand,this,_getWidthWithoutStretching).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[o,a]=s;_classPrivateFieldGet$4(_widthsMap,this).setValueAtIndex(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(o),a)})},!0)}getStretchedWidth(e){return _classPrivateFieldGet$4(_widthsMap,this).getValueAtIndex(_classPrivateFieldGet$4(_hot$1,this).toPhysicalColumn(e))}}function _willVerticalScrollAppear(){const{view:r}=_classPrivateFieldGet$4(_hot$1,this);if(r.isVerticallyScrollableByWindow())return!1;const e=r.getViewportHeight(),t=_classPrivateFieldGet$4(_hot$1,this).countRows(),n=r.getStylesHandler().getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<t;l++){var a;if(s+=((a=_classPrivateFieldGet$4(_hot$1,this).getRowHeight(l))!==null&&a!==void 0?a:n)+(l===0?1:0),s>e){o=!0;break}}return o}function _getWidthWithoutStretching(r){var e;return(e=_classPrivateFieldGet$4(_hot$1,this).getColWidth(r,"StretchColumns"))!==null&&e!==void 0?e:DEFAULT_WIDTH}function _overwriteColumnWidthFn(r,e){return _classPrivateFieldGet$4(_hot$1,this).runHooks("beforeStretchingColumnWidth",r,e)}function _classPrivateMethodInitSpec$5(r,e){_checkPrivateRedeclaration$6(r,e),e.add(r)}function _classPrivateFieldInitSpec$3(r,e,t){_checkPrivateRedeclaration$6(r,e),e.set(r,t)}function _checkPrivateRedeclaration$6(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$2(r,e,t){return r.set(_assertClassBrand$6(r,e),t),t}function _classPrivateFieldGet$3(r,e){return r.get(_assertClassBrand$6(r,e))}function _assertClassBrand$6(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$3="stretchColumns",PLUGIN_PRIORITY$2=155;var _stretchCalculator=new WeakMap,_previousTableWidth=new WeakMap,_resizeObserver=new WeakMap,_StretchColumns_brand=new WeakSet;class StretchColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$5(this,_StretchColumns_brand),_classPrivateFieldInitSpec$3(this,_stretchCalculator,new StretchCalculator(this.hot)),_classPrivateFieldInitSpec$3(this,_previousTableWidth,null),_classPrivateFieldInitSpec$3(this,_resizeObserver,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;(t=this.hot)!==null&&t!==void 0&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:s}=n;_classPrivateFieldGet$3(_previousTableWidth,this)!==null&&_classPrivateFieldGet$3(_previousTableWidth,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),_classPrivateFieldSet$2(_previousTableWidth,this,s.width)})})}))}static get PLUGIN_KEY(){return PLUGIN_KEY$3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$2}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$3(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),_classPrivateFieldGet$3(_resizeObserver,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$6(_StretchColumns_brand,e,_onBeforeRender).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return _assertClassBrand$6(_StretchColumns_brand,e,_onModifyColWidth).call(e,...n)},10),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$3(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_classPrivateFieldGet$3(_resizeObserver,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return _classPrivateFieldGet$3(_stretchCalculator,this).getStretchedWidth(e)}destroy(){_classPrivateFieldGet$3(_resizeObserver,this).disconnect(),_classPrivateFieldSet$2(_resizeObserver,this,null),_classPrivateFieldSet$2(_stretchCalculator,this,null),super.destroy()}}function _onModifyColWidth(r,e,t){if(t===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:r}function _onBeforeRender(r){r&&_classPrivateFieldGet$3(_stretchCalculator,this).refreshStretching()}function _classPrivateMethodInitSpec$4(r,e){_checkPrivateRedeclaration$5(r,e),e.add(r)}function _checkPrivateRedeclaration$5(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$c(r,e,t){return(e=_toPropertyKey$d(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$d(r){var e=_toPrimitive$d(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$d(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$5(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$2="touchScroll",PLUGIN_PRIORITY$1=200;var _TouchScroll_brand=new WeakSet;class TouchScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$4(this,_TouchScroll_brand),_defineProperty$c(this,"scrollbars",[]),_defineProperty$c(this,"clones",[]),_defineProperty$c(this,"lockedCollection",!1),_defineProperty$c(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$1}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand$5(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}}function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:r,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(r),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),n&&this.scrollbars.push(n),s&&s.clone&&this.scrollbars.push(s),this.clones=[],r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach(this.clones,r=>{addClass$1(r,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach(this.clones,r=>{removeClass$1(r,"hide-tween"),addClass$1(r,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach(this.clones,r=>{removeClass$1(r,"show-tween")})},400),arrayEach(this.scrollbars,r=>{r.refresh(),r.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function _classPrivateMethodInitSpec$3(r,e){_checkPrivateRedeclaration$4(r,e),e.add(r)}function _checkPrivateRedeclaration$4(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$b(r,e,t){return(e=_toPropertyKey$c(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$c(r){var e=_toPrimitive$c(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$c(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$4(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$1="trimRows",PLUGIN_PRIORITY=330;var _TrimRows_brand=new WeakSet;class TrimRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$3(this,_TrimRows_brand),_defineProperty$b(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$1}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand$4(_TrimRows_brand,this,_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let s=t;n&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,n)!==!1&&(n&&this.hot.batchExecution(()=>{arrayEach(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,n,n&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let s=t;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;n&&a&&(arrayEach(e,u=>{o[u]=!1}),s=arrayReduce(o,(u,c,h)=>(c&&u.push(h),u),[])),this.hot.runHooks("beforeUntrimRow",t,s,n&&a)!==!1&&(n&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,s,n&&a,n&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<t)}destroy(){super.destroy()}}function _onMapInit(){const r=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(r)&&this.hot.batchExecution(()=>{arrayEach(r,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var es_object_fromEntries={},hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var r=require_export(),e=requireIterate(),t=requireCreateProperty();return r({target:"Object",stat:!0},{fromEntries:function(s){var o={};return e(s,function(a,l){t(o,a,l)},{AS_ENTRIES:!0}),o}}),es_object_fromEntries}requireEs_object_fromEntries();const SHORTCUTS_GROUP="undoRedo",PLUGIN_KEY="undoRedo";function UndoRedo$1(r){const e=this;this.instance=r,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,r.addHook("afterChange",function(n,s){const o=n&&n.length;if(!o||!n.find(u=>{const[,,c,h]=u;return c!==h}))return;const l=()=>{const u=n.reduce((h,g)=>(h.push([...g]),h),[]);arrayEach(u,h=>{h[1]=r.propToCol(h[1])});const c=o>1?this.getSelected():[[u[0][0],u[0][1]]];return new UndoRedo$1.ChangeAction(u,c)};e.done(l,s)}),r.addHook("afterCreateRow",(n,s,o)=>{e.done(()=>new UndoRedo$1.CreateRowAction(n,s),o)});const t=(n,s,o,a)=>{const l=["visualRow","visualCol","row","col","prop"],u=l.length,c=[];return rangeEach(o,a,h=>{rangeEach(n,s,g=>{const v=r.getCellMeta(g,h);if(Object.keys(v).length!==u){const m=Object.fromEntries(Object.entries(v).filter(E=>{let[_]=E;return l.includes(_)===!1}));c.push([v.visualRow,v.visualCol,m])}})}),c};r.addHook("beforeRemoveRow",(n,s,o,a)=>{const l=()=>{const u=r.toPhysicalRow(n),c=u+s-1,h=deepClone(e.instance.getSourceData(u,0,u+s-1,e.instance.countSourceCols()-1));return new UndoRedo$1.RemoveRowAction(u,h,r.getSettings().fixedRowsBottom,r.getSettings().fixedRowsTop,r.rowIndexMapper.getIndexesSequence(),t(u,c,0,r.countCols()-1))};e.done(l,a)}),r.addHook("afterCreateCol",(n,s,o)=>{e.done(()=>new UndoRedo$1.CreateColumnAction(n,s),o)}),r.addHook("beforeRemoveCol",(n,s,o,a)=>{const l=()=>{const u=e.instance.getSourceDataArray(),c=(e.instance.countCols()+n)%e.instance.countCols(),h=c+s-1,g=[],v=[],m=[];rangeEach(u.length-1,S=>{const w=[],A=u[S];rangeEach(c,h,O=>{w.push(A[r.toPhysicalColumn(O)])}),g.push(w)}),rangeEach(s-1,S=>{m.push(r.toPhysicalColumn(c+S))}),Array.isArray(r.getSettings().colHeaders)&&rangeEach(s-1,S=>{v.push(r.getSettings().colHeaders[r.toPhysicalColumn(c+S)]||null)});const E=r.columnIndexMapper.getIndexesSequence(),_=r.rowIndexMapper.getIndexesSequence();return new UndoRedo$1.RemoveColumnAction(c,m,g,v,E,_,r.getSettings().fixedColumnsStart,t(0,r.countRows(),c,h))};e.done(l,a)}),r.addHook("beforeCellAlignment",(n,s,o,a)=>{e.done(()=>new UndoRedo$1.CellAlignmentAction(n,s,o,a))}),r.addHook("beforeFilter",(n,s)=>{e.done(()=>new UndoRedo$1.FiltersAction(n,s))}),r.addHook("beforeRowMove",(n,s)=>{n!==!1&&e.done(()=>new UndoRedo$1.RowMoveAction(n,s))}),r.addHook("beforeColumnMove",(n,s)=>{n!==!1&&e.done(()=>new UndoRedo$1.ColumnMoveAction(n,s))}),r.addHook("beforeMergeCells",(n,s)=>{s||e.done(()=>new UndoRedo$1.MergeCellsAction(r,n))}),r.addHook("afterUnmergeCells",(n,s)=>{s||e.done(()=>new UndoRedo$1.UnmergeCellsAction(r,n))}),r.addHook("beforeColumnSort",(n,s,o)=>{o&&e.done(()=>new UndoRedo$1.ColumnSortAction(n,s))}),r.addHook("afterInit",()=>{e.init()})}UndoRedo$1.prototype.done=function(r,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const o=r(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())};UndoRedo$1.prototype.undo=function(){if(this.isUndoAvailable()){const r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice());const t=deepClone(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};UndoRedo$1.prototype.redo=function(){if(this.isRedoAvailable()){const r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice());const t=deepClone(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};UndoRedo$1.prototype.isUndoAvailable=function(){return this.doneActions.length>0};UndoRedo$1.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};UndoRedo$1.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};UndoRedo$1.prototype.isEnabled=function(){return this.enabled};UndoRedo$1.prototype.enable=function(){if(this.isEnabled())return;const r=this.instance;this.enabled=!0,exposeUndoRedoMethods(r),this.registerShortcuts(),r.addHook("afterChange",onAfterChange)};UndoRedo$1.prototype.disable=function(){if(!this.isEnabled())return;const r=this.instance;this.enabled=!1,removeExposedUndoRedoMethods(r),this.unregisterShortcuts(),r.removeHook("afterChange",onAfterChange)};UndoRedo$1.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};UndoRedo$1.Action=function(){};UndoRedo$1.Action.prototype.undo=function(){};UndoRedo$1.Action.prototype.redo=function(){};UndoRedo$1.ChangeAction=function(r,e){this.changes=r,this.selected=e,this.actionType="change"};inherit(UndoRedo$1.ChangeAction,UndoRedo$1.Action);UndoRedo$1.ChangeAction.prototype.undo=function(r,e){const t=deepClone(this.changes),n=r.countEmptyRows(!0),s=r.countEmptyCols(!0);for(let a=0,l=t.length;a<l;a++)t[a].splice(3,1);r.addHookOnce("afterChange",e),r.setDataAtCell(t,null,null,"UndoRedo.undo");for(let a=0,l=t.length;a<l;a++){const[u,c]=t[a];r.getSettings().minSpareRows&&u+1+r.getSettings().minSpareRows===r.countRows()&&n===r.getSettings().minSpareRows&&(r.alter("remove_row",parseInt(u+1,10),r.getSettings().minSpareRows),r.undoRedo.doneActions.pop()),r.getSettings().minSpareCols&&c+1+r.getSettings().minSpareCols===r.countCols()&&s===r.getSettings().minSpareCols&&(r.alter("remove_col",parseInt(c+1,10),r.getSettings().minSpareCols),r.undoRedo.doneActions.pop())}const o=r.getSelectedLast();if(o!==void 0){const[a,l]=t[0],[u,c]=o,h=r.getFirstFullyVisibleRow(),g=r.getFirstFullyVisibleColumn(),v=a>=h,m=l>=g;if((v&&m)===!1&&(u!==a||c!==l)===!0){const S={row:a,col:l};v===!1&&(S.verticalSnap="top"),m===!1&&(S.horizontalSnap="start"),r.scrollViewportTo(S)}}r.selectCells(this.selected,!1,!1)};UndoRedo$1.ChangeAction.prototype.redo=function(r,e){const t=deepClone(this.changes);for(let n=0,s=t.length;n<s;n++)t[n].splice(2,1);r.addHookOnce("afterChange",e),r.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&r.selectCells(this.selected,!1,!1)};UndoRedo$1.CreateRowAction=function(r,e){this.index=r,this.amount=e,this.actionType="insert_row"};inherit(UndoRedo$1.CreateRowAction,UndoRedo$1.Action);UndoRedo$1.CreateRowAction.prototype.undo=function(r,e){const t=r.countRows(),n=r.getSettings().minSpareRows;this.index>=t&&this.index-n<t&&(this.index-=n),r.addHookOnce("afterRemoveRow",e),r.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};UndoRedo$1.CreateRowAction.prototype.redo=function(r,e){r.addHookOnce("afterCreateRow",e),r.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.RemoveRowAction=function(r,e,t,n,s,o){this.index=r,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=n,this.rowIndexesSequence=s,this.removedCellMetas=o};inherit(UndoRedo$1.RemoveRowAction,UndoRedo$1.Action);UndoRedo$1.RemoveRowAction.prototype.undo=function(r,e){const t=r.getSettings(),n=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);n.push([this.index+o,isNaN(l)?a:l,s[a]])})}),r.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;r.setCellMetaObject(o,a,l)}),r.addHookOnce("afterViewRender",e),r.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),r.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};UndoRedo$1.RemoveRowAction.prototype.redo=function(r,e){r.addHookOnce("afterRemoveRow",e),r.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};UndoRedo$1.CreateColumnAction=function(r,e){this.index=r,this.amount=e,this.actionType="insert_col"};inherit(UndoRedo$1.CreateColumnAction,UndoRedo$1.Action);UndoRedo$1.CreateColumnAction.prototype.undo=function(r,e){r.addHookOnce("afterRemoveCol",e),r.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};UndoRedo$1.CreateColumnAction.prototype.redo=function(r,e){r.addHookOnce("afterCreateCol",e),r.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.RemoveColumnAction=function(r,e,t,n,s,o,a,l){this.index=r,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=n,this.columnPositions=s.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a,this.removedCellMetas=l};inherit(UndoRedo$1.RemoveColumnAction,UndoRedo$1.Action);UndoRedo$1.RemoveColumnAction.prototype.undo=function(r,e){const t=r.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),s=(c,h,g)=>g[this.indexes.indexOf(n[h])],o=this.data.length,a=[];for(let c=0;c<o;c++)a.push(arrayMap(this.data[c],s));const l=arrayMap(this.headers,s),u=[];r.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach(r.getSourceDataArray(),(c,h)=>{arrayEach(n,(g,v)=>{c[g]=a[h][v],u.push([h,g,c[g]])})}),r.setSourceDataAtCell(u,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&arrayEach(l,(c,h)=>{r.getSettings().colHeaders[n[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,g,v]=c;r.setCellMetaObject(h,g,v)}),r.batchExecution(()=>{r.rowIndexMapper.setIndexesSequence(this.rowPositions),r.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.RemoveColumnAction.prototype.redo=function(r,e){r.addHookOnce("afterRemoveCol",e),r.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};UndoRedo$1.CellAlignmentAction=function(r,e,t,n){this.stateBefore=r,this.range=e,this.type=t,this.alignment=n};UndoRedo$1.CellAlignmentAction.prototype.undo=function(r,e){arrayEach(this.range,t=>{t.forAll((n,s)=>{n>=0&&s>=0&&r.setCellMeta(n,s,"className",this.stateBefore[n][s]||" htLeft")})}),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.CellAlignmentAction.prototype.redo=function(r,e){align(this.range,this.type,this.alignment,(t,n)=>r.getCellMeta(t,n),(t,n,s,o)=>r.setCellMeta(t,n,s,o)),r.addHookOnce("afterViewRender",e),r.render()};UndoRedo$1.FiltersAction=function(r,e){this.previousConditionsStack=e,this.conditionsStack=r,this.actionType="filter"};inherit(UndoRedo$1.FiltersAction,UndoRedo$1.Action);UndoRedo$1.FiltersAction.prototype.undo=function(r,e){const t=r.getPlugin("filters");r.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};UndoRedo$1.FiltersAction.prototype.redo=function(r,e){const t=r.getPlugin("filters");r.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class MergeCellsAction extends UndoRedo$1.Action{constructor(e,t){super(),this.cellRange=t;const n=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,s.row,s.col)}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}UndoRedo$1.MergeCellsAction=MergeCellsAction;class UnmergeCellsAction extends UndoRedo$1.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}UndoRedo$1.UnmergeCellsAction=UnmergeCellsAction;UndoRedo$1.RowMoveAction=function(r,e){this.rows=r.slice(),this.finalRowIndex=e,this.actionType="row_move"};inherit(UndoRedo$1.RowMoveAction,UndoRedo$1.Action);UndoRedo$1.RowMoveAction.prototype.undo=function(r,e){const t=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",e),getMoves(this.rows,this.finalRowIndex,r.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),t.moveRow(a,o)}),r.render(),r.deselectCell(),r.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};UndoRedo$1.RowMoveAction.prototype.redo=function(r,e){const t=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),r.render(),r.deselectCell(),r.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};UndoRedo$1.ColumnMoveAction=function(r,e){this.columns=r.slice(),this.finalColumnIndex=e,this.actionType="col_move"};inherit(UndoRedo$1.ColumnMoveAction,UndoRedo$1.Action);UndoRedo$1.ColumnMoveAction.prototype.undo=function(r,e){const t=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",e),getMoves(this.columns,this.finalColumnIndex,r.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),t.moveColumn(a,o)}),r.render(),r.deselectCell(),r.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};UndoRedo$1.ColumnMoveAction.prototype.redo=function(r,e){const t=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),r.render(),r.deselectCell(),r.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};UndoRedo$1.ColumnSortAction=function(r,e){this.previousSortState=r,this.nextSortState=e};inherit(UndoRedo$1.ColumnSortAction,UndoRedo$1.Action);UndoRedo$1.ColumnSortAction.prototype.undo=function(r,e){const t=r.getPlugin("columnSorting"),n=r.getPlugin("multiColumnSorting"),s=n.isEnabled()?n:t;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),e()};UndoRedo$1.ColumnSortAction.prototype.redo=function(r,e){const t=r.getPlugin("columnSorting"),n=r.getPlugin("multiColumnSorting");(n.isEnabled()?n:t).sort(this.nextSortState),e()};UndoRedo$1.prototype.init=function(){const r=this.instance.getSettings().undo,e=typeof r>"u"||r;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};UndoRedo$1.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:s=>!s.altKey,group:SHORTCUTS_GROUP};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};UndoRedo$1.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP)};function onAfterChange(r,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function exposeUndoRedoMethods(r){r.undo=function(){return r.undoRedo.undo()},r.redo=function(){return r.undoRedo.redo()},r.isUndoAvailable=function(){return r.undoRedo.isUndoAvailable()},r.isRedoAvailable=function(){return r.undoRedo.isRedoAvailable()},r.clearUndo=function(){return r.undoRedo.clear()}}function removeExposedUndoRedoMethods(r){delete r.undo,delete r.redo,delete r.isUndoAvailable,delete r.isRedoAvailable,delete r.clearUndo}const hook=Hooks.getSingleton();hook.add("afterUpdateSettings",function(){var r;(r=this.getPlugin("undoRedo"))===null||r===void 0||r.init()});hook.register("beforeUndo");hook.register("afterUndo");hook.register("beforeRedo");hook.register("afterRedo");UndoRedo$1.PLUGIN_KEY=PLUGIN_KEY;UndoRedo$1.SETTING_KEYS=!0;function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(StretchColumns),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(UndoRedo$1)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs$2(reactDomExports);var web_immediate={},web_clearImmediate={},validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var r=TypeError;return validateArgumentsLength=function(e,t){if(e<t)throw new r("Not enough arguments");return e},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var r=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(r),environmentIsIos}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var r=requireGlobalThis(),e=requireEnvironmentUserAgent(),t=requireClassofRaw(),n=function(s){return e.slice(0,s.length)===s};return environment=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":r.Bun&&typeof Bun.version=="string"?"BUN":r.Deno&&typeof Deno.version=="object"?"DENO":t(r.process)==="process"?"NODE":r.window&&r.document?"BROWSER":"REST"}(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var r=requireEnvironment();return environmentIsNode=r==="NODE",environmentIsNode}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var r=requireGlobalThis(),e=requireFunctionApply(),t=requireFunctionBindContext(),n=requireIsCallable(),s=requireHasOwnProperty(),o=requireFails(),a=requireHtml(),l=requireArraySlice(),u=requireDocumentCreateElement(),c=requireValidateArgumentsLength(),h=requireEnvironmentIsIos(),g=requireEnvironmentIsNode(),v=r.setImmediate,m=r.clearImmediate,E=r.process,_=r.Dispatch,S=r.Function,w=r.MessageChannel,A=r.String,O=0,D={},Y="onreadystatechange",H,k,K,se;o(function(){H=r.location});var re=function(ve){if(s(D,ve)){var xe=D[ve];delete D[ve],xe()}},Ce=function(ve){return function(){re(ve)}},Le=function(ve){re(ve.data)},he=function(ve){r.postMessage(A(ve),H.protocol+"//"+H.host)};return(!v||!m)&&(v=function(xe){c(arguments.length,1);var Ie=n(xe)?xe:S(xe),we=l(arguments,1);return D[++O]=function(){e(Ie,void 0,we)},k(O),O},m=function(xe){delete D[xe]},g?k=function(ve){E.nextTick(Ce(ve))}:_&&_.now?k=function(ve){_.now(Ce(ve))}:w&&!h?(K=new w,se=K.port2,K.port1.onmessage=Le,k=t(se.postMessage,se)):r.addEventListener&&n(r.postMessage)&&!r.importScripts&&H&&H.protocol!=="file:"&&!o(he)?(k=he,r.addEventListener("message",Le,!1)):Y in u("script")?k=function(ve){a.appendChild(u("script"))[Y]=function(){a.removeChild(this),re(ve)}}:k=function(ve){setTimeout(Ce(ve),0)}),task={set:v,clear:m},task}var hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var r=require_export(),e=requireGlobalThis(),t=requireTask().clear;return r({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==t},{clearImmediate:t}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var r=requireGlobalThis(),e=requireFunctionApply(),t=requireIsCallable(),n=requireEnvironment(),s=requireEnvironmentUserAgent(),o=requireArraySlice(),a=requireValidateArgumentsLength(),l=r.Function,u=/MSIE .\./.test(s)||n==="BUN"&&function(){var c=r.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")}();return schedulersFix=function(c,h){var g=h?2:1;return u?function(v,m){var E=a(arguments.length,1)>g,_=t(v)?v:l(v),S=E?o(arguments,g):[],w=E?function(){e(_,this,S)}:_;return h?c(w,m):c(w)}:c},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var r=require_export(),e=requireGlobalThis(),t=requireTask().set,n=requireSchedulersFix(),s=e.setImmediate?n(t,!1):t;return r({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==s},{setImmediate:s}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}requireWeb_immediate();function _classPrivateMethodInitSpec$2(r,e){_checkPrivateRedeclaration$3(r,e),e.add(r)}function _checkPrivateRedeclaration$3(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$a(r,e,t){return(e=_toPropertyKey$b(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$b(r){var e=_toPrimitive$b(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$b(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _assertClassBrand$3(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet;class EditorManager{constructor(e,t,n){_classPrivateMethodInitSpec$2(this,_EditorManager_brand),_defineProperty$a(this,"hot",void 0),_defineProperty$a(this,"tableMeta",void 0),_defineProperty$a(this,"selection",void 0),_defineProperty$a(this,"eventManager",void 0),_defineProperty$a(this,"destroyed",!1),_defineProperty$a(this,"activeEditor",void 0),_defineProperty$a(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new EventManager(e),this.hot.addHook("afterDocumentKeyDown",s=>_assertClassBrand$3(_EditorManager_brand,this,_onAfterDocumentKeyDown).call(this,s)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",s)}),this.hot.view._wt.update("onCellDblClick",(s,o,a)=>_assertClassBrand$3(_EditorManager_brand,this,_onCellDblClick).call(this,s,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:s}=t,o=this.hot.runHooks("modifyGetCellCoords",n,s,!1,"meta");let a=n,l=s;if(Array.isArray(o)&&([a,l]=o),this.cellProperties=this.hot.getCellMeta(a,l),!this.isCellEditable()){this.clearActiveEditor();return}const u=this.hot.getCell(n,s,!0);if(u){const c=this.hot.getCellEditor(this.cellProperties),h=this.hot.colToProp(l),g=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),l);this.activeEditor=_getEditorInstance(c,this.hot),this.activeEditor.prepare(n,s,h,u,g,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const s=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",s.highlight.row,s.highlight.col,e,t,n);if(t instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&s.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:s}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,l=o.isHidden(this.hot.toPhysicalRow(n))||a.isHidden(this.hot.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!t||l)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function _onAfterDocumentKeyDown(r){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||isImmediatePropagationStopped(r))return;const{keyCode:t}=r,n=(r.ctrlKey||r.metaKey)&&!r.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(t)&&!isCtrlMetaKey(t)&&!n&&!this.isEditorOpened()&&this.openEditor("",r)}function _onCellDblClick(r,e){e.isCell()&&this.openEditor(null,r,!0)}const instances=new WeakMap;EditorManager.getInstance=function(r,e,t){let n=instances.get(r);return n||(n=new EditorManager(r,e,t),instances.set(r,n)),n};function _classPrivateMethodInitSpec$1(r,e){_checkPrivateRedeclaration$2(r,e),e.add(r)}function _classPrivateFieldInitSpec$2(r,e,t){_checkPrivateRedeclaration$2(r,e),e.set(r,t)}function _checkPrivateRedeclaration$2(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$2(r,e){return r.get(_assertClassBrand$2(r,e))}function _classPrivateFieldSet$1(r,e,t){return r.set(_assertClassBrand$2(r,e),t),t}function _assertClassBrand$2(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet;class FocusManager{constructor(e){var t=this;_classPrivateMethodInitSpec$1(this,_FocusManager_brand),_classPrivateFieldInitSpec$2(this,_hot,void 0),_classPrivateFieldInitSpec$2(this,_focusMode,void 0),_classPrivateFieldInitSpec$2(this,_refocusDelay,1),_classPrivateFieldInitSpec$2(this,_refocusElementGetter,null),_classPrivateFieldInitSpec$2(this,_debouncedSelect,new Map);const n=e.getSettings();_classPrivateFieldSet$1(_hot,this,e),_classPrivateFieldSet$1(_focusMode,this,n.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet$2(_hot,this).addHook("afterUpdateSettings",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_onUpdateSettings).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelectionFocusSet",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$2(_hot,this).addHook("afterSelectionEnd",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return _assertClassBrand$2(_FocusManager_brand,t,_focusEditorElement).call(t,...o)})}getFocusMode(){return _classPrivateFieldGet$2(_focusMode,this)}setFocusMode(e){Object.values(FOCUS_MODES).includes(e)?_classPrivateFieldSet$1(_focusMode,this,e):warn$1(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet$2(_refocusDelay,this)}setRefocusDelay(e){_classPrivateFieldSet$1(_refocusDelay,this,e)}setRefocusElementGetter(e){_classPrivateFieldSet$1(_refocusElementGetter,this,e)}getRefocusElement(){var e;return typeof _classPrivateFieldGet$2(_refocusElementGetter,this)=="function"?_classPrivateFieldGet$2(_refocusElementGetter,this).call(this):(e=_classPrivateFieldGet$2(_hot,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=n=>{var s,o;const a=(s=_classPrivateFieldGet$2(_hot,this).getSelectedRangeLast())===null||s===void 0?void 0:s.highlight;if(!a)return;let l=_classPrivateFieldGet$2(_hot,this).runHooks("modifyFocusedElement",a.row,a.col,n);l instanceof HTMLElement||(l=n),l&&!((o=_classPrivateFieldGet$2(_hot,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&l.focus({preventScroll:!0})};e?t(e):_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,n=>t(n))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet$2(_refocusDelay,this);_classPrivateFieldGet$2(_hot,this).getSettings().imeFastEdit&&!((e=_classPrivateFieldGet$2(_hot,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(_classPrivateFieldGet$2(_debouncedSelect,this).has(t)||_classPrivateFieldGet$2(_debouncedSelect,this).set(t,debounce(()=>{var n;(n=this.getRefocusElement())===null||n===void 0||n.select()},t)),_classPrivateFieldGet$2(_debouncedSelect,this).get(t)())}}function _getSelectedCell(r){var e;const t=(e=_classPrivateFieldGet$2(_hot,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!_classPrivateFieldGet$2(_hot,this).selection.isCellVisible(t)){r(null);return}const n=_classPrivateFieldGet$2(_hot,this).getCell(t.row,t.col,!0);n===null?_classPrivateFieldGet$2(_hot,this).addHookOnce("afterScroll",()=>{r(_classPrivateFieldGet$2(_hot,this).getCell(t.row,t.col,!0))}):r(n)}function _focusCell(){_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,r=>{const{activeElement:e}=_classPrivateFieldGet$2(_hot,this).rootDocument;e&&isOutsideInput(e)&&e.blur(),this.focusOnHighlightedCell(r)})}function _focusEditorElement(){_assertClassBrand$2(_FocusManager_brand,this,_getSelectedCell).call(this,r=>{this.getFocusMode()===FOCUS_MODES.MIXED&&r.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onUpdateSettings(r){typeof r.imeFastEdit=="boolean"&&this.setFocusMode(r.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(r){holder.set(r,!0)}function hasValidParameter(r){return r===rootInstanceSymbol}function isRootInstance(r){return holder.has(r)}function _classPrivateMethodInitSpec(r,e){_checkPrivateRedeclaration$1(r,e),e.add(r)}function _classPrivateFieldInitSpec$1(r,e,t){_checkPrivateRedeclaration$1(r,e),e.set(r,t)}function _checkPrivateRedeclaration$1(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$9(r,e,t){return(e=_toPropertyKey$a(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$a(r){var e=_toPrimitive$a(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$a(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet$1(r,e){return r.get(_assertClassBrand$1(r,e))}function _classPrivateFieldSet(r,e,t){return r.set(_assertClassBrand$1(r,e),t),t}function _assertClassBrand$1(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_TableView_brand=new WeakSet;class TableView{constructor(e){_classPrivateMethodInitSpec(this,_TableView_brand),_defineProperty$9(this,"hot",void 0),_defineProperty$9(this,"eventManager",void 0),_defineProperty$9(this,"settings",void 0),_defineProperty$9(this,"THEAD",void 0),_defineProperty$9(this,"TBODY",void 0),_defineProperty$9(this,"_wt",void 0),_defineProperty$9(this,"activeWt",void 0),_classPrivateFieldInitSpec$1(this,_columnHeadersCount,0),_classPrivateFieldInitSpec$1(this,_rowHeadersCount,0),_defineProperty$9(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec$1(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec$1(this,_mouseDown,void 0),_classPrivateFieldInitSpec$1(this,_table,void 0),_classPrivateFieldInitSpec$1(this,_lastWidth,0),_classPrivateFieldInitSpec$1(this,_lastHeight,0),this.hot=e,this.eventManager=new EventManager(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),_assertClassBrand$1(_TableView_brand,this,_updateScrollbarClassNames).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),addClass$1(e,"handsontable"),_classPrivateFieldSet(_table,this,t.createElement("TABLE")),addClass$1(_classPrivateFieldGet$1(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass$1(_classPrivateFieldGet$1(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet$1(_table,this),[A11Y_PRESENTATION()]),setAttribute(e,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=t.createElement("THEAD"),_classPrivateFieldGet$1(_table,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),_classPrivateFieldGet$1(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet$1(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet$1(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:s}=this.hot,o=t.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{_classPrivateFieldSet(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(l.target)||(clearTextSelection(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_classPrivateFieldSet(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{_classPrivateFieldGet$1(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&clearTextSelection(s),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{n.isInProgress()&&!l.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{n.isInProgress()&&isLeftClick(l)&&n.finish(),_classPrivateFieldSet(_mouseDown,this,!1);const u=isOutsideInput(t.activeElement);isInput(t.activeElement)&&!u||(u||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(l.target)&&!isRightClick(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{n.isInProgress()&&isRightClick(l)&&(n.finish(),_classPrivateFieldSet(_mouseDown,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),_classPrivateFieldSet(_mouseDown,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let g=l.target;if(_classPrivateFieldGet$1(_mouseDown,this)||!e||!this.hot.view)return;const{holder:v}=this._wt.wtTable;if(g===v){const E=getScrollbarWidth(t);if(t.elementFromPoint(c+E,h)!==v||t.elementFromPoint(c,h+E)!==v)return}else for(;g!==o;){if(g===null){if(l.isTargetWebComponent)break;return}if(g===e)return;g=g.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=getParentWindow(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=getParentWindow(a);this.eventManager.addEventListener(_classPrivateFieldGet$1(_table,this),"selectstart",l=>{this.settings.fragmentSelection||isInput(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return n===null&&(n=e),s===null&&(s=t),[n,s]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),s=e.getNearestNotHiddenIndex(n-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,s){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,t),a=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let l=0;return t<0?l=a+1:t>0&&(l=s-a),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const n=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");n&&addClass$1(n,e)}removeClassNameFromLicenseElement(e){var t;const n=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");n&&removeClass$1(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet$1(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,l)=>{const u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),_classPrivateFieldSet(_rowHeadersCount,this,o.length),this.hot.getSettings().ariaTags&&_assertClassBrand$1(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand$1(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet$1(_rowHeadersCount,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,l)=>{const u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),_classPrivateFieldSet(_columnHeadersCount,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const l=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),u=l===null?o:l;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(o,a,l)=>{const[u,c]=this.translateFromRenderableToVisualIndex(o,a),h=this.hot.runHooks("modifyGetCellCoords",u,c,!1,"meta");let g=u,v=c;Array.isArray(h)&&([g,v]=h);const m=this.hot.getCellMeta(g,v),E=this.hot.colToProp(v);let _=this.hot.getDataAtRowProp(g,E);this.hot.hasHook("beforeValueRender")&&(_=this.hot.runHooks("beforeValueRender",_,m)),this.hot.runHooks("beforeRenderer",l,u,c,E,_,m),this.hot.getCellRenderer(m)(this.hot,l,u,c,E,_,m),this.hot.runHooks("afterRenderer",l,u,c,E,_,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,_classPrivateFieldSet(_mouseDown,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,c,l,h),!isImmediatePropagationStopped(o)&&(handleMouseEvent(o,{coords:c,selection:this.hot.selection,controller:h,cellCoordsFactory:(g,v)=>this.hot._createCellCoords(g,v)}),this.hot.runHooks("afterOnCellMouseDown",o,c,l),this.activeWt=this._wt)},onCellContextMenu:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,_classPrivateFieldSet(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,c,l),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,c,l),this.activeWt=this._wt)},onCellMouseOut:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",o,c,l),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,c,l),this.activeWt=this._wt)},onCellMouseOver:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",o,c,l,h),!isImmediatePropagationStopped(o)&&(_classPrivateFieldGet$1(_mouseDown,this)&&handleMouseEvent(o,{coords:c,selection:this.hot.selection,controller:h,cellCoordsFactory:(g,v)=>this.hot._createCellCoords(g,v)}),this.hot.runHooks("afterOnCellMouseOver",o,c,l),this.activeWt=this._wt)},onCellMouseUp:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",o,c,l),!(isImmediatePropagationStopped(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,c,l),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;return!u&&(c=l.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollVertically",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:l.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(o,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;return!u&&(c=l.getVisualFromRenderableIndex(o),c===null)?o:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:l.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,l)=>{const u=this.hot.rowIndexMapper,c=o<0;let h=o;c||(h=u.getVisualFromRenderableIndex(o));const g=this.hot.runHooks("beforeHighlightingRowHeader",h,a,l);return c?g:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:(o,a,l)=>{const u=this.hot.columnIndexMapper,c=o<0;let h=o;c||(h=u.getVisualFromRenderableIndex(o));const g=this.hot.runHooks("beforeHighlightingColumnHeader",h,a,l);return c?g:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:(o,a,l)=>{let u;const[c,h]=this.translateFromRenderableToVisualIndex(o,a),g=this.hot.selection.getSelectedRange();if(g.size()>0){const m=g.peekByIndex(l??0);u=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",c,h,u,l)},onBeforeDrawBorders:(o,a)=>{const[l,u,c,h]=o,g=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.hot.runHooks("beforeDrawBorders",g,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,l,u)=>{const c=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,g=a>=0?h.getVisualFromRenderableIndex(a):a,v=o>=0?c.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCellCoords",v,g,l,u);if(Array.isArray(m)){const[E,_,S,w]=m;return[E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,1)):E,_>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(_,1)):_,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S,w>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(w,-1)):w]}},onModifyGetCoordsElement:(o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=a>=0?u.getVisualFromRenderableIndex(a):a,h=o>=0?l.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCoordsElement",h,c);if(Array.isArray(g)){const[v,m]=g;return[v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,1)):v,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),u=o.startRow,c=o.endRow;if(typeof a=="number")o.startRow=Math.max(u-a,0),o.endRow=Math.min(c+a,l-1);else if(a==="auto"){const h=Math.max(1,Math.ceil(c/l*12));o.startRow=Math.max(u-h,0),o.endRow=Math.min(c+h,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),u=o.startColumn,c=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(u-a,0),o.endColumn=Math.min(c+a,l-1)),a==="auto"){const h=Math.max(1,Math.ceil(c/l*6));o.startColumn=Math.max(u-h,0),o.endColumn=Math.min(c+h,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WalkontableFacade(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:s}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,s),this.eventManager.addEventListener(t,"mousedown",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(isInput(e))return!0;const t=isChildOf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _classPrivateFieldGet$1(_mouseDown,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!hasClass$1(n,"relative")){empty$1(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:s}=this.hot,o=n.createElement("div"),a=n.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,s),o.appendChild(a),t.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(t.firstChild){const a=t.firstChild;hasClass$1(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,n,s),a.className="",addClass$1(a,["relative",...o()])):(empty$1(t),this.appendColHeader(e,t,n,s))}else{const{rootDocument:a}=this.hot,l=a.createElement("div"),u=a.createElement("span"),c=o();l.classList.add("relative",...c),u.className="colHeader",this.settings.ariaTags&&(setAttribute(l,...A11Y_PRESENTATION()),setAttribute(u,...A11Y_PRESENTATION())),this.updateCellHeader(u,e,n,s),l.appendChild(u),t.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,t,s)}updateCellHeader(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=t;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(hasClass$1(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(t):hasClass$1(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(t))),o>-1?fastInnerHTML(e,n(t,s)):(fastInnerText(e,""),addClass$1(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,t){_classPrivateFieldSet(_lastWidth,this,e),_classPrivateFieldSet(_lastHeight,this,t)}getLastSize(){return{width:_classPrivateFieldGet$1(_lastWidth,this),height:_classPrivateFieldGet$1(_lastHeight,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(t??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(t??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet$1(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet$1(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(r){const e=_assertClassBrand$1(_TableView_brand,this,_getAriaColcount).call(this)+r;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(e))}function _updateScrollbarClassNames(){const r=this.hot.rootElement;this.hasVerticalScroll()?addClass$1(r,"htHasScrollY"):removeClass$1(r,"htHasScrollY"),this.hasHorizontalScroll()?addClass$1(r,"htHasScrollX"):removeClass$1(r,"htHasScrollX")}function _defineProperty$8(r,e,t){return(e=_toPropertyKey$9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$9(r){var e=_toPrimitive$9(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataSource{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty$8(this,"hot",void 0),_defineProperty$8(this,"data",void 0),_defineProperty$8(this,"dataType","array"),_defineProperty$8(this,"colToProp",()=>{}),_defineProperty$8(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return arrayEach(this.data,(n,s)=>{const o=this.getAtCell(s,e);t.push(o)}),t}getAtRow(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=t===void 0&&n===void 0,{dataDotNotation:a}=this.hot.getSettings();let l=null,u=null;if(l=this.modifyRowData(e),Array.isArray(l))u=[],o?l.forEach((c,h)=>{u[h]=this.getAtPhysicalCell(e,h,l)}):rangeEach(t,n,c=>{u[c-t]=this.getAtPhysicalCell(e,c,l)});else if(isObject$1(l)||isFunction$1(l))if(s?u=[]:u={},!o||s){const h=this.countFirstRowKeys()-1;rangeEach(0,h,g=>{const v=this.colToProp(g);if(g>=(t||0)&&g<=(n||h)&&!Number.isInteger(v)){const m=this.getAtPhysicalCell(e,v,l);s?u.push(m):a?setProperty(u,v,m):u[v]=m}})}else objectEach(l,(c,h)=>{const g=this.getAtPhysicalCell(e,h,l);a?setProperty(u,h,g):u[h]=g});return u}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=createObjectPropListener(n);this.hot.runHooks("modifySourceData",e,t,s,"set"),s.isTouched()&&(n=s.value)}Number.isInteger(t)?this.data[e][t]=n:setProperty(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let s=null;if(n)if(typeof t=="string"){const{dataDotNotation:o}=this.hot.getSettings();s=o?getProperty(n,t):n[t]}else typeof t=="function"?s=t(n):s=n[t];if(this.hot.hasHook("modifySourceData")){const o=createObjectPropListener(s);this.hot.runHooks("modifySourceData",e,t,o,"get"),o.isTouched()&&(s=o.value)}return s}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=null,a=null,l=null,u=null;e===null||t===null?(s=!0,o=0,l=this.countRows()-1):(o=Math.min(e.row,t.row),a=Math.min(e.col,t.col),l=Math.max(e.row,t.row),u=Math.max(e.col,t.col));const c=[];return rangeEach(o,l,h=>{c.push(s?this.getAtRow(h,void 0,void 0,n):this.getAtRow(h,a,u,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}}function extendNotExistingKeys(r,e){return objectEach(e,(t,n)=>{isUndefined$1(r[n])&&(r[n]=t)}),r}function normalizeLanguageCode(r){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(r);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:r}function warnUserAboutLanguageRegistration(r){isDefined(r)&&error(toSingleLine`Language with code "${r}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(r,e){return Array.isArray(r)&&Number.isInteger(e)?r[e]:r}const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register(r,e){registerGloballyPhraseFormatter(r,e)}function getAll(){return getGlobalPhraseFormatters()}register("pluralize",pluralize);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const dictionary$1={languageCode:"en-US",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked"},dictionaryKeys=_dictionaryKeys,DEFAULT_LANGUAGE_CODE=dictionary$1.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(dictionary$1);function registerLanguageDictionary(r,e){let t=r,n=e;return isObject$1(r)&&(n=r,t=n.languageCode),extendLanguageDictionary(t,n),registerGloballyLanguageDictionary(t,deepClone(n)),deepClone(n)}function extendLanguageDictionary(r,e){r!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(e,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(r){return hasLanguageDictionary(r)?deepClone(getGlobalLanguageDictionary(r)):null}function hasLanguageDictionary(r){return hasGlobalLanguageDictionary(r)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(r,e,t){const n=getLanguageDictionary(r);if(n===null)return null;const s=n[e];if(isUndefined$1(s))return null;const o=getFormattedPhrase(s,t);return Array.isArray(o)?o[0]:o}function getFormattedPhrase(r,e){let t=r;return arrayEach(getAll(),n=>{t=n(r,e)}),t}function getValidLanguageCode(r){let e=normalizeLanguageCode(r);return hasLanguageDictionary(e)||(e=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(r)),e}function _defineProperty$7(r,e,t){return(e=_toPropertyKey$8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$8(r){var e=_toPrimitive$8(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){_defineProperty$7(this,"hot",void 0),_defineProperty$7(this,"metaManager",void 0),_defineProperty$7(this,"tableMeta",void 0),_defineProperty$7(this,"dataSource",void 0),_defineProperty$7(this,"duckSchema",void 0),_defineProperty$7(this,"colToPropCache",void 0),_defineProperty$7(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let s=0,o=0,a=!1;if(typeof t=="function"){const l=deepObjectSize(e);s=l>0?l:this.countFirstRowKeys(),a=!0}else{const l=this.tableMeta.maxCols;s=Math.min(l,t.length)}for(n=0;n<s;n++){const l=a?t(n):t[n];if(isObject$1(l)){if(typeof l.data<"u"){const u=a?o:n;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(e,t,n){let s=t,o=n,a;return typeof s>"u"&&(s=0,o=""),typeof e=="object"&&!Array.isArray(e)&&objectEach(e,(l,u)=>{l===null?(a=o+u,this.colToPropCache.push(a),this.propToColCache.set(a,s),s+=1):s=this.recursiveDuckColumns(l,s,`${u}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&isDefined(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(isDefined(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let a=o,l=0,u=e;if((typeof u!="number"||u>=o)&&(u=o),u<this.hot.countRows()&&(a=this.hot.toPhysicalRow(u)),this.hot.runHooks("beforeCreateRow",u,t,n)===!1||a===null)return{delta:0};const h=this.tableMeta.maxRows,g=this.getSchema().length,v=[];for(;l<t&&o+l<h;){let E=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?E=deepClone(this.getSchema()):(E=[],rangeEach(g-1,()=>E.push(null))):this.hot.dataType==="function"?E=this.tableMeta.dataSchema(u+l):(E={},deepExtend(E,this.getSchema())),v.push(E),l+=1}this.hot.rowIndexMapper.insertIndexes(u,l),s==="below"&&(a=Math.min(a+1,o)),this.spliceData(a,0,v);const m=this.hot.toVisualRow(a);return this.hot.countSourceRows()===v.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):n!=="auto"&&this.metaManager.createRow(a,t)),this.hot.runHooks("afterCreateRow",m,l,n),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:a}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,a=this.tableMeta.maxCols,l=this.hot.countSourceCols();let u=e;if((typeof u!="number"||u>=l)&&(u=l),this.hot.runHooks("beforeCreateCol",u,t,n)===!1)return{delta:0};let h=l;u<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(u));const g=this.hot.countSourceRows();let v=this.hot.countCols(),m=0,E=h;s==="end"&&(E=Math.min(E+1,l));const _=E;for(;m<t&&v<a;){if(typeof u!="number"||u>=v)if(g>0)for(let w=0;w<g;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<g;w++)o[w].splice(E,0,null);m+=1,E+=1,v+=1}this.hot.columnIndexMapper.insertIndexes(u,m),m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(_,t));const S=this.hot.toVisualColumn(_);return this.hot.runHooks("afterCreateCol",S,m,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:_}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-t;const o=this.visualRowsToPhysical(s,t),a=this.hot.countSourceRows();if(s=(a+s)%a,this.hot.runHooks("beforeRemoveRow",s,o.length,o,n)===!1)return!1;const u=o.length;if(this.filterData(s,u,o),s<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const h=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&h===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((h,g)=>g-h).forEach(h=>{this.metaManager.removeRow(h,1)}),this.hot.runHooks("afterRemoveRow",s,u,o,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-t:e;s=(this.hot.countCols()+s)%this.hot.countCols();const o=this.visualColumnsToPhysical(s,t),a=o.slice(0).sort((g,v)=>v-g);if(this.hot.runHooks("beforeRemoveCol",s,t,o,n)===!1)return!1;let u=!0;const c=a.length,h=this.dataSource;for(let g=0;g<c;g++)u&&o[0]!==o[g]-g&&(u=!1);if(u)for(let g=0,v=this.hot.countSourceRows();g<v;g++)h[g].splice(o[0],t),g===0&&this.metaManager.removeColumn(o[0],t);else for(let g=0,v=this.hot.countSourceRows();g<v;g++)for(let m=0;m<c;m++)h[g].splice(a[m],1),g===0&&this.metaManager.removeColumn(a[m],1);return s<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",s,t,o,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const s=this.hot.getDataAtCol(e),o=s.slice(t,t+n),a=s.slice(t+n);for(var l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,a);let h=0;for(;h<n;)u.push(null),h+=1;return to2dArray(u),this.hot.populateFromArray(t,e,u,null,null,"spliceCol"),o}spliceRow(e,t,n){const s=this.hot.getSourceDataAtRow(e),o=s.slice(t,t+n),a=s.slice(t+n);for(var l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];extendArray(u,a);let h=0;for(;h<n;)u.push(null),h+=1;return this.hot.populateFromArray(e,t,[u],null,null,"spliceRow"),o}spliceData(e,t,n){if(this.hot.runHooks("beforeDataSplice",e,t,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(a=>this.dataSource.push(a))}}filterData(e,t,n){let s=this.hot.runHooks("filterData",e,t,n);Array.isArray(s)===!1&&(s=this.dataSource.filter((o,a)=>n.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,t){const n=this.hot.toPhysicalRow(e);let s=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);s=isNaN(o)?o:s;const{dataDotNotation:a}=this.hot.getSettings();let l=null;if(s&&s.hasOwnProperty&&hasOwnProperty(s,t))l=s[t];else if(a&&typeof t=="string"&&t.indexOf(".")>-1){let u=s;if(!u)return null;const c=t.split(".");for(let h=0,g=c.length;h<g;h++)if(u=u[c[h]],typeof u>"u")return null;l=u}else typeof t=="function"&&(l=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const u=createObjectPropListener(l);this.hot.runHooks("modifyData",n,this.propToCol(t),u,"get"),u.isTouched()&&(l=u.value)}return l}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const s=this.hot.toPhysicalRow(e);let o=n,a=this.dataSource[s];const l=this.hot.runHooks("modifyRowData",s);if(a=isNaN(l)?l:a,this.hot.hasHook("modifyData")){const c=createObjectPropListener(o);this.hot.runHooks("modifyData",s,this.propToCol(t),c,"set"),c.isTouched()&&(o=c.value)}const{dataDotNotation:u}=this.hot.getSettings();if(a&&a.hasOwnProperty&&hasOwnProperty(a,t))a[t]=o;else if(u&&typeof t=="string"&&t.indexOf(".")>-1){let c=a,h=0,g;const v=t.split(".");for(h=0,g=v.length-1;h<g;h++)typeof c[v[h]]>"u"&&(c[v[h]]={}),c=c[v[h]];c[v[h]]=o}else typeof t=="function"?t(this.dataSource.slice(s,s+1)[0],o):a[t]=o}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),s=[];let o=(n+e)%n,a=t,l;for(;o<n&&a;)l=this.hot.toPhysicalRow(o),s.push(l),a-=1,o+=1;return s}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),s=[];let o=(n+e)%n,a=t;for(;o<n&&a;){const l=this.hot.toPhysicalColumn(o);s.push(l),a-=1,o+=1}return s}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,DataMap.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const s=[];let o,a,l;const u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];const h=n===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,g=Math.min(Math.max(u-1,0),Math.max(e.row,t.row)),v=Math.min(Math.max(c-1,0),Math.max(e.col,t.col));for(o=Math.min(e.row,t.row);o<=g;o++){l=[];const m=o>=0?this.hot.toPhysicalRow(o):o;for(a=Math.min(e.col,t.col);a<=v&&m!==null;a++)l.push(h.call(this,o,this.colToProp(a)));m!==null&&s.push(l)}return s}getText(e,t){return stringify(this.getRange(e,t,DataMap.DESTINATION_RENDERER))}getCopyableText(e,t){return stringify(this.getRange(e,t,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}function canBeOverwritten(r,e){var t;return r==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(r))||!hasOwnProperty(e,r)}function extendByMetaType(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const n=typeof e.type=="string"?_getItem(e.type):e.type;if(r._automaticallyAssignedMetaProps&&objectEach(e,(o,a)=>void r._automaticallyAssignedMetaProps.delete(a)),!isObject$1(n))return;t===r&&!r._automaticallyAssignedMetaProps&&(r._automaticallyAssignedMetaProps=new Set);const s={};objectEach(n,(o,a)=>{if(canBeOverwritten(a,t)){var l;s[a]=o,(l=r._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),extend$1(r,s)}function columnFactory(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}inherit(t,r);for(let n=0;n<e.length;n++)t.prototype[e[n]]=void 0;return t}function isUnsignedNumber(r){return Number.isInteger(r)&&r>=0}function assert(r,e){if(!r())throw new Error(`Assertion failed: ${e}`)}function isNullish(r){return r==null}const metaSchemaFactory=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(r){let e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,r),isEmpty$1(n)===!1)return!1;return!0},isEmptyRow(r){let e,t,n,s;for(e=0,t=this.countCols();e<t;e++)if(n=this.getDataAtCell(r,e),isEmpty$1(n)===!1)return typeof n=="object"?(s=this.getCellMeta(r,e),isObjectEqual(this.getSchema()[s.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function _defineProperty$6(r,e,t){return(e=_toPropertyKey$7(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$7(r){var e=_toPrimitive$7(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$7(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function createTableMetaEmptyClass(){return class{}}class GlobalMeta{constructor(e){_defineProperty$6(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty$6(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend$1(this.meta,metaSchemaFactory()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;extend$1(this.meta,e),extendByMetaType(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function _defineProperty$5(r,e,t){return(e=_toPropertyKey$6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$6(r){var e=_toPrimitive$6(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class TableMeta{constructor(e){_defineProperty$5(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){extend$1(this.meta,e),extendByMetaType(this.meta,e,e)}}function _defineProperty$4(r,e,t){return(e=_toPropertyKey$5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$5(r){var e=_toPrimitive$5(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class LazyFactoryMap{constructor(e){_defineProperty$4(this,"valueFactory",void 0),_defineProperty$4(this,"data",[]),_defineProperty$4(this,"index",[]),_defineProperty$4(this,"holes",new Set),this.valueFactory=e}obtain(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],n===void 0&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=n,this.index[e]=s}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const n=[],s=this.data.length;for(let a=0;a<t;a++)n.push(s+a),this.data.push(void 0);const o=isNullish(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(isNullish(e)?this.index.length-t:e,t);for(let s=0;s<n.length;s++){const o=n[s];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return arrayFilter(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const s=this._getKeyByStorageIndex(n);s!==-1&&e.push([s,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function _defineProperty$3(r,e,t){return(e=_toPropertyKey$4(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$4(r){var e=_toPrimitive$4(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$4(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const COLUMNS_PROPS_CONFLICTS=["data","width"];class ColumnMeta{constructor(e){_defineProperty$3(this,"globalMeta",void 0),_defineProperty$3(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=e,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);extend$1(n,t),extendByMetaType(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}function _defineProperty$2(r,e,t){return(e=_toPropertyKey$3(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$3(r){var e=_toPrimitive$3(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$3(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CellMeta{constructor(e){_defineProperty$2(this,"columnMeta",void 0),_defineProperty$2(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const s=this.getMeta(e,t);extend$1(s,n),extendByMetaType(s,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);return n===void 0?s:s[n]}setMeta(e,t,n,s){var o;const a=this.metas.obtain(e).obtain(t);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),a[n]=s}removeMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);delete s[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)isDefined(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class MetaManager{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GlobalMeta(e),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),n.forEach(s=>new s(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:s,visualColumn:o}=n;const a=this.cellMeta.getMeta(e,t);return a.visualRow=s,a.visualCol=o,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,s){this.cellMeta.setMeta(e,t,n,s)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mixin(MetaManager,localHooks);function replaceData(r,e,t,n){const{hotInstance:s,dataMap:o,dataSource:a,internalSource:l,source:u,metaManager:c,firstRun:h}=n,g=toUpperCaseFirst(l),v=s.getSettings();Array.isArray(v.dataSchema)?s.dataType="array":isFunction$1(v.dataSchema)?s.dataType="function":s.dataType="object",o&&o.destroy(),r=s.runHooks(`before${g}`,r,h,u);const m=new DataMap(s,r,c);if(e(m),typeof r=="object"&&r!==null)r.push&&r.splice||(r=[r]);else if(r===null){const E=m.getSchema();r=[];let _,S=0,w=0;for(S=0,w=v.startRows;S<w;S++)if((s.dataType==="object"||s.dataType==="function")&&v.dataSchema)_=deepClone(E),r.push(_);else if(s.dataType==="array")_=deepClone(E[0]),r.push(_);else{_=[];for(let A=0,O=v.startCols;A<O;A++)_.push(null);r.push(_)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof r} given)`);Array.isArray(r[0])&&(s.dataType="array"),v.data=r,m.dataSource=r,a.data=r,a.dataType=s.dataType,a.colToProp=m.colToProp.bind(m),a.propToCol=m.propToCol.bind(m),a.countCachedColumns=m.countCachedColumns.bind(m),t(m),s.runHooks(`after${g}`,r,h,u),h||(s.runHooks("afterChange",null,l),s.render()),s.getSettings().ariaTags&&setAttribute(s.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(s.countCols()+(s.view?s.countRowHeaders():0))])}function _defineProperty$1(r,e,t){return(e=_toPropertyKey$2(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$2(r){var e=_toPrimitive$2(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$2(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class DynamicCellMetaMod{constructor(e){_defineProperty$1(this,"metaManager",void 0),_defineProperty$1(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Hooks.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:s}=e;if((t=this.metaSyncMemo.get(n))!==null&&t!==void 0&&t.has(s))return;const{visualRow:o,visualCol:a}=e,l=this.metaManager.hot,u=l.colToProp(a);e.prop=u,l.runHooks("beforeGetCellMeta",o,a,e);const c=hasOwnProperty(e,"type")?e.type:null;let h=isFunction$1(e.cells)?e.cells(n,s,u):null;if(c)if(h){var g;h.type=(g=h.type)!==null&&g!==void 0?g:c}else h={type:c};h&&this.metaManager.updateCellMeta(n,s,h),l.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(s)}}function _classPrivateFieldInitSpec(r,e,t){_checkPrivateRedeclaration(r,e),e.set(r,t)}function _checkPrivateRedeclaration(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty(r,e,t){return(e=_toPropertyKey$1(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey$1(r){var e=_toPrimitive$1(r,"string");return typeof e=="symbol"?e:e+""}function _toPrimitive$1(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _classPrivateFieldGet(r,e){return r.get(_assertClassBrand(r,e))}function _assertClassBrand(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap;class ExtendMetaPropertiesMod{constructor(e){_defineProperty(this,"metaManager",void 0),_defineProperty(this,"usageTracker",new Set),_defineProperty(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec(this,_initOnlyCallback,(t,n,s)=>{if(!s)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:n,target:s,onChange:o}=e,a=typeof s=="string",l=a?s:t,u=`_${l}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[l],o?(this.installPropWatcher(t,u,o),a&&this.installPropWatcher(s,u,o)):n&&(this.installPropWatcher(t,u,_classPrivateFieldGet(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,n){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const a=!s.usageTracker.has(e);s.usageTracker.add(e),n.call(s,e,o,a),this[t]=o},enumerable:!0,configurable:!0})}}function installFocusDetector(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=r.rootElement,n=createInputElement(r),s=createInputElement(r);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(n),t.lastChild.after(s),{activate(){r._registerTimeout(()=>{n.tabIndex=0,s.tabIndex=0},10)},deactivate(){r._registerTimeout(()=>{n.tabIndex=-1,s.tabIndex=-1},10)}}}function createInputElement(r){const t=r.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),r.getSettings().ariaTags&&setAttribute(t,[A11Y_PRESENTATION(),A11Y_HIDDEN()]),t}function installFocusCatcher(r){const e=normalizeCoordsIfNeeded(r);let t;const{activate:n,deactivate:s}=installFocusDetector(r,{onFocusFromTop(){var g;const v=(g=e(t))!==null&&g!==void 0?g:getMostTopStartPosition(r);v&&(r.runHooks("modifyFocusOnTabNavigation","from_above",v),r.selectCell(v.row,v.col)),r.listen()},onFocusFromBottom(){var g;const v=(g=e(t))!==null&&g!==void 0?g:getMostBottomEndPosition(r);v&&(r.runHooks("modifyFocusOnTabNavigation","from_below",v),r.selectCell(v.row,v.col)),r.listen()}}),o={wrapped:!1,flipped:!1};let a=!0,l=!1,u=!1;r.addHook("afterListen",()=>s()),r.addHook("afterUnlisten",()=>n()),r.addHook("afterSelection",(g,v,m,E,_)=>{if(l&&(o.wrapped&&o.flipped||u)&&(u=!1,_.value=!0),a){var S;t=(S=r.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),r.addHook("beforeRowWrap",(g,v,m)=>{o.wrapped=!0,o.flipped=m});function c(){o.wrapped=!1,o.flipped=!1,r.deselectCell(),r.unlisten()}const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:"focusCatcher"};r.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:g}=r.getSettings();l=!0,r.getSelectedRangeLast()&&!g&&(a=!1),g||(u=!0)},position:"before"},{...h,callback:g=>{const{tabNavigation:v,autoWrapRow:m}=r.getSettings();if(l=!1,a=!0,!v||!r.selection.isSelected()||m&&o.wrapped&&o.flipped||!m&&o.wrapped)return m&&o.wrapped&&o.flipped&&(t=g.shiftKey?getMostTopStartPosition(r):getMostBottomEndPosition(r)),c(),!1;g.preventDefault()},position:"after"}])}function getMostTopStartPosition(r){const{rowIndexMapper:e,columnIndexMapper:t}=r,{navigableHeaders:n}=r.getSettings();let s=n&&r.countColHeaders()>0?-r.countColHeaders():0,o=n&&r.countRowHeaders()>0?-r.countRowHeaders():0;return s===0&&(s=e.getVisualFromRenderableIndex(s)),o===0&&(o=t.getVisualFromRenderableIndex(o)),s===null||o===null?null:r._createCellCoords(s,o)}function getMostBottomEndPosition(r){var e,t;const{rowIndexMapper:n,columnIndexMapper:s}=r,{navigableHeaders:o}=r.getSettings();let a=n.getRenderableIndexesLength()-1,l=s.getRenderableIndexesLength()-1;if(a<0){if(!o||r.countColHeaders()===0)return null;a=-1}if(l<0){if(!o||r.countColHeaders()===0)return null;l=-1}return r._createCellCoords((e=n.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(t=s.getVisualFromRenderableIndex(l))!==null&&t!==void 0?t:l)}function normalizeCoordsIfNeeded(r){return e=>{if(!e)return null;const t=getMostTopStartPosition(r),n=getMostBottomEndPosition(r);return e.col<t.col&&(e.col=t.col),e.col>n.col&&(e.col=n.col),e.row<t.row&&(e.row=t.row),e.row>n.row&&(e.row=n.row),e}}function columnHeaderScrollStrategy(r){return e=>{let{col:t}=e;r.scrollViewportTo({col:t})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function multipleScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function noncontiguousScrollStrategy(r){return e=>{r.scrollViewportTo(e.toObject())}}function rowHeaderScrollStrategy(r){return e=>{let{row:t}=e;r.scrollViewportTo({row:t})}}function singleScrollStrategy(r){return e=>{const t=r.selection.getSelectionSource(),{row:n,col:s}=e;if(n<0&&s>=0)r.scrollViewportTo({col:s});else if(s<0&&n>=0)r.scrollViewportTo({row:n});else{if(t==="mouse"&&(s===r.view.getLastPartiallyVisibleColumn()||n===r.view.getLastPartiallyVisibleRow()))return;r.scrollViewportTo({row:n,col:s})}}}function createViewportScroller(r){const{selection:e}=r;let t=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){t=!0},scrollTo(s){var o;if(t||n){t=!1;return}let a;e.isFocusSelectionChanged()?a=focusScrollStrategy(r):e.isSelectedByCorner()?a=cornerHeaderScrollStrategy():e.isSelectedByRowHeader()?a=rowHeaderScrollStrategy(r):e.isSelectedByColumnHeader()?a=columnHeaderScrollStrategy(r):e.getSelectedRange().size()===1&&e.isMultiple()?a=multipleScrollStrategy(r):e.getSelectedRange().size()===1&&!e.isMultiple()?a=singleScrollStrategy(r):e.getSelectedRange().size()>1&&(a=noncontiguousScrollStrategy(r)),(o=a)===null||o===void 0||o(s)}}}const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=r=>r.map(e=>{const t=e.toLowerCase();return mappings.has(t)?mappings.get(t):t}).sort().join("+"),getKeysList=r=>r.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=r=>{let{which:e,key:t}=r;if(specialCharactersSet.has(e))return specialCharactersSet.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:t.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(r){return isObject$1(r)&&r.__kindOf===__kindOf}const createContext=r=>{const e=createUniqueMap({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${r}" context.`}),t=function(){let{keys:u,callback:c,group:h,runOnlyIf:g=()=>!0,captureCtrl:v=!1,preventDefault:m=!0,stopPropagation:E=!1,relativeToGroup:_,position:S,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined$1(h))throw new Error("You need to define the shortcut's group.");if(isFunction$1(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const A={callback:c,group:h,runOnlyIf:g,captureCtrl:v,preventDefault:m,stopPropagation:E};isDefined(_)&&(A.relativeToGroup=_,A.position=S),isContextObject(w)&&(A.forwardToContext=w),u.forEach(O=>{const D=normalizeKeys(O);if(e.hasItem(D)){const H=e.getItem(D);let k=H.findIndex(K=>K.group===_);k!==-1?S==="before"?k-=1:k+=1:k=H.length,H.splice(k,0,A)}else e.addItem(D,[A])})},n=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{objectEach(c,(g,v)=>{Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),t(h)})},s=u=>{const c=normalizeKeys(u);e.removeItem(c)};return{__kindOf,addShortcut:t,addShortcuts:n,getShortcuts:u=>{const c=normalizeKeys(u),h=e.getItem(c);return isDefined(h)?h.slice():[]},hasShortcut:u=>{const c=normalizeKeys(u);return e.hasItem(c)},removeShortcutsByKeys:s,removeShortcutsByGroup:u=>{e.getItems().forEach(h=>{let[g,v]=h;const m=v.filter(E=>E.group!==u);m.length===0?s(getKeysList(g)):(v.length=0,v.push(...m))})}}};function createKeysObserver(){const r=new Set;return{press(e){r.add(e)},release(e){r.delete(e)},releaseAll(){r.clear()},isPressed(e){return r.has(e)}}}const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[];let instanceCounter=0;function useRecorder(r,e,t,n,s){const o=m=>MODIFIER_KEYS.includes(m),a=function(m){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const _=[];return m.altKey&&_.push("alt"),E&&(m.ctrlKey||m.metaKey)?_.push("control/meta"):(m.ctrlKey&&_.push("control"),m.metaKey&&_.push("meta")),m.shiftKey&&_.push("shift"),_},l=m=>{if(e(m)===!1||t(m)===!1||m.keyCode===229||typeof m.key!="string"||isImmediatePropagationStopped(m))return;const _=normalizeEventKey(m);let S=[];o(_)||(S=a(m));const w=[_].concat(S);!s(m,w)&&(isMacOS()&&S.includes("meta")||!isMacOS()&&S.includes("control"))&&s(m,[_].concat(a(m,!0))),n(m)},u=m=>{if(typeof m.key=="string"){const E=normalizeEventKey(m);o(E)&&modifierKeysObserver.press(E)}},c=m=>{if(typeof m.key=="string"){const E=normalizeEventKey(m);o(E)&&modifierKeysObserver.release(E)}},h=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let m=r;for(instanceCounter+=1;m;)instanceCounter===1&&(m.document.documentElement.addEventListener("keydown",u),modKeyListeners.push({event:"keydown",listener:u}),m.document.documentElement.addEventListener("keyup",c),modKeyListeners.push({event:"keyup",listener:c})),m.document.documentElement.addEventListener("keydown",l),m.document.documentElement.addEventListener("blur",h),m=getParentWindow(m)},unmount:()=>{let m=r;for(instanceCounter-=1;m;){if(instanceCounter===0){for(let E=0;E<modKeyListeners.length;E++){const{event:_,listener:S}=modKeyListeners[E];m.document.documentElement.removeEventListener(_,S)}modKeyListeners.length=0}m.document.documentElement.removeEventListener("keydown",l),m.document.documentElement.removeEventListener("blur",h),m=getParentWindow(m)}},isPressed:m=>modifierKeysObserver.isPressed(m),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}const createShortcutManager=r=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:s}=r;const o=createUniqueMap({errorIdExists:E=>`The "${E}" context name is already registered.`});let a="grid";const l=E=>{const _=createContext(E);return o.addItem(E,_),_},u=()=>a,c=E=>o.getItem(E),h=E=>{if(!o.hasItem(E))throw new Error(toSingleLine`You've tried to activate the "${E}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=E};let g=!1;const v=function(E,_){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u();const w=isContextObject(S)?S:c(S);let A=!1;if(!w.hasShortcut(_))return A;const O=w.getShortcuts(_);for(let D=0;D<O.length;D++){const{callback:Y,runOnlyIf:H,preventDefault:k,stopPropagation:K,captureCtrl:se,forwardToContext:re}=O[D];if(H(E)===!0){if(g=se,A=Y(E,_)===!1,g=!1,k&&E.preventDefault(),K&&(stopImmediatePropagation(E),E.stopPropagation()),A)break;re&&v(E,_,re)}}return A},m=useRecorder(e,t,n,s,v);return m.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:h,isCtrlPressed:()=>!g&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function getThemeClassName(r){const{classNames:e}=findFirstParentWithClass(r,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let activeGuid=null;const foreignHotInstances=new Map;function Core(r,e){var t,n=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new EventManager(o);let l,u,c,h,g,v,m=!0;hasValidParameter(s)&&registerAsRootInstance(this),this.rootElement=r,this.rootDocument=r.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const E=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",_=["rtl","ltr"].includes(E)?E:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",_),this.isRtl=function(){return _==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=getValidLanguageCode(e.language);const S=new MetaManager(o,e,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),w=S.getTableMeta(),A=S.getGlobalMeta(),O=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,r.insertBefore(this.container,r.firstChild),isRootInstance(this)&&(_injectProductInfo(e.licenseKey,r),addClass$1(r,"ht-wrapper")),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",B=>{o.runHooks("afterColumnSequenceChange",B)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",B=>{o.runHooks("afterRowSequenceChange",B)}),u=new DataSource(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const D=B=>{const{row:te,col:V}=B;return o._createCellCoords(te>=0?o.rowIndexMapper.getRenderableFromVisualIndex(te):te,V>=0?o.columnIndexMapper.getRenderableFromVisualIndex(V):V)},Y=B=>{const{row:te,col:V}=B;return o._createCellCoords(te>=0?o.rowIndexMapper.getVisualFromRenderableIndex(te):te,V>=0?o.columnIndexMapper.getVisualFromRenderableIndex(V):V)},H=(B,te)=>{const V=te>B?1:-1,ue=Math.min(B,te),Ae=Math.max(B,te),Ve=o.rowIndexMapper.getNearestNotHiddenIndex(B,V);return Ve===null||V===1&&Ve>Ae||V===-1&&Ve<ue?null:Ve>=0?o.rowIndexMapper.getRenderableFromVisualIndex(Ve):Ve},k=(B,te)=>{const V=te>B?1:-1,ue=Math.min(B,te),Ae=Math.max(B,te),Ve=o.columnIndexMapper.getNearestNotHiddenIndex(B,V);return Ve===null||V===1&&Ve>Ae||V===-1&&Ve<ue?null:Ve>=0?o.columnIndexMapper.getRenderableFromVisualIndex(Ve):Ve};let K=new Selection(w,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:B=>l.propToCol(B),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(B,te)=>o._createCellCoords(B,te),createCellRange:(B,te,V)=>o._createCellRange(B,te,V),visualToRenderableCoords:D,renderableToVisualCoords:Y,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:k,isDisabledCellSelection:(B,te)=>B<0||te<0?o.getSettings().disableVisualSelection:o.getCellMeta(B,te).disableVisualSelection});this.selection=K;const se=B=>{let{hiddenIndexesChanged:te}=B;te&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",se),this.rowIndexMapper.addLocalHook("cacheUpdated",se),this.selection.addLocalHook("afterSetRangeEnd",(B,te)=>{const V=createObjectPropListener(!1),ue=this.selection.getSelectedRange(),{from:Ae,to:Ve}=ue.current(),He=ue.size()-1;this.runHooks("afterSelection",Ae.row,Ae.col,Ve.row,Ve.col,V,He),this.runHooks("afterSelectionByProp",Ae.row,o.colToProp(Ae.col),Ve.row,o.colToProp(Ve.col),V,He),te&&(!V.isTouched()||V.isTouched()&&!V.value)&&v.scrollTo(B);const be=K.isSelectedByRowHeader(),qe=K.isSelectedByColumnHeader();be&&qe?addClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]):be?(removeClass$1(this.rootElement,"ht__selection--columns"),addClass$1(this.rootElement,"ht__selection--rows")):qe?(removeClass$1(this.rootElement,"ht__selection--rows"),addClass$1(this.rootElement,"ht__selection--columns")):removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),K.getSelectionSource()!=="shift"&&h.closeEditor(null),o.view.render(),h.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",B=>{this.runHooks("beforeSelectionFocusSet",B.row,B.col)}),this.selection.addLocalHook("afterSetFocus",B=>{const te=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",B.row,B.col,te),(!te.isTouched()||te.isTouched()&&!te.value)&&v.scrollTo(B),h.closeEditor(),o.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",B=>{const te=B.length-1,{from:V,to:ue}=B[te];this.runHooks("afterSelectionEnd",V.row,V.col,ue.row,ue.col,te),this.runHooks("afterSelectionEndByProp",V.row,o.colToProp(V.col),ue.row,o.colToProp(ue.col),te)}),this.selection.addLocalHook("afterIsMultipleSelection",B=>{const te=this.runHooks("afterIsMultipleSelection",B.value);B.value&&(B.value=te)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),o.view.render(),removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeStart",...te)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeStartOnly",...te)}).addLocalHook("beforeSetRangeEnd",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeSetRangeEnd",...te)}).addLocalHook("beforeSelectColumns",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeSelectColumns",...te)}).addLocalHook("afterSelectColumns",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("afterSelectColumns",...te)}).addLocalHook("beforeSelectRows",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeSelectRows",...te)}).addLocalHook("afterSelectRows",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("afterSelectRows",...te)}).addLocalHook("beforeModifyTransformStart",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("modifyTransformStart",...te)}).addLocalHook("afterModifyTransformStart",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformStart",...te)}).addLocalHook("beforeModifyTransformFocus",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("modifyTransformFocus",...te)}).addLocalHook("afterModifyTransformFocus",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformFocus",...te)}).addLocalHook("beforeModifyTransformEnd",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("modifyTransformEnd",...te)}).addLocalHook("afterModifyTransformEnd",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("afterModifyTransformEnd",...te)}).addLocalHook("beforeRowWrap",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeRowWrap",...te)}).addLocalHook("beforeColumnWrap",function(){for(var B=arguments.length,te=new Array(B),V=0;V<B;V++)te[V]=arguments[V];return n.runHooks("beforeColumnWrap",...te)}).addLocalHook("insertRowRequire",B=>this.alter("insert_row_above",B,1,"auto")).addLocalHook("insertColRequire",B=>this.alter("insert_col_start",B,1,"auto")),c={alter(B,te){var V,ue;let Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Ve=arguments.length>3?arguments[3]:void 0,He=arguments.length>4?arguments[4]:void 0;const be=qe=>{if(qe.length===0)return[];const le=[...qe];return le.sort((Se,Ye)=>{let[Fe]=Se,[je]=Ye;return Fe===je?0:Fe>je?1:-1}),arrayReduce(le,(Se,Ye)=>{let[Fe,je]=Ye;const rt=Se[Se.length-1],[Ue,Xe]=rt,et=Ue+Xe;if(Fe<=et){const Qe=Math.max(je-(et-Fe),0);rt[1]+=Qe}else Se.push([Fe,je]);return Se},[le[0]])};switch(B){case"insert_row_below":case"insert_row_above":const qe=o.countSourceRows();if(w.maxRows===qe)return;const le=B==="insert_row_below"?"below":"above";te=(V=te)!==null&&V!==void 0?V:le==="below"?qe:0;const{delta:pe,startPhysicalIndex:Se}=l.createRow(te,Ae,{source:Ve,mode:le});K.shiftRows(o.toVisualRow(Se),pe);break;case"insert_col_start":case"insert_col_end":const Ye=B==="insert_col_end"?"end":"start";te=(ue=te)!==null&&ue!==void 0?ue:Ye==="end"?o.countSourceCols():0;const{delta:Fe,startPhysicalIndex:je}=l.createCol(te,Ae,{source:Ve,mode:Ye});if(Fe){if(Array.isArray(w.colHeaders)){const Xe=[o.toVisualColumn(je),0];Xe.length+=Fe,Array.prototype.splice.apply(w.colHeaders,Xe)}K.shiftColumns(o.toVisualColumn(je),Fe)}break;case"remove_row":const rt=Xe=>{let et=0;arrayEach(Xe,Qe=>{let[st,St]=Qe;const At=isEmpty$1(st)?o.countRows()-1:Math.max(st-et,0);if(Number.isInteger(st)&&(st=Math.max(st-et,0)),!l.removeRow(st,St,Ve))return;if(K.isSelected()){const{row:ae}=o.getSelectedRangeLast().highlight;ae>=st&&ae<=st+St-1&&h.closeEditor(!0)}const X=o.countRows();X===0?K.deselect():Ve==="ContextMenu.removeRow"?K.refresh():K.shiftRows(st,-St);const P=w.fixedRowsTop;P>=At+1&&(w.fixedRowsTop-=Math.min(St,P-At));const R=w.fixedRowsBottom;R&&At>=X-R&&(w.fixedRowsBottom-=Math.min(St,R)),et+=St})};Array.isArray(te)?rt(be(te)):rt([[te,Ae]]);break;case"remove_col":const Ue=Xe=>{let et=0;arrayEach(Xe,Qe=>{let[st,St]=Qe;const At=isEmpty$1(st)?o.countCols()-1:Math.max(st-et,0);let j=o.toPhysicalColumn(At);if(Number.isInteger(st)&&(st=Math.max(st-et,0)),!l.removeCol(st,St,Ve))return;if(K.isSelected()){const{col:ae}=o.getSelectedRangeLast().highlight;ae>=st&&ae<=st+St-1&&h.closeEditor(!0)}o.countCols()===0?K.deselect():Ve==="ContextMenu.removeColumn"?K.refresh():K.shiftColumns(st,-St);const R=w.fixedColumnsStart;R>=At+1&&(w.fixedColumnsStart-=Math.min(St,R-At)),Array.isArray(w.colHeaders)&&(typeof j>"u"&&(j=-1),w.colHeaders.splice(j,St)),et+=St})};Array.isArray(te)?Ue(be(te)):Ue([[te,Ae]]);break;default:throw new Error(`There is no such action "${B}"`)}o.view.render(),He||c.adjustRowsAndCols()},adjustRowsAndCols(){const B=w.minRows,te=w.minSpareRows,V=w.minCols,ue=w.minSpareCols;if(B){const Ae=o.countRows();Ae<B&&l.createRow(Ae,B-Ae,{source:"auto"})}if(te){const Ae=o.countEmptyRows(!0);if(Ae<te){const Ve=te-Ae,He=Math.min(Ve,w.maxRows-o.countSourceRows());l.createRow(o.countRows(),He,{source:"auto"})}}{let Ae;(V||ue)&&(Ae=o.countEmptyCols(!0));let Ve=o.countCols();if(V&&!w.columns&&Ve<V){const He=V-Ve;Ae+=He,l.createCol(Ve,He,{source:"auto"})}if(ue&&!w.columns&&o.dataType==="array"&&Ae<ue){Ve=o.countCols();const He=ue-Ae,be=Math.min(He,w.maxCols-Ve);l.createCol(Ve,be,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(B,te,V,ue,Ae){let Ve,He,be,qe;const le=[],pe={},Se=[],Ye=B.row,Fe=B.col;if(He=te.length,He===0)return!1;let je=0,rt=0;switch(isObject$1(V)&&(je=V.col-Fe+1,rt=V.row-Ye+1),Ae){case"shift_down":const Ue=pivot(te),Xe=Ue.length,et=Math.max(Xe,je),Qe=o.getData().slice(Ye),st=pivot(Qe).slice(Fe,Fe+et);for(be=0;be<et;be+=1)if(be<Xe){for(Ve=0,He=Ue[be].length;Ve<rt-He;Ve+=1)Ue[be].push(Ue[be][Ve%He]);be<st.length?Se.push(Ue[be].concat(st[be])):Se.push(Ue[be].concat(new Array(Qe.length).fill(null)))}else Se.push(Ue[be%Xe].concat(st[be]));o.populateFromArray(Ye,Fe,pivot(Se));break;case"shift_right":const St=te.length,At=Math.max(St,rt),j=o.getData().slice(Ye).map(ee=>ee.slice(Fe));for(Ve=0;Ve<At;Ve+=1)if(Ve<St){for(be=0,qe=te[Ve].length;be<je-qe;be+=1)te[Ve].push(te[Ve][be%qe]);if(Ve<j.length)for(let ee=0;ee<j[Ve].length;ee+=1)te[Ve].push(j[Ve][ee]);else te[Ve].push(...new Array(j[0].length).fill(null))}else te.push(te[Ve%He].slice(0,At).concat(j[Ve]));o.populateFromArray(Ye,Fe,te);break;case"overwrite":default:pe.row=B.row,pe.col=B.col;let X=0,P=0,R=!0,ae;const Pe=function(fe){let Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const $e=te[fe%te.length];return Re!==null?$e[Re%$e.length]:$e},Oe=te.length,oe=V?V.row-B.row+1:0;for(V?He=oe:He=Math.max(Oe,oe),Ve=0;Ve<He&&!(V&&pe.row>V.row&&oe>Oe||!w.allowInsertRow&&pe.row>o.countRows()-1||pe.row>=w.maxRows);Ve++){const ee=Ve-X,fe=Pe(ee).length,Re=V?V.col-B.col+1:0;if(V?qe=Re:qe=Math.max(fe,Re),pe.col=B.col,ae=o.getCellMeta(pe.row,pe.col),(ue==="CopyPaste.paste"||ue==="Autofill.fill")&&ae.skipRowOnPaste){X+=1,pe.row+=1,He+=1;continue}for(P=0,be=0;be<qe&&!(V&&pe.col>V.col&&Re>fe||!w.allowInsertColumn&&pe.col>o.countCols()-1||pe.col>=w.maxCols);be++){if(ae=o.getCellMeta(pe.row,pe.col),(ue==="CopyPaste.paste"||ue==="Autofill.fill")&&ae.skipColumnOnPaste){P+=1,pe.col+=1,qe+=1;continue}if(ae.readOnly&&ue!=="UndoRedo.undo"){pe.col+=1;continue}const $e=be-P;let Je=Pe(ee,$e),Be=o.getDataAtCell(pe.row,pe.col);if(Je!==null&&typeof Je=="object")if(Array.isArray(Je)&&Be===null&&(Be=[]),Be===null||typeof Be!="object")R=!1;else{const ot=duckSchema(Array.isArray(Be)?Be:Be[0]||Be),gt=duckSchema(Array.isArray(Je)?Je:Je[0]||Je);isObjectEqual(ot,gt)||Array.isArray(ot)&&Array.isArray(gt)?Je=deepClone(Je):R=!1}else Be!==null&&typeof Be=="object"&&(R=!1);R&&le.push([pe.row,pe.col,Je]),R=!0,pe.col+=1}pe.row+=1}o.setDataAtCell(le,null,null,ue||"populateFromArray");break}}};function re(B){const te=normalizeLanguageCode(B);hasLanguageDictionary(te)?(o.runHooks("beforeLanguageChange",te),A.language=te,o.runHooks("afterLanguageChange",te)):warnUserAboutLanguageRegistration(B)}function Ce(B,te){const V=B==="className"?o.rootElement:o.table;if(m)addClass$1(V,te);else{let ue=[],Ae=[];A[B]&&(ue=Array.isArray(A[B])?A[B]:stringToArray(A[B])),te&&(Ae=Array.isArray(te)?te:stringToArray(te));const Ve=getDifferenceOfArrays(ue,Ae),He=getDifferenceOfArrays(Ae,ue);Ve.length&&removeClass$1(V,Ve),He.length&&addClass$1(V,He)}A[B]=te}this.init=function(){u.setData(w.data),o.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass$1(o.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new TableView(this);const B=w.themeName||getThemeClassName(o.rootElement);o.useTheme(B),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),h=EditorManager.getInstance(o,w,K),v=createViewportScroller(o),g=new FocusManager(o),isRootInstance(this)&&installFocusCatcher(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&o.rootElement.offsetParent===null&&observeVisibilityChangeOnce(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof m=="object"&&(o.runHooks("afterChange",m[0],m[1]),m=!1),o.runHooks("afterInit")};function Le(){let B=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,B=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&B===!1&&(B=!0,this.onQueueEmpty(this.valid))}}}function he(B){const te=B.replace(",",".");return isNaN(parseFloat(te))===!1?parseFloat(te):B}function ve(B,te,V){if(!B.length){V();return}const ue=o.getActiveEditor(),Ae=new Le;let Ve=!0;Ae.onQueueEmpty=()=>{ue&&Ve&&ue.cancelChanges(),V()};for(let He=B.length-1;He>=0;He--){const[be,qe,,le]=B[He],pe=l.propToCol(qe);let Se;Number.isInteger(pe)?Se=o.getCellMeta(be,pe):Se={...Object.getPrototypeOf(w),...w},Se.type==="numeric"&&typeof le=="string"&&isNumericLike(le)&&(B[He][3]=he(le)),o.getCellValidator(Se)&&(Ae.addValidatorToQueue(),o.validateCell(B[He][3],Se,function(Ye,Fe){return function(je){if(typeof je!="boolean")throw new Error("Validation error: result is not boolean");je===!1&&Fe.allowInvalid===!1&&(Ve=!1,B.splice(Ye,1),Fe.valid=!0),Ae.removeValidatorFormQueue()}}(He,Se),te))}Ae.checkIfQueueIsEmpty()}function xe(B,te){for(let ue=B.length-1;ue>=0;ue--){let Ae=!1;if(B[ue]===null){B.splice(ue,1);continue}if(!((B[ue][2]===null||B[ue][2]===void 0)&&(B[ue][3]===null||B[ue][3]===void 0))){if(w.allowInsertRow)for(;B[ue][0]>o.countRows()-1;){const{delta:Ve}=l.createRow(void 0,void 0,{source:te});if(Ve===0){Ae=!0;break}}if(o.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;l.propToCol(B[ue][1])>o.countCols()-1;){const{delta:Ve}=l.createCol(void 0,void 0,{source:te});if(Ve===0){Ae=!0;break}}Ae||l.set(B[ue][0],B[ue][1],B[ue][3])}}const V=B.length>0;if(o.forceFullRender=!0,V){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",B,te),h.closeEditor(),o.view.render(),h.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",B,te||"edit");const ue=o.getActiveEditor();ue&&isDefined(ue.refreshValue)&&ue.refreshValue()}else o.view.render()}this._createCellCoords=function(B,te){return o.view._wt.createCellCoords(B,te)},this._createCellRange=function(B,te,V){return o.view._wt.createCellRange(B,te,V)},this.validateCell=function(B,te,V,ue){let Ae=o.getCellValidator(te);function Ve(He){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||te.hidden===!0){V(He);return}const qe=te.visualCol,le=te.visualRow,pe=o.getCell(le,qe,!0);if(pe&&pe.nodeName!=="TH"){const Se=o.rowIndexMapper.getRenderableFromVisualIndex(le),Ye=o.columnIndexMapper.getRenderableFromVisualIndex(qe);o.view._wt.getSetting("cellRenderer",Se,Ye,pe)}V(He)}isRegExp$1(Ae)&&(Ae=function(He){return function(be,qe){qe(He.test(be))}}(Ae)),isFunction$1(Ae)?(B=o.runHooks("beforeValidate",B,te.visualRow,te.prop,ue),o._registerImmediate(()=>{Ae.call(te,B,He=>{o&&(He=o.runHooks("afterValidate",He,B,te.visualRow,te.prop,ue),te.valid=He,Ve(He),o.runHooks("postAfterValidate",He,B,te.visualRow,te.prop,ue))})})):o._registerImmediate(()=>{te.valid=!0,Ve(te.valid,!1)})};function Ie(B,te,V){return Array.isArray(B)?B:[[B,te,V]]}function we(B,te){const V=o.getActiveEditor(),ue=o.runHooks("beforeChange",B,te||"edit"),Ae=B.filter(Ve=>Ve!==null);return ue===!1||Ae.length===0?(V&&V.cancelChanges(),[]):Ae}this.setDataAtCell=function(B,te,V,ue){const Ae=Ie(B,te,V),Ve=[];let He=ue,be,qe,le;for(be=0,qe=Ae.length;be<qe;be++){if(typeof Ae[be]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Ae[be][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Ae[be][1]>=this.countCols()?le=Ae[be][1]:le=l.colToProp(Ae[be][1]),Ve.push([Ae[be][0],le,u.getAtCell(this.toPhysicalRow(Ae[be][0]),Ae[be][1]),Ae[be][2]])}!He&&typeof B=="object"&&(He=te);const pe=we(Ve,He);o.runHooks("afterSetDataAtCell",pe,He),ve(pe,He,()=>{xe(pe,He)})},this.setDataAtRowProp=function(B,te,V,ue){const Ae=Ie(B,te,V),Ve=[];let He=ue,be,qe;for(be=0,qe=Ae.length;be<qe;be++)Ve.push([Ae[be][0],Ae[be][1],u.getAtCell(this.toPhysicalRow(Ae[be][0]),Ae[be][1]),Ae[be][2]]);!He&&typeof B=="object"&&(He=te);const le=we(Ve,ue);o.runHooks("afterSetDataAtRowProp",le,He),ve(le,He,()=>{xe(le,He)})},this.listen=function(){o&&!o.isListening()&&(foreignHotInstances.forEach(B=>{o!==B&&B.unlisten()}),activeGuid=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===o.guid},this.destroyEditor=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(B),o.view.render(),te&&K.isSelected()&&h.prepareEditor()},this.populateFromArray=function(B,te,V,ue,Ae,Ve,He){if(!(typeof V=="object"&&typeof V[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const be=typeof ue=="number"?o._createCellCoords(ue,Ae):null;return c.populateFromArray(o._createCellCoords(B,te),V,be,Ve,He)},this.spliceCol=function(B,te,V){for(var ue=arguments.length,Ae=new Array(ue>3?ue-3:0),Ve=3;Ve<ue;Ve++)Ae[Ve-3]=arguments[Ve];return l.spliceCol(B,te,V,...Ae)},this.spliceRow=function(B,te,V){for(var ue=arguments.length,Ae=new Array(ue>3?ue-3:0),Ve=3;Ve<ue;Ve++)Ae[Ve-3]=arguments[Ve];return l.spliceRow(B,te,V,...Ae)},this.getSelected=function(){if(K.isSelected())return arrayMap(K.getSelectedRange(),B=>{let{from:te,to:V}=B;return[te.row,te.col,V.row,V.col]})},this.getSelectedLast=function(){const B=this.getSelected();let te;return B&&B.length>0&&(te=B[B.length-1]),te},this.getSelectedRange=function(){if(K.isSelected())return Array.from(K.getSelectedRange())},this.getSelectedRangeLast=function(){const B=this.getSelectedRange();let te;return B&&B.length>0&&(te=B[B.length-1]),te},this.emptySelectedCells=function(B){if(!K.isSelected()||this.countRows()===0||this.countCols()===0)return;const te=[];arrayEach(K.getSelectedRange(),V=>{if(V.isSingleHeader())return;const ue=V.getTopStartCorner(),Ae=V.getBottomEndCorner();rangeEach(ue.row,Ae.row,Ve=>{rangeEach(ue.col,Ae.col,He=>{this.getCellMeta(Ve,He).readOnly||te.push([Ve,He,null])})})}),te.length>0&&this.setDataAtCell(te,B)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const B=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(B,0),!this.isRenderSuspended()&&B===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(B){this.suspendRender();const te=B();return this.resumeRender(),te},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const te=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(te,0),(!this.isExecutionSuspended()&&te===this.executionSuspendedCounter||B)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const V=B();return this.resumeExecution(te),V},this.batch=function(B){this.suspendRender(),this.suspendExecution();const te=B();return this.resumeExecution(),this.resumeRender(),te},this.refreshDimensions=function(){if(!o.view)return;const{width:B,height:te}=o.view.getLastSize(),{width:V,height:ue}=o.rootElement.getBoundingClientRect(),Ae=V!==B||ue!==te;o.runHooks("beforeRefreshDimensions",{width:B,height:te},{width:V,height:ue},Ae)!==!1&&((Ae||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(V,ue),o.render()),o.runHooks("afterRefreshDimensions",{width:B,height:te},{width:V,height:ue},Ae))},this.updateData=function(B,te){replaceData(B,V=>{l=V},V=>{l=V,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),K.refresh()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:te,metaManager:S,firstRun:m})},this.loadData=function(B,te){replaceData(B,V=>{l=V},()=>{S.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),K.refresh(),m&&(m=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:te,metaManager:S,firstRun:m})},this.getInitialColumnCount=function(){const B=w.columns;let te=0;if(Array.isArray(B))te=B.length;else if(isFunction$1(B))if(o.dataType==="array"){const V=this.countSourceCols();for(let ue=0;ue<V;ue+=1)B(ue)&&(te+=1)}else(o.dataType==="object"||o.dataType==="function")&&(te=l.colToPropCache.length);else if(isDefined(w.dataSchema)){const V=l.getSchema();te=Array.isArray(V)?V.length:deepObjectSize(V)}else te=this.countSourceCols();return te},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(B,te,V,ue){return isUndefined$1(B)?l.getAll():l.getRange(o._createCellCoords(B,te),o._createCellCoords(V,ue),l.DESTINATION_RENDERER)},this.getCopyableText=function(B,te,V,ue){return l.getCopyableText(o._createCellCoords(B,te),o._createCellCoords(V,ue))},this.getCopyableData=function(B,te){return l.getCopyable(B,l.colToProp(te))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const V=(m?o.loadData:o.updateData).bind(this);let ue=!1,Ae,Ve;if(isDefined(B.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(B.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(B.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(Ae in B)Ae==="data"||(Ae==="language"?re(B.language):Ae==="className"?Ce("className",B.className):Ae==="tableClassName"&&o.table?(Ce("tableClassName",B.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Hooks.getSingleton().isRegistered(Ae)||Hooks.getSingleton().isDeprecated(Ae)?isFunction$1(B[Ae])?Hooks.getSingleton().addAsFixed(Ae,B[Ae],o):Array.isArray(B[Ae])&&Hooks.getSingleton().add(Ae,B[Ae],o):!te&&hasOwnProperty(B,Ae)&&(A[Ae]=B[Ae]));B.data===void 0&&w.data===void 0?V(null,"updateSettings"):B.data!==void 0?V(B.data,"updateSettings"):B.columns!==void 0&&(l.createMap(),o.initIndexMappers());const He=o.countCols(),be=w.columns;if(be&&isFunction$1(be)&&(ue=!0),(B.cell!==void 0||B.cells!==void 0||B.columns!==void 0)&&S.clearCache(),He>0)for(Ae=0,Ve=0;Ae<He;Ae++){if(be){const pe=ue?be(Ae):be[Ve];pe&&S.updateColumnMeta(Ve,pe)}Ve+=1}isDefined(B.cell)&&objectEach(B.cell,pe=>{o.setCellMetaObject(pe.row,pe.col,pe)}),o.runHooks("afterCellMetaReset");let qe=o.rootElement.style.height;qe!==""&&(qe=parseInt(o.rootElement.style.height,10));let le=B.height;if(isFunction$1(le)&&(le=le()),te&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),le===null){const pe=o.rootElement.getAttribute("data-initialstyle");pe&&(pe.indexOf("height")>-1||pe.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",pe):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else le!==void 0&&(o.rootElement.style.height=isNaN(le)?`${le}`:`${le}px`,o.rootElement.style.overflow="hidden");if(typeof B.width<"u"){let pe=B.width;isFunction$1(pe)&&(pe=pe()),o.rootElement.style.width=isNaN(pe)?`${pe}`:`${pe}px`}if(!te){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const pe=o.getCurrentThemeName(),Se=hasOwnProperty(B,"themeName");pe&&Se&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(pe));const Ye=Se&&B.themeName||getThemeClassName(o.rootElement);o.useTheme(Ye),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",B)}c.adjustRowsAndCols(),o.view&&!m&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!te&&o.view&&(qe===""||le===""||le===void 0)&&qe!==le&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const B=o.getSelectedLast();if(w.getValue){if(isFunction$1(w.getValue))return w.getValue.call(o);if(B)return o.getData()[B[0][0]][w.getValue]}else if(B)return o.getDataAtCell(B[0],B[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(B,te,V,ue,Ae){c.alter(B,te,V,ue,Ae)},this.getCell=function(B,te){let V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ue=te,Ae=B;if(te>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(te)))return null;ue=this.columnIndexMapper.getRenderableFromVisualIndex(te)}if(B>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(B)))return null;Ae=this.rowIndexMapper.getRenderableFromVisualIndex(B)}return Ae===null||ue===null||Ae===void 0||ue===void 0?null:o.view.getCellAtCoords(o._createCellCoords(Ae,ue),V)},this.getCoords=function(B){const te=this.view._wt.wtTable.getCoords(B);if(te===null)return null;const{row:V,col:ue}=te;let Ae=V,Ve=ue;return V>=0&&(Ae=this.rowIndexMapper.getVisualFromRenderableIndex(V)),ue>=0&&(Ve=this.columnIndexMapper.getVisualFromRenderableIndex(ue)),o._createCellCoords(Ae,Ve)},this.colToProp=function(B){return l.colToProp(B)},this.propToCol=function(B){return l.propToCol(B)},this.toVisualRow=B=>this.rowIndexMapper.getVisualFromPhysicalIndex(B),this.toVisualColumn=B=>this.columnIndexMapper.getVisualFromPhysicalIndex(B),this.toPhysicalRow=B=>this.rowIndexMapper.getPhysicalFromVisualIndex(B),this.toPhysicalColumn=B=>this.columnIndexMapper.getPhysicalFromVisualIndex(B),this.getDataAtCell=function(B,te){return l.get(B,l.colToProp(te))},this.getDataAtRowProp=function(B,te){return l.get(B,te)},this.getDataAtCol=function(B){const te=[],V=l.getRange(o._createCellCoords(0,B),o._createCellCoords(w.data.length-1,B),l.DESTINATION_RENDERER);for(let ue=0;ue<V.length;ue+=1)for(let Ae=0;Ae<V[ue].length;Ae+=1)te.push(V[ue][Ae]);return te},this.getDataAtProp=function(B){const te=[],V=l.getRange(o._createCellCoords(0,l.propToCol(B)),o._createCellCoords(w.data.length-1,l.propToCol(B)),l.DESTINATION_RENDERER);for(let ue=0;ue<V.length;ue+=1)for(let Ae=0;Ae<V[ue].length;Ae+=1)te.push(V[ue][Ae]);return te},this.getSourceData=function(B,te,V,ue){let Ae;return B===void 0?Ae=u.getData():Ae=u.getByRange(o._createCellCoords(B,te),o._createCellCoords(V,ue)),Ae},this.getSourceDataArray=function(B,te,V,ue){let Ae;return B===void 0?Ae=u.getData(!0):Ae=u.getByRange(o._createCellCoords(B,te),o._createCellCoords(V,ue),!0),Ae},this.getSourceDataAtCol=function(B){return u.getAtColumn(B)},this.setSourceDataAtCell=function(B,te,V,ue){const Ae=Ie(B,te,V),Ve=this.hasHook("afterSetSourceDataAtCell"),He=[];Ve&&arrayEach(Ae,qe=>{let[le,pe,Se]=qe;He.push([le,pe,u.getAtCell(le,pe),Se])}),arrayEach(Ae,qe=>{let[le,pe,Se]=qe;u.setAtCell(le,pe,Se)}),Ve&&this.runHooks("afterSetSourceDataAtCell",He,ue),this.render();const be=o.getActiveEditor();be&&isDefined(be.refreshValue)&&be.refreshValue()},this.getSourceDataAtRow=function(B){return u.getAtRow(B)},this.getSourceDataAtCell=function(B,te){return u.getAtCell(B,te)},this.getDataAtRow=function(B){return l.getRange(o._createCellCoords(B,0),o._createCellCoords(B,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(B,te,V,ue){const Ae=B===void 0?[0,0,this.countRows(),this.countCols()]:[B,te,V,ue],[Ve,He]=Ae;let[,,be,qe]=Ae,le=null,pe=null;be===void 0&&(be=Ve),qe===void 0&&(qe=He);let Se="mixed";return rangeEach(Math.max(Math.min(Ve,be),0),Math.max(Ve,be),Ye=>{let Fe=!0;return rangeEach(Math.max(Math.min(He,qe),0),Math.max(He,qe),je=>(pe=this.getCellMeta(Ye,je).type,le?Fe=le===pe:le=pe,Fe)),Se=Fe?pe:"mixed",Fe}),Se},this.removeCellMeta=function(B,te,V){const[ue,Ae]=[this.toPhysicalRow(B),this.toPhysicalColumn(te)];let Ve=S.getCellMetaKeyValue(ue,Ae,V);o.runHooks("beforeRemoveCellMeta",B,te,V,Ve)!==!1&&(S.removeCellMeta(ue,Ae,V),o.runHooks("afterRemoveCellMeta",B,te,V,Ve)),Ve=null},this.spliceCellsMeta=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var V=arguments.length,ue=new Array(V>2?V-2:0),Ae=2;Ae<V;Ae++)ue[Ae-2]=arguments[Ae];if(ue.length>0&&!Array.isArray(ue[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");te>0&&S.removeRow(this.toPhysicalRow(B),te),ue.length>0&&arrayEach(ue.reverse(),Ve=>{S.createRow(this.toPhysicalRow(B)),arrayEach(Ve,(He,be)=>this.setCellMetaObject(B,be,He))}),o.render()},this.setCellMetaObject=function(B,te,V){typeof V=="object"&&objectEach(V,(ue,Ae)=>{this.setCellMeta(B,te,Ae,ue)})},this.setCellMeta=function(B,te,V,ue){if(o.runHooks("beforeSetCellMeta",B,te,V,ue)===!1)return;let Ve=B,He=te;B<this.countRows()&&(Ve=this.toPhysicalRow(B)),te<this.countCols()&&(He=this.toPhysicalColumn(te)),S.setCellMeta(Ve,He,V,ue),o.runHooks("afterSetCellMeta",B,te,V,ue)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(B,te){let V=this.toPhysicalRow(B),ue=this.toPhysicalColumn(te);return V===null&&(V=B),ue===null&&(ue=te),S.getCellMeta(V,ue,{visualRow:B,visualColumn:te})},this.getColumnMeta=function(B){return S.getColumnMeta(this.toPhysicalColumn(B))},this.getCellMetaAtRow=function(B){return S.getCellsMetaAtRow(B)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||w.columns)},this.getCellRenderer=function(B,te){const V=typeof B=="number"?o.getCellMeta(B,te).renderer:B.renderer;return typeof V=="string"?_getItem$2(V):isUndefined$1(V)?_getItem$2("text"):V},this.getCellEditor=function(B,te){const V=typeof B=="number"?o.getCellMeta(B,te).editor:B.editor;return typeof V=="string"?_getItem$3(V):isUndefined$1(V)?_getItem$3("text"):V},this.getCellValidator=function(B,te){const V=typeof B=="number"?o.getCellMeta(B,te).validator:B.validator;return typeof V=="string"?_getItem$1(V):V},this.validateCells=function(B){this._validateCells(B)},this.validateRows=function(B,te){if(!Array.isArray(B))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(te,B)},this.validateColumns=function(B,te){if(!Array.isArray(B))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(te,void 0,B)},this._validateCells=function(B,te,V){const ue=new Le;B&&(ue.onQueueEmpty=B);let Ae=o.countRows()-1;for(;Ae>=0;){if(te!==void 0&&te.indexOf(Ae)===-1){Ae-=1;continue}let Ve=o.countCols()-1;for(;Ve>=0;){if(V!==void 0&&V.indexOf(Ve)===-1){Ve-=1;continue}ue.addValidatorToQueue(),o.validateCell(o.getDataAtCell(Ae,Ve),o.getCellMeta(Ae,Ve),He=>{if(typeof He!="boolean")throw new Error("Validation error: result is not boolean");He===!1&&(ue.valid=!1),ue.removeValidatorFormQueue()},"validateCells"),Ve-=1}Ae-=1}ue.checkIfQueueIsEmpty()},this.getRowHeader=function(B){let te=w.rowHeaders,V=B;return V!==void 0&&(V=o.runHooks("modifyRowHeader",V)),V===void 0?(te=[],rangeEach(o.countRows()-1,ue=>{te.push(o.getRowHeader(ue))})):Array.isArray(te)&&te[V]!==void 0?te=te[V]:isFunction$1(te)?te=te(V):te&&typeof te!="string"&&typeof te!="number"&&(te=V+1),te},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let B=0,te=o.countCols();B<te;B++)if(o.getColHeader(B))return!0;return!1},this.getColHeader=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const V=o.runHooks("modifyColHeader",B);if(V===void 0){const be=[],qe=o.countCols();for(let le=0;le<qe;le++)be.push(o.getColHeader(le));return be}let ue=w.colHeaders;const Ae=function(be){const qe=[],le=o.countCols();let pe=0;for(;pe<le;pe++)isFunction$1(w.columns)&&w.columns(pe)&&qe.push(pe);return qe[be]},Ve=o.toPhysicalColumn(V),He=Ae(Ve);return w.colHeaders===!1?ue=null:w.columns&&isFunction$1(w.columns)&&w.columns(He)&&w.columns(He).title?ue=w.columns(He).title:w.columns&&w.columns[Ve]&&w.columns[Ve].title?ue=w.columns[Ve].title:Array.isArray(w.colHeaders)&&w.colHeaders[Ve]!==void 0?ue=w.colHeaders[Ve]:isFunction$1(w.colHeaders)?ue=w.colHeaders(Ve):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(ue=spreadsheetColumnLabel(V)),ue=o.runHooks("modifyColumnHeaderValue",ue,B,te),ue},this._getColWidthFromSettings=function(B){let te;if(B>=0&&(te=o.getCellMeta(0,B).width),(te===void 0||te===w.width)&&(te=w.colWidths),te!=null){switch(typeof te){case"object":te=te[B];break;case"function":te=te(B);break}typeof te=="string"&&(te=parseInt(te,10))}return te},this.getColWidth=function(B,te){let V=o._getColWidthFromSettings(B);return V=o.runHooks("modifyColWidth",V,B,te),V===void 0&&(V=DEFAULT_WIDTH),V},this._getRowHeightFromSettings=function(B){let te=w.rowHeights;if(te!=null){switch(typeof te){case"object":te=te[B];break;case"function":te=te(B);break}typeof te=="string"&&(te=parseInt(te,10))}return te},this.getRowHeight=function(B,te){let V=o._getRowHeightFromSettings(B);return V=o.runHooks("modifyRowHeight",V,B,te),V},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const B=w.maxCols,te=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(B,te)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=0;return rangeEachReverse(o.countRows()-1,V=>{if(o.isEmptyRow(V))te+=1;else if(B===!0)return!1}),te},this.countEmptyCols=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=0;return rangeEachReverse(o.countCols()-1,V=>{if(o.isEmptyCol(V))te+=1;else if(B===!0)return!1}),te},this.isEmptyRow=function(B){return w.isEmptyRow.call(o,B)},this.isEmptyCol=function(B){return w.isEmptyCol.call(o,B)},this.selectCell=function(B,te,V,ue){let Ae=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,Ve=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined$1(B)||isUndefined$1(te)?!1:this.selectCells([[B,te,V,ue]],Ae,Ve)},this.selectCells=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;te===!1&&v.suspend();const ue=K.selectCells(B);return ue&&V&&o.listen(),v.resume(),ue},this.selectColumns=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B,V=arguments.length>2?arguments[2]:void 0;return K.selectColumns(B,te,V)},this.selectRows=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B,V=arguments.length>2?arguments[2]:void 0;return K.selectRows(B,te,V)},this.deselectCell=function(){K.deselect()},this.selectAll=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B,V=arguments.length>2?arguments[2]:void 0;v.skipNextScrollCycle(),K.selectAll(B,te,V)};const Ne=(B,te)=>B.getNearestNotHiddenIndex(te,1,!0);this.scrollViewportTo=function(B){var te;if(typeof B=="number"){var V;B={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(V=arguments[4])!==null&&V!==void 0?V:!0}}const{row:ue,col:Ae,considerHiddenIndexes:Ve}=(te=B)!==null&&te!==void 0?te:{};let He=ue,be=Ae;if(Ve===void 0||Ve){const pe=Number.isInteger(ue)&&ue>=0,Se=Number.isInteger(Ae)&&Ae>=0,Ye=pe?Ne(this.rowIndexMapper,ue):void 0,Fe=Se?Ne(this.columnIndexMapper,Ae):void 0;if(Ye===null||Fe===null)return!1;He=pe?o.rowIndexMapper.getRenderableFromVisualIndex(Ye):ue,be=Se?o.columnIndexMapper.getRenderableFromVisualIndex(Fe):Ae}const qe=Number.isInteger(He),le=Number.isInteger(be);return qe&&He>=0&&le&&be>=0?o.view.scrollViewport(o._createCellCoords(He,be),B.horizontalSnap,B.verticalSnap):qe&&He>=0&&(le&&be<0||!le)?o.view.scrollViewportVertically(He,B.verticalSnap):le&&be>=0&&(qe&&He<0||!qe)?o.view.scrollViewportHorizontally(be,B.horizontalSnap):!1},this.scrollToFocusedCell=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",B);const{highlight:te}=this.getSelectedRangeLast();this.scrollViewportTo(te.toObject())?this.view.render():(this.removeHook("afterScroll",B),this._registerImmediate(()=>B()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),foreignHotInstances.delete(this.guid),isRootInstance(o)){const B=this.rootDocument.querySelector(".hot-display-license-info");B&&B.parentNode.removeChild(B)}empty$1(o.rootElement),a.destroy(),h&&h.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),O.getItems().forEach(B=>{let[,te]=B;te.destroy()}),O.clear(),o.runHooks("afterDestroy")},!0),Hooks.getSingleton().destroy(o),objectEach(o,(B,te,V)=>{isFunction$1(B)?V[te]=at(te):te!=="guid"&&(V[te]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,c=null,K=null,h=null,o=null};function at(B){return()=>{throw new Error(`The "${B}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(B){const te=toUpperCaseFirst(B);return te==="UndoRedo"?this.undoRedo:O.getItem(te)},this.getPluginName=function(B){return B===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(B)},this.getInstance=function(){return o},this.addHook=function(B,te,V){Hooks.getSingleton().add(B,te,o,V)},this.hasHook=function(B){return Hooks.getSingleton().has(B,o)||Hooks.getSingleton().has(B)},this.addHookOnce=function(B,te,V){Hooks.getSingleton().once(B,te,o,V)},this.removeHook=function(B,te){Hooks.getSingleton().remove(B,te,o)},this.runHooks=function(B,te,V,ue,Ae,Ve,He){return Hooks.getSingleton().run(o,B,te,V,ue,Ae,Ve,He)},this.getTranslatedPhrase=function(B,te){return getTranslatedPhrase(w.language,B,te)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const B=this.rootDocument.createElement("div");return B.insertAdjacentHTML("afterbegin",instanceToHTML(this)),B.firstElementChild},this.timeouts=[],this.useTheme=B=>{this.view.getStylesHandler().useTheme(B),this.runHooks("afterSetTheme",B,!!m)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(B){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,V=B;typeof V=="function"&&(V=setTimeout(V,te)),this.timeouts.push(V)},this._clearTimeouts=function(){arrayEach(this.timeouts,B=>{clearTimeout(B)})},this.immediates=[],this._registerImmediate=function(B){this.immediates.push(setImmediate(B))},this._clearImmediates=function(){arrayEach(this.immediates,B=>{clearImmediate(B)})},this._getEditorManager=function(){return h},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const nt=createShortcutManager({handleEvent(){return o.isListening()},beforeKeyDown:B=>this.runHooks("beforeKeyDown",B),afterKeyDown:B=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",B)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",B=>{B.ctrlKey===!1&&B.metaKey===!1&&nt.releasePressedKeys()}),this.getShortcutManager=function(){return nt},this.getFocusManager=function(){return g},getPluginsNames().forEach(B=>{const te=getPlugin(B);O.addItem(B,new te(this))}),registerAllShortcutContexts(o),nt.setActiveContextName("grid"),Hooks.getSingleton().run(o,"construct")}_register(TextCellType);Handsontable$1.editors={BaseEditor};function Handsontable$1(r,e){const t=new Core(r,e||{},rootInstanceSymbol);return t.init(),t}Handsontable$1.Core=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(r,e,rootInstanceSymbol)};Handsontable$1.DefaultSettings=metaSchemaFactory();Handsontable$1.hooks=Hooks.getSingleton();Handsontable$1.CellCoords=CellCoords;Handsontable$1.CellRange=CellRange;Handsontable$1.packageName="handsontable";Handsontable$1.buildDate="16/12/2024 13:19:38";Handsontable$1.version="15.0.0";Handsontable$1.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};var bulkComponentContainer=null,AUTOSIZE_WARNING="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",OBSOLETE_HOTRENDERER_WARNING="Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead.",OBSOLETE_HOTEDITOR_WARNING="Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead.",UNEXPECTED_HOTTABLE_CHILDREN_WARNING="Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.",UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING="Unexpected children nodes found in HotColumn component. HotColumn components do not support any children.",HOT_DESTROYED_WARNING="The Handsontable instance bound to this component was destroyed and cannot be used properly.",DEFAULT_CLASSNAME="hot-wrapper-editor-container";function warn(){if(typeof console<"u"){var r;(r=console).warn.apply(r,arguments)}}function displayObsoleteRenderersEditorsWarning(r){return hasChildElementOfType(r,"hot-renderer")?(warn(OBSOLETE_HOTRENDERER_WARNING),!0):hasChildElementOfType(r,"hot-editor")?(warn(OBSOLETE_HOTEDITOR_WARNING),!0):!1}function displayChildrenOfTypeWarning(r,e){var t=React.Children.toArray(r);return t.some(function(n){return n.type!==e})?(warn(UNEXPECTED_HOTTABLE_CHILDREN_WARNING),!0):!1}function displayAnyChildrenWarning(r){var e=React.Children.toArray(r);return e.length?(warn(UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING),!0):!1}function hasChildElementOfType(r,e){var t=React.Children.toArray(r);return t.some(function(n){return n.props[e]!==void 0})}function createEditorPortal(r,e){if(!r||!e)return null;var t=React.createElement(e,null),n=getContainerAttributesProps({},!1);return n.className="".concat(DEFAULT_CLASSNAME," ").concat(n.className),ReactDOM.createPortal(React.createElement("div",Object.assign({},n),t),r.body)}function createPortal(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;e||(e=document),bulkComponentContainer||(bulkComponentContainer=e.createDocumentFragment());var s=n??e.createElement("DIV");return bulkComponentContainer.appendChild(s),{portal:ReactDOM.createPortal(r,s,t),portalContainer:s}}function getContainerAttributesProps(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:r.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:r.className||"",style:r.style||{}}}function isCSR(){return typeof window<"u"}function useUpdateEffect(r,e){var t=React.useRef(!1);reactExports.useEffect(function(){if(t.current)return r();t.current=!0},e)}function _arrayLikeToArray(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _assertThisInitialized(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _callSuper(r,e,t){return e=_getPrototypeOf(e),_possibleConstructorReturn(r,_isNativeReflectConstruct()?Reflect.construct(e,t,_getPrototypeOf(r).constructor):e.apply(r,t))}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,_toPropertyKey(n.key),n)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function _getPrototypeOf(r){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(r)}function _inherits(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&_setPrototypeOf(r,e)}function _isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!r})()}function _iterableToArray(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function _iterableToArrayLimit(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,s,o,a,l=[],u=!0,c=!1;try{if(o=(t=t.call(r)).next,e!==0)for(;!(u=(n=o.call(t)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(h){c=!0,s=h}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw s}}return l}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _objectWithoutProperties(r,e){if(r==null)return{};var t,n,s=_objectWithoutPropertiesLoose(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)t=o[n],e.includes(t)||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function _objectWithoutPropertiesLoose(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}function _possibleConstructorReturn(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(r)}function _setPrototypeOf(r,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},_setPrototypeOf(r,e)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _toPrimitive(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function _toPropertyKey(r){var e=_toPrimitive(r,"string");return typeof e=="symbol"?e:e+""}function _unsupportedIterableToArray(r,e){if(r){if(typeof r=="string")return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}var SettingsMapper=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"getSettings",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.prevProps,o=s===void 0?{}:s,a=n.isInit,l=a===void 0?!1:a,u=n.initOnlySettingKeys,c=u===void 0?[]:u,h=function(E){return!l&&c.includes(E)?o[E]===t[E]:!1},g={};for(var v in t)v!=="children"&&!h(v)&&t.hasOwnProperty(v)&&(g[v]=t[v]);return g}}])}(),HotTableContext=reactExports.createContext(void 0),HotTableContextProvider=function(e){var t=e.children,n=reactExports.useRef([]),s=reactExports.useCallback(function(S,w){n.current[w]=S},[]),o=reactExports.useRef(new Map),a=reactExports.useRef(new Map),l=reactExports.useCallback(function(){return a.current.clear()},[]),u=reactExports.useRef(new Map),c=reactExports.useCallback(function(){return u.current.clear()},[]),h=reactExports.useRef(new Map),g=reactExports.useCallback(function(S){return function(A,O,D,Y,H,k,K){var se="".concat(D,"-").concat(Y),re=A.guid,Ce="".concat(re,"-").concat(se),Le="".concat(se,"-").concat(re);if(a.current.has(se)&&(O.innerHTML=a.current.get(se).innerHTML),O&&!O.getAttribute("ghost-table")){for(var he=u.current.get(Le),ve=h.current.get(Ce);O.firstChild;)O.removeChild(O.firstChild);if(he&&ve)O.appendChild(ve);else{var xe=React.createElement(S,{instance:A,TD:O,row:D,col:Y,prop:H,value:k,cellProperties:K}),Ie=createPortal(xe,O.ownerDocument,Le,ve),we=Ie.portal,Ne=Ie.portalContainer;h.current.set(Ce,Ne),O.appendChild(Ne),u.current.set(Le,we)}}return a.current.set("".concat(D,"-").concat(Y),O),O}},[]),v=reactExports.useRef(function(){}),m=reactExports.useCallback(function(S){v.current=S},[]),E=reactExports.useCallback(function(){v.current(_toConsumableArray(u.current.values()))},[]),_=reactExports.useMemo(function(){return{componentRendererColumns:o.current,columnsSettings:n.current,emitColumnSettings:s,getRendererWrapper:g,clearPortalCache:c,clearRenderedCellCache:l,setRenderersPortalManagerRef:m,pushCellPortalsIntoPortalManager:E}},[s,g,l,m,E]);return React.createElement(HotTableContext.Provider,{value:_},t)};function useHotTableContext(){return reactExports.useContext(HotTableContext)}var HotColumnContext=reactExports.createContext(void 0),HotColumnContextProvider=function(e){var t=e.columnIndex,n=e.getOwnerDocument,s=e.children,o=reactExports.useMemo(function(){return{columnIndex:t,getOwnerDocument:n}},[t,n]);return React.createElement(HotColumnContext.Provider,{value:o},s)},useHotColumnContext=function(){return reactExports.useContext(HotColumnContext)},AbstractMethods=["close","focus","open"],ExcludedMethods=["getValue","setValue"],MethodsMap={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function makeEditorClass(r,e){return function(t){function n(s){var o;return _classCallCheck(this,n),o=_callSuper(this,n,[s]),e.current=o,Object.getOwnPropertyNames(Handsontable$1.editors.BaseEditor.prototype).forEach(function(a){if(!(a==="constructor"||ExcludedMethods.includes(a))){var l=Handsontable$1.editors.BaseEditor.prototype[a];n.prototype[a]=(function(){for(var u,c,h=arguments.length,g=new Array(h),v=0;v<h;v++)g[v]=arguments[v];if(AbstractMethods.includes(a)||(c=l.call.apply(l,[this].concat(g))),MethodsMap[a]&&(u=r.current)!==null&&u!==void 0&&u[MethodsMap[a]]){var m;c=(m=r.current[MethodsMap[a]]).call.apply(m,[this].concat(g))}return c}).bind(o)}}),o}return _inherits(n,t),_createClass(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(o){this.value=o}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Handsontable$1.editors.BaseEditor)}var EditorContext=reactExports.createContext(void 0),EditorContextProvider=function(e){var t=e.hooksRef,n=e.hotCustomEditorInstanceRef,s=e.children;return React.createElement(EditorContext.Provider,{value:{hooksRef:t,hotCustomEditorInstanceRef:n}},s)},isHotColumn=function(e){return e.type===HotColumn},internalProps=["_columnIndex","_getOwnerDocument","children"],HotColumn=function(e){var t=useHotTableContext(),n=t.componentRendererColumns,s=t.emitColumnSettings,o=t.getRendererWrapper,a=useHotColumnContext(),l=a.columnIndex,u=a.getOwnerDocument,c=reactExports.useRef(null),h=reactExports.useRef(null);reactExports.useEffect(function(){var v=function(){return Object.keys(e).filter(function(S){return!internalProps.includes(S)}).reduce(function(S,w){return S[w]=e[w],S},{})},m=function(){var S=SettingsMapper.getSettings(v());return e.renderer?(S.renderer=o(e.renderer),n.set(l,!0)):e.hotRenderer&&(S.renderer=e.hotRenderer),e.editor?S.editor=makeEditorClass(c,h):e.hotEditor&&(S.editor=e.hotEditor),S},E=m();s(E,l),displayObsoleteRenderersEditorsWarning(e.children)||displayAnyChildrenWarning(e.children)});var g=createEditorPortal(u(),e.editor);return React.createElement(EditorContextProvider,{hooksRef:c,hotCustomEditorInstanceRef:h},g)},version="15.0.0",RenderersPortalManager=reactExports.forwardRef(function(r,e){var t=reactExports.useState([]),n=_slicedToArray(t,2),s=n[0],o=n[1];return reactExports.useImperativeHandle(e,function(){return o}),React.createElement(reactExports.Fragment,null,s)});function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=r,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var r=requireReactPropTypesSecret();function e(){}function t(){}return t.resetWarningCache=e,factoryWithThrowingShims=function(){function s(l,u,c,h,g,v){if(v!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}s.isRequired=s;function o(){return s}var a={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:o,element:s,elementType:s,instanceOf:o,node:s,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},factoryWithThrowingShims}propTypes.exports=requireFactoryWithThrowingShims()();var propTypesExports=propTypes.exports,PropTypes=getDefaultExportFromCjs(propTypesExports),HotTableInner=reactExports.forwardRef(function(r,e){var t=reactExports.useRef(null),n=reactExports.useRef(null),s=reactExports.useRef(null),o=reactExports.useRef(null),a=reactExports.useRef(),l=useHotTableContext(),u=reactExports.useCallback(function(){return!t.current||!t.current.isDestroyed?t.current:(console.warn(HOT_DESTROYED_WARNING),null)},[t]),c=reactExports.useCallback(function(){return!t.current||t.current.isDestroyed},[t]),h=reactExports.useCallback(function(){l.clearRenderedCellCache(),l.componentRendererColumns.clear()},[l]),g=reactExports.useCallback(function(){return isCSR()?n.current?n.current.ownerDocument:document:null},[n]),v=function(){var A,O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y=c()?[]:((A=u())===null||A===void 0||(A=A.getSettings())===null||A===void 0?void 0:A._initOnlySettings)||[],H=SettingsMapper.getSettings(r,{prevProps:D,isInit:O,initOnlySettingKeys:Y});return H.columns=l.columnsSettings.length?l.columnsSettings:H.columns,r.renderer?(H.renderer=l.getRendererWrapper(r.renderer),l.componentRendererColumns.set("global",!0)):H.renderer=r.hotRenderer||_getItem$2("text"),r.editor?H.editor=makeEditorClass(s,o):H.editor=r.hotEditor||_getItem$3("text"),H},m=function(A){var O,D;A&&((O=A.getPlugin("autoRowSize"))!==null&&O!==void 0&&O.enabled||(D=A.getPlugin("autoColumnSize"))!==null&&D!==void 0&&D.enabled)&&l.componentRendererColumns.size>0&&warn(AUTOSIZE_WARNING)};reactExports.useEffect(function(){var w=v(!0);return a.current=r,t.current=new Handsontable$1.Core(n.current,w),t.current.addHook("beforeViewRender",function(){l.clearPortalCache(),l.clearRenderedCellCache()}),t.current.addHook("afterViewRender",function(){l.pushCellPortalsIntoPortalManager()}),t.current.init(),m(t.current),displayObsoleteRenderersEditorsWarning(r.children)||displayChildrenOfTypeWarning(r.children,HotColumn),function(){var A;h(),(A=u())===null||A===void 0||A.destroy()}},[]),useUpdateEffect(function(){h();var w=u(),A=v(!1,a.current);a.current=r,w==null||w.updateSettings(A,!1),m(w),displayObsoleteRenderersEditorsWarning(r.children)}),reactExports.useImperativeHandle(e,function(){return{get hotElementRef(){return n.current},get hotInstance(){return u()}}});var E=reactExports.Children.toArray(r.children).filter(isHotColumn).map(function(w,A){return React.createElement(HotColumnContextProvider,{columnIndex:A,getOwnerDocument:g,key:A},w)}),_=getContainerAttributesProps(r),S=createEditorPortal(g(),r.editor);return React.createElement(reactExports.Fragment,null,React.createElement("div",Object.assign({ref:n},_),E),React.createElement(RenderersPortalManager,{ref:l.setRenderersPortalManagerRef}),React.createElement(EditorContextProvider,{hooksRef:s,hotCustomEditorInstanceRef:o},S))});HotTableInner.propTypes={style:PropTypes.object,id:PropTypes.string,className:PropTypes.string};var _excluded=["children"],HotTable=reactExports.forwardRef(function(r,e){var t,n=r.children,s=_objectWithoutProperties(r,_excluded),o=(t=s.id)!==null&&t!==void 0?t:reactExports.useId();return React.createElement(HotTableContextProvider,null,React.createElement(HotTableInner,Object.assign({id:o},s,{ref:e}),n))});HotTable.version=version;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ReferenceType;(function(r){r.RELATIVE="RELATIVE",r.ABSOLUTE="ABSOLUTE"})(ReferenceType||(ReferenceType={}));class ColumnAddress{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new ColumnAddress(ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new ColumnAddress(ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===ReferenceType.ABSOLUTE}isColumnRelative(){return this.type===ReferenceType.RELATIVE}isAbsolute(){return this.type===ReferenceType.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new ColumnAddress(this.type,this.col+t,s)}shiftedByColumns(e){return new ColumnAddress(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=absoluteSheetReference(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),simpleColumnAddress(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new ColumnAddress(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new ColumnAddress(this.type,n,this.sheet)}withSheet(e){return new ColumnAddress(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case ReferenceType.RELATIVE:return`${t}#COLR${this.col}`;case ReferenceType.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(invalidSimpleColumnAddress(t))return;const n=columnIndexToLabel(t.col);return`${this.type===ReferenceType.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowAddress{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new RowAddress(ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new RowAddress(ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===ReferenceType.ABSOLUTE}isRowRelative(){return this.type===ReferenceType.RELATIVE}isAbsolute(){return this.type===ReferenceType.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new RowAddress(this.type,this.row+n,s)}shiftedByRows(e){return new RowAddress(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=absoluteSheetReference(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),simpleRowAddress(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new RowAddress(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new RowAddress(this.type,n,this.sheet)}withSheet(e){return new RowAddress(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case ReferenceType.RELATIVE:return`${t}#ROWR${this.row}`;case ReferenceType.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return invalidSimpleRowAddress(t)?void 0:`${this.type===ReferenceType.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CellReferenceType;(function(r){r.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",r.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",r.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",r.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(CellReferenceType||(CellReferenceType={}));class CellAddress{constructor(e,t,n,s){this.col=e,this.row=t,this.type=n,this.sheet=s}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?CellAddress.absolute.bind(this):e.isColumnAbsolute()?CellAddress.absoluteCol.bind(this):t.isRowAbsolute()?CellAddress.absoluteRow.bind(this):CellAddress.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new CellAddress(e,t,CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=absoluteSheetReference(this,e);return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE?simpleCellAddress(t,this.col,this.row):this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW?simpleCellAddress(t,e.col+this.col,this.row):this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL?simpleCellAddress(t,this.col,e.row+this.row):simpleCellAddress(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?ReferenceType.RELATIVE:ReferenceType.ABSOLUTE;return new ColumnAddress(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?ReferenceType.RELATIVE:ReferenceType.ABSOLUTE;return new RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=absoluteSheetReference(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),simpleColumnAddress(t,n)}toSimpleRowAddress(e){const t=absoluteSheetReference(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),simpleRowAddress(t,n)}isRowAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===CellReferenceType.CELL_REFERENCE_RELATIVE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new CellAddress(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new CellAddress(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new CellAddress(this.col+t,this.row+n,this.type,s)}withSheet(e){return new CellAddress(this.col,this.row,this.type,e)}isInvalid(e){return invalidSimpleCellAddress(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,s=this.isRowAbsolute()?this.row:this.row+t;return new CellAddress(n,s,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,s=this.isRowRelative()?this.row:this.row+t;return new CellAddress(n,s,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case CellReferenceType.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(invalidSimpleCellAddress(t))return;const n=columnIndexToLabel(t.col),s=this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE||this.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${s}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const RANGE_OPERATOR=":",ABSOLUTE_OPERATOR="$",ALL_WHITESPACE_PATTERN="\\s+",ODFF_WHITESPACE_PATTERN="[ \\t\\n\\r]+",UNICODE_LETTER_PATTERN="A-Za-z-",NON_RESERVED_CHARACTER_PATTERN=`${UNICODE_LETTER_PATTERN}0-9_.`,UNQUOTED_SHEET_NAME_PATTERN=`[${UNICODE_LETTER_PATTERN}0-9_]+`,QUOTED_SHEET_NAME_PATTERN="'(((?!').|'')*)'",SHEET_NAME_PATTERN=`(${UNQUOTED_SHEET_NAME_PATTERN}|${QUOTED_SHEET_NAME_PATTERN})!`,CELL_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[A-Za-z]+\\${ABSOLUTE_OPERATOR}?[0-9]+`,COLUMN_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[A-Za-z]+`,ROW_REFERENCE_PATTERN=`(${SHEET_NAME_PATTERN})?\\${ABSOLUTE_OPERATOR}?[0-9]+`,R1C1_CELL_REFERENCE_PATTERN="[rR][0-9]*[cC][0-9]*",CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=`(${CELL_REFERENCE_PATTERN})[^${NON_RESERVED_CHARACTER_PATTERN}]`,NAMED_EXPRESSION_PATTERN=`[${UNICODE_LETTER_PATTERN}_][${NON_RESERVED_CHARACTER_PATTERN}]*`,ALL_DIGITS_ARRAY=["0","1","2","3","4","5","6","7","8","9"],ALL_UNICODE_LETTERS_ARRAY=[...Array.from(Array(26)).map((r,e)=>e+65),...Array.from(Array(26)).map((r,e)=>e+97),...Array.from(Array(496)).map((r,e)=>e+192)].map(r=>String.fromCharCode(r));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const addressRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${ABSOLUTE_OPERATOR}?)([0-9]+)$`),columnRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),rowRegex=new RegExp(`^(${SHEET_NAME_PATTERN})?(\\${ABSOLUTE_OPERATOR}?)([0-9]+)$`),simpleSheetNameRegex=new RegExp(`^${UNQUOTED_SHEET_NAME_PATTERN}$`),cellAddressFromString=(r,e,t)=>{const n=addressRegex.exec(e),s=columnLabelToIndex(n[6]);let o=extractSheetNumber(n,r);if(o===void 0)return;o===null&&(o=void 0);const a=Number(n[8])-1;return n[5]===ABSOLUTE_OPERATOR&&n[7]===ABSOLUTE_OPERATOR?CellAddress.absolute(s,a,o):n[5]===ABSOLUTE_OPERATOR?CellAddress.absoluteCol(s,a-t.row,o):n[7]===ABSOLUTE_OPERATOR?CellAddress.absoluteRow(s-t.col,a,o):CellAddress.relative(s-t.col,a-t.row,o)},columnAddressFromString=(r,e,t)=>{const n=columnRegex.exec(e);let s=extractSheetNumber(n,r);if(s===void 0)return;s===null&&(s=void 0);const o=columnLabelToIndex(n[6]);return n[5]===ABSOLUTE_OPERATOR?ColumnAddress.absolute(o,s):ColumnAddress.relative(o-t.col,s)},rowAddressFromString=(r,e,t)=>{const n=rowRegex.exec(e);let s=extractSheetNumber(n,r);if(s===void 0)return;s===null&&(s=void 0);const o=Number(n[6])-1;return n[5]===ABSOLUTE_OPERATOR?RowAddress.absolute(o,s):RowAddress.relative(o-t.row,s)},simpleCellAddressFromString=(r,e,t)=>{const n=addressRegex.exec(e);if(!n)return;const s=columnLabelToIndex(n[6]);let o=extractSheetNumber(n,r);if(o===void 0)return;o===null&&(o=t);const a=Number(n[8])-1;return simpleCellAddress(o,s,a)},simpleCellRangeFromString=(r,e,t)=>{const n=e.split(RANGE_OPERATOR);if(n.length!==2)return;const[s,o]=n,a=simpleCellAddressFromString(r,s,t);if(a===void 0)return;const l=simpleCellAddressFromString(r,o,a.sheet);if(l!==void 0&&a.sheet===l.sheet)return simpleCellRange(a,l)},simpleCellAddressToString=(r,e,t)=>{const n=columnIndexToLabel(e.col),s=sheetIndexToString(e.sheet,r);if(s!==void 0)return t!==e.sheet?`${s}!${n}${e.row+1}`:`${n}${e.row+1}`},simpleCellRangeToString=(r,e,t)=>{const n=simpleCellAddressToString(r,e.start,t),s=simpleCellAddressToString(r,e.end,e.start.sheet);if(!(n===void 0||s===void 0))return`${n}${RANGE_OPERATOR}${s}`};function columnLabelToIndex(r){return r.length===1?r.toUpperCase().charCodeAt(0)-65:r.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function columnIndexToLabel(r){let e="";for(;r>=0;)e=String.fromCharCode(r%26+97)+e,r=Math.floor(r/26)-1;return e.toUpperCase()}function sheetIndexToString(r,e){let t=e(r);if(t!==void 0)return simpleSheetNameRegex.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function extractSheetNumber(r,e){var t;let n=(t=r[3])!==null&&t!==void 0?t:r[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function isEmpty(r){return r&&r.length===0}function keys(r){return r==null?[]:Object.keys(r)}function values(r){for(var e=[],t=Object.keys(r),n=0;n<t.length;n++)e.push(r[t[n]]);return e}function mapValues(r,e){for(var t=[],n=keys(r),s=0;s<n.length;s++){var o=n[s];t.push(e.call(null,r[o],o))}return t}function map(r,e){for(var t=[],n=0;n<r.length;n++)t.push(e.call(null,r[n],n));return t}function flatten(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];Array.isArray(n)?e=e.concat(flatten(n)):e.push(n)}return e}function first$1(r){return isEmpty(r)?void 0:r[0]}function last(r){var e=r&&r.length;return e?r[e-1]:void 0}function forEach(r,e){if(Array.isArray(r))for(var t=0;t<r.length;t++)e.call(null,r[t],t);else if(isObject(r))for(var n=keys(r),t=0;t<n.length;t++){var s=n[t],o=r[s];e.call(null,o,s)}else throw Error("non exhaustive match")}function isString(r){return typeof r=="string"}function isUndefined(r){return r===void 0}function isFunction(r){return r instanceof Function}function drop(r,e){return e===void 0&&(e=1),r.slice(e,r.length)}function dropRight(r,e){return e===void 0&&(e=1),r.slice(0,r.length-e)}function filter(r,e){var t=[];if(Array.isArray(r))for(var n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function reject(r,e){return filter(r,function(t){return!e(t)})}function pick(r,e){for(var t=Object.keys(r),n={},s=0;s<t.length;s++){var o=t[s],a=r[o];e(a)&&(n[o]=a)}return n}function has(r,e){return isObject(r)?r.hasOwnProperty(e):!1}function contains(r,e){return find(r,function(t){return t===e})!==void 0}function cloneArr(r){for(var e=[],t=0;t<r.length;t++)e.push(r[t]);return e}function cloneObj(r){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}function find(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(e.call(null,n))return n}}function findAll(r,e){for(var t=[],n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function reduce(r,e,t){for(var n=Array.isArray(r),s=n?r:values(r),o=n?[]:keys(r),a=t,l=0;l<s.length;l++)a=e.call(null,a,s[l],n?l:o[l]);return a}function compact(r){return reject(r,function(e){return e==null})}function uniq(r,e){e===void 0&&(e=function(n){return n});var t=[];return reduce(r,function(n,s){var o=e(s);return contains(t,o)?n:(t.push(o),n.concat(s))},[])}function isArray(r){return Array.isArray(r)}function isRegExp(r){return r instanceof RegExp}function isObject(r){return r instanceof Object}function every(r,e){for(var t=0;t<r.length;t++)if(!e(r[t],t))return!1;return!0}function difference(r,e){return reject(r,function(t){return contains(e,t)})}function some(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return!0;return!1}function indexOf(r,e){for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function assign(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++)for(var s=e[n],o=keys(s),a=0;a<o.length;a++){var l=o[a];r[l]=s[l]}return r}function assignNoOverwrite(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++){var s=e[n];if(!isUndefined(s))for(var o=keys(s),a=0;a<o.length;a++){var l=o[a];has(r,l)||(r[l]=s[l])}}return r}function defaults(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return assignNoOverwrite.apply(null,[{}].concat(r))}function groupBy(r,e){var t={};return forEach(r,function(n){var s=e(n),o=t[s];o?o.push(n):t[s]=[n]}),t}function merge(r,e){for(var t=cloneObj(r),n=keys(e),s=0;s<n.length;s++){var o=n[s],a=e[o];t[o]=a}return t}function NOOP(){}function IDENTITY(r){return r}function packArray(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];e.push(n!==void 0?n:void 0)}return e}function PRINT_ERROR(r){console&&console.error&&console.error("Error: "+r)}function PRINT_WARNING(r){console&&console.warn&&console.warn("Warning: "+r)}function isES2015MapSupported(){return typeof Map=="function"}function applyMixins(r,e){e.forEach(function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(s){if(s!=="constructor"){var o=Object.getOwnPropertyDescriptor(n,s);o&&(o.get||o.set)?Object.defineProperty(r.prototype,s,o):r.prototype[s]=t.prototype[s]}})})}function toFastProperties(r){function e(){}e.prototype=r;var t=new e;function n(){return typeof t.bar}return n(),n(),r}function peek(r){return r[r.length-1]}function timer(r){var e=new Date().getTime(),t=r(),n=new Date().getTime(),s=n-e;return{time:s,value:t}}var regexpToAst$1={exports:{}},regexpToAst=regexpToAst$1.exports,hasRequiredRegexpToAst;function requireRegexpToAst(){return hasRequiredRegexpToAst||(hasRequiredRegexpToAst=1,function(r){(function(e,t){r.exports?r.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:regexpToAst,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(_){this.idx=_.idx,this.input=_.input,this.groupIdx=_.groupIdx},e.prototype.pattern=function(_){this.idx=0,this.input=_,this.groupIdx=0,this.consumeChar("/");var S=this.disjunction();this.consumeChar("/");for(var w={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":l(w,"global");break;case"i":l(w,"ignoreCase");break;case"m":l(w,"multiLine");break;case"u":l(w,"unicode");break;case"y":l(w,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:w,value:S}},e.prototype.disjunction=function(){var _=[];for(_.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),_.push(this.alternative());return{type:"Disjunction",value:_}},e.prototype.alternative=function(){for(var _=[];this.isTerm();)_.push(this.term());return{type:"Alternative",value:_}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var _;switch(this.popChar()){case"=":_="Lookahead";break;case"!":_="NegativeLookahead";break}u(_);var S=this.disjunction();return this.consumeChar(")"),{type:_,value:S}}c()},e.prototype.quantifier=function(_){var S;switch(this.popChar()){case"*":S={atLeast:0,atMost:1/0};break;case"+":S={atLeast:1,atMost:1/0};break;case"?":S={atLeast:0,atMost:1};break;case"{":var w=this.integerIncludingZero();switch(this.popChar()){case"}":S={atLeast:w,atMost:w};break;case",":var A;this.isDigit()?(A=this.integerIncludingZero(),S={atLeast:w,atMost:A}):S={atLeast:w,atMost:1/0},this.consumeChar("}");break}if(_===!0&&S===void 0)return;u(S);break}if(!(_===!0&&S===void 0))return u(S),this.peekChar(0)==="?"?(this.consumeChar("?"),S.greedy=!1):S.greedy=!0,S.type="Quantifier",S},e.prototype.atom=function(){var _;switch(this.peekChar()){case".":_=this.dotAll();break;case"\\":_=this.atomEscape();break;case"[":_=this.characterClass();break;case"(":_=this.group();break}return _===void 0&&this.isPatternCharacter()&&(_=this.patternCharacter()),u(_),this.isQuantifier()&&(_.quantifier=this.quantifier()),_},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o(`
`),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var _=this.positiveInteger();return{type:"GroupBackReference",value:_}},e.prototype.characterClassEscape=function(){var _,S=!1;switch(this.popChar()){case"d":_=g;break;case"D":_=g,S=!0;break;case"s":_=m;break;case"S":_=m,S=!0;break;case"w":_=v;break;case"W":_=v,S=!0;break}return u(_),{type:"Set",value:_,complement:S}},e.prototype.controlEscapeAtom=function(){var _;switch(this.popChar()){case"f":_=o("\f");break;case"n":_=o(`
`);break;case"r":_=o("\r");break;case"t":_=o("	");break;case"v":_=o("\v");break}return u(_),{type:"Character",value:_}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var _=this.popChar();if(/[a-zA-Z]/.test(_)===!1)throw Error("Invalid ");var S=_.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:S}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var _=this.popChar();return{type:"Character",value:o(_)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var _=this.popChar();return{type:"Character",value:o(_)}}},e.prototype.characterClass=function(){var _=[],S=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),S=!0);this.isClassAtom();){var w=this.classAtom(),A=w.type==="Character";if(A&&this.isRangeDash()){this.consumeChar("-");var O=this.classAtom(),D=O.type==="Character";if(D){if(O.value<w.value)throw Error("Range out of order in character class");_.push({from:w.value,to:O.value})}else a(w.value,_),_.push(o("-")),a(O.value,_)}else a(w.value,_)}return this.consumeChar("]"),{type:"Set",complement:S,value:_}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var _=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),_=!1;break;default:this.groupIdx++;break}var S=this.disjunction();this.consumeChar(")");var w={type:"Group",capturing:_,value:S};return _&&(w.idx=this.groupIdx),w},e.prototype.positiveInteger=function(){var _=this.popChar();if(s.test(_)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)_+=this.popChar();return parseInt(_,10)},e.prototype.integerIncludingZero=function(){var _=this.popChar();if(n.test(_)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)_+=this.popChar();return parseInt(_,10)},e.prototype.patternCharacter=function(){var _=this.popChar();switch(_){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(_)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(_){switch(_===void 0&&(_=0),this.peekChar(_)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var _=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(_)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(_){for(var S="",w=0;w<_;w++){var A=this.popChar();if(t.test(A)===!1)throw Error("Expecting a HexDecimal digits");S+=A}var O=parseInt(S,16);return{type:"Character",value:O}},e.prototype.peekChar=function(_){return _===void 0&&(_=0),this.input[this.idx+_]},e.prototype.popChar=function(){var _=this.peekChar(0);return this.consumeChar(),_},e.prototype.consumeChar=function(_){if(_!==void 0&&this.input[this.idx]!==_)throw Error("Expected: '"+_+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,n=/[0-9]/,s=/[1-9]/;function o(_){return _.charCodeAt(0)}function a(_,S){_.length!==void 0?_.forEach(function(w){S.push(w)}):S.push(_)}function l(_,S){if(_[S]===!0)throw"duplicate flag "+S;_[S]=!0}function u(_){if(_===void 0)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}var h,g=[];for(h=o("0");h<=o("9");h++)g.push(h);var v=[o("_")].concat(g);for(h=o("a");h<=o("z");h++)v.push(h);for(h=o("A");h<=o("Z");h++)v.push(h);var m=[o(" "),o("\f"),o(`
`),o("\r"),o("	"),o("\v"),o("	"),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o(""),o("\u2028"),o("\u2029"),o(""),o(""),o(""),o("\uFEFF")];function E(){}return E.prototype.visitChildren=function(_){for(var S in _){var w=_[S];_.hasOwnProperty(S)&&(w.type!==void 0?this.visit(w):Array.isArray(w)&&w.forEach(function(A){this.visit(A)},this))}},E.prototype.visit=function(_){switch(_.type){case"Pattern":this.visitPattern(_);break;case"Flags":this.visitFlags(_);break;case"Disjunction":this.visitDisjunction(_);break;case"Alternative":this.visitAlternative(_);break;case"StartAnchor":this.visitStartAnchor(_);break;case"EndAnchor":this.visitEndAnchor(_);break;case"WordBoundary":this.visitWordBoundary(_);break;case"NonWordBoundary":this.visitNonWordBoundary(_);break;case"Lookahead":this.visitLookahead(_);break;case"NegativeLookahead":this.visitNegativeLookahead(_);break;case"Character":this.visitCharacter(_);break;case"Set":this.visitSet(_);break;case"Group":this.visitGroup(_);break;case"GroupBackReference":this.visitGroupBackReference(_);break;case"Quantifier":this.visitQuantifier(_);break}this.visitChildren(_)},E.prototype.visitPattern=function(_){},E.prototype.visitFlags=function(_){},E.prototype.visitDisjunction=function(_){},E.prototype.visitAlternative=function(_){},E.prototype.visitStartAnchor=function(_){},E.prototype.visitEndAnchor=function(_){},E.prototype.visitWordBoundary=function(_){},E.prototype.visitNonWordBoundary=function(_){},E.prototype.visitLookahead=function(_){},E.prototype.visitNegativeLookahead=function(_){},E.prototype.visitCharacter=function(_){},E.prototype.visitSet=function(_){},E.prototype.visitGroup=function(_){},E.prototype.visitGroupBackReference=function(_){},E.prototype.visitQuantifier=function(_){},{RegExpParser:e,BaseRegExpVisitor:E,VERSION:"0.4.0"}})}(regexpToAst$1)),regexpToAst$1.exports}var regexpToAstExports=requireRegexpToAst(),regExpAstCache={},regExpParser=new regexpToAstExports.RegExpParser;function getRegExpAst(r){var e=r.toString();if(regExpAstCache.hasOwnProperty(e))return regExpAstCache[e];var t=regExpParser.pattern(e);return regExpAstCache[e]=t,t}function clearRegExpParserCache(){regExpAstCache={}}var __extends$a=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),complementErrorMessage="Complement Sets are not supported for first char optimization",failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function getOptimizedStartCodesIndices(r,e){e===void 0&&(e=!1);try{var t=getRegExpAst(r),n=firstCharOptimizedIndices(t.value,{},t.flags.ignoreCase);return n}catch(o){if(o.message===complementErrorMessage)e&&PRINT_WARNING(""+failedOptimizationPrefixMsg+("	Unable to optimize: < "+r.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var s="";e&&(s=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),PRINT_ERROR(failedOptimizationPrefixMsg+`
`+("	Failed parsing: < "+r.toString()+` >
`)+("	Using the regexp-to-ast library version: "+regexpToAstExports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+s)}}return[]}function firstCharOptimizedIndices(r,e,t){switch(r.type){case"Disjunction":for(var n=0;n<r.value.length;n++)firstCharOptimizedIndices(r.value[n],e,t);break;case"Alternative":for(var s=r.value,n=0;n<s.length;n++){var o=s[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=o;switch(a.type){case"Character":addOptimizedIdxToResult(a.value,e,t);break;case"Set":if(a.complement===!0)throw Error(complementErrorMessage);forEach(a.value,function(c){if(typeof c=="number")addOptimizedIdxToResult(c,e,t);else{var h=c;if(t===!0)for(var g=h.from;g<=h.to;g++)addOptimizedIdxToResult(g,e,t);else{for(var g=h.from;g<=h.to&&g<minOptimizationVal;g++)addOptimizedIdxToResult(g,e,t);if(h.to>=minOptimizationVal)for(var v=h.from>=minOptimizationVal?h.from:minOptimizationVal,m=h.to,E=charCodeToOptimizedIndex(v),_=charCodeToOptimizedIndex(m),S=E;S<=_;S++)e[S]=S}}});break;case"Group":firstCharOptimizedIndices(a.value,e,t);break;default:throw Error("Non Exhaustive Match")}var l=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&isWholeOptional(a)===!1||a.type!=="Group"&&l===!1)break}break;default:throw Error("non exhaustive match!")}return values(e)}function addOptimizedIdxToResult(r,e,t){var n=charCodeToOptimizedIndex(r);e[n]=n,t===!0&&handleIgnoreCase(r,e)}function handleIgnoreCase(r,e){var t=String.fromCharCode(r),n=t.toUpperCase();if(n!==t){var s=charCodeToOptimizedIndex(n.charCodeAt(0));e[s]=s}else{var o=t.toLowerCase();if(o!==t){var s=charCodeToOptimizedIndex(o.charCodeAt(0));e[s]=s}}}function findCode(r,e){return find(r.value,function(t){if(typeof t=="number")return contains(e,t);var n=t;return find(e,function(s){return n.from<=s&&s<=n.to})!==void 0})}function isWholeOptional(r){return r.quantifier&&r.quantifier.atLeast===0?!0:r.value?isArray(r.value)?every(r.value,isWholeOptional):isWholeOptional(r.value):!1}var CharCodeFinder=function(r){__extends$a(e,r);function e(t){var n=r.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}r.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){contains(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?findCode(t,this.targetCharCodes)===void 0&&(this.found=!0):findCode(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(regexpToAstExports.BaseRegExpVisitor);function canMatchCharCode(r,e){if(e instanceof RegExp){var t=getRegExpAst(e),n=new CharCodeFinder(r);return n.visit(t),n.found}else return find(e,function(s){return contains(r,s.charCodeAt(0))})!==void 0}var __extends$9=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),PATTERN="PATTERN",DEFAULT_MODE="defaultMode",MODES="modes",SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function analyzeTokenTypes(r,e){e=defaults(e,{useSticky:SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(A,O){return O()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){initCharCodeToOptimizedIndexMap()});var n;t("Reject Lexer.NA",function(){n=reject(r,function(A){return A[PATTERN]===Lexer.NA})});var s=!1,o;t("Transform Patterns",function(){s=!1,o=map(n,function(A){var O=A[PATTERN];if(isRegExp(O)){var D=O.source;return D.length===1&&D!=="^"&&D!=="$"&&D!=="."?D:D.length===2&&D[0]==="\\"&&!contains(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],D[1])?D[1]:e.useSticky?addStickyFlag(O):addStartOfInput(O)}else{if(isFunction(O))return s=!0,{exec:O};if(has(O,"exec"))return s=!0,O;if(typeof O=="string"){if(O.length===1)return O;var Y=O.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),H=new RegExp(Y);return e.useSticky?addStickyFlag(H):addStartOfInput(H)}else throw Error("non exhaustive match")}})});var a,l,u,c,h;t("misc mapping",function(){a=map(n,function(A){return A.tokenTypeIdx}),l=map(n,function(A){var O=A.GROUP;if(O!==Lexer.SKIPPED){if(isString(O))return O;if(isUndefined(O))return!1;throw Error("non exhaustive match")}}),u=map(n,function(A){var O=A.LONGER_ALT;if(O){var D=indexOf(n,O);return D}}),c=map(n,function(A){return A.PUSH_MODE}),h=map(n,function(A){return has(A,"POP_MODE")})});var g;t("Line Terminator Handling",function(){var A=getCharCodes(e.lineTerminatorCharacters);g=map(n,function(O){return!1}),e.positionTracking!=="onlyOffset"&&(g=map(n,function(O){if(has(O,"LINE_BREAKS"))return O.LINE_BREAKS;if(checkLineBreaksIssues(O,A)===!1)return canMatchCharCode(A,O.PATTERN)}))});var v,m,E,_;t("Misc Mapping #2",function(){v=map(n,isCustomPattern),m=map(o,isShortPattern),E=reduce(n,function(A,O){var D=O.GROUP;return isString(D)&&D!==Lexer.SKIPPED&&(A[D]=[]),A},{}),_=map(o,function(A,O){return{pattern:o[O],longerAlt:u[O],canLineTerminator:g[O],isCustom:v[O],short:m[O],group:l[O],push:c[O],pop:h[O],tokenTypeIdx:a[O],tokenType:n[O]}})});var S=!0,w=[];return e.safeMode||t("First Char Optimization",function(){w=reduce(n,function(A,O,D){if(typeof O.PATTERN=="string"){var Y=O.PATTERN.charCodeAt(0),H=charCodeToOptimizedIndex(Y);addToMapOfArrays(A,H,_[D])}else if(isArray(O.START_CHARS_HINT)){var k;forEach(O.START_CHARS_HINT,function(se){var re=typeof se=="string"?se.charCodeAt(0):se,Ce=charCodeToOptimizedIndex(re);k!==Ce&&(k=Ce,addToMapOfArrays(A,Ce,_[D]))})}else if(isRegExp(O.PATTERN))if(O.PATTERN.unicode)S=!1,e.ensureOptimizations&&PRINT_ERROR(""+failedOptimizationPrefixMsg+("	Unable to analyze < "+O.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var K=getOptimizedStartCodesIndices(O.PATTERN,e.ensureOptimizations);isEmpty(K)&&(S=!1),forEach(K,function(se){addToMapOfArrays(A,se,_[D])})}else e.ensureOptimizations&&PRINT_ERROR(""+failedOptimizationPrefixMsg+("	TokenType: <"+O.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),S=!1;return A},[])}),t("ArrayPacking",function(){w=packArray(w)}),{emptyGroups:E,patternIdxToConfig:_,charCodeToPatternIdxToConfig:w,hasCustom:s,canBeOptimized:S}}function validatePatterns(r,e){var t=[],n=findMissingPatterns(r);t=t.concat(n.errors);var s=findInvalidPatterns(n.valid),o=s.valid;return t=t.concat(s.errors),t=t.concat(validateRegExpPattern(o)),t=t.concat(findInvalidGroupType(o)),t=t.concat(findModesThatDoNotExist(o,e)),t=t.concat(findUnreachablePatterns(o)),t}function validateRegExpPattern(r){var e=[],t=filter(r,function(n){return isRegExp(n[PATTERN])});return e=e.concat(findEndOfInputAnchor(t)),e=e.concat(findStartOfInputAnchor(t)),e=e.concat(findUnsupportedFlags(t)),e=e.concat(findDuplicatePatterns(t)),e=e.concat(findEmptyMatchRegExps(t)),e}function findMissingPatterns(r){var e=filter(r,function(s){return!has(s,PATTERN)}),t=map(e,function(s){return{message:"Token Type: ->"+s.name+"<- missing static 'PATTERN' property",type:LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[s]}}),n=difference(r,e);return{errors:t,valid:n}}function findInvalidPatterns(r){var e=filter(r,function(s){var o=s[PATTERN];return!isRegExp(o)&&!isFunction(o)&&!has(o,"exec")&&!isString(o)}),t=map(e,function(s){return{message:"Token Type: ->"+s.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[s]}}),n=difference(r,e);return{errors:t,valid:n}}var end_of_input=/[^\\][\$]/;function findEndOfInputAnchor(r){var e=function(s){__extends$9(o,s);function o(){var a=s!==null&&s.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitEndAnchor=function(a){this.found=!0},o}(regexpToAstExports.BaseRegExpVisitor),t=filter(r,function(s){var o=s[PATTERN];try{var a=getRegExpAst(o),l=new e;return l.visit(a),l.found}catch{return end_of_input.test(o.source)}}),n=map(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function findEmptyMatchRegExps(r){var e=filter(r,function(n){var s=n[PATTERN];return s.test("")}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return t}var start_of_input=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(r){var e=function(s){__extends$9(o,s);function o(){var a=s!==null&&s.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitStartAnchor=function(a){this.found=!0},o}(regexpToAstExports.BaseRegExpVisitor),t=filter(r,function(s){var o=s[PATTERN];try{var a=getRegExpAst(o),l=new e;return l.visit(a),l.found}catch{return start_of_input.test(o.source)}}),n=map(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function findUnsupportedFlags(r){var e=filter(r,function(n){var s=n[PATTERN];return s instanceof RegExp&&(s.multiline||s.global)}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return t}function findDuplicatePatterns(r){var e=[],t=map(r,function(o){return reduce(r,function(a,l){return o.PATTERN.source===l.PATTERN.source&&!contains(e,l)&&l.PATTERN!==Lexer.NA&&(e.push(l),a.push(l)),a},[])});t=compact(t);var n=filter(t,function(o){return o.length>1}),s=map(n,function(o){var a=map(o,function(u){return u.name}),l=first$1(o).PATTERN;return{message:"The same RegExp pattern ->"+l+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}});return s}function findInvalidGroupType(r){var e=filter(r,function(n){if(!has(n,"GROUP"))return!1;var s=n.GROUP;return s!==Lexer.SKIPPED&&s!==Lexer.NA&&!isString(s)}),t=map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return t}function findModesThatDoNotExist(r,e){var t=filter(r,function(s){return s.PUSH_MODE!==void 0&&!contains(e,s.PUSH_MODE)}),n=map(t,function(s){var o="Token Type: ->"+s.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+s.PUSH_MODE+"<-which does not exist";return{message:o,type:LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[s]}});return n}function findUnreachablePatterns(r){var e=[],t=reduce(r,function(n,s,o){var a=s.PATTERN;return a===Lexer.NA||(isString(a)?n.push({str:a,idx:o,tokenType:s}):isRegExp(a)&&noMetaChar(a)&&n.push({str:a.source,idx:o,tokenType:s})),n},[]);return forEach(r,function(n,s){forEach(t,function(o){var a=o.str,l=o.idx,u=o.tokenType;if(s<l&&testTokenType(a,n.PATTERN)){var c="Token: ->"+u.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[n,u]})}})}),e}function testTokenType(r,e){if(isRegExp(e)){var t=e.exec(r);return t!==null&&t.index===0}else{if(isFunction(e))return e(r,0,[],{});if(has(e,"exec"))return e.exec(r,0,[],{});if(typeof e=="string")return e===r;throw Error("non exhaustive match")}}function noMetaChar(r){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return find(e,function(t){return r.source.indexOf(t)!==-1})===void 0}function addStartOfInput(r){var e=r.ignoreCase?"i":"";return new RegExp("^(?:"+r.source+")",e)}function addStickyFlag(r){var e=r.ignoreCase?"iy":"y";return new RegExp(""+r.source,e)}function performRuntimeChecks(r,e,t){var n=[];return has(r,DEFAULT_MODE)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+DEFAULT_MODE+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),has(r,MODES)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+MODES+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),has(r,MODES)&&has(r,DEFAULT_MODE)&&!has(r.modes,r.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+DEFAULT_MODE+": <"+r.defaultMode+`>which does not exist
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),has(r,MODES)&&forEach(r.modes,function(s,o){forEach(s,function(a,l){isUndefined(a)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+o+"> at index: <"+l+`>
`),type:LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function performWarningRuntimeChecks(r,e,t){var n=[],s=!1,o=compact(flatten(mapValues(r.modes,function(u){return u}))),a=reject(o,function(u){return u[PATTERN]===Lexer.NA}),l=getCharCodes(t);return e&&forEach(a,function(u){var c=checkLineBreaksIssues(u,l);if(c!==!1){var h=buildLineBreakIssueMessage(u,c),g={message:h,type:c.issue,tokenType:u};n.push(g)}else has(u,"LINE_BREAKS")?u.LINE_BREAKS===!0&&(s=!0):canMatchCharCode(l,u.PATTERN)&&(s=!0)}),e&&!s&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function cloneEmptyGroups(r){var e={},t=keys(r);return forEach(t,function(n){var s=r[n];if(isArray(s))e[n]=[];else throw Error("non exhaustive match")}),e}function isCustomPattern(r){var e=r.PATTERN;if(isRegExp(e))return!1;if(isFunction(e))return!0;if(has(e,"exec"))return!0;if(isString(e))return!1;throw Error("non exhaustive match")}function isShortPattern(r){return isString(r)&&r.length===1?r.charCodeAt(0):!1}var LineTerminatorOptimizedTester={test:function(r){for(var e=r.length,t=this.lastIndex;t<e;t++){var n=r.charCodeAt(t);if(n===10)return this.lastIndex=t+1,!0;if(n===13)return r.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function checkLineBreaksIssues(r,e){if(has(r,"LINE_BREAKS"))return!1;if(isRegExp(r.PATTERN)){try{canMatchCharCode(e,r.PATTERN)}catch(t){return{issue:LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(isString(r.PATTERN))return!1;if(isCustomPattern(r))return{issue:LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function buildLineBreakIssueMessage(r,e){if(e.issue===LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+r.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+r.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function getCharCodes(r){var e=map(r,function(t){return isString(t)&&t.length>0?t.charCodeAt(0):t});return e}function addToMapOfArrays(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}var minOptimizationVal=256;function charCodeToOptimizedIndex(r){return r<minOptimizationVal?r:charCodeToOptimizedIdxMap[r]}var charCodeToOptimizedIdxMap=[];function initCharCodeToOptimizedIndexMap(){if(isEmpty(charCodeToOptimizedIdxMap)){charCodeToOptimizedIdxMap=new Array(65536);for(var r=0;r<65536;r++)charCodeToOptimizedIdxMap[r]=r>255?255+~~(r/255):r}}function tokenStructuredMatcher(r,e){var t=r.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function tokenStructuredMatcherNoCategories(r,e){return r.tokenTypeIdx===e.tokenTypeIdx}var tokenShortNameIdx=1,tokenIdxToClass={};function augmentTokenTypes(r){var e=expandCategories(r);assignTokenDefaultProps(e),assignCategoriesMapProp(e),assignCategoriesTokensProp(e),forEach(e,function(t){t.isParent=t.categoryMatches.length>0})}function expandCategories(r){for(var e=cloneArr(r),t=r,n=!0;n;){t=compact(flatten(map(t,function(o){return o.CATEGORIES})));var s=difference(t,e);e=e.concat(s),isEmpty(s)?n=!1:t=s}return e}function assignTokenDefaultProps(r){forEach(r,function(e){hasShortKeyProperty(e)||(tokenIdxToClass[tokenShortNameIdx]=e,e.tokenTypeIdx=tokenShortNameIdx++),hasCategoriesProperty(e)&&!isArray(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),hasCategoriesProperty(e)||(e.CATEGORIES=[]),hasExtendingTokensTypesProperty(e)||(e.categoryMatches=[]),hasExtendingTokensTypesMapProperty(e)||(e.categoryMatchesMap={})})}function assignCategoriesTokensProp(r){forEach(r,function(e){e.categoryMatches=[],forEach(e.categoryMatchesMap,function(t,n){e.categoryMatches.push(tokenIdxToClass[n].tokenTypeIdx)})})}function assignCategoriesMapProp(r){forEach(r,function(e){singleAssignCategoriesToksMap([],e)})}function singleAssignCategoriesToksMap(r,e){forEach(r,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),forEach(e.CATEGORIES,function(t){var n=r.concat(e);contains(n,t)||singleAssignCategoriesToksMap(n,t)})}function hasShortKeyProperty(r){return has(r,"tokenTypeIdx")}function hasCategoriesProperty(r){return has(r,"CATEGORIES")}function hasExtendingTokensTypesProperty(r){return has(r,"categoryMatches")}function hasExtendingTokensTypesMapProperty(r){return has(r,"categoryMatchesMap")}function isTokenType(r){return has(r,"tokenTypeIdx")}var defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->"+r.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(r,e,t,n,s){return"unexpected character: ->"+r.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},LexerDefinitionErrorType;(function(r){r[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(LexerDefinitionErrorType||(LexerDefinitionErrorType={}));var DEFAULT_LEXER_CONFIG={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(DEFAULT_LEXER_CONFIG);var Lexer=function(){function r(e,t){var n=this;if(t===void 0&&(t=DEFAULT_LEXER_CONFIG),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=merge(DEFAULT_LEXER_CONFIG,t);var s=this.config.traceInitPerf;s===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof s=="number"&&(this.traceInitMaxIdent=s,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===DEFAULT_LEXER_CONFIG.lineTerminatorsPattern)n.config.lineTerminatorsPattern=LineTerminatorOptimizedTester;else if(n.config.lineTerminatorCharacters===DEFAULT_LEXER_CONFIG.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),isArray(e)?(o={modes:{}},o.modes[DEFAULT_MODE]=cloneArr(e),o[DEFAULT_MODE]=DEFAULT_MODE):(a=!1,o=cloneObj(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(performRuntimeChecks(o,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(performWarningRuntimeChecks(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),o.modes=o.modes?o.modes:{},forEach(o.modes,function(h,g){o.modes[g]=reject(h,function(v){return isUndefined(v)})});var l=keys(o.modes);if(forEach(o.modes,function(h,g){n.TRACE_INIT("Mode: <"+g+"> processing",function(){if(n.modes.push(g),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(validatePatterns(h,l))}),isEmpty(n.lexerDefinitionErrors)){augmentTokenTypes(h);var v;n.TRACE_INIT("analyzeTokenTypes",function(){v=analyzeTokenTypes(h,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[g]=v.patternIdxToConfig,n.charCodeToPatternIdxToConfig[g]=v.charCodeToPatternIdxToConfig,n.emptyGroups=merge(n.emptyGroups,v.emptyGroups),n.hasCustom=v.hasCustom||n.hasCustom,n.canModeBeOptimized[g]=v.canBeOptimized}})}),n.defaultMode=o.defaultMode,!isEmpty(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var u=map(n.lexerDefinitionErrors,function(h){return h.message}),c=u.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}forEach(n.lexerDefinitionWarning,function(h){PRINT_WARNING(h.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(SUPPORT_STICKY?(n.chopInput=IDENTITY,n.match=n.matchWithTest):(n.updateLastIndex=NOOP,n.match=n.matchWithExec),a&&(n.handleModes=NOOP),n.trackStartLines===!1&&(n.computeNewColumn=IDENTITY),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=NOOP),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var h=reduce(n.canModeBeOptimized,function(g,v,m){return v===!1&&g.push(m),g},[]);if(t.ensureOptimizations&&!isEmpty(h))throw Error("Lexer Modes: < "+h.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){clearRegExpParserCache()}),n.TRACE_INIT("toFastProperties",function(){toFastProperties(n)})})}return r.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!isEmpty(this.lexerDefinitionErrors)){var n=map(this.lexerDefinitionErrors,function(a){return a.message}),s=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+s)}var o=this.tokenizeInternal(e,t);return o},r.prototype.tokenizeInternal=function(e,t){var n=this,s,o,a,l,u,c,h,g,v,m,E,_,S,w,A=e,O=A.length,D=0,Y=0,H=this.hasCustom?0:Math.floor(e.length/10),k=new Array(H),K=[],se=this.trackStartLines?1:void 0,re=this.trackStartLines?1:void 0,Ce=cloneEmptyGroups(this.emptyGroups),Le=this.trackStartLines,he=this.config.lineTerminatorsPattern,ve=0,xe=[],Ie=[],we=[],Ne=[];Object.freeze(Ne);var at=void 0;function nt(){return xe}function B(Qe){var st=charCodeToOptimizedIndex(Qe),St=Ie[st];return St===void 0?Ne:St}var te=function(Qe){if(we.length===1&&Qe.tokenType.PUSH_MODE===void 0){var st=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Qe);K.push({offset:Qe.startOffset,line:Qe.startLine!==void 0?Qe.startLine:void 0,column:Qe.startColumn!==void 0?Qe.startColumn:void 0,length:Qe.image.length,message:st})}else{we.pop();var St=last(we);xe=n.patternIdxToConfig[St],Ie=n.charCodeToPatternIdxToConfig[St],ve=xe.length;var At=n.canModeBeOptimized[St]&&n.config.safeMode===!1;Ie&&At?at=B:at=nt}};function V(Qe){we.push(Qe),Ie=this.charCodeToPatternIdxToConfig[Qe],xe=this.patternIdxToConfig[Qe],ve=xe.length,ve=xe.length;var st=this.canModeBeOptimized[Qe]&&this.config.safeMode===!1;Ie&&st?at=B:at=nt}V.call(this,t);for(var ue;D<O;){u=null;var Ae=A.charCodeAt(D),Ve=at(Ae),He=Ve.length;for(s=0;s<He;s++){ue=Ve[s];var be=ue.pattern;c=null;var qe=ue.short;if(qe!==!1?Ae===qe&&(u=be):ue.isCustom===!0?(w=be.exec(A,D,k,Ce),w!==null?(u=w[0],w.payload!==void 0&&(c=w.payload)):u=null):(this.updateLastIndex(be,D),u=this.match(be,e,D)),u!==null){if(l=ue.longerAlt,l!==void 0){var le=xe[l],pe=le.pattern;h=null,le.isCustom===!0?(w=pe.exec(A,D,k,Ce),w!==null?(a=w[0],w.payload!==void 0&&(h=w.payload)):a=null):(this.updateLastIndex(pe,D),a=this.match(pe,e,D)),a&&a.length>u.length&&(u=a,c=h,ue=le)}break}}if(u!==null){if(g=u.length,v=ue.group,v!==void 0&&(m=ue.tokenTypeIdx,E=this.createTokenInstance(u,D,m,ue.tokenType,se,re,g),this.handlePayload(E,c),v===!1?Y=this.addToken(k,Y,E):Ce[v].push(E)),e=this.chopInput(e,g),D=D+g,re=this.computeNewColumn(re,g),Le===!0&&ue.canLineTerminator===!0){var Se=0,Ye=void 0,Fe=void 0;he.lastIndex=0;do Ye=he.test(u),Ye===!0&&(Fe=he.lastIndex-1,Se++);while(Ye===!0);Se!==0&&(se=se+Se,re=g-Fe,this.updateTokenEndLineColumnLocation(E,v,Fe,Se,se,re,g))}this.handleModes(ue,te,V,E)}else{for(var je=D,rt=se,Ue=re,Xe=!1;!Xe&&D<O;)for(A.charCodeAt(D),e=this.chopInput(e,1),D++,o=0;o<ve;o++){var et=xe[o],be=et.pattern,qe=et.short;if(qe!==!1?A.charCodeAt(D)===qe&&(Xe=!0):et.isCustom===!0?Xe=be.exec(A,D,k,Ce)!==null:(this.updateLastIndex(be,D),Xe=be.exec(e)!==null),Xe===!0)break}_=D-je,S=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(A,je,_,rt,Ue),K.push({offset:je,line:rt,column:Ue,length:_,message:S})}}return this.hasCustom||(k.length=Y),{tokens:k,groups:Ce,errors:K}},r.prototype.handleModes=function(e,t,n,s){if(e.pop===!0){var o=e.push;t(s),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)},r.prototype.chopInput=function(e,t){return e.substring(t)},r.prototype.updateLastIndex=function(e,t){e.lastIndex=t},r.prototype.updateTokenEndLineColumnLocation=function(e,t,n,s,o,a,l){var u,c;t!==void 0&&(u=n===l-1,c=u?-1:0,s===1&&u===!0||(e.endLine=o+c,e.endColumn=a-1+-c))},r.prototype.computeNewColumn=function(e,t){return e+t},r.prototype.createTokenInstance=function(){return null},r.prototype.createOffsetOnlyToken=function(e,t,n,s){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:s}},r.prototype.createStartOnlyToken=function(e,t,n,s,o,a){return{image:e,startOffset:t,startLine:o,startColumn:a,tokenTypeIdx:n,tokenType:s}},r.prototype.createFullToken=function(e,t,n,s,o,a,l){return{image:e,startOffset:t,endOffset:t+l-1,startLine:o,endLine:o,startColumn:a,endColumn:a+l-1,tokenTypeIdx:n,tokenType:s}},r.prototype.addToken=function(e,t,n){return 666},r.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},r.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,t++,t},r.prototype.handlePayload=function(e,t){},r.prototype.handlePayloadNoCustom=function(e,t){},r.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},r.prototype.match=function(e,t,n){return null},r.prototype.matchWithTest=function(e,t,n){var s=e.test(t);return s===!0?t.substring(n,e.lastIndex):null},r.prototype.matchWithExec=function(e,t){var n=e.exec(t);return n!==null?n[0]:n},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=timer(t),o=s.time,a=s.value,l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return t()},r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",r.NA=/NOT_APPLICABLE/,r}();function tokenLabel(r){return hasTokenLabel(r)?r.LABEL:r.name}function hasTokenLabel(r){return isString(r.LABEL)&&r.LABEL!==""}var PARENT="parent",CATEGORIES="categories",LABEL="label",GROUP="group",PUSH_MODE="push_mode",POP_MODE="pop_mode",LONGER_ALT="longer_alt",LINE_BREAKS="line_breaks",START_CHARS_HINT="start_chars_hint";function createToken(r){return createTokenInternal(r)}function createTokenInternal(r){var e=r.pattern,t={};if(t.name=r.name,isUndefined(e)||(t.PATTERN=e),has(r,PARENT))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return has(r,CATEGORIES)&&(t.CATEGORIES=r[CATEGORIES]),augmentTokenTypes([t]),has(r,LABEL)&&(t.LABEL=r[LABEL]),has(r,GROUP)&&(t.GROUP=r[GROUP]),has(r,POP_MODE)&&(t.POP_MODE=r[POP_MODE]),has(r,PUSH_MODE)&&(t.PUSH_MODE=r[PUSH_MODE]),has(r,LONGER_ALT)&&(t.LONGER_ALT=r[LONGER_ALT]),has(r,LINE_BREAKS)&&(t.LINE_BREAKS=r[LINE_BREAKS]),has(r,START_CHARS_HINT)&&(t.START_CHARS_HINT=r[START_CHARS_HINT]),t}var EOF=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([EOF]);function createTokenInstance(r,e,t,n,s,o,a,l){return{image:e,startOffset:t,endOffset:n,startLine:s,endLine:o,startColumn:a,endColumn:l,tokenTypeIdx:r.tokenTypeIdx,tokenType:r}}function tokenMatcher(r,e){return tokenStructuredMatcher(r,e)}var __extends$8=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AbstractProduction=function(){function r(e){this.definition=e}return r.prototype.accept=function(e){e.visit(this),forEach(this.definition,function(t){t.accept(e)})},r}(),NonTerminal=function(r){__extends$8(e,r);function e(t){var n=r.call(this,[])||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(AbstractProduction),Rule=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.orgText="",assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Flat=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Option$1=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionMandatory=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionMandatoryWithSeparator=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Repetition=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),RepetitionWithSeparator=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Alternation=function(r){__extends$8(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,assign(n,pick(t,function(s){return s!==void 0})),n}return e}(AbstractProduction),Terminal=function(){function r(e){this.idx=1,assign(this,pick(e,function(t){return t!==void 0}))}return r.prototype.accept=function(e){e.visit(this)},r}();function serializeGrammar(r){return map(r,serializeProduction)}function serializeProduction(r){function e(s){return map(s,serializeProduction)}if(r instanceof NonTerminal)return{type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};if(r instanceof Flat)return{type:"Flat",definition:e(r.definition)};if(r instanceof Option$1)return{type:"Option",idx:r.idx,definition:e(r.definition)};if(r instanceof RepetitionMandatory)return{type:"RepetitionMandatory",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof RepetitionMandatoryWithSeparator)return{type:"RepetitionMandatoryWithSeparator",name:r.name,idx:r.idx,separator:serializeProduction(new Terminal({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof RepetitionWithSeparator)return{type:"RepetitionWithSeparator",name:r.name,idx:r.idx,separator:serializeProduction(new Terminal({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof Repetition)return{type:"Repetition",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Alternation)return{type:"Alternation",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Terminal){var t={type:"Terminal",name:r.terminalType.name,label:tokenLabel(r.terminalType),idx:r.idx},n=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(t.pattern=isRegExp(n)?n.source:n),t}else{if(r instanceof Rule)return{type:"Rule",name:r.name,orgText:r.orgText,definition:e(r.definition)};throw Error("non exhaustive match")}}var RestWalker=function(){function r(){}return r.prototype.walk=function(e,t){var n=this;t===void 0&&(t=[]),forEach(e.definition,function(s,o){var a=drop(e.definition,o+1);if(s instanceof NonTerminal)n.walkProdRef(s,a,t);else if(s instanceof Terminal)n.walkTerminal(s,a,t);else if(s instanceof Flat)n.walkFlat(s,a,t);else if(s instanceof Option$1)n.walkOption(s,a,t);else if(s instanceof RepetitionMandatory)n.walkAtLeastOne(s,a,t);else if(s instanceof RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(s,a,t);else if(s instanceof RepetitionWithSeparator)n.walkManySep(s,a,t);else if(s instanceof Repetition)n.walkMany(s,a,t);else if(s instanceof Alternation)n.walkOr(s,a,t);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(e,t,n){},r.prototype.walkProdRef=function(e,t,n){},r.prototype.walkFlat=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkOption=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkAtLeastOne=function(e,t,n){var s=[new Option$1({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkAtLeastOneSep=function(e,t,n){var s=restForRepetitionWithSeparator(e,t,n);this.walk(e,s)},r.prototype.walkMany=function(e,t,n){var s=[new Option$1({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkManySep=function(e,t,n){var s=restForRepetitionWithSeparator(e,t,n);this.walk(e,s)},r.prototype.walkOr=function(e,t,n){var s=this,o=t.concat(n);forEach(e.definition,function(a){var l=new Flat({definition:[a]});s.walk(l,o)})},r}();function restForRepetitionWithSeparator(r,e,t){var n=[new Option$1({definition:[new Terminal({terminalType:r.separator})].concat(r.definition)})],s=n.concat(e,t);return s}var GAstVisitor=function(){function r(){}return r.prototype.visit=function(e){var t=e;switch(t.constructor){case NonTerminal:return this.visitNonTerminal(t);case Flat:return this.visitFlat(t);case Option$1:return this.visitOption(t);case RepetitionMandatory:return this.visitRepetitionMandatory(t);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case Repetition:return this.visitRepetition(t);case Alternation:return this.visitAlternation(t);case Terminal:return this.visitTerminal(t);case Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(e){},r.prototype.visitFlat=function(e){},r.prototype.visitOption=function(e){},r.prototype.visitRepetition=function(e){},r.prototype.visitRepetitionMandatory=function(e){},r.prototype.visitRepetitionMandatoryWithSeparator=function(e){},r.prototype.visitRepetitionWithSeparator=function(e){},r.prototype.visitAlternation=function(e){},r.prototype.visitTerminal=function(e){},r.prototype.visitRule=function(e){},r}(),__extends$7=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function isSequenceProd(r){return r instanceof Flat||r instanceof Option$1||r instanceof Repetition||r instanceof RepetitionMandatory||r instanceof RepetitionMandatoryWithSeparator||r instanceof RepetitionWithSeparator||r instanceof Terminal||r instanceof Rule}function isOptionalProd(r,e){e===void 0&&(e=[]);var t=r instanceof Option$1||r instanceof Repetition||r instanceof RepetitionWithSeparator;return t?!0:r instanceof Alternation?some(r.definition,function(n){return isOptionalProd(n,e)}):r instanceof NonTerminal&&contains(e,r)?!1:r instanceof AbstractProduction?(r instanceof NonTerminal&&e.push(r),every(r.definition,function(n){return isOptionalProd(n,e)})):!1}function isBranchingProd(r){return r instanceof Alternation}function getProductionDslName(r){if(r instanceof NonTerminal)return"SUBRULE";if(r instanceof Option$1)return"OPTION";if(r instanceof Alternation)return"OR";if(r instanceof RepetitionMandatory)return"AT_LEAST_ONE";if(r instanceof RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(r instanceof RepetitionWithSeparator)return"MANY_SEP";if(r instanceof Repetition)return"MANY";if(r instanceof Terminal)return"CONSUME";throw Error("non exhaustive match")}var DslMethodsCollectorVisitor=function(r){__extends$7(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var n=t.terminalType.name+this.separator+"Terminal";has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitNonTerminal=function(t){var n=t.nonTerminalName+this.separator+"Terminal";has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(GAstVisitor),collectorVisitor=new DslMethodsCollectorVisitor;function collectMethods(r){collectorVisitor.reset(),r.accept(collectorVisitor);var e=collectorVisitor.dslMethods;return collectorVisitor.reset(),e}function first(r){if(r instanceof NonTerminal)return first(r.referencedRule);if(r instanceof Terminal)return firstForTerminal(r);if(isSequenceProd(r))return firstForSequence(r);if(isBranchingProd(r))return firstForBranching(r);throw Error("non exhaustive match")}function firstForSequence(r){for(var e=[],t=r.definition,n=0,s=t.length>n,o,a=!0;s&&a;)o=t[n],a=isOptionalProd(o),e=e.concat(first(o)),n=n+1,s=t.length>n;return uniq(e)}function firstForBranching(r){var e=map(r.definition,function(t){return first(t)});return uniq(flatten(e))}function firstForTerminal(r){return[r.terminalType]}var IN="_~IN~_",__extends$6=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ResyncFollowsWalker=function(r){__extends$6(e,r);function e(t){var n=r.call(this)||this;return n.topProd=t,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,n,s){},e.prototype.walkProdRef=function(t,n,s){var o=buildBetweenProdsFollowPrefix(t.referencedRule,t.idx)+this.topProd.name,a=n.concat(s),l=new Flat({definition:a}),u=first(l);this.follows[o]=u},e}(RestWalker);function computeAllProdsFollows(r){var e={};return forEach(r,function(t){var n=new ResyncFollowsWalker(t).startWalking();assign(e,n)}),e}function buildBetweenProdsFollowPrefix(r,e){return r.name+e+IN}var BITS_FOR_METHOD_TYPE=4,BITS_FOR_OCCURRENCE_IDX=8,BITS_FOR_ALT_IDX=8,OR_IDX=1<<BITS_FOR_OCCURRENCE_IDX,OPTION_IDX=2<<BITS_FOR_OCCURRENCE_IDX,MANY_IDX=3<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_IDX=4<<BITS_FOR_OCCURRENCE_IDX,MANY_SEP_IDX=5<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_SEP_IDX=6<<BITS_FOR_OCCURRENCE_IDX;function getKeyForAutomaticLookahead(r,e,t){return t|e|r}var BITS_START_FOR_ALT_IDX=32-BITS_FOR_ALT_IDX;function getKeyForAltIndex(r,e,t,n){var s=n+1<<BITS_START_FOR_ALT_IDX;return getKeyForAutomaticLookahead(r,e,t)|s}var __extends$5=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function setNodeLocationOnlyOffset(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.endOffset=e.endOffset):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset)}function setNodeLocationFull(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.startColumn=e.startColumn,r.startLine=e.startLine,r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine)}function addTerminalToCst(r,e,t){r.children[t]===void 0?r.children[t]=[e]:r.children[t].push(e)}function addNoneTerminalToCst(r,e,t){r.children[e]===void 0?r.children[e]=[t]:r.children[e].push(t)}var NamedDSLMethodsCollectorVisitor=function(r){__extends$5(e,r);function e(t){var n=r.call(this)||this;return n.result=[],n.ruleIdx=t,n}return e.prototype.collectNamedDSLMethod=function(t,n,s){if(!isUndefined(t.name)){var o=void 0;if(t instanceof Option$1||t instanceof Repetition||t instanceof RepetitionMandatory||t instanceof Alternation)o=new n({definition:t.definition,idx:t.idx});else if(t instanceof RepetitionMandatoryWithSeparator||t instanceof RepetitionWithSeparator)o=new n({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var a=[o],l=getKeyForAutomaticLookahead(this.ruleIdx,s,t.idx);this.result.push({def:a,key:l,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Option$1,OPTION_IDX)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Repetition,MANY_IDX)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,RepetitionMandatory,AT_LEAST_ONE_IDX)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,RepetitionMandatoryWithSeparator,AT_LEAST_ONE_SEP_IDX)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,RepetitionWithSeparator,MANY_SEP_IDX)},e.prototype.visitAlternation=function(t){var n=this;this.collectNamedDSLMethod(t,Alternation,OR_IDX);var s=t.definition.length>1;forEach(t.definition,function(o,a){if(!isUndefined(o.name)){var l=o.definition;s?l=[new Option$1({definition:o.definition})]:l=o.definition;var u=getKeyForAltIndex(n.ruleIdx,OR_IDX,t.idx,a);n.result.push({def:l,key:u,name:o.name,orgProd:o})}})},e}(GAstVisitor);function expandAllNestedRuleNames(r,e){var t={allRuleNames:[]};return forEach(r,function(n){var s=e[n.name];t.allRuleNames.push(n.name);var o=new NamedDSLMethodsCollectorVisitor(s);n.accept(o),forEach(o.result,function(a){a.def,a.key;var l=a.name;t.allRuleNames.push(n.name+l)})}),t}var __extends$4=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AbstractNextPossibleTokensWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this)||this;return s.topProd=t,s.path=n,s.possibleTokTypes=[],s.nextProductionName="",s.nextProductionOccurrence=0,s.found=!1,s.isAtEndOfPath=!1,s}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,n){n===void 0&&(n=[]),this.found||r.prototype.walk.call(this,t,n)},e.prototype.walkProdRef=function(t,n,s){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var o=n.concat(s);this.updateExpectedNext(),this.walk(t.referencedRule,o)}},e.prototype.updateExpectedNext=function(){isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(RestWalker),NextAfterTokenWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.path=n,s.nextTerminalName="",s.nextTerminalOccurrence=0,s.nextTerminalName=s.path.lastTok.name,s.nextTerminalOccurrence=s.path.lastTokOccurrence,s}return e.prototype.walkTerminal=function(t,n,s){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var o=n.concat(s),a=new Flat({definition:o});this.possibleTokTypes=first(a),this.found=!0}},e}(AbstractNextPossibleTokensWalker),AbstractNextTerminalAfterProductionWalker=function(r){__extends$4(e,r);function e(t,n){var s=r.call(this)||this;return s.topRule=t,s.occurrence=n,s.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},s}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(RestWalker),NextTerminalAfterManyWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkMany=function(t,n,s){if(t.idx===this.occurrence){var o=first$1(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkMany.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterManySepWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,n,s){if(t.idx===this.occurrence){var o=first$1(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkManySep.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterAtLeastOneWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,n,s){if(t.idx===this.occurrence){var o=first$1(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkAtLeastOne.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker),NextTerminalAfterAtLeastOneSepWalker=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,n,s){if(t.idx===this.occurrence){var o=first$1(n.concat(s));this.result.isEndOfRule=o===void 0,o instanceof Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else r.prototype.walkAtLeastOneSep.call(this,t,n,s)},e}(AbstractNextTerminalAfterProductionWalker);function possiblePathsFrom(r,e,t){t===void 0&&(t=[]),t=cloneArr(t);var n=[],s=0;function o(c){return c.concat(drop(r,s+1))}function a(c){var h=possiblePathsFrom(o(c),e,t);return n.concat(h)}for(;t.length<e&&s<r.length;){var l=r[s];if(l instanceof Flat)return a(l.definition);if(l instanceof NonTerminal)return a(l.definition);if(l instanceof Option$1)n=a(l.definition);else if(l instanceof RepetitionMandatory){var u=l.definition.concat([new Repetition({definition:l.definition})]);return a(u)}else if(l instanceof RepetitionMandatoryWithSeparator){var u=[new Flat({definition:l.definition}),new Repetition({definition:[new Terminal({terminalType:l.separator})].concat(l.definition)})];return a(u)}else if(l instanceof RepetitionWithSeparator){var u=l.definition.concat([new Repetition({definition:[new Terminal({terminalType:l.separator})].concat(l.definition)})]);n=a(u)}else if(l instanceof Repetition){var u=l.definition.concat([new Repetition({definition:l.definition})]);n=a(u)}else{if(l instanceof Alternation)return forEach(l.definition,function(c){n=a(c.definition)}),n;if(l instanceof Terminal)t.push(l.terminalType);else throw Error("non exhaustive match")}s++}return n.push({partialPath:t,suffixDef:drop(r,s)}),n}function nextPossibleTokensAfter(r,e,t,n){var s="EXIT_NONE_TERMINAL",o=[s],a="EXIT_ALTERNATIVE",l=!1,u=e.length,c=u-n-1,h=[],g=[];for(g.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!isEmpty(g);){var v=g.pop();if(v===a){l&&last(g).idx<=c&&g.pop();continue}var m=v.def,E=v.idx,_=v.ruleStack,S=v.occurrenceStack;if(!isEmpty(m)){var w=m[0];if(w===s){var A={idx:E,def:drop(m),ruleStack:dropRight(_),occurrenceStack:dropRight(S)};g.push(A)}else if(w instanceof Terminal)if(E<u-1){var O=E+1,D=e[O];if(t(D,w.terminalType)){var A={idx:O,def:drop(m),ruleStack:_,occurrenceStack:S};g.push(A)}}else if(E===u-1)h.push({nextTokenType:w.terminalType,nextTokenOccurrence:w.idx,ruleStack:_,occurrenceStack:S}),l=!0;else throw Error("non exhaustive match");else if(w instanceof NonTerminal){var Y=cloneArr(_);Y.push(w.nonTerminalName);var H=cloneArr(S);H.push(w.idx);var A={idx:E,def:w.definition.concat(o,drop(m)),ruleStack:Y,occurrenceStack:H};g.push(A)}else if(w instanceof Option$1){var k={idx:E,def:drop(m),ruleStack:_,occurrenceStack:S};g.push(k),g.push(a);var K={idx:E,def:w.definition.concat(drop(m)),ruleStack:_,occurrenceStack:S};g.push(K)}else if(w instanceof RepetitionMandatory){var se=new Repetition({definition:w.definition,idx:w.idx}),re=w.definition.concat([se],drop(m)),A={idx:E,def:re,ruleStack:_,occurrenceStack:S};g.push(A)}else if(w instanceof RepetitionMandatoryWithSeparator){var Ce=new Terminal({terminalType:w.separator}),se=new Repetition({definition:[Ce].concat(w.definition),idx:w.idx}),re=w.definition.concat([se],drop(m)),A={idx:E,def:re,ruleStack:_,occurrenceStack:S};g.push(A)}else if(w instanceof RepetitionWithSeparator){var k={idx:E,def:drop(m),ruleStack:_,occurrenceStack:S};g.push(k),g.push(a);var Ce=new Terminal({terminalType:w.separator}),Le=new Repetition({definition:[Ce].concat(w.definition),idx:w.idx}),re=w.definition.concat([Le],drop(m)),K={idx:E,def:re,ruleStack:_,occurrenceStack:S};g.push(K)}else if(w instanceof Repetition){var k={idx:E,def:drop(m),ruleStack:_,occurrenceStack:S};g.push(k),g.push(a);var Le=new Repetition({definition:w.definition,idx:w.idx}),re=w.definition.concat([Le],drop(m)),K={idx:E,def:re,ruleStack:_,occurrenceStack:S};g.push(K)}else if(w instanceof Alternation)for(var he=w.definition.length-1;he>=0;he--){var ve=w.definition[he],xe={idx:E,def:ve.definition.concat(drop(m)),ruleStack:_,occurrenceStack:S};g.push(xe),g.push(a)}else if(w instanceof Flat)g.push({idx:E,def:w.definition.concat(drop(m)),ruleStack:_,occurrenceStack:S});else if(w instanceof Rule)g.push(expandTopLevelRule(w,E,_,S));else throw Error("non exhaustive match")}}return h}function expandTopLevelRule(r,e,t,n){var s=cloneArr(t);s.push(r.name);var o=cloneArr(n);return o.push(1),{idx:e,def:r.definition,ruleStack:s,occurrenceStack:o}}var __extends$3=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),PROD_TYPE;(function(r){r[r.OPTION=0]="OPTION",r[r.REPETITION=1]="REPETITION",r[r.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",r[r.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",r[r.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",r[r.ALTERNATION=5]="ALTERNATION"})(PROD_TYPE||(PROD_TYPE={}));function getProdType(r){if(r instanceof Option$1)return PROD_TYPE.OPTION;if(r instanceof Repetition)return PROD_TYPE.REPETITION;if(r instanceof RepetitionMandatory)return PROD_TYPE.REPETITION_MANDATORY;if(r instanceof RepetitionMandatoryWithSeparator)return PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR;if(r instanceof RepetitionWithSeparator)return PROD_TYPE.REPETITION_WITH_SEPARATOR;if(r instanceof Alternation)return PROD_TYPE.ALTERNATION;throw Error("non exhaustive match")}function buildLookaheadFuncForOr(r,e,t,n,s,o){var a=getLookaheadPathsForOr(r,e,t),l=areTokenCategoriesNotUsed(a)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return o(a,n,l,s)}function buildLookaheadFuncForOptionalProd(r,e,t,n,s,o){var a=getLookaheadPathsForOptionalProd(r,e,s,t),l=areTokenCategoriesNotUsed(a)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return o(a[0],l,n)}function buildAlternativesLookAheadFunc(r,e,t,n){var s=r.length,o=every(r,function(u){return every(u,function(c){return c.length===1})});if(e)return function(u){for(var c=map(u,function(O){return O.GATE}),h=0;h<s;h++){var g=r[h],v=g.length,m=c[h];if(!(m!==void 0&&m.call(this)===!1))e:for(var E=0;E<v;E++){for(var _=g[E],S=_.length,w=0;w<S;w++){var A=this.LA(w+1);if(t(A,_[w])===!1)continue e}return h}}};if(o&&!n){var a=map(r,function(u){return flatten(u)}),l=reduce(a,function(u,c,h){return forEach(c,function(g){has(u,g.tokenTypeIdx)||(u[g.tokenTypeIdx]=h),forEach(g.categoryMatches,function(v){has(u,v)||(u[v]=h)})}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]}}else return function(){for(var u=0;u<s;u++){var c=r[u],h=c.length;e:for(var g=0;g<h;g++){for(var v=c[g],m=v.length,E=0;E<m;E++){var _=this.LA(E+1);if(t(_,v[E])===!1)continue e}return u}}}}function buildSingleAlternativeLookaheadFunction(r,e,t){var n=every(r,function(c){return c.length===1}),s=r.length;if(n&&!t){var o=flatten(r);if(o.length===1&&isEmpty(o[0].categoryMatches)){var a=o[0],l=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===l}}else{var u=reduce(o,function(c,h,g){return c[h.tokenTypeIdx]=!0,forEach(h.categoryMatches,function(v){c[v]=!0}),c},[]);return function(){var c=this.LA(1);return u[c.tokenTypeIdx]===!0}}}else return function(){e:for(var c=0;c<s;c++){for(var h=r[c],g=h.length,v=0;v<g;v++){var m=this.LA(v+1);if(e(m,h[v])===!1)continue e}return!0}return!1}}var RestDefinitionFinderWalker=function(r){__extends$3(e,r);function e(t,n,s){var o=r.call(this)||this;return o.topProd=t,o.targetOccurrence=n,o.targetProdType=s,o}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,n,s,o){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=s.concat(o),!0):!1},e.prototype.walkOption=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.OPTION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOne=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOneSep=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkMany=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkManySep=function(t,n,s){this.checkIsTarget(t,PROD_TYPE.REPETITION_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e}(RestWalker),InsideDefinitionFinderVisitor=function(r){__extends$3(e,r);function e(t,n,s){var o=r.call(this)||this;return o.targetOccurrence=t,o.targetProdType=n,o.targetRef=s,o.result=[],o}return e.prototype.checkIsTarget=function(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,PROD_TYPE.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,PROD_TYPE.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,PROD_TYPE.ALTERNATION)},e}(GAstVisitor);function initializeArrayOfArrays(r){for(var e=new Array(r),t=0;t<r;t++)e[t]=[];return e}function pathToHashKeys(r){for(var e=[""],t=0;t<r.length;t++){for(var n=r[t],s=[],o=0;o<e.length;o++){var a=e[o];s.push(a+"_"+n.tokenTypeIdx);for(var l=0;l<n.categoryMatches.length;l++){var u="_"+n.categoryMatches[l];s.push(a+u)}}e=s}return e}function isUniquePrefixHash(r,e,t){for(var n=0;n<r.length;n++)if(n!==t)for(var s=r[n],o=0;o<e.length;o++){var a=e[o];if(s[a]===!0)return!1}return!0}function lookAheadSequenceFromAlternatives(r,e){for(var t=map(r,function(h){return possiblePathsFrom([h],1)}),n=initializeArrayOfArrays(t.length),s=map(t,function(h){var g={};return forEach(h,function(v){var m=pathToHashKeys(v.partialPath);forEach(m,function(E){g[E]=!0})}),g}),o=t,a=1;a<=e;a++){var l=o;o=initializeArrayOfArrays(l.length);for(var u=function(h){for(var g=l[h],v=0;v<g.length;v++){var m=g[v].partialPath,E=g[v].suffixDef,_=pathToHashKeys(m),S=isUniquePrefixHash(s,_,h);if(S||isEmpty(E)||m.length===e){var w=n[h];if(containsPath(w,m)===!1){w.push(m);for(var A=0;A<_.length;A++){var O=_[A];s[h][O]=!0}}}else{var D=possiblePathsFrom(E,a+1,m);o[h]=o[h].concat(D),forEach(D,function(Y){var H=pathToHashKeys(Y.partialPath);forEach(H,function(k){s[h][k]=!0})})}}},c=0;c<l.length;c++)u(c)}return n}function getLookaheadPathsForOr(r,e,t,n){var s=new InsideDefinitionFinderVisitor(r,PROD_TYPE.ALTERNATION,n);return e.accept(s),lookAheadSequenceFromAlternatives(s.result,t)}function getLookaheadPathsForOptionalProd(r,e,t,n){var s=new InsideDefinitionFinderVisitor(r,t);e.accept(s);var o=s.result,a=new RestDefinitionFinderWalker(e,r,t),l=a.startWalking(),u=new Flat({definition:o}),c=new Flat({definition:l});return lookAheadSequenceFromAlternatives([u,c],n)}function containsPath(r,e){e:for(var t=0;t<r.length;t++){var n=r[t];if(n.length===e.length){for(var s=0;s<n.length;s++){var o=e[s],a=n[s],l=o===a||a.categoryMatchesMap[o.tokenTypeIdx]!==void 0;if(l===!1)continue e}return!0}}return!1}function isStrictPrefixOfPath(r,e){return r.length<e.length&&every(r,function(t,n){var s=e[n];return t===s||s.categoryMatchesMap[t.tokenTypeIdx]})}function areTokenCategoriesNotUsed(r){return every(r,function(e){return every(e,function(t){return every(t,function(n){return isEmpty(n.categoryMatches)})})})}var __extends$2=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function validateGrammar$1(r,e,t,n,s,o){var a=map(r,function(A){return validateDuplicateProductions(A,s)}),l=map(r,function(A){return validateNoLeftRecursion(A,A,s)}),u=[],c=[],h=[];every(l,isEmpty)&&(u=map(r,function(A){return validateEmptyOrAlternative(A,s)}),c=map(r,function(A){return validateAmbiguousAlternationAlternatives(A,e,n,s)}),h=validateSomeNonEmptyLookaheadPath(r,e,s));var g=checkTerminalAndNoneTerminalsNameSpace(r,t,s),v=map(t,function(A){return validateTokenName(A,s)}),m=validateNestedRulesNames(r,s),E=validateDuplicateNestedRules(r,s),_=map(r,function(A){return validateTooManyAlts(A,s)}),S=map(r,function(A){return validateRuleName(A,s)}),w=map(r,function(A){return validateRuleDoesNotAlreadyExist(A,r,o,s)});return flatten(a.concat(v,m,E,h,l,u,c,g,_,S,w))}function validateNestedRulesNames(r,e){var t=[];return forEach(r,function(n){var s=new NamedDSLMethodsCollectorVisitor("");n.accept(s);var o=map(s.result,function(a){return a.orgProd});t.push(map(o,function(a){return validateNestedRuleName(n,a,e)}))}),flatten(t)}function validateDuplicateProductions(r,e){var t=new OccurrenceValidationCollector;r.accept(t);var n=t.allProductions,s=groupBy(n,identifyProductionForDuplicates),o=pick(s,function(l){return l.length>1}),a=map(values(o),function(l){var u=first$1(l),c=e.buildDuplicateFoundError(r,l),h=getProductionDslName(u),g={message:c,type:ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:h,occurrence:u.idx},v=getExtraProductionArgument(u);return v&&(g.parameter=v),g});return a}function identifyProductionForDuplicates(r){return getProductionDslName(r)+"_#_"+r.idx+"_#_"+getExtraProductionArgument(r)}function getExtraProductionArgument(r){return r instanceof Terminal?r.terminalType.name:r instanceof NonTerminal?r.nonTerminalName:""}var OccurrenceValidationCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(GAstVisitor),validTermsPattern=/^[a-zA-Z_]\w*$/,validNestedRuleName=new RegExp(validTermsPattern.source.replace("^","^\\$"));function validateRuleName(r,e){var t=[],n=r.name;return n.match(validTermsPattern)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:r,expectedPattern:validTermsPattern}),type:ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),t}function validateNestedRuleName(r,e,t){var n=[],s;return e.name.match(validNestedRuleName)||(s=t.buildInvalidNestedRuleNameError(r,e),n.push({message:s,type:ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:r.name})),n}function validateTokenName(r,e){var t=[],n=r.name;return n.match(validTermsPattern)||t.push({message:e.buildTokenNameError({tokenType:r,expectedPattern:validTermsPattern}),type:ParserDefinitionErrorType.INVALID_TOKEN_NAME}),t}function validateRuleDoesNotAlreadyExist(r,e,t,n){var s=[],o=reduce(e,function(l,u){return u.name===r.name?l+1:l},0);if(o>1){var a=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:t});s.push({message:a,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:r.name})}return s}function validateRuleIsOverridden(r,e,t){var n=[],s;return contains(e,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",n.push({message:s,type:ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:r})),n}function validateNoLeftRecursion(r,e,t,n){n===void 0&&(n=[]);var s=[],o=getFirstNoneTerminal(e.definition);if(isEmpty(o))return[];var a=r.name,l=contains(o,r);l&&s.push({message:t.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:n}),type:ParserDefinitionErrorType.LEFT_RECURSION,ruleName:a});var u=difference(o,n.concat([r])),c=map(u,function(h){var g=cloneArr(n);return g.push(h),validateNoLeftRecursion(r,h,t,g)});return s.concat(flatten(c))}function getFirstNoneTerminal(r){var e=[];if(isEmpty(r))return e;var t=first$1(r);if(t instanceof NonTerminal)e.push(t.referencedRule);else if(t instanceof Flat||t instanceof Option$1||t instanceof RepetitionMandatory||t instanceof RepetitionMandatoryWithSeparator||t instanceof RepetitionWithSeparator||t instanceof Repetition)e=e.concat(getFirstNoneTerminal(t.definition));else if(t instanceof Alternation)e=flatten(map(t.definition,function(a){return getFirstNoneTerminal(a.definition)}));else if(!(t instanceof Terminal))throw Error("non exhaustive match");var n=isOptionalProd(t),s=r.length>1;if(n&&s){var o=drop(r);return e.concat(getFirstNoneTerminal(o))}else return e}var OrCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(GAstVisitor);function validateEmptyOrAlternative(r,e){var t=new OrCollector;r.accept(t);var n=t.alternations,s=reduce(n,function(o,a){var l=dropRight(a.definition),u=map(l,function(c,h){var g=nextPossibleTokensAfter([c],[],null,1);return isEmpty(g)?{message:e.buildEmptyAlternationError({topLevelRule:r,alternation:a,emptyChoiceIdx:h}),type:ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:a.idx,alternative:h+1}:null});return o.concat(compact(u))},[]);return s}function validateAmbiguousAlternationAlternatives(r,e,t,n){var s=new OrCollector;r.accept(s);var o=s.alternations,a=t[r.name];a&&(o=reject(o,function(u){return a[getProductionDslName(u)+(u.idx===0?"":u.idx)]})),o=reject(o,function(u){return u.ignoreAmbiguities===!0});var l=reduce(o,function(u,c){var h=c.idx,g=c.maxLookahead||e,v=getLookaheadPathsForOr(h,r,g,c),m=checkAlternativesAmbiguities(v,c,r,n),E=checkPrefixAlternativesAmbiguities(v,c,r,n);return u.concat(m,E)},[]);return l}var RepetionCollector=function(r){__extends$2(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(GAstVisitor);function validateTooManyAlts(r,e){var t=new OrCollector;r.accept(t);var n=t.alternations,s=reduce(n,function(o,a){return a.definition.length>255&&o.push({message:e.buildTooManyAlternativesError({topLevelRule:r,alternation:a}),type:ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:r.name,occurrence:a.idx}),o},[]);return s}function validateSomeNonEmptyLookaheadPath(r,e,t){var n=[];return forEach(r,function(s){var o=new RepetionCollector;s.accept(o);var a=o.allProductions;forEach(a,function(l){var u=getProdType(l),c=l.maxLookahead||e,h=l.idx,g=getLookaheadPathsForOptionalProd(h,s,u,c),v=g[0];if(isEmpty(flatten(v))){var m=t.buildEmptyRepetitionError({topLevelRule:s,repetition:l});n.push({message:m,type:ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:s.name})}})}),n}function checkAlternativesAmbiguities(r,e,t,n){var s=[],o=reduce(r,function(l,u,c){return e.definition[c].ignoreAmbiguities===!0||forEach(u,function(h){var g=[c];forEach(r,function(v,m){c!==m&&containsPath(v,h)&&e.definition[m].ignoreAmbiguities!==!0&&g.push(m)}),g.length>1&&!containsPath(s,h)&&(s.push(h),l.push({alts:g,path:h}))}),l},[]),a=map(o,function(l){var u=map(l.alts,function(h){return h+1}),c=n.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:u,prefixPath:l.path});return{message:c,type:ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[l.alts]}});return a}function checkPrefixAlternativesAmbiguities(r,e,t,n){var s=[],o=reduce(r,function(a,l,u){var c=map(l,function(h){return{idx:u,path:h}});return a.concat(c)},[]);return forEach(o,function(a){var l=e.definition[a.idx];if(l.ignoreAmbiguities!==!0){var u=a.idx,c=a.path,h=findAll(o,function(v){return e.definition[v.idx].ignoreAmbiguities!==!0&&v.idx<u&&isStrictPrefixOfPath(v.path,c)}),g=map(h,function(v){var m=[v.idx+1,u+1],E=e.idx===0?"":e.idx,_=n.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:m,prefixPath:v.path});return{message:_,type:ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:E,alternatives:m}});s=s.concat(g)}}),s}function checkTerminalAndNoneTerminalsNameSpace(r,e,t){var n=[],s=map(e,function(o){return o.name});return forEach(r,function(o){var a=o.name;if(contains(s,a)){var l=t.buildNamespaceConflictError(o);n.push({message:l,type:ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),n}function validateDuplicateNestedRules(r,e){var t=[];return forEach(r,function(n){var s=new NamedDSLMethodsCollectorVisitor("");n.accept(s);var o=groupBy(s.result,function(l){return l.name}),a=pick(o,function(l){return l.length>1});forEach(values(a),function(l){var u=map(l,function(h){return h.orgProd}),c=e.buildDuplicateNestedRuleNameError(n,u);t.push({message:c,type:ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),t}var defaultParserErrorProvider={buildMismatchTokenMessage:function(r){var e=r.expected,t=r.actual;r.previous,r.ruleName;var n=hasTokenLabel(e),s=n?"--> "+tokenLabel(e)+" <--":"token of type --> "+e.name+" <--",o="Expecting "+s+" but found --> '"+t.image+"' <--";return o},buildNotAllInputParsedMessage:function(r){var e=r.firstRedundant;return r.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(r){var e=r.expectedPathsPerAlt,t=r.actual;r.previous;var n=r.customUserDescription;r.ruleName;var s="Expecting: ",o=first$1(t).image,a=`
but found: '`+o+"'";if(n)return s+n+a;var l=reduce(e,function(g,v){return g.concat(v)},[]),u=map(l,function(g){return"["+map(g,function(v){return tokenLabel(v)}).join(", ")+"]"}),c=map(u,function(g,v){return"  "+(v+1)+". "+g}),h=`one of these possible Token sequences:
`+c.join(`
`);return s+h+a},buildEarlyExitMessage:function(r){var e=r.expectedIterationPaths,t=r.actual,n=r.customUserDescription;r.ruleName;var s="Expecting: ",o=first$1(t).image,a=`
but found: '`+o+"'";if(n)return s+n+a;var l=map(e,function(c){return"["+map(c,function(h){return tokenLabel(h)}).join(",")+"]"}),u=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+l.join(" ,")+">");return s+u+a}};Object.freeze(defaultParserErrorProvider);var defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(r,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+r.name+"<-";return t}},defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(r,e){function t(h){return h instanceof Terminal?h.terminalType.name:h instanceof NonTerminal?h.nonTerminalName:""}var n=r.name,s=first$1(e),o=s.idx,a=getProductionDslName(s),l=t(s),u=o>0,c="->"+a+(u?o:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildInvalidNestedRuleNameError:function(r,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+r.name+`<-
`+("it must match the pattern: ->"+validNestedRuleName.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(r,e){var t=first$1(e).name,n="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+r.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(r){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+r.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(r){var e=map(r.prefixPath,function(s){return tokenLabel(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous alternatives: <"+r.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(r){var e=map(r.prefixPath,function(s){return tokenLabel(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous Alternatives Detected: <"+r.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(r){var e=getProductionDslName(r.repetition);r.repetition.idx!==0&&(e+=r.repetition.idx);var t="The repetition <"+e+"> within Rule <"+r.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(r){var e=r.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+r.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(r){var e="Ambiguous empty alternative: <"+(r.emptyChoiceIdx+1)+">"+(" in <OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(r){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
 has `+(r.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(r){var e=r.topLevelRule.name,t=map(r.leftRecursionPath,function(o){return o.name}),n=e+" --> "+t.concat([e]).join(" --> "),s=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return s},buildInvalidRuleNameError:function(r){var e=r.topLevelRule.name,t=r.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return n},buildDuplicateRuleNameError:function(r){var e;r.topLevelRule instanceof Rule?e=r.topLevelRule.name:e=r.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+r.grammarName+"<-";return t}},__extends$1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function resolveGrammar$1(r,e){var t=new GastRefResolverVisitor(r,e);return t.resolveRefs(),t.errors}var GastRefResolverVisitor=function(r){__extends$1(e,r);function e(t,n){var s=r.call(this)||this;return s.nameToTopRule=t,s.errMsgProvider=n,s.errors=[],s}return e.prototype.resolveRefs=function(){var t=this;forEach(values(this.nameToTopRule),function(n){t.currTopLevel=n,n.accept(t)})},e.prototype.visitNonTerminal=function(t){var n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{var s=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:s,type:ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(GAstVisitor);function resolveGrammar(r){r=defaults(r,{errMsgProvider:defaultGrammarResolverErrorProvider});var e={};return forEach(r.rules,function(t){e[t.name]=t}),resolveGrammar$1(e,r.errMsgProvider)}function validateGrammar(r){return r=defaults(r,{errMsgProvider:defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),validateGrammar$1(r.rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName)}var MISMATCHED_TOKEN_EXCEPTION="MismatchedTokenException",NO_VIABLE_ALT_EXCEPTION="NoViableAltException",EARLY_EXIT_EXCEPTION="EarlyExitException",NOT_ALL_INPUT_PARSED_EXCEPTION="NotAllInputParsedException",RECOGNITION_EXCEPTION_NAMES=[MISMATCHED_TOKEN_EXCEPTION,NO_VIABLE_ALT_EXCEPTION,EARLY_EXIT_EXCEPTION,NOT_ALL_INPUT_PARSED_EXCEPTION];Object.freeze(RECOGNITION_EXCEPTION_NAMES);function isRecognitionException(r){return contains(RECOGNITION_EXCEPTION_NAMES,r.name)}function MismatchedTokenException(r,e,t){this.name=MISMATCHED_TOKEN_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}MismatchedTokenException.prototype=Error.prototype;function NoViableAltException(r,e,t){this.name=NO_VIABLE_ALT_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}NoViableAltException.prototype=Error.prototype;function NotAllInputParsedException(r,e){this.name=NOT_ALL_INPUT_PARSED_EXCEPTION,this.message=r,this.token=e,this.resyncedTokens=[]}NotAllInputParsedException.prototype=Error.prototype;function EarlyExitException(r,e,t){this.name=EARLY_EXIT_EXCEPTION,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}EarlyExitException.prototype=Error.prototype;var EOF_FOLLOW_KEY={},IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";function InRuleRecoveryException(r){this.name=IN_RULE_RECOVERY_EXCEPTION,this.message=r}InRuleRecoveryException.prototype=Error.prototype;var Recoverable=function(){function r(){}return r.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=has(e,"recoveryEnabled")?e.recoveryEnabled:DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=attemptInRepetitionRecovery)},r.prototype.getTokenToInsert=function(e){var t=createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},r.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},r.prototype.tryInRepetitionRecovery=function(e,t,n,s){for(var o=this,a=this.findReSyncTokenType(),l=this.exportLexerState(),u=[],c=!1,h=this.LA(1),g=this.LA(1),v=function(){var m=o.LA(0),E=o.errorMessageProvider.buildMismatchTokenMessage({expected:s,actual:h,previous:m,ruleName:o.getCurrRuleFullName()}),_=new MismatchedTokenException(E,h,o.LA(0));_.resyncedTokens=dropRight(u),o.SAVE_ERROR(_)};!c;)if(this.tokenMatcher(g,s)){v();return}else if(n.call(this)){v(),e.apply(this,t);return}else this.tokenMatcher(g,a)?c=!0:(g=this.SKIP_TOKEN(),this.addToResyncTokens(g,u));this.importLexerState(l)},r.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!(n===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},r.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t),s=this.getNextPossibleTokenTypes(n);return s},r.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var s=this.SKIP_TOKEN();return this.consumeToken(),s}throw new InRuleRecoveryException("sad sad panda")},r.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},r.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||isEmpty(t))return!1;var s=this.LA(1),o=find(t,function(a){return n.tokenMatcher(s,a)})!==void 0;return o},r.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},r.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return contains(n,e)},r.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var s=t.tokenType;if(contains(e,s))return s;t=this.LA(n),n++}},r.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return EOF_FOLLOW_KEY;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},r.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return isEmpty(this.LAST_EXPLICIT_RULE_STACK)||(t=map(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_STACK[s]}),n=map(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_OCCURRENCE_STACK[s]})),map(t,function(s,o){return o===0?EOF_FOLLOW_KEY:{ruleName:e.shortRuleNameToFullName(s),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(t[o-1])}})},r.prototype.flattenFollowSet=function(){var e=this,t=map(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return flatten(t)},r.prototype.getFollowSetFromFollowKey=function(e){if(e===EOF_FOLLOW_KEY)return[EOF];var t=e.ruleName+e.idxInCallingRule+IN+e.inRule;return this.resyncFollows[t]},r.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,EOF)||t.push(e),t},r.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return dropRight(t)},r.prototype.attemptInRepetitionRecovery=function(e,t,n,s,o,a,l){},r.prototype.getCurrentGrammarPath=function(e,t){var n=this.getHumanReadableRuleStack(),s=cloneArr(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:s,lastTok:e,lastTokOccurrence:t};return o},r.prototype.getHumanReadableRuleStack=function(){var e=this;return isEmpty(this.LAST_EXPLICIT_RULE_STACK)?map(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):map(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},r}();function attemptInRepetitionRecovery(r,e,t,n,s,o,a){var l=this.getKeyForAutomaticLookahead(n,s),u=this.firstAfterRepMap[l];if(u===void 0){var c=this.getCurrRuleFullName(),h=this.getGAstProductions()[c],g=new o(h,s);u=g.startWalking(),this.firstAfterRepMap[l]=u}var v=u.token,m=u.occurrence,E=u.isEndOfRule;this.RULE_STACK.length===1&&E&&v===void 0&&(v=EOF,m=1),this.shouldInRepetitionRecoveryBeTried(v,m,a)&&this.tryInRepetitionRecovery(r,e,t,v)}var LooksAhead=function(){function r(){}return r.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=has(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=has(e,"maxLookahead")?e.maxLookahead:DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=isES2015MapSupported()?new Map:[],isES2015MapSupported()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},r.prototype.preComputeLookaheadFunctions=function(e){var t=this;forEach(e,function(n){t.TRACE_INIT(n.name+" Rule Lookahead",function(){var s=collectMethods(n),o=s.alternation,a=s.repetition,l=s.option,u=s.repetitionMandatory,c=s.repetitionMandatoryWithSeparator,h=s.repetitionWithSeparator;forEach(o,function(g){var v=g.idx===0?"":g.idx;t.TRACE_INIT(""+getProductionDslName(g)+v,function(){var m=buildLookaheadFuncForOr(g.idx,n,g.maxLookahead||t.maxLookahead,g.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),E=getKeyForAutomaticLookahead(t.fullRuleNameToShort[n.name],OR_IDX,g.idx);t.setLaFuncCache(E,m)})}),forEach(a,function(g){t.computeLookaheadFunc(n,g.idx,MANY_IDX,PROD_TYPE.REPETITION,g.maxLookahead,getProductionDslName(g))}),forEach(l,function(g){t.computeLookaheadFunc(n,g.idx,OPTION_IDX,PROD_TYPE.OPTION,g.maxLookahead,getProductionDslName(g))}),forEach(u,function(g){t.computeLookaheadFunc(n,g.idx,AT_LEAST_ONE_IDX,PROD_TYPE.REPETITION_MANDATORY,g.maxLookahead,getProductionDslName(g))}),forEach(c,function(g){t.computeLookaheadFunc(n,g.idx,AT_LEAST_ONE_SEP_IDX,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,g.maxLookahead,getProductionDslName(g))}),forEach(h,function(g){t.computeLookaheadFunc(n,g.idx,MANY_SEP_IDX,PROD_TYPE.REPETITION_WITH_SEPARATOR,g.maxLookahead,getProductionDslName(g))})})})},r.prototype.computeLookaheadFunc=function(e,t,n,s,o,a){var l=this;this.TRACE_INIT(""+a+(t===0?"":t),function(){var u=buildLookaheadFuncForOptionalProd(t,e,o||l.maxLookahead,l.dynamicTokensEnabled,s,l.lookAheadBuilderForOptional),c=getKeyForAutomaticLookahead(l.fullRuleNameToShort[e.name],n,t);l.setLaFuncCache(c,u)})},r.prototype.lookAheadBuilderForOptional=function(e,t,n){return buildSingleAlternativeLookaheadFunction(e,t,n)},r.prototype.lookAheadBuilderForAlternatives=function(e,t,n,s){return buildAlternativesLookAheadFunc(e,t,n,s)},r.prototype.getKeyForAutomaticLookahead=function(e,t){var n=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(n,e,t)},r.prototype.getLaFuncFromCache=function(e){},r.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},r.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},r.prototype.setLaFuncCache=function(e,t){},r.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},r.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},r}();function classNameFromInstance(r){return functionName(r.constructor)}var FUNC_NAME_REGEXP=/^\s*function\s*(\S*)\s*\(/,NAME="name";function functionName(r){var e=r.name;if(e)return e;var t=r.toString().match(FUNC_NAME_REGEXP)[1];return t}function defineNameProp(r,e){var t=Object.getOwnPropertyDescriptor(r,NAME);return isUndefined(t)||t.configurable?(Object.defineProperty(r,NAME,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function defaultVisit(r,e){for(var t=keys(r),n=t.length,s=0;s<n;s++)for(var o=t[s],a=r[o],l=a.length,u=0;u<l;u++){var c=a[u];c.tokenTypeIdx===void 0&&(c.fullName!==void 0?this[c.fullName](c.children,e):this[c.name](c.children,e))}}function createBaseSemanticVisitorConstructor(r,e){var t=function(){};defineNameProp(t,r+"BaseSemantics");var n={visit:function(s,o){if(isArray(s)&&(s=s[0]),!isUndefined(s))return s.fullName!==void 0?this[s.fullName](s.children,o):this[s.name](s.children,o)},validateVisitor:function(){var s=validateVisitor(this,e);if(!isEmpty(s)){var o=map(s,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+functionName(this.constructor)+`>:
	`+(""+o.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=n,t.prototype.constructor=t,t._RULE_NAMES=e,t}function createBaseVisitorConstructorWithDefaults(r,e,t){var n=function(){};defineNameProp(n,r+"BaseSemanticsWithDefaults");var s=Object.create(t.prototype);return forEach(e,function(o){s[o]=defaultVisit}),n.prototype=s,n.prototype.constructor=n,n}var CstVisitorDefinitionError;(function(r){r[r.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",r[r.MISSING_METHOD=1]="MISSING_METHOD"})(CstVisitorDefinitionError||(CstVisitorDefinitionError={}));function validateVisitor(r,e){var t=validateMissingCstMethods(r,e),n=validateRedundantMethods(r,e);return t.concat(n)}function validateMissingCstMethods(r,e){var t=map(e,function(n){if(!isFunction(r[n]))return{msg:"Missing visitor method: <"+n+"> on "+functionName(r.constructor)+" CST Visitor.",type:CstVisitorDefinitionError.MISSING_METHOD,methodName:n}});return compact(t)}var VALID_PROP_NAMES=["constructor","visit","validateVisitor"];function validateRedundantMethods(r,e){var t=[];for(var n in r)validTermsPattern.test(n)&&isFunction(r[n])&&!contains(VALID_PROP_NAMES,n)&&!contains(e,n)&&t.push({msg:"Redundant visitor method: <"+n+"> on "+functionName(r.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+validTermsPattern.source+"/."),type:CstVisitorDefinitionError.REDUNDANT_METHOD,methodName:n});return t}var TreeBuilder=function(){function r(){}return r.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=has(e,"outputCst")?e.outputCst:DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=has(e,"nodeLocationTracking")?e.nodeLocationTracking:DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=NOOP,this.cstFinallyStateUpdate=NOOP,this.cstPostTerminal=NOOP,this.cstPostNonTerminal=NOOP,this.cstPostRule=NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationFull,this.setNodeLocationFromNode=setNodeLocationFull,this.cstPostRule=NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationOnlyOffset,this.setNodeLocationFromNode=setNodeLocationOnlyOffset,this.cstPostRule=NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=NOOP,this.setNodeLocationFromNode=NOOP,this.cstPostRule=NOOP,this.setInitialNodeLocation=NOOP;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},r.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},r.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?n.endOffset=t.endOffset:n.startOffset=NaN},r.prototype.cstPostTerminal=function(e,t){var n=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(n,t,e),this.setNodeLocationFromToken(n.location,t)},r.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},r.prototype.getBaseCstVisitorConstructor=function(){if(isUndefined(this.baseCstVisitorConstructor)){var e=createBaseSemanticVisitorConstructor(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(isUndefined(this.baseCstVisitorWithDefaultsConstructor)){var e=createBaseVisitorConstructorWithDefaults(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.nestedRuleBeforeClause=function(e,t){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n},r.prototype.nestedAltBeforeClause=function(e,t,n,s){var o=this.getLastExplicitRuleShortName(),a=getKeyForAltIndex(o,n,t,s),l;if(e.NAME!==void 0)return l=e.NAME,this.nestedRuleInvocationStateUpdate(l,a),{shortName:a,nestedName:l}},r.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,s=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];addNoneTerminalToCst(o,t,s),this.setNodeLocationFromNode(o.location,s.location)},r.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},r.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},r.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},r.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},r.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},r.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},r}(),LexerAdapter=function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):END_OF_FILE},r.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?END_OF_FILE:this.tokVector[t]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(e){this.currIdx=e},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r}(),RecognizerApi=function(){function r(){}return r.prototype.ACTION=function(e){return e.call(this)},r.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},r.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},r.prototype.option=function(e,t){return this.optionInternal(t,e)},r.prototype.or=function(e,t){return this.orInternal(t,e)},r.prototype.many=function(e,t){return this.manyInternal(e,t)},r.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},r.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},r.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},r.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},r.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},r.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},r.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},r.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},r.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},r.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},r.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},r.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},r.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},r.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},r.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},r.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},r.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},r.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},r.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},r.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},r.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},r.prototype.OPTION=function(e){return this.optionInternal(e,0)},r.prototype.OPTION1=function(e){return this.optionInternal(e,1)},r.prototype.OPTION2=function(e){return this.optionInternal(e,2)},r.prototype.OPTION3=function(e){return this.optionInternal(e,3)},r.prototype.OPTION4=function(e){return this.optionInternal(e,4)},r.prototype.OPTION5=function(e){return this.optionInternal(e,5)},r.prototype.OPTION6=function(e){return this.optionInternal(e,6)},r.prototype.OPTION7=function(e){return this.optionInternal(e,7)},r.prototype.OPTION8=function(e){return this.optionInternal(e,8)},r.prototype.OPTION9=function(e){return this.optionInternal(e,9)},r.prototype.OR=function(e){return this.orInternal(e,0)},r.prototype.OR1=function(e){return this.orInternal(e,1)},r.prototype.OR2=function(e){return this.orInternal(e,2)},r.prototype.OR3=function(e){return this.orInternal(e,3)},r.prototype.OR4=function(e){return this.orInternal(e,4)},r.prototype.OR5=function(e){return this.orInternal(e,5)},r.prototype.OR6=function(e){return this.orInternal(e,6)},r.prototype.OR7=function(e){return this.orInternal(e,7)},r.prototype.OR8=function(e){return this.orInternal(e,8)},r.prototype.OR9=function(e){return this.orInternal(e,9)},r.prototype.MANY=function(e){this.manyInternal(0,e)},r.prototype.MANY1=function(e){this.manyInternal(1,e)},r.prototype.MANY2=function(e){this.manyInternal(2,e)},r.prototype.MANY3=function(e){this.manyInternal(3,e)},r.prototype.MANY4=function(e){this.manyInternal(4,e)},r.prototype.MANY5=function(e){this.manyInternal(5,e)},r.prototype.MANY6=function(e){this.manyInternal(6,e)},r.prototype.MANY7=function(e){this.manyInternal(7,e)},r.prototype.MANY8=function(e){this.manyInternal(8,e)},r.prototype.MANY9=function(e){this.manyInternal(9,e)},r.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},r.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},r.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},r.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},r.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},r.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},r.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},r.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},r.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},r.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},r.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},r.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},r.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},r.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},r.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},r.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},r.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},r.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},r.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},r.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},r.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},r.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},r.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},r.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},r.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},r.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},r.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},r.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},r.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},r.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},r.prototype.RULE=function(e,t,n){if(n===void 0&&(n=DEFAULT_RULE_CONFIG),contains(this.definedRulesNames,e)){var s=defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),o={message:s,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,t,n);return this[e]=a,a},r.prototype.OVERRIDE_RULE=function(e,t,n){n===void 0&&(n=DEFAULT_RULE_CONFIG);var s=[];s=s.concat(validateRuleIsOverridden(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,s);var o=this.defineRule(e,t,n);return this[e]=o,o},r.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(s){if(isRecognitionException(s))return!1;throw s}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return serializeGrammar(values(this.gastProductionsCache))},r}(),RecognizerEngine=function(){function r(){}return r.prototype.initRecognizerEngine=function(e,t){if(this.className=classNameFromInstance(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},has(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(isArray(e)){if(isEmpty(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(isArray(e))this.tokensMap=reduce(e,function(a,l){return a[l.name]=l,a},{});else if(has(e,"modes")&&every(flatten(values(e.modes)),isTokenType)){var n=flatten(values(e.modes)),s=uniq(n);this.tokensMap=reduce(s,function(a,l){return a[l.name]=l,a},{})}else if(isObject(e))this.tokensMap=cloneObj(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=EOF;var o=every(values(e),function(a){return isEmpty(a.categoryMatches)});this.tokenMatcher=o?tokenStructuredMatcherNoCategories:tokenStructuredMatcher,augmentTokenTypes(values(this.tokensMap))},r.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var s=has(n,"resyncEnabled")?n.resyncEnabled:DEFAULT_RULE_CONFIG.resyncEnabled,o=has(n,"recoveryValueFunc")?n.recoveryValueFunc:DEFAULT_RULE_CONFIG.recoveryValueFunc,a=this.ruleShortNameIdx<<BITS_FOR_METHOD_TYPE+BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function l(h){try{if(this.outputCst===!0){t.apply(this,h);var g=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(g),g}else return t.apply(this,h)}catch(v){return this.invokeRuleCatch(v,s,o)}finally{this.ruleFinallyStateUpdate()}}var u;u=function(h,g){return h===void 0&&(h=0),this.ruleInvocationStateUpdate(a,e,h),l.call(this,g)};var c="ruleName";return u[c]=e,u.originalGrammarAction=t,u},r.prototype.invokeRuleCatch=function(e,t,n){var s=this.RULE_STACK.length===1,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(e)){var a=e;if(o){var l=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(l))if(a.resyncedTokens=this.reSyncTo(l),this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];return u.recoveredNode=!0,u}else return n();else{if(this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];u.recoveredNode=!0,a.partialCstResult=u}throw a}}else{if(s)return this.moveToTerminatedState(),n();throw a}}else throw e},r.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(OPTION_IDX,t),s=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(OPTION_IDX,t);return this.optionInternalLogic(e,t,n)},r.prototype.optionInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(e.DEF!==void 0){if(a=e.DEF,l=e.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=e;if(o.call(this)===!0)return a.call(this)},r.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,n)},r.prototype.atLeastOneInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(t.DEF!==void 0){if(a=t.DEF,l=t.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=t;if(o.call(this)===!0)for(var c=this.doSingleRepetition(a);o.call(this)===!0&&c===!0;)c=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],o,AT_LEAST_ONE_IDX,e,NextTerminalAfterAtLeastOneWalker)},r.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},r.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var s=this,o=t.DEF,a=t.SEP,l=this.getLaFuncFromCache(n);if(l.call(this)===!0){o.call(this);for(var u=function(){return s.tokenMatcher(s.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,o,NextTerminalAfterAtLeastOneSepWalker],u,AT_LEAST_ONE_SEP_IDX,e,NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},r.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_IDX,e);return this.manyInternalLogic(e,t,n)},r.prototype.manyInternalLogic=function(e,t,n){var s=this,o=this.getLaFuncFromCache(n),a,l;if(t.DEF!==void 0){if(a=t.DEF,l=t.GATE,l!==void 0){var u=o;o=function(){return l.call(s)&&u.call(s)}}}else a=t;for(var c=!0;o.call(this)===!0&&c===!0;)c=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],o,MANY_IDX,e,NextTerminalAfterManyWalker,c)},r.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,e),s=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,n)},r.prototype.manySepFirstInternalLogic=function(e,t,n){var s=this,o=t.DEF,a=t.SEP,l=this.getLaFuncFromCache(n);if(l.call(this)===!0){o.call(this);for(var u=function(){return s.tokenMatcher(s.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,o,NextTerminalAfterManySepWalker],u,MANY_SEP_IDX,e,NextTerminalAfterManySepWalker)}},r.prototype.repetitionSepSecondInternal=function(e,t,n,s,o){for(;n();)this.CONSUME(t),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,s,o],n,AT_LEAST_ONE_SEP_IDX,e,o)},r.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>t},r.prototype.orInternalNoCst=function(e,t){var n=isArray(e)?e:e.DEF,s=this.getKeyForAutomaticLookahead(OR_IDX,t),o=this.getLaFuncFromCache(s),a=o.call(this,n);if(a!==void 0){var l=n[a];return l.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},r.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(OR_IDX,t),s=this.nestedRuleBeforeClause(e,n);try{var o=isArray(e)?e:e.DEF,a=this.getLaFuncFromCache(n),l=a.call(this,o);if(l!==void 0){var u=o[l],c=this.nestedAltBeforeClause(u,t,OR_IDX,l);try{return u.ALT.call(this)}finally{c!==void 0&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(t,e))}},r.prototype.subruleInternal=function(e,t,n){var s;try{var o=n!==void 0?n.ARGS:void 0;return s=e.call(this,t,o),this.cstPostNonTerminal(s,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),s}catch(a){this.subruleInternalError(a,n,e.ruleName)}},r.prototype.subruleInternalError=function(e,t,n){throw isRecognitionException(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:n),delete e.partialCstResult),e},r.prototype.consumeInternal=function(e,t,n){var s;try{var o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),s=o):this.consumeInternalError(e,o,n)}catch(a){s=this.consumeInternalRecovery(e,t,a)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,s),s},r.prototype.consumeInternalError=function(e,t,n){var s,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?s=n.ERR_MSG:s=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new MismatchedTokenException(s,t,o))},r.prototype.consumeInternalRecovery=function(e,t,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var s=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,s)}catch(o){throw o.name===IN_RULE_RECOVERY_EXCEPTION?n:o}}else throw n},r.prototype.saveRecogState=function(){var e=this.errors,t=cloneArr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},r.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},r.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),EOF)},r.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r}(),ErrorHandler=function(){function r(){}return r.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=defaults(e.errorMessageProvider,DEFAULT_PARSER_CONFIG.errorMessageProvider)},r.prototype.SAVE_ERROR=function(e){if(isRecognitionException(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return cloneArr(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),r.prototype.raiseEarlyExitException=function(e,t,n){for(var s=this.getCurrRuleFullName(),o=this.getGAstProductions()[s],a=getLookaheadPathsForOptionalProd(e,o,t,this.maxLookahead),l=a[0],u=[],c=1;c<=this.maxLookahead;c++)u.push(this.LA(c));var h=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:l,actual:u,previous:this.LA(0),customUserDescription:n,ruleName:s});throw this.SAVE_ERROR(new EarlyExitException(h,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),s=this.getGAstProductions()[n],o=getLookaheadPathsForOr(e,s,this.maxLookahead),a=[],l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));var u=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:a,previous:u,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(c,this.LA(1),u))},r}(),ContentAssist=function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(isUndefined(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return nextPossibleTokensAfter([n],t,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(e){var t=first$1(e.ruleStack),n=this.getGAstProductions(),s=n[t],o=new NextAfterTokenWalker(s,e).startWalking();return o},r}(),RECORDING_NULL_OBJECT={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(RECORDING_NULL_OBJECT);var HANDLE_SEPARATOR=!0,MAX_METHOD_IDX=Math.pow(2,BITS_FOR_OCCURRENCE_IDX)-1,RFT=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([RFT]);var RECORDING_PHASE_TOKEN=createTokenInstance(RFT,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(RECORDING_PHASE_TOKEN);var RECORDING_PHASE_CSTNODE={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},GastRecorder=function(){function r(){}return r.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(s){var o=s>0?s:"";e["CONSUME"+o]=function(a,l){return this.consumeInternalRecord(a,s,l)},e["SUBRULE"+o]=function(a,l){return this.subruleInternalRecord(a,s,l)},e["OPTION"+o]=function(a){return this.optionInternalRecord(a,s)},e["OR"+o]=function(a){return this.orInternalRecord(a,s)},e["MANY"+o]=function(a){this.manyInternalRecord(s,a)},e["MANY_SEP"+o]=function(a){this.manySepFirstInternalRecord(s,a)},e["AT_LEAST_ONE"+o]=function(a){this.atLeastOneInternalRecord(s,a)},e["AT_LEAST_ONE_SEP"+o]=function(a){this.atLeastOneSepFirstInternalRecord(s,a)}},n=0;n<10;n++)t(n);e.consume=function(s,o,a){return this.consumeInternalRecord(o,s,a)},e.subrule=function(s,o,a){return this.subruleInternalRecord(o,s,a)},e.option=function(s,o){return this.optionInternalRecord(o,s)},e.or=function(s,o){return this.orInternalRecord(o,s)},e.many=function(s,o){this.manyInternalRecord(s,o)},e.atLeastOne=function(s,o){this.atLeastOneInternalRecord(s,o)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},r.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},r.prototype.ACTION_RECORD=function(e){},r.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},r.prototype.LA_RECORD=function(e){return END_OF_FILE},r.prototype.topLevelRuleRecord=function(e,t){try{var n=new Rule({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(s){if(s.KNOWN_RECORDER_ERROR!==!0)try{s.message=s.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw s}throw s}},r.prototype.optionInternalRecord=function(e,t){return recordProd.call(this,Option$1,e,t)},r.prototype.atLeastOneInternalRecord=function(e,t){recordProd.call(this,RepetitionMandatory,t,e)},r.prototype.atLeastOneSepFirstInternalRecord=function(e,t){recordProd.call(this,RepetitionMandatoryWithSeparator,t,e,HANDLE_SEPARATOR)},r.prototype.manyInternalRecord=function(e,t){recordProd.call(this,Repetition,t,e)},r.prototype.manySepFirstInternalRecord=function(e,t){recordProd.call(this,RepetitionWithSeparator,t,e,HANDLE_SEPARATOR)},r.prototype.orInternalRecord=function(e,t){return recordOrProd.call(this,e,t)},r.prototype.subruleInternalRecord=function(e,t,n){if(assertMethodIdxIsValid(t),!e||has(e,"ruleName")===!1){var s=new Error("<SUBRULE"+getIdxSuffix(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var o=peek(this.recordingProdStack),a=e.ruleName,l=new NonTerminal({idx:t,nonTerminalName:a,referencedRule:void 0});return o.definition.push(l),this.outputCst?RECORDING_PHASE_CSTNODE:RECORDING_NULL_OBJECT},r.prototype.consumeInternalRecord=function(e,t,n){if(assertMethodIdxIsValid(t),!hasShortKeyProperty(e)){var s=new Error("<CONSUME"+getIdxSuffix(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var o=peek(this.recordingProdStack),a=new Terminal({idx:t,terminalType:e});return o.definition.push(a),RECORDING_PHASE_TOKEN},r}();function recordProd(r,e,t,n){n===void 0&&(n=!1),assertMethodIdxIsValid(t);var s=peek(this.recordingProdStack),o=isFunction(e)?e:e.DEF,a=new r({definition:[],idx:t});return has(e,"NAME")&&(a.name=e.NAME),n&&(a.separator=e.SEP),has(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),o.call(this),s.definition.push(a),this.recordingProdStack.pop(),RECORDING_NULL_OBJECT}function recordOrProd(r,e){var t=this;assertMethodIdxIsValid(e);var n=peek(this.recordingProdStack),s=isArray(r)===!1,o=s===!1?r:r.DEF,a=new Alternation({definition:[],idx:e,ignoreAmbiguities:s&&r.IGNORE_AMBIGUITIES===!0});has(r,"NAME")&&(a.name=r.NAME),has(r,"MAX_LOOKAHEAD")&&(a.maxLookahead=r.MAX_LOOKAHEAD);var l=some(o,function(u){return isFunction(u.GATE)});return a.hasPredicates=l,n.definition.push(a),forEach(o,function(u){var c=new Flat({definition:[]});a.definition.push(c),has(u,"NAME")&&(c.name=u.NAME),has(u,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=u.IGNORE_AMBIGUITIES:has(u,"GATE")&&(c.ignoreAmbiguities=!0),t.recordingProdStack.push(c),u.ALT.call(t),t.recordingProdStack.pop()}),RECORDING_NULL_OBJECT}function getIdxSuffix(r){return r===0?"":""+r}function assertMethodIdxIsValid(r){if(r<0||r>MAX_METHOD_IDX){var e=new Error("Invalid DSL Method idx value: <"+r+`>
	`+("Idx value must be a none negative value smaller than "+(MAX_METHOD_IDX+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var PerformanceTracer=function(){function r(){}return r.prototype.initPerformanceTracer=function(e){if(has(e,"traceInitPerf")){var t=e.traceInitPerf,n=typeof t=="number";this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=timer(t),o=s.time,a=s.value,l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return t()},r}(),__extends=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),END_OF_FILE=createTokenInstance(EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(END_OF_FILE);var DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),ParserDefinitionErrorType;(function(r){r[r.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",r[r.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",r[r.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",r[r.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",r[r.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",r[r.LEFT_RECURSION=5]="LEFT_RECURSION",r[r.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",r[r.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",r[r.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",r[r.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",r[r.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",r[r.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",r[r.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",r[r.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",r[r.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(ParserDefinitionErrorType||(ParserDefinitionErrorType={}));function EMPTY_ALT(r){return r===void 0&&(r=void 0),function(){return r}}var Parser=function(){function r(e,t){t===void 0&&(t=DEFAULT_PARSER_CONFIG),this.ignoredIssues=DEFAULT_PARSER_CONFIG.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),has(t,"ignoredIssues")&&t.ignoredIssues!==DEFAULT_PARSER_CONFIG.ignoredIssues&&PRINT_WARNING(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=has(t,"ignoredIssues")?t.ignoredIssues:DEFAULT_PARSER_CONFIG.ignoredIssues,this.skipValidations=has(t,"skipValidations")?t.skipValidations:DEFAULT_PARSER_CONFIG.skipValidations}return r.performSelfAnalysis=function(e){e.performSelfAnalysis()},r.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){toFastProperties(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),forEach(e.definedRulesNames,function(o){var a=e[o],l=a.originalGrammarAction,u=void 0;e.TRACE_INIT(o+" Rule",function(){u=e.topLevelRuleRecord(o,l)}),e.gastProductionsCache[o]=u})}finally{e.disableRecording()}});var s=[];if(e.TRACE_INIT("Grammar Resolving",function(){s=resolveGrammar({rules:values(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,s)}),e.TRACE_INIT("Grammar Validations",function(){if(isEmpty(s)&&e.skipValidations===!1){var o=validateGrammar({rules:values(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:values(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:defaultGrammarValidatorErrorProvider,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,o)}}),isEmpty(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var o=computeAllProdsFollows(values(e.gastProductionsCache));e.resyncFollows=o}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(values(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var o=expandAllNestedRuleNames(values(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=o.allRuleNames}),!r.DEFER_DEFINITION_ERRORS_HANDLING&&!isEmpty(e.definitionErrors))throw t=map(e.definitionErrors,function(o){return o.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},r.DEFER_DEFINITION_ERRORS_HANDLING=!1,r}();applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);(function(r){__extends(e,r);function e(t,n){n===void 0&&(n=DEFAULT_PARSER_CONFIG);var s=this,o=cloneObj(n);return o.outputCst=!0,s=r.call(this,t,o)||this,s}return e})(Parser);var EmbeddedActionsParser=function(r){__extends(e,r);function e(t,n){n===void 0&&(n=DEFAULT_PARSER_CONFIG);var s=this,o=cloneObj(n);return o.outputCst=!1,s=r.call(this,t,o)||this,s}return e}(Parser);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const parsingError=(r,e)=>({type:r,message:e});var ParsingErrorType;(function(r){r.LexingError="LexingError",r.ParserError="ParsingError",r.StaticOffsetError="StaticOffsetError",r.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",r.RangeOffsetNotAllowed="RangeOffsetNotAllowed",r.InvalidRangeSize="InvalidRangeSize"})(ParsingErrorType||(ParsingErrorType={}));var AstNodeType;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.MINUS_UNARY_OP="MINUS_UNARY_OP",r.PLUS_UNARY_OP="PLUS_UNARY_OP",r.PERCENT_OP="PERCENT_OP",r.CONCATENATE_OP="CONCATENATE_OP",r.EQUALS_OP="EQUALS_OP",r.NOT_EQUAL_OP="NOT_EQUAL_OP",r.GREATER_THAN_OP="GREATER_THAN_OP",r.LESS_THAN_OP="LESS_THAN_OP",r.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",r.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",r.PLUS_OP="PLUS_OP",r.MINUS_OP="MINUS_OP",r.TIMES_OP="TIMES_OP",r.DIV_OP="DIV_OP",r.POWER_OP="POWER_OP",r.FUNCTION_CALL="FUNCTION_CALL",r.NAMED_EXPRESSION="NAMED_EXPRESSION",r.PARENTHESIS="PARENTHESES",r.CELL_REFERENCE="CELL_REFERENCE",r.CELL_RANGE="CELL_RANGE",r.COLUMN_RANGE="COLUMN_RANGE",r.ROW_RANGE="ROW_RANGE",r.ERROR="ERROR",r.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",r.ARRAY="ARRAY"})(AstNodeType||(AstNodeType={}));var RangeSheetReferenceType;(function(r){r[r.RELATIVE=0]="RELATIVE",r[r.START_ABSOLUTE=1]="START_ABSOLUTE",r[r.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(RangeSheetReferenceType||(RangeSheetReferenceType={}));const buildEmptyArgAst=r=>({type:AstNodeType.EMPTY,leadingWhitespace:r==null?void 0:r.image}),buildNumberAst=(r,e)=>({type:AstNodeType.NUMBER,value:r,leadingWhitespace:e==null?void 0:e.image}),buildStringAst=r=>{var e;return{type:AstNodeType.STRING,value:r.image.slice(1,-1),leadingWhitespace:(e=r.leadingWhitespace)===null||e===void 0?void 0:e.image}},buildCellReferenceAst=(r,e)=>({type:AstNodeType.CELL_REFERENCE,reference:r,leadingWhitespace:e==null?void 0:e.image}),buildCellRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.CELL_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n}),buildColumnRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.COLUMN_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),buildRowRangeAst=(r,e,t,n)=>(assertRangeConsistency(r,e,t),{type:AstNodeType.ROW_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),buildConcatenateOpAst=(r,e,t)=>({type:AstNodeType.CONCATENATE_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildEqualsOpAst=(r,e,t)=>({type:AstNodeType.EQUALS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildNotEqualOpAst=(r,e,t)=>({type:AstNodeType.NOT_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildGreaterThanOpAst=(r,e,t)=>({type:AstNodeType.GREATER_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildLessThanOpAst=(r,e,t)=>({type:AstNodeType.LESS_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildGreaterThanOrEqualOpAst=(r,e,t)=>({type:AstNodeType.GREATER_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildLessThanOrEqualOpAst=(r,e,t)=>({type:AstNodeType.LESS_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildPlusOpAst=(r,e,t)=>({type:AstNodeType.PLUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildMinusOpAst=(r,e,t)=>({type:AstNodeType.MINUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildTimesOpAst=(r,e,t)=>({type:AstNodeType.TIMES_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildDivOpAst=(r,e,t)=>({type:AstNodeType.DIV_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildPowerOpAst=(r,e,t)=>({type:AstNodeType.POWER_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),buildMinusUnaryOpAst=(r,e)=>({type:AstNodeType.MINUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildPlusUnaryOpAst=(r,e)=>({type:AstNodeType.PLUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildPercentOpAst=(r,e)=>({type:AstNodeType.PERCENT_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),buildProcedureAst=(r,e,t,n,s)=>({type:AstNodeType.FUNCTION_CALL,procedureName:r,args:e,leadingWhitespace:t==null?void 0:t.image,internalWhitespace:n==null?void 0:n.image,hyperlink:s}),buildArrayAst=(r,e,t)=>({type:AstNodeType.ARRAY,args:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),buildNamedExpressionAst=(r,e)=>({type:AstNodeType.NAMED_EXPRESSION,expressionName:r,leadingWhitespace:e==null?void 0:e.image}),buildParenthesisAst=(r,e,t)=>({type:AstNodeType.PARENTHESIS,expression:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),buildCellErrorAst=(r,e)=>({type:AstNodeType.ERROR,error:r,leadingWhitespace:e==null?void 0:e.image}),buildErrorWithRawInputAst=(r,e,t)=>({type:AstNodeType.ERROR_WITH_RAW_INPUT,error:e,rawInput:r,leadingWhitespace:t==null?void 0:t.image}),buildParsingErrorAst=()=>({type:AstNodeType.ERROR,error:CellError.parsingError()});function assertRangeConsistency(r,e,t){if(r.sheet!==void 0&&e.sheet===void 0||r.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(r.sheet===void 0&&t!==RangeSheetReferenceType.RELATIVE||r.sheet!==void 0&&t===RangeSheetReferenceType.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function imageWithWhitespace(r,e){return(e??"")+r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const binaryOpTokenMap={[AstNodeType.PLUS_OP]:"+",[AstNodeType.MINUS_OP]:"-",[AstNodeType.TIMES_OP]:"*",[AstNodeType.DIV_OP]:"/",[AstNodeType.CONCATENATE_OP]:"&",[AstNodeType.POWER_OP]:"^",[AstNodeType.EQUALS_OP]:"=",[AstNodeType.NOT_EQUAL_OP]:"<>",[AstNodeType.GREATER_THAN_OP]:">",[AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[AstNodeType.LESS_THAN_OP]:"<",[AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const buildCacheEntry=(r,e,t,n)=>({ast:r,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:n});class Cache{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=collectDependencies(t,this.functionRegistry),s=buildCacheEntry(t,n,doesContainFunctions(t,this.functionRegistry.isFunctionVolatile),doesContainFunctions(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,s),s}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,t),t)}}const doesContainFunctions=(r,e)=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.CELL_REFERENCE:case AstNodeType.CELL_RANGE:case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.NAMED_EXPRESSION:return!1;case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:return doesContainFunctions(r.value,e);case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:return doesContainFunctions(r.left,e)||doesContainFunctions(r.right,e);case AstNodeType.PARENTHESIS:return doesContainFunctions(r.expression,e);case AstNodeType.FUNCTION_CALL:return e(r.procedureName)?!0:r.args.some(t=>doesContainFunctions(t,e));case AstNodeType.ARRAY:return r.args.some(t=>t.some(n=>doesContainFunctions(n,e)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ErrorMessage{}ErrorMessage.DistinctSigns="Distinct signs.";ErrorMessage.WrongArgNumber="Wrong number of arguments.";ErrorMessage.EmptyArg="Empty function argument.";ErrorMessage.EmptyArray="Empty array not allowed.";ErrorMessage.ArrayDimensions="Array dimensions are not compatible.";ErrorMessage.NoSpaceForArrayResult="No space for array result.";ErrorMessage.ValueSmall="Value too small.";ErrorMessage.ValueLarge="Value too large.";ErrorMessage.BadCriterion="Incorrect criterion.";ErrorMessage.RangeManySheets="Range spans more than one sheet.";ErrorMessage.CellRangeExpected="Cell range expected.";ErrorMessage.WrongDimension="Wrong range dimension.";ErrorMessage.ScalarExpected="Cell range not allowed.";ErrorMessage.NumberCoercion="Value cannot be coerced to number.";ErrorMessage.NumberExpected="Number argument expected.";ErrorMessage.IntegerExpected="Value needs to be an integer.";ErrorMessage.BadMode="Mode not recognized.";ErrorMessage.DateBounds="Date outside of bounds.";ErrorMessage.OutOfSheet="Resulting reference is out of the sheet.";ErrorMessage.WrongType="Wrong type of argument.";ErrorMessage.NaN="NaN or infinite value encountered.";ErrorMessage.EqualLength="Ranges need to be of equal length.";ErrorMessage.Negative="Value cannot be negative.";ErrorMessage.NotBinary="String does not represent a binary number.";ErrorMessage.NotOctal="String does not represent an octal number.";ErrorMessage.NotHex="String does not represent a hexadecimal number.";ErrorMessage.EndStartPeriod="End period needs to be at least start period.";ErrorMessage.CellRefExpected="Cell reference expected.";ErrorMessage.EmptyRange="Empty range not allowed.";ErrorMessage.BadRef="Address is not correct.";ErrorMessage.NumberRange="Number-only range expected.";ErrorMessage.ValueNotFound="Value not found.";ErrorMessage.ValueBaseLarge="Value in base too large.";ErrorMessage.ValueBaseSmall="Value in base too small.";ErrorMessage.ValueBaseLong="Value in base too long.";ErrorMessage.NegativeLength="Length cannot be negative.";ErrorMessage.PatternNotFound="Pattern not found.";ErrorMessage.OneValue="Needs at least one value.";ErrorMessage.TwoValues="Range needs to contain at least two elements.";ErrorMessage.ThreeValues="Range needs to contain at least three elements.";ErrorMessage.IndexBounds="Index out of bounds.";ErrorMessage.IndexLarge="Index too large.";ErrorMessage.Formula="Expected formula.";ErrorMessage.NegativeCount="Count cannot be negative.";ErrorMessage.ParseError="Parsing error.";ErrorMessage.SheetRef="Sheet does not exist.";ErrorMessage.PeriodLong="Period number cannot exceed life length.";ErrorMessage.InvalidDate="Invalid date.";ErrorMessage.BitshiftLong="Result of bitshift is too long.";ErrorMessage.EmptyString="Empty-string argument not allowed.";ErrorMessage.LengthBounds="Length out of bounds.";ErrorMessage.NegativeTime="Time cannot be negative.";ErrorMessage.NoDefault="No default option.";ErrorMessage.NoConditionMet="None of the conditions were met.";ErrorMessage.Selector="Selector cannot exceed the number of arguments.";ErrorMessage.StartEndDate="Start date needs to be earlier than end date.";ErrorMessage.IncorrectDateTime="String does not represent correct DateTime.";ErrorMessage.CharacterCodeBounds="Character code out of bounds.";ErrorMessage.NonZero="Argument cannot be 0.";ErrorMessage.LessThanOne="Argument cannot be less than 1.";ErrorMessage.WeekendString="Incorrect weekend bitmask string.";ErrorMessage.InvalidRoman="Invalid roman numeral.";ErrorMessage.WrongOrder="Wrong order of values.";ErrorMessage.ComplexNumberExpected="Complex number expected.";ErrorMessage.ShouldBeIorJ="Should be 'i' or 'j'.";ErrorMessage.SizeMismatch="Array dimensions mismatched.";ErrorMessage.FunctionName=r=>`Function name ${r} not recognized.`;ErrorMessage.NamedExpressionName=r=>`Named expression ${r} not recognized.`;ErrorMessage.LicenseKey=r=>`License key is ${r}.`;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CellReferenceMatcher{constructor(){this.POSSIBLE_START_CHARACTERS=[...ALL_UNICODE_LETTERS_ARRAY,...ALL_DIGITS_ARRAY,ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=new RegExp(CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NamedExpressionMatcher{constructor(){this.POSSIBLE_START_CHARACTERS=[...ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=new RegExp(NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const AdditionOp=createToken({name:"AdditionOp",pattern:Lexer.NA}),PlusOp=createToken({name:"PlusOp",pattern:/\+/,categories:AdditionOp}),MinusOp=createToken({name:"MinusOp",pattern:/-/,categories:AdditionOp}),MultiplicationOp=createToken({name:"MultiplicationOp",pattern:Lexer.NA}),TimesOp=createToken({name:"TimesOp",pattern:/\*/,categories:MultiplicationOp}),DivOp=createToken({name:"DivOp",pattern:/\//,categories:MultiplicationOp}),PowerOp=createToken({name:"PowerOp",pattern:/\^/}),PercentOp=createToken({name:"PercentOp",pattern:/%/}),BooleanOp=createToken({name:"BooleanOp",pattern:Lexer.NA}),EqualsOp=createToken({name:"EqualsOp",pattern:/=/,categories:BooleanOp}),NotEqualOp=createToken({name:"NotEqualOp",pattern:/<>/,categories:BooleanOp}),GreaterThanOp=createToken({name:"GreaterThanOp",pattern:/>/,categories:BooleanOp}),LessThanOp=createToken({name:"LessThanOp",pattern:/</,categories:BooleanOp}),GreaterThanOrEqualOp=createToken({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:BooleanOp}),LessThanOrEqualOp=createToken({name:"LessThanOrEqualOp",pattern:/<=/,categories:BooleanOp}),ConcatenateOp=createToken({name:"ConcatenateOp",pattern:/&/}),LParen=createToken({name:"LParen",pattern:/\(/}),RParen=createToken({name:"RParen",pattern:/\)/}),ArrayLParen=createToken({name:"ArrayLParen",pattern:/{/}),ArrayRParen=createToken({name:"ArrayRParen",pattern:/}/}),StringLiteral=createToken({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),ErrorLiteral=createToken({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),RangeSeparator=createToken({name:"RangeSeparator",pattern:new RegExp(RANGE_OPERATOR)}),ColumnRange=createToken({name:"ColumnRange",pattern:new RegExp(`${COLUMN_REFERENCE_PATTERN}${RANGE_OPERATOR}${COLUMN_REFERENCE_PATTERN}`)}),RowRange=createToken({name:"RowRange",pattern:new RegExp(`${ROW_REFERENCE_PATTERN}${RANGE_OPERATOR}${ROW_REFERENCE_PATTERN}`)}),ProcedureName=createToken({name:"ProcedureName",pattern:new RegExp(`([${UNICODE_LETTER_PATTERN}][${NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)}),cellReferenceMatcher=new CellReferenceMatcher,CellReference=createToken({name:"CellReference",pattern:cellReferenceMatcher.match.bind(cellReferenceMatcher),start_chars_hint:cellReferenceMatcher.POSSIBLE_START_CHARACTERS,line_breaks:!1}),namedExpressionMatcher=new NamedExpressionMatcher,NamedExpression=createToken({name:"NamedExpression",pattern:namedExpressionMatcher.match.bind(namedExpressionMatcher),start_chars_hint:namedExpressionMatcher.POSSIBLE_START_CHARACTERS,line_breaks:!1}),buildLexerConfig=r=>{const e=r.translationPackage.getFunctionTranslation("OFFSET"),t=r.errorMapping,n=r.translationPackage.buildFunctionMapping(),s=new RegExp(r.ignoreWhiteSpace==="standard"?ODFF_WHITESPACE_PATTERN:ALL_WHITESPACE_PATTERN),o=createToken({name:"WhiteSpace",pattern:s}),a=createToken({name:"ArrayRowSep",pattern:r.arrayRowSeparator}),l=createToken({name:"ArrayColSep",pattern:r.arrayColumnSeparator}),u=createToken({name:"NumberLiteral",pattern:new RegExp(`(([${r.decimalSeparator}]\\d+)|(\\d+([${r.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),c=createToken({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let h,g;r.functionArgSeparator===r.arrayColumnSeparator?(h=l,g=[]):r.functionArgSeparator===r.arrayRowSeparator?(h=a,g=[]):(h=createToken({name:"ArgSeparator",pattern:r.functionArgSeparator}),g=[h]);const v=[o,PlusOp,MinusOp,TimesOp,DivOp,PowerOp,EqualsOp,NotEqualOp,PercentOp,GreaterThanOrEqualOp,LessThanOrEqualOp,GreaterThanOp,LessThanOp,LParen,RParen,ArrayLParen,ArrayRParen,c,ProcedureName,RangeSeparator,...g,ColumnRange,RowRange,u,StringLiteral,ErrorLiteral,ConcatenateOp,BooleanOp,AdditionOp,MultiplicationOp,CellReference,NamedExpression,a,l];return{ArgSeparator:h,NumberLiteral:u,OffsetProcedureName:c,ArrayRowSeparator:a,ArrayColSeparator:l,WhiteSpace:o,allTokens:v,errorMapping:t,functionMapping:n,decimalSeparator:r.decimalSeparator,maxColumns:r.maxColumns,maxRows:r.maxRows}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaParser extends EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:EMPTY_ALT(buildEmptyArgAst())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const s=this.CONSUME(ProcedureName),o=s.image.toUpperCase().slice(0,-1),a=(n=this.lexerConfig.functionMapping[o])!==null&&n!==void 0?n:o,l=[];let u=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var h;const g=this.CONSUME(this.lexerConfig.ArgSeparator);u.type===AstNodeType.EMPTY&&(u.leadingWhitespace=(h=g.leadingWhitespace)===null||h===void 0?void 0:h.image),l.push(u),u=this.SUBRULE2(this.booleanExpressionOrEmpty)}),l.push(u),l.length===1&&l[0].type===AstNodeType.EMPTY&&(l.length=0);const c=this.CONSUME(RParen);return buildProcedureAst(a,l,s.leadingWhitespace,c.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(NamedExpression);return buildNamedExpressionAst(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(RParen),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(ColumnRange),[s,o]=n.image.split(":"),a=this.ACTION(()=>columnAddressFromString(this.sheetMapping,s,this.formulaAddress)),l=this.ACTION(()=>columnAddressFromString(this.sheetMapping,o,this.formulaAddress));if(a===void 0||l===void 0)return buildCellErrorAst(new CellError(ErrorType.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||l.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace);if(a.sheet===void 0&&l.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:c,sheetRefType:h}=FormulaParser.fixSheetIdsForRangeEnds(a,l);return buildColumnRangeAst(u,c,h,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(RowRange),[s,o]=n.image.split(":"),a=this.ACTION(()=>rowAddressFromString(this.sheetMapping,s,this.formulaAddress)),l=this.ACTION(()=>rowAddressFromString(this.sheetMapping,o,this.formulaAddress));if(a===void 0||l===void 0)return buildCellErrorAst(new CellError(ErrorType.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||l.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace);if(a.sheet===void 0&&l.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:c,sheetRefType:h}=FormulaParser.fixSheetIdsForRangeEnds(a,l);return buildRowRangeAst(u,c,h,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(CellReference),s=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress));return s===void 0?buildErrorWithRawInputAst(n.image,new CellError(ErrorType.REF),n.leadingWhitespace):s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?buildErrorWithRawInputAst(n.image,new CellError(ErrorType.NAME),n.leadingWhitespace):buildCellReferenceAst(s,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var s;const o=this.CONSUME(CellReference),a=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress)),l=this.ACTION(()=>cellAddressFromString(this.sheetMapping,o.image,this.formulaAddress));return a===void 0||l===void 0?this.ACTION(()=>buildErrorWithRawInputAst(`${n.image}:${o.image}`,new CellError(ErrorType.REF),n.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||l.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>buildErrorWithRawInputAst(`${n.image}:${o.image}`,new CellError(ErrorType.NAME),n.leadingWhitespace)):this.buildCellRange(a,l,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var s;const o=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>cellAddressFromString(this.sheetMapping,n.image,this.formulaAddress));return a===void 0?buildCellErrorAst(new CellError(ErrorType.REF)):o.type===AstNodeType.CELL_REFERENCE?this.buildCellRange(a,o.reference,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image):this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(CellReference);return this.CONSUME2(RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const s=this.CONSUME(CellReference),o=this.ACTION(()=>cellAddressFromString(this.sheetMapping,s.image,this.formulaAddress));return o===void 0?this.ACTION(()=>buildCellErrorAst(new CellError(ErrorType.REF))):this.buildCellRange(n.reference,o,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const s=this.SUBRULE(this.offsetProcedureExpression);return s.type===AstNodeType.CELL_REFERENCE?this.buildCellRange(n.reference,s.reference,n.leadingWhitespace):this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let s;return this.OPTION(()=>{this.CONSUME(RangeSeparator),n.type===AstNodeType.CELL_RANGE?s=this.parsingError(ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):s=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),s!==void 0?s:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),buildArrayAst(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(LParen),s=this.SUBRULE(this.booleanExpression),o=this.CONSUME(RParen);return buildParenthesisAst(s,n.leadingWhitespace,o.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(ArrayLParen),s=this.SUBRULE(this.insideArrayExpression),o=this.CONSUME(ArrayRParen);return buildArrayAst(s.args,n.leadingWhitespace,o.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const s=n.replace(this.lexerConfig.decimalSeparator,".");return Number(s)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const s=this.CONSUME(this.lexerConfig.NumberLiteral);return buildNumberAst(this.numericStringToNumber(s.image),s.leadingWhitespace)}},{ALT:()=>{const s=this.CONSUME(StringLiteral);return buildStringAst(s)}},{ALT:()=>{const s=this.CONSUME(ErrorLiteral),o=s.image.toUpperCase(),a=this.lexerConfig.errorMapping[o];return a?buildCellErrorAst(new CellError(a),s.leadingWhitespace):this.parsingError(ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),s=this.OPTION(()=>this.CONSUME(PercentOp));return s?buildPercentOpAst(n,s.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(AdditionOp),s=this.SUBRULE(this.atomicExpression);return tokenMatcher(n,PlusOp)?buildPlusUnaryOpAst(s,n.leadingWhitespace):tokenMatcher(n,MinusOp)?buildMinusUnaryOpAst(s,n.leadingWhitespace):(this.customParsingError=parsingError(ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const s=this.CONSUME(PowerOp),o=this.SUBRULE2(this.atomicExpression);tokenMatcher(s,PowerOp)?n=buildPowerOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const s=this.CONSUME(MultiplicationOp),o=this.SUBRULE2(this.powerExpression);tokenMatcher(s,TimesOp)?n=buildTimesOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,DivOp)?n=buildDivOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const s=this.CONSUME(AdditionOp),o=this.SUBRULE2(this.multiplicationExpression);tokenMatcher(s,PlusOp)?n=buildPlusOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,MinusOp)?n=buildMinusOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const s=this.CONSUME(ConcatenateOp),o=this.SUBRULE2(this.additionExpression);n=buildConcatenateOpAst(n,o,s.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const s=this.CONSUME(BooleanOp),o=this.SUBRULE2(this.concatenateExpression);tokenMatcher(s,EqualsOp)?n=buildEqualsOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,NotEqualOp)?n=buildNotEqualOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,GreaterThanOp)?n=buildGreaterThanOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,LessThanOp)?n=buildLessThanOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,GreaterThanOrEqualOp)?n=buildGreaterThanOrEqualOpAst(n,o,s.leadingWhitespace):tokenMatcher(s,LessThanOrEqualOp)?n=buildLessThanOrEqualOpAst(n,o,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=simpleCellAddress(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),s=[];return this.customParsingError&&s.push(this.customParsingError),s=s.concat(this.errors.map(o=>({type:ParsingErrorType.ParserError,message:o.message}))),s.length>0&&(n=buildParsingErrorAst()),{ast:n,errors:s}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:s,secondEnd:o,sheetRefType:a}=FormulaParser.fixSheetIdsForRangeEnds(e,t);return buildCellRangeAst(s,o,a,n)}static fixSheetIdsForRangeEnds(e,t){const n=FormulaParser.rangeSheetReferenceType(e.sheet,t.sheet),s=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:s,sheetRefType:n}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==AstNodeType.CELL_REFERENCE)return this.parsingError(ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let s;if(n.type===AstNodeType.NUMBER&&Number.isInteger(n.value))s=n.value;else if(n.type===AstNodeType.PLUS_UNARY_OP&&n.value.type===AstNodeType.NUMBER&&Number.isInteger(n.value.value))s=n.value.value;else if(n.type===AstNodeType.MINUS_UNARY_OP&&n.value.type===AstNodeType.NUMBER&&Number.isInteger(n.value.value))s=-n.value.value;else return this.parsingError(ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===AstNodeType.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===AstNodeType.PLUS_UNARY_OP&&o.value.type===AstNodeType.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===AstNodeType.MINUS_UNARY_OP&&o.value.type===AstNodeType.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");const l=e[3];let u;if(l===void 0)u=1;else if(l.type===AstNodeType.NUMBER){if(u=l.value,u<1)return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const c=e[4];let h;if(c===void 0)h=1;else if(c.type===AstNodeType.NUMBER){if(h=c.value,h<1)return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const g=new CellAddress(t.reference.col+a,t.reference.row+s,t.reference.type);let v=g.col,m=g.row;if((t.reference.type===CellReferenceType.CELL_REFERENCE_RELATIVE||t.reference.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL)&&(m=m+this.formulaAddress.row),(t.reference.type===CellReferenceType.CELL_REFERENCE_RELATIVE||t.reference.type===CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW)&&(v=v+this.formulaAddress.col),v<0||m<0)return buildCellErrorAst(new CellError(ErrorType.REF,ErrorMessage.OutOfSheet));if(h===1&&u===1)return buildCellReferenceAst(g);{const E=new CellAddress(g.col+h-1,g.row+u-1,g.type);return buildCellRangeAst(g,E,RangeSheetReferenceType.RELATIVE)}}parsingError(e,t){return this.customParsingError=parsingError(e,t),buildParsingErrorAst()}static rangeSheetReferenceType(e,t){return e===void 0?RangeSheetReferenceType.RELATIVE:t===void 0?RangeSheetReferenceType.START_ABSOLUTE:RangeSheetReferenceType.BOTH_ABSOLUTE}}class FormulaLexer{constructor(e){this.lexerConfig=e,this.lexer=new Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return FormulaLexer.filterTokensByNeighbors(e,(t,n,s)=>(tokenMatcher(t,CellReference)||tokenMatcher(t,RangeSeparator))&&tokenMatcher(n,this.lexerConfig.WhiteSpace)&&(tokenMatcher(s,CellReference)||tokenMatcher(s,RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return FormulaLexer.filterTokensByNeighbors(e,(t,n,s)=>!tokenMatcher(t,this.lexerConfig.ArgSeparator)&&tokenMatcher(n,this.lexerConfig.WhiteSpace)&&tokenMatcher(s,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const s=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||s.push(e[n]),++n;return s.push(e[n]),s}trimTrailingWhitespaces(e){return e.length>0&&tokenMatcher(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Unparser{constructor(e,t,n,s){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=s}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,s;switch(e.type){case AstNodeType.EMPTY:return imageWithWhitespace("",e.leadingWhitespace);case AstNodeType.NUMBER:return imageWithWhitespace(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case AstNodeType.STRING:return imageWithWhitespace('"'+e.value+'"',e.leadingWhitespace);case AstNodeType.FUNCTION_CALL:{const o=e.args.map(u=>u!==void 0?this.unparseAst(u,t):"").join(this.config.functionArgSeparator),l=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+o+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(l,e.leadingWhitespace)}case AstNodeType.NAMED_EXPRESSION:{const o=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||n===void 0?void 0:n.displayName;return imageWithWhitespace(o||e.expressionName,e.leadingWhitespace)}case AstNodeType.CELL_REFERENCE:{let o;return e.reference.sheet!==void 0?o=this.unparseSheetName(e.reference.sheet)+"!":o="",o+=(s=e.reference.unparse(t))!==null&&s!==void 0?s:this.config.translationPackage.getErrorTranslation(ErrorType.REF),imageWithWhitespace(o,e.leadingWhitespace)}case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:return imageWithWhitespace(this.formatRange(e,t),e.leadingWhitespace);case AstNodeType.PLUS_UNARY_OP:{const o=this.unparseAst(e.value,t);return imageWithWhitespace("+",e.leadingWhitespace)+o}case AstNodeType.MINUS_UNARY_OP:{const o=this.unparseAst(e.value,t);return imageWithWhitespace("-",e.leadingWhitespace)+o}case AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+imageWithWhitespace("%",e.leadingWhitespace);case AstNodeType.ERROR:{const o=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:ErrorType.ERROR);return imageWithWhitespace(o,e.leadingWhitespace)}case AstNodeType.ERROR_WITH_RAW_INPUT:return imageWithWhitespace(e.rawInput,e.leadingWhitespace);case AstNodeType.PARENTHESIS:{const a="("+this.unparseAst(e.expression,t)+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(a,e.leadingWhitespace)}case AstNodeType.ARRAY:{const o="{"+e.args.map(a=>a.map(l=>this.unparseAst(l,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+imageWithWhitespace("}",e.internalWhitespace);return imageWithWhitespace(o,e.leadingWhitespace)}default:{const o=this.unparseAst(e.left,t),a=this.unparseAst(e.right,t);return o+imageWithWhitespace(binaryOpTokenMap[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const t=sheetIndexToString(e,this.sheetMappingFn);if(t===void 0)throw new NoSheetWithIdError(e);return t}formatRange(e,t){let n="",s="";e.start.sheet!==void 0&&e.sheetReferenceType!==RangeSheetReferenceType.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===RangeSheetReferenceType.BOTH_ABSOLUTE&&(s=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(t),a=e.end.unparse(t);return o===void 0||a===void 0?this.config.translationPackage.getErrorTranslation(ErrorType.REF):`${n}${o}:${s}${a}`}}function formatNumber(r,e){return r.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ParserWithCaching{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=buildLexerConfig(e),this.lexer=new FormulaLexer(this.lexerConfig),this.formulaParser=new FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const g=n.errors.map(v=>({type:ParsingErrorType.LexingError,message:v.message}));return{ast:buildParsingErrorAst(),errors:g,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const s=this.computeHashFromTokens(n.tokens,t);let o=this.cache.get(s);if(o!==void 0)++this.statsCacheUsed;else{const g=this.bindWhitespacesToTokens(n.tokens),v=this.formulaParser.parseFromTokens(g,t);if(v.errors.length>0)return Object.assign(Object.assign({},v),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(s,v.ast)}const{ast:a,hasVolatileFunction:l,hasStructuralChangeFunction:u}=o,c=this.convertReversedRangesToRegularRanges(a),h=collectDependencies(c,this.functionRegistry);return{ast:c,errors:[],hasVolatileFunction:l,hasStructuralChangeFunction:u,dependencies:h}}convertReversedRangesToRegularRanges(e){switch(e.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.CELL_REFERENCE:case AstNodeType.NAMED_EXPRESSION:return e;case AstNodeType.CELL_RANGE:{const{start:t,end:n}=e,s=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.COLUMN_RANGE:{const{start:t,end:n}=e,s=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.ROW_RANGE:{const{start:t,end:n}=e,s=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case AstNodeType.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case AstNodeType.FUNCTION_CALL:{const t=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:t})}case AstNodeType.ARRAY:{const t=e.args.map(n=>n.map(s=>this.convertReversedRangesToRegularRanges(s)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[s,o]=n.map(h=>h.toColumnAddress()).sort(ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(h=>h.toRowAddress()).sort(RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[u,c]=n.map(h=>h.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:CellAddress.fromColAndRow(s,a,u),end:CellAddress.fromColAndRow(o,l,c)}}orderColumnRangeEnds(e,t){const n=[e,t],[s,o]=n.sort(ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(u=>u.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:new ColumnAddress(s.type,s.col,a),end:new ColumnAddress(o.type,o.col,l)}}orderRowRangeEnds(e,t){const n=[e,t],[s,o]=n.sort(RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map(u=>u.sheet).sort(ParserWithCaching.compareSheetIds.bind(this));return{start:new RowAddress(s.type,s.row,a),end:new RowAddress(o.type,o.row,l)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,relativeDependencies:a}=t;return{ast:n,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}}}computeHashFromTokens(e,t){var n;let s="",o=0;for(;o<e.length;){const a=e[o];if(tokenMatcher(a,CellReference)){const l=cellAddressFromString(this.sheetMapping,a.image,t);l===void 0?s=s.concat(a.image):s=s.concat(l.hash(!0))}else if(tokenMatcher(a,ProcedureName)){const l=a.image.toUpperCase().slice(0,-1),u=(n=this.lexerConfig.functionMapping[l])!==null&&n!==void 0?n:l;s=s.concat(u,"(")}else if(tokenMatcher(a,ColumnRange)){const[l,u]=a.image.split(":"),c=columnAddressFromString(this.sheetMapping,l,t),h=columnAddressFromString(this.sheetMapping,u,t);c===void 0||h===void 0?s=s.concat("!REF"):s=s.concat(c.hash(!0),":",h.hash(!0))}else if(tokenMatcher(a,RowRange)){const[l,u]=a.image.split(":"),c=rowAddressFromString(this.sheetMapping,l,t),h=rowAddressFromString(this.sheetMapping,u,t);c===void 0||h===void 0?s=s.concat("!REF"):s=s.concat(c.hash(!0),":",h.hash(!0))}else s=s.concat(a.image);o++}return s}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case AstNodeType.EMPTY:return e.leadingWhitespace||"";case AstNodeType.NUMBER:return imageWithWhitespace(formatNumber(e.value,this.config.decimalSeparator),e.leadingWhitespace);case AstNodeType.STRING:return imageWithWhitespace('"'+e.value+'"',e.leadingWhitespace);case AstNodeType.NAMED_EXPRESSION:return imageWithWhitespace(e.expressionName,e.leadingWhitespace);case AstNodeType.FUNCTION_CALL:{const t=e.args.map(s=>this.computeHashOfAstNode(s)).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(n,e.leadingWhitespace)}case AstNodeType.CELL_REFERENCE:return imageWithWhitespace(e.reference.hash(!0),e.leadingWhitespace);case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==RangeSheetReferenceType.RELATIVE),n=e.end.hash(e.sheetReferenceType===RangeSheetReferenceType.BOTH_ABSOLUTE);return imageWithWhitespace(t+":"+n,e.leadingWhitespace)}case AstNodeType.MINUS_UNARY_OP:return imageWithWhitespace("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case AstNodeType.PLUS_UNARY_OP:return imageWithWhitespace("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+imageWithWhitespace("%",e.leadingWhitespace);case AstNodeType.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:ErrorType.ERROR);return imageWithWhitespace(t,e.leadingWhitespace)}case AstNodeType.ERROR_WITH_RAW_INPUT:return imageWithWhitespace(e.rawInput,e.leadingWhitespace);case AstNodeType.ARRAY:{const t=e.args.map(n=>n.map(s=>this.computeHashOfAstNode(s)).join(",")).join(";");return imageWithWhitespace("{"+t+imageWithWhitespace("}",e.internalWhitespace),e.leadingWhitespace)}case AstNodeType.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+imageWithWhitespace(")",e.internalWhitespace);return imageWithWhitespace(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+imageWithWhitespace(binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];tokenMatcher(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let s=1;s<e.length;++s){const o=e[s];if(tokenMatcher(o,this.lexerConfig.WhiteSpace))continue;const a=e[s-1];tokenMatcher(a,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=a),t.push(o)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const collectDependenciesFn=(r,e,t,n)=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:return;case AstNodeType.NAMED_EXPRESSION:{n&&t.push(new NamedExpressionDependency(r.expressionName));return}case AstNodeType.CELL_REFERENCE:{n&&t.push(new AddressDependency(r.reference));return}case AstNodeType.CELL_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new CellRangeDependency(r.start,r.end));return}case AstNodeType.COLUMN_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new ColumnRangeDependency(r.start,r.end));return}case AstNodeType.ROW_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new RowRangeDependency(r.start,r.end));return}case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:{collectDependenciesFn(r.value,e,t,!0);return}case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:collectDependenciesFn(r.left,e,t,!0),collectDependenciesFn(r.right,e,t,!0);return;case AstNodeType.PARENTHESIS:collectDependenciesFn(r.expression,e,t,n);return;case AstNodeType.FUNCTION_CALL:{const s=!e.doesFunctionNeedArgumentToBeComputed(r.procedureName);r.args.forEach(o=>collectDependenciesFn(o,e,t,s));return}}},collectDependencies=(r,e)=>{const t=new Array;return collectDependenciesFn(r,e,t,!0),t};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddressDependency{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class CellRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class ColumnRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new AbsoluteColumnRange(t.sheet,t.col,n.col)}}class RowRangeDependency{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new AbsoluteRowRange(t.sheet,t.row,n.row)}}class NamedExpressionDependency{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const absolutizeDependencies=(r,e)=>r.map(t=>t.absolutize(e)),filterDependenciesOutOfScope=r=>r.filter(e=>e instanceof NamedExpressionDependency?!0:e instanceof AbsoluteCellRange?!(invalidSimpleCellAddress(e.start)||invalidSimpleCellAddress(e.end)):!invalidSimpleCellAddress(e));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const EmptyValue=Symbol("Empty value");function getRawValue(r){return r instanceof RichNumber?r.val:r}class RichNumber{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function cloneNumber(r,e){if(typeof r=="number")return e;{const t=r.fromNumber(e);return t.format=r.format,t}}class DateNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_DATE}}class CurrencyNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_CURRENCY}}class TimeNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_TIME}}class DateTimeNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_DATETIME}}class PercentNumber extends RichNumber{getDetailedType(){return NumberType.NUMBER_PERCENT}}function isExtendedNumber(r){return typeof r=="number"||r instanceof RichNumber}var NumberType;(function(r){r.NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"})(NumberType||(NumberType={}));function getTypeOfExtendedNumber(r){return r instanceof RichNumber?r.getDetailedType():NumberType.NUMBER_RAW}function getFormatOfExtendedNumber(r){if(r instanceof RichNumber)return r.format}function getTypeFormatOfExtendedNumber(r){return r instanceof RichNumber?{type:r.getDetailedType(),format:r.format}:{type:NumberType.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SimpleRangeValue{constructor(e,t,n,s){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=s,this.size=e===void 0?new ArraySize(t.effectiveWidth(n),t.effectiveHeight(n)):new ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new SimpleRangeValue(e,t,n,!0)}static onlyNumbers(e){return new SimpleRangeValue(e,void 0,void 0,!0)}static onlyValues(e){return new SimpleRangeValue(e,void 0,void 0,void 0)}static onlyRange(e,t){return new SimpleRangeValue(void 0,e,t,void 0)}static fromScalar(e){return new SimpleRangeValue([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let s=0;s<n.length;++s)yield simpleCellAddress(e.sheet,e.col+s,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],simpleCellAddress(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof SimpleRangeValue?(this._hasOnlyNumbers=!1,new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)):(isExtendedNumber(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ContentChanges{constructor(){this.changes=new Map}static empty(){return new ContentChanges}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach(n=>{const s=e.exportChange(n);Array.isArray(s)?t=t.concat(s):t.push(s)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const n=t.value;if(n instanceof SimpleRangeValue)for(const s of n.effectiveAddressesFromData(e))this.changes.delete(addressKey(s));this.changes.set(addressKey(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowsSpan{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new RowsSpan(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new RowsSpan(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new RowsSpan(this.sheet,t,n)}firstRow(){return new RowsSpan(this.sheet,this.rowStart,this.rowStart)}}class ColumnsSpan{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new ColumnsSpan(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new ColumnsSpan(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new ColumnsSpan(this.sheet,t,n)}firstColumn(){return new ColumnsSpan(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var StatType;(function(r){r.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(StatType||(StatType={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Statistics{constructor(){this.stats=new Map([[StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(StatType.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(StatType.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),s=this.startTimes.get(e);if(s){let o=(t=this.stats.get(e))!==null&&t!==void 0?t:0;o+=n-s,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class EmptyStatistics extends Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NoSheetWithIdError extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class NoSheetWithNameError extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class SheetNameAlreadyTakenError extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class SheetSizeLimitExceededError extends Error{constructor(){super("Sheet size limit exceeded")}}class NotAFormulaError extends Error{constructor(){super("This is not a formula")}}class InvalidAddressError extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class InvalidArgumentsError extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class SheetsNotEqual extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class NamedExpressionNameIsAlreadyTakenError extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class NamedExpressionNameIsInvalidError extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class NamedExpressionDoesNotExistError extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class NoOperationToUndoError extends Error{constructor(){super("There is no operation to undo")}}class NoOperationToRedoError extends Error{constructor(){super("There is no operation to redo")}}class NothingToPasteError extends Error{constructor(){super("There is nothing to paste")}}function replacer(r,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class UnableToParseError extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,replacer,4)}`)}}class ExpectedValueOfTypeError extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class ConfigValueEmpty extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class ConfigValueTooSmallError extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class ConfigValueTooBigError extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class ExpectedOneOfValuesError extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class EvaluationSuspendedError extends Error{constructor(){super("Computations are suspended")}}class MissingTranslationError extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class ProtectedFunctionTranslationError extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class LanguageNotRegisteredError extends Error{constructor(){super("Language not registered.")}}class LanguageAlreadyRegisteredError extends Error{constructor(){super("Language already registered.")}}class FunctionPluginValidationError extends Error{static functionNotDeclaredInPlugin(e,t){return new FunctionPluginValidationError(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new FunctionPluginValidationError(`Function method ${e} not found in plugin ${t}`)}}class ProtectedFunctionError extends Error{static cannotRegisterFunctionWithId(e){return new ProtectedFunctionError(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new ProtectedFunctionError(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new ProtectedFunctionError("Cannot unregister protected plugin")}}class SourceLocationHasArrayError extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class TargetLocationHasArrayError extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class NoRelativeAddressesAllowedError extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class AliasAlreadyExisting extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddressMapping{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:n,width:s,fill:o}=t,a=this.policy.call(o);this.addSheet(e,new a(s,n))}getCellValue(e){const t=this.getCell(e);return t===void 0?EmptyValue:t instanceof ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof ValueCellVertex?t.getValues().rawValue:t instanceof ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");const s=n.getCell(e);if(s===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,s),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new NoSheetWithIdError(e);return t.getWidth()}addRows(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new NoSheetWithIdError(e);s.addRows(t,n)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new NoSheetWithIdError(e);s.addColumns(t,n)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new NoSheetWithIdError(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArrayMapping{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t!=null&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(addressKey(e))}setArray(e,t){this.arrayMapping.set(addressKey(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(addressKey(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,(s,o)=>{const a=o.getRange();return t<=a.start.row?[a.shifted(0,n),o]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,(s,o)=>{const a=o.getRange();return t<=a.start.col?[a.shifted(n,0),o]:void 0})}updateArrayVerticesInSheet(e,t){const n=Array();for(const[s,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const a=t(s,o);a!==void 0&&(this.removeArray(s),n.push(a))}n.forEach(([s,o])=>{this.setArray(s,o)})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NotComputedArray{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class ArrayValue{constructor(e){if(this.size=new ArraySize(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof SimpleRangeValue?new ArrayValue(e.data):new ArrayValue([[e]])}simpleRangeValue(){return SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(EmptyValue));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const s of this.array)s.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let s=0;s<e;++s)n.push(new Array(t).fill(EmptyValue));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class ErroredArray{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaVertex{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,s){return n.isScalar()?new FormulaCellVertex(e,t,s):new ArrayVertex(e,t,n,s)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,s]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=s}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class ArrayVertex extends FormulaVertex{constructor(e,t,n,s=0){super(e,t,s),n.isRef?this.array=new ErroredArray(new CellError(ErrorType.REF,ErrorMessage.NoSpaceForArrayResult),ArraySize.error()):this.array=new NotComputedArray(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof CellError)return this.setErrorValue(e),e;const t=ArrayValue.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch{return new CellError(ErrorType.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof CellError||t===EmptyValue))return getRawValue(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,s=e.row-this.cellAddress.row;this.array instanceof ArrayValue&&this.array.set(n,s,t)}setNoSpace(){return this.array=new ErroredArray(new CellError(ErrorType.SPILL,ErrorMessage.NoSpaceForArrayResult),ArraySize.error()),this.getCellValue()}getRange(){return AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof NotComputedArray)}columnsFromArray(){return ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return equalSimpleCellAddress(this.cellAddress,e)}setErrorValue(e){this.array=new ErroredArray(e,this.array.size)}}class FormulaCellVertex extends FormulaVertex{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RangeVertex{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return(n=this.getCriterionFunctionValues(e).get(t))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const collectAddressesDependentToRange=(r,e,t,n,s)=>{if(e instanceof RangeVertex){const l=e.range.intersectionWith(t);return l!==void 0?Array.from(l.addresses(s)):[]}let o,a;if(e instanceof FormulaVertex)o=e.getFormula(n),a=e.getAddress(n);else return[];return collectDependencies(o,r).filter(l=>l instanceof AddressDependency).map(l=>l.dependency.toSimpleCellAddress(a)).filter(l=>t.addressInRange(l))};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var NodeVisitStatus;(function(r){r[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED"})(NodeVisitStatus||(NodeVisitStatus={}));class TopSort{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const s=e.reverse();return s.forEach(o=>this.runDFS(o)),this.postprocess(s,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=NodeVisitStatus.ON_STACK;const t=[e],n=[];for(;t.length>0;){const s=t[t.length-1];switch(this.nodeStatus[s]){case NodeVisitStatus.ON_STACK:{this.handleOnStack(s,n,t);break}case NodeVisitStatus.PROCESSED:{this.handleProcessed(s,n,t);break}case NodeVisitStatus.POPPED:{t.pop();break}}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(s=>{this.entranceTime[s]===void 0&&(n.push(s),this.parent[s]=e,this.nodeStatus[s]=NodeVisitStatus.ON_STACK)}),this.nodeStatus[e]=NodeVisitStatus.PROCESSED}handleProcessed(e,t,n){let s=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(o=>{this.inSCC[o]||(s=this.parent[o]===e?Math.min(s,this.low[o]):Math.min(s,this.entranceTime[o]))}),this.low[e]=s,s===this.entranceTime[e]){const o=[];do o.push(t[t.length-1]),t.pop();while(o[o.length-1]!==e);o.forEach(a=>{this.inSCC[a]=!0}),this.order.push(...o),o.length>1&&o.forEach(a=>{this.sccNonSingletons[a]=!0})}n.pop(),this.nodeStatus[e]=NodeVisitStatus.POPPED}postprocess(e,t,n){const s=[];e.forEach(l=>{s[l]=!0});const o=[],a=[];return this.order.reverse(),this.order.forEach(l=>{const u=this.getAdjacentNodeIds(l);this.sccNonSingletons[l]||u.includes(l)?(a.push(this.nodesSparseArray[l]),t(this.nodesSparseArray[l]),u.forEach(c=>s[c]=!0)):(o.push(this.nodesSparseArray[l]),s[l]&&n(this.nodesSparseArray[l])&&u.forEach(c=>s[c]=!0))}),{sorted:o,cycled:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ProcessableValue{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Graph{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new ProcessableValue({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);return n===void 0||s===void 0?!1:this.edgesSparseArray[n].includes(s)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(n=>n!==void 0).map(n=>this.nodesSparseArray[n]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(s)||this.edgesSparseArray[n].push(s)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(s=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(s)),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);const o=this.edgesSparseArray[n].indexOf(s);if(o===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][o]}removeEdgeIfExists(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);if(n===void 0||s===void 0)return;const o=this.edgesSparseArray[n].indexOf(s);o!==-1&&delete this.edgesSparseArray[n][o]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,n){const s=new TopSort(this.nodesSparseArray,this.edgesSparseArray),o=e.map(a=>this.getNodeId(a)).filter(a=>a!==void 0);return s.getTopSortedWithSccSubgraphFrom(o,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(n=>n!==void 0&&this.nodesSparseArray[n]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([n,s])=>{this.removeEdgeIfExists(s,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(n=>this.nodesSparseArray[n]).filter(n=>n!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RangeMapping{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,n;return(n=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&n!==void 0?n:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const n=keyFromAddresses(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){const t=e.getStart().sheet,n=this.rangeMapping.get(t);if(n===void 0)return;const s=keyFromAddresses(e.getStart(),e.getEnd());n.delete(s),n.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const n=this.rangeMapping.get(e.sheet),s=keyFromAddresses(e,t);return n==null?void 0:n.get(s)}fetchRange(e,t){const n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),s=Array(),o=Array(),a=e.sheet;for(const[u,c]of this.entriesFromSheet(e.sheet)){const h=c.range;e.start<=t(c.range.end)&&(h.removeSpan(e),h.shouldBeRemoved()?(this.removeByKey(a,u),n.push(c)):s.push([u,c]),o.push(c))}const l=[];s.sort((u,c)=>compareBy(u[1],c[1],t));for(const[u,c]of s){const h=keyFromRange(c.range);if(h===u)continue;const g=this.getByKey(a,h);this.removeByKey(a,u),g!==void 0&&c!=g?l.push([g,c]):this.setRange(c)}return{verticesToRemove:n,verticesToMerge:l,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,t,n){return this.updateVerticesFromSheet(e,(s,o)=>t<=o.start.row?(o.range.shiftByRows(n),{changedSize:!1,vertex:o}):t>o.start.row&&t<=o.end.row?(o.range.expandByRows(n),{changedSize:!0,vertex:o}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,n){return this.updateVerticesFromSheet(e,(s,o)=>t<=o.start.col?(o.range.shiftByColumns(n),{changedSize:!1,vertex:o}):t>o.start.col&&t<=o.end.col?(o.range.expandByColumns(n),{changedSize:!0,vertex:o}):void 0)}moveRangesInsideSourceRange(e,t,n,s){this.updateVerticesFromSheet(e.sheet,(o,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(t),a.range.shiftByRows(n),a.range.moveToSheet(s),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=simpleCellAddress(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(n!==void 0){const s=AbsoluteCellRange.fromSimpleCellAddresses(simpleCellAddress(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:s}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[s,o]of this.entriesFromSheet(e)){const a=t(s,o);a!==void 0&&(this.removeByKey(e,s),n.push(a))}return n.forEach(s=>{this.setRange(s.vertex)}),{verticesWithChangedSize:n.filter(s=>s.changedSize).map(s=>s.vertex)}}}function keyFromAddresses(r,e){return`${r.col},${r.row},${e.col},${e.row}`}function keyFromRange(r){return keyFromAddresses(r.start,r.end)}const compareBy=(r,e,t)=>{const n=t(r.range.start),s=t(r.range.start);if(n===s){const o=t(r.range.end),a=t(e.range.end);return o-a}else return n-s};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TranslationPackage{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new MissingTranslationError(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===ErrorType.LIC)return`#${ErrorType.LIC}!`;const t=this.errors[e];if(t===void 0)throw new MissingTranslationError(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new MissingTranslationError(`ui.${e}`);return t}checkUI(){for(const e of Object.values(UIElement))if(!(e in this.ui))throw new MissingTranslationError(`ui.${e}`)}checkErrors(){for(const e of Object.values(ErrorType))if(!(e in this.errors)&&e!==ErrorType.LIC)throw new MissingTranslationError(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new ProtectedFunctionTranslationError(n)}}function buildTranslationPackage(r){return new TranslationPackage(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var UIElement;(function(r){r.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(UIElement||(UIElement={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function canonicalize(r){return r.toLowerCase()}class Sheet{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return canonicalize(this.displayName)}}class SheetMapping{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const n=this.mappingFromCanonicalName.get(canonicalize(t));if(n===void 0)throw new NoSheetWithNameError(t);return n.id},this.get=t=>{var n;return(n=this.mappingFromCanonicalName.get(canonicalize(t)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(UIElement.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=canonicalize(e);if(this.mappingFromCanonicalName.has(t))throw new SheetNameAlreadyTakenError(e);this.lastSheetId++;const n=new Sheet(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(canonicalize(e))}renameSheet(e,t){const n=this.fetchSheetById(e),s=n.displayName;if(s===t)return;const o=this.mappingFromCanonicalName.get(canonicalize(t));if(o!==void 0&&o.id!==n.id)throw new SheetNameAlreadyTakenError(t);const a=n.canonicalName;return this.mappingFromCanonicalName.delete(a),n.displayName=t,this.store(n),s}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new NoSheetWithIdError(e);return t}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DependencyGraph{constructor(e,t,n,s,o,a,l,u){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=s,this.stats=o,this.lazilyTransformingAstService=a,this.functionRegistry=l,this.namedExpressions=u,this.changes=ContentChanges.empty(),this.dependencyQueryAddresses=c=>{if(c instanceof RangeVertex)return this.rangeDependencyQuery(c).map(([h,g])=>h);{const h=this.formulaDependencyQuery(c);if(h!==void 0){const[g,v]=h;return v.map(m=>m instanceof NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(m.name,g.sheet).address:isSimpleCellAddress(m)?m:simpleCellRange(m.start,m.end))}else return[]}},this.dependencyQueryVertices=c=>{if(c instanceof RangeVertex)return this.rangeDependencyQuery(c);{const h=this.formulaDependencyQuery(c);if(h!==void 0){const[g,v]=h;return v.map(m=>{if(m instanceof AbsoluteCellRange)return[m.start,this.rangeMapping.fetchRange(m.start,m.end)];if(m instanceof NamedExpressionDependency){const E=this.namedExpressions.namedExpressionOrPlaceholder(m.name,g.sheet);return[E.address,this.addressMapping.fetchCell(E.address)]}else return[m,this.addressMapping.fetchCell(m)]})}else return[]}},this.rangeDependencyQuery=c=>{const h=[],{smallerRangeVertex:g,restRange:v}=this.rangeMapping.findSmallerRange(c.range);let m;g!==void 0&&this.graph.adjacentNodes(g).has(c)?(m=v,h.push([new AbsoluteCellRange(g.start,g.end),g])):m=c.range;for(const E of m.addresses(this)){const _=this.addressMapping.getCell(E);_!==void 0&&h.push([E,_])}return h},this.formulaDependencyQuery=c=>{let h,g;if(c instanceof FormulaVertex)g=c.getAddress(this.lazilyTransformingAstService),h=c.getFormula(this.lazilyTransformingAstService);else return;const v=collectDependencies(h,this.functionRegistry);return[g,absolutizeDependencies(v,g)]},this.graph=new Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,n,s,o){return new DependencyGraph(new AddressMapping(t.chooseAddressMappingPolicy),new RangeMapping,new SheetMapping(t.translationPackage),new ArrayMapping,o,e,n,s)}setFormulaToCell(e,t,n,s,o,a){const l=FormulaVertex.fromAst(t,e,s,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(l),this.processCellDependencies(n,l),this.graph.markNodeAsDirty(l),o&&this.markAsVolatile(l),a&&this.markAsDependentOnStructureChange(l),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof ArrayVertex&&this.arrayMapping.removeArray(n.getRange()),n instanceof ValueCellVertex)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n));else{const s=new ValueCellVertex(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,s),this.addressMapping.setCell(e,s),this.graph.markNodeAsDirty(s)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return ContentChanges.empty();if(this.graph.adjacentNodes(t).size>0){const n=new EmptyCellVertex;this.exchangeGraphNode(t,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);e.forEach(s=>{if(s instanceof AbsoluteCellRange){const o=s;let a=this.getRange(o.start,o.end);a===void 0&&(a=new RangeVertex(o),this.rangeMapping.setRange(a)),this.graph.addNodeAndReturnId(a);const l=this.graph.getNodeId(a);o.isFinite()||this.graph.markNodeAsInfiniteRange(l);const{smallerRangeVertex:u,restRange:c}=this.rangeMapping.findSmallerRange(o);if(u!==void 0){if(this.graph.addEdge(u,l),a.bruteForce){a.bruteForce=!1;for(const g of o.addresses(this))this.graph.removeEdge(this.fetchCell(g),l)}}else a.bruteForce=!0;const h=this.arrayMapping.getArray(c);if(h!==void 0)this.graph.addEdge(h,l);else for(const g of c.addresses(this)){const{vertex:v,id:m}=this.fetchCellOrCreateEmpty(g);this.graph.addEdge(m??v,l)}this.graph.addEdge(l,n),o.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(a)}else if(s instanceof NamedExpressionDependency){const o=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:a,id:l}=this.fetchNamedExpressionVertex(s.name,o);this.graph.addEdge(l??a,n)}else{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,n)}})}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,s=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,s)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const n=new EmptyCellVertex,s=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:s}}removeRows(e){this.stats.measure(StatType.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromRowsSpan(e)){for(const o of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(o);if(s instanceof ArrayVertex)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,n]of this.addressMapping.sheetEntries(e)){for(const s of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(s);this.removeVertex(n),this.addressMapping.removeCell(t)}this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const n of t)this.removeVertex(n);this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[n,s]of this.addressMapping.sheetEntries(e))s instanceof ArrayVertex?t.add(s):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(StatType.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromColumnsSpan(e)){for(const o of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(o);if(s instanceof ArrayVertex)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(StatType.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const n of t.addresses(this)){const s=this.addressMapping.getCell(n);if(s!==void 0&&!(s instanceof EmptyCellVertex)&&s!==e)return!1}return!0}moveCells(e,t,n,s){for(const o of e.addressesWithDirection(t,n,this)){const a=simpleCellAddress(s,o.col+t,o.row+n);let l=this.addressMapping.getCell(o);const u=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(o),l!==void 0){this.graph.markNodeAsDirty(l),this.addressMapping.setCell(a,l);let c;for(const h of this.graph.adjacentNodes(l))h instanceof RangeVertex&&!e.containsRange(h.range)&&(c=c??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(c,h),this.graph.removeEdge(l,h));c&&(this.graph.markNodeAsDirty(c),this.addressMapping.setCell(o,c))}if(u!==void 0){l===void 0&&this.addressMapping.removeCell(a);for(const c of this.graph.adjacentNodes(u))l=l??this.fetchCellOrCreateEmpty(a).vertex,this.graph.addEdge(l,c),this.graph.markNodeAsDirty(l);this.removeVertex(u)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(o))if(a instanceof RangeVertex&&!e.containsRange(a.range)){this.graph.removeEdge(o,a);for(const l of o.range.addresses(this)){const{vertex:u,id:c}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(c??u,a),this.addressMapping.setCell(l,u),this.graph.markNodeAsDirty(u)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,s)}setArrayEmpty(e){const t=AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const s of t.addresses(this))this.addressMapping.removeCell(s);for(const s of n.values()){const o=collectAddressesDependentToRange(this.functionRegistry,s,e.getRange(),this.lazilyTransformingAstService,this);for(const a of o){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}o.length>0&&this.graph.markNodeAsDirty(s)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const n=this.getScalarValue(t);n!==EmptyValue&&(yield[getRawValue(n),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const s=this.getScalarValue(n);t.push(s)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;t instanceof FormulaVertex?n=this.formulaDirectDependenciesToArray(t,e):n=this.rangeDirectDependenciesToArray(t,e);let s=!1;for(const[o,a]of n)e.isLeftCorner(o)&&(s=!0),this.graph.addEdge(a,t),this.graph.markNodeAsDirty(a);s||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=ContentChanges.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach(s=>{const o=s;o instanceof RangeVertex?n.push(simpleCellRange(o.start,o.end)):n.push(o.getAddress(this.lazilyTransformingAstService))}),n}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(t,s)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:a})=>a.range.addressInRange(e));if(t.length<=0)return;const{vertex:n,id:s}=this.fetchCellOrCreateEmpty(e),o=s??this.graph.getNodeId(n);t.forEach(({id:a})=>{this.graph.addEdge(o,a)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(n=>{this.graph.hasNode(n)&&this.graph.adjacentNodes(n).forEach(s=>{s instanceof ArrayVertex&&t.add(s)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:n})=>{const s=e.range.intersectionWith(n.range);s!==void 0&&s.addresses(this).forEach(o=>{const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const s=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new CellError(ErrorType.REF),n,s):(this.addressMapping.removeCell(n),this.changes.addChange(EmptyValue,n,s)):this.changes.addChange(EmptyValue,n,s)}}*formulaDirectDependenciesToArray(e,t){var n;const[,s]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(s!==void 0){for(const o of s)if(!(o instanceof NamedExpressionDependency||o instanceof AbsoluteCellRange)&&t.getRange().addressInRange(o)){const a=this.fetchCellOrCreateEmpty(o).vertex;yield[o,a]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const s of n.addresses(this))if(t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof FormulaVertex||n instanceof RangeVertex)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const s=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of s)if(o.range.includesRow(t+n))if(o.bruteForce){const a=o.range.rangeWithSameWidth(t,n);for(const l of a.addresses(this)){const{vertex:u,id:c}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(c??u,o)}}else{let a=o,l=this.rangeMapping.findSmallerRange(a.range);if(l.smallerRangeVertex!==void 0)continue;for(;l.smallerRangeVertex===void 0;){const u=new RangeVertex(AbsoluteCellRange.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(u),this.graph.addNodeAndReturnId(u);const c=new AbsoluteCellRange(simpleCellAddress(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(c,a),this.graph.addEdge(u,a),a=u,l=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(l.smallerRangeVertex,a),this.addAllFromRange(l.restRange,a),this.graph.removeEdge(l.smallerRangeVertex,o)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(o??s,t)}}fixRangesWhenAddingColumns(e,t,n){for(const s of this.rangeMapping.rangesInSheet(e))if(s.range.includesColumn(t+n)){let o;s.bruteForce?o=s.range.rangeWithSameHeight(t,n):o=AbsoluteCellRange.spanFrom(simpleCellAddress(e,t,s.range.end.row),n,1);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=AbsoluteCellRange.spanFrom(t,e.width,e.height),s=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof ArrayVertex&&this.setArray(n,e),this.exchangeOrAddGraphNode(s,e),this.addressMapping.setCell(t,e),e instanceof ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this)){if(e.isLeftCorner(o))continue;const a=this.getCell(o);this.exchangeOrAddGraphNode(a,e)}}for(const o of n.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof ArrayVertex))return;const n=AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const s of n.addresses(this))this.addressMapping.setCell(s,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,t);for(const[a,l]of s)this.mergeRangeVertices(a,l);for(const a of n)this.removeVertexAndCleanupDependencies(a);return o}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(RowsSpan.fromRowStartAndEnd(e,t-1,t-1))){const o=s.getRange();for(let a=o.start.col;a<=o.end.col;++a)for(let l=t;l<=o.end.row;++l){const u=simpleCellAddress(e,a,l),c=simpleCellAddress(e,a,l+n),h=s.getArrayCellValue(u);this.addressMapping.moveCell(c,u),this.changes.addChange(EmptyValue,c,h)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const o of s.getRange().addresses(this))this.addressMapping.setCell(o,s);else this.setNoSpaceIfArray(s)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1))){const o=s.getRange();for(let a=o.start.row;a<=o.end.row;++a)for(let l=t;l<=o.end.col;++l){const u=simpleCellAddress(e,l,a),c=simpleCellAddress(e,l+n,a),h=s.getArrayCellValue(u);this.addressMapping.moveCell(c,u),this.changes.addChange(EmptyValue,c,h)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const o of s.getRange().addresses(this))this.addressMapping.setCell(o,s);else this.setNoSpaceIfArray(s)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(e,s)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const n=t.values().next().value;t.delete(n);const[s,o]=n;this.graph.hasNode(o)&&this.graph.adjacentNodesCount(o)===0&&((o instanceof RangeVertex||o instanceof EmptyCellVertex)&&this.graph.removeNode(o).forEach(a=>t.add(a)),o instanceof RangeVertex?this.rangeMapping.removeRange(o):o instanceof EmptyCellVertex&&this.addressMapping.removeCell(s))}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class EmptyCellVertex{constructor(){}getCellValue(){return EmptyValue}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ValueCellVertex{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ParsingErrorVertex{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return CellError.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SparseStrategy{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(n=>{const s=new Map;n.forEach((o,a)=>{a>=e&&(s.set(a+t,o),n.delete(a))}),s.forEach((o,a)=>{n.set(a,o)})}),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach((s,o)=>{o>=e&&(n.set(o+t,s),this.mapping.delete(o))}),n.forEach((s,o)=>{this.mapping.set(o,s)}),this.width+=t}removeRows(e){this.mapping.forEach(s=>{const o=new Map;s.forEach((a,l)=>{l>=e.rowStart&&(s.delete(l),l>e.rowEnd&&o.set(l-e.numberOfRows,a))}),o.forEach((a,l)=>{s.set(l,a)})});const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach((o,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&t.set(a-e.numberOfColumns,o))}),t.forEach((o,a)=>{this.mapping.set(a,o)});const n=Math.min(this.width-1,e.columnEnd),s=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-s)}*getEntries(e){for(const[t,n]of this.mapping)for(const[s,o]of n)yield[simpleCellAddress(e,t,s),o]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[n,s]of t)yield s}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,o]of n)yield o}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const s=t.get(n);s!==void 0&&(yield s)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const s of e.rows()){const o=n.get(s);o!==void 0&&(yield[simpleCellAddress(e.sheet,t,s),o])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,o]of n.entries())yield[simpleCellAddress(e.sheet,t,s),o]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,s]of t)s!==void 0&&(yield s)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DenseStrategy{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let s=0;s<t;s++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)this.mapping[n]!==void 0&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let s=0;s<this.height;s++)this.mapping[s]!==void 0&&this.mapping[s].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const s=this.getCellVertex(n,t);s&&(yield[simpleCellAddress(e,n,t),s])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield[simpleCellAddress(e.sheet,t,n),s])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield[simpleCellAddress(e.sheet,t,n),s])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return(n=this.mapping[t])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ErrorType;(function(r){r.DIV_BY_ZERO="DIV_BY_ZERO",r.NAME="NAME",r.VALUE="VALUE",r.NUM="NUM",r.NA="NA",r.CYCLE="CYCLE",r.REF="REF",r.SPILL="SPILL",r.LIC="LIC",r.ERROR="ERROR"})(ErrorType||(ErrorType={}));var CellType;(function(r){r.FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA"})(CellType||(CellType={}));const getCellType=(r,e)=>r instanceof ArrayVertex?r.isLeftCorner(e)?CellType.ARRAYFORMULA:CellType.ARRAY:r instanceof FormulaCellVertex||r instanceof ParsingErrorVertex?CellType.FORMULA:r instanceof ValueCellVertex?CellType.VALUE:CellType.EMPTY;var CellValueNoNumber;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.ERROR="ERROR"})(CellValueNoNumber||(CellValueNoNumber={}));var CellValueJustNumber;(function(r){r.NUMBER="NUMBER"})(CellValueJustNumber||(CellValueJustNumber={}));const CellValueType=Object.assign(Object.assign({},CellValueNoNumber),CellValueJustNumber),CellValueDetailedType=Object.assign(Object.assign({},CellValueNoNumber),NumberType),CellValueTypeOrd=r=>{switch(r){case CellValueType.EMPTY:return 0;case CellValueType.NUMBER:return 1;case CellValueType.STRING:return 2;case CellValueType.BOOLEAN:return 3;case CellValueType.ERROR:return 4}throw new Error("Cell value not computed")},getCellValueType=r=>{if(r===EmptyValue)return CellValueType.EMPTY;if(r instanceof CellError||r instanceof SimpleRangeValue)return CellValueType.ERROR;if(typeof r=="string")return CellValueType.STRING;if(isExtendedNumber(r))return CellValueType.NUMBER;if(typeof r=="boolean")return CellValueType.BOOLEAN;throw new Error("Cell value not computed")},getCellValueDetailedType=r=>isExtendedNumber(r)?getTypeOfExtendedNumber(r):getCellValueType(r),getCellValueFormat=r=>{if(isExtendedNumber(r))return getFormatOfExtendedNumber(r)};class CellError{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new CellError(ErrorType.ERROR,`${ErrorMessage.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new CellError(this.type,this.message,e):this}}const simpleRowAddress=(r,e)=>({sheet:r,row:e}),invalidSimpleRowAddress=r=>r.row<0,simpleColumnAddress=(r,e)=>({sheet:r,col:e}),invalidSimpleColumnAddress=r=>r.col<0,simpleCellAddress=(r,e,t)=>({sheet:r,col:e,row:t}),invalidSimpleCellAddress=r=>r.col<0||r.row<0,movedSimpleCellAddress=(r,e,t,n)=>simpleCellAddress(e,r.col+t,r.row+n),addressKey=r=>`${r.sheet},${r.row},${r.col}`;function isSimpleCellAddress(r){var e,t,n;return r&&(typeof r=="object"||typeof r=="function")&&typeof((e=r)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=r)===null||t===void 0?void 0:t.col)=="number"&&typeof((n=r)===null||n===void 0?void 0:n.row)=="number"}const absoluteSheetReference=(r,e)=>{var t;return(t=r.sheet)!==null&&t!==void 0?t:e.sheet},equalSimpleCellAddress=(r,e)=>r.sheet===e.sheet&&r.col===e.col&&r.row===e.row;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";function isSimpleCellRange(r){return r&&(typeof r=="object"||typeof r=="function")?"start"in r&&isSimpleCellAddress(r.start)&&"end"in r&&isSimpleCellAddress(r.end):!1}const simpleCellRange=(r,e)=>({start:r,end:e});class AbsoluteCellRange{constructor(e,t){if(e.sheet!==t.sheet)throw new SheetsNotEqual(e.sheet,t.sheet);this.start=simpleCellAddress(e.sheet,e.col,e.row),this.end=simpleCellAddress(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new SheetsNotEqual(e.sheet,t.sheet);const n=t.col-e.col,s=t.row-e.row;return Number.isFinite(s)&&Number.isFinite(n)?new AbsoluteCellRange(e,t):Number.isFinite(s)?new AbsoluteRowRange(e.sheet,e.row,t.row):new AbsoluteColumnRange(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===AstNodeType.CELL_RANGE?AbsoluteCellRange.fromCellRange(e,t):e.type===AstNodeType.COLUMN_RANGE?AbsoluteColumnRange.fromColumnRange(e,t):AbsoluteRowRange.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return AbsoluteCellRange.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new AbsoluteCellRange(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const s=AbsoluteCellRange.spanFromOrUndef(e,t,n);if(s===void 0)throw new Error(WRONG_RANGE_SIZE);return s}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n))return e.col!==0?void 0:new AbsoluteRowRange(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(t))return e.row!==0?void 0:new AbsoluteColumnRange(e.sheet,e.col,e.col+t-1);if(Number.isFinite(n)&&Number.isFinite(t))return new AbsoluteCellRange(e,simpleCellAddress(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,s,o){return new AbsoluteCellRange(simpleCellAddress(e,t,n),simpleCellAddress(e,s,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),s=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(t>n||s>o))return new AbsoluteCellRange(simpleCellAddress(this.sheet,s,t),simpleCellAddress(this.sheet,o,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return AbsoluteCellRange.spanFrom(simpleCellAddress(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const s=simpleCellAddress(this.sheet,this.start.col+n,this.start.row+t);e[t].push(s)}}return e}withStart(e){return new AbsoluteCellRange(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return equalSimpleCellAddress(this.start,e.start)&&equalSimpleCellAddress(this.end,e.end)}addressesArrayMap(e,t){const n=[];let s=this.start.row;for(;s<=this.effectiveEndRow(e);){let o=this.start.col;const a=[];for(;o<=this.effectiveEndColumn(e);)a.push(t(simpleCellAddress(this.start.sheet,o,s))),o++;n.push(a),s++}return n}addresses(e){const t=[];let n=this.start.row;const s=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;n<=s;){let a=this.start.col;for(;a<=o;)t.push(simpleCellAddress(this.start.sheet,a,n)),a++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield simpleCellAddress(this.start.sheet,o,s),o-=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield simpleCellAddress(this.start.sheet,o,s),o-=1;s+=1}}else if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield simpleCellAddress(this.start.sheet,o,s),o+=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield simpleCellAddress(this.start.sheet,o,s),o+=1;s+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return simpleCellAddress(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class AbsoluteColumnRange extends AbsoluteCellRange{constructor(e,t,n){super(simpleCellAddress(e,t,0),simpleCellAddress(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),s=e.end.toSimpleColumnAddress(t);if(n.sheet!==s.sheet)throw new SheetsNotEqual(n.sheet,s.sheet);return new AbsoluteColumnRange(n.sheet,n.col,s.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new AbsoluteColumnRange(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new AbsoluteColumnRange(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class AbsoluteRowRange extends AbsoluteCellRange{constructor(e,t,n){super(simpleCellAddress(e,0,t),simpleCellAddress(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),s=e.end.toSimpleRowAddress(t);if(n.sheet!==s.sheet)throw new SheetsNotEqual(n.sheet,s.sheet);return new AbsoluteRowRange(n.sheet,n.row,s.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new AbsoluteRowRange(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new AbsoluteRowRange(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InterpreterState{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function collatorFromConfig(r){const e=r.caseSensitive?r.accentSensitive?"variant":"case":r.accentSensitive?"accent":"base",t=r.caseFirst,n=r.ignorePunctuation;return new Intl.Collator(r.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const COMPLEX_NUMBER_SYMBOL="i",complexParsingRegexp=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class ArithmeticHelper{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(s,o)=>this.compare(s,o)<0,this.leq=(s,o)=>this.compare(s,o)<=0,this.gt=(s,o)=>this.compare(s,o)>0,this.geq=(s,o)=>this.compare(s,o)>=0,this.eq=(s,o)=>this.compare(s,o)===0,this.neq=(s,o)=>this.compare(s,o)!==0,this.pow=(s,o)=>Math.pow(getRawValue(s),getRawValue(o)),this.addWithEpsilonRaw=(s,o)=>{const a=s+o;return Math.abs(a)<this.actualEps*Math.abs(s)?0:a},this.addWithEpsilon=(s,o)=>{const a=inferExtendedNumberTypeAdditive(s,o);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(getRawValue(s),getRawValue(o)),a)},this.unaryMinus=s=>cloneNumber(s,-getRawValue(s)),this.unaryPlus=s=>s,this.unaryPercent=s=>new PercentNumber(getRawValue(s)/100),this.concat=(s,o)=>s.concat(o),this.nonstrictadd=(s,o)=>s instanceof CellError?s:o instanceof CellError?o:typeof s=="number"?typeof o=="number"?this.addWithEpsilonRaw(s,o):s:typeof o=="number"?o:0,this.subtract=(s,o)=>{const a=inferExtendedNumberTypeAdditive(s,o),l=getRawValue(s),u=getRawValue(o);let c=l-u;return Math.abs(c)<this.actualEps*Math.abs(l)&&(c=0),this.ExtendedNumberFactory(c,a)},this.divide=(s,o)=>{const a=getRawValue(s),l=getRawValue(o);if(l===0)return new CellError(ErrorType.DIV_BY_ZERO);{const u=inferExtendedNumberTypeMultiplicative(s,o);return this.ExtendedNumberFactory(a/l,u)}},this.multiply=(s,o)=>{const a=inferExtendedNumberTypeMultiplicative(s,o);return this.ExtendedNumberFactory(getRawValue(s)*getRawValue(o),a)},this.manyToExactComplex=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(isExtendedNumber(a)||typeof a=="string"){const l=this.coerceScalarToComplex(a);l instanceof CellError||o.push(l)}}return o},this.coerceNumbersExactRanges=s=>this.manyToNumbers(s,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=s=>this.manyToNumbers(s,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;isExtendedNumber(a)&&o.push(getRawValue(a))}return o},this.manyToOnlyNumbersDropNulls=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(isExtendedNumber(a))o.push(getRawValue(a));else if(a!==EmptyValue)return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected)}return o},this.manyToCoercedNumbersDropNulls=s=>{const o=[];for(const a of s){if(a instanceof CellError)return a;if(a===EmptyValue)continue;const l=this.coerceScalarToNumberOrError(a);isExtendedNumber(l)&&o.push(getRawValue(l))}return o},this.collator=collatorFromConfig(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n=="string"&&t.test(this.normalizeString(n))}neqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n!="string"||!t.test(this.normalizeString(n))}searchString(e,t){var n;const o=this.buildRegex(e,!1).exec(t);return(n=o==null?void 0:o.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(isWildcard(n)||this.config.useRegularExpressions&&needsEscape(n))return!0}return!1}floatCmp(e,t){const n=getRawValue(e),s=getRawValue(t),o=1+this.actualEps;return s>=0&&n*o>=s&&n<=s*o||s<=0&&n*o<=s&&n>=s*o?0:n>s?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof CellError?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new CellError(ErrorType.VALUE,ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===EmptyValue)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return isExtendedNumber(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const n=t.slice(0,t.length-1).trim(),s=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(s!==void 0)return new PercentNumber(s/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[n,s]=t,o=this.numberLiteralsHelper.numericStringToMaybeNumber(s);if(o!==void 0)return new CurrencyNumber(o,n)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const s of e)if(s instanceof SimpleRangeValue)t.push(s);else if(s!==EmptyValue){const o=this.coerceScalarToComplex(s);if(o instanceof CellError)return o;t.push(o)}const n=[];for(const s of t)if(s instanceof SimpleRangeValue){const o=this.manyToExactComplex(s.valuesFromTopLeftCorner());if(o instanceof CellError)return o;n.push(...o)}else n.push(s);return n}coerceScalarToComplex(e){return e instanceof CellError?e:e===EmptyValue?[0,0]:isExtendedNumber(e)?[getRawValue(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:s}=t;switch(n){case NumberType.NUMBER_RAW:return e;case NumberType.NUMBER_CURRENCY:return new CurrencyNumber(e,s??this.config.currencySymbol[0]);case NumberType.NUMBER_DATE:return new DateNumber(e,s);case NumberType.NUMBER_DATETIME:return new DateTimeNumber(e,s);case NumberType.NUMBER_TIME:return new TimeNumber(e,s);case NumberType.NUMBER_PERCENT:return new PercentNumber(e,s)}}buildRegex(e,t=!0){e=this.normalizeString(e);let n,s=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,s=!1}return o?n=escapeNoCharacters(e,this.config.caseSensitive):s?n=escapeNonWildcards(e,this.config.caseSensitive):n=escapeAllCharacters(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=normalizeString(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,s=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(isExtendedNumber(n)&&isExtendedNumber(s))return this.floatCmp(n,s)}return e===EmptyValue?e=coerceEmptyToValue(t):t===EmptyValue&&(t=coerceEmptyToValue(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?numberCmp(coerceBooleanToNumber(e),coerceBooleanToNumber(t)):isExtendedNumber(e)&&isExtendedNumber(t)?this.floatCmp(e,t):e===EmptyValue&&t===EmptyValue?0:numberCmp(CellValueTypeOrd(getCellValueType(e)),CellValueTypeOrd(getCellValueType(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const o of e)if(o instanceof SimpleRangeValue)n.push(o);else{const a=getRawValue(this.coerceScalarToNumberOrError(o));if(a instanceof CellError)return a;n.push(a)}const s=[];for(const o of n)if(o instanceof SimpleRangeValue){const a=t(o.valuesFromTopLeftCorner());if(a instanceof CellError)return a;s.push(...a)}else s.push(o);return s}coerceStringToComplex(e){const t=complexParsingRegexp.exec(e);if(t===null)return new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected);let n;if(t[6]!==void 0?n=t[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(t[1]+t[3],t[5]),n instanceof CellError||t[8]===void 0)return n;let s;return t[14]!==void 0?s=t[9]==="-"?[0,-1]:[0,1]:s=this.parseComplexToken(t[9]+t[11],t[13]),s instanceof CellError?s:t[5]!==""||t[13]===""?new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected):t[8]==="+"?[n[0]+s[0],n[1]+s[1]]:[n[0]-s[0],n[1]-s[1]]}parseComplexToken(e,t){const n=getRawValue(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new CellError(ErrorType.NUM,ErrorMessage.ComplexNumberExpected):t===""?[n,0]:[0,n]}}function coerceComplexToString([r,e],t){if(!isFinite(r)||!isFinite(e))return new CellError(ErrorType.NUM,ErrorMessage.NaN);if(t=t??COMPLEX_NUMBER_SYMBOL,e===0)return`${r}`;const n=`${e===-1||e===1?"":Math.abs(e)}${t}`;return r===0?`${e<0?"-":""}${n}`:`${r}${e<0?"-":"+"}${n}`}function coerceToRange(r){return r instanceof SimpleRangeValue?r:SimpleRangeValue.fromScalar(r)}function coerceBooleanToNumber(r){return Number(r)}function coerceEmptyToValue(r){return typeof r=="string"?"":isExtendedNumber(r)?0:typeof r=="boolean"?!1:EmptyValue}function coerceScalarToBoolean(r){if(r instanceof CellError||typeof r=="boolean")return r;if(r===EmptyValue)return!1;if(isExtendedNumber(r))return getRawValue(r)!==0;{const e=r.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function coerceScalarToString(r){return r instanceof CellError||typeof r=="string"?r:r===EmptyValue?"":isExtendedNumber(r)?getRawValue(r).toString():r?"TRUE":"FALSE"}function zeroIfEmpty(r){return r===EmptyValue?0:r}function numberCmp(r,e){const t=getRawValue(r),n=getRawValue(e);return t>n?1:t<n?-1:0}function isNumberOverflow(r){return isNaN(r)||r===1/0||r===-1/0}function fixNegativeZero(r){return r===0?0:r}function isWildcard(r){return["*","?"].includes(r)}const escapedCharacters=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function needsEscape(r){return escapedCharacters.includes(r)}function escapeNonWildcards(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);if(s==="~"){if(n==r.length-1){t+="~";continue}const o=r.charAt(n+1);isWildcard(o)||needsEscape(o)?(t+="\\"+o,n++):(t+=o,n++)}else isWildcard(s)?t+="."+s:needsEscape(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function escapeAllCharacters(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);isWildcard(s)||needsEscape(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function escapeNoCharacters(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);isWildcard(s)||needsEscape(s)||e?t+=s:t+=s.toLowerCase()}return t}function inferExtendedNumberTypeAdditive(r,e){const{type:t,format:n}=getTypeFormatOfExtendedNumber(r),{type:s,format:o}=getTypeFormatOfExtendedNumber(e);if(t===NumberType.NUMBER_RAW)return{type:s,format:o};if(s===NumberType.NUMBER_RAW)return{type:t,format:n};if((t===NumberType.NUMBER_DATETIME||t===NumberType.NUMBER_DATE)&&(s===NumberType.NUMBER_DATETIME||s===NumberType.NUMBER_DATE))return{type:NumberType.NUMBER_RAW};if(t===NumberType.NUMBER_TIME){if(s===NumberType.NUMBER_DATE)return{type:NumberType.NUMBER_DATETIME,format:`${o} ${n}`};if(s===NumberType.NUMBER_DATETIME)return{type:NumberType.NUMBER_DATETIME,format:o}}if(s===NumberType.NUMBER_TIME){if(t===NumberType.NUMBER_DATE)return{type:NumberType.NUMBER_DATETIME,format:`${n} ${o}`};if(t===NumberType.NUMBER_DATETIME)return{type:NumberType.NUMBER_DATETIME,format:n}}return{type:t,format:n}}function inferExtendedNumberTypeMultiplicative(r,e){let{type:t,format:n}=getTypeFormatOfExtendedNumber(r),{type:s,format:o}=getTypeFormatOfExtendedNumber(e);return t===NumberType.NUMBER_PERCENT&&(t=NumberType.NUMBER_RAW,n=void 0),s===NumberType.NUMBER_PERCENT&&(s=NumberType.NUMBER_RAW,o=void 0),t===NumberType.NUMBER_RAW?{type:s,format:o}:s===NumberType.NUMBER_RAW?{type:t,format:n}:{type:NumberType.NUMBER_RAW}}function forceNormalizeString(r){return normalizeString(r.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function coerceRangeToScalar(r,e){var t;if(r.isAdHoc())return(t=r.data[0])===null||t===void 0?void 0:t[0];const n=r.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const s=e.formulaAddress.row-n.start.row;if(s>=0&&s<n.height())return r.data[s][0]}else if(n.height()===1){const s=e.formulaAddress.col-n.start.col;if(s>=0&&s<n.width())return r.data[0][s]}}}function normalizeString(r,e){return r.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var FunctionArgumentType;(function(r){r.STRING="STRING",r.NUMBER="NUMBER",r.BOOLEAN="BOOLEAN",r.SCALAR="SCALAR",r.NOERROR="NOERROR",r.RANGE="RANGE",r.INTEGER="INTEGER",r.COMPLEX="COMPLEX",r.ANY="ANY"})(FunctionArgumentType||(FunctionArgumentType={}));class FunctionPlugin{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,n,s,o)=>{const a=this.evaluateArguments(t,n,s),l=a.map(([E,_])=>E),u=a.map(([E,_])=>_),c=this.buildMetadataForEachArgumentValue(l.length,s),h=n.arraysFlag&&!s.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(c,l.length))return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);const[g,v]=h?this.calculateSizeOfVectorizedResultArray(l,c):[1,1];if(g===1&&v===1){const E=this.vectorizeAndBroadcastArgumentsIfNecessary(h,l,c,0,0);return this.calculateSingleCellOfResultArray(n,E,c,u,o,s.returnNumberType)}const m=[...Array(g).keys()].map(E=>[...Array(v).keys()].map(_=>{const S=this.vectorizeAndBroadcastArgumentsIfNecessary(h,l,c,E,_),w=this.calculateSingleCellOfResultArray(n,S,c,u,o,s.returnNumberType);if(w instanceof SimpleRangeValue)throw new Error("Function returning array cannot be vectorized.");return w}));return SimpleRangeValue.onlyValues(m)},this.runFunctionWithReferenceArgument=(t,n,s,o,a,l=()=>new CellError(ErrorType.NA,ErrorMessage.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(o(),s.returnNumberType);if(t.length>1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);let u=t[0];for(;u.type===AstNodeType.PARENTHESIS;)u=u.expression;let c;if(u.type===AstNodeType.CELL_REFERENCE)c=u.reference.toSimpleCellAddress(n.formulaAddress);else if(u.type===AstNodeType.CELL_RANGE||u.type===AstNodeType.COLUMN_RANGE||u.type===AstNodeType.ROW_RANGE)try{c=AbsoluteCellRange.fromAst(u,n.formulaAddress).start}catch{return new CellError(ErrorType.REF,ErrorMessage.CellRefExpected)}return c!==void 0?this.returnNumberWrapper(a(c),s.returnNumberType):this.runFunction(t,n,s,l)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const s of e){const o=this.evaluateAst(s,t);if(o instanceof SimpleRangeValue)for(const a of o.valuesFromTopLeftCorner())n.push([a,!0]);else n.push([o,!1])}return n}coerceToType(e,t,n){let s;if(e instanceof SimpleRangeValue)switch(t.argumentType){case FunctionArgumentType.RANGE:case FunctionArgumentType.ANY:s=e;break;default:{const o=coerceRangeToScalar(e,n);if(o===void 0)return;e=o}}if(!(e instanceof SimpleRangeValue))switch(t.argumentType){case FunctionArgumentType.INTEGER:case FunctionArgumentType.NUMBER:const o=this.coerceScalarToNumberOrError(e);if(!isExtendedNumber(o)){s=o;break}const a=getRawValue(o);if(t.maxValue!==void 0&&a>t.maxValue)return new CellError(ErrorType.NUM,ErrorMessage.ValueLarge);if(t.minValue!==void 0&&a<t.minValue)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);if(t.lessThan!==void 0&&a>=t.lessThan)return new CellError(ErrorType.NUM,ErrorMessage.ValueLarge);if(t.greaterThan!==void 0&&a<=t.greaterThan)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);if(t.argumentType===FunctionArgumentType.INTEGER&&!Number.isInteger(a))return new CellError(ErrorType.NUM,ErrorMessage.IntegerExpected);s=o;break;case FunctionArgumentType.STRING:s=coerceScalarToString(e);break;case FunctionArgumentType.BOOLEAN:s=coerceScalarToBoolean(e);break;case FunctionArgumentType.SCALAR:case FunctionArgumentType.NOERROR:case FunctionArgumentType.ANY:s=e;break;case FunctionArgumentType.RANGE:if(e instanceof CellError)return e;s=coerceToRange(e);break;case FunctionArgumentType.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(getRawValue(e))}return t.passSubtype||s===void 0?s:getRawValue(s)}calculateSingleCellOfResultArray(e,t,n,s,o,a){const l=this.coerceArgumentsToRequiredTypes(e,t,n,s);if(l instanceof CellError)return l;const u=o(...l);return this.returnNumberWrapper(u,a)}coerceArgumentsToRequiredTypes(e,t,n,s){const o=[];for(let a=0;a<n.length;a++){const l=n[a],u=t[a]!==void 0?t[a]:l==null?void 0:l.defaultValue;if(u===void 0){o.push(void 0);continue}const c=this.coerceToType(u,l,e);if(c===void 0&&!s[a])return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(c instanceof CellError&&l.argumentType!==FunctionArgumentType.SCALAR)return c;o.push(c)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,s,o){return t.map((a,l)=>e&&this.isRangePassedAsAScalarArgument(a,n[l])?this.vectorizeAndBroadcastRangeArgument(a,s,o):a)}vectorizeAndBroadcastRangeArgument(e,t,n){var s;const o=e.height()===1?0:t,a=e.width()===1?0:n;return(s=e.data[o])===null||s===void 0?void 0:s[a]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map(s=>[this.evaluateAst(s,t),!1])}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(o=>(o==null?void 0:o.optionalArg)||(o==null?void 0:o.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter((a,l)=>this.isRangePassedAsAScalarArgument(a,t[l])),s=Math.max(1,...n.map(a=>a.height())),o=Math.max(1,...n.map(a=>a.width()));return[s,o]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof SimpleRangeValue&&![FunctionArgumentType.RANGE,FunctionArgumentType.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return t!==void 0&&isExtendedNumber(e)?this.arithmeticHelper.ExtendedNumberFactory(getRawValue(e),{type:t,format:n}):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArraySize{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new ArraySize(1,1,!0)}static scalar(){return new ArraySize(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function arraySizeForBinaryOp(r,e){return new ArraySize(Math.max(r.width,e.width),Math.max(r.height,e.height))}function arraySizeForUnaryOp(r){return new ArraySize(r.width,r.height)}class ArraySizePredictor{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:case AstNodeType.CELL_RANGE:{const n=AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return n===void 0?ArraySize.error():new ArraySize(n.width(),n.height(),!0)}case AstNodeType.ARRAY:{const n=[],s=[];for(const l of e.args){const u=l.map(g=>this.checkArraySizeForAst(g,t)),c=Math.min(...u.map(g=>g.height)),h=u.reduce((g,v)=>g+v.width,0);n.push(c),s.push(h)}const o=n.reduce((l,u)=>l+u,0),a=Math.min(...s);return new ArraySize(a,o)}case AstNodeType.STRING:case AstNodeType.NUMBER:return ArraySize.scalar();case AstNodeType.CELL_REFERENCE:return new ArraySize(1,1,!0);case AstNodeType.DIV_OP:case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.PLUS_OP:case AstNodeType.POWER_OP:case AstNodeType.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),s=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||s.height>1||s.width>1)?ArraySize.error():arraySizeForBinaryOp(n,s)}case AstNodeType.MINUS_UNARY_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?ArraySize.error():arraySizeForUnaryOp(n)}case AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case AstNodeType.EMPTY:return ArraySize.error();default:return ArraySize.error()}}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(n!==void 0)return n(e,t);const s=this.functionRegistry.getMetadata(e.procedureName);if(s===void 0||s.expandRanges||!t.arraysFlag||s.vectorizationForbidden||s.parameters===void 0)return new ArraySize(1,1);const o=e.args.map(c=>{var h;return this.checkArraySizeForAst(c,new InterpreterState(t.formulaAddress,t.arraysFlag||((h=s==null?void 0:s.arrayFunction)!==null&&h!==void 0?h:!1)))}),a=[...s.parameters];if(s.repeatLastArgs!==void 0&&a.length<o.length&&(o.length-a.length)%s.repeatLastArgs!==0)return ArraySize.error();for(;a.length<o.length;){if(s.repeatLastArgs===void 0)return ArraySize.error();a.push(...a.slice(a.length-s.repeatLastArgs))}let l=1,u=1;for(let c=0;c<o.length;c++)a[c].argumentType!==FunctionArgumentType.RANGE&&a[c].argumentType!==FunctionArgumentType.ANY&&(u=Math.max(u,o[c].height),l=Math.max(l,o[c].width));return new ArraySize(l,u)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DetailedCellError{constructor(e,t,n){var s;this.value=t,this.address=n,this.type=e.type,this.message=(s=e.message)!==null&&s!==void 0?s:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function configValueFromParam(r,e,t){if(typeof r>"u")return Config.defaultConfig[t];if(typeof e=="string"){if(typeof r===e)return r;throw new ExpectedValueOfTypeError(e,t)}else{if(e.includes(r))return r;throw new ExpectedOneOfValuesError(e.map(n=>`'${n}'`).join(" "),t)}}function validateNumberToBeAtLeast(r,e,t){if(r<t)throw new ConfigValueTooSmallError(e,t)}function validateNumberToBeAtMost(r,e,t){if(r>t)throw new ConfigValueTooBigError(e,t)}function configValueFromParamCheck(r,e,t,n){if(e(r))return r;if(typeof r>"u")return Config.defaultConfig[n];throw new ExpectedValueOfTypeError(t,n)}function configCheckIfParametersNotInConflict(...r){const e=new Map;r.forEach(n=>{const s=e.get(n.value)||[];s.push(n.name),e.set(n.value,s)});const t=[];for(const n of e.values())n.length>1&&t.push(n);if(t.length>0){t.forEach(s=>s.sort());const n=t.map(s=>`[${s}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function validateArgToType(r,e,t){if(typeof r!==e)throw new ExpectedValueOfTypeError(e,t)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const TIME_FORMAT_SECONDS_ITEM_REGEXP=new RegExp("^ss(\\.(s+|0+))?$"),QUICK_CHECK_REGEXP=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),WHITESPACE_REGEXP=new RegExp("\\s+"),DATE_SEPARATOR_REGEXP=new RegExp("[ /.-]"),TIME_SEPARATOR=":",SECONDS_PRECISION=1e3,memoizedParseTimeFormat=memoize(parseTimeFormat),memoizedParseDateFormat=memoize(parseDateFormat);function defaultParseToDateTime(r,e,t){if(e===void 0&&t===void 0)return;let n=r.replace(WHITESPACE_REGEXP," ").trim().toLowerCase();if(!doesItLookLikeADateTimeQuickCheck(n))return;let s=n.substring(n.length-2);s==="am"||s==="pm"?n=n.substring(0,n.length-2).trim():(s=n.substring(n.length-1),s==="a"||s==="p"?n=n.substring(0,n.length-1).trim():s=void 0);const o=n.split(DATE_SEPARATOR_REGEXP);o.length>=2&&o[o.length-2].includes(TIME_SEPARATOR)&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());const a=o[o.length-1].split(TIME_SEPARATOR);if(s!==void 0&&a.push(s),o.length===1)return defaultParseToTime(a,t);if(a.length===1)return defaultParseToDate(o,e);const l=defaultParseToDate(o.slice(0,o.length-1),e),u=defaultParseToTime(a,t);if(l!==void 0)return u===void 0?void 0:Object.assign(Object.assign({},l),u)}function defaultParseToTime(r,e){var t,n,s;if(e===void 0)return;const{itemsCount:o,hourItem:a,minuteItem:l,secondItem:u}=memoizedParseTimeFormat(e);let c;if(r[r.length-1]==="am"||r[r.length-1]==="a"?(c=!1,r.pop()):(r[r.length-1]==="pm"||r[r.length-1]==="p")&&(c=!0,r.pop()),r.length!==o)return;const h=Number((t=r[u])!==null&&t!==void 0?t:"0");if(!Number.isFinite(h))return;const g=Math.round(h*SECONDS_PRECISION)/SECONDS_PRECISION,v=Number((n=r[l])!==null&&n!==void 0?n:"0");if(!(Number.isFinite(v)&&Number.isInteger(v)))return;const m=Number((s=r[a])!==null&&s!==void 0?s:"0");return!(Number.isFinite(m)&&Number.isInteger(m))||c!==void 0&&(m<0||m>12)?void 0:{hours:c!==void 0?m%12+(c?12:0):m,minutes:v,seconds:g}}function defaultParseToDate(r,e){var t;if(e===void 0)return;const{itemsCount:n,dayItem:s,monthItem:o,shortYearItem:a,longYearItem:l}=memoizedParseDateFormat(e);if(r.length!==n)return;const u=Number(r[s]);if(!(Number.isFinite(u)&&Number.isInteger(u)))return;const c=Number(r[o]);if(!(Number.isFinite(c)&&Number.isInteger(c))||r[l]&&r[a])return;const h=Number((t=r[l])!==null&&t!==void 0?t:r[a]);if(Number.isFinite(h)&&Number.isInteger(h)&&!(r[l]&&(h<1e3||h>9999))&&!(r[a]&&(h<0||h>99)))return{year:h,month:c,day:u}}function parseTimeFormat(r){const e=r.toLowerCase().trim(),n=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,r.length-3):e).trim().split(TIME_SEPARATOR);return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex(s=>TIME_FORMAT_SECONDS_ITEM_REGEXP.test(s))}}function parseDateFormat(r){const e=r.toLowerCase().trim().split(DATE_SEPARATOR_REGEXP);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function doesItLookLikeADateTimeQuickCheck(r){return QUICK_CHECK_REGEXP.test(r)}function memoize(r){const e={};return t=>{const n=e[t];if(n!==void 0)return n;const s=r(t);return e[t]=s,s}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const numDays=[31,28,31,30,31,30,31,31,30,31,30,31],prefSumDays=[0,31,59,90,120,151,181,212,243,273,304,334],SECONDS_PER_MINUTE=60,MINUTES_PER_HOUR=60,HOURS_PER_DAY=24;function instanceOfSimpleDate(r){return r&&(typeof r=="object"||typeof r=="function")?"year"in r&&typeof r.year=="number"&&"month"in r&&typeof r.month=="number"&&"day"in r&&typeof r.day=="number":!1}function instanceOfSimpleTime(r){return r&&(typeof r=="object"||typeof r=="function")?"hours"in r&&typeof r.hours=="number"&&"minutes"in r&&typeof r.minutes=="number"&&"seconds"in r&&typeof r.seconds=="number":!1}const maxDate={year:9999,month:12,day:31};class DateTimeHelper{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(maxDate),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:s=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return instanceOfSimpleTime(t)?instanceOfSimpleDate(t)?new DateTimeNumber(timeToNumber(t)+this.dateToNumber(t),n+" "+s):new TimeNumber(timeToNumber(t),s):instanceOfSimpleDate(t)?new DateNumber(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=numDays[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const s=t-this.dateToNumberFromZero({year:n,month:1,day:1}),o=dayToMonth(s-(this.isLeapYear(n)&&s>=59?1:0)),a=s-prefSumDays[o]-(this.isLeapYear(n)&&o>1?1:0);return{year:n,month:o+1,day:a+1}}numberToSimpleDateTime(e){const t=numberToSimpleTime(e%1),n=Math.floor(t.hours/HOURS_PER_DAY);t.hours=t.hours%HOURS_PER_DAY;const s=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},s),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:numDays[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const s=this.parseDateTime(e,t,n);if(!(instanceOfSimpleDate(s)&&(s.year>=0&&s.year<100&&(s.year<this.getNullYear()?s.year+=2e3:s.year+=1900),!this.isValidDate(s))))return s}parseDateTimeFromFormats(e,t,n){const s=t.length===0?[void 0]:t,o=n.length===0?[void 0]:n;for(const a of s)for(const l of o){const u=this.parseSingleFormat(e,a,l);if(u!==void 0)return{dateTime:u,timeFormat:l,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+prefSumDays[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function dayToMonth(r){let e=0;return prefSumDays[e+6]<=r&&(e+=6),prefSumDays[e+3]<=r&&(e+=3),prefSumDays[e+2]<=r?e+=2:prefSumDays[e+1]<=r&&(e+=1),e}function offsetMonth(r,e){const t=12*r.year+r.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:r.day}}function truncateDayInMonth(r){return{year:r.year,month:r.month,day:Math.min(r.day,numDays[r.month-1])}}function roundToNearestSecond(r){return Math.round(r*3600*24)/(3600*24)}function roundToEpsilon(r,e=1){return Math.round(r*e)/e}function numberToSimpleTime(r){const e=r*HOURS_PER_DAY*MINUTES_PER_HOUR*SECONDS_PER_MINUTE,t=roundToEpsilon(e%SECONDS_PER_MINUTE,1e5)%SECONDS_PER_MINUTE,n=(e-t)/SECONDS_PER_MINUTE,s=Math.round(n%MINUTES_PER_HOUR)%MINUTES_PER_HOUR,o=(n-s)/MINUTES_PER_HOUR;return{hours:Math.round(o),minutes:s,seconds:t}}function timeToNumber(r){return((r.seconds/60+r.minutes)/60+r.hours)/24}function toBasisEU(r){return{year:r.year,month:r.month,day:Math.min(30,r.day)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AlwaysDense{call(){return DenseStrategy}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const dateFormatRegex=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,numberFormatRegex=/(\\.|[#0]+(\.[#0]*)?)/g;var TokenType;(function(r){r.FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT"})(TokenType||(TokenType={}));function formatToken(r,e){return{type:r,value:e}}var FormatExpressionType;(function(r){r.DATE="DATE",r.NUMBER="NUMBER",r.STRING="STRING"})(FormatExpressionType||(FormatExpressionType={}));function matchDateFormat(r){dateFormatRegex.lastIndex=0;const e=[];let t;do t=dateFormatRegex.exec(r),t!==null&&e.push(t);while(t);return e}function matchNumberFormat(r){numberFormatRegex.lastIndex=0;const e=numberFormatRegex.exec(r);return e!==null?[e]:[]}function createTokens(r,e){const t=[];let n=0;for(let o=0;o<r.length;++o){const a=r[o];if(a.index!==n){const l=e.substr(n,a.index-n);t.push(formatToken(TokenType.FREE_TEXT,l))}a[0].startsWith("\\")?t.push(formatToken(TokenType.FREE_TEXT,a[0])):t.push(formatToken(TokenType.FORMAT,a[0])),n=a.index+a[0].length}const s=r[r.length-1];if(s.index+s[0].length<e.length){const o=e.substr(s.index+s[0].length,e.length);t.push(formatToken(TokenType.FREE_TEXT,o))}return t}function parseForDateTimeFormat(r){const e=matchDateFormat(r);if(!e.every(t=>isEscapeToken(t)))return{type:FormatExpressionType.DATE,tokens:createTokens(e,r)}}function parseForNumberFormat(r){const e=matchNumberFormat(r);if(!e.every(t=>isEscapeToken(t)))return{type:FormatExpressionType.NUMBER,tokens:createTokens(e,r)}}function isEscapeToken(r){return r[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function format(r,e,t,n){const s=t.stringifyDateTime(n.numberToSimpleDateTime(r),e);if(s!==void 0)return s;const o=t.stringifyDuration(numberToSimpleTime(r),e);if(o!==void 0)return o;const a=parseForNumberFormat(e);return a!==void 0?numberFormat(a.tokens,r):e}function padLeft(r,e){let t=`${r}`;for(;t.length<e;)t="0"+t;return t}function padRight(r,e){let t=`${r}`;for(;t.length<e;)t=t+"0";return t}function countChars(r,e){return r.split(e).length-1}function numberFormat(r,e){let t="";for(let n=0;n<r.length;++n){const s=r[n];if(s.type===TokenType.FREE_TEXT){t+=s.value;continue}const o=s.value.split("."),a=o[0],l=o[1]||"",u=o[1]?".":"",c=Number(e.toFixed(l.length)).toString().split(".");let h=c[0]||"",g=c[1]||"";if(a.length>h.length){const m=countChars(a.substr(0,a.length-h.length),"0");h=padLeft(h,m+h.length)}const v=countChars(l.substr(g.length,l.length-g.length),"0");g=padRight(g,v+g.length),t+=h+u+g}return t}function defaultStringifyDuration(r,e){const t=parseForDateTimeFormat(e);if(t===void 0)return;const n=t.tokens;let s="";for(const o of n){if(o.type===TokenType.FREE_TEXT){s+=o.value;continue}switch(o.value.toLowerCase()){case"h":case"hh":{s+=padLeft(r.hours,o.value.length),r.hours=0;break}case"[hh]":{s+=padLeft(r.hours,o.value.length-2),r.hours=0;break}case"m":case"mm":{s+=padLeft(r.minutes,o.value.length),r.minutes=0;break}case"[mm]":{s+=padLeft(r.minutes+60*r.hours,o.value.length-2),r.minutes=0,r.hours=0;break}case"s":case"ss":{s+=padLeft(Math.floor(r.seconds),o.value.length);break}default:{if(TIME_FORMAT_SECONDS_ITEM_REGEXP.test(o.value)){const a=Math.max(o.value.length-3,0);s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,a))/Math.pow(10,a)}`;continue}return}}}return s}function defaultStringifyDateTime(r,e){const t=parseForDateTimeFormat(e);if(t===void 0)return;const n=t.tokens;let s="",o=!1;const a=n.some(l=>l.type===TokenType.FORMAT&&(l.value==="a/p"||l.value==="A/P"||l.value==="am/pm"||l.value==="AM/PM"));for(let l=0;l<n.length;l++){const u=n[l];if(u.type===TokenType.FREE_TEXT){s+=u.value;continue}switch(u.value.toLowerCase()){case"h":case"hh":{o=!0,s+=padLeft(a?(r.hours+11)%12+1:r.hours,u.value.length);break}case"d":case"dd":{s+=padLeft(r.day,u.value.length);break}case"s":case"ss":{s+=padLeft(Math.floor(r.seconds),u.value.length);break}case"m":case"mm":{l+1<n.length&&n[l+1].value.startsWith(":")&&(o=!0),o?s+=padLeft(r.minutes,u.value.length):s+=padLeft(r.month,u.value.length),o=!0;break}case"yy":{s+=padLeft(r.year%100,u.value.length);break}case"yyyy":{s+=r.year;break}case"am/pm":case"a/p":{const[c,h]=u.value.split("/");s+=r.hours<12?c:h;break}default:{if(TIME_FORMAT_SECONDS_ITEM_REGEXP.test(u.value)){const c=u.value.length-3;s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,c))/Math.pow(10,c)}`;continue}return}}}return s}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const _rl="length",_hd=r=>parseInt(r,16),_pi=r=>parseInt(r,10),_nm=r=>(r+"").replace(/\-/g,""),_ss=(r,e,t)=>r.substr(e,t),_cp=r=>r.codePointAt(0)-65;function extractTime(r){return _nm(r)[_rl]===25?_hd(_ss(_nm(r),_hd("12"),_cp("F")))/(_hd(_ss(_nm(r),_cp("C"),_cp("Y")>>4))||(~~![][_rl]<<3)+1):0}function checkKeySchema(r){if(r=(r+"").replace(/\-/g,""),r[_rl]!==_cp("Z"))return!1;let e=0;return[[0,_cp("G")+1],[_cp("H"),_cp("H")-1],[_cp("G")+_cp("H"),_cp("G")]].reduce((t,[n,s],o)=>(t|=(_pi(`${_pi(_hd(_ss(r,e+n-(o===0?0:2),s+(o?2:0)))+(_hd(_ss(r,e+n+s,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),_cp("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const consoleMessages={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:r})=>`The license key for HyperFormula expired on ${r}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let _notified=!1;function checkLicenseKeyValidity(r){const e={template:"missing",vars:{}};if(r==="gpl-v3"||r==="internal-use-in-handsontable")e.template="valid";else if(typeof r=="string"&&checkKeySchema(r)){const[t,n,s]="14/01/2025".split("/"),o=Math.floor(new Date(`${n}/${t}/${s}`).getTime()/864e5),a=extractTime(r);e.vars.keyValidityDate=formatDate(new Date((a+1)*864e5)),o>a?e.template="expired":e.template="valid"}else r!==""&&(e.template="invalid");return!_notified&&e.template!=="valid"&&(console.warn(consoleMessages[e.template](e.vars)),_notified=!0),e.template}function formatDate(r){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()],n=r.getDate(),s=r.getFullYear();return`${t} ${n}, ${s}`}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CellContent;(function(r){class e{constructor(u){this.value=u,this.value=cloneNumber(this.value,fixNegativeZero(getRawValue(this.value)))}}r.Number=e;class t{constructor(u){this.value=u}}r.String=t;class n{constructor(u){this.value=u}}r.Boolean=n;class s{static getSingletonInstance(){return s.instance||(s.instance=new s),s.instance}}r.Empty=s;class o{constructor(u){this.formula=u}}r.Formula=o;class a{constructor(u,c){this.value=new CellError(u,c)}}r.Error=a})(CellContent||(CellContent={}));function isFormula(r){return r.startsWith("=")}function isBoolean(r){const e=r.toLowerCase();return e==="true"||e==="false"}function isError(r,e){const t=r.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class CellContentParser{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(e==null)return CellContent.Empty.getSingletonInstance();if(typeof e=="number")return isNumberOverflow(e)?new CellContent.Error(ErrorType.NUM,ErrorMessage.ValueLarge):new CellContent.Number(e);if(typeof e=="boolean")return new CellContent.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=timeToNumber({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),s=t+n;return s<0?new CellContent.Error(ErrorType.NUM,ErrorMessage.DateBounds):s%1===0?new CellContent.Number(new DateNumber(s,"Date()")):s<1?new CellContent.Number(new TimeNumber(s,"Date()")):new CellContent.Number(new DateTimeNumber(s,"Date()"))}else if(typeof e=="string"){if(isBoolean(e))return new CellContent.Boolean(e.toLowerCase()==="true");if(isFormula(e))return new CellContent.Formula(e);if(isError(e,this.config.errorMapping))return new CellContent.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),n=0,s;if(t.endsWith("%"))n=1,t=t.slice(0,t.length-1);else{const l=this.currencyMatcher(t);l!==void 0&&(n=2,[s,t]=l)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(o!==void 0){let l;return n===1?l=new PercentNumber(o/100):n===2?l=new CurrencyNumber(o,s):l=o,new CellContent.Number(l)}const a=this.dateHelper.dateStringToDateNumber(t);return a!==void 0?new CellContent.Number(a):new CellContent.String(e.startsWith("'")?e.slice(1):e)}}else throw new UnableToParseError(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ClipboardOperationType;(function(r){r[r.COPY=0]="COPY",r[r.CUT=1]="CUT"})(ClipboardOperationType||(ClipboardOperationType={}));var ClipboardCellType;(function(r){r[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR"})(ClipboardCellType||(ClipboardCellType={}));class Clipboard{constructor(e,t,n,s,o){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=s,this.content=o}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[simpleCellAddress(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class ClipboardOperations{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new Clipboard(e,t,n,ClipboardOperationType.CUT)}copy(e,t,n){const s=[];for(let o=0;o<n;++o){s[o]=[];for(let a=0;a<t;++a){const l=this.operations.getClipboardCell(simpleCellAddress(e.sheet,e.col+a,e.row+o));s[o].push(l)}}this.clipboard=new Clipboard(e,t,n,ClipboardOperationType.COPY,s)}abortCut(){this.clipboard&&this.clipboard.type===ClipboardOperationType.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(invalidSimpleCellAddress(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new InvalidArgumentsError("a valid target address.");const t=AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===ClipboardOperationType.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===ClipboardOperationType.COPY}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InternalNamedExpression{constructor(e,t,n,s){this.displayName=e,this.address=t,this.added=n,this.options=s}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new InternalNamedExpression(this.displayName,this.address,this.added,this.options)}}class WorkbookStore{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class WorksheetStore{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class NamedExpressions{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new WorkbookStore,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,s;return t===void 0?this.workbookStore.isNameAvailable(e):(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&s!==void 0?s:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var n;return t===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e))!==null&&s!==void 0?s:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.has(e))!==null&&s!==void 0?s:!1}isNameValid(e){const t=new RegExp(`^${CELL_REFERENCE_PATTERN}$`),n=new RegExp(`^${R1C1_CELL_REFERENCE_PATTERN}$`),s=new RegExp(`^${NAMED_EXPRESSION_PATTERN}$`);return t.test(e)||n.test(e)?!1:s.test(e)}addNamedExpression(e,t,n){const s=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let o=s.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=n):(o=new InternalNamedExpression(e,this.nextAddress(),!0,n),s.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,t){const n=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return(n=this.worksheetStoreOrCreate(t).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new InternalNamedExpression(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;t===void 0?n=this.workbookStore:n=this.worksheetStore(t);const s=n==null?void 0:n.get(e);if(n===void 0||s===void 0||!s.added)throw Error("Named expression does not exist");n.remove(e),n instanceof WorksheetStore&&n.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(s.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,n)=>{t.getAllNamedExpressions().forEach(s=>{e.push({expression:s,scope:n})})}),e}getAllNamedExpressionsForScope(e){var t,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new WorksheetStore,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return simpleCellAddress(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const doesContainRelativeReferences=r=>{switch(r.type){case AstNodeType.EMPTY:case AstNodeType.NUMBER:case AstNodeType.STRING:case AstNodeType.ERROR:case AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case AstNodeType.CELL_REFERENCE:return!r.reference.isAbsolute();case AstNodeType.CELL_RANGE:case AstNodeType.COLUMN_RANGE:case AstNodeType.ROW_RANGE:return!r.start.isAbsolute();case AstNodeType.NAMED_EXPRESSION:return!1;case AstNodeType.PERCENT_OP:case AstNodeType.PLUS_UNARY_OP:case AstNodeType.MINUS_UNARY_OP:return doesContainRelativeReferences(r.value);case AstNodeType.CONCATENATE_OP:case AstNodeType.EQUALS_OP:case AstNodeType.NOT_EQUAL_OP:case AstNodeType.LESS_THAN_OP:case AstNodeType.GREATER_THAN_OP:case AstNodeType.LESS_THAN_OR_EQUAL_OP:case AstNodeType.GREATER_THAN_OR_EQUAL_OP:case AstNodeType.MINUS_OP:case AstNodeType.PLUS_OP:case AstNodeType.TIMES_OP:case AstNodeType.DIV_OP:case AstNodeType.POWER_OP:return doesContainRelativeReferences(r.left)||doesContainRelativeReferences(r.right);case AstNodeType.PARENTHESIS:return doesContainRelativeReferences(r.expression);case AstNodeType.FUNCTION_CALL:return r.args.some(e=>doesContainRelativeReferences(e));case AstNodeType.ARRAY:return r.args.some(e=>e.some(t=>doesContainRelativeReferences(t)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Transformer{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s,o]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),a=t.rememberNewAst(s);n.setFormula(a),n.setAddress(o)}}transformSingleAst(e,t){const n=this.transformAst(e,t),s=this.fixNodeAddress(t);return[n,s]}transformAst(e,t){switch(e.type){case AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case AstNodeType.EMPTY:case AstNodeType.ERROR:case AstNodeType.NUMBER:case AstNodeType.NAMED_EXPRESSION:case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.STRING:return e;case AstNodeType.PERCENT_OP:case AstNodeType.MINUS_UNARY_OP:case AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,t))});case AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(s=>this.transformAst(s,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof CellAddress?Object.assign(Object.assign({},e),{reference:n}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===ErrorType.REF?buildCellErrorAst(new CellError(ErrorType.REF)):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddColumnsTransformer extends Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const s=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=s.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s===ErrorType.REF||o===ErrorType.REF?ErrorType.REF:s||o?[s||e,o||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AddRowsTransformer extends Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const s=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=s.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):s.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s===ErrorType.REF||o===ErrorType.REF?ErrorType.REF:s||o?[s||e,o||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CleanOutOfScopeDependenciesTransformer extends Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?ErrorType.REF:!1}transformCellRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}transformColumnRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}transformRowRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?ErrorType.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MoveCellsTransformer extends Transformer{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s,this.dependentFormulaTransformer=new DependentFormulaTransformer(e,t,n,s)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return simpleCellAddress(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof CellAddress){const s=e.toSimpleCellAddress(t);if(n.addressInRange(s))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const s=this.sourceRange;if(e instanceof CellAddress&&t instanceof CellAddress){const o=e.toSimpleCellAddress(n),a=t.toSimpleCellAddress(n);if(s.addressInRange(o)&&s.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class DependentFormulaTransformer extends Transformer{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const s=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return s&&o?[s,o]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveColumnsTransformer extends Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart)return!1;if(s.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(s.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=absoluteSheetReference(e,n);let o=e,a=t;if(this.columnsSpan.sheet===s){const c=e.toSimpleColumnAddress(n),h=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=c.col&&this.columnsSpan.columnEnd>=h.col)return ErrorType.REF;c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-c.col+1)),h.col>=this.columnsSpan.columnStart&&h.col<=this.columnsSpan.columnEnd&&(a=t.shiftedByColumns(-(h.col-this.columnsSpan.columnStart+1)))}const l=this.transformCellAddress(o,n),u=this.transformCellAddress(a,n);if(l===!1&&u===!1)return[o,a];if(l===ErrorType.REF||u===ErrorType.REF)throw Error("Cannot happen");return[l||o,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveRowsTransformer extends Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=absoluteSheetReference(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart)return!1;if(s.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(s.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return ErrorType.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=absoluteSheetReference(e,n);let o=e,a=t;if(this.rowsSpan.sheet===s){const c=e.toSimpleRowAddress(n),h=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=c.row&&this.rowsSpan.rowEnd>=h.row)return ErrorType.REF;c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-c.row+1)),h.row>=this.rowsSpan.rowStart&&h.row<=this.rowsSpan.rowEnd&&(a=t.shiftedByRows(-(h.row-this.rowsSpan.rowStart+1)))}const l=this.transformCellAddress(o,n),u=this.transformCellAddress(a,n);return l===!1&&u===!1?[o,a]:l===ErrorType.REF||u===ErrorType.REF?ErrorType.REF:[l||o,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveSheetTransformer extends Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(s)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?ErrorType.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function validateAsSheet(r){if(!Array.isArray(r))throw new InvalidArgumentsError("an array of arrays.");for(let e=0;e<r.length;e++)if(!Array.isArray(r[e]))throw new InvalidArgumentsError("an array of arrays.")}function findBoundaries(r){let e=0,t=0,n=0;for(let o=0;o<r.length;o++){let a=0;for(let l=0;l<r[o].length;l++){const u=r[o][l];u!=null&&(a=l+1,++n)}e=Math.max(e,a),a>0&&(t=o+1)}const s=e*t;return{height:t,width:e,fill:s===0?0:n/s}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RemoveRowsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class AddRowsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class AddColumnsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeAddedIndexes(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class RemoveColumnsCommand{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return normalizeRemovedIndexes(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Operations{constructor(e,t,n,s,o,a,l,u,c){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=s,this.parser=o,this.stats=a,this.lazilyTransformingAstService=l,this.namedExpressions=u,this.arraySizePredictor=c,this.changes=ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const s=this.doRemoveRows(n);s&&t.push(s)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const s=this.doRemoveColumns(n);s&&t.push(s)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const s=new RemoveSheetTransformer(e);s.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(s)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(s=>this.removeNamedExpression(s.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:n}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,findBoundaries(n)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,s){const o=RowsSpan.fromNumberOfRows(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),s<t&&(t+=n);const a=simpleCellAddress(e,0,t),l=simpleCellAddress(e,0,s);this.moveCells(a,Number.POSITIVE_INFINITY,n,l);const u=RowsSpan.fromNumberOfRows(e,t,n);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,s){const o=ColumnsSpan.fromNumberOfColumns(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),s<t&&(t+=n);const a=simpleCellAddress(e,t,0),l=simpleCellAddress(e,s,0);this.moveCells(a,n,Number.POSITIVE_INFINITY,l);const u=ColumnsSpan.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,s){this.ensureItIsPossibleToMoveCells(e,t,n,s);const o=AbsoluteCellRange.spanFrom(e,t,n),a=AbsoluteCellRange.spanFrom(s,t,n),l=s.col-e.col,u=s.row-e.row,c=s.sheet,h=this.getRangeClipboardCells(a),g=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(g);const v=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(v,l,u,c);let m=0;this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const _=new MoveCellsTransformer(o,l,u,c);_.performEagerTransformations(this.dependencyGraph,this.parser),m=this.lazilyTransformingAstService.addTransformation(_)}),this.dependencyGraph.moveCells(o,l,u,c);const E=this.updateNamedExpressionsForMovedCells(e,t,n,s);return{version:m,overwrittenCellsData:h,addedGlobalNamedExpressions:E}}setRowOrder(e,t){const n=[];let s=[];for(const[o,a]of t)if(o!==a){const l=AbsoluteCellRange.spanFrom({sheet:e,col:0,row:o},1/0,1),u=this.getRangeClipboardCells(l);s=s.concat(u),n.push(u.map(([{sheet:c,col:h},g])=>[{sheet:c,col:h,row:a},g]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),s}setColumnOrder(e,t){const n=[];let s=[];for(const[o,a]of t)if(o!==a){const l=AbsoluteCellRange.spanFrom({sheet:e,col:o,row:0},1,1/0),u=this.getRangeClipboardCells(l);s=s.concat(u),n.push(u.map(([{sheet:c,col:h,row:g},v])=>[{sheet:c,col:a,row:g},v]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),s}addNamedExpression(e,t,n,s){const o=this.namedExpressions.addNamedExpression(e,n,s);this.storeNamedExpressionInCell(o.address,t),this.adjustNamedExpressionEdges(o,e,n)}restoreNamedExpression(e,t,n){const s=e.displayName;this.restoreCell(e.address,t);const o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,s,n)}changeNamedExpressionExpression(e,t,n,s){const o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new NamedExpressionDoesNotExistError(e);const a=o.copy();o.options=s;const l=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[a,l]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(n.displayName,t);const s=this.getClipboardCell(n.address);if(t!==void 0){const o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,s]}ensureItIsPossibleToMoveCells(e,t,n,s){if(invalidSimpleCellAddress(e)||!(isPositiveInteger$1(t)&&isPositiveInteger$1(n)||isRowOrColumnRange(e,t,n))||invalidSimpleCellAddress(s)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(s.sheet))throw new InvalidArgumentsError("a valid range of cells to move.");const o=AbsoluteCellRange.spanFrom(e,t,n),a=AbsoluteCellRange.spanFrom(s,t,n);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new TargetLocationHasArrayError}restoreClipboardCells(e,t){const n=[];for(const[s,o]of t)if(this.restoreCell(s,o),o.type===ClipboardCellType.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(o.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,s,a))}return n}restoreCell(e,t){switch(t.type){case ClipboardCellType.VALUE:{this.setValueToCell(t,e);break}case ClipboardCellType.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case ClipboardCellType.EMPTY:{this.setCellEmpty(e);break}case ClipboardCellType.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof EmptyCellVertex)return[e,{type:ClipboardCellType.EMPTY}];if(t instanceof ValueCellVertex)return[e,Object.assign({type:ClipboardCellType.VALUE},t.getValues())];if(t instanceof FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof ParsingErrorVertex)return[e,{type:ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof EmptyCellVertex)return{type:ClipboardCellType.EMPTY};if(t instanceof ValueCellVertex)return Object.assign({type:ClipboardCellType.VALUE},t.getValues());if(t instanceof ArrayVertex){const n=t.getArrayCellValue(e);return n===EmptyValue?{type:ClipboardCellType.EMPTY}:{type:ClipboardCellType.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof FormulaCellVertex)return{type:ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof ParsingErrorVertex)return{type:ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),s=new Array(t);for(let o=0;o<t;o++){s[o]=new Array(n);for(let a=0;a<n;a++){const l=simpleCellAddress(e,a,o);s[o][a]=this.getClipboardCell(l)}}return s}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),s=this.getOldContent(e);if(n instanceof CellContent.Formula){const o=this.parser.parse(n.formula,e),{ast:a,errors:l}=o;if(l.length>0)this.setParsingErrorToCell(n.formula,l,e);else try{const u=this.arraySizePredictor.checkArraySize(a,e);if(u.width<=0||u.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,u,o)}catch(u){if(!u.message)throw u;const c={type:ParsingErrorType.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[c],e)}}else n instanceof CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return s}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let s=0;s<t[n].length;s++){const o=simpleCellAddress(e,s,n);this.setCellContent(o,t[n][s])}}setParsingErrorToCell(e,t,n){const s=this.dependencyGraph.getCellValue(n),o=new ParsingErrorVertex(t,e),a=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(getRawValue(s),n),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(o.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}){const l=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,n,absolutizeDependencies(a,e),t,s,o);this.columnSearch.remove(getRawValue(l),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}setValueToCell(e,t){const n=this.dependencyGraph.getCellValue(t),s=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(getRawValue(n),getRawValue(e.parsedValue),t),this.columnSearch.applyChanges(s.getChanges().filter(o=>!equalSimpleCellAddress(o.address,t))),this.changes.addAll(s),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(getRawValue(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(EmptyValue,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:o,dependencies:a}=this.parser.fetchCachedResult(e),l=absolutizeDependencies(a,t),[u]=new CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(u);const c=filterDependenciesOutOfScope(l),h=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,u,c,h,s,o)}rowEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getHeight(t);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(s.getChanges());let o=0;return this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const a=new RemoveRowsTransformer(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(s.getChanges()),this.columnSearch.removeColumns(e);let o=0;return this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const a=new RemoveColumnsTransformer(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const n=new AddRowsTransformer(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const n=t.getFormula(this.lazilyTransformingAstService),s=t.getAddress(this.lazilyTransformingAstService),o=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(o,s)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(StatType.TRANSFORM_ASTS,()=>{const s=new AddColumnsTransformer(e);s.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(s)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getWidth(t);return e>=n}adjustNamedExpressionEdges(e,t,n){if(n===void 0)return;const{vertex:s,id:o}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=o??this.dependencyGraph.graph.getNodeId(s),l=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:u,id:c}=this.dependencyGraph.fetchCellOrCreateEmpty(l.address),h=c??this.dependencyGraph.graph.getNodeId(u);for(const g of this.dependencyGraph.graph.adjacentNodes(u))if(g instanceof FormulaCellVertex&&g.getAddress(this.lazilyTransformingAstService).sheet===n){const v=g.getFormula(this.lazilyTransformingAstService),m=g.getAddress(this.lazilyTransformingAstService),{dependencies:E}=this.parser.fetchCachedResultForAst(v);for(const _ of absolutizeDependencies(E,m))_ instanceof NamedExpressionDependency&&_.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,g),this.dependencyGraph.graph.addEdge(a,g))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof CellContent.Formula){const s=this.parser.parse(n.formula,simpleCellAddress(-1,0,0));if(doesContainRelativeReferences(s.ast))throw new NoRelativeAddressesAllowedError;const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(e,o,absolutizeDependencies(u,e),ArraySize.scalar(),a,l)}else n instanceof CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,s){if(e.sheet===s.sheet)return[];const o=[],a=AbsoluteCellRange.spanFrom(s,t,n);for(const l of a.addresses(this.dependencyGraph)){const u=this.addressMapping.fetchCell(l);if(u instanceof FormulaCellVertex&&l.sheet!==e.sheet){const c=u.getFormula(this.lazilyTransformingAstService),{dependencies:h}=this.parser.fetchCachedResultForAst(c);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,l,h))}}return o}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const s=[],o=this.addressMapping.fetchCell(t);for(const a of absolutizeDependencies(n,t)){if(!(a instanceof NamedExpressionDependency))continue;const l=a.name,u=this.dependencyGraph.fetchNamedExpressionVertex(l,e).vertex,h=this.namedExpressions.isExpressionInScope(l,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(l,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(l,u,s);h!==u&&(this.dependencyGraph.graph.removeEdgeIfExists(u,o),this.dependencyGraph.graph.addEdge(h,o))}return s}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let s=this.namedExpressions.namedExpressionForScope(e);if(s===void 0)if(s=this.namedExpressions.addNamedExpression(e),n.push(s.normalizeExpressionName()),t instanceof FormulaCellVertex){const o=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:l,hasStructuralChangeFunction:u,dependencies:c}=o;this.dependencyGraph.setFormulaToCell(s.address,a,absolutizeDependencies(c,s.address),ArraySize.scalar(),l,u)}else t instanceof EmptyCellVertex?this.setCellEmpty(s.address):t instanceof ValueCellVertex&&this.setValueToCell(t.getValues(),s.address);return this.dependencyGraph.fetchCellOrCreateEmpty(s.address).vertex}}function normalizeRemovedIndexes(r){if(r.length<=1)return r;const e=[...r].sort(([s],[o])=>s-o),t=e.reduce((s,[o,a])=>{const l=s[s.length-1],u=l[0]+l[1];return o<=u?l[1]+=Math.max(0,a-(u-o)):s.push([o,a]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]-=n,n+=t[s][1];return t}function normalizeAddedIndexes(r){if(r.length<=1)return r;const e=[...r].sort(([s],[o])=>s-o),t=e.reduce((s,[o,a])=>{const l=s[s.length-1];return o===l[0]?l[1]=Math.max(l[1],a):s.push([o,a]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]+=n,n+=t[s][1];return t}function isPositiveInteger$1(r){return Number.isInteger(r)&&r>0}function isRowOrColumnRange(r,e,t){return r.row===0&&isPositiveInteger$1(e)&&t===Number.POSITIVE_INFINITY||r.col===0&&isPositiveInteger$1(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BaseUndoEntry{}class RemoveRowsUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class MoveCellsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o,a,l){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=s,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=a,this.version=l}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class AddRowsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class SetRowOrderUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class SetColumnOrderUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class SetSheetContentUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class MoveRowsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=s,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class MoveColumnsUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=s,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class AddColumnsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class RemoveColumnsUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class AddSheetUndoEntry extends BaseUndoEntry{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class RemoveSheetUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=s,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class RenameSheetUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class ClearSheetUndoEntry extends BaseUndoEntry{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class SetCellContentsUndoEntry extends BaseUndoEntry{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class PasteUndoEntry extends BaseUndoEntry{constructor(e,t,n,s){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=s}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class AddNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n,s){super(),this.name=e,this.newContent=t,this.scope=n,this.options=s}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class RemoveNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class ChangeNamedExpressionUndoEntry extends BaseUndoEntry{constructor(e,t,n,s,o){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=s,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class BatchUndoEntry extends BaseUndoEntry{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class UndoRedo{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new BatchUndoEntry}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const o=n[s];this.operations.addRows(new AddRowsCommand(t,[[o.rowFrom,o.rowCount]]));for(const{address:a,cellType:l}of o.removedCells)this.operations.restoreCell(a,l);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const o=n[s];this.operations.addColumns(new AddColumnsCommand(t,[[o.columnFrom,o.columnCount]]));for(const{address:a,cellType:l}of o.removedCells)this.operations.restoreCell(a,l);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeRows(new RemoveRowsCommand(e.command.sheet,[[s.rowStart,s.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeColumns(new RemoveColumnsCommand(e.command.sheet,[[s.columnStart,s.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const n=t.address,[s,o]=t.oldContent;equalSimpleCellAddress(n,s)||this.operations.setCellEmpty(n),this.operations.restoreCell(s,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}for(const[s,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(s,o,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.length;a++){const l=o[a],u=simpleCellAddress(n,a,s);this.operations.restoreCell(u,l)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,s=n.length,o=n[0].length;for(let a=0;a<s;++a)for(let l=0;l<o;++l){const u=simpleCellAddress(t.sheet,t.col+l,t.row+a);this.operations.restoreCell(u,n[a][l])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[s,o]=n;this.operations.setFormulaToCellFromCache(o,s)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CrudOperations{constructor(e,t,n,s,o,a,l,u,c,h){this.operations=t,this.undoRedo=n,this.clipboardOperations=s,this.dependencyGraph=o,this.columnSearch=a,this.parser=l,this.cellContentParser=u,this.lazilyTransformingAstService=c,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new AddRowsUndoEntry(n))}removeRows(e,...t){const n=new RemoveRowsCommand(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeRows(n);this.undoRedo.saveOperation(new RemoveRowsUndoEntry(n,s))}addColumns(e,...t){const n=new AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new AddColumnsUndoEntry(n))}removeColumns(e,...t){const n=new RemoveColumnsCommand(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeColumns(n);this.undoRedo.saveOperation(new RemoveColumnsUndoEntry(n,s))}moveCells(e,t,n,s){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:a,addedGlobalNamedExpressions:l}=this.operations.moveCells(e,t,n,s);this.undoRedo.saveOperation(new MoveCellsUndoEntry(e,t,n,s,a,l,o))}moveRows(e,t,n,s){this.ensureItIsPossibleToMoveRows(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,t,n,s);this.undoRedo.saveOperation(new MoveRowsUndoEntry(e,t,n,s,o))}moveColumns(e,t,n,s){this.ensureItIsPossibleToMoveColumns(e,t,n,s),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,t,n,s);this.undoRedo.saveOperation(new MoveColumnsUndoEntry(e,t,n,s,o))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!isPositiveInteger(t))throw new InvalidArgumentsError("width to be positive integer.");if(!isPositiveInteger(n))throw new InvalidArgumentsError("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=AbsoluteCellRange.spanFrom(e,t.width,t.height),s=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new PasteUndoEntry(e,s,t.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new AddSheetUndoEntry(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:s,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new RemoveSheetUndoEntry(t,e,n,o,s))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const n=this.operations.renameSheet(e,t);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new RenameSheetUndoEntry(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new ClearSheetUndoEntry(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let s=0;s<t.length;s++)if(!(t[s]instanceof Array))throw new InvalidArgumentsError("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let s=0;s<t.length;s++)for(let o=0;o<t[s].length;o++){const a={sheet:e.sheet,row:e.row+s,col:e.col+o},l=t[s][o];this.clipboardOperations.abortCut();const u=this.operations.setCellContent(a,l);n.push({address:a,newContent:l,oldContent:u})}this.undoRedo.saveOperation(new SetCellContentsUndoEntry(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),validateAsSheet(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new SetSheetContentUndoEntry(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new SetRowOrderUndoEntry(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const o=AbsoluteCellRange.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new SetColumnOrderUndoEntry(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const o=AbsoluteCellRange.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new SourceLocationHasArrayError}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==s)throw new InvalidArgumentsError(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const o=[];for(let a=0;a<s;a++)t[a]!==a&&o.push([a,t[a]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,s){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new AddNamedExpressionUndoEntry(e,t,n,s))}changeNamedExpressionExpression(e,t,n,s){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[o,a]=this.operations.changeNamedExpressionExpression(e,n,t,s);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new ChangeNamedExpressionUndoEntry(o,n,a,t,s))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,s]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new RemoveNamedExpressionUndoEntry(n,s,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.dependencyGraph.getSheetHeight(e),s=t.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+s>this.maxRows)throw new SheetSizeLimitExceededError;for(const[o,a]of t)if(!isNonnegativeInteger(o)||!isPositiveInteger(a))throw new InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,s]of t){const o=n+s-1;if(!isNonnegativeInteger(n)||!isNonnegativeInteger(o))throw new InvalidArgumentsError("starting and ending row to be nonnegative.");if(o<n)throw new InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.dependencyGraph.getSheetWidth(e),s=t.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+s>this.maxColumns)throw new SheetSizeLimitExceededError;for(const[o,a]of t)if(!isNonnegativeInteger(o)||!isPositiveInteger(a))throw new InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,s]of t){const o=n+s-1;if(!isNonnegativeInteger(n)||!isNonnegativeInteger(o))throw new InvalidArgumentsError("starting and ending column to be nonnegative.");if(o<n)throw new InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,n,s){this.ensureItIsPossibleToAddRows(e,[s,n]);const o=simpleCellAddress(e,0,t),a=simpleCellAddress(e,0,s);if(!this.sheetMapping.hasSheetWithId(e)||invalidSimpleCellAddress(o)||invalidSimpleCellAddress(a)||!isPositiveInteger(n)||s<=t+n&&s>=t)throw new InvalidArgumentsError("a valid range of rows to move.");const l=this.dependencyGraph.getSheetWidth(e),u=AbsoluteCellRange.spanFrom(o,l,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(RowsSpan.fromNumberOfRows(e,s-1,2)))throw new TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,n,s){this.ensureItIsPossibleToAddColumns(e,[s,n]);const o=simpleCellAddress(e,t,0),a=simpleCellAddress(e,s,0);if(!this.sheetMapping.hasSheetWithId(e)||invalidSimpleCellAddress(o)||invalidSimpleCellAddress(a)||!isPositiveInteger(n)||s<=t+n&&s>=t)throw new InvalidArgumentsError("a valid range of columns to move.");const l=this.dependencyGraph.getSheetHeight(e),u=AbsoluteCellRange.spanFrom(o,n,l);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(ColumnsSpan.fromNumberOfColumns(e,s-1,2)))throw new TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e);const n=this.sheetMapping.get(t);if(n!==void 0&&n!==e)throw new SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if(invalidSimpleCellAddress(e))throw new InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=findBoundaries(t),s=AbsoluteCellRange.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(s);for(const o of s.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,t){const n=findBoundaries(t),s=AbsoluteCellRange.spanFrom(simpleCellAddress(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(s)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,n){const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map(([l,u])=>l).sort((l,u)=>l-u),a=t.map(([l,u])=>u).sort((l,u)=>l-u);for(let l=0;l<o.length;l++){if(!isNonnegativeInteger(o[l])||o[l]>=s)throw new InvalidArgumentsError(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(o[l]===o[l+1])throw new InvalidArgumentsError(`source ${n} numbers to be unique.`);if(o[l]!==a[l])throw new InvalidArgumentsError(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof CellContent.Formula){const n=this.parser.parse(t.formula,simpleCellAddress(-1,0,0));if(doesContainRelativeReferences(n.ast))throw new NoRelativeAddressesAllowedError}}}function isPositiveInteger(r){return Number.isInteger(r)&&r>0}function isNonnegativeInteger(r){return Number.isInteger(r)&&r>=0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Evaluator{constructor(e,t,n,s,o,a){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=s,this.dependencyGraph=o,this.columnSearch=a}run(){this.stats.start(StatType.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(StatType.TOP_SORT),this.stats.measure(StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=ContentChanges.empty();return this.stats.measure(StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof FormulaVertex){const s=n.isComputed()?n.getCellValue():void 0,o=this.recomputeFormulaVertexValue(n);if(o!==s){const a=n.getAddress(this.lazilyTransformingAstService);return t.addChange(o,a),this.columnSearch.change(getRawValue(s),getRawValue(o),a),!0}return!1}else return n instanceof RangeVertex&&n.clearCache(),!0},n=>{if(n instanceof RangeVertex)n.clearCache();else if(n instanceof FormulaVertex){const s=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(getRawValue(n.valueOrUndef()),s);const o=new CellError(ErrorType.CYCLE,void 0,n);n.setCellValue(o),t.addChange(o,s)}})}),t}runAndForget(e,t,n){const s=[];for(const a of absolutizeDependencies(n,t))if(a instanceof AbsoluteCellRange){const l=a;if(this.dependencyGraph.getRange(l.start,l.end)===void 0){const u=new RangeVertex(l);this.dependencyGraph.rangeMapping.setRange(u),s.push(u)}}const o=this.evaluateAstToCellValue(e,new InterpreterState(t,this.config.useArrayArithmetic));return s.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),o}recomputeFormulas(e,t){e.forEach(n=>{n instanceof FormulaVertex&&n.setCellValue(new CellError(ErrorType.CYCLE,void 0,n))}),t.forEach(n=>{if(n instanceof FormulaVertex){const s=this.recomputeFormulaVertexValue(n),o=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(getRawValue(s),o)}else n instanceof RangeVertex&&n.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),s=this.evaluateAstToCellValue(n,new InterpreterState(t,this.config.useArrayArithmetic,e));return e.setCellValue(s)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof SimpleRangeValue?n:n===EmptyValue&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ExportedCellChange{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class ExportedNamedExpressionChange{constructor(e,t){this.name=e,this.newValue=t}}class Exporter{constructor(e,t,n,s){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=s}exportChange(e){const t=e.value,n=e.address;if(n.sheet===NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){const s=this.namedExpressions.namedExpressionInAddress(n.row);if(!s)throw new Error("Missing named expression");return new ExportedNamedExpressionChange(s.displayName,this.exportScalarOrRange(t))}else if(t instanceof SimpleRangeValue){const s=[];for(const[o,a]of t.entriesFromTopLeftCorner(n))s.push(new ExportedCellChange(a,this.exportValue(o)));return s}else return new ExportedCellChange(n,this.exportValue(t))}exportValue(e){return e instanceof SimpleRangeValue?this.detailedError(new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)):this.config.smartRounding&&isExtendedNumber(e)?this.cellValueRounding(getRawValue(e)):e instanceof CellError?this.detailedError(e):e===EmptyValue?null:getRawValue(e)}exportScalarOrRange(e){return e instanceof SimpleRangeValue?e.rawData().map(t=>t.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var t,n;let s;const o=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?s=(n=this.namedExpressions.namedExpressionInAddress(o.row))===null||n===void 0?void 0:n.displayName:s=simpleCellAddressToString(this.sheetIndexMapping,o,-1)),new DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),s)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class GraphBuilder{constructor(e,t,n,s,o,a){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=s,this.stats=o,this.arraySizePredictor=a,this.buildStrategy=new SimpleStrategy(e,t,n,o,s,a)}buildGraph(e,t){const n=t.measure(StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((t,n)=>{this.dependencyGraph.processCellDependencies(t,n)})}}class SimpleStrategy{constructor(e,t,n,s,o,a){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=s,this.cellContentParser=o,this.arraySizePredictor=a}run(e){const t=new Map;for(const n in e){const s=this.dependencyGraph.getSheetId(n),o=e[n];for(let a=0;a<o.length;++a){const l=o[a];for(let u=0;u<l.length;++u){const c=l[u],h=simpleCellAddress(s,u,a),g=this.cellContentParser.parse(c);if(g instanceof CellContent.Formula){const v=this.stats.measure(StatType.PARSER,()=>this.parser.parse(g.formula,h));if(v.errors.length>0){this.shrinkArrayIfNeeded(h);const m=new ParsingErrorVertex(v.errors,g.formula);this.dependencyGraph.addVertex(h,m)}else{this.shrinkArrayIfNeeded(h);const m=this.arraySizePredictor.checkArraySize(v.ast,h);if(m.isScalar()){const E=new FormulaCellVertex(v.ast,h,0);t.set(E,absolutizeDependencies(v.dependencies,h)),this.dependencyGraph.addVertex(h,E),v.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(E),v.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(E)}else{const E=new ArrayVertex(v.ast,h,new ArraySize(m.width,m.height));t.set(E,absolutizeDependencies(v.dependencies,h)),this.dependencyGraph.addArrayVertex(h,E)}}}else if(!(g instanceof CellContent.Empty)){this.shrinkArrayIfNeeded(h);const v=new ValueCellVertex(g.value,c);this.columnIndex.add(getRawValue(g.value),h),this.dependencyGraph.addVertex(h,v)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const LICENSE_STATUS_MAP=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class VersionPlugin extends FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:s}=this.config;let o;return LICENSE_STATUS_MAP.has(s)?o=LICENSE_STATUS_MAP.get(s):LICENSE_STATUS_MAP.has(n)?o=LICENSE_STATUS_MAP.get(n):n==="valid"&&(o=s.slice(-5)),`HyperFormula v${HyperFormula.version}, ${o}`})}}VersionPlugin.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function validateAndReturnMetadataFromName(r,e){var t;let n=e.implementedFunctions[r];const s=(t=e.aliases)===null||t===void 0?void 0:t[r];if(s!==void 0){if(n!==void 0)throw new AliasAlreadyExisting(r,e.name);n=e.implementedFunctions[s]}if(n===void 0)throw FunctionPluginValidationError.functionNotDeclaredInPlugin(r,e.name);return n}class FunctionRegistry{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)FunctionRegistry.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(FunctionRegistry.plugins);for(const[t,n]of FunctionRegistry.protectedFunctions())FunctionRegistry.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,validateAndReturnMetadataFromName(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{t.has(n)&&HyperFormula.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,t)})}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){const s=validateAndReturnMetadataFromName(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,s))n.set(t,e);else throw FunctionPluginValidationError.functionMethodNotFound(s,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[n,s]of this.instancePlugins.entries()){let o=t.find(c=>c instanceof s);o===void 0&&(o=new s(e),t.push(o));const a=validateAndReturnMetadataFromName(n,s),l=a.method;this.functions.set(n,[l,o]);const u=a.arraySizeMethod;u!==void 0&&this.arraySizeFunctions.set(n,[u,o])}}getFunctionPlugin(e){if(!FunctionRegistry.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(o,a)=>s[n](o,a)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(o,a)=>s[n](o,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)FunctionRegistry.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}FunctionRegistry.plugins=new Map;FunctionRegistry._protectedPlugins=new Map([["VERSION",VersionPlugin],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var CriterionType;(function(r){r.GREATER_THAN="GREATER_THAN",r.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",r.LESS_THAN="LESS_THAN",r.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",r.NOT_EQUAL="NOT_EQUAL",r.EQUAL="EQUAL"})(CriterionType||(CriterionType={}));const buildCriterion=(r,e)=>({operator:r,value:e});class CriterionBuilder{constructor(e){var t,n,s,o;this.trueString=(n=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(o=(s=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||s===void 0?void 0:s.toLowerCase())!==null&&o!==void 0?o:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,t);if(n!==void 0)return{raw:e,lambda:buildCriterionLambda(n,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return buildCriterion(CriterionType.EQUAL,e);if(typeof e=="string"){const n=ANY_CRITERION_REGEX.exec(e);let s,o;n?(o=StrToCriterionType(n[1]),s=n[2]):(o=CriterionType.EQUAL,s=e);const a=t.coerceToMaybeNumber(s),l=s.toLowerCase()===this.trueString?!0:s.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(s==="")return buildCriterion(o,null);if(a===void 0){if(o===CriterionType.EQUAL||o===CriterionType.NOT_EQUAL)return buildCriterion(o,l??s)}else return buildCriterion(o,getRawValue(a))}}}const ANY_CRITERION_REGEX=/([<>=]+)(.*)/;function StrToCriterionType(r){switch(r){case">":return CriterionType.GREATER_THAN;case">=":return CriterionType.GREATER_THAN_OR_EQUAL;case"<":return CriterionType.LESS_THAN;case"<=":return CriterionType.LESS_THAN_OR_EQUAL;case"<>":return CriterionType.NOT_EQUAL;case"=":return CriterionType.EQUAL;default:return}}const buildCriterionLambda=(r,e)=>{switch(r.operator){case CriterionType.GREATER_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>0:t=>!1;case CriterionType.GREATER_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>=0:t=>!1;case CriterionType.LESS_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<0:t=>!1;case CriterionType.LESS_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<=0:t=>!1;case CriterionType.EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)===0;if(typeof t=="string"){if(t==="")return!1;const n=e.coerceToMaybeNumber(t);return n===void 0?!1:e.floatCmp(n,r.value)===0}else return!1}:typeof r.value=="string"?e.eqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t=="boolean"&&t===r.value:t=>t===EmptyValue;case CriterionType.NOT_EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)!==0;if(typeof t=="string"){if(t==="")return!0;const n=e.coerceToMaybeNumber(t);return n===void 0?!0:e.floatCmp(n,r.value)!==0}else return!0}:typeof r.value=="string"?e.neqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t!="boolean"||t!==r.value:t=>t!==EmptyValue}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Interpreter{constructor(e,t,n,s,o,a,l,u,c,h){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=s,this.arithmeticHelper=o,this.functionRegistry=a,this.namedExpressions=l,this.serialization=u,this.arraySizePredictor=c,this.dateTimeHelper=h,this.equalOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.eq,g,v),this.notEqualOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.neq,g,v),this.greaterThanOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.gt,g,v),this.lessThanOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.lt,g,v),this.greaterThanOrEqualOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.geq,g,v),this.lessThanOrEqualOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.leq,g,v),this.concatOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.concat,coerceScalarToString(g),coerceScalarToString(v)),this.plusOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(g),this.arithmeticHelper.coerceScalarToNumberOrError(v)),this.minusOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(g),this.arithmeticHelper.coerceScalarToNumberOrError(v)),this.timesOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(g),this.arithmeticHelper.coerceScalarToNumberOrError(v)),this.powerOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(g),this.arithmeticHelper.coerceScalarToNumberOrError(v)),this.divOp=(g,v)=>binaryErrorWrapper(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(g),this.arithmeticHelper.coerceScalarToNumberOrError(v)),this.unaryMinusOp=g=>unaryErrorWrapper(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(g)),this.percentOp=g=>unaryErrorWrapper(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(g)),this.unaryPlusOp=g=>this.arithmeticHelper.unaryPlus(g),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new CriterionBuilder(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(isExtendedNumber(n)){if(isNumberOverflow(getRawValue(n)))return new CellError(ErrorType.NUM,ErrorMessage.NaN);n=cloneNumber(n,fixNegativeZero(getRawValue(n)))}return n instanceof SimpleRangeValue&&n.height()===1&&n.width()===1&&([[n]]=n.data),wrapperForRootVertex(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case AstNodeType.EMPTY:return EmptyValue;case AstNodeType.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return invalidSimpleCellAddress(n)?new CellError(ErrorType.REF,ErrorMessage.BadRef):this.dependencyGraph.getCellValue(n)}case AstNodeType.NUMBER:case AstNodeType.STRING:return e.value;case AstNodeType.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,s,t)}case AstNodeType.EQUALS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,s,t)}case AstNodeType.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,s,t)}case AstNodeType.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,s,t)}case AstNodeType.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,s,t)}case AstNodeType.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,s,t)}case AstNodeType.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,s,t)}case AstNodeType.PLUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,s,t)}case AstNodeType.MINUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,s,t)}case AstNodeType.TIMES_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,s,t)}case AstNodeType.POWER_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,s,t)}case AstNodeType.DIV_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,s,t)}case AstNodeType.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case AstNodeType.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case AstNodeType.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case AstNodeType.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!FunctionRegistry.functionIsProtected(e.procedureName))return new CellError(ErrorType.LIC,ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new InterpreterState(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new CellError(ErrorType.NAME,ErrorMessage.FunctionName(e.procedureName))}case AstNodeType.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new CellError(ErrorType.NAME,ErrorMessage.NamedExpressionName(e.expressionName))}case AstNodeType.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteCellRange.fromCellRange(e,t.formulaAddress),s=this.dependencyGraph.getArray(n);if(s){const o=s.array;if(o instanceof NotComputedArray)throw new Error("Array should be already computed");if(o instanceof CellError)return o;if(o instanceof ArrayValue)return SimpleRangeValue.fromRange(o.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteColumnRange.fromColumnRange(e,t.formulaAddress);return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);const n=AbsoluteRowRange.fromRowRangeAst(e,t.formulaAddress);return SimpleRangeValue.onlyRange(n,this.dependencyGraph)}case AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case AstNodeType.ARRAY:{let n;const s=[];for(const o of e.args){let a;const l=[];for(const c of o){const h=coerceToRange(this.evaluateAst(c,t)),g=h.height();if(a===void 0)a=g,l.push(...h.data);else if(a===g)for(let v=0;v<g;v++)l[v].push(...h.data[v]);else return new CellError(ErrorType.REF,ErrorMessage.SizeMismatch)}const u=l[0].length;if(n===void 0)n=u,s.push(...l);else if(n===u)s.push(...l);else return new CellError(ErrorType.REF,ErrorMessage.SizeMismatch)}return SimpleRangeValue.onlyValues(s)}case AstNodeType.ERROR_WITH_RAW_INPUT:case AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var s;if(t instanceof SimpleRangeValue&&!n.arraysFlag&&(t=(s=coerceRangeToScalar(t,n))!==null&&s!==void 0?s:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),t instanceof CellError)return t;if(t instanceof SimpleRangeValue){const o=t.data.map(a=>a.map(e));return SimpleRangeValue.onlyValues(o)}return e(t)}binaryRangeWrapper(e,t,n,s){var o,a;if(t instanceof SimpleRangeValue&&!s.arraysFlag&&(t=(o=coerceRangeToScalar(t,s))!==null&&o!==void 0?o:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),t instanceof CellError)return t;if(n instanceof SimpleRangeValue&&!s.arraysFlag&&(n=(a=coerceRangeToScalar(n,s))!==null&&a!==void 0?a:new CellError(ErrorType.VALUE,ErrorMessage.ScalarExpected)),n instanceof CellError)return n;if(t instanceof SimpleRangeValue||n instanceof SimpleRangeValue){if(!(t instanceof SimpleRangeValue))if(n.isAdHoc()){const h=n.data;for(let g=0;g<h.length;g++)for(let v=0;v<h[0].length;v++)h[g][v]=e(t,h[g][v]);return SimpleRangeValue.onlyValues(h)}else t=SimpleRangeValue.fromScalar(t);if(!(n instanceof SimpleRangeValue))if(t.isAdHoc()){const h=t.data;for(let g=0;g<h.length;g++)for(let v=0;v<h[0].length;v++)h[g][v]=e(h[g][v],n);return SimpleRangeValue.onlyValues(h)}else n=SimpleRangeValue.fromScalar(n);if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const h=t.data,g=n.data;for(let v=0;v<h.length;v++)for(let m=0;m<h[0].length;m++)h[v][m]=e(h[v][m],g[v][m]);return SimpleRangeValue.onlyValues(h)}if(n.isAdHoc()){const h=t.data,g=n.data;for(let v=0;v<h.length;v++)for(let m=0;m<h[0].length;m++)g[v][m]=e(h[v][m],g[v][m]);return SimpleRangeValue.onlyValues(g)}}const l=Math.max(t.width(),n.width()),u=Math.max(t.height(),n.height()),c=Array(u);for(let h=0;h<u;h++)c[h]=Array(l);for(let h=0;h<u;h++){const g=t.height()!==1?h:0,v=n.height()!==1?h:0;for(let m=0;m<l;m++){const E=t.width()!==1?m:0,_=n.width()!==1?m:0;g<t.height()&&v<n.height()&&E<t.width()&&_<n.width()?c[h][m]=e(t.data[g][E],n.data[v][_]):c[h][m]=new CellError(ErrorType.NA)}}return SimpleRangeValue.onlyValues(c)}return e(t,n)}}function unaryErrorWrapper(r,e){return e instanceof CellError?e:r(e)}function binaryErrorWrapper(r,e,t){return e instanceof CellError?e:t instanceof CellError?t:r(e,t)}function wrapperForRootVertex(r,e){return r instanceof CellError&&e!==void 0?r.attachRootVertex(e):r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CombinedTransformer{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(n=>n.performEagerTransformations(e,t))}transformSingleAst(e,t){let[n,s]=[e,t];return this.transformations.forEach(o=>{[n,s]=o.transformSingleAst(n,s)}),[n,s]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LazilyTransformingAstService{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new CombinedTransformer(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(StatType.TRANSFORM_ASTS_POSTPONED);for(let o=n;o<this.transformations.length;o++){const a=this.transformations[o];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[l,u]=a.transformSingleAst(e,t);e=l,t=u}const s=this.parser.rememberNewAst(e);return this.stats.end(StatType.TRANSFORM_ASTS_POSTPONED),[s,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const s=this.transformations[n];(!t||t(s))&&(yield s)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NOT_FOUND$1=-1;function findLastOccurrenceInOrderedRange(r,e,{searchCoordinate:t,orderingDirection:n,ifNoMatch:s},o){const a=e.start[t],l=t==="col"?e.effectiveEndColumn(o):e.effectiveEndRow(o),u=t==="col"?v=>getRawValue(o.getCellValue(simpleCellAddress(e.sheet,v,e.start.row))):v=>getRawValue(o.getCellValue(simpleCellAddress(e.sheet,e.start.col,v))),c=n==="asc"?(v,m)=>compare(v,m):(v,m)=>-compare(v,m),h=findLastMatchingIndex(v=>c(r,u(v))>=0,a,l),g=u(h);if(g===r)return h-a;if(s==="returnLowerBound"){if(h===NOT_FOUND$1)return n==="asc"?NOT_FOUND$1:0;if(typeof g!=typeof r)return NOT_FOUND$1;if(n==="asc")return h-a;const v=h+1;return v<=l?v-a:NOT_FOUND$1}if(s==="returnUpperBound"){if(h===NOT_FOUND$1)return n==="asc"?0:NOT_FOUND$1;if(typeof g!=typeof r)return NOT_FOUND$1;if(n==="desc")return h-a;const v=h+1;return v<=l?v-a:NOT_FOUND$1}return NOT_FOUND$1}function findLastMatchingIndex(r,e,t){let n=e,s=t;for(;n<s;){const o=Math.ceil((n+s)/2);r(o)?n=o:s=o-1}return n===s&&r(n)?n:NOT_FOUND$1}function compare(r,e){return typeof r==typeof e?r===EmptyValue?0:r<e?-1:r>e?1:0:r===EmptyValue?-1:e===EmptyValue?1:e instanceof CellError||typeof r=="number"&&typeof e=="string"||typeof r=="number"&&typeof e=="boolean"?-1:typeof r=="string"&&typeof e=="number"?1:typeof r=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NOT_FOUND=-1;class AdvancedFind{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:n}={returnOccurrence:"first"}){const s=t.range,o=s===void 0?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(s),a=n==="first"?0:o.length-1,l=n==="first"?c=>c<o.length:c=>c>=0,u=n==="first"?c=>c+1:c=>c-1;for(let c=a;l(c);c=u(c))if(e(getRawValue(o[c])))return c;return NOT_FOUND}basicFind(e,t,n,{ordering:s,ifNoMatch:o,returnOccurrence:a}){const l=typeof e=="string"?forceNormalizeString(e):e,u=t.range;return u===void 0?this.findNormalizedValue(l,t.valuesFromTopLeftCorner(),o,a):s==="none"?this.findNormalizedValue(l,this.dependencyGraph.computeListOfValuesInRange(u),o,a):findLastOccurrenceInOrderedRange(l,u,{searchCoordinate:n,orderingDirection:s,ifNoMatch:o},this.dependencyGraph)}findNormalizedValue(e,t,n="returnNotFound",s="first"){const o=t.map(getRawValue).map(v=>typeof v=="string"?forceNormalizeString(v):v);if(n==="returnNotFound")return s==="first"?o.indexOf(e):o.lastIndexOf(e);const a=n==="returnLowerBound"?(v,m)=>compare(v,m):(v,m)=>-compare(v,m);let l=n==="returnLowerBound"?-1/0:1/0,u=NOT_FOUND;const c=s==="first"?0:o.length-1,h=s==="first"?v=>v<o.length:v=>v>=0,g=s==="first"?v=>v+1:v=>v-1;for(let v=c;h(v);v=g(v)){const m=o[v];if(m===e)return v;a(m,e)>0||a(l,m)<0&&(l=m,u=v)}return u}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ColumnBinarySearch extends AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,s){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ColumnIndex{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new ColumnBinarySearch(e)}add(e,t){if(!(e===EmptyValue||e instanceof CellError))if(e instanceof SimpleRangeValue)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(getRawValue(n),s);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof SimpleRangeValue)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(getRawValue(n),s);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(getRawValue(t.oldValue),getRawValue(t.value),t.address)}moveValues(e,t,n,s){for(const[o,a]of e){const l=movedSimpleCellAddress(a,s,t,n);this.remove(o,a),this.add(o,l)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,ifNoMatch:s,returnOccurrence:o}){o==null&&(o=n==="none"?"first":"last");const a=this.findUsingColumnIndex(e,t,o);return a!==void 0?a:this.binarySearchStrategy.find(e,t,{ordering:n,ifNoMatch:s,returnOccurrence:o})}findUsingColumnIndex(e,t,n){const s=t.range;if(s===void 0)return;this.ensureRecentData(s.sheet,s.start.col,e);const o=this.getColumnMap(s.sheet,s.start.col);if(!o)return-1;const a=typeof e=="string"?forceNormalizeString(e):e,l=o.get(a);if(!l||!l.index||l.index.length===0)return;const u=ColumnIndex.findRowBelongingToRange(l,s,n);return u!==void 0?u-s.start.row:void 0}static findRowBelongingToRange(e,t,n){const s=t.start.row,o=t.end.row,a=n==="first"?findInOrderedArray(s,e.index,"upperBound"):findInOrderedArray(o,e.index,"lowerBound");if(a===-1)return;const l=e.index[a];return l>=s&&l<=o?l:void 0}advancedFind(e,t,n={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,n)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let s=n[t];return s||(s=new Map,n[t]=s),s}getValueIndex(e,t,n){const s=this.getColumnMap(e,t);let o=this.getColumnMap(e,t).get(n);return o||(o={version:this.transformingService.version(),index:[]},s.set(n,o)),o}ensureRecentData(e,t,n){const s=this.getValueIndex(e,t,n),o=this.transformingService.version();if(s.version===o)return;const a=this.transformingService.getTransformationsFrom(s.version,l=>l.sheet===e&&(l instanceof AddRowsTransformer||l instanceof RemoveRowsTransformer));for(const l of a)l instanceof AddRowsTransformer?this.addRows(t,l.rowsSpan,n):l instanceof RemoveRowsTransformer&&this.removeRows(t,l.rowsSpan,n);s.version=o}addSingleCellValue(e,t){this.stats.measure(StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=forceNormalizeString(e));const n=this.getValueIndex(t.sheet,t.col,e);ColumnIndex.addValue(n,t.row)})}removeSingleValue(e,t){this.stats.measure(StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=forceNormalizeString(e));const s=n.get(e);if(!s)return;const o=findInOrderedArray(t.row,s.index);o>-1&&s.index.splice(o,1),s.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);ColumnIndex.shiftRows(s,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);ColumnIndex.removeRowsFromValues(s,t),ColumnIndex.shiftRows(s,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=findInOrderedArray(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=findInOrderedArray(t.rowStart,e.index,"upperBound"),s=findInOrderedArray(t.rowEnd,e.index,"lowerBound");n>-1&&s>-1&&n<=s&&e.index[n]<=t.rowEnd&&e.index.splice(n,s-n+1)}static shiftRows(e,t,n){const s=findInOrderedArray(t,e.index,"upperBound");if(s!==-1)for(let o=s;o<e.index.length;++o)e.index[o]+=n}}function findInOrderedArray(r,e,t="upperBound"){let n=0,s=e.length-1;for(;n<=s;){const l=Math.floor((n+s)/2);if(r>e[l])n=l+1;else if(r<e[l])s=l-1;else return l}const o=t==="lowerBound"?s:n;return o>=0&&o<=e.length?o:-1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function buildColumnSearchStrategy(r,e,t){return e.useColumnIndex?new ColumnIndex(r,e,t):new ColumnBinarySearch(r)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NumberLiteralHelper{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Serialization{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof FormulaCellVertex){const n=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(n.procedureName==="HYPERLINK")return n.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof FormulaCellVertex){const s=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(s,t)}else if(n instanceof ArrayVertex){const s=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(s.row!==e.row||s.col!==e.col||s.sheet!==e.sheet)return;t=t??e;const o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,t)}else if(n instanceof ParsingErrorVertex)return n.getFormula()}getCellSerialized(e,t){var n;return(n=this.getCellFormula(e,t))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),s=this.dependencyGraph.getSheetWidth(e),o=new Array(n);for(let a=0;a<n;a++){o[a]=new Array(s);for(let l=0;l<s;l++){const u=simpleCellAddress(e,l,a);o[a][l]=t(u)}for(let l=s-1;l>=0&&(o[a][l]===null||o[a][l]===void 0);l--)o[a].pop()}for(let a=n-1;a>=0&&o[a].length===0;a--)o.pop();return o}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(s)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);e[s]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,t){const n=new Unparser(e,buildLexerConfig(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new Serialization(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BuildEngineFactory{static buildFromSheets(e,t={},n=[]){const s=new Config(t);return this.buildEngine(s,e,n)}static buildFromSheet(e,t={},n=[]){const s=new Config(t),o=s.translationPackage.getUITranslation(UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(s,{[o]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new Config(e),{},t)}static rebuildWithConfig(e,t,n,s){return this.buildEngine(e,t,n,s)}static buildEngine(e,t={},n=[],s=e.useStats?new Statistics:new EmptyStatistics){s.start(StatType.BUILD_ENGINE_TOTAL);const o=new NamedExpressions,a=new FunctionRegistry(e),l=new LazilyTransformingAstService(s),u=DependencyGraph.buildEmpty(l,e,a,o,s),c=buildColumnSearchStrategy(u,e,s),h=u.sheetMapping,g=u.addressMapping;for(const Ce in t)if(Object.prototype.hasOwnProperty.call(t,Ce)){const Le=t[Ce];validateAsSheet(Le);const he=findBoundaries(Le);if(he.height>e.maxRows||he.width>e.maxColumns)throw new SheetSizeLimitExceededError;const ve=h.addSheet(Ce);g.autoAddSheet(ve,he)}const v=new ParserWithCaching(e,a,h.get);l.parser=v;const m=new Unparser(e,buildLexerConfig(e),h.fetchDisplayName,o),E=new DateTimeHelper(e),_=new NumberLiteralHelper(e),S=new ArithmeticHelper(e,E,_),w=new CellContentParser(e,E,_),A=new ArraySizePredictor(e,a),O=new Operations(e,u,c,w,v,s,l,o,A),D=new UndoRedo(e,O);l.undoRedo=D;const Y=new ClipboardOperations(e,u,O),H=new CrudOperations(e,O,D,Y,u,c,v,w,l,o);n.forEach(Ce=>{H.ensureItIsPossibleToAddNamedExpression(Ce.name,Ce.expression,Ce.scope),H.operations.addNamedExpression(Ce.name,Ce.expression,Ce.scope,Ce.options)});const k=new Exporter(e,o,h.fetchDisplayName,l),K=new Serialization(u,m,k),se=new Interpreter(e,u,c,s,S,a,o,K,A,E);s.measure(StatType.GRAPH_BUILD,()=>{new GraphBuilder(u,c,v,w,s,A).buildGraph(t,s)});const re=new Evaluator(e,s,se,l,u,c);return re.run(),s.end(StatType.BUILD_ENGINE_TOTAL),{config:e,stats:s,dependencyGraph:u,columnSearch:c,parser:v,unparser:m,cellContentParser:w,evaluator:re,lazilyTransformingAstService:l,crudOperations:H,exporter:k,namedExpressions:o,serialization:K,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function objectDestroy(r){for(const[e,t]of Object.entries(r))t instanceof Function?r[e]=postMortem(t):delete r[e]}function postMortem(r){return()=>{throw new Error(`The "${r}" method cannot be called because this HyperFormula instance has been destroyed`)}}var tinyEmitter={exports:{}},hasRequiredTinyEmitter;function requireTinyEmitter(){if(hasRequiredTinyEmitter)return tinyEmitter.exports;hasRequiredTinyEmitter=1;function r(){}return r.prototype={on:function(e,t,n){var s=this.e||(this.e={});return(s[e]||(s[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var s=this;function o(){s.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),s=0,o=n.length;for(s;s<o;s++)n[s].fn.apply(n[s].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),s=n[e],o=[];if(s&&t)for(var a=0,l=s.length;a<l;a++)s[a].fn!==t&&s[a].fn._!==t&&o.push(s[a]);return o.length?n[e]=o:delete n[e],this}},tinyEmitter.exports=r,tinyEmitter.exports.TinyEmitter=r,tinyEmitter.exports}var tinyEmitterExports=requireTinyEmitter();/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Events;(function(r){r.SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed"})(Events||(Events={}));class Emitter extends tinyEmitterExports.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperFormula{constructor(e,t,n,s,o,a,l,u,c,h,g,v,m,E){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=s,this._parser=o,this._unparser=a,this._cellContentParser=l,this._evaluator=u,this._lazilyTransformingAstService=c,this._crudOperations=h,this._exporter=g,this._namedExpressions=v,this._serialization=m,this._functionRegistry=E,this._emitter=new Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return getDefaultConfig()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(BuildEngineFactory.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(BuildEngineFactory.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){validateArgToType(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new LanguageNotRegisteredError;return t}static registerLanguage(e,t){if(validateArgToType(e,"string","languageCode"),this.registeredLanguages.has(e))throw new LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,buildTranslationPackage(t))}static unregisterLanguage(e){if(validateArgToType(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new LanguageNotRegisteredError}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){validateArgToType(e,"string","functionId"),FunctionRegistry.registerFunction(e,t,n)}static unregisterFunction(e){validateArgToType(e,"string","functionId"),FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){validateArgToType(e,"string","code");const t=FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return validateArgToType(e,"string","functionId"),FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new HyperFormula(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return validateArgToType(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return validateArgToType(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return validateArgToType(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return validateArgToType(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([n,s])=>this._config[n]===s)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(isSimpleCellAddress(e))t=new AbsoluteCellRange(e,e);else if(isSimpleCellRange(e))t=new AbsoluteCellRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const n of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){validateArgToType(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){validateArgToType(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){validateArgToType(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){validateArgToType(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeAddedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeRemovedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeAddedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){validateArgToType(e,"number","sheetId");const n=normalizeRemovedIndexes(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...t){return validateArgToType(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!isSimpleCellAddress(t))throw new ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");try{const n=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch{return!1}}moveCells(e,t){if(!isSimpleCellAddress(t))throw new ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const n=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,s){validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startRow"),validateArgToType(n,"number","numberOfRows"),validateArgToType(s,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,s),!0}catch{return!1}}moveRows(e,t,n,s){return validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startRow"),validateArgToType(n,"number","numberOfRows"),validateArgToType(s,"number","targetRow"),this._crudOperations.moveRows(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,s){validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startColumn"),validateArgToType(n,"number","numberOfColumns"),validateArgToType(s,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,s),!0}catch{return!1}}moveColumns(e,t,n,s){return validateArgToType(e,"number","sheetId"),validateArgToType(t,"number","startColumn"),validateArgToType(n,"number","numberOfColumns"),validateArgToType(s,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const t=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");const t=new AbsoluteCellRange(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellValue(s)))}getRangeFormulas(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellFormula(s)))}getRangeSerialized(e){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");return new AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellSerialized(s)))}getFillRangeData(e,t,n=!1){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","source");if(!isSimpleCellRange(t))throw new ExpectedValueOfTypeError("SimpleCellRange","target");const s=new AbsoluteCellRange(e.start,e.end),o=new AbsoluteCellRange(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(a=>a.map(l=>{const u=((l.row-(n?t:e).start.row)%s.height()+s.height())%s.height()+e.start.row,c=((l.col-(n?t:e).start.col)%s.width()+s.width())%s.width()+e.start.col;return this._serialization.getCellSerialized({row:u,col:c,sheet:s.sheet},l)}))}isItPossibleToAddSheet(e){validateArgToType(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&validateArgToType(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Events.SheetAdded,t),t}isItPossibleToRemoveSheet(e){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){validateArgToType(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return validateArgToType(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){validateArgToType(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return validateArgToType(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return validateArgToType(e,"string","cellAddress"),validateArgToType(t,"number","sheetId"),simpleCellAddressFromString(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return validateArgToType(e,"string","cellRange"),validateArgToType(t,"number","sheetId"),simpleCellRangeFromString(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const n=typeof t=="number"?t:t.includeSheetName?e.sheet+1:e.sheet;return simpleCellAddressToString(this.sheetMapping.fetchDisplayName,e,n)}simpleCellRangeToString(e,t={}){if(!isSimpleCellRange(e))throw new ExpectedValueOfTypeError("SimpleCellRange","cellRange");const n=typeof t=="number"?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return simpleCellRangeToString(this.sheetMapping.fetchDisplayName,e,n)}getCellDependents(e){let t;if(isSimpleCellAddress(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(isSimpleCellRange(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(isSimpleCellAddress(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(isSimpleCellRange(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return validateArgToType(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return validateArgToType(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return validateArgToType(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return getCellType(t,e)}doesCellHaveSimpleValue(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===CellType.VALUE}doesCellHaveFormula(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===CellType.FORMULA||t===CellType.ARRAYFORMULA}isCellEmpty(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===CellType.EMPTY}isCellPartOfArray(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===CellType.ARRAY||t===CellType.ARRAYFORMULA}getCellValueType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueType(t)}getCellValueDetailedType(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueDetailedType(t)}getCellValueFormat(e){if(!isSimpleCellAddress(e))throw new ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return getCellValueFormat(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){validateArgToType(e,"number","sheetId"),validateArgToType(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){validateArgToType(e,"number","sheetId"),validateArgToType(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);n!==void 0&&this._emitter.emit(Events.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch{return!1}}addNamedExpression(e,t,n,s){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,s);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(n===void 0)return;const s=this._serialization.getCellFormula(n.address);return{name:e,scope:t,expression:s,options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch{return!1}}changeNamedExpression(e,t,n,s){return validateArgToType(e,"string","expressionName"),n!==void 0&&validateArgToType(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){validateArgToType(e,"string","expressionName"),t!==void 0&&validateArgToType(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Events.NamedExpressionRemoved,n.displayName,s),s}else return[]}listNamedExpressions(e){return e!==void 0&&validateArgToType(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){validateArgToType(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new NotAFormulaError;return this._unparser.unparse(t,n)}calculateFormula(e,t){validateArgToType(e,"string","formulaString"),validateArgToType(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:s,dependencies:o}=this.extractTemporaryFormula(e,t);if(n===void 0)throw new NotAFormulaError;const a=this.evaluator.runAndForget(n,s,o);return this._exporter.exportScalarOrRange(a)}getNamedExpressionsFromFormula(e){validateArgToType(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new NotAFormulaError;const s=n.filter(a=>a instanceof NamedExpressionDependency).map(a=>a.name);return[...new Set(s)]}validateFormula(e){validateArgToType(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return HyperFormula.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return validateArgToType(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return validateArgToType(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return validateArgToType(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return validateArgToType(e,"number","val"),numberToSimpleTime(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){objectDestroy(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new EvaluationSuspendedError}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),s={sheet:t,col:0,row:0};if(!(n instanceof CellContent.Formula))return{address:s,dependencies:[]};const{ast:o,errors:a,dependencies:l}=this._parser.parse(n.formula,s);return a.length>0?{address:s,dependencies:[]}:{ast:o,address:s,dependencies:l}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),s=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),a=BuildEngineFactory.rebuildWithConfig(t,s,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Events.ValuesUpdated,n),n}}}HyperFormula.version="3.0.0";HyperFormula.buildDate="14/01/2025 11:44:17";HyperFormula.releaseDate="14/01/2025";HyperFormula.languages={};HyperFormula.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const privatePool=new WeakMap;class Config{constructor(e={},t=!0){const{accentSensitive:n,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:c,decimalSeparator:h,evaluateNullToZero:g,functionArgSeparator:v,functionPlugins:m,ignorePunctuation:E,leapYear1900:_,localeLang:S,language:w,ignoreWhiteSpace:A,licenseKey:O,matchWholeCell:D,arrayColumnSeparator:Y,arrayRowSeparator:H,maxRows:k,maxColumns:K,nullYear:se,nullDate:re,parseDateTime:Ce,precisionEpsilon:Le,precisionRounding:he,stringifyDateTime:ve,stringifyDuration:xe,smartRounding:Ie,timeFormats:we,thousandSeparator:Ne,useArrayArithmetic:at,useStats:nt,undoLimit:B,useColumnIndex:te,useRegularExpressions:V,useWildcards:ue}=e;this.useArrayArithmetic=configValueFromParam(at,"boolean","useArrayArithmetic"),this.accentSensitive=configValueFromParam(n,"boolean","accentSensitive"),this.caseSensitive=configValueFromParam(s,"boolean","caseSensitive"),this.caseFirst=configValueFromParam(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=configValueFromParam(E,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??Config.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...configValueFromParamCheck(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...configValueFromParamCheck(we,Array.isArray,"array","timeFormats")],this.functionArgSeparator=configValueFromParam(v,"string","functionArgSeparator"),this.decimalSeparator=configValueFromParam(h,[".",","],"decimalSeparator"),this.language=configValueFromParam(w,"string","language"),this.ignoreWhiteSpace=configValueFromParam(A,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=configValueFromParam(O,"string","licenseKey"),this.thousandSeparator=configValueFromParam(Ne,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=configValueFromParam(Y,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=configValueFromParam(H,[";","|"],"arrayRowSeparator"),this.localeLang=configValueFromParam(S,"string","localeLang"),this.functionPlugins=[...m??Config.defaultConfig.functionPlugins],this.smartRounding=configValueFromParam(Ie,"boolean","smartRounding"),this.evaluateNullToZero=configValueFromParam(g,"boolean","evaluateNullToZero"),this.nullYear=configValueFromParam(se,"number","nullYear"),validateNumberToBeAtLeast(this.nullYear,"nullYear",0),validateNumberToBeAtMost(this.nullYear,"nullYear",100),this.precisionRounding=configValueFromParam(he,"number","precisionRounding"),validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=configValueFromParam(Le,"number","precisionEpsilon"),validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=configValueFromParam(te,"boolean","useColumnIndex"),this.useStats=configValueFromParam(nt,"boolean","useStats"),this.parseDateTime=configValueFromParam(Ce,"function","parseDateTime"),this.stringifyDateTime=configValueFromParam(ve,"function","stringifyDateTime"),this.stringifyDuration=configValueFromParam(xe,"function","stringifyDuration"),this.translationPackage=HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=configValueFromParamCheck(re,instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=configValueFromParam(_,"boolean","leapYear1900"),this.undoLimit=configValueFromParam(B,"number","undoLimit"),this.useRegularExpressions=configValueFromParam(V,"boolean","useRegularExpressions"),this.useWildcards=configValueFromParam(ue,"boolean","useWildcards"),this.matchWholeCell=configValueFromParam(D,"boolean","matchWholeCell"),validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0),this.maxRows=configValueFromParam(k,"number","maxRows"),validateNumberToBeAtLeast(this.maxRows,"maxRows",1),this.maxColumns=configValueFromParam(K,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1),this.context=l,privatePool.set(this,{licenseKeyValidityState:checkLicenseKeyValidity(this.licenseKey)}),configCheckIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),configCheckIfParametersNotInConflict({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...configValueFromParamCheck(e,Array.isArray,"array","currencySymbol")];return t.forEach(n=>{if(typeof n!="string")throw new ExpectedValueOfTypeError("string[]","currencySymbol");if(n==="")throw new ConfigValueEmpty("currencySymbol")}),t}get licenseKeyValidityState(){return privatePool.get(this).licenseKeyValidityState}getConfig(){return getFullConfigFromPartial(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new Config(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,n,s){e!==void 0&&console.warn(s===void 0?`${t} option is deprecated since ${n}`:`${t} option is deprecated since ${n}, please use ${s}`)}}Config.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:defaultStringifyDateTime,stringifyDuration:defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function getFullConfigFromPartial(r){var e;const t={};for(const n in Config.defaultConfig){const s=(e=r[n])!==null&&e!==void 0?e:Config.defaultConfig[n];Array.isArray(s)?t[n]=[...s]:t[n]=s}return t}function getDefaultConfig(){return getFullConfigFromPartial({})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const dictionary={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var AbsStyle;(function(r){r[r.FullyAbsolute=1]="FullyAbsolute",r[r.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",r[r.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",r[r.FullyRelative=4]="FullyRelative"})(AbsStyle||(AbsStyle={}));class AddressPlugin extends FunctionPlugin{verifyAddressArguments(e,t,n,s){if(s){if(e<1||t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.FullyAbsolute==n){if(e<1||t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.RowAbsoluteColRelative==n){if(e<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}else if(AbsStyle.RowRelativeColAbsolute==n&&t<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(n,s,o,a,l)=>{const u=this.verifyAddressArguments(n,s,o,a);if(u!==void 0)return u;const c=columnIndexToLabel(s-1);let h="";l!=null&&(h=`${l}!`);const g=s==0?"C":`C[${s}]`,v=n==0?"R":`R[${n}]`;return AbsStyle.FullyRelative==o?a?`${h}${c}${n}`:`${h}${v}${g}`:AbsStyle.RowRelativeColAbsolute==o?a?`${h}$${c}${n}`:`${h}${v}C${s}`:AbsStyle.RowAbsoluteColRelative==o?a?`${h}${c}$${n}`:`${h}R${n}${g}`:a?`${h}$${c}$${n}`:`${h}R${n}C${s}`})}}AddressPlugin.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:FunctionArgumentType.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ArrayPlugin extends FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,t){if(e.args.length!==1)return ArraySize.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(o=>{var a;return this.arraySizeForAst(o,new InterpreterState(t.formulaAddress,t.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(n,s,o)=>{s=Math.min(s,n.height()),o=Math.min(o,n.width());const a=n.data,l=[];for(let u=0;u<s;u++)l.push(a[u].slice(0,o));return SimpleRangeValue.onlyValues(l)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return ArraySize.error();const n=this.metadata("ARRAY_CONSTRAIN"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))});let{height:o,width:a}=s[0];return e.args[1].type===AstNodeType.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===AstNodeType.NUMBER&&(a=Math.min(a,e.args[2].value)),o<1||a<1||!Number.isInteger(o)||!Number.isInteger(a)?ArraySize.error():new ArraySize(a,o)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(n,...s)=>{for(const l of s)if(n.width()!==l.width()||n.height()!==l.height())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);if(n.width()>1&&n.height()>1)return new CellError(ErrorType.NA,ErrorMessage.WrongDimension);const o=n.data,a=[];for(let l=0;l<n.height();l++){const u=[];for(let c=0;c<n.width();c++){let h=!0;for(const g of s)if(coerceScalarToBoolean(g.data[l][c])!==!0){h=!1;break}h&&u.push(o[l][c])}u.length>0&&a.push(u)}return a.length>0?SimpleRangeValue.onlyValues(a):new CellError(ErrorType.NA,ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return ArraySize.error();const n=this.metadata("FILTER"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))}),o=Math.max(...s.map(l=>l.width)),a=Math.max(...s.map(l=>l.height));return new ArraySize(o,a)}}ArrayPlugin.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AbsPlugin extends FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}AbsPlugin.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const MAX_48BIT_INTEGER=0xffffffffffff,SHIFT_MIN_POSITIONS=-53,SHIFT_MAX_POSITIONS=53;class BitShiftPlugin extends FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),shiftLeft)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),shiftRight)}}BitShiftPlugin.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:SHIFT_MIN_POSITIONS,maxValue:SHIFT_MAX_POSITIONS}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:SHIFT_MIN_POSITIONS,maxValue:SHIFT_MAX_POSITIONS}]}};function shiftLeft(r,e){return e<0?shiftRight(r,-e):validate(r*Math.pow(2,e))}function shiftRight(r,e){return e<0?shiftLeft(r,-e):validate(Math.floor(r/Math.pow(2,e)))}function validate(r){return r>MAX_48BIT_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.BitshiftLong):r}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BitwiseLogicOperationsPlugin extends FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(n,s)=>n&s)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(n,s)=>n|s)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(n,s)=>n^s)}}BitwiseLogicOperationsPlugin.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BooleanPlugin extends FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(n,s,o)=>n?s:o)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...n)=>{for(let s=0;s<n.length;s+=2)if(n[s])return n[s+1];return new CellError(ErrorType.NA,ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...n)=>n.filter(s=>s!==void 0).every(s=>!!s))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...n)=>n.filter(s=>s!==void 0).some(s=>s))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),n=>!n)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...n)=>{let s=0;return n.filter(o=>o!==void 0).forEach(o=>{o&&s++}),s%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(n,...s)=>{const o=s.length;let a=0;for(;a+1<o;a+=2)if(!(s[a]instanceof CellError)&&this.arithmeticHelper.eq(n,s[a]))return s[a+1];return a<o?s[a]:new CellError(ErrorType.NA,ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(n,s)=>n instanceof CellError?s:n)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(n,s)=>n instanceof CellError&&n.type===ErrorType.NA?s:n)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(n,...s)=>n>s.length?new CellError(ErrorType.NUM,ErrorMessage.Selector):s[n-1])}}BooleanPlugin.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CharPlugin extends FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=256?new CellError(ErrorType.VALUE,ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=1114112?new CellError(ErrorType.VALUE,ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}CharPlugin.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CodePlugin extends FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),n=>n.length===0?new CellError(ErrorType.VALUE,ErrorMessage.EmptyString):n.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),n=>{var s;return(s=n.codePointAt(0))!==null&&s!==void 0?s:new CellError(ErrorType.VALUE,ErrorMessage.EmptyString)})}}CodePlugin.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:FunctionArgumentType.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CountBlankPlugin extends FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...n)=>{let s=0;return n.forEach(o=>{o===EmptyValue&&s++}),s})}}CountBlankPlugin.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CountUniquePlugin extends FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...n)=>{const s=new Set,o=new Set;for(const a of n)a instanceof CellError?o.add(a.type):a!==""&&s.add(a);return s.size+o.size})}}CountUniquePlugin.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DateTimePlugin extends FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s),a=o+((4-o)%7+7)%7,l=Math.floor((t-1)/7)-Math.floor((a-1)/7)+1;return l===0?this.isoweeknumCore(e-7)+1:l},this.days360Core=(e,t,n)=>{const s=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);let a,l;return n?(a=toBasisEU(s),l=toBasisEU(o)):[a,l]=this.dateTimeHelper.toBasisUS(s,o),360*(l.year-a.year)+30*(l.month-a.month)+l.day-a.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(n,s,o)=>{const a=Math.trunc(o);let l=Math.trunc(s),u=Math.trunc(n);u<this.dateTimeHelper.getEpochYearZero()&&(u+=this.dateTimeHelper.getEpochYearZero());const c=Math.floor((l-1)/12);u+=c,l-=c*12;const h={year:u,month:l,day:1};if(this.dateTimeHelper.isValidDate(h)){let g=this.dateTimeHelper.dateToNumber(h)+(a-1);return g=this.dateTimeHelper.getWithinBounds(g),g===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):g}return new CellError(ErrorType.VALUE,ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(n,s,o)=>{const a=timeToNumber({hours:Math.trunc(n),minutes:Math.trunc(s),seconds:Math.trunc(o)});return a<0?new CellError(ErrorType.NUM,ErrorMessage.NegativeTime):a%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(n,s)=>{const o=this.dateTimeHelper.numberToSimpleDate(n);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(offsetMonth(o,s)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):a})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(n,s)=>Math.trunc(n)-Math.trunc(s))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),n=>numberToSimpleTime(roundToNearestSecond(n)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(n,s)=>format(n,s,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(n,s)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(s===3)return(o-1)%7;const a=weekdayOffsets.get(s);return a===void 0?new CellError(ErrorType.NUM,ErrorMessage.BadMode):(o-a)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(n,s)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),u=this.dateTimeHelper.relativeNumberToAbsoluteNumber(l);if(s===21)return this.isoweeknumCore(n);const c=weekdayOffsets.get(s);return c===void 0?new CellError(ErrorType.NUM,ErrorMessage.BadMode):Math.floor((o-c)/7)-Math.floor((u-c)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),n=>{const{dateTime:s}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return s===void 0?new CellError(ErrorType.VALUE,ErrorMessage.IncorrectDateTime):instanceOfSimpleDate(s)?(instanceOfSimpleTime(s)?Math.trunc(timeToNumber(s)):0)+this.dateTimeHelper.dateToNumber(s):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),n=>{const s=this.dateTimeHelper.dateStringToDateNumber(n);return s===void 0?new CellError(ErrorType.VALUE,ErrorMessage.IncorrectDateTime):getRawValue(s)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const n=new Date(Date.now());return timeToNumber({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(n,s)=>{const o=this.dateTimeHelper.numberToSimpleDate(n),a=truncateDayInMonth(offsetMonth(o,s));let l=this.dateTimeHelper.dateToNumber(a);return l=this.dateTimeHelper.getWithinBounds(l),l===void 0?new CellError(ErrorType.NUM,ErrorMessage.DateBounds):l})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(n,s,o)=>{if(n>s)return new CellError(ErrorType.NUM,ErrorMessage.StartEndDate);if(o==="D")return Math.floor(s)-Math.floor(n);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);switch(o){case"M":return(l.year-a.year)*12+(l.month-a.month)-(l.day<a.day?1:0);case"YM":return(12+(l.month-a.month)-(l.day<a.day?1:0))%12;case"Y":return l.month>a.month||l.month===a.month&&l.day>=a.day?l.year-a.year:l.year-a.year-1;case"MD":if(l.day>=a.day)return l.day-a.day;{const u=l.month===1?12:l.month-1,c=l.month===1?l.year-1:l.year;return this.dateTimeHelper.daysInMonth(c,u)+l.day-a.day}case"YD":return l.month>a.month||l.month===a.month&&l.day>=a.day?Math.floor(s)-this.dateTimeHelper.dateToNumber({year:l.year,month:a.month,day:a.day}):Math.floor(s)-Math.floor(n)-365*(l.year-a.year-1)-this.dateTimeHelper.leapYearsCount(l.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new CellError(ErrorType.NUM,ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(n,s,o)=>{switch(n=Math.trunc(n),s=Math.trunc(s),n>s&&([n,s]=[s,n]),o){case 0:return this.days360Core(n,s,!1)/360;case 1:return(s-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(s));case 2:return(s-n)/360;case 3:return(s-n)/365;case 4:return this.days360Core(n,s,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const s=n%60;n=Math.trunc(n/60);const o=n%60;n=Math.trunc(n/60);const a=n%24;n=Math.trunc(n/24);const l=n%30;n=Math.trunc(n/30);const u=n%12,c=Math.trunc(n/12);return"P"+(c>0?`${c}Y`:"")+(u>0?`${u}M`:"")+(l>0?`${l}D`:"")+"T"+(a>0?`${a}H`:"")+(o>0?`${o}M`:"")+(s>0?`${s}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(n,s,o)=>this.networkdayscore(n,s,1,o))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(n,s,o,a)=>this.networkdayscore(n,s,o,a))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(n,s,o)=>this.workdaycore(n,s,1,o))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(n,s,o,a)=>this.workdaycore(n,s,o,a))}networkdayscore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);let o=1;e>t&&([e,t]=[t,e],o=-1);const a=computeWeekendPattern(n);if(a instanceof CellError)return a;const l=this.simpleRangeToFilteredHolidays(a,s);return l instanceof CellError?l:o*this.countWorkdays(e,t,a,l)}workdaycore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);const o=computeWeekendPattern(n);if(o instanceof CellError)return o;const a=this.simpleRangeToFilteredHolidays(o,s);if(a instanceof CellError)return a;if(t>0){let l=1;for(;this.countWorkdays(e+1,e+l,o,a)<t;)l*=2;let u=1;for(;u+1<l;){const c=Math.trunc((u+l)/2);this.countWorkdays(e+1,e+c,o,a)<t?u=c:l=c}return e+l}else if(t<0){t*=-1;let l=1;for(;this.countWorkdays(e-l,e-1,o,a)<t;)l*=2;let u=1;for(;u+1<l;){const c=Math.trunc((u+l)/2);this.countWorkdays(e-c,e-1,o,a)<t?u=c:l=c}return e-l}else return e}countWorkdays(e,t,n,s){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let l=0;for(let u=0;u<7;u++)n.charAt(u)==="0"&&(l+=Math.floor((o+6-u)/7),l-=Math.floor((a-1+6-u)/7));return l-=lowerBound(t+1,s)-lowerBound(e,s),l}simpleRangeToFilteredHolidays(e,t){var n;const s=(n=t==null?void 0:t.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const a of s)if(a instanceof CellError)return a;const o=[];for(const a of s)if(a!==EmptyValue)if(isExtendedNumber(a))o.push(Math.trunc(getRawValue(a)));else return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);return[...new Set(o)].sort((a,l)=>a-l).filter(a=>{const u=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(u)==="0"})}}DateTimePlugin.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:FunctionArgumentType.STRING}],returnNumberType:NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:FunctionArgumentType.STRING}],returnNumberType:NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]}};function lowerBound(r,e){if(e.length===0||r<=e[0])return 0;if(e[e.length-1]<r)return e.length;let t=0,n=e.length-1;for(;t+1<n;){const s=Math.floor((n+t)/2);e[s]>=r?n=s:t=s}return n}function computeWeekendPattern(r){var e;return typeof r!="number"&&typeof r!="string"?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):typeof r=="string"?r.length!==7||!/^(0|1)*$/.test(r)||r==="1111111"?new CellError(ErrorType.NUM,ErrorMessage.WeekendString):r:(e=workdayPatterns.get(r))!==null&&e!==void 0?e:new CellError(ErrorType.NUM,ErrorMessage.BadMode)}const weekdayOffsets=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),workdayPatterns=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DegreesPlugin extends FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}DegreesPlugin.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class DeltaPlugin extends FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(n,s)=>n===s?1:0)}}DeltaPlugin.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ExpPlugin extends FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}ExpPlugin.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FinancialPlugin extends FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),pmtCore)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),ipmtCore)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),ppmtCore)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),fvCore)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(n,s,o,a,l,u)=>{if(a>l)return new CellError(ErrorType.NUM,ErrorMessage.EndStartPeriod);let c=0;for(let h=a;h<=l;h++)c+=ipmtCore(n,h,s,o,0,u);return c})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(n,s,o,a,l,u)=>{if(a>l)return new CellError(ErrorType.NUM,ErrorMessage.EndStartPeriod);let c=0;for(let h=a;h<=l;h++)c+=ppmtCore(n,h,s,o,0,u);return c})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(n,s,o,a,l)=>{if(l===12&&a>o||a>o+1)return new CellError(ErrorType.NUM,ErrorMessage.PeriodLong);if(s>=n)return 0;const u=Math.round((1-Math.pow(s/n,1/o))*1e3)/1e3,c=n*u*l/12;if(a===1)return c;let h=c;for(let g=0;g<a-2;g++)h+=(n-h)*u;return a===o+1?(n-h)*u*(12-l)/12:(n-h)*u})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(n,s,o,a,l)=>{if(a>o)return new CellError(ErrorType.NUM);let u=l/o,c;u>=1?(u=1,a===1?c=n:c=0):c=n*Math.pow(1-u,a-1);const h=n*Math.pow(1-u,a);return Math.max(c-Math.max(s,h),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(n,s)=>{if(s<1)return new CellError(ErrorType.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/s})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(n,s)=>{if(s<1)return new CellError(ErrorType.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*s/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(n,s)=>(s=Math.trunc(s),Math.pow(1+n/s,s)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(n,s,o,a)=>o===0?new CellError(ErrorType.DIV_BY_ZERO):a*n*(s/o-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(n,s)=>(s=Math.trunc(s),(Math.pow(n+1,1/s)-1)*s))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(n,s,o,a,l)=>n===0?s===0?new CellError(ErrorType.DIV_BY_ZERO):(-o-a)/s:(l&&(s*=1+n),Math.log((s-a*n)/(o*n+s))/Math.log(1+n)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(n,s,o,a,l,u)=>{if(u<=-1)return new CellError(ErrorType.VALUE);const c=1e-7,h=50;let g=u;l=l?1:0;for(let v=0;v<h;v++){if(g<=-1)return new CellError(ErrorType.NUM);let m;if(Math.abs(g)<c)m=o*(1+n*g)+s*(1+g*l)*n+a;else{const _=Math.pow(1+g,n);m=o*_+s*(1/g+l)*(_-1)+a}if(Math.abs(m)<c)return g;let E;if(Math.abs(g)<c)E=o*n+s*l*n;else{const _=Math.pow(1+g,n),S=n*Math.pow(1+g,n-1);E=o*S+s*(1/g+l)*S+s*(-1/(g*g))*(_-1)}g-=m/E}return new CellError(ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(n,s,o,a,l)=>(l=l?1:0,n===-1?s===0?new CellError(ErrorType.NUM):new CellError(ErrorType.DIV_BY_ZERO):n===0?-o*s-a:((1-Math.pow(1+n,s))*o*(1+n*l)/n-a)/Math.pow(1+n,s)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(n,s,o)=>s===0||o<0&&s>0||o>0&&s<0?new CellError(ErrorType.NUM):Math.pow(o/s,1/n)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(n,s,o)=>o===0?new CellError(ErrorType.DIV_BY_ZERO):(n-s)/o)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(n,s,o,a)=>a>o?new CellError(ErrorType.NUM):(n-s)*(o-a+1)*2/(o*(o+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);if(l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day))return new CellError(ErrorType.NUM);const u=360-o*(s-n);return u===0?0:u<0?new CellError(ErrorType.NUM):365*o/u})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);if(l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day))return new CellError(ErrorType.NUM);const u=360-o*(s-n);return u===0?0:u<0?new CellError(ErrorType.NUM):100*(1-o*(s-n)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(n,s,o)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new CellError(ErrorType.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),l=this.dateTimeHelper.numberToSimpleDate(s);return l.year>a.year+1||l.year===a.year+1&&(l.month>a.month||l.month===a.month&&l.day>a.day)?new CellError(ErrorType.NUM):(100-o)*360/(o*(s-n))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(n,s)=>{const o=s.valuesFromTopLeftCorner();for(const a of o)if(a instanceof CellError)return a;for(const a of o)if(isExtendedNumber(a))n*=1+getRawValue(a);else if(a!==EmptyValue)return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);return n})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(n,...s)=>{const o=this.arithmeticHelper.coerceNumbersExactRanges(s);return o instanceof CellError?o:npvCore(n,o)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(n,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof CellError)return a;let l=!1,u=!1;const c=[],h=[];for(const E of a)E>0?(l=!0,c.push(E),h.push(0)):E<0?(u=!0,h.push(E),c.push(0)):(h.push(0),c.push(0));if(!l||!u)return new CellError(ErrorType.DIV_BY_ZERO);const g=a.length,v=npvCore(o,c);if(v instanceof CellError)return v;const m=npvCore(s,h);return m instanceof CellError?m:Math.pow(-v*Math.pow(1+o,g)/m/(1+s),1/(g-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(n,s,o)=>(Math.log(o)-Math.log(s))/Math.log(1+n))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(n,s,o)=>{const a=s.valuesFromTopLeftCorner();for(const v of a)if(typeof v!="number")return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);const l=a,u=o.valuesFromTopLeftCorner();for(const v of u)if(typeof v!="number")return new CellError(ErrorType.VALUE,ErrorMessage.NumberExpected);const c=u;if(c.length!==l.length)return new CellError(ErrorType.NUM,ErrorMessage.EqualLength);const h=c.length;let g=0;if(c[0]<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);for(let v=0;v<h;v++){if(c[v]=Math.floor(c[v]),c[v]<c[0])return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);g+=l[v]/Math.pow(1+n,(c[v]-c[0])/365)}return g})}}FinancialPlugin.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.INTEGER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE}],returnNumberType:NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],returnNumberType:NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]}};function pmtCore(r,e,t,n,s){if(r===0)return(-t-n)/e;{const o=Math.pow(1+r,e);return(n*r+t*r*o)*(s?1/(1+r):1)/(1-o)}}function ipmtCore(r,e,t,n,s,o){const a=pmtCore(r,t,n,s,o);return e===1?r*(o?0:-n):r*(o?fvCore(r,e-2,a,n,o)-a:fvCore(r,e-1,a,n,o))}function fvCore(r,e,t,n,s){if(r===0)return-n-t*e;{const o=Math.pow(1+r,e);return t*(s?1+r:1)*(1-o)/r-n*o}}function ppmtCore(r,e,t,n,s,o){return pmtCore(r,t,n,s,o)-ipmtCore(r,e,t,n,s,o)}function npvCore(r,e){let t=0;for(let n=e.length-1;n>=0;n--){if(t+=e[n],r===-1){if(t===0)continue;return new CellError(ErrorType.DIV_BY_ZERO)}t/=1+r}return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FormulaTextPlugin extends FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber),n=>{var s;return(s=this.serialization.getCellFormula(n))!==null&&s!==void 0?s:new CellError(ErrorType.NA,ErrorMessage.Formula)})}}FormulaTextPlugin.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperlinkPlugin extends FunctionPlugin{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(n,s)=>(e.hyperlink=n,s??n))}}HyperlinkPlugin.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class InformationPlugin extends FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),n=>n instanceof CellError&&n.type!==ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),n=>n instanceof CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof FormulaVertex)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),n=>n===EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),n=>n instanceof CellError&&n.type==ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),n=>n instanceof CellError&&(n.type==ErrorType.REF||n.type==ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,n=>n.col+1)}columns(e,t){if(e.args.length!==1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);if(e.args.some(s=>s.type===AstNodeType.EMPTY))return new CellError(ErrorType.NUM,ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===AstNodeType.PARENTHESIS;)n=n.expression;if(n.type===AstNodeType.CELL_RANGE||n.type===AstNodeType.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===AstNodeType.CELL_REFERENCE)return 1;if(n.type===AstNodeType.ROW_RANGE)return this.config.maxColumns;{const s=this.evaluateAst(n,t);return s instanceof SimpleRangeValue?s.width():s instanceof CellError?s:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,n=>n.row+1)}rows(e,t){if(e.args.length!==1)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);if(e.args.some(s=>s.type===AstNodeType.EMPTY))return new CellError(ErrorType.NUM,ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===AstNodeType.PARENTHESIS;)n=n.expression;if(n.type===AstNodeType.CELL_RANGE||n.type===AstNodeType.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===AstNodeType.CELL_REFERENCE)return 1;if(n.type===AstNodeType.COLUMN_RANGE)return this.config.maxRows;{const s=this.evaluateAst(n,t);return s instanceof SimpleRangeValue?s.height():s instanceof CellError?s:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(n,s,o)=>{var a,l,u,c,h,g;return o<1||s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o>n.width()||s>n.height()?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(g=(u=(l=(a=n==null?void 0:n.data)===null||a===void 0?void 0:a[s-1])===null||l===void 0?void 0:l[o-1])!==null&&u!==void 0?u:(h=(c=n==null?void 0:n.data)===null||c===void 0?void 0:c[0])===null||h===void 0?void 0:h[0])!==null&&g!==void 0?g:new CellError(ErrorType.VALUE,ErrorMessage.CellRangeExpected)})}na(e,t){return new CellError(ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const s=this.dependencyGraph.sheetMapping.get(n);return s!==void 0?s+1:new CellError(ErrorType.NA,ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new CellError(ErrorType.VALUE,ErrorMessage.CellRefExpected))}}InformationPlugin.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class IsEvenPlugin extends FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),n=>n%2===0)}}IsEvenPlugin.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class IsOddPlugin extends FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),n=>n%2===1)}}IsOddPlugin.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LogarithmPlugin extends FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(n,s)=>Math.log(n)/Math.log(s))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}LogarithmPlugin.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const PI=parseFloat(Math.PI.toFixed(14));class MathConstantsPlugin extends FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>PI)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),n=>Math.sqrt(PI*n))}}MathConstantsPlugin.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function arraySizeForMultiplication(r,e){return new ArraySize(e.width,r.height)}function arraySizeForPoolFunction(r,e,t){return new ArraySize(1+(r.width-e)/t,1+(r.height-e)/t)}class MatrixPlugin extends FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(n,s)=>{if(!n.hasOnlyNumbers()||!s.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);if(s.height()!==n.width())return new CellError(ErrorType.VALUE,ErrorMessage.ArrayDimensions);const o=arraySizeForMultiplication(n.size,s.size),a=this.createKernel(function(l,u,c){let h=0;for(let g=0;g<c;++g)h+=l[this.thread.y][g]*u[g][this.thread.x];return h},o)(n.rawNumbers(),s.rawNumbers(),n.width());return SimpleRangeValue.onlyNumbers(a)})}mmultArraySize(e,t){if(e.args.length!==2)return ArraySize.error();const n=this.metadata("MMULT"),s=e.args.map(l=>{var u;return this.arraySizeForAst(l,new InterpreterState(t.formulaAddress,t.arraysFlag||((u=n==null?void 0:n.arrayFunction)!==null&&u!==void 0?u:!1)))}),[o,a]=s;return arraySizeForMultiplication(o,a)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(n,s,o=s)=>{if(!n.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);const a=arraySizeForPoolFunction(n.size,s,o),l=this.createKernel(function(u,c,h){const g=this.thread.x*h,v=this.thread.y*h;let m=u[v][g];for(let E=0;E<c;E++)for(let _=0;_<c;_++)m=Math.max(m,u[v+E][g+_]);return m},a)(n.rawNumbers(),s,o);return SimpleRangeValue.onlyNumbers(l)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(n,s,o=s)=>{if(!n.hasOnlyNumbers())return new CellError(ErrorType.VALUE,ErrorMessage.NumberRange);const a=arraySizeForPoolFunction(n.size,s,o),l=this.createKernel(function(u,c,h){const g=this.thread.x*h,v=this.thread.y*h;let m=u[v][g];for(let O=0;O<c;O++)for(let D=0;D<c;D++)m=Math.max(m,u[v+O][g+D]);let E=u[v][g];for(let O=0;O<c;O++)for(let D=0;D<c;D++)E=Math.min(E,u[v+O][g+D]);const _=c*c;let S=E,w=m,A=42;for(let O=0;O<32;O++){const D=(S+w)/2;let Y=0;for(let H=0;H<c;H++)for(let k=0;k<c;k++)u[v+H][g+k]>D&&Y++;if(c%2===0)if(Y===_/2){A=D;break}else Y>_/2?S=D:w=D;else if(Y===(_-1)/2){A=D;break}else Y>(_-1)/2?S=D:w=D}return A},a)(n.rawNumbers(),s,o);return SimpleRangeValue.onlyNumbers(l)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return ArraySize.error();const n=this.metadata("MAXPOOL"),o=e.args.map(c=>{var h;return this.arraySizeForAst(c,new InterpreterState(t.formulaAddress,t.arraysFlag||((h=n==null?void 0:n.arrayFunction)!==null&&h!==void 0?h:!1)))})[0],a=e.args[1];let l;a.type===AstNodeType.NUMBER?l=a.value:l=1;let u=l;if(e.args.length===3){const c=e.args[2];c.type===AstNodeType.NUMBER?u=c.value:u=1}return l>o.width||l>o.height||u>l||(o.width-l)%u!==0||(o.height-l)%u!==0?ArraySize.error():arraySizeForPoolFunction(o,l,u)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),n=>{const s=n.rawData(),o=n.size,a=[];for(let l=0;l<o.width;++l){a[l]=[];for(let u=0;u<o.height;++u)a[l][u]=s[u][l]}return SimpleRangeValue.onlyValues(a)})}transposeArraySize(e,t){if(e.args.length!==1)return ArraySize.error();const n=this.metadata("TRANSPOSE"),s=e.args.map(a=>{var l;return this.arraySizeForAst(a,new InterpreterState(t.formulaAddress,t.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[o]=s;return new ArraySize(o.height,o.width)}createKernel(e,t){return function(...n){const s=[];for(let o=0;o<t.height;++o){s.push([]);for(let a=0;a<t.width;++a)s[o][a]=e.apply({thread:{x:a,y:o}},n)}return s}}}MatrixPlugin.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MedianPlugin extends FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof CellError?s:s.length===0?new CellError(ErrorType.NUM,ErrorMessage.OneValue):(s.sort((o,a)=>o-a),s.length%2===0?(s[s.length/2-1]+s[s.length/2])/2:s[Math.floor(s.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof CellError?o:(o.sort((a,l)=>a-l),s=Math.trunc(s),s>o.length?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o[o.length-s])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof CellError?o:(o.sort((a,l)=>a-l),s=Math.trunc(s),s>o.length?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o[s-1])})}}MedianPlugin.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ModuloPlugin extends FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(n,s)=>s===0?new CellError(ErrorType.DIV_BY_ZERO):n%s)}}ModuloPlugin.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function zeroForInfinite$1(r){return isExtendedNumber(r)&&!Number.isFinite(getRawValue(r))?0:r}class MomentsAggregate{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new MomentsAggregate(e*e,e,1)}compose(e){return new MomentsAggregate(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}MomentsAggregate.empty=new MomentsAggregate(0,0,0);class NumericAggregationPlugin extends FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(getRawValue(n),2),strictlyNumbers)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(s,o)=>Math.max(s,o),getRawValue,numbersBooleans);return zeroForInfinite$1(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(s,o)=>Math.min(s,o),getRawValue,numbersBooleans);return zeroForInfinite$1(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const s=this.reduce(e.args,t,MomentsAggregate.empty,"_AGGREGATE_A",(o,a)=>o.compose(a),o=>MomentsAggregate.single(getRawValue(o)),numbersBooleans);return s instanceof CellError?s:(n=s.averageValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof CellError?s:(n=s.varSValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}varpa(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof CellError?s:(n=s.varPValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof CellError)return n;{const s=n.varSValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof CellError)return n;{const s=n.varPValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:FunctionArgumentType.NUMBER},t),s=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(s,t);case 2:case 102:return this.doCount(s,t);case 3:case 103:return this.doCounta(s,t);case 4:case 104:return this.doMax(s,t);case 5:case 105:return this.doMin(s,t);case 6:case 106:return this.doProduct(s,t);case 7:case 107:return this.doStdevS(s,t);case 8:case 108:return this.doStdevP(s,t);case 9:case 109:return this.doSum(s,t);case 10:case 110:return this.doVarS(s,t);case 11:case 111:return this.doVarP(s,t);default:return new CellError(ErrorType.VALUE,ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,MomentsAggregate.empty,"_AGGREGATE",(n,s)=>n.compose(s),n=>MomentsAggregate.single(getRawValue(n)),strictlyNumbers)}reduceAggregateA(e,t){return this.reduce(e,t,MomentsAggregate.empty,"_AGGREGATE_A",(n,s)=>n.compose(s),n=>MomentsAggregate.single(getRawValue(n)),numbersBooleans)}doAverage(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.averageValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doVarS(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.varSValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doVarP(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof CellError?s:(n=s.varPValue())!==null&&n!==void 0?n:new CellError(ErrorType.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof CellError)return n;{const s=n.varSValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof CellError)return n;{const s=n.varPValue();return s===void 0?new CellError(ErrorType.DIV_BY_ZERO):Math.sqrt(s)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(n,s)=>n+s,getRawValue,n=>isExtendedNumber(n)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(n,s)=>n+s,getRawValue,n=>n===EmptyValue?0:1)}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(s,o)=>Math.max(s,o),getRawValue,strictlyNumbers);return zeroForInfinite$1(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(s,o)=>Math.min(s,o),getRawValue,strictlyNumbers);return zeroForInfinite$1(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,getRawValue,strictlyNumbers)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(n,s)=>n*s,getRawValue,strictlyNumbers)}reduce(e,t,n,s,o,a,l){return e.length<1?new CellError(ErrorType.NA,ErrorMessage.WrongArgNumber):e.reduce((u,c)=>{if(u instanceof CellError)return u;if(c.type===AstNodeType.CELL_RANGE||c.type===AstNodeType.COLUMN_RANGE||c.type===AstNodeType.ROW_RANGE){const g=this.evaluateRange(c,t,n,s,o,a,l);return g instanceof CellError?g:o(g,u)}let h;if(h=this.evaluateAst(c,t),h instanceof SimpleRangeValue)return Array.from(h.valuesFromTopLeftCorner()).map(l).filter(v=>v!==void 0).map(v=>v instanceof CellError?v:a(v)).reduce((v,m)=>v instanceof CellError?v:m instanceof CellError?m:o(v,m),u);if(c.type===AstNodeType.CELL_REFERENCE){if(h=l(h),h===void 0)return u}else if(h=this.coerceScalarToNumberOrError(h),h=l(h),h===void 0)return u;return h instanceof CellError?h:o(u,a(h))},n)}evaluateRange(e,t,n,s,o,a,l){let u;try{u=AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(g){if(g instanceof SheetsNotEqual)return new CellError(ErrorType.REF,ErrorMessage.RangeManySheets);throw g}const c=this.dependencyGraph.getRange(u.start,u.end);if(c===void 0)throw new Error("Range does not exists in graph");let h=c.getFunctionValue(s);return h===void 0&&(h=this.getRangeValues(s,u,c,a,l).reduce((v,m)=>v instanceof CellError?v:m instanceof CellError?m:o(v,m),n),c.setFunctionValue(s,h)),h}getRangeValues(e,t,n,s,o){const a=[],{smallerRangeVertex:l,restRange:u}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let c;if(l!==void 0&&this.dependencyGraph.existsEdge(l,n)){const h=l.getFunctionValue(e);if(h!==void 0)a.push(h);else for(const g of l.range.addresses(this.dependencyGraph)){const v=o(this.dependencyGraph.getScalarValue(g));v instanceof CellError?a.push(v):v!==void 0&&a.push(s(v))}c=u}else c=t;for(const h of c.addresses(this.dependencyGraph)){const g=o(this.dependencyGraph.getScalarValue(h));g instanceof CellError?a.push(g):g!==void 0&&a.push(s(g))}return a}}NumericAggregationPlugin.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1}};NumericAggregationPlugin.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function strictlyNumbers(r){if(isExtendedNumber(r)||r instanceof CellError)return r}function numbersBooleans(r){return typeof r=="boolean"?coerceBooleanToNumber(r):isExtendedNumber(r)||r instanceof CellError?r:typeof r=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class PowerPlugin extends FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}PowerPlugin.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RadiansPlugin extends FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}RadiansPlugin.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const MAX_LENGTH=10,DECIMAL_NUMBER_OF_BITS=255,MIN_BASE=2,MAX_BASE=36,ALPHABET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class RadixConversionPlugin extends FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(n,s)=>decimalToBaseWithExactPadding(n,2,s))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(n,s)=>decimalToBaseWithExactPadding(n,8,s))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(n,s)=>decimalToBaseWithExactPadding(n,16,s))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),n=>{const s=coerceStringToBase(n,2,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):twoComplementToDecimal(s,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(n,s)=>{const o=coerceStringToBase(n,2,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):decimalToBaseWithExactPadding(twoComplementToDecimal(o,2),8,s)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(n,s)=>{const o=coerceStringToBase(n,2,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotBinary):decimalToBaseWithExactPadding(twoComplementToDecimal(o,2),16,s)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),n=>{const s=coerceStringToBase(n,8,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):twoComplementToDecimal(s,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(n,s)=>{const o=coerceStringToBase(n,8,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):decimalToBaseWithExactPadding(twoComplementToDecimal(o,8),2,s)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(n,s)=>{const o=coerceStringToBase(n,8,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotOctal):decimalToBaseWithExactPadding(twoComplementToDecimal(o,8),16,s)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),n=>{const s=coerceStringToBase(n,16,MAX_LENGTH);return s===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):twoComplementToDecimal(s,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(n,s)=>{const o=coerceStringToBase(n,16,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):decimalToBaseWithExactPadding(twoComplementToDecimal(o,16),2,s)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(n,s)=>{const o=coerceStringToBase(n,16,MAX_LENGTH);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):decimalToBaseWithExactPadding(twoComplementToDecimal(o,16),8,s)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),decimalToBaseWithMinimumPadding)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(n,s)=>{const o=coerceStringToBase(n,s,DECIMAL_NUMBER_OF_BITS);return o===void 0?new CellError(ErrorType.NUM,ErrorMessage.NotHex):parseInt(o,s)})}}RadixConversionPlugin.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:MAX_LENGTH}]},DECIMAL:{method:"decimal",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,minValue:MIN_BASE,maxValue:MAX_BASE}]},BASE:{method:"base",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:MIN_BASE,maxValue:MAX_BASE},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:DECIMAL_NUMBER_OF_BITS}]}};function coerceStringToBase(r,e,t){const n=ALPHABET.substr(0,e),s=new RegExp(`^[${n}]+$`);if(!(r.length>t||!s.test(r)))return r}function decimalToBaseWithExactPadding(r,e,t){if(r>maxValFromBase(e))return new CellError(ErrorType.NUM,ErrorMessage.ValueBaseLarge);if(r<minValFromBase(e))return new CellError(ErrorType.NUM,ErrorMessage.ValueBaseSmall);const n=decimalToRadixComplement(r,e);return t===void 0||r<0?n:n.length>t?new CellError(ErrorType.NUM,ErrorMessage.ValueBaseLong):padLeft(n,t)}function minValFromBase(r){return-Math.pow(r,MAX_LENGTH)/2}function maxValFromBase(r){return-minValFromBase(r)-1}function decimalToBaseWithMinimumPadding(r,e,t){const n=decimalToRadixComplement(r,e);return t!==void 0&&t>n.length?padLeft(n,t):n}function decimalToRadixComplement(r,e){const t=r<0?Math.pow(e,MAX_LENGTH):0;return(r+t).toString(e).toUpperCase()}function twoComplementToDecimal(r,e){const t=parseInt(r,e),n=Math.pow(e,MAX_LENGTH);return t>=n/2?t-n:t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RandomPlugin extends FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(n,s)=>s<n?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.ceil(n),s=Math.floor(s)+1,n===s&&(s+=1),n+Math.floor(Math.random()*(s-n))))}}RandomPlugin.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function findNextOddNumber(r){const e=Math.ceil(r);return e%2===1?e:e+1}function findNextEvenNumber(r){const e=Math.ceil(r);return e%2===0?e:e+1}class RoundingPlugin extends FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(n,s)=>{const o=Math.pow(10,s);return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),n=>n<0?-findNextEvenNumber(-n):findNextEvenNumber(n))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),n=>n<0?-findNextOddNumber(-n):findNextOddNumber(n))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(n,s,o)=>s===0||n===0?0:(s=Math.abs(s),o===1&&n<0&&(s=-s),Math.ceil(n/s)*s))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(n,s)=>n===0?0:s===0?new CellError(ErrorType.DIV_BY_ZERO):n>0&&s<0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.ceil(n/s)*s)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.ceil(n/s)*s))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(n,s,o)=>s===0||n===0?0:(s=Math.abs(s),o===1&&n<0&&(s*=-1),Math.floor(n/s)*s))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(n,s)=>n===0?0:s===0?new CellError(ErrorType.DIV_BY_ZERO):n>0&&s<0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.floor(n/s)*s)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.floor(n/s)*s))}}RoundingPlugin.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]}};RoundingPlugin.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SqrtPlugin extends FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}SqrtPlugin.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function*empty(){}function split(r){const e=r[Symbol.iterator](),{done:t,value:n}=e.next();return t?{rest:empty()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const findSmallerRangeForMany=(r,e,t)=>{if(t.end.row>t.start.row){const n=simpleCellAddress(t.end.sheet,t.end.col,t.end.row-1),s=r.getRange(t.start,n);if(s!==void 0)return{smallerRangeVertex:s,restValuesRange:t.withStart(simpleCellAddress(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(o=>o.withStart(simpleCellAddress(o.start.sheet,o.start.col,o.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class CriterionFunctionCompute{constructor(e,t,n,s,o){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=s,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const o of t)if(!o.conditionRange.sameDimensionsAs(e))return new CellError(ErrorType.VALUE,ErrorMessage.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),s=t.map(o=>this.tryToGetRangeVertexForRangeValue(o.conditionRange));if(n&&s.every(o=>o!==void 0)){const o=t.map(u=>u.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),o);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const l=this.buildNewCriterionCache(this.cacheKey(t),t.map(u=>u.conditionRange.range),e.range);return l.has(o)||l.set(o,[this.evaluateRangeValue(e,t),t.map(u=>u.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(t),l),s.forEach(u=>{u!==void 0&&u.addDependentCacheRange(n)}),l.get(o)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map(l=>l.criterionPackage.lambda),s=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=t.map(l=>l.conditionRange.iterateValuesFromTopLeftCorner()),a=ifFilter(n,o,s);return this.reduceFunction(a)}buildNewCriterionCache(e,t,n){const s=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:o,restConditionRanges:a,restValuesRange:l}=findSmallerRangeForMany(this.dependencyGraph,t,n);let u;o!==void 0&&this.dependencyGraph.existsEdge(o,s)?u=o.getCriterionFunctionValues(e):u=new Map;const c=new Map;return u.forEach(([h,g],v)=>{const m=ifFilter(g,a.map(_=>getRangeValues(this.dependencyGraph,_)),Array.from(getRangeValues(this.dependencyGraph,l)).map(this.mapFunction)[Symbol.iterator]()),E=this.composeFunction(h,this.reduceFunction(m));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),c.set(v,[E,g])}),c}}class Condition{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*getRangeValues(r,e){for(const t of e.addresses(r))yield getRawValue(r.getScalarValue(t))}function*ifFilter(r,e,t){for(const n of t){const s=e.map(a=>split(a));if(!s.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const o=s.map(a=>getRawValue(a.value));zip(o,r).every(([a,l])=>l(a))&&(yield n),e=s.map(a=>a.rest)}}function zip(r,e){const t=[];for(let n=0;n<Math.min(r.length,e.length);n++)t.push([r[n],e[n]]);return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class AverageResult{constructor(e,t){this.sum=e,this.count=t}static single(e){return new AverageResult(e,1)}compose(e){return new AverageResult(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}AverageResult.empty=new AverageResult(0,0);function conditionalAggregationFunctionCacheKey(r){return e=>{const t=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[r,...t].join(",")}}function zeroForInfinite(r){return isExtendedNumber(r)&&!Number.isFinite(getRawValue(r))?0:r}function mapToRawScalarValue(r){if(r instanceof CellError)return r;if(isExtendedNumber(r))return getRawValue(r)}class ConditionalAggregationPlugin extends FunctionPlugin{sumif(e,t){const n="SUMIF",s=(o,a,l)=>this.computeConditionalAggregationFunction(l??o,[o,a],n,0,(u,c)=>this.arithmeticHelper.nonstrictadd(u,c),mapToRawScalarValue);return this.runFunction(e.args,t,this.metadata(n),s)}sumifs(e,t){const n="SUMIFS",s=(o,...a)=>this.computeConditionalAggregationFunction(o,a,n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),mapToRawScalarValue);return this.runFunction(e.args,t,this.metadata(n),s)}averageif(e,t){const n="AVERAGEIF",s=(o,a,l)=>{const u=this.computeConditionalAggregationFunction(l??o,[o,a],n,AverageResult.empty,(c,h)=>c.compose(h),c=>isExtendedNumber(c)?AverageResult.single(getRawValue(c)):AverageResult.empty);return u instanceof CellError?u:u.averageValue()||new CellError(ErrorType.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(n),s)}countif(e,t){const n="COUNTIF",s=(o,a)=>this.computeConditionalAggregationFunction(o,[o,a],n,0,(l,u)=>l+u,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}countifs(e,t){const n="COUNTIFS",s=(...o)=>this.computeConditionalAggregationFunction(o[0],o,n,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}minifs(e,t){const n="MINIFS",s=(a,l)=>l===void 0||a===void 0?l===void 0?a:l:Math.min(a,l),o=(a,...l)=>{const u=this.computeConditionalAggregationFunction(a,l,n,Number.POSITIVE_INFINITY,s,mapToRawScalarValue);return zeroForInfinite(u)};return this.runFunction(e.args,t,this.metadata(n),o)}maxifs(e,t){const n="MAXIFS",s=(a,l)=>l===void 0||a===void 0?l===void 0?a:l:Math.max(a,l),o=(a,...l)=>{const u=this.computeConditionalAggregationFunction(a,l,n,Number.NEGATIVE_INFINITY,s,mapToRawScalarValue);return zeroForInfinite(u)};return this.runFunction(e.args,t,this.metadata(n),o)}computeConditionalAggregationFunction(e,t,n,s,o,a){const l=[];for(let u=0;u<t.length;u+=2){const c=t[u],h=this.interpreter.criterionBuilder.fromCellValue(t[u+1],this.arithmeticHelper);if(h===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.BadCriterion);l.push(new Condition(c,h))}return new CriterionFunctionCompute(this.interpreter,conditionalAggregationFunctionCacheKey(n),s,o,a).compute(e,l)}}ConditionalAggregationPlugin.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SumprodPlugin extends FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...n)=>{const s=n[0].width(),o=n[0].height();for(const u of n)if(u.width()!==s||u.height()!==o)return new CellError(ErrorType.VALUE,ErrorMessage.EqualLength);let a=0;const l=n.map(u=>u.iterateValuesFromTopLeftCorner());for(let u=0;u<s*o;u++){let c=1;for(const h of l){const g=h.next().value;if(g instanceof CellError)return g;const v=this.coerceScalarToNumberOrError(g);isExtendedNumber(v)?c*=getRawValue(v):c=0}a+=c}return a})}}SumprodPlugin.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:FunctionArgumentType.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TextPlugin extends FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(n,s)=>{const o=n.split(" ");return s>=o.length||s<0?new CellError(ErrorType.VALUE,ErrorMessage.IndexBounds):o[s]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),n=>n.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),n=>n.replace(new RegExp("\\p{L}+","gu"),s=>s.charAt(0).toUpperCase()+s.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(n,s)=>n===s)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeCount):n.repeat(s))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):s===0?"":n.slice(-s))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(n,s)=>s<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.slice(0,s))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(n,s,o)=>s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.substring(s-1,s+o-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(n,s,o,a)=>s<1?new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne):o<0?new CellError(ErrorType.VALUE,ErrorMessage.NegativeLength):n.substring(0,s-1)+a+n.substring(s+o-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(n,s,o)=>{if(o<1||o>s.length)return new CellError(ErrorType.VALUE,ErrorMessage.LengthBounds);const a=n.toLowerCase(),l=s.substring(o-1).toLowerCase(),u=this.arithmeticHelper.requiresRegex(a)?this.arithmeticHelper.searchString(a,l):l.indexOf(a);return u>-1?u+o:new CellError(ErrorType.VALUE,ErrorMessage.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(n,s,o,a)=>{const l=this.escapeRegExpSpecialCharacters(s),u=new RegExp(l,"g");if(a===void 0)return n.replace(u,o);if(a<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);let c,h=0;for(;(c=u.exec(n))!==null;)if(a===++h)return n.substring(0,c.index)+o+n.substring(u.lastIndex);return n})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(n,s,o)=>{if(o<1||o>s.length)return new CellError(ErrorType.VALUE,ErrorMessage.IndexBounds);const l=s.substring(o-1).indexOf(n)+o;return l>0?l:new CellError(ErrorType.VALUE,ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),n=>n instanceof CellError||typeof n=="string"?n:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),n=>n.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}TextPlugin.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.STRING},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:FunctionArgumentType.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TrigonometryPlugin extends FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(n,s)=>n===0&&s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.atan2(s,n))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.tan(n))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),n=>n===0?PI/2:Math.atan(1/n))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),n=>n===0?new CellError(ErrorType.NUM,ErrorMessage.NonZero):Math.atanh(1/n))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),n=>n===0?new CellError(ErrorType.DIV_BY_ZERO):1/Math.sinh(n))}}TrigonometryPlugin.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:FunctionArgumentType.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RowSearchStrategy extends AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LookupPlugin extends FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(n,s,o,a)=>{const l=s.range;if(l===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(o<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);if(o>l.width())return new CellError(ErrorType.REF,ErrorMessage.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doVlookup(zeroIfEmpty(n),s,o-1,u)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(n,s,o,a)=>{const l=s.range;if(l===void 0)return new CellError(ErrorType.VALUE,ErrorMessage.WrongType);if(o<1)return new CellError(ErrorType.VALUE,ErrorMessage.LessThanOne);if(o>l.height())return new CellError(ErrorType.REF,ErrorMessage.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doHlookup(zeroIfEmpty(n),s,o-1,u)})}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),(n,s,o,a,l,u)=>{if(![0,-1,1,2].includes(l))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);if(![1,-1,2,-2].includes(u))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);const c=s instanceof SimpleRangeValue?s:SimpleRangeValue.fromScalar(s),h=o instanceof SimpleRangeValue?o:SimpleRangeValue.fromScalar(o),g=l===2,v={ordering:u===2?"asc":u===-2?"desc":"none",returnOccurrence:u===-1?"last":"first",ifNoMatch:l===-1?"returnLowerBound":l===1?"returnUpperBound":"returnNotFound"};return this.doXlookup(zeroIfEmpty(n),c,h,a,g,v)})}xlookupArraySize(e){var t,n;const s=(t=e==null?void 0:e.args)===null||t===void 0?void 0:t[1],o=(n=e==null?void 0:e.args)===null||n===void 0?void 0:n[2];if((s==null?void 0:s.start)==null||(s==null?void 0:s.end)==null||(o==null?void 0:o.start)==null||(o==null?void 0:o.end)==null)return ArraySize.error();const a=s.end.row-s.start.row+1,l=s.end.col-s.start.col+1,u=o.end.row-o.start.row+1,c=o.end.col-o.start.col+1,h=l===1&&u===a;return!h&&!(a===1&&c===l)?ArraySize.error():h?new ArraySize(c,1):new ArraySize(1,u)}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(n,s,o)=>this.doMatch(zeroIfEmpty(n),s,o))}searchInRange(e,t,n,s,o){return n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e)?o.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:s.returnOccurrence}):o.find(e,t,s)}doVlookup(e,t,n,s){this.dependencyGraph.stats.start(StatType.VLOOKUP);const o=t.range;let a;o===void 0?a=SimpleRangeValue.onlyValues(t.data.map(c=>[c[0]])):a=SimpleRangeValue.onlyRange(AbsoluteCellRange.spanFrom(o.start,1,o.height()),this.dependencyGraph);const l=this.searchInRange(e,a,s.ordering==="none",s,this.columnSearch);if(this.dependencyGraph.stats.end(StatType.VLOOKUP),l===-1)return new CellError(ErrorType.NA,ErrorMessage.ValueNotFound);let u;if(o===void 0)u=t.data[l][n];else{const c=simpleCellAddress(o.sheet,o.start.col+n,o.start.row+l);u=this.dependencyGraph.getCellValue(c)}return u instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):u}doHlookup(e,t,n,s){const o=t.range;let a;o===void 0?a=SimpleRangeValue.onlyValues([t.data[0]]):a=SimpleRangeValue.onlyRange(AbsoluteCellRange.spanFrom(o.start,o.width(),1),this.dependencyGraph);const l=this.searchInRange(e,a,s.ordering==="none",s,this.rowSearch);if(l===-1)return new CellError(ErrorType.NA,ErrorMessage.ValueNotFound);let u;if(o===void 0)u=t.data[n][l];else{const c=simpleCellAddress(o.sheet,o.start.col+l,o.start.row+n);u=this.dependencyGraph.getCellValue(c)}return u instanceof SimpleRangeValue?new CellError(ErrorType.VALUE,ErrorMessage.WrongType):u}doXlookup(e,t,n,s,o,a){const l=t.width()===1&&n.height()===t.height(),u=t.height()===1&&n.width()===t.width();if(!l&&!u)return new CellError(ErrorType.VALUE,ErrorMessage.WrongDimension);const c=l?this.columnSearch:this.rowSearch,h=this.searchInRange(e,t,o,a,c);if(h===-1)return s==ErrorType.NA?new CellError(ErrorType.NA,ErrorMessage.ValueNotFound):s;const g=l?[n.data[h]]:n.data.map(v=>[v[h]]);return SimpleRangeValue.onlyValues(g)}doMatch(e,t,n){if(![-1,0,1].includes(n))return new CellError(ErrorType.VALUE,ErrorMessage.BadMode);if(t.width()>1&&t.height()>1)return new CellError(ErrorType.NA);const s=t.width()===1?this.columnSearch:this.rowSearch,o=n===0?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:n===-1?"desc":"asc",ifNoMatch:n===-1?"returnUpperBound":"returnLowerBound"},a=s.find(e,t,o);return a===-1?new CellError(ErrorType.NA,ErrorMessage.ValueNotFound):a+1}}LookupPlugin.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",arraySizeMethod:"xlookupArraySize",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.SCALAR,optionalArg:!0,defaultValue:ErrorType.NA},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:FunctionArgumentType.NOERROR},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RomanPlugin extends FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(n,s)=>(n=Math.trunc(n),s===!1?s=4:s===!0&&(s=0),s=getRawValue(this.coerceScalarToNumberOrError(s)),s instanceof CellError?s:(s=Math.trunc(s),s<0?new CellError(ErrorType.VALUE,ErrorMessage.ValueSmall):s>4?new CellError(ErrorType.VALUE,ErrorMessage.ValueLarge):romanMode(n,s))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let s=!1;if(n.startsWith("-")&&(n=n.slice(1),s=!0,n===""))return new CellError(ErrorType.VALUE,ErrorMessage.InvalidRoman);const o={input:n,acc:0};return eatToken(o,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),eatToken(o,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),eatToken(o,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),eatToken(o,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),eatToken(o,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),eatToken(o,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),eatToken(o,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),eatToken(o,{token:"IX",val:9}),eatToken(o,{token:"V",val:5},{token:"IV",val:4}),eatToken(o,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),o.input!==""?new CellError(ErrorType.VALUE,ErrorMessage.InvalidRoman):s?-o.acc:o.acc})}}RomanPlugin.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:FunctionArgumentType.STRING}]}};function eatToken(r,...e){for(const t of e)if(r.input.startsWith(t.token)){r.input=r.input.slice(t.token.length),r.acc+=t.val;break}}function romanMode(r,e){const t={val:r%1e3,acc:"M".repeat(Math.floor(r/1e3))};return e===4&&(absorb(t,"IM",999,1e3),absorb(t,"ID",499,500)),e>=3&&(absorb(t,"VM",995,1e3),absorb(t,"VD",495,500)),e>=2&&(absorb(t,"XM",990,1e3),absorb(t,"XD",490,500)),e>=1&&(absorb(t,"LM",950,1e3),absorb(t,"LD",450,500)),absorb(t,"CM",900,1e3),absorb(t,"CD",400,500),absorb(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(absorb(t,"IC",99,100),absorb(t,"IL",49,50)),e>=1&&(absorb(t,"VC",95,100),absorb(t,"VL",45,50)),absorb(t,"XC",90,100),absorb(t,"XL",40,50),absorb(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,absorb(t,"IX",9,10),absorb(t,"IV",4,5),absorb(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function absorb(r,e,t,n){r.val>=t&&r.val<n&&(r.val-=t,r.acc+=e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SimpleArithmerticPlugin extends FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}SimpleArithmerticPlugin.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:FunctionArgumentType.STRING,passSubtype:!0},{argumentType:FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:FunctionArgumentType.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var M=Math;function _horner(r,e){for(var t=0,n=0;t<r.length;++t)n=e*n+r[t];return n}function _bessel_iter(r,e,t,n,s){if(e===0)return t;if(e===1)return n;for(var o=2/r,a=n,l=1;l<e;++l)a=n*l*o+s*t,t=n,n=a;return a}function _bessel_wrap(r,e,t,n,s){return function(a,l){if(n){if(a===0)return n==1?-1/0:1/0;if(a<0)return NaN}if(l===0)return r(a);if(l===1)return e(a);if(l<0)return NaN;l|=0;var u=r(a),c=e(a);return _bessel_iter(a,l,u,c,s)}}var besselj=function(){var r=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function o(g){var v=0,m=0,E=0,_=g*g;if(g<8)m=_horner(e,_),E=_horner(t,_),v=m/E;else{var S=g-.785398164;_=64/_,m=_horner(n,_),E=_horner(s,_),v=M.sqrt(r/g)*(M.cos(S)*m-M.sin(S)*E*8/g)}return v}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(g){var v=0,m=0,E=0,_=g*g,S=M.abs(g)-2.356194491;return Math.abs(g)<8?(m=g*_horner(a,_),E=_horner(l,_),v=m/E):(_=64/_,m=_horner(u,_),E=_horner(c,_),v=M.sqrt(r/M.abs(g))*(M.cos(S)*m-M.sin(S)*E*8/M.abs(g)),g<0&&(v=-v)),v}return function g(v,m){if(m=Math.round(m),!isFinite(v))return isNaN(v)?v:0;if(m<0)return(m%2?-1:1)*g(v,-m);if(v<0)return(m%2?-1:1)*g(-v,m);if(m===0)return o(v);if(m===1)return h(v);if(v===0)return 0;var E=0;if(v>m)E=_bessel_iter(v,m,o(v),h(v),-1);else{for(var _=2*M.floor((m+M.floor(M.sqrt(40*m)))/2),S=!1,w=0,A=0,O=1,D=0,Y=2/v,H=_;H>0;H--)D=H*Y*O-w,w=O,O=D,M.abs(O)>1e10&&(O*=1e-10,w*=1e-10,E*=1e-10,A*=1e-10),S&&(A+=O),S=!S,H==m&&(E=w);A=2*A-O,E/=A}return E}}(),bessely=function(){var r=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function o(g){var v=0,m=0,E=0,_=g*g,S=g-.785398164;return g<8?(m=_horner(e,_),E=_horner(t,_),v=m/E+r*besselj(g,0)*M.log(g)):(_=64/_,m=_horner(n,_),E=_horner(s,_),v=M.sqrt(r/g)*(M.sin(S)*m+M.cos(S)*E*8/g)),v}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(g){var v=0,m=0,E=0,_=g*g,S=g-2.356194491;return g<8?(m=g*_horner(a,_),E=_horner(l,_),v=m/E+r*(besselj(g,1)*M.log(g)-1/g)):(_=64/_,m=_horner(u,_),E=_horner(c,_),v=M.sqrt(r/g)*(M.sin(S)*m+M.cos(S)*E*8/g)),v}return _bessel_wrap(o,h,"BESSELY",1,-1)}(),besseli=function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(a){return a<=3.75?_horner(r,a*a/(3.75*3.75)):M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(e,3.75/M.abs(a))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),s=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function o(a){return a<3.75?a*_horner(n,a*a/(3.75*3.75)):(a<0?-1:1)*M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(s,3.75/M.abs(a))}return function a(l,u){if(u=Math.round(u),u===0)return t(l);if(u===1)return o(l);if(u<0)return NaN;if(M.abs(l)===0)return 0;if(l==1/0)return 1/0;var c=0,h,g=2/M.abs(l),v=0,m=1,E=0,_=2*M.round((u+M.round(M.sqrt(40*u)))/2);for(h=_;h>0;h--)E=h*g*m+v,v=m,m=E,M.abs(m)>1e10&&(m*=1e-10,v*=1e-10,c*=1e-10),h==u&&(c=v);return c*=a(l,0)/m,l<0&&u%2?-c:c}}(),besselk=function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(a){return a<=2?-M.log(a/2)*besseli(a,0)+_horner(r,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(e,2/a)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function o(a){return a<=2?M.log(a/2)*besseli(a,1)+1/a*_horner(n,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(s,2/a)}return _bessel_wrap(t,o,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function erf(r){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,n=!1,s=0,o=0,a,l,u,c;if(r===0)return 0;for(r<0&&(r=-r,n=!0),a=2/(2+r),l=4*a-2;t>0;t--)u=s,s=l*s-o+e[t],o=u;return c=a*Math.exp(-r*r+.5*(e[0]+l*s)-o),n?c-1:1-c}function erfc(r){return 1-erf(r)}function erfcinv(r){let e=0,t,n,s,o;if(r>=2)return-100;if(r<=0)return 100;for(o=r<1?r:2-r,s=Math.sqrt(-2*Math.log(o/2)),t=-.70711*((2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s);e<2;e++)n=erfc(t)-o,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return r<1?t:-t}const exponential={pdf:(r,e)=>r<0?0:e*Math.exp(-e*r),cdf:(r,e)=>r<0?0:1-Math.exp(-e*r)};function gammafn(r){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,s=0,o=0,a=0,l=r,u,c,h,g;if(r>171.6243769536076)return 1/0;if(l<=0)if(g=l%1,g)n=(l&1?-1:1)*Math.PI/Math.sin(Math.PI*g),l=1-l;else return 1/0;for(h=l,l<1?c=l++:c=(l-=s=(l|0)-1)-1,u=0;u<8;++u)a=(a+e[u])*c,o=o*c+t[u];if(g=a/o+1,h<l)g/=h;else if(h>l)for(u=0;u<s;++u)g*=l,l++;return n&&(g=n/g),g}const gamma={pdf:function(e,t,n){return e<0?0:e===0&&t===1?1/n:Math.exp((t-1)*Math.log(e)-e/n-gammaln(t)-t*Math.log(n))},cdf:function(e,t,n){return e<0?0:lowRegGamma(t,e/n)},inv:function(r,e,t){return gammapinv(r,e)*t}};function gammaln(r){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,s,o,a;for(a=(o=s=r)+5.5,a-=(s+.5)*Math.log(a);e<6;e++)n+=t[e]/++o;return Math.log(2.5066282746310007*n/s)-a}function lowRegGamma(r,e){const t=gammaln(r);let n=r,s=1/r,o=s,a=e+1-r,l=1/1e-30,u=1/a,c=u,h=1;const g=-~(Math.log(r>=1?r:1/r)*8.5+r*.4+17);let v;if(e<0||r<=0)return NaN;if(e<r+1){for(;h<=g;h++)s+=o*=e/++n;return s*Math.exp(-e+r*Math.log(e)-t)}for(;h<=g;h++)v=-h*(h-r),a+=2,u=v*u+a,l=a+v/l,u=1/u,c*=u*l;return 1-c*Math.exp(-e+r*Math.log(e)-t)}function gammapinv(r,e){let t=0;const n=e-1,s=1e-8,o=gammaln(e);let a,l,u,c,h,g,v;if(r>=1)return Math.max(100,e+100*Math.sqrt(e));if(r<=0)return 0;for(e>1?(g=Math.log(n),v=Math.exp(n*(g-1)-o),h=r<.5?r:1-r,u=Math.sqrt(-2*Math.log(h)),a=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,r<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(u=1-e*(.253+e*.12),r<u?a=Math.pow(r/u,1/e):a=1-Math.log(1-(r-u)/(1-u)));t<12;t++){if(a<=0)return 0;if(l=lowRegGamma(e,a)-r,e>1?u=v*Math.exp(-(a-n)+n*(Math.log(a)-g)):u=Math.exp(-a+n*Math.log(a)-o),c=l/u,a-=u=c/(1-.5*Math.min(1,c*((e-1)/a-1))),a<=0&&(a=.5*(a+u)),Math.abs(u)<s*a)break}return a}const normal={pdf:function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return .5*(1+erf((e-t)/Math.sqrt(2*n*n)))},inv:function(r,e,t){return-1.4142135623730951*t*erfcinv(2*r)+e}},beta={pdf:function(e,t,n){return e>1||e<0?0:t==1&&n==1?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/betafn(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-betaln(t,n))},cdf:function(e,t,n){return e>1||e<0?+(e>1):ibeta(e,t,n)},inv:function(e,t,n){return ibetainv(e,t,n)}};function betafn(r,e){if(!(r<=0||e<=0))return r+e>170?Math.exp(betaln(r,e)):gammafn(r)*gammafn(e)/gammafn(r+e)}function betaln(r,e){return gammaln(r)+gammaln(e)-gammaln(r+e)}function ibetainv(r,e,t){var n=1e-8,s=e-1,o=t-1,a=0,l,u,c,h,g,v,m,E,_,S,w;if(r<=0)return 0;if(r>=1)return 1;for(e>=1&&t>=1?(c=r<.5?r:1-r,h=Math.sqrt(-2*Math.log(c)),m=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,r<.5&&(m=-m),E=(m*m-3)/6,_=2/(1/(2*e-1)+1/(2*t-1)),S=m*Math.sqrt(E+_)/_-(1/(2*t-1)-1/(2*e-1))*(E+5/6-2/(3*_)),m=e/(e+t*Math.exp(2*S))):(l=Math.log(e/(e+t)),u=Math.log(t/(e+t)),h=Math.exp(e*l)/e,g=Math.exp(t*u)/t,S=h+g,r<h/S?m=Math.pow(e*S*r,1/e):m=1-Math.pow(t*S*(1-r),1/t)),w=-gammaln(e)-gammaln(t)+gammaln(e+t);a<10;a++){if(m===0||m===1)return m;if(v=ibeta(m,e,t)-r,h=Math.exp(s*Math.log(m)+o*Math.log(1-m)+w),g=v/h,m-=h=g/(1-.5*Math.min(1,g*(s/m-o/(1-m)))),m<=0&&(m=.5*(m+h)),m>=1&&(m=.5*(m+h+1)),Math.abs(h)<n*m&&a>0)break}return m}function ibeta(r,e,t){var n=r===0||r===1?0:Math.exp(gammaln(e+t)-gammaln(e)-gammaln(t)+e*Math.log(r)+t*Math.log(1-r));return r<0||r>1?!1:r<(e+1)/(e+t+2)?n*betacf(r,e,t)/e:1-n*betacf(1-r,t,e)/t}function betacf(r,e,t){var n=1e-30,s=1,o=e+t,a=e+1,l=e-1,u=1,c=1-o*r/a,h,g,v,m;for(Math.abs(c)<n&&(c=n),c=1/c,m=c;s<=100&&(h=2*s,g=s*(t-s)*r/((l+h)*(e+h)),c=1+g*c,Math.abs(c)<n&&(c=n),u=1+g/u,Math.abs(u)<n&&(u=n),c=1/c,m*=c*u,g=-(e+s)*(o+s)*r/((e+h)*(a+h)),c=1+g*c,Math.abs(c)<n&&(c=n),u=1+g/u,Math.abs(u)<n&&(u=n),c=1/c,v=c*u,m*=v,!(Math.abs(v-1)<3e-7));s++);return m}const binomial={pdf:function(r,e,t){return t===0||t===1?e*t===r?1:0:combination(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r)},cdf:function(r,e,t){var n,s=1e-10;if(r<0)return 0;if(r>=e)return 1;if(t<0||t>1||e<=0)return NaN;r=Math.floor(r);var o=t,a=r+1,l=e-r,u=a+l,c=Math.exp(gammaln(u)-gammaln(l)-gammaln(a)+a*Math.log(o)+l*Math.log(1-o));return o<(a+1)/(u+2)?n=c*betinc(o,a,l,s):n=1-c*betinc(1-o,l,a,s),Math.round((1-n)*(1/s))/(1/s)}};function betinc(r,e,t,n){for(var s=0,o=1,a=1,l=1,u=0,c=0,h;Math.abs((a-c)/a)>n;)c=a,h=-(e+u)*(e+t+u)*r/(e+2*u)/(e+2*u+1),s=a+h*s,o=l+h*o,u=u+1,h=u*(t-u)*r/(e+2*u-1)/(e+2*u),a=s+h*a,l=o+h*l,s=s/l,o=o/l,a=a/l,l=1;return a/e}function combination(r,e){return r>170||e>170?Math.exp(combinationln(r,e)):factorial(r)/factorial(e)/factorial(r-e)}function combinationln(r,e){return factorialln(r)-factorialln(e)-factorialln(r-e)}function factorialln(r){return r<0?NaN:gammaln(r+1)}function factorial(r){return r<0?NaN:gammafn(r+1)}const chisquare={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-gammaln(t/2))},cdf:function(e,t){return e<0?0:lowRegGamma(t/2,e/2)},inv:function(r,e){return 2*gammapinv(r,.5*e)}},centralF={pdf:function(e,t,n){var s,o,a;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/betafn(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):(s=t*e/(n+e*t),o=n/(n+e*t),a=t*o/2,a*binomial.pdf((t-2)/2,(t+n-2)/2,s))},cdf:function(e,t,n){return e<0?0:ibeta(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/ibetainv(e,t/2,n/2)-1))}},weibull={pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}},poisson={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/factorial(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var s=0;n<=e;n++)s+=poisson.pdf(n,t);return s}},hypgeom={pdf:function(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>s||e>n)return 0;if(n*2>t)return s*2>t?hypgeom.pdf(t-n-s+e,t,t-n,t-s):hypgeom.pdf(s-e,t,t-n,s);if(s*2>t)return hypgeom.pdf(n-e,t,n,t-s);if(n<s)return hypgeom.pdf(e,t,s,n);for(var o=1,a=0,l=0;l<e;l++){for(;o>1&&a<s;)o*=1-n/(t-a),a++;o*=(s-l)*(n-l)/((l+1)*(t-n-s+l+1))}for(;a<s;a++)o*=1-n/(t-a);return Math.min(1,Math.max(0,o))},cdf:function r(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>=s||e>=n)return 1;if(n*2>t)return s*2>t?r(t-n-s+e,t,t-n,t-s):1-hypgeom.cdf(s-e-1,t,t-n,s);if(s*2>t)return 1-hypgeom.cdf(n-e-1,t,n,t-s);if(n<s)return hypgeom.cdf(e,t,s,n);for(var o=1,a=1,l=0,u=0;u<e;u++){for(;o>1&&l<s;){var c=1-n/(t-l);a*=c,o*=c,l++}a*=(s-u)*(n-u)/((u+1)*(t-n-s+u+1)),o+=a}for(;l<s;l++)o*=1-n/(t-l);return Math.min(1,Math.max(0,o))}},studentt={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*betafn(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var n=t/2;return ibeta((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},inv:function(r,e){var t=ibetainv(2*Math.min(r,1-r),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),r>.5?t:-t}},lognormal={pdf:function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*erf((Math.log(e)-t)/Math.sqrt(2*n*n))},inv:function(r,e,t){return Math.exp(-1.4142135623730951*t*erfcinv(2*r)+e)}},negbin={pdf:function(e,t,n){return e!==e>>>0?!1:e<0?0:combination(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t)},cdf:function(e,t,n){var s=0,o=0;if(e<0)return 0;for(;o<=e;o++)s+=negbin.pdf(o,t,n);return s}};function sum(r){for(var e=0,t=r.length;--t>=0;)e+=r[t];return e}function mean(r){return sum(r)/r.length}function sumsqerr(r){for(var e=mean(r),t=0,n=r.length,s;--n>=0;)s=r[n]-e,t+=s*s;return t}function variance(r,e){return sumsqerr(r)/(r.length-(e?1:0))}function stdev(r,e){return Math.sqrt(variance(r,e))}function normalci(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(normal.inv(r[1]/2,0,1)*r[2]/Math.sqrt(r[3])):t=Math.abs(normal.inv(r[1]/2,0,1)*stdev(r[2])/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function tci(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(studentt.inv(r[1]/2,r[3]-1)*r[2]/Math.sqrt(r[3])):t=Math.abs(studentt.inv(r[1]/2,r[2].length-1)*stdev(r[2],!0)/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function product(r){for(var e=1,t=r.length;--t>=0;)e*=r[t];return e}function geomean(r){return Math.pow(product(r),1/r.length)}function covariance(r,e){var t=mean(r),n=mean(e),s=r.length,o=new Array(s),a;for(a=0;a<s;a++)o[a]=(r[a]-t)*(e[a]-n);return sum(o)/(s-1)}function corrcoeff(r,e){return covariance(r,e)/stdev(r,1)/stdev(e,1)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class StatisticalPlugin extends FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(n,s)=>s===void 0?erf(n):erf(s)-erf(n))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(n,s,o)=>o?exponential.cdf(n,s):exponential.pdf(n,s))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(n,s,o,a)=>a?gamma.cdf(n,s,o):gamma.pdf(n,s,o))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),n=>normal.cdf(n,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(n,s,o,a,l,u)=>n<=l?new CellError(ErrorType.NUM,ErrorMessage.ValueSmall):n>=u?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(n=(n-l)/(u-l),a?beta.cdf(n,s,o):beta.pdf(n,s,o)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(n,s,o,a,l)=>a>=l?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):beta.inv(n,s,o)*(l-a)+a)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(n,s,o,a)=>n>s?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),a?binomial.cdf(n,s,o):binomial.pdf(n,s,o)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(n,s,o)=>{n=Math.trunc(n);let a=-1,l=n;for(;l>a+1;){const u=Math.trunc((a+l)/2);binomial.cdf(u,n,s)>=o?l=u:a=u}return l})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(n,s)=>besseli(n,Math.trunc(s)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(n,s)=>besselj(n,Math.trunc(s)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(n,s)=>besselk(n,Math.trunc(s)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(n,s)=>bessely(n,Math.trunc(s)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(n,s,o)=>(s=Math.trunc(s),o?chisquare.cdf(n,s):chisquare.pdf(n,s)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(n,s)=>1-chisquare.cdf(n,Math.trunc(s)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(n,s)=>chisquare.inv(n,Math.trunc(s)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(n,s)=>chisquare.inv(1-n,Math.trunc(s)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(n,s,o,a)=>(s=Math.trunc(s),o=Math.trunc(o),a?centralF.cdf(n,s,o):centralF.pdf(n,s,o)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(n,s,o)=>1-centralF.cdf(n,Math.trunc(s),Math.trunc(o)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(n,s,o)=>centralF.inv(n,Math.trunc(s),Math.trunc(o)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(n,s,o)=>centralF.inv(1-n,Math.trunc(s),Math.trunc(o)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(n,s,o,a)=>a?weibull.cdf(n,o,s):weibull.pdf(n,o,s))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(n,s,o)=>(n=Math.trunc(n),o?poisson.cdf(n,s):poisson.pdf(n,s)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(n,s,o,a,l)=>n>s||n>o||s>a||o>a?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):n+a<o+s?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):(n=Math.trunc(n),s=Math.trunc(s),o=Math.trunc(o),a=Math.trunc(a),l?hypgeom.cdf(n,a,o,s):hypgeom.pdf(n,a,o,s)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(n,s,o)=>(s=Math.trunc(s),o?studentt.cdf(n,s):studentt.pdf(n,s)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(n,s)=>(1-studentt.cdf(n,Math.trunc(s)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(n,s)=>1-studentt.cdf(n,Math.trunc(s)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(n,s,o)=>o*(1-studentt.cdf(n,Math.trunc(s))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(n,s)=>studentt.inv(n,Math.trunc(s)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(n,s)=>studentt.inv(1-n/2,Math.trunc(s)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(n,s,o,a)=>a?lognormal.cdf(n,s,o):lognormal.pdf(n,s,o))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(n,s,o)=>lognormal.inv(n,s,o))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(n,s,o,a)=>a?normal.cdf(n,s,o):normal.pdf(n,s,o))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(n,s,o)=>normal.inv(n,s,o))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(n,s)=>s?normal.cdf(n,0,1):normal.pdf(n,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),n=>normal.inv(n,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),n=>normal.pdf(n,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(n,s,o,a)=>(n=Math.trunc(n),s=Math.trunc(s),a?negbin.cdf(n,s,o):negbin.pdf(n,s,o)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(n,s,o)=>normalci(1,n,s,Math.trunc(o))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(n,s,o)=>(o=Math.trunc(o),o===1?new CellError(ErrorType.DIV_BY_ZERO):tci(1,n,s,o)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(n,s,o)=>(n-s)/o)}}StatisticalPlugin.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1},{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,greaterThan:0}]}};StatisticalPlugin.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MathPlugin extends FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),n=>{n=Math.trunc(n);let s=1;for(let o=1;o<=n;o++)s*=o;return s})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let s=1;for(let o=n;o>=1;o-=2)s*=o;return s})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(n,s)=>s>n?new CellError(ErrorType.NUM,ErrorMessage.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),combin(n,s)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(n,s)=>(n=Math.trunc(n),s=Math.trunc(s),n+s-1>=1030?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):n===0&&s===0?1:combin(n+s-1,s)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof CellError)return s;let o=0;for(const a of s){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);o=binaryGCD(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof CellError)return s;let o=1;for(const a of s){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);o=binaryLCM(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new CellError(ErrorType.NUM,ErrorMessage.ValueLarge):o})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(n,s)=>s===0?0:n>0&&s<0||n<0&&s>0?new CellError(ErrorType.NUM,ErrorMessage.DistinctSigns):Math.round(n/s)*s)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...n)=>{let s=0,o=1;for(let a of n){if(a<0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);a=Math.trunc(a);for(let l=1;l<=a;l++)o*=(s+l)/l;s+=a}return Math.round(o)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(n,s)=>s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.trunc(n/s))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(n,s,o,a)=>{const l=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(l instanceof CellError)return l;let u=0;l.reverse();for(const c of l)u*=Math.pow(n,o),u+=c;return u*Math.pow(n,s)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const h=o[c],g=a[c];if(h instanceof CellError)return h;if(g instanceof CellError)return g;typeof h=="number"&&typeof g=="number"&&(u+=Math.pow(h,2)-Math.pow(g,2))}return u})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const h=o[c],g=a[c];if(h instanceof CellError)return h;if(g instanceof CellError)return g;typeof h=="number"&&typeof g=="number"&&(u+=Math.pow(h,2)+Math.pow(g,2))}return u})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(n,s)=>{const o=n.valuesFromTopLeftCorner(),a=s.valuesFromTopLeftCorner();if(o.length!==a.length)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=o.length;let u=0;for(let c=0;c<l;c++){const h=o[c],g=a[c];if(h instanceof CellError)return h;if(g instanceof CellError)return g;typeof h=="number"&&typeof g=="number"&&(u+=Math.pow(h-g,2))}return u})}}MathPlugin.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:FunctionArgumentType.NUMBER,minValue:0},{argumentType:FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]}};function combin(r,e){2*e>r&&(e=r-e);let t=1;for(let n=1;n<=e;n++)t*=(r-e+n)/n;return Math.round(t)}function binaryGCD(r,e){for(r<e&&([r,e]=[e,r]);e>0;)[r,e]=[e,r%e];return r}function binaryLCM(r,e){return r===0||e===0?0:r*(e/binaryGCD(r,e))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ComplexPlugin extends FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(n,s,o)=>o!=="i"&&o!=="j"?new CellError(ErrorType.VALUE,ErrorMessage.ShouldBeIorJ):coerceComplexToString([n,s],o))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),abs)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([n,s])=>s)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([n,s])=>n)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([n,s])=>n===0&&s===0?new CellError(ErrorType.DIV_BY_ZERO):Math.atan2(s,n))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([n,s])=>coerceComplexToString([n,-s]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),n=>coerceComplexToString(cos(n)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),n=>coerceComplexToString(cosh(n)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),n=>coerceComplexToString(div(cos(n),sin(n))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),n=>coerceComplexToString(div([1,0],sin(n))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),n=>coerceComplexToString(div([1,0],sinh(n))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),n=>coerceComplexToString(div([1,0],cos(n))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),n=>coerceComplexToString(div([1,0],cosh(n))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),n=>coerceComplexToString(sin(n)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),n=>coerceComplexToString(sinh(n)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),n=>coerceComplexToString(div(sin(n),cos(n))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(n,s)=>coerceComplexToString(div(n,s)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof CellError)return s;let o=[1,0];for(const a of s)o=mul(o,a);return coerceComplexToString(o)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof CellError)return s;let o=[0,0];for(const a of s)o=add(o,a);return coerceComplexToString(o)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(n,s)=>coerceComplexToString(sub(n,s)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),n=>coerceComplexToString(exp(n)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),n=>coerceComplexToString(ln(n)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),n=>{const[s,o]=ln(n),a=Math.log(10);return coerceComplexToString([s/a,o/a])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),n=>{const[s,o]=ln(n),a=Math.log(2);return coerceComplexToString([s/a,o/a])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(n,s)=>coerceComplexToString(power(n,s)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),n=>coerceComplexToString(power(n,.5)))}}ComplexPlugin.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:FunctionArgumentType.COMPLEX},{argumentType:FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:FunctionArgumentType.COMPLEX}]}};function add([r,e],[t,n]){return[r+t,e+n]}function sub([r,e],[t,n]){return[r-t,e-n]}function mul([r,e],[t,n]){return[r*t-e*n,r*n+t*e]}function div([r,e],[t,n]){const s=Math.pow(t,2)+Math.pow(n,2),[o,a]=mul([r,e],[t,-n]);return[o/s,a/s]}function cos([r,e]){return[Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e)]}function cosh([r,e]){return[Math.cosh(r)*Math.cos(e),Math.sinh(r)*Math.sin(e)]}function sin([r,e]){return[Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e)]}function sinh([r,e]){return[Math.sinh(r)*Math.cos(e),Math.cosh(r)*Math.sin(e)]}function exp([r,e]){return[Math.exp(r)*Math.cos(e),Math.exp(r)*Math.sin(e)]}function abs([r,e]){return Math.sqrt(r*r+e*e)}function ln([r,e]){return[Math.log(abs([r,e])),Math.atan2(e,r)]}function power(r,e){const[t,n]=ln(r);return exp([e*t,e*n])}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class StatisticalAggregationPlugin extends FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.DIV_BY_ZERO);const o=mean(s);return s.reduce((a,l)=>a+Math.abs(l-o),0)/s.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof CellError?s:s.length===0?0:sumsqerr(s)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.NUM,ErrorMessage.OneValue);for(const o of s)if(o<=0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);return geomean(s)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;if(s.length===0)return new CellError(ErrorType.NUM,ErrorMessage.OneValue);for(const o of s)if(o<=0)return new CellError(ErrorType.NUM,ErrorMessage.ValueSmall);return s.length/s.reduce((o,a)=>o+1/a,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):corrcoeff(o[0],o[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):Math.pow(corrcoeff(o[0],o[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.OneValue):a===1?0:covariance(o[0],o[1])*(a-1)/a})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);return o instanceof CellError?o:o[0].length<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):covariance(o[0],o[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(n,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof CellError)return a;const l=a.length;if(o===void 0){if(l<2)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);o=stdev(a,!0)}return l<1?new CellError(ErrorType.NA,ErrorMessage.OneValue):o===0?new CellError(ErrorType.DIV_BY_ZERO):1-normal.cdf((mean(a)-s)/(o/Math.sqrt(l)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(n,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(o instanceof CellError)return o;if(a instanceof CellError)return a;if(o.length<=1||a.length<=1)return new CellError(ErrorType.DIV_BY_ZERO);const l=variance(o,!0),u=variance(a,!0);if(l===0||u===0)return new CellError(ErrorType.DIV_BY_ZERO);const c=l/u,h=centralF.cdf(c,o.length-1,a.length-1);return 2*Math.min(h,1-h)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<=2?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues):Math.sqrt((sumsqerr(o[0])-Math.pow(covariance(o[0],o[1])*(a-1),2)/sumsqerr(o[1]))/(a-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const o=parseTwoArrays(n,s);if(o instanceof CellError)return o;const a=o[0].length;return a<=1?new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues):covariance(o[0],o[1])*(a-1)/sumsqerr(o[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(n,s)=>{const o=n.height(),a=n.width();if(s.height()!==o||s.width()!==a)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);const l=parseTwoArrays(n,s);if(l instanceof CellError)return l;if(l[0].length<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);let u=0;for(let c=0;c<l[0].length;c++){if(l[1][c]===0)return new CellError(ErrorType.DIV_BY_ZERO);u+=Math.pow(l[0][c]-l[1][c],2)/l[1][c]}return u<0?new CellError(ErrorType.NUM,ErrorMessage.NaN):1-chisquare.cdf(u,o>1&&a>1?(o-1)*(a-1):o*a-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(n,s,o,a)=>{const l=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),u=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(l instanceof CellError)return l;if(u instanceof CellError)return u;const c=l.length,h=u.length;if(a===1){if(h!==c)return new CellError(ErrorType.NA,ErrorMessage.EqualLength);if(c<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const g=Array(c);for(let E=0;E<c;E++)g[E]=l[E]-u[E];const v=stdev(g,!0);if(v===0)return new CellError(ErrorType.DIV_BY_ZERO);const m=Math.abs(Math.sqrt(c)*mean(g)/v);return o*(1-studentt.cdf(m,c-1))}else if(a===2){if(c<=1||h<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const g=(sumsqerr(l)+sumsqerr(u))/(c+h-2);if(g===0)return new CellError(ErrorType.DIV_BY_ZERO);const v=Math.abs((mean(l)-mean(u))/Math.sqrt(g*(1/c+1/h)));return o*(1-studentt.cdf(v,c+h-2))}else{if(c<=1||h<=1)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.TwoValues);const g=variance(l,!0),v=variance(u,!0);if(g===0&&v===0)return new CellError(ErrorType.DIV_BY_ZERO);const m=Math.abs((mean(l)-mean(u))/Math.sqrt(g/c+v/h)),E=Math.pow(g/c+v/h,2)/(Math.pow(g/c,2)/(c-1)+Math.pow(v/h,2)/(h-1));return o*(1-studentt.cdf(m,E))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;const o=s.length;if(o<3)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues);const a=mean(s),l=stdev(s,!0);return l===0?new CellError(ErrorType.DIV_BY_ZERO):s.reduce((u,c)=>u+Math.pow((c-a)/l,3),0)*o/(o-1)/(o-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof CellError)return s;const o=s.length;if(o<3)return new CellError(ErrorType.DIV_BY_ZERO,ErrorMessage.ThreeValues);const a=mean(s),l=stdev(s,!1);return l===0?new CellError(ErrorType.DIV_BY_ZERO):s.reduce((u,c)=>u+Math.pow((c-a)/l,3),0)/o})}}StatisticalAggregationPlugin.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.NUMBER},{argumentType:FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.RANGE},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:FunctionArgumentType.ANY}],repeatLastArgs:1}};StatisticalAggregationPlugin.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function parseTwoArrays(r,e){const t=r.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let s,o;const a=[],l=[];for(;s=t.next(),o=n.next(),!s.done&&!o.done;){const u=s.value,c=o.value;if(u instanceof CellError)return u;if(c instanceof CellError)return c;isExtendedNumber(u)&&isExtendedNumber(c)&&(a.push(getRawValue(u)),l.push(getRawValue(c)))}return[a,l]}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const plugins=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin,AddressPlugin,ArrayPlugin,BitShiftPlugin,BitwiseLogicOperationsPlugin,BooleanPlugin,CharPlugin,CodePlugin,ComplexPlugin,ConditionalAggregationPlugin,CountBlankPlugin,CountUniquePlugin,DateTimePlugin,DegreesPlugin,DeltaPlugin,ExpPlugin,FinancialPlugin,FormulaTextPlugin,HyperlinkPlugin,InformationPlugin,IsEvenPlugin,IsOddPlugin,LogarithmPlugin,LookupPlugin,MathConstantsPlugin,MathPlugin,MatrixPlugin,MedianPlugin,ModuloPlugin,NumericAggregationPlugin,PowerPlugin,RadiansPlugin,RadixConversionPlugin,RandomPlugin,RomanPlugin,RoundingPlugin,SimpleArithmerticPlugin,SqrtPlugin,StatisticalAggregationPlugin,StatisticalPlugin,SumprodPlugin,TextPlugin,TrigonometryPlugin},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HyperFormulaNS extends HyperFormula{}HyperFormulaNS.HyperFormula=HyperFormula;HyperFormulaNS.ErrorType=ErrorType;HyperFormulaNS.CellError=CellError;HyperFormulaNS.CellType=CellType;HyperFormulaNS.CellValueType=CellValueType;HyperFormulaNS.CellValueDetailedType=CellValueDetailedType;HyperFormulaNS.DetailedCellError=DetailedCellError;HyperFormulaNS.ExportedCellChange=ExportedCellChange;HyperFormulaNS.ExportedNamedExpressionChange=ExportedNamedExpressionChange;HyperFormulaNS.ConfigValueTooBigError=ConfigValueTooBigError;HyperFormulaNS.ConfigValueTooSmallError=ConfigValueTooSmallError;HyperFormulaNS.EvaluationSuspendedError=EvaluationSuspendedError;HyperFormulaNS.ExpectedOneOfValuesError=ExpectedOneOfValuesError;HyperFormulaNS.ExpectedValueOfTypeError=ExpectedValueOfTypeError;HyperFormulaNS.ArraySize=ArraySize;HyperFormulaNS.SimpleRangeValue=SimpleRangeValue;HyperFormulaNS.EmptyValue=EmptyValue;HyperFormulaNS.FunctionPlugin=FunctionPlugin;HyperFormulaNS.FunctionArgumentType=FunctionArgumentType;HyperFormulaNS.FunctionPluginValidationError=FunctionPluginValidationError;HyperFormulaNS.InvalidAddressError=InvalidAddressError;HyperFormulaNS.InvalidArgumentsError=InvalidArgumentsError;HyperFormulaNS.LanguageNotRegisteredError=LanguageNotRegisteredError;HyperFormulaNS.LanguageAlreadyRegisteredError=LanguageAlreadyRegisteredError;HyperFormulaNS.MissingTranslationError=MissingTranslationError;HyperFormulaNS.NamedExpressionDoesNotExistError=NamedExpressionDoesNotExistError;HyperFormulaNS.NamedExpressionNameIsAlreadyTakenError=NamedExpressionNameIsAlreadyTakenError;HyperFormulaNS.NamedExpressionNameIsInvalidError=NamedExpressionNameIsInvalidError;HyperFormulaNS.NoOperationToRedoError=NoOperationToRedoError;HyperFormulaNS.NoOperationToUndoError=NoOperationToUndoError;HyperFormulaNS.NoRelativeAddressesAllowedError=NoRelativeAddressesAllowedError;HyperFormulaNS.NoSheetWithIdError=NoSheetWithIdError;HyperFormulaNS.NoSheetWithNameError=NoSheetWithNameError;HyperFormulaNS.NotAFormulaError=NotAFormulaError;HyperFormulaNS.NothingToPasteError=NothingToPasteError;HyperFormulaNS.ProtectedFunctionTranslationError=ProtectedFunctionTranslationError;HyperFormulaNS.SheetNameAlreadyTakenError=SheetNameAlreadyTakenError;HyperFormulaNS.SheetSizeLimitExceededError=SheetSizeLimitExceededError;HyperFormulaNS.SourceLocationHasArrayError=SourceLocationHasArrayError;HyperFormulaNS.TargetLocationHasArrayError=TargetLocationHasArrayError;HyperFormulaNS.UnableToParseError=UnableToParseError;const defaultLanguage=Config.defaultConfig.language;HyperFormula.registerLanguage(defaultLanguage,dictionary);HyperFormula.languages[dictionary.langCode]=dictionary;for(const r of Object.getOwnPropertyNames(plugins))r.startsWith("_")||HyperFormula.registerFunctionPlugin(plugins[r]);function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$3={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(r,e){(function(t,n){r.exports=n()})(jsuites,function(){var t;return function(){var n={195:function(l){(function(u,c){l.exports=c()})(this,function(){return function(ue){function c(He,be){this.highOrder=He,this.lowOrder=be}var h=[new c(1779033703,4089235720),new c(3144134277,2227873595),new c(1013904242,4271175723),new c(2773480762,1595750129),new c(1359893119,2917565137),new c(2600822924,725511199),new c(528734635,4215389547),new c(1541459225,327033209)],g=[new c(1116352408,3609767458),new c(1899447441,602891725),new c(3049323471,3964484399),new c(3921009573,2173295548),new c(961987163,4081628472),new c(1508970993,3053834265),new c(2453635748,2937671579),new c(2870763221,3664609560),new c(3624381080,2734883394),new c(310598401,1164996542),new c(607225278,1323610764),new c(1426881987,3590304994),new c(1925078388,4068182383),new c(2162078206,991336113),new c(2614888103,633803317),new c(3248222580,3479774868),new c(3835390401,2666613458),new c(4022224774,944711139),new c(264347078,2341262773),new c(604807628,2007800933),new c(770255983,1495990901),new c(1249150122,1856431235),new c(1555081692,3175218132),new c(1996064986,2198950837),new c(2554220882,3999719339),new c(2821834349,766784016),new c(2952996808,2566594879),new c(3210313671,3203337956),new c(3336571891,1034457026),new c(3584528711,2466948901),new c(113926993,3758326383),new c(338241895,168717936),new c(666307205,1188179964),new c(773529912,1546045734),new c(1294757372,1522805485),new c(1396182291,2643833823),new c(1695183700,2343527390),new c(1986661051,1014477480),new c(2177026350,1206759142),new c(2456956037,344077627),new c(2730485921,1290863460),new c(2820302411,3158454273),new c(3259730800,3505952657),new c(3345764771,106217008),new c(3516065817,3606008344),new c(3600352804,1432725776),new c(4094571909,1467031594),new c(275423344,851169720),new c(430227734,3100823752),new c(506948616,1363258195),new c(659060556,3750685593),new c(883997877,3785050280),new c(958139571,3318307427),new c(1322822218,3812723403),new c(1537002063,2003034995),new c(1747873779,3602036899),new c(1955562222,1575990012),new c(2024104815,1125592928),new c(2227730452,2716904306),new c(2361852424,442776044),new c(2428436474,593698344),new c(2756734187,3733110249),new c(3204031479,2999351573),new c(3329325298,3815920427),new c(3391569614,3928383900),new c(3515267271,566280711),new c(3940187606,3454069534),new c(4118630271,4000239992),new c(116418474,1914138554),new c(174292421,2731055270),new c(289380356,3203993006),new c(460393269,320620315),new c(685471733,587496836),new c(852142971,1086792851),new c(1017036298,365543100),new c(1126000580,2618297676),new c(1288033470,3409855158),new c(1501505948,4234509866),new c(1607167915,987167468),new c(1816402316,1246189591)],v=new Array(64),m,E,_,S,w,A,O,D,Y,H,k,K,se=8;function re(He){return unescape(encodeURIComponent(He))}function Ce(He){for(var be=[],qe=(1<<se)-1,le=He.length*se,pe=0;pe<le;pe+=se)be[pe>>5]|=(He.charCodeAt(pe/se)&qe)<<32-se-pe%32;return be}function Le(He){for(var be="0123456789abcdef",qe="",le=He.length*4,pe,Se=0;Se<le;Se+=1)pe=He[Se>>2]>>(3-Se%4)*8,qe+=be.charAt(pe>>4&15)+be.charAt(pe&15);return qe}function he(He,be){var qe,le,pe,Se;return qe=(He.lowOrder&65535)+(be.lowOrder&65535),le=(He.lowOrder>>>16)+(be.lowOrder>>>16)+(qe>>>16),pe=(le&65535)<<16|qe&65535,qe=(He.highOrder&65535)+(be.highOrder&65535)+(le>>>16),le=(He.highOrder>>>16)+(be.highOrder>>>16)+(qe>>>16),Se=(le&65535)<<16|qe&65535,new c(Se,pe)}function ve(He,be,qe,le){var pe,Se,Ye,Fe;return pe=(He.lowOrder&65535)+(be.lowOrder&65535)+(qe.lowOrder&65535)+(le.lowOrder&65535),Se=(He.lowOrder>>>16)+(be.lowOrder>>>16)+(qe.lowOrder>>>16)+(le.lowOrder>>>16)+(pe>>>16),Ye=(Se&65535)<<16|pe&65535,pe=(He.highOrder&65535)+(be.highOrder&65535)+(qe.highOrder&65535)+(le.highOrder&65535)+(Se>>>16),Se=(He.highOrder>>>16)+(be.highOrder>>>16)+(qe.highOrder>>>16)+(le.highOrder>>>16)+(pe>>>16),Fe=(Se&65535)<<16|pe&65535,new c(Fe,Ye)}function xe(He,be,qe,le,pe){var Se,Ye,Fe,je;return Se=(He.lowOrder&65535)+(be.lowOrder&65535)+(qe.lowOrder&65535)+(le.lowOrder&65535)+(pe.lowOrder&65535),Ye=(He.lowOrder>>>16)+(be.lowOrder>>>16)+(qe.lowOrder>>>16)+(le.lowOrder>>>16)+(pe.lowOrder>>>16)+(Se>>>16),Fe=(Ye&65535)<<16|Se&65535,Se=(He.highOrder&65535)+(be.highOrder&65535)+(qe.highOrder&65535)+(le.highOrder&65535)+(pe.highOrder&65535)+(Ye>>>16),Ye=(He.highOrder>>>16)+(be.highOrder>>>16)+(qe.highOrder>>>16)+(le.highOrder>>>16)+(pe.highOrder>>>16)+(Se>>>16),je=(Ye&65535)<<16|Se&65535,new c(je,Fe)}function Ie(He,be,qe){return new c(He.highOrder&be.highOrder^He.highOrder&qe.highOrder^be.highOrder&qe.highOrder,He.lowOrder&be.lowOrder^He.lowOrder&qe.lowOrder^be.lowOrder&qe.lowOrder)}function we(He,be,qe){return new c(He.highOrder&be.highOrder^~He.highOrder&qe.highOrder,He.lowOrder&be.lowOrder^~He.lowOrder&qe.lowOrder)}function Ne(He,be){return be<=32?new c(He.highOrder>>>be|He.lowOrder<<32-be,He.lowOrder>>>be|He.highOrder<<32-be):new c(He.lowOrder>>>be|He.highOrder<<32-be,He.highOrder>>>be|He.lowOrder<<32-be)}function at(He){var be=Ne(He,28),qe=Ne(He,34),le=Ne(He,39);return new c(be.highOrder^qe.highOrder^le.highOrder,be.lowOrder^qe.lowOrder^le.lowOrder)}function nt(He){var be=Ne(He,14),qe=Ne(He,18),le=Ne(He,41);return new c(be.highOrder^qe.highOrder^le.highOrder,be.lowOrder^qe.lowOrder^le.lowOrder)}function B(He){var be=Ne(He,1),qe=Ne(He,8),le=V(He,7);return new c(be.highOrder^qe.highOrder^le.highOrder,be.lowOrder^qe.lowOrder^le.lowOrder)}function te(He){var be=Ne(He,19),qe=Ne(He,61),le=V(He,6);return new c(be.highOrder^qe.highOrder^le.highOrder,be.lowOrder^qe.lowOrder^le.lowOrder)}function V(He,be){return be<=32?new c(He.highOrder>>>be,He.lowOrder>>>be|He.highOrder<<32-be):new c(0,He.highOrder<<32-be)}var ue=re(ue),Ae=ue.length*se;ue=Ce(ue),ue[Ae>>5]|=128<<24-Ae%32,ue[(Ae+128>>10<<5)+31]=Ae;for(var Y=0;Y<ue.length;Y+=32){m=h[0],E=h[1],_=h[2],S=h[3],w=h[4],A=h[5],O=h[6],D=h[7];for(var H=0;H<80;H++)H<16?v[H]=new c(ue[H*2+Y],ue[H*2+Y+1]):v[H]=ve(te(v[H-2]),v[H-7],B(v[H-15]),v[H-16]),k=xe(D,nt(w),we(w,A,O),g[H],v[H]),K=he(at(m),Ie(m,E,_)),D=O,O=A,A=w,w=he(S,k),S=_,_=E,E=m,m=he(k,K);h[0]=he(m,h[0]),h[1]=he(E,h[1]),h[2]=he(_,h[2]),h[3]=he(S,h[3]),h[4]=he(w,h[4]),h[5]=he(A,h[5]),h[6]=he(O,h[6]),h[7]=he(D,h[7])}for(var Ve=[],Y=0;Y<h.length;Y++)Ve.push(h[Y].highOrder),Ve.push(h[Y].lowOrder);return Le(Ve)}})}},s={};function o(l){var u=s[l];if(u!==void 0)return u.exports;var c=s[l]={exports:{}};return n[l].call(c.exports,c,c.exports,o),c.exports}(function(){o.n=function(l){var u=l&&l.__esModule?function(){return l.default}:function(){return l};return o.d(u,{a:u}),u}})(),function(){o.d=function(l,u){for(var c in u)o.o(u,c)&&!o.o(l,c)&&Object.defineProperty(l,c,{enumerable:!0,get:u[c]})}}(),function(){o.o=function(l,u){return Object.prototype.hasOwnProperty.call(l,u)}}();var a={};(function(){o.d(a,{default:function(){return At}});var l=function(j){document.dictionary||(document.dictionary={});var X=null,P=Object.keys(j);for(X=0;X<P.length;X++)document.dictionary[P[X]]=j[P[X]]},u=function(j){return typeof document<"u"&&document.dictionary&&document.dictionary[j]||j},c={setDictionary:l,translate:u},g=function(j,X){if(X===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(R){return R!==null}),setTimeout(function(){window.jSuitesStateControl.push(j)},0);else{var P=window.jSuitesStateControl.indexOf(j);P>=0&&window.jSuitesStateControl.splice(P,1)}},v={};v.two=function(j){return j=""+j,j.length==1&&(j="0"+j),j},v.focus=function(j){if(j.innerText.length){var X=document.createRange(),P=window.getSelection(),R=j.childNodes[j.childNodes.length-1];X.setStart(R,R.length),X.collapse(!0),P.removeAllRanges(),P.addRange(X),j.scrollLeft=j.scrollWidth}},v.isNumeric=function(j){return typeof j=="string"&&(j=j.trim()),!isNaN(j)&&j!==null&&j!==""},v.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(j){var X=Math.random()*16|0,P=j=="x"?X:X&3|8;return P.toString(16)})},v.getNode=function(){var j=document.getSelection().anchorNode;return j?j.nodeType==3?j.parentNode:j:null},v.hash=function(j){var X=0,P,R;if(j.length===0)return X;for(P=0;P<j.length;P++)R=j.charCodeAt(P),R>32&&(X=(X<<5)-X+R,X|=0);return X},v.randomColor=function(j){var X=-.25,P=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");P.length<6&&(P=P[0]+P[0]+P[1]+P[1]+P[2]+P[2]);var R=[],ae,Pe;for(Pe=0;Pe<3;Pe++)ae=parseInt(P.substr(Pe*2,2),16),ae=Math.round(Math.min(Math.max(0,ae+ae*X),255)).toString(16),R.push(("00"+ae).substr(ae.length));return j==!0?"#"+v.two(R[0].toString(16))+v.two(R[1].toString(16))+v.two(R[2].toString(16)):R},v.getWindowWidth=function(){var j=window,X=document,P=X.documentElement,R=X.getElementsByTagName("body")[0],ae=j.innerWidth||P.clientWidth||R.clientWidth;return ae},v.getWindowHeight=function(){var j=window,X=document,P=X.documentElement,R=X.getElementsByTagName("body")[0],ae=j.innerHeight||P.clientHeight||R.clientHeight;return ae},v.getPosition=function(j){if(j.changedTouches&&j.changedTouches[0])var X=j.changedTouches[0].pageX,P=j.changedTouches[0].pageY;else var X=window.Event?j.pageX:j.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),P=window.Event?j.pageY:j.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[X,P]},v.click=function(j){if(j.click)j.click();else{var X=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});j.dispatchEvent(X)}},v.findElement=function(j,X){var P=!1;function R(ae){ae&&!P&&(typeof X=="function"?P=X(ae):typeof X=="string"&&ae.classList&&ae.classList.contains(X)&&(P=ae)),ae.parentNode&&!P&&R(ae.parentNode)}return R(j),P};var m=v;function E(j,X,P){if(j=j.split("."),j.length){let R=this,ae=null;for(;j.length>1;)if(ae=j.shift(),R.hasOwnProperty(ae))R=R[ae];else{if(typeof X>"u")return;R[ae]={},R=R[ae]}if(ae=j.shift(),typeof X<"u")return P===!0?delete R[ae]:R[ae]=X,!0;if(R)return R[ae]}return!1}function _(j,X){var P={};P.options={};var R={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},ae=null;for(var Pe in R)X&&X.hasOwnProperty(Pe)?P.options[Pe]=X[Pe]:P.options[Pe]=R[Pe];j.classList.add("jsorting"),j.addEventListener("dragstart",function(ee){let fe=ee.target;if(fe.nodeType===3)if(fe.parentNode.getAttribute("draggable")==="true")fe=fe.parentNode;else{ee.preventDefault(),ee.stopPropagation();return}if(fe.getAttribute("draggable")==="true"){let Re=Array.prototype.indexOf.call(fe.parentNode.children,fe);ae={element:fe,o:Re,d:Re},fe.style.opacity="0.25",typeof P.options.ondragstart=="function"&&P.options.ondragstart(j,fe,ee),ee.dataTransfer.setDragImage(fe,0,0)}}),j.addEventListener("dragover",function(ee){if(ee.preventDefault(),ae&&Oe(ee.target)&&ee.target.getAttribute("draggable")=="true"&&ae.element!=ee.target){if(P.options.direction)var fe=ee.target.clientWidth/2>ee.offsetX;else var fe=ee.target.clientHeight/2>ee.offsetY;fe?ee.target.parentNode.insertBefore(ae.element,ee.target):ee.target.parentNode.insertBefore(ae.element,ee.target.nextSibling),ae.d=Array.prototype.indexOf.call(ee.target.parentNode.children,ae.element)}}),j.addEventListener("dragleave",function(ee){ee.preventDefault()}),j.addEventListener("dragend",function(ee){ee.preventDefault(),ae&&(typeof P.options.ondragend=="function"&&P.options.ondragend(j,ae.element,ee),ae.o<ae.d?ee.target.parentNode.insertBefore(ae.element,ee.target.parentNode.children[ae.o]):ee.target.parentNode.insertBefore(ae.element,ee.target.parentNode.children[ae.o].nextSibling),ae.element.style.opacity="",ae=null)}),j.addEventListener("drop",function(ee){ee.preventDefault(),ae&&(ae.o!==ae.d&&typeof P.options.ondrop=="function"&&P.options.ondrop(j,ae.o,ae.d,ae.element,ee.target,ee),ae.element.style.opacity="",ae=null)});for(var Oe=function(ee){var fe=!1;function Re($e){$e.className&&$e.classList.contains("jsorting")&&(fe=!0),fe||Re($e.parentNode)}return Re(ee),fe},oe=0;oe<j.children.length;oe++)j.children[oe].hasAttribute("draggable")||j.children[oe].setAttribute("draggable","true");return j.val=function(){for(var ee=null,fe=[],Re=0;Re<j.children.length;Re++)(ee=j.children[Re].getAttribute("data-id"))&&fe.push(ee);return fe},j}function S(j,X){var P={};(!X.loadUp||typeof X.loadUp!="function")&&(X.loadUp=function(){return!1}),(!X.loadDown||typeof X.loadDown!="function")&&(X.loadDown=function(){return!1}),X.timer||(X.timer=100);var R=null,ae=function(Pe){if(R==null){var Oe=!1,oe=j.scrollTop;j.scrollTop+j.clientHeight*2>=j.scrollHeight?X.loadDown()&&(oe==j.scrollTop&&(j.scrollTop=j.scrollTop-j.clientHeight),Oe=!0):j.scrollTop<=j.clientHeight&&X.loadUp()&&(oe==j.scrollTop&&(j.scrollTop=j.scrollTop+j.clientHeight),Oe=!0),R=setTimeout(function(){R=null},X.timer),Oe&&typeof X.onupdate=="function"&&X.onupdate()}};return j.onscroll=function(Pe){ae()},j.onwheel=function(Pe){ae()},P}function w(){var j=function(X,P){if(Array.isArray(X)){var R={instance:[],complete:P};if(X.length>0)for(var ae=0;ae<X.length;ae++)X[ae].multiple=R,R.instance.push(j(X[ae]));return R}if(X.data||(X.data={}),X.type&&(X.method=X.type),X.method||(X.method="GET"),X.dataType||(X.dataType="json"),X.data){var Pe=function($e,Je){var Be=[];if($e){var ot=Object.keys($e);if(ot.length)for(var gt=0;gt<ot.length;gt++){if(Je)var b=Je+"["+ot[gt]+"]";else var b=ot[gt];if($e[b]instanceof FileList)Be[b]=$e[ot[gt]];else if($e[ot[gt]]===null||$e[ot[gt]]===void 0)Be[b]="";else if(typeof $e[ot[gt]]=="object")for(var q=Pe($e[ot[gt]],b),F=Object.keys(q),W=0;W<F.length;W++)Be[F[W]]=q[F[W]];else Be[b]=$e[ot[gt]]}}return Be},Oe=Pe(X.data),oe=Object.keys(Oe);if(X.method=="GET"){if(oe.length){for(var ee=[],ae=0;ae<oe.length;ae++)ee.push(oe[ae]+"="+encodeURIComponent(Oe[oe[ae]]));X.url.indexOf("?")<0&&(X.url+="?"),X.url+=ee.join("&")}}else for(var ee=new FormData,ae=0;ae<oe.length;ae++)if(Oe[oe[ae]]instanceof FileList){if(Oe[oe[ae]].length)for(var fe=0;fe<Oe[oe[ae]].length;fe++)ee.append(oe[ae],Oe[oe[ae]][fe],Oe[oe[ae]][fe].name)}else ee.append(oe[ae],Oe[oe[ae]])}var Re=new XMLHttpRequest;return Re.open(X.method,X.url,!0),X.requestedWith?Re.setRequestHeader("X-Requested-With",X.requestedWith):X.requestedWith!==!1&&Re.setRequestHeader("X-Requested-With","XMLHttpRequest"),X.contentType&&Re.setRequestHeader("Content-Type",X.contentType),X.method==="POST"?Re.setRequestHeader("Accept","application/json"):X.dataType==="blob"?Re.responseType="blob":X.contentType||(X.dataType==="json"?Re.setRequestHeader("Content-Type","text/json"):X.dataType==="html"&&Re.setRequestHeader("Content-Type","text/html")),X.cache!==!0&&(Re.setRequestHeader("pragma","no-cache"),Re.setRequestHeader("cache-control","no-cache")),X.withCredentials===!0&&(Re.withCredentials=!0),typeof X.beforeSend=="function"&&X.beforeSend(Re),typeof j.beforeSend=="function"&&j.beforeSend(Re),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(Re),Re.onerror=function(){X.error&&typeof X.error=="function"&&X.error({message:"Network error: Unable to reach the server.",status:0})},Re.ontimeout=function(){X.error&&typeof X.error=="function"&&X.error({message:"Request timed out after "+Re.timeout+"ms.",status:0})},Re.onload=function(){if(Re.status>=200&&Re.status<300)if(X.dataType==="json")try{var $e=JSON.parse(Re.responseText);X.success&&typeof X.success=="function"&&X.success($e)}catch(Be){X.error&&typeof X.error=="function"&&X.error(Be,$e)}else{if(X.dataType==="blob")var $e=Re.response;else var $e=Re.responseText;X.success&&typeof X.success=="function"&&X.success($e)}else X.error&&typeof X.error=="function"&&X.error(Re.responseText,Re.status);if(j.queue&&j.queue.length>0&&j.send(j.queue.shift()),j.requests&&j.requests.length){var Je=j.requests.indexOf(Re);if(j.requests.splice(Je,1),j.requests.length||X.complete&&typeof X.complete=="function"&&X.complete($e),X.group&&j.oncomplete&&typeof j.oncomplete[X.group]=="function"&&(j.pending(X.group)||(j.oncomplete[X.group](),j.oncomplete[X.group]=null)),X.multiple&&X.multiple.instance){var Je=X.multiple.instance.indexOf(Re);X.multiple.instance.splice(Je,1),X.multiple.instance.length||X.multiple.complete&&typeof X.multiple.complete=="function"&&X.multiple.complete($e)}}},Re.options=X,Re.data=ee,X.queue===!0&&j.requests.length>0?j.queue.push(Re):j.send(Re),Re};return j.send=function(X){X.data?Array.isArray(X.data)?X.send(X.data.join("&")):X.send(X.data):X.send(),j.requests.push(X)},j.exists=function(X,P){var R=new XMLHttpRequest;R.open("HEAD",X,!1),R.send(),R.status&&P(R.status)},j.pending=function(X){var P=0,R=j.requests;if(R&&R.length)for(var ae=0;ae<R.length;ae++)(!X||X==R[ae].options.group)&&P++;return P},j.oncomplete={},j.requests=[],j.queue=[],j}var A=w();function O(){const j={loading:{}};return j.loading.show=function(X){j.loading.element||(j.loading.element=document.createElement("div"),j.loading.element.className="jloading"),document.body.appendChild(j.loading.element),X>0&&setTimeout(function(){j.loading.hide()},X*1e3)},j.loading.hide=function(){j.loading.element&&j.loading.element.parentNode&&document.body.removeChild(j.loading.element)},j.slideLeft=function(X,P,R){P==!0?(X.classList.add("jslide-left-in"),setTimeout(function(){X.classList.remove("jslide-left-in"),typeof R=="function"&&R()},400)):(X.classList.add("jslide-left-out"),setTimeout(function(){X.classList.remove("jslide-left-out"),typeof R=="function"&&R()},400))},j.slideRight=function(X,P,R){P===!0?(X.classList.add("jslide-right-in"),setTimeout(function(){X.classList.remove("jslide-right-in"),typeof R=="function"&&R()},400)):(X.classList.add("jslide-right-out"),setTimeout(function(){X.classList.remove("jslide-right-out"),typeof R=="function"&&R()},400))},j.slideTop=function(X,P,R){P===!0?(X.classList.add("jslide-top-in"),setTimeout(function(){X.classList.remove("jslide-top-in"),typeof R=="function"&&R()},400)):(X.classList.add("jslide-top-out"),setTimeout(function(){X.classList.remove("jslide-top-out"),typeof R=="function"&&R()},400))},j.slideBottom=function(X,P,R){P===!0?(X.classList.add("jslide-bottom-in"),setTimeout(function(){X.classList.remove("jslide-bottom-in"),typeof R=="function"&&R()},400)):(X.classList.add("jslide-bottom-out"),setTimeout(function(){X.classList.remove("jslide-bottom-out"),typeof R=="function"&&R()},100))},j.fadeIn=function(X,P){X.style.display="",X.classList.add("jfade-in"),setTimeout(function(){X.classList.remove("jfade-in"),typeof P=="function"&&P()},2e3)},j.fadeOut=function(X,P){X.classList.add("jfade-out"),setTimeout(function(){X.style.display="none",X.classList.remove("jfade-out"),typeof P=="function"&&P()},1e3)},j}var D=O();function Y(){var j={};j.now=function(Oe,oe){var ee=null,fe=null,Re=null,$e=null,Je=null,Be=null;return Array.isArray(Oe)?(ee=Oe[0],fe=Oe[1],Re=Oe[2],$e=Oe[3],Je=Oe[4],Be=Oe[5]):(Oe||(Oe=new Date),ee=Oe.getFullYear(),fe=Oe.getMonth()+1,Re=Oe.getDate(),$e=Oe.getHours(),Je=Oe.getMinutes(),Be=Oe.getSeconds()),oe==!0?m.two(ee)+"-"+m.two(fe)+"-"+m.two(Re):m.two(ee)+"-"+m.two(fe)+"-"+m.two(Re)+" "+m.two($e)+":"+m.two(Je)+":"+m.two(Be)},j.toArray=function(Oe){var ee=Oe.split(Oe.indexOf("T")!==-1?"T":" "),oe=ee[1],ee=ee[0].split("-"),fe=parseInt(ee[0]),Re=parseInt(ee[1]),$e=parseInt(ee[2]),Je=0,Be=0;return oe&&(oe=oe.split(":"),Je=parseInt(oe[0]),Be=parseInt(oe[1])),[fe,Re,$e,Je,Be,0]};var X=Date.UTC(1900,0,0),P=Date.UTC(1900,1,29),R=864e5;j.dateToNum=function(Oe){typeof Oe=="string"&&(Oe=new Date(Oe+"  GMT+0"));var oe=Oe.getTime();return oe>=P&&(oe+=R),oe-=X,oe/R},j.numToDate=function(Oe){var oe=X+Oe*R;oe>=P&&(oe-=R);const ee=new Date(oe);var fe=[ee.getUTCFullYear(),ee.getUTCMonth()+1,ee.getUTCDate(),ee.getUTCHours(),ee.getUTCMinutes(),ee.getUTCSeconds()];return j.now(fe)};let ae=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Pe=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(j,"weekdays",{get:function(){return ae.map(function(Oe){return c.translate(Oe)})}}),Object.defineProperty(j,"weekdaysShort",{get:function(){return ae.map(function(Oe){return c.translate(Oe).substring(0,3)})}}),Object.defineProperty(j,"months",{get:function(){return Pe.map(function(Oe){return c.translate(Oe)})}}),Object.defineProperty(j,"monthsShort",{get:function(){return Pe.map(function(Oe){return c.translate(Oe).substring(0,3)})}}),j}var H=Y();function k(){var j={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},X=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var L=0;this.date[4]&&(L=parseFloat(this.date[4]/60));var Z=parseInt(this.date[3])+L;Z/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?Z=m.two(this.date[3])+":"+m.two(this.date[4])+":"+m.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),Z=m.two(this.date[0])+"-"+m.two(this.date[1])+"-"+m.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(Z+=" "+m.two(this.date[3])+":"+m.two(this.date[4])+":"+m.two(this.date[5])));return Z},P=function(){var L="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)L=parseInt(this.date[3]);else{let de=parseInt(this.date[3]);de<13&&this.values.indexOf("PM")!==-1?L=(de+12)%24:L=de%24}this.date[4]&&(L+=parseFloat(this.date[4]/60)),this.date[5]&&(L+=parseFloat(this.date[5]/3600)),L/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var Z=H.now(this.date);L=H.dateToNum(Z)}return isNaN(L)&&(L=""),L},R=function(L){return L===null||L===""||L===void 0},ae=function(L){var Z=(""+L)[0];return Z=="="},Pe=function(L){return L==="currency"||L==="percentage"||L==="scientific"||L==="numeric"},Oe=function(L){if(L&&Number(L)==L)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var Z=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=Z[1]}else{L||(L=this.mask);var de=new RegExp("0{1}(.{1})0+","ig"),Z=de.exec(L);if(Z&&Z[1]&&Z[1].length==1)return this.options.decimal=Z[1],Z[1];var de=new RegExp("#{1}(.{1})#+","ig"),Z=de.exec(L);Z&&Z[1]&&Z[1].length==1?Z[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},oe=function(L,Z){if(L=="")return"";Z||(Z=Oe.call(this)),L=(""+L).split(Z);var de=L[0].match(/[-]+/g);if(de&&de.length?de=!0:de=!1,L[0]=L[0].match(/[0-9]+/g),L[0]?(de&&L[0].unshift("-"),L[0]=L[0].join("")):de&&(L[0]="-"),L[0]||L[1])L[1]!==void 0&&(L[1]=L[1].match(/[0-9]+/g),L[1]?L[1]=L[1].join(""):L[1]="");else return"";return L},ee=function(L,Z){if(L==="")return"";var de=Oe.call(this),Ee=this.options;if(L=oe.call(this,L),L==="")return"";var ye=null;if(L[0]&&(Ee.style==="percent"?ye=parseFloat(L[0])/100:ye=parseFloat(L[0]+".1")),(L[0]==="-"||L[0]==="-00")&&!L[1]&&Z&&Z.inputType=="deleteContentBackward")return"";var Ge=new Intl.NumberFormat(this.locale,Ee).format(ye);if(Ge=Ge.split(de),Ee.style==="percent"&&Ge[0].indexOf("%")!==-1&&(Ge[0]=Ge[0].replace("%",""),Ge[2]="%"),typeof Ge[1]<"u"){var tt=Ge[1].replace(/[0-9]*/g,"");tt&&(Ge[2]=tt)}return L[1]!==void 0?Ge[1]=de+L[1]:Ge[1]="",Ge.join("")},fe=function(L,Z){var de=Je.call(L);if(de){var Ee=ee.call(this,de,Z),ye=Ee.length-de.length,Ge=$e.call(L)+ye;Je.call(L,Ee,Ge,!0)}},Re=function(L){var Z=oe.call(this,L);return Z?(Z[0]==="-"&&(Z[0]="-0"),parseFloat(Z.join("."))):null},$e=function(L,Z){if(L===void 0)if(this.tagName=="DIV"){var de=0,Ee=window.getSelection();if(Ee&&Ee.rangeCount!==0){var ye=Ee.getRangeAt(0),Ge=ye.cloneRange();Ge.selectNodeContents(this),Ge.setEnd(ye.endContainer,ye.endOffset),de=Ge.toString().length}return de}else return this.selectionStart;else{var tt=Je.call(this);if(Z){for(var Ge=null,ft=0;ft<tt.length;ft++)(tt[ft].match(/[\-0-9]/g)||tt[ft]==="."||tt[ft]===",")&&(Ge=ft);Ge===null&&(Ge=tt.indexOf(" ")),L>=Ge&&(L=Ge+1)}if(L>tt.length&&(L=tt.length),L)if(this.tagName=="DIV"){var Ee=window.getSelection(),ye=document.createRange();this.childNodes[0]&&(ye.setStart(this.childNodes[0],L),Ee.removeAllRanges(),Ee.addRange(ye))}else this.selectionStart=L,this.selectionEnd=L}},Je=function(L,Z,de){if(this.tagName=="DIV")if(L===void 0){var L=this.innerText;return this.value&&this.value.length>L.length&&(L=this.value),L}else this.innerText!==L&&(this.innerText=L,Z&&$e.call(this,Z,de));else{if(L===void 0)return this.value;this.value!==L&&(this.value=L,Z&&$e.call(this,Z,de))}},Be=H.weekdays,ot=H.weekdaysShort,gt=H.months,b=H.monthsShort,q={YEAR:function(L,Z){var de=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(L)>=0&&parseInt(L)<=10&&this.values[this.index].length<Z&&(this.values[this.index]+=L),this.values[this.index].length==Z){if(Z==2)var de=de.substr(0,2)+this.values[this.index];else if(Z==3)var de=de.substr(0,1)+this.values[this.index];else if(Z==4)var de=this.values[this.index];this.date[0]=de,this.index++}},YYYY:function(L){q.YEAR.call(this,L,4)},YYY:function(L){q.YEAR.call(this,L,3)},YY:function(L){q.YEAR.call(this,L,2)},FIND:function(L,Z){if(R(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=L;return}for(var de=0,Ee=0,ye=(this.values[this.index]+L).toLowerCase(),Ge=0;Ge<Z.length;Ge++)Z[Ge].toLowerCase().indexOf(ye)==0&&(de=Ge,Ee++);if(Ee>1)this.values[this.index]+=L;else if(Ee==1){var tt=Z[de].length-this.values[this.index].length-1;return this.position+=tt,this.values[this.index]=Z[de],this.index++,de}},MMM:function(L){var Z=q.FIND.call(this,L,b);Z!==void 0&&(this.date[1]=Z+1)},MON:function(L){q.MMM.call(this,L)},MMMM:function(L){var Z=q.FIND.call(this,L,gt);Z!==void 0&&(this.date[1]=Z+1)},MONTH:function(L){q.MMMM.call(this,L)},MMMMM:function(L){R(this.values[this.index])&&(this.values[this.index]="");for(var Z=(this.values[this.index]+L).toLowerCase(),de=0;de<gt.length;de++)if(gt[de][0].toLowerCase().indexOf(Z)==0){this.values[this.index]=gt[de][0],this.date[1]=de+1,this.index++;break}},MM:function(L){R(this.values[this.index])?parseInt(L)>1&&parseInt(L)<10?(this.date[1]=this.values[this.index]="0"+L,this.index++):parseInt(L)<2&&(this.values[this.index]=L):this.values[this.index]==1&&parseInt(L)<3?(this.date[1]=this.values[this.index]+=L,this.index++):this.values[this.index]==0&&parseInt(L)>0&&parseInt(L)<10&&(this.date[1]=this.values[this.index]+=L,this.index++)},M:function(L){var Z=!1;if(parseInt(L)>=0&&parseInt(L)<10)if(R(this.values[this.index]))this.values[this.index]=L,L>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(L)<3)this.date[1]=this.values[this.index]+=L,this.index++;else if(this.values[this.index]==0&&parseInt(L)>0)this.date[1]=this.values[this.index]+=L,this.index++;else var Z=!0;else var Z=!0;if(Z==!0){var de=parseInt(this.values[this.index]);de>0&&de<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(L){var Z=!1;if(parseInt(L)>=0&&parseInt(L)<10)if(R(this.values[this.index]))this.values[this.index]=L,parseInt(L)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(L)<2)this.date[2]=this.values[this.index]+=L,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=L,this.index++;else if(this.values[this.index]==0&&parseInt(L)>0)this.date[2]=this.values[this.index]+=L,this.index++;else var Z=!0;else var Z=!0;if(Z==!0){var de=parseInt(this.values[this.index]);de>0&&de<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(L){R(this.values[this.index])?parseInt(L)>3&&parseInt(L)<10?(this.date[2]=this.values[this.index]="0"+L,this.index++):parseInt(L)<10&&(this.values[this.index]=L):this.values[this.index]==3&&parseInt(L)<2?(this.date[2]=this.values[this.index]+=L,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(L)<10?(this.date[2]=this.values[this.index]+=L,this.index++):this.values[this.index]==0&&parseInt(L)>0&&parseInt(L)<10&&(this.date[2]=this.values[this.index]+=L,this.index++)},DDD:function(L){q.FIND.call(this,L,ot)},DY:function(L){q.DDD.call(this,L)},DDDD:function(L){q.FIND.call(this,L,Be)},DAY:function(L){q.DDDD.call(this,L)},HH12:function(L,Z){R(this.values[this.index])?parseInt(L)>1&&parseInt(L)<10?(Z&&(L=0+L),this.date[3]=this.values[this.index]=L,this.index++):parseInt(L)<10&&(this.values[this.index]=L):this.values[this.index]==1&&parseInt(L)<3?(this.date[3]=this.values[this.index]+=L,this.index++):this.values[this.index]<1&&parseInt(L)<10&&(this.date[3]=this.values[this.index]+=L,this.index++)},HH24:function(L,Z){parseInt(L)>=0&&parseInt(L)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(L)>2&&parseInt(L)<10?(Z&&(L=0+L),this.date[3]=this.values[this.index]=L,this.index++):parseInt(L)<10&&(this.values[this.index]=L):this.values[this.index]==2&&parseInt(L)<4?(!Z&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=L,this.index++):this.values[this.index]<2&&parseInt(L)<10&&(!Z&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=L,this.index++))},HH:function(L){q.HH24.call(this,L,1)},H:function(L){q.HH24.call(this,L,0)},"\\[H\\]":function(L){this.values[this.index]==null&&(this.values[this.index]=""),L.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=L:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(L,Z){this.values[this.index]==null||this.values[this.index]==""?parseInt(L)>5&&parseInt(L)<10?(this.date[Z]=this.values[this.index]="0"+L,this.index++):parseInt(L)<10&&(this.values[this.index]=L):parseInt(L)<10&&(this.date[Z]=this.values[this.index]+=L,this.index++)},MI:function(L){q.N60.call(this,L,4)},SS:function(L){q.N60.call(this,L,5)},"AM/PM":function(L){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?L.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":L.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(L){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(L)>=0&&parseInt(L)<7&&(this.values[this.index]=L),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(L){var Z=Oe.call(this),de=!1;R(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(de=!0);var Ee=oe.call(this,this.values[this.index],Z);Ee&&(this.values[this.index]=Ee.join(Z)),parseInt(L)>=0&&parseInt(L)<10?(this.values[this.index]=="0"&&L>0?this.values[this.index]="":this.values[this.index]=="-0"&&L>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||L==Z)&&(this.values[this.index]+=L)):Z&&L==Z?this.values[this.index].indexOf(Z)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=L):L=="-"&&(de=!0),de===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(L){q["0{1}(.{1}0+)?"].call(this,L)},"0{1}(.{1}0+)?%":function(L){q["0{1}(.{1}0+)?"].call(this,L),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(L){q["0{1}(.{1}0+)?"].call(this,L);var Z=Oe.call(this),de=this.tokens[this.index].substr(1,1),Ee=this.values[this.index][0]==="-",ye=oe.call(this,this.values[this.index],Z);if(ye!==""){var Ge=ye[0].match(/[0-9]/g);if(Ge){Ge=Ge.join("");for(var tt=[],ft=0,We=Ge.length-1;We>=0;We--)tt.push(Ge[We]),ft++,ft%3||tt.push(de);tt=tt.reverse(),ye[0]=tt.join(""),ye[0].substr(0,1)==de&&(ye[0]=ye[0].substr(1))}else ye[0]="";this.values[this.index]=ye.join(Z),Ee&&(this.values[this.index]="-"+this.values[this.index])}},0:function(L){L.match(/[0-9]/g)&&(this.values[this.index]=L,this.index++)},"[0-9a-zA-Z$]+":function(L){R(this.values[this.index])&&(this.values[this.index]="");var Z=this.tokens[this.index],de=this.values[this.index],Ee=de.length;Z[Ee]==L?(this.values[this.index]+=L,this.values[this.index]==Z&&this.index++):(this.values[this.index]=Z,this.index++,L.match(/[\-0-9]/g)&&this.position--)},A:function(L){L.match(/[a-zA-Z]/gi)&&(this.values[this.index]=L,this.index++)},".":function(L){q["[0-9a-zA-Z$]+"].call(this,L)},"@":function(L){R(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=L}},F=function(L){if(this.type=="general")var Z=[].concat(j.general);else var Z=[].concat(j.currency,j.datetime,j.percentage,j.scientific,j.numeric,j.text,j.general);var de=new RegExp(Z.join("|"),"gi");return L.match(de)},W=function(L){if(this.type)if(this.type=="text")var Z=["text"];else if(this.type=="general")var Z=["general"];else if(this.type=="datetime")var Z=["numeric","datetime","general"];else var Z=["currency","percentage","scientific","numeric","general"];else var Z=Object.keys(j);for(var de=0;de<Z.length;de++)for(var Ee=Z[de],ye=0;ye<j[Ee].length;ye++){var Ge=new RegExp(j[Ee][ye],"gi"),tt=L.match(Ge);if(tt)return{type:Ee,method:j[Ee][ye]}}},z=function(L){for(var Z=[],de=0;de<L.length;de++){var Ee=W.call(this,L[de]);Ee?Z.push(Ee.method):Z.push(null)}for(var de=0;de<Z.length;de++)Z[de]=="MM"&&(Z[de-1]&&Z[de-1].indexOf("H")>=0||Z[de-2]&&Z[de-2].indexOf("H")>=0||Z[de+1]&&Z[de+1].indexOf("S")>=0||Z[de+2]&&Z[de+2].indexOf("S")>=0)&&(Z[de]="MI");return Z},ie=function(L){var Z=W.call(this,L);if(Z)var de=Z.type;if(de){for(var Ee=0,ye=F.call(this,L),Ge=0;Ge<ye.length;Ge++)Z=W.call(this,ye[Ge]),Z&&Pe(Z.type)&&Ee++;Ee>1&&(de="general")}return de},_e=function(){typeof q[this.methods[this.index]]=="function"?(q[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},J=function(L){return(""+ +L).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(Z,de,Ee,ye,Ge){return Ge<0?de+"0."+Array(1-Ge-Ee.length).join(0)+Ee+ye:de+Ee+ye+Array(Ge-ye.length+1).join(0)})},me=function(L,Z,de){var Ee=null,ye={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof L=="object"){if(ye.input=L.target,ye.value=Je.call(L.target),ye.caret=$e.call(L.target),(Ee=L.target.getAttribute("data-mask"))&&(ye.mask=Ee),(Ee=L.target.getAttribute("data-type"))&&(ye.type=Ee),L.target.mask?(L.target.mask.options&&(ye.options=L.target.mask.options),L.target.mask.locale&&(ye.locale=L.target.mask.locale)):(Ee=L.target.getAttribute("data-locale"))&&(ye.locale=Ee,ye.mask&&(ye.options.style=ye.mask)),L.target.attributes&&L.target.attributes.length)for(var Ge=0;Ge<L.target.attributes.length;Ge++){var tt=L.target.attributes[Ge].name,ft=L.target.attributes[Ge].value;tt.substr(0,4)=="data"&&(ye.options[tt.substr(5)]=ft)}}else{if(typeof Z=="string")ye.mask=Z;else for(var tt=Object.keys(Z),Ge=0;Ge<tt.length;Ge++)ye[tt[Ge]]=Z[tt[Ge]];typeof L=="number"&&(Oe.call(ye,ye.mask),L=(""+L).replace(".",ye.options.decimal)),ye.value=L,ye.input&&(Je.call(ye.input,L),m.focus(ye.input),ye.caret=$e.call(ye.input))}if(!ae(ye.value)&&(ye.mask||ye.locale)){if(ye.mask){if(ye.mask=ye.mask.replace(new RegExp(/\[h]/),"|h|"),ye.mask=ye.mask.replace(new RegExp(/\[.*?\]/),""),ye.mask=ye.mask.replace(new RegExp(/\|h\|/),"[h]"),ye.mask.indexOf(";")!==-1){var Ee=ye.mask.split(";");ye.mask=Ee[0]}if(ye.mask.indexOf("##")!==-1){var We=ye.mask.split(";");We[0]&&(typeof L=="object"&&(We[0]=We[0].replace(new RegExp(/_\)/g),""),We[0]=We[0].replace(new RegExp(/_\(/g),"")),We[0]=We[0].replace("*","	"),We[0]=We[0].replace(new RegExp(/_-/g),""),We[0]=We[0].replace(new RegExp(/_/g),""),We[0]=We[0].replace(new RegExp(/"/g),""),We[0]=We[0].replace("##0.###","##0.000"),We[0]=We[0].replace("##0.##","##0.00"),We[0]=We[0].replace("##0.#","##0.0"),We[0]=We[0].replace("##0,###","##0,000"),We[0]=We[0].replace("##0,##","##0,00"),We[0]=We[0].replace("##0,#","##0,0")),ye.mask=We[0]}if(ye.mask.indexOf("\\")!==-1){var We=ye.mask.split(";");We[0]=We[0].replace(new RegExp(/\\/g),""),ye.mask=We[0]}ye.type||(ye.type=ie.call(ye,ye.mask)),ye.tokens=F.call(ye,ye.mask)}if(typeof L!="object"||!L.inputType||!L.inputType.indexOf("insert")||!L.inputType.indexOf("delete"))if(ye.locale)if(ye.input)fe.call(ye,ye.input,L);else var yt=ee.call(ye,ye.value);else{for(ye.methods=z.call(ye,ye.tokens),ye.event=L;ye.position<ye.value.length&&typeof ye.tokens[ye.index]<"u";)_e.call(ye);var yt=ye.values.join("");if(Pe(ye.type)&&yt!==""){for(;typeof ye.tokens[ye.index]<"u";){var Ee=W.call(ye,ye.tokens[ye.index]);Ee&&Ee.type=="general"&&(ye.values[ye.index]=ye.tokens[ye.index]),ye.index++}var Ct=!0}else var Ct=!1;if(yt=ye.values.join(""),ye.input){if(Ee=yt.length-ye.value.length,Ee>0)var Mt=ye.caret+Ee;else var Mt=ye.caret;Je.call(ye.input,yt,Mt,Ct)}}if(ye.input){var De=null;if(Pe(ye.type)){let ht=Je.call(ye.input);ye.number=Re.call(ye,ht),ye.type=="percentage"&&(""+ht).indexOf("%")!==-1?De=me.adjustPrecision(ye.number/100):De=ye.number}else ye.type=="datetime"&&(De=X.call(ye),ye.date[0]&&ye.date[1]&&ye.date[2]&&ye.input.setAttribute("data-completed",!0));De&&ye.input.setAttribute("data-value",De)}if(yt!==void 0)return de?ye:yt}};return me.adjustPrecision=function(L){if(typeof L=="number"&&!Number.isInteger(L)){const Z=L.toString().split(".");if(Z[1]&&Z[1].length>10){let de=0;const Ee=Z[1][Z[1].length-2];if(Ee==0||Ee==9){for(let ye=Z[1].length-2;ye>0;ye--)if(de>=0&&Z[1][ye]==Ee){if(de++,de>6)break}else{de=0;break}if(de)return parseFloat(parseFloat(L).toFixed(Z[1].length-1))}}}return L},me.getType=ie,me.prepare=function(L,Z){return Z||(Z={}),F.call(Z,L)},me.apply=function(L){var Z=Je.call(L.target);L.key.length==1&&(Z+=L.key),Je.call(L.target,me(Z,L.target.getAttribute("data-mask")))},me.run=function(L,Z,de){return me(L,{mask:Z,decimal:de})},me.extract=function(L,Z,de){if(R(L)||typeof Z!="object")return L;if(Z=Object.assign({},Z),Z.options||(Z.options={}),!Z.mask&&Z.format&&(Z.mask=Z.format),Z.mask){if(Z.mask.indexOf(";")!==-1){var Ee=Z.mask.split(";");Z.mask=Ee[0]}Z.mask=Z.mask.replace(new RegExp(/\[h]/),"|h|"),Z.mask=Z.mask.replace(new RegExp(/\[.*?\]/),""),Z.mask=Z.mask.replace(new RegExp(/\|h\|/),"[h]")}Oe.call(Z,Z.mask);var ye=null,Ge=null;if(Z.type=="percent"||Z.options.style=="percent"?ye="percentage":Z.mask&&(ye=ie.call(Z,Z.mask)),ye==="text"){var tt={};Ge=L}else if(ye==="general"){var tt=me(L,Z,!0);Ge=L}else if(ye==="datetime"){L instanceof Date&&(L=me.getDateString(L,Z.mask));var tt=me(L,Z,!0);m.isNumeric(L)?Ge=L:Ge=P.call(tt)}else if(ye==="scientific"){Ge=L,typeof L=="string"&&(Ge=Number(Ge));var tt=Z}else{Ge=Re.call(Z,L),ye==="percentage"&&(""+L).indexOf("%")!==-1&&(Ge/=100);var tt=Z}return tt.value=Ge,!tt.type&&ye&&(tt.type=ye),de?tt:Ge},me.render=function(L,Z,de,Ee){if(R(L)||typeof Z!="object")return L;if(Z=Object.assign({},Z),Z.options||(Z.options={}),!Z.mask&&Z.format&&(Z.mask=Z.format),Z.mask){if(Z.mask.indexOf(";")!==-1){var ye=Z.mask.split(";");de||(ye[0]=ye[0].replace(new RegExp(/_\)/g),""),ye[0]=ye[0].replace(new RegExp(/_\(/g),"")),Z.mask=ye[0]}Z.mask=Z.mask.replace(new RegExp(/\[h]/),"|h|"),Z.mask=Z.mask.replace(new RegExp(/\[.*?\]/),""),Z.mask=Z.mask.replace(new RegExp(/\|h\|/),"[h]")}var Ge=null;Z.type=="percent"||Z.options.style=="percent"?Ge="percentage":Z.mask?Ge=ie.call(Z,Z.mask):L instanceof Date&&(Ge="datetime");var tt=!1;if(Ge=="datetime"||Z.type=="calendar"){var ye=me.getDateString(L,Z.mask);ye&&(L=ye),Z.mask&&de&&(tt=!0)}else if(Ge!=="text")if(typeof L=="string"&&t.isNumeric(L)&&(L=Number(L)),Ge==="percentage"&&(L=me.adjustPrecision(L*100)),typeof L=="number"){var ye=null;if(Z.mask&&de){var ft=Oe.call(Z,Z.mask);if(Ge==="scientific")if(Z.mask.indexOf(ft)!==-1){let mt=Z.mask.split("E");mt=mt[0].split(ft),mt=""+mt[1].match(/[0-9]+/g),mt=mt.length,ye=L.toExponential(mt)}else ye=L.toExponential(0);else{if(Z.mask.indexOf(ft)!==-1){ft=Z.mask.split(ft),ft=""+ft[1].match(/[0-9]+/g),ft=ft.length,ye=L.toFixed(ft);let mt=L.toString().split("."),Nt=mt[1];Nt&&Nt.length>ft&&Nt[Nt.length-1]==="5"&&(ye=parseFloat(mt[0]+"."+Nt+"1").toFixed(ft))}else L.toString().indexOf(ft)!==-1&&(ye=L.toFixed(0));(""+ye).indexOf("e")!==-1&&(ye=J(ye))}}else if(Z.locale&&de){var ft=(""+L).split(".");if(Z.options){typeof ft[1]>"u"&&(ft[1]="");var yt=ft[1].length;if(Z.options.minimumFractionDigits>yt)for(var We=0;We<Z.options.minimumFractionDigits-yt;We++)ft[1]+="0"}ft[1].length?ye=ft.join("."):ye=ft[0];var yt=ft[1].length;Z.options&&Z.options.maximumFractionDigits<yt&&(ye=parseFloat(ye).toFixed(Z.options.maximumFractionDigits))}else ye=J(L);ye!==null&&(L=ye,Oe.call(Z,Z.mask),Z.options.decimal&&(L=L.replace(".",Z.options.decimal)))}else Z.mask&&de&&(tt=!0);if(tt){var Ct=Z.mask.length-L.length;if(Ct>0)for(var We=0;We<Ct;We++)L+=" "}if(Ge==="scientific")if(!de)L=J(L);else return L;if(Ge==="numeric"&&Ee===!1&&typeof L=="string")return L;if(L=me(L,Z),de&&Ge==="numeric"){var Mt=Z.mask.match(new RegExp(/^[0]+$/gm));if(Mt&&Mt.length===1){var De=Mt[0].length;if(De>3)for(L=""+L;L.length<De;)L="0"+L}}return L},me.set=function(L,Z){if(Z){L.setAttribute("data-mask",Z);var de=new Event("input",{bubbles:!0,cancelable:!0});L.dispatchEvent(de)}},me.extractDateFromString=function(L,Z){var de=me(L,{mask:Z},!0);if(L>0&&Number(L)==L&&(de.values.join("")!==de.value||de.type=="numeric")){var Ee=new Date(Math.round((L-25569)*86400*1e3));return Ee.getFullYear()+"-"+m.two(Ee.getMonth())+"-"+m.two(Ee.getDate())+" 00:00:00"}var ye=!1;return de.values&&de.values.length===de.tokens.length&&de.values[de.values.length-1].length>=de.tokens[de.tokens.length-1].length&&(ye=!0),de.date[0]&&de.date[1]&&(de.date[2]||ye)?(de.date[2]||(de.date[2]=1),de.date[0]+"-"+m.two(de.date[1])+"-"+m.two(de.date[2])+" "+m.two(de.date[3])+":"+m.two(de.date[4])+":"+m.two(de.date[5])):""},me.getDateString=function(L,Z){if(!Z)var Z={};if(Z&&typeof Z=="object"){if(Z.format)var de=Z.format;else if(Z.mask)var de=Z.mask}else var de=Z;if(de||(de="YYYY-MM-DD"),de.indexOf("[h]")>=0){var Ee=0;if(L&&m.isNumeric(L)&&(Ee=parseFloat(24*Number(L)),de.indexOf("mm")>=0)){var ye=(""+Ee).split(".");if(ye[1]){var Ge=60*parseFloat("0."+ye[1]);Ge=parseFloat(Ge.toFixed(2))}else var Ge=0;Ee=parseInt(ye[0])+":"+m.two(Ge)}return Ee}L instanceof Date?L=H.now(L):L&&m.isNumeric(L)&&(L=H.numToDate(L));for(var tt=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],ft=new RegExp(tt.join("|"),"gi"),We=de.match(ft),yt=0;yt<We.length;yt++)We[yt].toUpperCase()=="MM"&&(We[yt-1]&&We[yt-1].toUpperCase().indexOf("H")>=0||We[yt-2]&&We[yt-2].toUpperCase().indexOf("H")>=0||We[yt+1]&&We[yt+1].toUpperCase().indexOf("S")>=0||We[yt+2]&&We[yt+2].toUpperCase().indexOf("S")>=0)&&(We[yt]="mi");var Ct={tokens:We};if(L){var Ge=""+L,Mt=Ge.indexOf("T")!==-1?"T":" ";Ge=Ge.split(Mt);var ye=0,De=0,ht=0;Ge[1]&&(ye=Ge[1].split(":"),De=ye[1]?ye[1]:0,ht=ye[2]?ye[2]:0,ye=ye[0]?ye[0]:0),Ge=Ge[0].split("-");let dt=new Date(Ge[0],Ge[1],0).getDate();if(Ge[0]&&Ge[1]&&Ge[2]&&Ge[0]>0&&Ge[1]>0&&Ge[1]<13&&Ge[2]>0&&Ge[2]<=dt){Ct.data=[Ge[0],Ge[1],Ge[2],ye,De,ht],Ct.value=[];for(var mt=new Date(Ct.data[0],Ct.data[1]-1,Ct.data[2],Ct.data[3],Ct.data[4],Ct.data[5]),Nt=function(wt){var Ot=this.tokens[wt],Bt=Ot.toUpperCase(),bt=null;Bt==="YYYY"?bt=this.data[0]:Bt==="YYY"?bt=this.data[0].substring(1,4):Bt==="YY"?bt=this.data[0].substring(2,4):Bt==="Y"?bt=this.data[0].substring(3,4):Ot==="MON"?bt=H.months[mt.getMonth()].substr(0,3).toUpperCase():Ot==="mon"?bt=H.months[mt.getMonth()].substr(0,3).toLowerCase():Ot==="MONTH"?bt=H.months[mt.getMonth()].toUpperCase():Ot==="month"?bt=H.months[mt.getMonth()].toLowerCase():Bt==="MMMMM"?bt=H.months[mt.getMonth()].substr(0,1):Bt==="MMMM"||Ot==="Month"?bt=H.months[mt.getMonth()]:Bt==="MMM"||Ot=="Mon"?bt=H.months[mt.getMonth()].substr(0,3):Bt==="MM"?bt=m.two(this.data[1]):Bt==="M"?bt=mt.getMonth()+1:Ot==="DAY"?bt=H.weekdays[mt.getDay()].toUpperCase():Ot==="day"?bt=H.weekdays[mt.getDay()].toLowerCase():Bt==="DDDD"||Ot=="Day"?bt=H.weekdays[mt.getDay()]:Bt==="DDD"?bt=H.weekdays[mt.getDay()].substr(0,3):Bt==="DD"?bt=m.two(this.data[2]):Bt==="D"?bt=parseInt(this.data[2]):Bt==="Q"?bt=Math.floor((mt.getMonth()+3)/3):Bt==="HH24"||Bt==="HH"?(bt=this.data[3],bt>12&&this.tokens.indexOf("am/pm")!==-1&&(bt-=12),bt=m.two(bt)):Bt==="HH12"?this.data[3]>12?bt=m.two(this.data[3]-12):bt=m.two(this.data[3]):Bt==="H"?(bt=this.data[3],bt>12&&this.tokens.indexOf("am/pm")!==-1&&(bt-=12,bt=m.two(bt))):Bt==="MI"?bt=m.two(this.data[4]):Bt==="SS"?bt=m.two(this.data[5]):Bt==="MS"?bt=mt.getMilliseconds():Bt==="AM/PM"?this.data[3]>=12?bt="PM":bt="AM":Bt==="WD"&&(bt=H.weekdays[mt.getDay()]),bt===null?this.value[wt]=this.tokens[wt]:this.value[wt]=bt},yt=0;yt<Ct.tokens.length;yt++)Nt.call(Ct,yt);L=Ct.value.join("")}else L=""}return L},me}var K=k();function se(){var j=function(X,P){if(X.calendar)return X.calendar.setOptions(P,!0);var R={type:"calendar"};R.options={},R.date=null,R.setOptions=function(J,me){var L={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:H.monthsShort,monthsFull:H.months,weekdays:H.weekdays,textDone:c.translate("Done"),textReset:c.translate("Reset"),textUpdate:c.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var Z in L)J&&J.hasOwnProperty(Z)?R.options[Z]=J[Z]:(typeof R.options[Z]>"u"||me===!0)&&(R.options[Z]=L[Z]);if(R.options.resetButton==!1?ee.style.display="none":ee.style.display="",R.options.readonly?X.setAttribute("readonly","readonly"):X.removeAttribute("readonly"),R.options.placeholder?X.setAttribute("placeholder",R.options.placeholder):X.removeAttribute("placeholder"),m.isNumeric(R.options.value)&&R.options.value>0&&(R.options.value=j.numToDate(R.options.value),R.options.dataType="numeric"),ee.innerHTML=R.options.textReset,fe.innerHTML=R.options.textDone,W.innerHTML=R.options.textUpdate,R.options.format&&X.setAttribute("data-mask",R.options.format.toLowerCase()),!R.options.value&&R.options.today)var de=j.now();else var de=R.options.value;return de&&(R.options.value=null,R.setValue(de)),R},R.open=function(J){if(!oe.classList.contains("jcalendar-focus")&&!oe.classList.contains("jcalendar-inline")){if(j.current=R,g(R,!0),R.getDays(),R.options.type=="year-month-picker"&&R.getMonths(),R.options.time&&(z.value=R.date[3],ie.value=R.date[4]),oe.classList.add("jcalendar-focus"),m.getWindowWidth()<800||R.options.fullscreen)oe.classList.add("jcalendar-fullsize"),D.slideBottom($e,1);else{oe.classList.remove("jcalendar-fullsize");var me=X.getBoundingClientRect(),L=$e.getBoundingClientRect();if(R.options.position)Re.style.position="fixed",window.innerHeight<me.bottom+L.height?Re.style.top=me.top-(L.height+2)+"px":Re.style.top=me.top+me.height+2+"px",Re.style.left=me.left+"px";else{if(window.innerHeight<me.bottom+L.height){var Z=-1*(me.height+L.height+2);Z+me.top<0&&(Z=-1*(me.top+me.height)),Re.style.top=Z+"px"}else Re.style.top="2px";if(window.innerWidth<me.left+L.width){var Z=window.innerWidth-(me.left+L.width+20);Re.style.left=Z+"px"}else Re.style.left="0px"}}typeof R.options.onopen=="function"&&R.options.onopen(X)}},R.close=function(J,me){if(R.options.autoSelect!==!0&&typeof me>"u"&&(me=!1),oe.classList.contains("jcalendar-focus")){if(me!==!1){var L=oe.querySelector(".jcalendar-selected");if(typeof me=="string")var Z=me;else if(!L||L.classList.contains("jcalendar-disabled"))var Z=R.options.value;else var Z=R.getValue();R.setValue(Z)}else{let de=R.options.value||"";R.options.value=null,R.setValue(de)}!J&&typeof R.options.onclose=="function"&&R.options.onclose(X),oe.classList.remove("jcalendar-focus"),g(R,!1),j.current=null}return R.options.value},R.prev=function(){R.options.mode=="years"?(R.date[0]=R.date[0]-12,R.getYears()):R.options.mode=="months"?(R.date[0]=parseInt(R.date[0])-1,R.getMonths()):(R.date[1]<2?(R.date[0]=R.date[0]-1,R.date[1]=12):R.date[1]=R.date[1]-1,R.getDays())},R.next=function(){R.options.mode=="years"?(R.date[0]=parseInt(R.date[0])+12,R.getYears()):R.options.mode=="months"?(R.date[0]=parseInt(R.date[0])+1,R.getMonths()):(R.date[1]>11?(R.date[0]=parseInt(R.date[0])+1,R.date[1]=1):R.date[1]=parseInt(R.date[1])+1,R.getDays())},R.setToday=function(){var J=new Date().toISOString().substr(0,10);return R.setValue(J),J},R.setValue=function(J){J||(J=""+J);var me=J,L=R.options.value;if(L!=me){if(me){R.setLabel(me,R.options);var de=me.split(" ");de[1]||(de[1]="00:00:00");var Z=de[1].split(":"),de=de[0].split("-"),Ee=parseInt(de[0]),ye=parseInt(de[1]),Ge=parseInt(de[2]),tt=parseInt(Z[0]),ft=parseInt(Z[1]);R.date=[Ee,ye,Ge,tt,ft,0];var J=R.setLabel(me,R.options),We=j.now(new Date(Ee,ye-1,Ge),!0);if(R.options.validRange){if(!R.options.validRange[0]||We>=R.options.validRange[0])var yt=!0;else var yt=!1;if(!R.options.validRange[1]||We<=R.options.validRange[1])var Ct=!0;else var Ct=!1;yt&&Ct?(X.classList.remove("jcalendar_warning"),X.title=""):(X.classList.add("jcalendar_warning"),X.title=c.translate("Date outside the valid range"))}else X.classList.remove("jcalendar_warning"),X.title=""}else{R.date=null;var J="";X.classList.remove("jcalendar_warning"),X.title=""}R.options.value=me,typeof R.options.onchange=="function"&&R.options.onchange(X,me,L),X.value!=J&&(X.value=J,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value}))}R.date&&(R.getDays(),R.options.type=="year-month-picker"&&R.getMonths())},R.getValue=function(){return R.date?R.options.time?m.two(R.date[0])+"-"+m.two(R.date[1])+"-"+m.two(R.date[2])+" "+m.two(R.date[3])+":"+m.two(R.date[4])+":"+m.two(0):m.two(R.date[0])+"-"+m.two(R.date[1])+"-"+m.two(R.date[2])+" "+m.two(0)+":"+m.two(0)+":"+m.two(0):""},R.update=function(J,me){if(!J.classList.contains("jcalendar-disabled")){var L=oe.querySelector(".jcalendar-selected");L&&L.classList.remove("jcalendar-selected"),J.classList.add("jcalendar-selected"),J.classList.contains("jcalendar-set-month")?(R.date[1]=me,R.date[2]=1):R.date[2]=J.innerText,R.options.time?(R.date[3]=z.value,R.date[4]=ie.value):R.close(null,!0)}Oe()},R.reset=function(){R.setValue(""),R.date=null,R.close(!1,!1)},R.getDays=function(){R.options.mode="days";var tt=new Date,J=R.date&&m.isNumeric(R.date[0])?R.date[0]:parseInt(tt.getFullYear()),me=R.date&&m.isNumeric(R.date[1])?R.date[1]:parseInt(tt.getMonth())+1,L=R.date&&m.isNumeric(R.date[2])?R.date[2]:parseInt(tt.getDate()),Z=R.date&&m.isNumeric(R.date[3])?R.date[3]:parseInt(tt.getHours()),de=R.date&&m.isNumeric(R.date[4])?R.date[4]:parseInt(tt.getMinutes());R.date=[J,me,L,Z,de,0],Je.innerHTML=J,Be.innerHTML=R.options.months[me-1];var Ee=tt.getMonth()==me-1&&tt.getFullYear()==J,ye=tt.getDate(),tt=new Date(J,me,0,0,0),Ge=tt.getDate(),tt=new Date(J,me-1,0,0,0),ft=tt.getDay()+1,Mt=R.options.startingDay||0;ft=ft-Mt,gt.innerHTML="";var We=document.createElement("tr");We.setAttribute("align","center"),gt.appendChild(We);for(var yt=0;yt<7;yt++){var Ct=document.createElement("td");Ct.classList.add("jcalendar-weekday"),Ct.innerHTML=R.options.weekdays[Mt].substr(0,1),We.appendChild(Ct),Mt++,Mt>6&&(Mt=0)}for(var Mt=0,De=0,ht=0;ht<6;ht++){var We=document.createElement("tr");We.setAttribute("align","center"),We.style.height="34px";for(var yt=0;yt<7;yt++){var Ct=document.createElement("td");if(Ct.classList.add("jcalendar-set-day"),Mt>=ft&&Mt<ft+Ge){De++,Ct.innerHTML=De,De==L&&Ct.classList.add("jcalendar-selected"),Ee&&ye==De&&(Ct.style.fontWeight="bold");var mt=j.now(new Date(J,me-1,De),!0);if(R.options.validRange){if(!R.options.validRange[0]||mt>=R.options.validRange[0])var Nt=!0;else var Nt=!1;if(!R.options.validRange[1]||mt<=R.options.validRange[1])var pt=!0;else var pt=!1;Nt&&pt||Ct.classList.add("jcalendar-disabled")}}We.appendChild(Ct),Mt++}gt.appendChild(We)}R.options.time?q.style.display="":q.style.display="none",Oe()},R.getMonths=function(){R.options.mode="months";var J=R.options.months;R.options.value;var me=new Date,L=parseInt(me.getFullYear()),Z=parseInt(me.getMonth())+1,de=R.date&&m.isNumeric(R.date[0])?R.date[0]:L,Ee=R.date&&m.isNumeric(R.date[1])?R.date[1]:Z;Je.innerHTML=R.date[0],Be.innerHTML=J[Ee-1];var ye=document.createElement("table");ye.setAttribute("width","100%");for(var Ge=null,tt=0;tt<12;tt++){if(!(tt%4)){var Ge=document.createElement("tr");Ge.setAttribute("align","center"),ye.appendChild(Ge)}var ft=document.createElement("td");if(ft.classList.add("jcalendar-set-month"),ft.setAttribute("data-value",tt+1),ft.innerText=J[tt],R.options.validRange){var We=de+"-"+m.two(tt+1);if(!R.options.validRange[0]||We>=R.options.validRange[0].substr(0,7))var yt=!0;else var yt=!1;if(!R.options.validRange[1]||We<=R.options.validRange[1].substr(0,7))var Ct=!0;else var Ct=!1;yt&&Ct||ft.classList.add("jcalendar-disabled")}tt+1==Ee&&ft.classList.add("jcalendar-selected"),L==de&&tt+1==Z&&(ft.style.fontWeight="bold"),Ge.appendChild(ft)}gt.innerHTML='<tr><td colspan="7"></td></tr>',gt.children[0].children[0].appendChild(ye),Oe()},R.getYears=function(){R.options.mode="years";for(var J=new Date,me=J.getFullYear(),L=R.date&&m.isNumeric(R.date[0])?R.date[0]:parseInt(J.getFullYear()),Z=[],de=0;de<25;de++)Z[de]=parseInt(R.date[0])+(de-12);var Ee=document.createElement("table");Ee.setAttribute("width","100%");for(var de=0;de<25;de++){if(!(de%5)){var ye=document.createElement("tr");ye.setAttribute("align","center"),Ee.appendChild(ye)}var Ge=document.createElement("td");Ge.classList.add("jcalendar-set-year"),Ge.innerText=Z[de],L==Z[de]&&Ge.classList.add("jcalendar-selected"),me==Z[de]&&(Ge.style.fontWeight="bold"),ye.appendChild(Ge)}gt.innerHTML='<tr><td colspan="7"></td></tr>',gt.firstChild.firstChild.appendChild(Ee),Oe()},R.setLabel=function(J,me){return j.getDateString(J,me)},R.fromFormatted=function(J,me){return j.extractDateFromString(J,me)};var ae=function(J){var me=m.findElement(J.target,"jcalendar-container");if(me){var L=J.target.className;if(L=="jcalendar-prev")R.prev();else if(L=="jcalendar-next")R.next();else if(L=="jcalendar-month")R.getMonths();else if(L=="jcalendar-year")R.getYears();else if(L=="jcalendar-set-year")R.date[0]=J.target.innerText,R.options.type=="year-month-picker"?R.getMonths():R.getDays();else if(J.target.classList.contains("jcalendar-set-month")){var Z=parseInt(J.target.getAttribute("data-value"));R.options.type=="year-month-picker"?R.update(J.target,Z):(R.date[1]=Z,R.getDays())}else L=="jcalendar-confirm"||L=="jcalendar-update"||L=="jcalendar-close"?R.close(null,!0):L=="jcalendar-backdrop"?R.close(!1,!1):L=="jcalendar-reset"?R.reset():J.target.classList.contains("jcalendar-set-day")&&J.target.innerText&&R.update(J.target)}else R.close(!1,!1)},Pe=function(J){if(J.target.value&&J.target.value.length>3){var me=j.extractDateFromString(J.target.value,R.options.format);me&&R.setValue(me)}},Oe=function(){var J=oe.querySelector(".jcalendar-selected");J&&J.classList.contains("jcalendar-disabled")?(W.setAttribute("disabled","disabled"),z.setAttribute("disabled","disabled"),ie.setAttribute("disabled","disabled")):(W.removeAttribute("disabled"),z.removeAttribute("disabled"),ie.removeAttribute("disabled")),typeof R.options.onupdate=="function"&&R.options.onupdate(X,R.getValue())},oe=null,ee=null,fe=null,Re=null,$e=null,Je=null,Be=null,ot=null,gt=null,b=null,q=null,F=null,W=null,z=null,ie=null,_e=function(){X.tagName=="INPUT"&&X.value&&(P.value=X.value),ee=document.createElement("div"),ee.className="jcalendar-reset",fe=document.createElement("div"),fe.className="jcalendar-confirm",b=document.createElement("div"),b.className="jcalendar-controls",b.style.borderBottom="1px solid #ddd",b.appendChild(ee),b.appendChild(fe),Re=document.createElement("div"),Re.className="jcalendar-container",$e=document.createElement("div"),$e.className="jcalendar-content",Re.appendChild($e),X.tagName=="DIV"?(oe=X,oe.classList.add("jcalendar-inline")):($e.appendChild(b),oe=document.createElement("div"),oe.className="jcalendar"),oe.classList.add("jcalendar-container"),oe.appendChild(Re);var J=document.createElement("div");J.className="jcalendar-table",$e.appendChild(J);var me=document.createElement("td");me.setAttribute("colspan","2"),me.className="jcalendar-prev",Je=document.createElement("span"),Je.className="jcalendar-year",Be=document.createElement("span"),Be.className="jcalendar-month";var L=document.createElement("td");L.className="jcalendar-header",L.setAttribute("colspan","3"),L.appendChild(Be),L.appendChild(Je);var Z=document.createElement("td");Z.setAttribute("colspan","2"),Z.className="jcalendar-next";var de=document.createElement("thead"),Ee=document.createElement("tr");Ee.appendChild(me),Ee.appendChild(L),Ee.appendChild(Z),de.appendChild(Ee),ot=document.createElement("table"),gt=document.createElement("tbody"),ot.setAttribute("cellpadding","0"),ot.setAttribute("cellspacing","0"),ot.appendChild(de),ot.appendChild(gt),J.appendChild(ot),z=document.createElement("select"),z.className="jcalendar-select",z.onchange=function(){R.date[3]=this.value,typeof R.options.onupdate=="function"&&R.options.onupdate(X,R.getValue())};for(var ye=0;ye<24;ye++){var Ge=document.createElement("option");Ge.value=ye,Ge.innerHTML=m.two(ye),z.appendChild(Ge)}ie=document.createElement("select"),ie.className="jcalendar-select",ie.onchange=function(){R.date[4]=this.value,typeof R.options.onupdate=="function"&&R.options.onupdate(X,R.getValue())};for(var ye=0;ye<60;ye++){var Ge=document.createElement("option");Ge.value=ye,Ge.innerHTML=m.two(ye),ie.appendChild(Ge)}var tt=document.createElement("div");tt.className="jcalendar-controls",q=document.createElement("div"),q.className="jcalendar-time",q.style.maxWidth="140px",q.appendChild(z),q.appendChild(ie),W=document.createElement("button"),W.setAttribute("type","button"),W.className="jcalendar-update",F=document.createElement("div"),F.style.flexGrow="10",F.appendChild(W),tt.appendChild(q),X.tagName=="INPUT"&&tt.appendChild(F),$e.appendChild(tt);var ft=document.createElement("div");ft.className="jcalendar-backdrop",oe.appendChild(ft),X.addEventListener("keyup",Pe),oe.addEventListener("swipeleft",function(We){D.slideLeft(ot,0,function(){R.next(),D.slideRight(ot,1)}),We.preventDefault(),We.stopPropagation()}),oe.addEventListener("swiperight",function(We){D.slideRight(ot,0,function(){R.prev(),D.slideLeft(ot,1)}),We.preventDefault(),We.stopPropagation()}),"ontouchend"in document.documentElement?(oe.addEventListener("touchend",ae),X.addEventListener("touchend",R.open)):(oe.addEventListener("mouseup",ae),X.addEventListener("mouseup",R.open)),j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),R.setOptions(P),X.tagName=="INPUT"?(X.parentNode.insertBefore(oe,X.nextSibling),X.setAttribute("autocomplete","off"),X.classList.add("jcalendar-input"),X.value=R.setLabel(R.getValue(),R.options)):(R.getDays(),R.options.time&&(z.value=R.date[3],ie.value=R.date[4])),R.options.opened==!0&&R.open(),R.options.controls==!1&&Re.classList.add("jcalendar-hide-controls"),X.change=R.setValue,X.val=function(We){if(We===void 0)return R.getValue();R.setValue(We)},X.calendar=oe.calendar=R};return _e(),R};return j.keydown=function(X){var P=null;(P=j.current)&&(X.which==13?P.close(!1,!0):X.which==27&&P.close(!1,!1))},j.prettify=function(X,P){if(!P)var P={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};X.indexOf("GMT")===-1&&X.indexOf("Z")===-1&&(X+=" GMT");var R=new Date,ae=new Date(X),Pe=parseInt((R-ae)/1e3/60);if(String.prototype.format=function(oe){return this.replace("{0}",oe)},Pe==0)var Oe=P.justNow;else if(Pe<90)var Oe=P.xMinutesAgo.format(Pe);else if(Pe<1440)var Oe=P.xHoursAgo.format(Math.round(Pe/60));else if(Pe<20160)var Oe=P.xDaysAgo.format(Math.round(Pe/1440));else if(Pe<43200)var Oe=P.xWeeksAgo.format(Math.round(Pe/10080));else if(Pe<1036800)var Oe=P.xMonthsAgo.format(Math.round(Pe/43200));else var Oe=P.xYearsAgo.format(Math.round(Pe/525600));return Oe},j.prettifyAll=function(){for(var X=document.querySelectorAll(".prettydate"),P=0;P<X.length;P++)X[P].getAttribute("data-date")?X[P].innerHTML=j.prettify(X[P].getAttribute("data-date")):X[P].innerHTML&&(X[P].setAttribute("title",X[P].innerHTML),X[P].setAttribute("data-date",X[P].innerHTML),X[P].innerHTML=j.prettify(X[P].innerHTML))},j.now=H.now,j.toArray=H.toArray,j.dateToNum=H.dateToNum,j.numToDate=H.numToDate,j.weekdays=H.weekdays,j.months=H.months,j.weekdaysShort=H.weekdaysShort,j.monthsShort=H.monthsShort,j.extractDateFromString=K.extractDateFromString,j.getDateString=K.getDateString,j}var re=se();function Ce(){var j={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},X=function(P){return j[P]?j[P]:j.material};return X.get=function(P){return j[P]?j[P]:j},X.set=function(P,R){j[P]=R},X}var Le=Ce();function he(j,X){var P={};P.options={};var R={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var ae in R)X&&X.hasOwnProperty(ae)?P.options[ae]=X[ae]:P.options[ae]=R[ae];j.classList.add("jtabs");var Pe=null,Oe=null,oe=null;const ee=function(Be){P.options.animation&&setTimeout(function(){let ot=P.headers.children[Be].getBoundingClientRect();P.options.palette==="modern"?(oe.style.width=ot.width-4+"px",oe.style.left=P.headers.children[Be].offsetLeft+2+"px"):(oe.style.width=ot.width+"px",oe.style.left=P.headers.children[Be].offsetLeft+"px"),P.options.position==="bottom"?oe.style.top="0px":oe.style.bottom="0px"},50)};var fe=function(Be){typeof P.headers.scrollTo=="function"?P.headers.scrollTo({left:Be,behavior:"smooth"}):P.headers.scrollLeft=Be,Be<=1?Pe.classList.add("disabled"):Pe.classList.remove("disabled"),Be>=P.headers.scrollWidth-P.headers.offsetWidth?Oe.classList.add("disabled"):Oe.classList.remove("disabled"),P.headers.scrollWidth<=P.headers.offsetWidth?(Pe.style.display="none",Oe.style.display="none"):(Pe.style.display="",Oe.style.display="")};if(P.setBorder=ee,P.open=function(Be){if(Array.from(P.content.children),!!P.content.children[Be]){for(var ot=null,gt=0;gt<P.headers.children.length;gt++)P.headers.children[gt].classList.contains("jtabs-selected")&&(ot=gt),P.headers.children[gt].classList.remove("jtabs-selected"),P.content.children[gt]&&P.content.children[gt].classList.remove("jtabs-selected");if(P.headers.children[Be].classList.add("jtabs-selected"),P.content.children[Be]&&P.content.children[Be].classList.add("jtabs-selected"),ot!=Be&&typeof P.options.onchange=="function"&&P.content.children[Be]&&P.options.onchange(j,P,Be,P.headers.children[Be],P.content.children[Be]),P.options.hideHeaders==!0&&P.headers.children.length<3&&P.options.allowCreate==!1)P.headers.parentNode.style.display="none";else{P.headers.parentNode.style.display="";var b=P.headers.children[Be].offsetLeft,q=b+P.headers.children[Be].offsetWidth,F=P.headers.scrollLeft,W=F+P.headers.offsetWidth;F<=b&&W>=q||fe(b-1),ee(Be)}}},P.selectIndex=function(Be){var ot=Array.prototype.indexOf.call(P.headers.children,Be);return ot>=0&&P.open(ot),ot},P.rename=function(Be,ot){ot||(ot=prompt("New title",P.headers.children[Be].innerText)),P.headers.children[Be].innerText=ot,ee(P.getActive())},P.create=function(Be,ot){if(typeof P.options.onbeforecreate=="function"){var gt=P.options.onbeforecreate(j,Be);if(gt===!1)return!1;Be=gt}var b=P.appendElement(Be);return typeof P.options.oncreate=="function"&&P.options.oncreate(j,b),ee(P.getActive()),b},P.remove=function(Be){return P.deleteElement(Be)},P.nextNumber=function(){for(var Be=0,ot=0;ot<P.headers.children.length;ot++){var gt=P.headers.children[ot].innerText.match(/[0-9].*/);gt>Be&&(Be=parseInt(gt))}return Be?Be++:Be=1,Be},P.deleteElement=function(Be){let ot=P.getActive();if(P.headers.children[Be])P.headers.removeChild(P.headers.children[Be]),P.content.removeChild(P.content.children[Be]);else return!1;if(ot===Be)P.open(0);else{let gt=P.getActive()||0;ee(gt)}typeof P.options.ondelete=="function"&&P.options.ondelete(j,Be)},P.appendElement=function(Be,ot,gt,b){if(!Be)var Be=prompt("Title?","");if(Be){var q=document.createElement("div"),F=document.createElement("div");if(F.innerHTML=Be,F.content=q,typeof b>"u")P.content.appendChild(q),P.headers.insertBefore(F,P.headers.lastChild);else{let W=P.content.children[b];W?P.content.insertBefore(q,W):P.content.appendChild(q),W=P.headers.children[b]||P.headers.lastChild,P.headers.insertBefore(F,W)}return P.options.allowChangePosition&&F.setAttribute("draggable","true"),gt!==!1&&P.selectIndex(F),typeof ot=="function"&&ot(q,F),q}},P.getActive=function(){for(var Be=0;Be<P.headers.children.length;Be++)if(P.headers.children[Be].classList.contains("jtabs-selected"))return Be;return!1},P.updateContent=function(Be,ot){if(typeof ot!="string")var gt=ot;else{var gt=document.createElement("div");gt.innerHTML=ot}P.content.children[Be].classList.contains("jtabs-selected")&&ot.classList.add("jtabs-selected"),P.content.replaceChild(ot,P.content.children[Be]),ee()},P.updatePosition=function(Be,ot,gt,b){if(Be>ot?P.content.insertBefore(P.content.children[Be],P.content.children[ot]):P.content.insertBefore(P.content.children[Be],P.content.children[ot].nextSibling),b!==!1)P.open(ot);else{const q=P.getActive();ot<q&&P.setBorder(q)}!gt&&typeof P.options.onchangeposition=="function"&&P.options.onchangeposition(P.headers,Be,ot)},P.move=function(Be,ot,gt,b){Be>ot?P.headers.insertBefore(P.headers.children[Be],P.headers.children[ot]):P.headers.insertBefore(P.headers.children[Be],P.headers.children[ot].nextSibling),P.updatePosition(Be,ot,gt,b)},P.setBorder=ee,P.init=function(){j.innerHTML="",P.headers=document.createElement("div"),P.content=document.createElement("div"),P.headers.classList.add("jtabs-headers"),P.content.classList.add("jtabs-content"),P.options.palette?j.classList.add("jtabs-modern"):j.classList.remove("jtabs-modern"),P.options.padding&&(P.content.style.padding=parseInt(P.options.padding)+"px");var Be=document.createElement("div");Be.className="jtabs-headers-container",Be.appendChild(P.headers),P.options.maxWidth&&(Be.style.maxWidth=parseInt(P.options.maxWidth)+"px");var ot=document.createElement("div");if(ot.className="jtabs-controls",ot.setAttribute("draggable","false"),Be.appendChild(ot),P.options.position=="bottom"?(j.appendChild(P.content),j.appendChild(Be)):(j.appendChild(Be),j.appendChild(P.content)),P.options.allowCreate==!0){var gt=document.createElement("div");gt.className="jtabs-add",gt.onclick=function(){P.create()},ot.appendChild(gt)}Pe=document.createElement("div"),Pe.className="jtabs-prev",Pe.onclick=function(){fe(P.headers.scrollLeft-P.headers.offsetWidth)},ot.appendChild(Pe),Oe=document.createElement("div"),Oe.className="jtabs-next",Oe.onclick=function(){fe(P.headers.scrollLeft+P.headers.offsetWidth)},ot.appendChild(Oe);for(var b=0;b<P.options.data.length;b++){if(P.options.data[b].titleElement)var q=P.options.data[b].titleElement;else var q=document.createElement("div");if(P.options.data[b].icon){var F=document.createElement("div"),W=document.createElement("i");W.classList.add("material-icons"),W.innerHTML=P.options.data[b].icon,F.appendChild(W),q.appendChild(F)}if(P.options.data[b].title){var z=document.createTextNode(P.options.data[b].title);q.appendChild(z)}if(P.options.data[b].width&&(q.style.width=P.options.data[b].width),P.options.data[b].contentElement)var ie=P.options.data[b].contentElement;else{var ie=document.createElement("div");ie.innerHTML=P.options.data[b].content}P.headers.appendChild(q),P.content.appendChild(ie)}oe=document.createElement("div"),oe.className="jtabs-border",P.headers.appendChild(oe),P.options.animation&&j.classList.add("jtabs-animation"),P.headers.addEventListener("click",function(_e){if(_e.target.parentNode.classList.contains("jtabs-headers"))var J=_e.target;else if(_e.target.tagName=="I")var J=_e.target.parentNode.parentNode;else var J=_e.target.parentNode;var me=P.selectIndex(J);typeof P.options.onclick=="function"&&P.options.onclick(j,P,me,P.headers.children[me],P.content.children[me])}),P.headers.addEventListener("contextmenu",function(_e){P.selectIndex(_e.target)}),P.headers.children.length&&P.open(0),fe(0),P.options.allowChangePosition==!0&&_(P.headers,{direction:1,ondrop:function(_e,J,me){P.updatePosition(J,me)}}),typeof P.options.onload=="function"&&P.options.onload(j,P)},j.children[0]&&j.children[0].children.length)for(var Re=0;Re<j.children[0].children.length;Re++){var $e=P.options.data&&P.options.data[Re]?P.options.data[Re]:{};j.children[1]&&j.children[1].children[Re]?($e.titleElement=j.children[0].children[Re],$e.contentElement=j.children[1].children[Re]):$e.contentElement=j.children[0].children[Re],P.options.data[Re]=$e}var Je=!1;if(P.options.data)for(var Re=0;Re<P.options.data.length;Re++)P.options.data[Re].url&&(A({url:P.options.data[Re].url,type:"GET",dataType:"text/html",index:Re,success:function(ot){P.options.data[this.index].content=ot},complete:function(){P.init()}}),Je=!0);return Je||P.init(),j.tabs=P,P}function ve(j,X){if(j.color)return j.color.setOptions(X,!0);var P={type:"color"};P.options={};var R=null,ae=null,Pe=null,Oe=null,oe=null,ee=null,fe=null;P.setOptions=function(L,Z){var de={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};L||(L={}),L&&!L.palette&&(L.palette=Le());for(var Ee in de)L&&L.hasOwnProperty(Ee)?P.options[Ee]=L[Ee]:(typeof P.options[Ee]>"u"||Z===!0)&&(P.options[Ee]=de[Ee]);return Oe&&(Oe.innerHTML=P.options.resetLabel),oe&&(oe.innerHTML=P.options.doneLabel),P.options.palette&&fe&&fe.updateContent(0,ot()),typeof P.options.value=="string"&&(j.value=P.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value)),P.options.placeholder?j.setAttribute("placeholder",P.options.placeholder):j.getAttribute("placeholder")&&j.removeAttribute("placeholder"),P},P.select=function(L){var Z=R.querySelector(".jcolor-selected");Z&&Z.classList.remove("jcolor-selected"),P.values[L]&&P.values[L].classList.add("jcolor-selected"),P.options.value=L},P.open=function(){if(!R.classList.contains("jcolor-focus")){g(P,!0),R.classList.add("jcolor-focus"),P.options.value&&P.select(P.options.value),Pe.style.marginTop="",Pe.style.marginLeft="";var L=Pe.getBoundingClientRect(),Z=m.getWindowWidth(),de=m.getWindowHeight();if(Z<800||P.options.fullscreen==!0?(Pe.classList.add("jcolor-fullscreen"),D.slideBottom(Pe,1),ae.style.display="block"):(Pe.classList.contains("jcolor-fullscreen")&&(Pe.classList.remove("jcolor-fullscreen"),ae.style.display=""),P.options.position?Pe.style.position="fixed":Pe.style.position="",L.left+L.width>Z&&(Pe.style.marginLeft=-1*(L.left+L.width-(Z-20))+"px"),L.top+L.height>de&&(Pe.style.marginTop=-1*(L.top+L.height-(de-20))+"px")),typeof P.options.onopen=="function"&&P.options.onopen(j,P),fe.setBorder(fe.getActive()),P.options.value){var Ee=Be(P.options.value);ie.forEach(function(ye,Ge){ye.value=Ee[Ge],ye.dispatchEvent(new Event("input"))})}}},P.close=function(L){return R.classList.contains("jcolor-focus")&&(R.classList.remove("jcolor-focus"),ae.style.display="",!L&&typeof P.options.onclose=="function"&&P.options.onclose(j,P),g(P,!1)),P.options.value},P.setValue=function(L){L||(L=""),L!=P.options.value&&(P.options.value=L,z=L,P.select(L),typeof P.options.onchange=="function"&&P.options.onchange(j,L,P),j.value!=P.options.value&&(j.value=P.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value),typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),P.options.closeOnChange==!0&&P.close())},P.getValue=function(){return P.options.value};var Re=function(L){var Z=L.toString(16);return Z.length===1?"0"+Z:Z},$e=function(L,Z,de){return"#"+Re(L)+Re(Z)+Re(de)},Je=function(L){return parseInt("0x"+L)},Be=function(L){return[Je(L.substr(1,2)),Je(L.substr(3,2)),Je(L.substr(5,2))]},ot=function(){var L=document.createElement("div");L.className="jcolor-grid",P.values=[];var Z=document.createElement("table");Z.setAttribute("cellpadding","7"),Z.setAttribute("cellspacing","0");for(var de=0;de<P.options.palette.length;de++){for(var Ee=document.createElement("tr"),ye=0;ye<P.options.palette[de].length;ye++){var Ge=document.createElement("td"),tt=P.options.palette[de][ye];tt.length<7&&tt.substr(0,1)!=="#"&&(tt="#"+tt),Ge.style.backgroundColor=tt,Ge.setAttribute("data-value",tt),Ge.innerHTML="",Ee.appendChild(Ge),P.options.value==tt&&Ge.classList.add("jcolor-selected"),P.values[tt]=Ge}Z.appendChild(Ee)}return L.appendChild(Z),L},gt=document.createElement("canvas");gt.width=200,gt.height=160;var b=gt.getContext("2d"),q=function(){var L=ee.firstChild.getBoundingClientRect();gt.width=L.width-14,F()},F=function(){var L=b.createLinearGradient(0,0,gt.width,0);L.addColorStop(0,"rgb(255,0,0)"),L.addColorStop(.15,"rgb(255,0,255)"),L.addColorStop(.33,"rgb(0,0,255)"),L.addColorStop(.49,"rgb(0,255,255)"),L.addColorStop(.67,"rgb(0,255,0)"),L.addColorStop(.84,"rgb(255,255,0)"),L.addColorStop(1,"rgb(255,0,0)"),b.fillStyle=L,b.fillRect(0,0,gt.width,gt.height),L=b.createLinearGradient(0,0,0,gt.height),L.addColorStop(0,"rgba(255,255,255,1)"),L.addColorStop(.5,"rgba(255,255,255,0)"),L.addColorStop(.5,"rgba(0,0,0,0)"),L.addColorStop(1,"rgba(0,0,0,1)"),b.fillStyle=L,b.fillRect(0,0,gt.width,gt.height)},W=function(){var L=document.createElement("div");L.className="jcolor-hsl";var Z=document.createElement("div");Z.className="jcolor-point";var de=document.createElement("div");de.appendChild(gt),de.appendChild(Z),L.appendChild(de);var Ee=function(ye,Ge,tt){if(ye===1){var ft=L.getBoundingClientRect(),We=Ge-ft.left,yt=tt-ft.top;We<0&&(We=0),yt<0&&(yt=0),We>ft.width&&(We=ft.width),yt>ft.height&&(yt=ft.height),Z.style.left=We+"px",Z.style.top=yt+"px";var Ct=b.getImageData(We,yt,1,1).data;z=$e(Ct[0],Ct[1],Ct[2])}};return L.addEventListener("mousedown",function(ye){Ee(ye.buttons,ye.clientX,ye.clientY)}),L.addEventListener("mousemove",function(ye){Ee(ye.buttons,ye.clientX,ye.clientY)}),L.addEventListener("touchmove",function(ye){Ee(1,ye.changedTouches[0].clientX,ye.changedTouches[0].clientY)}),L},z="",ie=[],_e=function(){if(z!=="")for(var L=0;L<ie.length;L++){var Z=Be(z);Z[L]=0;var de="linear-gradient(90deg, rgb(";de+=Z.join(", "),de+="), rgb(",Z[L]=255,de+=Z.join(", "),de+="))",ie[L].style.backgroundImage=de}},J=function(){var L=document.createElement("div");L.className="jcolor-sliders";var Z=document.createElement("div"),de=function(tt){var ft=document.createElement("div");ft.className="jcolor-sliders-input-container";var We=document.createElement("label");We.innerText=tt;var yt=document.createElement("div");yt.className="jcolor-sliders-input-subcontainer";var Ct=document.createElement("input");Ct.type="range",Ct.min=0,Ct.max=255,Ct.value=0,ft.appendChild(We),yt.appendChild(Ct);var Mt=document.createElement("div");return Mt.innerText=Ct.value,Ct.addEventListener("input",function(){Mt.innerText=Ct.value}),yt.appendChild(Mt),ft.appendChild(yt),Z.appendChild(ft),Ct};ie=[de("Red"),de("Green"),de("Blue")],L.appendChild(Z);var Ee=document.createElement("div");Ee.className="jcolor-sliders-final-color";var ye=document.createElement("div");ye.style.visibility="hidden",ye.innerText="a",Ee.appendChild(ye);var Ge=function(){var tt=$e(parseInt(ie[0].value),parseInt(ie[1].value),parseInt(ie[2].value));ye.innerText=tt,ye.style.color=tt,ye.style.removeProperty("visibility"),z=tt};return ie.forEach(function(tt){tt.addEventListener("input",function(){Ge(),_e()})}),L.appendChild(Ee),L},me=function(){P.setOptions(X),j.tagName=="INPUT"&&(j.classList.add("jcolor-input"),j.readOnly=!0),R=document.createElement("div"),R.className="jcolor",ae=document.createElement("div"),ae.className="jcolor-backdrop",R.appendChild(ae),Pe=document.createElement("div"),Pe.className="jcolor-content";var L=document.createElement("div");L.className="jcolor-controls",Pe.appendChild(L),Oe=document.createElement("div"),Oe.className="jcolor-reset",Oe.innerHTML=P.options.resetLabel,L.appendChild(Oe),oe=document.createElement("div"),oe.className="jcolor-close",oe.innerHTML=P.options.doneLabel,L.appendChild(oe),ee=document.createElement("div"),Pe.appendChild(ee),fe=he(ee,{animation:!0,data:[{title:"Grid",contentElement:ot()},{title:"Spectrum",contentElement:W()},{title:"Sliders",contentElement:J()}],onchange:function(Z,de,Ee){if(Ee===1)q();else{var ye=z!==""?z:P.getValue();if(Ee===2&&ye){var Ge=Be(ye);ie.forEach(function(tt,ft){tt.value=Ge[ft],tt.dispatchEvent(new Event("input"))})}}},palette:"modern"}),R.appendChild(Pe),j.tagName=="INPUT"?j.parentNode.insertBefore(R,j.nextSibling):j.appendChild(R),R.addEventListener("click",function(Z){if(Z.target.tagName=="TD"){var de=Z.target.getAttribute("data-value");de&&P.setValue(de)}else Z.target.classList.contains("jcolor-reset")?(P.setValue(""),P.close()):Z.target.classList.contains("jcolor-close")?(fe.getActive()>0&&P.setValue(z),P.close()):Z.target.classList.contains("jcolor-backdrop")?P.close():P.open()}),j.addEventListener("mouseup",function(Z){P.open()}),window.addEventListener("resize",function(){R.classList.contains("jcolor-focus")&&fe.getActive()==1&&q()}),P.options.opened==!0&&P.open(),j.change=P.setValue,j.val=function(Z){if(Z===void 0)return P.getValue();P.setValue(Z)},j.color=P,R.color=P};return P.toHex=function(L){var Z=function(de){return("0"+parseInt(de).toString(16)).slice(-2)};if(L)return/^#[0-9A-F]{6}$/i.test(L)?L:(L=L.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),L&&L.length?"#"+Z(L[1])+Z(L[2])+Z(L[3]):"")},me(),P}function xe(){var j=function(X,P){var R={type:"contextmenu"};R.options={};var ae={items:null,onclick:null};for(var Pe in ae)P&&P.hasOwnProperty(Pe)?R.options[Pe]=P[Pe]:R.options[Pe]=ae[Pe];X.classList.add("jcontextmenu"),R.open=function(ee,fe){if(fe&&(R.options.items=fe,R.create(fe)),j.current&&j.current.close(),g(R,!0),X.classList.add("jcontextmenu-focus"),j.current=R,R.options.items&&R.options.items.length>0||X.children.length){if(ee.target)if(ee.changedTouches&&ee.changedTouches[0])Re=ee.changedTouches[0].clientX,$e=ee.changedTouches[0].clientY;else var Re=ee.clientX,$e=ee.clientY;else var Re=ee.x,$e=ee.y;var Je=X.getBoundingClientRect();if(window.innerHeight<$e+Je.height){var Be=$e-Je.height;Be<0&&(Be=0),X.style.top=Be+"px"}else X.style.top=$e+"px";window.innerWidth<Re+Je.width?Re-Je.width>0?X.style.left=Re-Je.width+"px":X.style.left="10px":X.style.left=Re+"px"}},R.isOpened=function(){return!!X.classList.contains("jcontextmenu-focus")},R.close=function(){X.classList.contains("jcontextmenu-focus")&&X.classList.remove("jcontextmenu-focus"),g(R,!1)},R.create=function(ee){X.innerHTML="";var fe=Oe();X.appendChild(fe);for(var Re=0;Re<ee.length;Re++){var $e=oe(ee[Re]);X.appendChild($e)}};function Oe(){var ee=document.createElement("div");ee.classList.add("header"),ee.addEventListener("click",function($e){$e.preventDefault(),$e.stopPropagation()});var fe=document.createElement("a");fe.classList.add("title"),fe.innerHTML=c.translate("Menu"),ee.appendChild(fe);var Re=document.createElement("a");return Re.classList.add("close"),Re.innerHTML=c.translate("close"),Re.addEventListener("click",function($e){R.close()}),ee.appendChild(Re),ee}function oe(ee){if(ee.type&&(ee.type=="line"||ee.type=="divisor"))var fe=document.createElement("hr");else{var fe=document.createElement("div"),Re=document.createElement("a");if(Re.innerHTML=ee.title,ee.tooltip&&fe.setAttribute("title",ee.tooltip),ee.icon&&fe.setAttribute("data-icon",ee.icon),ee.id&&(fe.id=ee.id),ee.disabled?fe.className="jcontextmenu-disabled":ee.onclick&&(fe.method=ee.onclick,fe.addEventListener("mousedown",function(F){F.preventDefault()}),fe.addEventListener("mouseup",function(F){this.method(this,F)})),fe.appendChild(Re),ee.submenu){var $e=document.createElement("span");$e.innerHTML="&#9658;",fe.appendChild($e),fe.classList.add("jcontexthassubmenu");var Je=document.createElement("div");Je.classList.add("jcontextmenu"),Je.setAttribute("tabindex","900");for(var Be=ee.submenu,ot=0;ot<Be.length;ot++){var gt=oe(Be[ot]);Je.appendChild(gt)}fe.appendChild(Je)}else if(ee.shortcut){var b=document.createElement("span");b.innerHTML=ee.shortcut,fe.appendChild(b)}}return fe}return typeof R.options.onclick=="function"&&X.addEventListener("click",function(ee){R.options.onclick(R,ee)}),R.options.items&&R.create(R.options.items),window.addEventListener("mousewheel",function(){R.close()}),X.contextmenu=R,R};return j}var Ie=xe();function we(){var j=function(X,P){if(X.dropdown)return X.dropdown.setOptions(P,!0);var R={type:"dropdown"};R.options={};var ae=function(J,me){J&&J.length&&(R.options.sortResults!==!1&&(typeof R.options.sortResults=="function"?J.sort(R.options.sortResults):J.sort(Pe)),R.setData(J)),typeof R.options.onload=="function"&&R.options.onload(X,R,J,me),me&&oe(me),me==null&&(R.options.value=""),X.value=R.options.value,R.options.opened==!0&&R.open()},Pe=function(J,me){var L,Z;return typeof J=="string"?L=J:J.text?L=J.text:J.name&&(L=J.name),typeof me=="string"?Z=me:me.text?Z=me.text:me.name&&(Z=me.name),typeof L=="string"||typeof Z=="string"?(typeof L!="string"&&(L=""+L),typeof Z!="string"&&(Z=""+Z),L.localeCompare(Z)):L-Z},Oe=function(){R.value={};for(var J=0;J<R.items.length;J++)R.items[J].selected==!0&&(R.items[J].element&&R.items[J].element.classList.remove("jdropdown-selected"),R.items[J].selected=null);R.options.value="",X.value=""},oe=function(J){if(Oe(),J!==null)if(!J)typeof R.value[""]<"u"&&(R.value[""]="");else{Array.isArray(J)||(J=(""+J).split(";"));for(var me=0;me<J.length;me++)R.value[J[me]]=""}for(var me=0;me<R.items.length;me++)typeof R.value[ee(me)]<"u"&&(R.items[me].element&&R.items[me].element.classList.add("jdropdown-selected"),R.items[me].selected=!0,R.value[ee(me)]=fe(me));R.options.value=Object.keys(R.value).join(";"),R.header.value=R.getText()},ee=function(J,me){if(R.options.format)var L="id";else var L="value";return R.items[J]?R.items[J].data[L]:""},fe=function(J,me){if(R.options.format)var L="name";else var L="text";return R.items[J]?R.items[J].data[L]:""},Re=function(){return Object.keys(R.value)},$e=function(){for(var J=[],me=Object.keys(R.value),L=0;L<me.length;L++)J.push(R.value[me[L]]);return J};R.setOptions=function(J,me){J||(J={});var L={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var Z in L)J&&J.hasOwnProperty(Z)?R.options[Z]=J[Z]:(typeof R.options[Z]>"u"||me===!0)&&(R.options[Z]=L[Z]);return(R.options.remoteSearch==!0||R.options.type==="searchbar")&&(R.options.autocomplete=!0),R.options.newOptions==!0?R.header.classList.add("jdropdown-add"):R.header.classList.remove("jdropdown-add"),R.options.autocomplete==!0?R.header.removeAttribute("readonly"):R.header.setAttribute("readonly","readonly"),R.options.placeholder?R.header.setAttribute("placeholder",R.options.placeholder):R.header.removeAttribute("placeholder"),X.classList.remove("jdropdown-searchbar"),X.classList.remove("jdropdown-picker"),X.classList.remove("jdropdown-list"),R.options.type=="searchbar"?X.classList.add("jdropdown-searchbar"):R.options.type=="list"?X.classList.add("jdropdown-list"):R.options.type=="picker"?X.classList.add("jdropdown-picker"):m.getWindowWidth()<800?R.options.autocomplete?(X.classList.add("jdropdown-searchbar"),R.options.type="searchbar"):(X.classList.add("jdropdown-picker"),R.options.type="picker"):(R.options.width?(X.style.width=R.options.width,X.style.minWidth=R.options.width):(X.style.removeProperty("width"),X.style.removeProperty("min-width")),X.classList.add("jdropdown-default"),R.options.type="default"),R.options.type=="searchbar"?Je.appendChild(gt):Be.insertBefore(gt,Be.firstChild),R.options.url&&!J.data?A({url:R.options.url,method:"GET",dataType:"json",success:function(de){de&&ae(de,R.options.value)}}):ae(R.options.data,R.options.value),R};var Je=null,Be=null,ot=null,gt=null,b=null,q=null,F=null,W=function(){if(P||(P={}),X.tagName=="SELECT"){var J=j.extractFromDom(X,P);X=J.el,P=J.options}!P.placeholder&&X.getAttribute("placeholder")&&(P.placeholder=X.getAttribute("placeholder")),R.value={},R.items=[],R.groups=[],R.search="",R.results=null,X.classList.add("jdropdown"),Je=document.createElement("div"),Je.className="jdropdown-container-header",R.header=document.createElement("input"),R.header.className="jdropdown-header jss_object",R.header.type="text",R.header.setAttribute("autocomplete","off"),R.header.onfocus=function(){typeof R.options.onfocus=="function"&&R.options.onfocus(X)},R.header.onblur=function(){typeof R.options.onblur=="function"&&R.options.onblur(X)},R.header.onkeyup=function(me){R.options.autocomplete==!0&&!F?(R.search!=R.header.value.trim()&&(F=setTimeout(function(){R.find(R.header.value.trim()),F=null},400)),X.classList.contains("jdropdown-focus")||R.open()):R.options.autocomplete||R.next(me.key)},j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),Be=document.createElement("div"),Be.className="jdropdown-container",ot=document.createElement("div"),ot.className="jdropdown-content",gt=document.createElement("div"),gt.className="jdropdown-close",gt.textContent="Done",b=document.createElement("div"),b.className="jdropdown-reset",b.textContent="x",b.onclick=function(){R.reset(),R.close()},q=document.createElement("div"),q.className="jdropdown-backdrop",Je.appendChild(R.header),Be.appendChild(ot),X.appendChild(Je),X.appendChild(Be),X.appendChild(q),R.setOptions(P),"ontouchsend"in document.documentElement?X.addEventListener("touchsend",j.mouseup):X.addEventListener("mouseup",j.mouseup),R.options.lazyLoading==!0&&S(ot,{loadUp:R.loadUp,loadDown:R.loadDown}),ot.onwheel=function(me){me.stopPropagation()},X.change=R.setValue,X.val=function(me){if(me===void 0)return R.getValue(!!R.options.multiple);R.setValue(me)},X.dropdown=R};R.getUrl=function(){return R.options.url},R.setUrl=function(J,me){R.options.url=J,A({url:R.options.url,method:"GET",dataType:"json",success:function(L){R.setData(L),typeof me=="function"&&me(R)}})},R.setId=function(J,me){if(R.options.format)var L="id";else var L="value";typeof J=="object"?J[L]=me:R.items[J].data[L]=me};const z=function(J,me){if(!J){let de=R.options.autocomplete==!0?R.header.value:"";if(J=prompt(c.translate("Add A New Option"),de),!J)return!1}if(me||(me=m.guid()),R.options.format)var L={id:me,name:J};else var L={value:me,text:J};if(typeof R.options.onbeforeinsert=="function"){let de=R.options.onbeforeinsert(R,L);if(de===!1)return!1;de&&(L=de)}R.options.data.push(L);var Z=R.createItem(L);return ot.appendChild(Z.element),typeof R.options.oninsert=="function"&&R.options.oninsert(R,L,Z),ot.style.display=="none"&&(ot.style.display=""),R.results&&R.results.push(Z),L};R.add=function(J,me){return typeof R.options.prompt=="function"?R.options.prompt.call(R,z):z(J,me)},R.createItem=function(J,me,L){R.options.format?(!J.id&&J.value!==void 0&&(J.id=J.value),!J.name&&J.text!==void 0&&(J.name=J.text)):(!J.value&&J.id!==void 0&&(J.value=J.id),!J.text&&J.name!==void 0&&(J.text=J.name));var Z={};if(Z.element=document.createElement("div"),Z.element.className="jdropdown-item",Z.element.indexValue=R.items.length,Z.data=J,me&&(Z.group=me),J.id&&Z.element.setAttribute("id",J.id),J.disabled==!0&&Z.element.setAttribute("data-disabled",!0),J.tooltip&&Z.element.setAttribute("title",J.tooltip),J.image){var de=document.createElement("img");de.className="jdropdown-image",de.src=J.image,J.title||de.classList.add("jdropdown-image-small"),Z.element.appendChild(de)}else if(J.icon){var Ee=document.createElement("span");Ee.className="jdropdown-icon material-icons",Ee.innerText=J.icon,J.title||Ee.classList.add("jdropdown-icon-small"),J.color&&(Ee.style.color=J.color),Z.element.appendChild(Ee)}else if(J.color){var ye=document.createElement("div");ye.className="jdropdown-color",ye.style.backgroundColor=J.color,Z.element.appendChild(ye)}if(R.options.format)var Ge=J.name;else var Ge=J.text;var tt=document.createElement("div");if(tt.className="jdropdown-description",tt.textContent=Ge||"&nbsp;",J.title){var ft=document.createElement("div");ft.className="jdropdown-title",ft.innerText=J.title,tt.appendChild(ft)}if(R.options.format)var We=J.id;else var We=J.value;return R.value[We]&&(Z.element.classList.add("jdropdown-selected"),Z.selected=!0),R.items.push(Z),Z.element.appendChild(tt),Z},R.appendData=function(J){if(J.length){for(var me=[],L=[],Z=0;Z<J.length;Z++)J[Z].group?(L[J[Z].group]||(L[J[Z].group]=[]),L[J[Z].group].push(Z)):me.push(Z);var de=0,Ee=Object.keys(L);if(Ee.length>0)for(var Z=0;Z<Ee.length;Z++){var ye=document.createElement("div");ye.className="jdropdown-group";var Ge=document.createElement("div");Ge.className="jdropdown-group-name",Ge.textContent=Ee[Z];var tt=document.createElement("i");tt.className="jdropdown-group-arrow jdropdown-group-arrow-down",Ge.appendChild(tt);var ft=document.createElement("div");ft.className="jdropdown-group-items";for(var We=0;We<L[Ee[Z]].length;We++){var yt=R.createItem(J[L[Ee[Z]][We]],ye,Ee[Z]);(R.options.lazyLoading==!1||de<200)&&(ft.appendChild(yt.element),de++)}ye.appendChild(Ge),ye.appendChild(ft),R.groups.push(ye),ft.children.length>0&&ot.appendChild(ye)}if(me.length)for(var Z=0;Z<me.length;Z++){var yt=R.createItem(J[me[Z]]);(R.options.lazyLoading==!1||de<200)&&(ot.appendChild(yt.element),de++)}}},R.setData=function(J){if(Oe(),ot.textContent="",R.header.value="",R.items=[],J&&J.length){for(var me=0;me<J.length;me++)typeof J[me]!="object"&&(R.options.format?J[me]={id:J[me],name:J[me]}:J[me]={value:J[me],text:J[me]});R.appendData(J),R.options.data=J}else R.options.data=[];R.close()},R.getData=function(){return R.options.data},R.getPosition=function(J){for(var me=0;me<R.items.length;me++)if(ee(me)==J)return me;return!1},R.getText=function(J){var me=$e();return J?me:me.join("; ")},R.getValue=function(J){var me=Re();return J?me:me.join(";")};var ie=function(J){X.value!=R.options.value&&(X.value=R.options.value,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value})),typeof R.options.onchange=="function"&&R.options.onchange(X,R,J,R.options.value)};R.setValue=function(J){var me=R.getValue();Array.isArray(J)&&(J=J.join(";")),me!==J&&(oe(J),ie(me))},R.resetSelected=function(){R.setValue(null)},R.selectIndex=function(L,me){var L=parseInt(L);if(R.items&&R.items[L]&&(me===!0||R.items[L].data.disabled!==!0))if(R.setCursor(L,!1),!R.options.multiple)R.items[L].selected?R.options.allowEmpty!==!1&&R.setValue(null):R.setValue(ee(L)),R.close();else{var Z=R.options.value;R.items[L].selected?(R.items[L].element.classList.remove("jdropdown-selected"),R.items[L].selected=!1,delete R.value[ee(L)]):(R.items[L].element.classList.add("jdropdown-selected"),R.items[L].selected=!0,R.value[ee(L)]=fe(L)),R.options.value=Object.keys(R.value).join(";"),R.options.autocomplete==!1&&(R.header.value=$e().join("; ")),ie(Z)}},R.selectItem=function(J){R.selectIndex(J.indexValue)};var _e=function(J,me){for(var L=0;L<me.length;L++)if(R.options.format){if(me[L].id==J)return!0}else if(me[L].value==J)return!0;return!1};return R.find=function(J){if(R.search==J.trim())return!1;if(R.search=J,R.setCursor(),R.groups.length)for(var me=0;me<R.groups.length;me++)R.groups[me].lastChild.textContent="";if(ot.textContent="",R.options.remoteSearch==!0){R.results=null;var L=R.options.url;let ft={url:L,method:"GET",data:{q:J},dataType:"json",success:function(We){R.items=[];var yt=Object.keys(R.value);if(yt.length)for(var Ct=0;Ct<yt.length;Ct++)_e(yt[Ct],We)||(R.options.format?We.unshift({id:yt[Ct],name:R.value[yt[Ct]]}):We.unshift({value:yt[Ct],text:R.value[yt[Ct]]}));R.appendData(We),We.length?ot.style.display="":ot.style.display="none",typeof R.options.onsearch=="function"&&R.options.onsearch(R,We)}};if(typeof R.options.onbeforesearch=="function"){let We=R.options.onbeforesearch(R,ft);if(We===!1)return;typeof We=="object"&&(ft=We)}A(ft)}else{J=new RegExp(J,"gi");for(var Z=[],me=0;me<R.items.length;me++){var de=fe(me),Ee=R.items[me].data.title||"",ye=R.items[me].data.group||"",Ge=R.items[me].data.synonym||"";Ge&&(Ge=Ge.join(" ")),(J==null||R.items[me].selected==!0||de.toString().match(J)||Ee.match(J)||ye.match(J)||Ge.match(J))&&Z.push(R.items[me])}if(!Z.length)ot.style.display="none",R.results=null;else{ot.style.display="",R.results=Z;var tt=Z.length||0;R.options.lazyLoading==!0&&tt>200&&(tt=200);for(var me=0;me<tt;me++)R.results[me].group?(R.results[me].group.parentNode||ot.appendChild(R.results[me].group),R.results[me].group.lastChild.appendChild(R.results[me].element)):ot.appendChild(R.results[me].element)}}R.options.autofocus==!0&&R.first()},R.open=function(){if(!X.classList.contains("jdropdown-focus")){j.current=R,g(R,!0),X.classList.add("jdropdown-focus"),m.getWindowWidth()<800&&(R.options.type==null||R.options.type=="picker")&&D.slideBottom(Be,1),R.options.autocomplete==!0&&(R.header.value=R.search,R.header.focus());var J=Re();if(J[0]){var me=R.getPosition(J[0]);me!==!1&&R.setCursor(me)}if(!R.options.type||R.options.type=="default"){var L=X.getBoundingClientRect(),Z=Be.getBoundingClientRect();R.options.position?(Be.style.position="fixed",window.innerHeight<L.bottom+Z.height?(Be.style.top="",Be.style.bottom=window.innerHeight-L.top+1+"px"):(Be.style.top=L.bottom+"px",Be.style.bottom=""),Be.style.left=L.left+"px"):window.innerHeight<L.bottom+Z.height?(Be.style.top="",Be.style.bottom=L.height+1+"px"):(Be.style.top="",Be.style.bottom=""),Be.style.minWidth=L.width+"px",R.options.maxWidth&&(Be.style.maxWidth=R.options.maxWidth),!R.items.length&&R.options.autocomplete==!0?ot.style.display="none":ot.style.display=""}}typeof R.options.onopen=="function"&&R.options.onopen(X)},R.close=function(J){return X.classList.contains("jdropdown-focus")&&(R.header.value=R.getText(),R.setCursor(),!J&&typeof R.options.onclose=="function"&&R.options.onclose(X),R.header.blur&&R.header.blur(),X.classList.remove("jdropdown-focus"),g(R,!1),j.current=null),R.getValue()},R.setCursor=function(J,me){if(R.currentIndex!=null&&R.items&&R.items[R.currentIndex]&&R.items[R.currentIndex].element.classList.remove("jdropdown-cursor"),J==null)R.currentIndex=null;else if(J=parseInt(J),R.items[J].element.parentNode&&(R.items[J].element.classList.add("jdropdown-cursor"),R.currentIndex=J,me!==!1&&R.items[R.currentIndex].element)){ot.scrollTop;var L=R.items[R.currentIndex].element;ot.scrollTop=L.offsetTop-L.scrollTop+L.clientTop-95}},R.resetCursor=R.setCursor,R.updateCursor=R.setCursor,R.reset=function(){R.setCursor(),R.setValue(null)},R.first=function(){R.options.lazyLoading===!0&&R.loadFirst();var J=ot.querySelectorAll(".jdropdown-item");if(J.length){var me=J[0].indexValue;R.setCursor(me)}},R.last=function(){R.options.lazyLoading===!0&&R.loadLast();var J=ot.querySelectorAll(".jdropdown-item");if(J.length){var me=J[J.length-1].indexValue;R.setCursor(me)}},R.next=function(J){var me=null;if(J){if(J.length==1){var L=R.currentIndex||-1;J=J.toLowerCase();var Z=null,de=null,Ee=ot.querySelectorAll(".jdropdown-item");if(Ee.length){for(var ye=0;ye<Ee.length;ye++)if(Ee[ye].indexValue>L&&(Z=R.items[Ee[ye].indexValue])&&(de=Z.element.innerText[0])&&(de=de.toLowerCase(),J==de)){me=Ee[ye].indexValue;break}R.setCursor(me)}}}else if(R.currentIndex==null||R.currentIndex==null)R.first();else{var Ge=R.items[R.currentIndex].element,tt=Ge.nextElementSibling;tt?(tt.classList.contains("jdropdown-group")&&(tt=tt.lastChild.firstChild),me=tt.indexValue):Ge.parentNode.classList.contains("jdropdown-group-items")&&((tt=Ge.parentNode.parentNode.nextElementSibling)&&(tt.classList.contains("jdropdown-group")?tt=tt.lastChild.firstChild:tt.classList.contains("jdropdown-item")?me=tt.indexValue:tt=null),tt&&(me=tt.indexValue)),me!==null&&R.setCursor(me)}},R.prev=function(){var J=null;if(R.currentIndex===null)R.first();else{var me=R.items[R.currentIndex].element,L=me.previousElementSibling;L?(L.classList.contains("jdropdown-group")&&(L=L.lastChild.lastChild),J=L.indexValue):me.parentNode.classList.contains("jdropdown-group-items")&&((L=me.parentNode.parentNode.previousElementSibling)&&(L.classList.contains("jdropdown-group")?L=L.lastChild.lastChild:L.classList.contains("jdropdown-item")?J=L.indexValue:L=null),L&&(J=L.indexValue))}J!==null&&R.setCursor(J)},R.loadFirst=function(){if(R.results)var J=R.results;else var J=R.items;var me=J.length||0;R.options.lazyLoading==!0&&me>200&&(me=200),ot.textContent="";for(var L=0;L<me;L++)J[L].group?(J[L].group.parentNode||ot.appendChild(J[L].group),J[L].group.lastChild.appendChild(J[L].element)):ot.appendChild(J[L].element);ot.scrollTop=0},R.loadLast=function(){if(R.results)var J=R.results;else var J=R.items;var me=J.length;if(me>200){me=me-200,ot.textContent="";for(var L=me;L<J.length;L++)J[L].group?(J[L].group.parentNode||ot.appendChild(J[L].group),J[L].group.lastChild.appendChild(J[L].element)):ot.appendChild(J[L].element);ot.scrollTop=ot.scrollHeight}},R.loadUp=function(){var J=!1;if(R.results)var me=R.results;else var me=R.items;var L=ot.querySelectorAll(".jdropdown-item"),Z=L[0].indexValue;Z=R.items[Z];var de=me.indexOf(Z)-1;if(de>0){for(var Ee=0;de>0&&me[de]&&Ee<200;)me[de].group?(me[de].group.parentNode||ot.insertBefore(me[de].group,ot.firstChild),me[de].group.lastChild.insertBefore(me[de].element,me[de].group.lastChild.firstChild)):ot.insertBefore(me[de].element,ot.firstChild),de--,Ee++;J=!0}return J},R.loadDown=function(){var J=!1;if(R.results)var me=R.results;else var me=R.items;var L=ot.querySelectorAll(".jdropdown-item"),Z=L[L.length-1].indexValue;Z=R.items[Z];var de=me.indexOf(Z)+1;if(de<me.length){for(var Ee=0;de<me.length&&me[de]&&Ee<200;)me[de].group?(me[de].group.parentNode||ot.appendChild(me[de].group),me[de].group.lastChild.appendChild(me[de].element)):ot.appendChild(me[de].element),de++,Ee++;J=!0}return J},W(),R};return j.keydown=function(X){var P=null;if(P=j.current){if(X.which==13||X.which==9)P.header.value&&P.currentIndex==null&&P.options.newOptions?P.add():(P.currentIndex==null&&P.options.autocomplete==!0&&P.header.value!=""&&P.find(P.header.value),P.selectIndex(P.currentIndex));else if(X.which==38)P.currentIndex==null?P.first():P.currentIndex>0&&P.prev(),X.preventDefault();else if(X.which==40)P.currentIndex==null?P.first():P.currentIndex+1<P.items.length&&P.next(),X.preventDefault();else if(X.which==36)P.first(),X.target.classList.contains("jdropdown-header")||X.preventDefault();else if(X.which==35)P.last(),X.target.classList.contains("jdropdown-header")||X.preventDefault();else if(X.which==27)P.close();else if(X.which==33){if(P.currentIndex==null)P.first();else if(P.currentIndex>0)for(var R=0;R<7;R++)P.prev();X.preventDefault()}else if(X.which==34){if(P.currentIndex==null)P.first();else if(P.currentIndex+1<P.items.length)for(var R=0;R<7;R++)P.next();X.preventDefault()}}},j.mouseup=function(X){var P=m.findElement(X.target,"jdropdown");if(P){var R=P.dropdown;if(X.target.classList.contains("jdropdown-header"))if(P.classList.contains("jdropdown-focus")&&P.classList.contains("jdropdown-default")){var ae=P.getBoundingClientRect();if(X.changedTouches&&X.changedTouches[0]){var Pe=X.changedTouches[0].clientX;X.changedTouches[0].clientY}else{var Pe=X.clientX;X.clientY}ae.width-(Pe-ae.left)<30?X.target.classList.contains("jdropdown-add")?R.add():R.close():R.options.autocomplete==!1&&R.close()}else R.open();else if(X.target.classList.contains("jdropdown-group-name")){var Oe=X.target.nextSibling.children;if(X.target.nextSibling.style.display!="none")for(var oe=0;oe<Oe.length;oe++)Oe[oe].style.display!="none"&&R.selectItem(Oe[oe])}else X.target.classList.contains("jdropdown-group-arrow")?X.target.classList.contains("jdropdown-group-arrow-down")?(X.target.classList.remove("jdropdown-group-arrow-down"),X.target.classList.add("jdropdown-group-arrow-up"),X.target.parentNode.nextSibling.style.display="none"):(X.target.classList.remove("jdropdown-group-arrow-up"),X.target.classList.add("jdropdown-group-arrow-down"),X.target.parentNode.nextSibling.style.display=""):X.target.classList.contains("jdropdown-item")?R.selectItem(X.target):X.target.classList.contains("jdropdown-image")||X.target.classList.contains("jdropdown-description")?R.selectItem(X.target.parentNode):X.target.classList.contains("jdropdown-title")?R.selectItem(X.target.parentNode.parentNode):(X.target.classList.contains("jdropdown-close")||X.target.classList.contains("jdropdown-backdrop"))&&R.close()}},j.extractFromDom=function(X,P){var R=X;if(P||(P={}),X.getAttribute("multiple")&&(!P||P.multiple==null)&&(P.multiple=!0),X.getAttribute("placeholder")&&(!P||P.placeholder==null)&&(P.placeholder=X.getAttribute("placeholder")),X.getAttribute("data-autocomplete")&&(!P||P.autocomplete==null)&&(P.autocomplete=!0),(!P||P.width==null)&&(P.width=X.offsetWidth),X.value&&(!P||P.value==null)&&(P.value=X.value),!P||P.data==null){P.data=[];for(var ae=0;ae<X.children.length;ae++)if(X.children[ae].tagName=="OPTGROUP")for(var Pe=0;Pe<X.children[ae].children.length;Pe++)P.data.push({value:X.children[ae].children[Pe].value,text:X.children[ae].children[Pe].textContent,group:X.children[ae].getAttribute("label")});else P.data.push({value:X.children[ae].value,text:X.children[ae].textContent})}(!P||P.onchange==null)&&(P.onchange=function(oe,ee,fe,Re){P.multiple==!0?obj.items[ee].classList.contains("jdropdown-selected")?R.options[ee].setAttribute("selected","selected"):R.options[ee].removeAttribute("selected"):R.value=Re});var Oe=document.createElement("div");return X.parentNode.insertBefore(Oe,X),X.style.display="none",X=Oe,{el:X,options:P}},j}var Ne=we();function at(j,X){if(j.picker)return j.picker.setOptions(X,!0);var P={type:"picker"};P.options={};var R=null,ae=null,Pe=function(ee){return ee instanceof Element||ee instanceof HTMLDocument},Oe=function(){ae.innerHTML="";for(var ee=Object.keys(P.options.data),fe=0;fe<ee.length;fe++){var Re=document.createElement("div");Re.classList.add("jpicker-item"),Re.k=ee[fe],Re.v=P.options.data[ee[fe]];var $e=P.getLabel(ee[fe],Re);Pe($e)?Re.appendChild($e):Re.innerHTML=$e,ae.appendChild(Re)}};P.setOptions=function(ee,fe){var Re={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};ee&&ee.options&&(ee.data=ee.options);for(var $e in Re)ee&&ee.hasOwnProperty($e)?P.options[$e]=ee[$e]:(typeof P.options[$e]>"u"||fe===!0)&&(P.options[$e]=Re[$e]);return P.options.header===!1?R.style.display="none":R.style.display="",P.options.width?R.style.width=parseInt(P.options.width)+"px":R.style.width="",P.options.height?(ae.style.maxHeight=P.options.height+"px",ae.style.overflow="scroll"):ae.style.overflow="",P.options.columns>0&&(P.options.grid?(ae.classList.add("jpicker-grid"),ae.style.gridTemplateColumns="repeat("+P.options.grid+", 1fr)"):(ae.classList.add("jpicker-columns"),ae.style.width=P.options.width?P.options.width:36*P.options.columns+"px")),isNaN(parseInt(P.options.value))&&(P.options.value=0),Oe(),P.setValue(P.options.value),P},P.getValue=function(){return P.options.value},P.setValue=function(ee,fe){if(P.setLabel(ee),P.options.value=String(ee),j.value!=P.options.value&&(j.value=P.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),ae.children[ee]&&ae.children[ee].getAttribute("type")!=="generic"&&P.close(),fe&&typeof P.options.onchange=="function"){var Re=P.options.data[ee];P.options.onchange(j,P,Re,Re,ee,fe)}},P.getLabel=function(ee,fe){var Re=P.options.data[ee]||null;return typeof P.options.render=="function"&&(Re=P.options.render(Re,fe)),Re},P.setLabel=function(ee){var fe;P.options.content?fe='<i class="material-icons">'+P.options.content+"</i>":fe=P.getLabel(ee,null),Pe(fe)?(R.innerHTML="",R.appendChild(fe)):R.innerHTML=fe},P.open=function(){if(!j.classList.contains("jpicker-focus")){g(P,!0),j.classList.add("jpicker-focus"),j.focus();var ee=0,fe=0;ae.style.marginLeft="";var Re=R.getBoundingClientRect(),$e=ae.getBoundingClientRect();window.innerHeight<Re.bottom+$e.height||P.options.bottom?ee=-1*($e.height+4):ee=Re.height+4,P.options.right===!0&&(fe=-1*$e.width+Re.width),$e.left+fe<0&&(fe=fe+$e.left+10),$e.left+$e.width>window.innerWidth&&(fe=-1*(10+$e.left+$e.width-window.innerWidth)),ae.style.marginTop=parseInt(ee)+"px",ae.style.marginLeft=parseInt(fe)+"px",typeof P.options.onopen=="function"&&P.options.onopen(j,P)}},P.close=function(){j.classList.contains("jpicker-focus")&&(j.classList.remove("jpicker-focus"),g(P,!1),typeof P.options.onclose=="function"&&P.options.onclose(j,P))};var oe=function(){j.classList.add("jpicker"),j.setAttribute("tabindex","0"),j.onmousedown=function(ee){j.classList.contains("jpicker-focus")||P.open()},R=document.createElement("div"),R.classList.add("jpicker-header"),ae=document.createElement("div"),ae.classList.add("jpicker-content"),ae.onclick=function(ee){var fe=m.findElement(ee.target,"jpicker-item");fe&&fe.parentNode===ae&&P.setValue(fe.k,ee)},j.appendChild(R),j.appendChild(ae),j.value=X.value||0,P.setOptions(X),typeof P.options.onload=="function"&&P.options.onload(j,P),j.change=P.setValue,j.val=function(ee){if(ee===void 0)return P.getValue();P.setValue(ee)},j.picker=P};return oe(),P}function nt(j,X){var P={type:"toolbar"};P.options={};var R={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var ae in R)X&&X.hasOwnProperty(ae)?P.options[ae]=X[ae]:P.options[ae]=R[ae];!j&&X.app&&X.app.el&&(j=document.createElement("div"),X.app.el.appendChild(j));var Pe=document.createElement("div");Pe.classList.add("jtoolbar-item"),Pe.classList.add("jtoolbar-arrow");var Oe=document.createElement("div");Oe.classList.add("jtoolbar-floating"),Pe.appendChild(Oe),P.selectItem=function(ee){for(var fe=oe.children,Re=0;Re<fe.length;Re++)ee!=fe[Re]&&fe[Re].classList.remove("jtoolbar-selected");ee.classList.add("jtoolbar-selected")},P.hide=function(){D.slideBottom(j,0,function(){j.style.display="none"})},P.show=function(){j.style.display="",D.slideBottom(j,1)},P.get=function(){return j},P.setBadge=function(ee,fe){oe.children[ee].children[1].firstChild.innerHTML=fe},P.destroy=function(){toolbar.remove(),j.innerHTML=""},P.update=function(ee,fe){for(var Re=0;Re<oe.children.length;Re++){var $e=oe.children[Re];typeof $e.updateState=="function"&&$e.updateState(j,P,$e,ee,fe)}for(var Re=0;Re<Oe.children.length;Re++){var $e=Oe.children[Re];typeof $e.updateState=="function"&&$e.updateState(j,P,$e,ee,fe)}},P.create=function(ee){oe.innerHTML="";for(var fe=0;fe<ee.length;fe++){var Re=document.createElement("div");if(Re.classList.add("jtoolbar-item"),ee[fe].width&&(Re.style.width=parseInt(ee[fe].width)+"px"),ee[fe].k&&(Re.k=ee[fe].k),ee[fe].tooltip&&Re.setAttribute("title",ee[fe].tooltip),ee[fe].id&&Re.setAttribute("id",ee[fe].id),ee[fe].updateState&&(Re.updateState=ee[fe].updateState),ee[fe].active&&Re.classList.add("jtoolbar-active"),ee[fe].disabled&&Re.classList.add("jtoolbar-disabled"),ee[fe].type=="select"||ee[fe].type=="dropdown")at(Re,ee[fe]);else if(ee[fe].type=="divisor")Re.classList.add("jtoolbar-divisor");else if(ee[fe].type=="label")Re.classList.add("jtoolbar-label"),Re.innerHTML=ee[fe].content;else{var $e=document.createElement("i");if(typeof ee[fe].class>"u")$e.classList.add("material-icons");else for(var Je=ee[fe].class.split(" "),Be=0;Be<Je.length;Be++)$e.classList.add(Je[Be]);if($e.innerHTML=ee[fe].content?ee[fe].content:"",Re.appendChild($e),P.options.badge==!0){var ot=document.createElement("div");ot.classList.add("jbadge");var gt=document.createElement("div");gt.innerHTML=ee[fe].badge?ee[fe].badge:"",ot.appendChild(gt),Re.appendChild(ot)}if(ee[fe].title)if(P.options.title==!0){var b=document.createElement("span");b.innerHTML=ee[fe].title,Re.appendChild(b)}else Re.setAttribute("title",ee[fe].title);P.options.app&&ee[fe].route&&(Re.route=ee[fe].route,Re.onclick=function(){P.options.app.pages(this.route)},P.options.app.pages(ee[fe].route,{toolbarItem:Re,closed:!0})),typeof ee[fe].render=="function"&&ee[fe].render(Re,ee[fe])}ee[fe].onclick&&(Re.onclick=ee[fe].onclick.bind(ee[fe],j,P,Re)),oe.appendChild(Re)}setTimeout(function(){P.refresh()},0)},P.open=function(){Pe.classList.add("jtoolbar-arrow-selected"),j.getBoundingClientRect();var ee=Oe.getBoundingClientRect();ee.bottom>window.innerHeight||P.options.bottom?Oe.style.bottom="0":Oe.style.removeProperty("bottom"),Oe.style.right="0",Pe.children[0].focus(),g(P,!0)},P.close=function(){Pe.classList.remove("jtoolbar-arrow-selected"),g(P,!1)},P.refresh=function(){if(P.options.responsive==!0){var ee=j.parentNode.getBoundingClientRect();P.options.maxWidth||(P.options.maxWidth=ee.width);var fe=parseInt(P.options.maxWidth);for(Pe.parentNode&&Pe.parentNode.removeChild(Pe);Oe.firstChild;)oe.appendChild(Oe.firstChild);if(fe<oe.offsetWidth)for(fe-=50;oe.lastChild&&fe<oe.offsetWidth;)Oe.insertBefore(oe.lastChild,Oe.firstChild);Oe.children.length>0&&oe.appendChild(Pe)}},P.setReadonly=function(ee){ee=ee?"add":"remove",j.classList[ee]("jtoolbar-disabled")},j.onclick=function(ee){var fe=m.findElement(ee.target,"jtoolbar-item");fe&&P.selectItem(fe),ee.target.classList.contains("jtoolbar-arrow")&&P.open()},window.addEventListener("resize",function(){P.refresh()}),j.classList.add("jtoolbar"),j.innerHTML="",P.options.container==!0&&j.classList.add("jtoolbar-container");var oe=document.createElement("div");return j.appendChild(oe),P.options.app&&j.classList.add("jtoolbar-mobile"),P.create(P.options.items),j.toolbar=P,P}function B(){var j=function(X,P){var R={type:"editor"};R.options={};var ae={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Pe in ae)P&&P.hasOwnProperty(Pe)?R.options[Pe]=P[Pe]:R.options[Pe]=ae[Pe];var Oe=null,oe=null,ee=[];R.el=X,typeof R.options.onclick=="function"&&(X.onclick=function(De){R.options.onclick(X,R,De)}),X.classList.add("jeditor-container");var fe=document.createElement("div");fe.className="jsnippet",fe.setAttribute("contenteditable",!1);var Re=document.createElement("div");if(Re.className="jeditor-toolbar",R.editor=document.createElement("div"),R.editor.setAttribute("contenteditable",!0),R.editor.setAttribute("spellcheck",!1),R.editor.classList.add("jeditor"),R.options.placeholder&&R.editor.setAttribute("data-placeholder",R.options.placeholder),(R.options.maxHeight||R.options.height)&&(R.editor.style.overflowY="auto",R.options.maxHeight&&(R.editor.style.maxHeight=R.options.maxHeight),R.options.height&&(R.editor.style.height=R.options.height)),R.options.url)A({url:R.options.url,dataType:"html",success:function(De){R.editor.innerHTML=De,j.setCursor(R.editor,R.options.focus=="initial")}});else if(R.options.value)R.editor.innerHTML=R.options.value;else for(var $e=0;$e<X.children.length;$e++)R.editor.appendChild(X.children[$e]);X.innerHTML="";var Je=function(De){typeof R.options.onchange=="function"&&R.options.onchange(X,R,De),R.options.value=R.getData(),X.value!=R.options.value&&(X.value=R.options.value,typeof X.oninput=="function"&&X.oninput({type:"input",target:X,value:X.value}))},Be=function(De){var ht=document.createElement("div");ht.innerHTML=De;var mt=ht.querySelectorAll("img");if(mt.length)for(var Nt=0;Nt<mt.length;Nt++)R.addImage(mt[Nt].src)},ot=function(){var De=null;if(De=fe.children[0]){De.classList.contains("jslider-grid")||De.classList.add("jslider-grid");var ht=De.children.length;De.setAttribute("data-number",ht>4?4:ht),ht>4?De.setAttribute("data-total",ht-4):De.removeAttribute("data-total")}},gt=function(De){fe.innerHTML||R.appendSnippet({}),fe.children[0].appendChild(De),ot()};R.appendSnippet=function(De){fe.innerHTML="";for(var ht=["image","title","description","host","url"],mt=0;mt<ht.length;mt++){var Nt=document.createElement("div");if(Nt.className="jsnippet-"+ht[mt],Nt.setAttribute("data-k",ht[mt]),fe.appendChild(Nt),De[ht[mt]])if(ht[mt]=="image"){Array.isArray(De.image)||(De.image=[De.image]);for(var pt=0;pt<De.image.length;pt++){var Me=document.createElement("img");Me.src=De.image[pt],Nt.appendChild(Me)}}else Nt.innerHTML=De[ht[mt]]}R.editor.appendChild(document.createElement("br")),R.editor.appendChild(fe)},R.setData=function(De){typeof De=="object"?R.editor.innerHTML=De.content:R.editor.innerHTML=De,R.options.focus&&j.setCursor(R.editor,!0),ee=[]},R.getFiles=function(){for(var De=R.editor.querySelectorAll(".jfile"),ht=[],mt=0;mt<De.length;mt++)ee[De[mt].src]&&ht.push(ee[De[mt].src]);return ht},R.getText=function(){return R.editor.innerText},R.getData=function(De){if(De){var ht={content:""};if(fe.innerHTML){ht.snippet={};for(var mt=0;mt<fe.children.length;mt++){var Nt=fe.children[mt].getAttribute("data-k");if(Nt)if(Nt=="image"){ht.snippet.image||(ht.snippet.image=[]);for(var pt=0;pt<fe.children[mt].children.length;pt++)ht.snippet.image.push(fe.children[mt].children[pt].getAttribute("src"))}else ht.snippet[Nt]=fe.children[mt].innerHTML}}var Me=Object.keys(ee);if(Me.length){ht.files=[];for(var mt=0;mt<Me.length;mt++)ht.files.push(ee[Me[mt]])}var dt=document.createElement("div");dt.innerHTML=R.editor.innerHTML;var wt=dt.querySelector(".jsnippet");wt&&wt.remove();var Ot=dt.innerHTML;Ot=Ot.replace(/<br>/g,`
`),Ot=Ot.replace(/<\/div>/g,`</div>
`),Ot=Ot.replace(/<(?:.|\n)*?>/gm,""),ht.content=Ot.trim(),yt("getData",ht)}else var ht=R.editor.innerHTML;return ht},R.reset=function(){R.editor.innerHTML="",fe.innerHTML="",ee=[]},R.addPdf=function(De){if(De.result.substr(0,4)!="data")console.error("Invalid source");else{var ht=document.createElement("canvas");ht.width=60,ht.height=60;var mt=new Image,Nt=ht.getContext("2d");Nt.drawImage(mt,0,0,ht.width,ht.height),ht.toBlob(function(pt){var Me=document.createElement("img");Me.src=window.URL.createObjectURL(pt),Me.title=De.name,Me.className="jfile pdf",ee[Me.src]={file:Me.src,extension:"pdf",content:De.result},document.execCommand("insertHtml",!1,Me.outerHTML)})}},R.addImage=function(De,ht){if(R.options.acceptImages)if(De||(De=""),De.substr(0,4)!="data"&&!R.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(De.substr(0,4)=="data"){var mt=De.split(";");mt=mt[0].split("/"),mt=mt[1]}else{var mt=De.substr(De.lastIndexOf(".")+1);De=R.options.remoteParser+De}var Nt=new Image;Nt.onload=function(){var Me=document.createElement("canvas");Me.width=Nt.width,Me.height=Nt.height;var dt=Me.getContext("2d");dt.drawImage(Nt,0,0,Me.width,Me.height),Me.toBlob(function(wt){var Ot=document.createElement("img");Ot.src=window.URL.createObjectURL(wt),Ot.classList.add("jfile"),Ot.setAttribute("tabindex","900"),Ot.setAttribute("width",Nt.width),Ot.setAttribute("height",Nt.height),ee[Ot.src]={file:Ot.src,extension:mt,content:Me.toDataURL()},R.options.dropAsSnippet||ht?(gt(Ot),ee[Ot.src].snippet=!0):document.execCommand("insertHtml",!1,Ot.outerHTML),Je()})},Nt.src=De}},R.addFile=function(De){for(var ht=[],mt=0;mt<De.length;mt++)if(De[mt].size>R.options.maxFileSize)alert("The file is too big");else{var Nt=De[mt].type.split("/");Nt[0]=="image"?Nt=1:Nt[1]=="pdf"?Nt=2:Nt=0,Nt?(ht[mt]=new FileReader,ht[mt].index=mt,ht[mt].type=Nt,ht[mt].name=De[mt].name,ht[mt].date=De[mt].lastModified,ht[mt].size=De[mt].size,ht[mt].addEventListener("load",function(pt){pt.target.type==2?R.options.acceptFiles==!0&&R.addPdf(pt.target):R.addImage(pt.target.result)},!1),ht[mt].readAsDataURL(De[mt])):alert("The extension is not allowed")}},R.destroy=function(){R.editor.removeEventListener("mouseup",tt),R.editor.removeEventListener("mousedown",ft),R.editor.removeEventListener("mousemove",We),R.editor.removeEventListener("keyup",ye),R.editor.removeEventListener("keydown",Ge),R.editor.removeEventListener("dragstart",J),R.editor.removeEventListener("dragenter",me),R.editor.removeEventListener("dragover",L),R.editor.removeEventListener("drop",Z),R.editor.removeEventListener("paste",_e),R.editor.removeEventListener("blur",de),R.editor.removeEventListener("focus",Ee),X.editor=null,X.classList.remove("jeditor-container"),Re.remove(),fe.remove(),R.editor.remove()},R.upload=function(){m.click(R.file)};const b=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],q=["width","height","align","border","src","tabindex"],F=["color","font-weight","font-size","background","background-color","margin"],W=function(De){if(De.tagName&&b.indexOf(De.tagName.toLowerCase())===-1&&De.innerText&&(De.innerHTML=De.innerText),De.attributes&&De.attributes.length){let ht=null,mt=De.getAttribute("style");if(mt){ht=[];let pt=mt.split(";");for(let Me=0;Me<pt.length;Me++){let dt=pt[Me].trim().split(":");if(F.indexOf(dt[0].trim())>=0){let wt=dt.shift();dt=dt.join(":"),ht.push(wt+":"+dt)}}}De.tagName.toUpperCase()==="IMG"&&(!R.options.acceptImages||!De.src?De.parentNode.removeChild(De):(De.setAttribute("tabindex","900"),R.addImage(De.src)));let Nt=[];for(let pt=0;pt<De.attributes.length;pt++)Nt.push(De.attributes[pt].name);Nt.length&&Nt.forEach(function(pt){q.indexOf(pt)===-1?De.removeAttribute(pt):De.attributes&&De.attributes[$e]&&De.attributes[$e].value.indexOf("<")!==-1&&De.attributes[$e].value.replace("<","&#60;")}),De.style="",ht&&ht.length&&De.setAttribute("style",ht.join(";"))}if(De.children.length)for(let ht=De.children.length;ht>0;ht--)W(De.children[ht-1])};var z=function(De){var ht=window.getSelection(),mt=document.createRange();mt.selectNode(De),ht.addRange(mt)},ie=function(De){De&&(De=De.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ht=new DOMParser,mt=ht.parseFromString(De,"text/html");W(mt);var Nt=document.createElement("div");return Nt.innerHTML=mt.firstChild.innerHTML,Nt},_e=function(De){if(R.options.filterPaste==!0){if(De.clipboardData||De.originalEvent.clipboardData)var ht=(De.originalEvent||De).clipboardData.getData("text/html"),mt=(De.originalEvent||De).clipboardData.getData("text/plain"),Nt=(De.originalEvent||De).clipboardData.files;else if(window.clipboardData)var ht=window.clipboardData.getData("Html"),mt=window.clipboardData.getData("Text"),Nt=window.clipboardData.files;if(Nt.length)R.addFile(Nt);else if(!ht)ht=mt.split(`\r
`),De.target.innerText?(ht=ht.map(function(Me){return"<div>"+Me+"</div>"}),document.execCommand("insertText",!1,ht.join(""))):ht.map(function(Me){var dt=document.createElement("div");dt.innerText=Me,R.editor.appendChild(dt)});else{var pt=ie(ht);document.execCommand("insertHtml",!1,pt.innerHTML)}De.preventDefault()}},J=function(De){oe&&oe.e&&De.preventDefault()},me=function(De){oe||R.options.dropZone==!1||(X.classList.add("jeditor-dragging"),De.preventDefault())},L=function(De){oe||R.options.dropZone==!1||(Oe&&clearTimeout(Oe),Oe=setTimeout(function(){X.classList.remove("jeditor-dragging")},100),De.preventDefault())},Z=function(De){if(!(oe||R.options.dropZone==!1)){var ht=null;document.caretRangeFromPoint?ht=document.caretRangeFromPoint(De.clientX,De.clientY):De.rangeParent&&(ht=document.createRange(),ht.setStart(De.rangeParent,De.rangeOffset));var mt=window.getSelection();mt.removeAllRanges(),mt.addRange(ht),mt.anchorNode.parentNode.focus();var Nt=(De.originalEvent||De).dataTransfer.getData("text/html"),pt=(De.originalEvent||De).dataTransfer.getData("text/plain"),Me=(De.originalEvent||De).dataTransfer.files;Me.length?R.addFile(Me):pt&&Be(Nt),X.classList.remove("jeditor-dragging"),De.preventDefault()}},de=function(De){yt("onevent",De),Je(De),typeof R.options.onblur=="function"&&R.options.onblur(X,R,De)},Ee=function(De){typeof R.options.onfocus=="function"&&R.options.onfocus(X,R,De)},ye=function(De){R.editor.innerHTML||(R.editor.innerHTML="<div><br></div>"),typeof R.options.onkeyup=="function"&&R.options.onkeyup(X,R,De)},Ge=function(De){if(yt("onevent",De),De.key=="Delete"&&De.target.tagName=="IMG"){var ht=De.target.parentNode;z(De.target),ht.classList.contains("jsnippet-image")&&ot()}typeof R.options.onkeydown=="function"&&R.options.onkeydown(X,R,De)},tt=function(De){if(oe&&oe.e&&(oe.e.classList.remove("resizing"),oe.e.changed==!0)){var ht=oe.e.cloneNode();ht.width=parseInt(oe.e.style.width)||oe.e.getAttribute("width"),ht.height=parseInt(oe.e.style.height)||oe.e.getAttribute("height"),oe.e.style.width="",oe.e.style.height="",z(oe.e),document.execCommand("insertHtml",!1,ht.outerHTML)}oe=!1},ft=function(De){var ht=function(Me){var dt=Me.getBoundingClientRect();dt.width-(De.clientX-dt.left)<40&&De.clientY-dt.top<40&&(Me.innerHTML="",Me.remove())};if(De.target.tagName=="IMG")if(De.target.style.cursor){var mt=De.target.getBoundingClientRect();oe={e:De.target,x:De.clientX,y:De.clientY,w:mt.width,h:mt.height,d:De.target.style.cursor},De.target.getAttribute("width")||De.target.setAttribute("width",mt.width),De.target.getAttribute("height")||De.target.setAttribute("height",mt.height);var Nt=window.getSelection();if(Nt.rangeCount)for(var pt=0;pt<Nt.rangeCount;pt++)Nt.removeRange(Nt.getRangeAt(pt));De.target.classList.add("resizing")}else oe=!0;else De.target.classList.contains("jsnippet")?ht(De.target):De.target.parentNode.classList.contains("jsnippet")&&ht(De.target.parentNode),oe=!0},We=function(De){if(De.target.tagName=="IMG"&&!De.target.parentNode.classList.contains("jsnippet-image")&&R.options.allowImageResize==!0&&De.target.getAttribute("tabindex")){var ht=De.target.getBoundingClientRect();De.clientY-ht.top<5?ht.width-(De.clientX-ht.left)<5?De.target.style.cursor="ne-resize":De.clientX-ht.left<5?De.target.style.cursor="nw-resize":De.target.style.cursor="n-resize":ht.height-(De.clientY-ht.top)<5?ht.width-(De.clientX-ht.left)<5?De.target.style.cursor="se-resize":De.clientX-ht.left<5?De.target.style.cursor="sw-resize":De.target.style.cursor="s-resize":ht.width-(De.clientX-ht.left)<5?De.target.style.cursor="e-resize":De.clientX-ht.left<5?De.target.style.cursor="w-resize":De.target.style.cursor=""}if(De.which==1&&oe&&oe.d){if(oe.d=="e-resize"||oe.d=="ne-resize"||oe.d=="se-resize")if(oe.e.style.width=oe.w+(De.clientX-oe.x),De.shiftKey){var mt=(De.clientX-oe.x)*(oe.h/oe.w);oe.e.style.height=oe.h+mt}else var mt=null;mt||(oe.d=="s-resize"||oe.d=="se-resize"||oe.d=="sw-resize")&&(De.shiftKey||(oe.e.style.height=oe.h+(De.clientY-oe.y))),oe.e.changed=!0}},yt=function(De,ht){if(R.options.extensions){var mt=Object.keys(R.options.extensions);if(mt.length)for(var Nt=0;Nt<mt.length;Nt++)R.options.extensions[mt[Nt]]&&typeof R.options.extensions[mt[Nt]][De]=="function"&&R.options.extensions[mt[Nt]][De].call(R,ht)}},Ct=function(){if(R.options.extensions){var De=Object.keys(R.options.extensions);if(De.length)for(var ht=0;ht<De.length;ht++)R.options.extensions[De[ht]]&&typeof R.options.extensions[De[ht]]=="function"&&(R.options.extensions[De[ht]]=R.options.extensions[De[ht]](X,R))}};if(document.addEventListener("mouseup",tt),document.addEventListener("mousemove",We),R.editor.addEventListener("mousedown",ft),R.editor.addEventListener("keyup",ye),R.editor.addEventListener("keydown",Ge),R.editor.addEventListener("dragstart",J),R.editor.addEventListener("dragenter",me),R.editor.addEventListener("dragover",L),R.editor.addEventListener("drop",Z),R.editor.addEventListener("paste",_e),R.editor.addEventListener("focus",Ee),R.editor.addEventListener("blur",de),X.appendChild(R.editor),R.options.snippet&&R.appendSnippet(R.options.snippet),R.options.toolbar){if(Array.isArray(R.options.toolbar))var Mt={container:!0,responsive:!0,items:R.options.toolbar};else if(R.options.toolbar===!0)var Mt={container:!0,responsive:!0,items:[]};else var Mt=R.options.toolbar;Mt.items&&Mt.items.length||(Mt.items=j.getDefaultToolbar(R)),R.options.toolbarOnTop?(X.classList.add("toolbar-on-top"),X.insertBefore(Re,X.firstChild)):(R.editor.style.padding="15px",X.appendChild(Re)),nt(Re,Mt),Re.addEventListener("click",function(){R.editor.focus()})}return R.file=document.createElement("input"),R.file.style.display="none",R.file.type="file",R.file.setAttribute("accept","image/*"),R.file.onchange=function(){R.addFile(this.files)},X.appendChild(R.file),R.options.focus&&j.setCursor(R.editor,R.options.focus=="initial"),X.change=R.setData,X.val=function(De){if(De===void 0){var ht=X.getAttribute("data-html")!=="true";return R.getData(ht)}else R.setData(De)},Ct(),X.editor=R,typeof R.options.onload=="function"&&R.options.onload(X,R,R.editor),R};return j.setCursor=function(X,P){X.focus(),document.execCommand("selectAll");var R=window.getSelection(),ae=R.getRangeAt(0);if(P==!0)var Pe=ae.startContainer,Oe=0;else var Pe=ae.endContainer,Oe=Pe.length;ae.setStart(Pe,Oe),ae.setEnd(Pe,Oe),R.removeAllRanges(),R.addRange(ae)},j.getDefaultToolbar=function(X){var P=function(ae,Pe,Oe){Oe.color||(ve(Oe,{onchange:function(oe,ee){Oe.k==="color"?document.execCommand("foreColor",!1,ee):document.execCommand("backColor",!1,ee)}}),Oe.color.open())},R=[];return R.push({content:"undo",onclick:function(){document.execCommand("undo")}}),R.push({content:"redo",onclick:function(){document.execCommand("redo")}}),R.push({type:"divisor"}),X.options.toolbarOnTop&&(R.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(ae){return'<span style="font-family:'+ae+'">'+ae+"</span>"},onchange:function(ae,Pe,Oe,oe,ee){document.execCommand("fontName",!1,oe)}}),R.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(ae){return'<span style="font-size:'+ae+'">'+ae+"</span>"},onchange:function(ae,Pe,Oe,oe,ee){document.execCommand("fontSize",!1,parseInt(ee)+1)}}),R.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(ae){return'<i class="material-icons">'+ae+"</i>"},onchange:function(ae,Pe,Oe,oe,ee){var fe=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(fe[ee])}}),R.push({type:"divisor"}),R.push({content:"format_color_text",k:"color",onclick:P}),R.push({content:"format_color_fill",k:"background-color",onclick:P})),R.push({content:"format_bold",onclick:function(ae,Pe,Oe){document.execCommand("bold"),document.queryCommandState("bold")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({content:"format_italic",onclick:function(ae,Pe,Oe){document.execCommand("italic"),document.queryCommandState("italic")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({content:"format_underline",onclick:function(ae,Pe,Oe){document.execCommand("underline"),document.queryCommandState("underline")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({type:"divisor"}),R.push({content:"format_list_bulleted",onclick:function(ae,Pe,Oe){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({content:"format_list_numbered",onclick:function(ae,Pe,Oe){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({content:"format_indent_increase",onclick:function(ae,Pe,Oe){document.execCommand("indent",!0,null),document.queryCommandState("indent")?Oe.classList.add("selected"):Oe.classList.remove("selected")}}),R.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),X.options.toolbarOnTop&&(R.push({type:"divisor"}),R.push({content:"photo",onclick:function(){X.upload()}}),R.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(ae,Pe){Pe&&(Pe.onmouseover=this.onmouseover,ae=ae.split("x"),Pe.setAttribute("data-x",ae[0]),Pe.setAttribute("data-y",ae[1]));var Oe=document.createElement("div");return Pe.style.margin="1px",Pe.style.border="1px solid #ddd",Oe},onmouseover:function(ae){for(var Pe=parseInt(ae.target.getAttribute("data-x")),Oe=parseInt(ae.target.getAttribute("data-y")),oe=0;oe<ae.target.parentNode.children.length;oe++){var ee=ae.target.parentNode.children[oe],fe=parseInt(ee.getAttribute("data-x")),Re=parseInt(ee.getAttribute("data-y"));fe<=Pe&&Re<=Oe?(ee.style.backgroundColor="#cae1fc",ee.style.borderColor="#2977ff"):(ee.style.backgroundColor="",ee.style.borderColor="#ddd")}},onchange:function(ae,Pe,Oe){Oe=Oe.split("x");for(var oe=document.createElement("table"),ee=document.createElement("tbody"),fe=0;fe<=Oe[1];fe++){for(var Re=document.createElement("tr"),$e=0;$e<=Oe[0];$e++){var Je=document.createElement("td");Je.innerHTML="",Re.appendChild(Je)}ee.appendChild(Re)}oe.appendChild(ee),oe.setAttribute("width","100%"),oe.setAttribute("cellpadding","6"),oe.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,oe.outerHTML)}})),R},j}var te=B();function V(){var j=function(X,P){var R={};R.options={};var ae={type:"big",title:"Untitled",width:510,height:472};for(var Pe in ae)P&&P.hasOwnProperty(Pe)?R.options[Pe]=P[Pe]:R.options[Pe]=ae[Pe];var Oe=function(){for(var fe=document.createElement("div");X.children[0];)fe.appendChild(X.children[0]);for(R.content=document.createElement("div"),R.content.className="jfloating_content",R.content.innerHTML=X.innerHTML;fe.children[0];)R.content.appendChild(fe.children[0]);R.container=document.createElement("div"),R.container.className="jfloating",R.container.appendChild(R.content),R.options.title?R.container.setAttribute("title",R.options.title):R.container.classList.add("no-title"),R.options.width&&(R.container.style.width=parseInt(R.options.width)+"px"),R.options.height&&(R.container.style.height=parseInt(R.options.height)+"px"),X.innerHTML="",X.appendChild(R.container)},oe=function(){R.container&&R.container.addEventListener("click",function(fe){var Re=fe.target.getBoundingClientRect();if(fe.target.classList.contains("jfloating")){if(fe.changedTouches&&fe.changedTouches[0])var $e=fe.changedTouches[0].clientX,Je=fe.changedTouches[0].clientY;else var $e=fe.clientX,Je=fe.clientY;Re.width-($e-Re.left)<50&&Je-Re.top<50?setTimeout(function(){R.close()},100):R.setState()}})},ee=function(){R.container.classList.add("jfloating-"+R.options.type)};return R.state={isMinized:!1},R.setState=function(){R.state.isMinized?R.container.classList.remove("jfloating-minimized"):R.container.classList.add("jfloating-minimized"),R.state.isMinized=!R.state.isMinized},R.close=function(){Components.elements.splice(j.elements.indexOf(R.container),1),R.updatePosition(),X.remove()},R.updatePosition=function(){for(var fe=0;fe<j.elements.length;fe++){var Re=j.elements[fe],$e=j.elements[fe-1];Re.style.right=fe*($e?$e.offsetWidth:Re.offsetWidth)*1.01+"px"}},R.init=function(){Oe(),oe(),ee(),j.elements.push(R.container),R.updatePosition(),X.floating=R},R.init(),R};return j.elements=[],j}var ue=V();function Ae(){const j=function(oe){return!isNaN(oe)&&oe!==null&&(typeof oe!="string"||oe.trim()!=="")},X={between:function(oe,ee){return oe>=ee[0]&&oe<=ee[1]},"not between":function(oe,ee){return oe<ee[0]||oe>ee[1]},"<":function(oe,ee){return oe<ee[0]},"<=":function(oe,ee){return oe<=ee[0]},">":function(oe,ee){return oe>ee[0]},">=":function(oe,ee){return oe>=ee[0]},"=":function(oe,ee){return oe==ee[0]},"!=":function(oe,ee){return oe!=ee[0]}},P={"valid date":function(){return!0},"=":function(oe,ee){return oe===ee[0]},"!=":function(oe,ee){return oe!==ee[0]},"<":function(oe,ee){return oe<ee[0]},"<=":function(oe,ee){return oe<=ee[0]},">":function(oe,ee){return oe>ee[0]},">=":function(oe,ee){return oe>=ee[0]},between:function(oe,ee){return oe>=ee[0]&&oe<=ee[1]},"not between":function(oe,ee){return oe<ee[0]||oe>ee[1]}},R={contains:function(oe,ee){return oe.includes(ee[0])},"not contains":function(oe,ee){return!oe.includes(ee[0])},"begins with":function(oe,ee){return oe.startsWith(ee[0])},"ends with":function(oe,ee){return oe.endsWith(ee[0])},"=":function(oe,ee){return oe===ee[0]},"!=":function(oe,ee){return oe!==ee[0]},"valid email":function(oe){var ee=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return ee.test(oe)},"valid url":function(oe){var ee=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return ee.test(oe)}},ae=function(oe,ee){return typeof ae[ee.type]=="function"?ee.allowBlank&&(typeof oe>"u"||oe===""||oe===null)?!0:ae[ee.type].call(this,oe,ee):null};ae.url=function(oe){var ee=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!ee.test(oe)},ae.email=function(oe){var ee=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(oe&&ee.test(oe))},ae.required=function(oe){return!!(oe&&oe.trim())},ae.empty=function(oe){return typeof oe>"u"||oe===null||typeof oe=="string"&&!oe.toString().trim()},ae["not exist"]=ae.empty,ae.notEmpty=function(oe){return!ae.empty(oe)},ae.exist=ae.notEmpty,ae.number=function(oe,ee){if(!j(oe))return!1;if(!ee||!ee.criteria)return!0;if(!X[ee.criteria])return!1;let fe=ee.value.map(function(Re){return parseFloat(Re)});return X[ee.criteria](oe,fe)},ae.login=function(oe){let ee=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(oe&&ee.test(oe))},ae.list=function(oe,ee){let fe=typeof oe;if(fe!=="string"&&fe!=="number")return!1;let Re;return typeof ee.value[0]=="string"?ee.source?Re=ee.source:Re=ee.value[0].split(","):Re=ee.value[0],Array.isArray(Re)?Re.findIndex(function(Je){return Je==oe})>-1:!1};const Pe=function(){let oe=new Date;return oe.setHours(0,0,0,0),oe},Oe={"one year ago":function(){let oe=Pe();return oe.setFullYear(oe.getFullYear()-1),oe},"one month ago":function(){let oe=Pe();return oe.setMonth(oe.getMonth()-1),oe},"one week ago":function(){let oe=Pe();return oe.setDate(oe.getDate()-7),oe},yesterday:function(){let oe=Pe();return oe.setDate(oe.getDate()-1),oe},today:Pe,tomorrow:function(){let oe=Pe();return oe.setDate(oe.getDate()+1),oe}};return ae.date=function(oe,ee){if(j(oe)&&oe>0&&oe<1e6&&(oe=H.numToDate(oe)),new Date(oe)=="Invalid Date")return!1;if(!ee||!ee.criteria)return!0;if(!P[ee.criteria])return!1;let fe=ee.value.map(function(Re){return typeof Re=="string"&&Oe[Re]?Oe[Re]().getTime():new Date(Re).getTime()});return P[ee.criteria](new Date(oe).getTime(),fe)},ae.text=function(oe,ee){if(typeof oe>"u"||oe===null)oe="";else if(typeof oe!="string")return!1;return!ee||!ee.criteria?!0:R[ee.criteria]?R[ee.criteria](oe,ee.value):!1},ae.textLength=function(oe,ee){return oe=oe.toString(),ae.number(oe.length,ee)},ae}var Ve=Ae();function He(){var j=function(X,P){var R={};R.options={};var ae={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(ee,fe){alert(fe)}};for(var Pe in ae)P&&P.hasOwnProperty(Pe)?R.options[Pe]=P[Pe]:R.options[Pe]=ae[Pe];R.options.validations||(R.options.validations={}),R.options.submitButton||(R.options.submitButton=X.querySelector("input[type=submit]")),R.options.submitButton&&R.options.url&&(R.options.submitButton.onclick=function(){R.save()}),R.options.validations.email||(R.options.validations.email=Ve.email),R.options.validations.length||(R.options.validations.length=Ve.length),R.options.validations.required||(R.options.validations.required=Ve.required),R.setUrl=function(ee){R.options.url=ee},R.load=function(){A({url:R.options.url,method:"GET",dataType:"json",queue:!0,success:function(ee){if(typeof R.options.onbeforeload=="function"){var fe=R.options.onbeforeload(X,ee);fe&&(ee=fe)}j.setElements(X,ee),typeof R.options.onload=="function"&&R.options.onload(X,ee)}})},R.save=function(){var ee=R.validate();if(ee)R.options.onerror(X,ee);else{var fe=j.getElements(X,!0);if(typeof R.options.onbeforesave=="function"){var fe=R.options.onbeforesave(X,fe);if(fe===!1)return}A({url:R.options.url,method:"POST",dataType:"json",data:fe,success:function(Re){typeof R.options.onsave=="function"&&R.options.onsave(X,fe,Re)}})}},R.remove=function(){if(typeof R.options.onbeforeremove=="function"){var ee=R.options.onbeforeremove(X,R);if(ee===!1)return!1}A({url:R.options.url,method:"DELETE",dataType:"json",success:function(fe){typeof R.options.onremove=="function"&&R.options.onremove(X,R,fe),R.reset()}})};var Oe=function(ee){ee.classList.add("error"),R.options.submitButton&&R.options.submitButton.setAttribute("disabled",!0);var fe=ee.getAttribute("data-error")||"There is an error in the form";return ee.setAttribute("title",fe),fe},oe=function(ee){var fe=!1;ee.classList.remove("error"),ee.removeAttribute("title");for(var Re=X.querySelectorAll("input, select, textarea, div[name]"),$e=0;$e<Re.length;$e++)Re[$e].getAttribute("data-validation")&&Re[$e].classList.contains("error")&&(fe=!0);R.options.submitButton&&(fe?R.options.submitButton.setAttribute("disabled",!0):R.options.submitButton.removeAttribute("disabled"))};return R.validateElement=function(ee){var fe=!1,Re=j.getValue(ee),$e=ee.getAttribute("data-validation");return typeof R.options.validations[$e]=="function"&&!R.options.validations[$e](Re,ee)?fe=Oe(ee):ee.classList.contains("error")&&oe(ee),fe},R.reset=function(){for(var ee=X.querySelectorAll("input, select, textarea, div[name]"),fe=0;fe<ee.length;fe++)ee[fe].getAttribute("name")&&(ee[fe].type=="checkbox"||ee[fe].type=="radio"?ee[fe].checked=!1:typeof ee[fe].val=="function"?ee[fe].val(""):ee[fe].value="")},R.validate=function(){for(var ee=[],fe=X.querySelectorAll("input, select, textarea, div[name]"),Re=0;Re<fe.length;Re++)if(fe[Re].getAttribute("data-validation")){var $e=R.validateElement(fe[Re]);$e&&ee.push($e)}return ee.length>0?ee.join("<br>"):!1},R.getError=function(){return!!R.validation()},R.setHash=function(){return R.getHash(j.getElements(X))},R.getHash=function(ee){var fe=0,Re,$e;if(ee.length===0)return fe;for(Re=0;Re<ee.length;Re++)$e=ee.charCodeAt(Re),fe=(fe<<5)-fe+$e,fe|=0;return fe},R.isChanged=function(){var ee=R.setHash();return R.options.currentHash!=ee},R.resetTracker=function(){R.options.currentHash=R.setHash(),R.options.ignore=!1},R.setIgnore=function(ee){R.options.ignore=!!ee},setTimeout(function(){R.options.currentHash=R.setHash()},1e3),X.addEventListener("keyup",function(ee){ee.target.getAttribute("data-validation")&&R.validateElement(ee.target)}),j.hasEvents||(window.addEventListener("beforeunload",function(ee){if(R.isChanged()&&R.options.ignore==!1){var fe=R.options.message?R.options.message:"o/";return fe?(typeof ee>"u"&&(ee=window.event),ee&&(ee.returnValue=fe),fe):void 0}}),j.hasEvents=!0),X.form=R,R};return j.getValue=function(X){var P=null;if(X.type=="checkbox")X.checked==!0&&(P=X.value||!0);else if(X.type=="radio")X.checked==!0&&(P=X.value);else if(X.type=="file")P=X.files;else if(X.tagName=="select"&&X.multiple==!0){P=[];for(var R=X.querySelectorAll("options[selected]"),ae=0;ae<R.length;ae++)P.push(R[ae].value)}else typeof X.val=="function"?P=X.val():P=X.value||"";return P},j.getElements=function(X,P){for(var R={},ae=null,Pe=X.querySelectorAll("input, select, textarea, div[name]"),Oe=0;Oe<Pe.length;Oe++)(ae=Pe[Oe].getAttribute("name"))&&(R[ae]=j.getValue(Pe[Oe])||"");return P==!0?R:JSON.stringify(R)},j.setElements=function(X,P){for(var R=null,ae=null,Pe=X.querySelectorAll("input, select, textarea, div[name]"),Oe=0;Oe<Pe.length;Oe++){var oe=Pe[Oe].getAttribute("type");if(R=Pe[Oe].getAttribute("name")){if(R=R.replace(new RegExp(/\[(.*?)\]/ig),".$1"),ae=null,R.match(/\./)){var ee=E.call(P,R)||"";typeof ee<"u"&&(ae=ee)}else typeof P[R]<"u"&&(ae=P[R]);ae!==null&&(oe=="checkbox"||oe=="radio"?Pe[Oe].checked=!!ae:oe=="file"||(typeof Pe[Oe].val=="function"?Pe[Oe].val(ae):Pe[Oe].value=ae))}}},j}var be=He();function qe(){var j=function(){var P=null,R=function(oe){if(oe.which==27)for(var ee=document.querySelectorAll(".jmodal"),fe=0;fe<ee.length;fe++)ee[fe].parentNode.modal.close()},ae=function(oe){let ee=oe.composedPath();var fe=m.findElement(ee[0],"jmodal");if(fe){var Re=fe.getBoundingClientRect();if(oe.changedTouches&&oe.changedTouches[0])var $e=oe.changedTouches[0].clientX,Je=oe.changedTouches[0].clientY;else var $e=oe.clientX,Je=oe.clientY;Re.width-($e-Re.left)<50&&Je-Re.top<50&&fe.parentNode.modal.close()}P&&(P.element.style.cursor="auto",P=null)},Pe=function(oe){let ee=oe.composedPath();var fe=m.findElement(ee[0],"jmodal");if(fe){var Re=fe.getBoundingClientRect();if(oe.changedTouches&&oe.changedTouches[0])var $e=oe.changedTouches[0].clientX,Je=oe.changedTouches[0].clientY;else var $e=oe.clientX,Je=oe.clientY;Re.width-($e-Re.left)<50&&Je-Re.top<50||Je-Re.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),P={left:Re.left,top:Re.top,x:oe.clientX,y:oe.clientY,width:Re.width,height:Re.height,element:fe})}},Oe=function(oe){if(P){if(oe=oe||window.event,oe.buttons)var ee=oe.buttons;else if(oe.button)var ee=oe.button;else var ee=oe.which;ee?(P.element.style.top=P.top+(oe.clientY-P.y)+P.height/2+"px",P.element.style.left=P.left+(oe.clientX-P.x)+P.width/2+"px",P.element.style.cursor="move"):P.element.style.cursor="auto"}};document.addEventListener("keydown",R),document.addEventListener("mouseup",ae),document.addEventListener("mousedown",Pe),document.addEventListener("mousemove",Oe)},X=function(P,R){var ae={};ae.options={};var Pe={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var Oe in Pe)R&&R.hasOwnProperty(Oe)?ae.options[Oe]=R[Oe]:ae.options[Oe]=Pe[Oe];!ae.options.title&&P.getAttribute("title")&&(ae.options.title=P.getAttribute("title"));for(var oe=document.createElement("div");P.children[0];)oe.appendChild(P.children[0]);for(ae.title=document.createElement("div"),ae.title.className="jmodal_title",ae.options.icon&&ae.title.setAttribute("data-icon",ae.options.icon),ae.content=document.createElement("div"),ae.content.className="jmodal_content",ae.content.innerHTML=P.innerHTML;oe.children[0];)ae.content.appendChild(oe.children[0]);if(ae.container=document.createElement("div"),ae.container.className="jmodal",ae.container.appendChild(ae.title),ae.container.appendChild(ae.content),ae.options.padding&&(ae.content.style.padding=ae.options.padding),ae.options.width&&(ae.container.style.width=ae.options.width),ae.options.height&&(ae.container.style.height=ae.options.height),ae.options.title){var ee=document.createElement("h4");ee.innerText=ae.options.title,ae.title.appendChild(ee)}if(P.innerHTML="",P.style.display="none",P.appendChild(ae.container),ae.options.backdrop){var fe=document.createElement("div");fe.className="jmodal_backdrop",fe.onclick=function(){ae.close()},P.appendChild(fe)}return ae.open=function(){P.style.display="block";var Re=ae.container.getBoundingClientRect();m.getWindowWidth()<Re.width?(ae.container.style.top="",ae.container.style.left="",ae.container.classList.add("jmodal_fullscreen"),D.slideBottom(ae.container,1)):ae.options.backdrop&&(fe.style.display="block"),typeof ae.options.onopen=="function"&&ae.options.onopen(P,ae)},ae.resetPosition=function(){ae.container.style.top="",ae.container.style.left=""},ae.isOpen=function(){return P.style.display!="none"},ae.close=function(){ae.isOpen()&&(P.style.display="none",ae.options.backdrop&&(fe.style.display=""),ae.container.classList.remove("jmodal_fullscreen"),typeof ae.options.onclose=="function"&&ae.options.onclose(P,ae))},ae.options.url?A({url:ae.options.url,method:"GET",dataType:"text/html",success:function(Re){ae.content.innerHTML=Re,ae.options.closed||ae.open(),typeof ae.options.onload=="function"&&ae.options.onload(ae)}}):(ae.options.closed||ae.open(),typeof ae.options.onload=="function"&&ae.options.onload(ae)),P.modal=ae,j(),j=function(){},ae};return X}var le=qe();function pe(){var j=function(X){var P={};P.options={};var R={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var ae in R)X&&X.hasOwnProperty(ae)?P.options[ae]=X[ae]:P.options[ae]=R[ae];var Pe=document.createElement("div");Pe.className="jnotification",P.options.error&&Pe.classList.add("jnotification-error");var Oe=document.createElement("div");Oe.className="jnotification-container",Pe.appendChild(Oe);var oe=document.createElement("div");oe.className="jnotification-header",Oe.appendChild(oe);var ee=document.createElement("div");if(ee.className="jnotification-image",oe.appendChild(ee),P.options.icon){var fe=document.createElement("img");fe.src=P.options.icon,ee.appendChild(fe)}var Re=document.createElement("div");if(Re.className="jnotification-name",Re.innerHTML=P.options.name,oe.appendChild(Re),P.options.closeable==!0){var $e=document.createElement("div");$e.className="jnotification-close",$e.onclick=function(){P.hide()},oe.appendChild($e)}var Je=document.createElement("div");Je.className="jnotification-date",oe.appendChild(Je);var Be=document.createElement("div");if(Be.className="jnotification-content",Oe.appendChild(Be),P.options.title){var ot=document.createElement("div");ot.className="jnotification-title",ot.innerHTML=P.options.title,Be.appendChild(ot)}var gt=document.createElement("div");if(gt.className="jnotification-message",gt.innerHTML=P.options.message,Be.appendChild(gt),P.show=function(){document.body.appendChild(Pe),m.getWindowWidth()>800?D.fadeIn(Pe):D.slideTop(Pe,1)},P.hide=function(){m.getWindowWidth()>800?D.fadeOut(Pe,function(){Pe.parentNode&&(Pe.parentNode.removeChild(Pe),b&&clearTimeout(b))}):D.slideTop(Pe,0,function(){Pe.parentNode&&(Pe.parentNode.removeChild(Pe),b&&clearTimeout(b))})},P.show(),P.options.autoHide==!0)var b=setTimeout(function(){P.hide()},P.options.timeout);return m.getWindowWidth()<800&&Pe.addEventListener("swipeup",function(q){P.hide(),q.preventDefault(),q.stopPropagation()}),P};return j.isVisible=function(){var X=document.querySelector(".jnotification");return!!(X&&X.parentNode)},j}var Se=pe();function Ye(j,X){var P={};P.options={};var R={value:0,onchange:null,width:null};for(var ae in R)X&&X.hasOwnProperty(ae)?P.options[ae]=X[ae]:P.options[ae]=R[ae];j.classList.add("jprogressbar"),j.setAttribute("tabindex",1),j.setAttribute("data-value",P.options.value);var Pe=document.createElement("div");Pe.style.width=P.options.value+"%",Pe.style.color="#fff",j.appendChild(Pe),P.options.width&&(j.style.width=P.options.width),P.setValue=function(oe){oe=parseInt(oe),P.options.value=oe,Pe.style.width=oe+"%",j.setAttribute("data-value",oe+"%"),oe<6?j.style.color="#000":j.style.color="#fff",P.options.value=oe,typeof P.options.onchange=="function"&&P.options.onchange(j,oe),j.value!=P.options.value&&(j.value=P.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},P.getValue=function(){return P.options.value};var Oe=function(oe){if(oe.which){var ee=j.getBoundingClientRect();if(oe.changedTouches&&oe.changedTouches[0]){var fe=oe.changedTouches[0].clientX;oe.changedTouches[0].clientY}else{var fe=oe.clientX;oe.clientY}P.setValue(Math.round((fe-ee.left)/ee.width*100))}};return"touchstart"in document.documentElement?(j.addEventListener("touchstart",Oe),j.addEventListener("touchend",Oe)):(j.addEventListener("mousedown",Oe),j.addEventListener("mousemove",Oe)),j.change=P.setValue,j.val=function(oe){if(oe===void 0)return P.getValue();P.setValue(oe)},j.progressbar=P,P}function Fe(j,X){if(j.rating)return j.rating.setOptions(X,!0);var P={};P.options={},P.setOptions=function(ae,Pe){var Oe={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var oe in Oe)ae&&ae.hasOwnProperty(oe)?P.options[oe]=ae[oe]:(typeof P.options[oe]>"u"||Pe===!0)&&(P.options[oe]=Oe[oe]);j.innerHTML="";for(var ee=0;ee<P.options.number;ee++){var fe=document.createElement("div");fe.setAttribute("data-index",ee+1),fe.setAttribute("title",P.options.tooltip[ee]),j.appendChild(fe)}if(P.options.value)for(var ee=0;ee<P.options.number;ee++)ee<P.options.value&&j.children[ee].classList.add("jrating-selected");return P},P.setValue=function(ae){for(var Pe=0;Pe<P.options.number;Pe++)Pe<ae?j.children[Pe].classList.add("jrating-selected"):(j.children[Pe].classList.remove("jrating-over"),j.children[Pe].classList.remove("jrating-selected"));P.options.value=ae,typeof P.options.onchange=="function"&&P.options.onchange(j,ae),j.value!=P.options.value&&(j.value=P.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},P.getValue=function(){return P.options.value};var R=function(){P.setOptions(X),j.classList.add("jrating"),j.addEventListener("click",function(ae){var Pe=ae.target.getAttribute("data-index");Pe!=null&&(Pe==P.options.value?P.setValue(0):P.setValue(Pe))}),j.addEventListener("mouseover",function(ae){for(var Pe=ae.target.getAttribute("data-index"),Oe=0;Oe<P.options.number;Oe++)Oe<Pe?j.children[Oe].classList.add("jrating-over"):j.children[Oe].classList.remove("jrating-over")}),j.addEventListener("mouseout",function(ae){for(var Pe=0;Pe<P.options.number;Pe++)j.children[Pe].classList.remove("jrating-over")}),j.change=P.setValue,j.val=function(ae){if(ae===void 0)return P.getValue();P.setValue(ae)},j.rating=P};return R(),P}function je(j,X){if(j.search)return j.search;var P=null,R=function(fe){if(fe.target.classList.contains("jsearch_item"))var Re=fe.target;else var Re=fe.target.parentNode;oe.selectIndex(Re),fe.preventDefault()},ae=function(fe){if(typeof oe.options.onsearch=="function"){var Re=oe.options.onsearch(oe,fe);Re&&(fe=Re)}if(ee.innerHTML="",!fe.length)j.style.display="";else{j.style.display="block";for(var $e=fe.length<11?fe.length:10,Je=0;Je<$e;Je++){if(typeof fe[Je]=="string")var Be=fe[Je],ot=fe[Je];else{var Be=fe[Je].text;!Be&&fe[Je].name&&(Be=fe[Je].name);var ot=fe[Je].value;!ot&&fe[Je].id&&(ot=fe[Je].id)}var gt=document.createElement("div");gt.setAttribute("data-value",ot),gt.setAttribute("data-text",Be),gt.className="jsearch_item",fe[Je].id&&gt.setAttribute("id",fe[Je].id),oe.options.forceSelect&&Je==0&&gt.classList.add("selected");var b=document.createElement("img");fe[Je].image?b.src=fe[Je].image:b.style.display="none",gt.appendChild(b);var q=document.createElement("div");q.innerHTML=Be,gt.appendChild(q),ee.appendChild(gt)}}},Pe=function(fe){if(fe!=oe.terms)if(oe.terms=fe,oe.options.forceSelect?P=0:P=null,Array.isArray(oe.options.data)){var Re=function(Je){if(typeof Je=="string"){if((""+Je).toLowerCase().search(fe.toLowerCase())>=0)return!0}else for(var Be in Je){var ot=Je[Be];if((""+ot).toLowerCase().search(fe.toLowerCase())>=0)return!0}return!1},$e=oe.options.data.filter(function(Je){return Re(Je)});ae($e)}else A({url:oe.options.data+fe,method:"GET",dataType:"json",success:function(Je){ae(Je)}})},Oe=null,oe=function(fe){Oe&&clearTimeout(Oe),Oe=setTimeout(function(){Pe(fe)},500)};X.forceSelect===null&&(X.forceSelect=!0),oe.options={data:X.data||null,input:X.input||null,searchByNode:X.searchByNode||null,onselect:X.onselect||null,forceSelect:X.forceSelect,onsearch:X.onsearch||null,onbeforesearch:X.onbeforesearch||null},oe.selectIndex=function(fe){var Re=fe.getAttribute("id"),$e=fe.getAttribute("data-text"),Je=fe.getAttribute("data-value"),Be=fe.children[0].src||"";typeof oe.options.onselect=="function"&&oe.options.onselect(oe,$e,Je,Re,Be),oe.close()},oe.open=function(){j.style.display="block"},oe.close=function(){Oe&&clearTimeout(Oe),oe.terms="",ee.innerHTML="",j.style.display=""},oe.isOpened=function(){return!!j.style.display},oe.keydown=function(fe){oe.isOpened()&&(fe.key=="Enter"?P!==null&&ee.children[P]?(oe.selectIndex(ee.children[P]),fe.preventDefault()):oe.close():fe.key==="ArrowUp"?(P!==null&&ee.children[0]&&(ee.children[P].classList.remove("selected"),!oe.options.forceSelect&&P===0?P=null:(P=Math.max(0,P-1),ee.children[P].classList.add("selected"))),fe.preventDefault()):fe.key==="ArrowDown"&&(P==null?P=-1:ee.children[P].classList.remove("selected"),P<9&&ee.children[P+1]&&P++,ee.children[P].classList.add("selected"),fe.preventDefault()))},oe.keyup=function(fe){if(!oe.options.searchByNode&&oe.options.input)if(oe.options.input.tagName==="DIV")var Re=oe.options.input.innerText;else var Re=oe.options.input.value;else{var $e=m.getNode();if($e)var Re=$e.innerText}if(typeof oe.options.onbeforesearch=="function"){var Je=oe.options.onbeforesearch(oe,Re);if(Je)Re=Je;else if(Je===!1)return}oe(Re)},oe.blur=function(fe){oe.close()},oe.options.input&&(oe.options.input.addEventListener("keyup",oe.keyup),oe.options.input.addEventListener("keydown",oe.keydown),oe.options.input.addEventListener("blur",oe.blur));var ee=document.createElement("div");return ee.classList.add("jsearch_container"),ee.onmousedown=R,j.appendChild(ee),j.classList.add("jsearch"),j.search=oe,oe}function rt(j,X){var P={};if(P.options={},P.currentImage=null,X&&(P.options=X),j.setAttribute("tabindex","900"),P.options.items=[],!j.classList.contains("jslider")){if(j.classList.add("jslider"),j.classList.add("unselectable"),P.options.height&&(j.style.minHeight=parseInt(P.options.height)+"px"),P.options.width&&(j.style.width=parseInt(P.options.width)+"px"),P.options.grid){j.classList.add("jslider-grid");var R=j.children.length;R>4&&j.setAttribute("data-total",R-4),j.setAttribute("data-number",R>4?4:R)}var ae=document.createElement("div");if(ae.classList.add("jslider-counter"),j.children.length>0)for(var Pe=0;Pe<j.children.length;Pe++){P.options.items.push(j.children[Pe]);var Oe=document.createElement("div");Oe.onclick=function(){var $e=Array.prototype.slice.call(ae.children).indexOf(this);P.show(P.currentImage=P.options.items[$e])},ae.appendChild(Oe)}var oe=document.createElement("div");oe.className="jslider-caption";var ee=document.createElement("div"),fe=document.createElement("div");fe.className="jslider-close",fe.innerHTML="",fe.onclick=function(){P.close()},ee.appendChild(oe),ee.appendChild(fe)}P.updateCounter=function($e){for(var Je=0;Je<ae.children.length;Je++)if(ae.children[Je].classList.contains("jslider-counter-focus")){ae.children[Je].classList.remove("jslider-counter-focus");break}ae.children[$e].classList.add("jslider-counter-focus")},P.show=function($e){if(!$e)var $e=j.children[0];j.classList.add("jslider-focus"),j.classList.remove("jslider-grid"),j.appendChild(ee),j.appendChild(ae);var Je=P.options.items.indexOf($e);P.updateCounter(Je);for(var Be=0;Be<j.children.length;Be++)j.children[Be].style.display="";$e.style.display="block",$e.previousElementSibling?j.classList.add("jslider-left"):j.classList.remove("jslider-left"),$e.nextElementSibling&&$e.nextElementSibling.tagName=="IMG"?j.classList.add("jslider-right"):j.classList.remove("jslider-right"),P.currentImage=$e,P.currentImage.offsetHeight>P.currentImage.offsetWidth&&P.currentImage.classList.add("jslider-vertical"),ee.children[0].innerText=P.currentImage.getAttribute("title")},P.open=function(){P.show(),typeof P.options.onopen=="function"&&P.options.onopen(j)},P.close=function(){j.classList.remove("jslider-focus"),j.classList.remove("jslider-left"),j.classList.remove("jslider-right"),P.options.grid&&j.classList.add("jslider-grid");for(var $e=0;$e<j.children.length;$e++)j.children[$e].style.display="";ae.remove(),ee.remove(),P.currentImage=null,typeof P.options.onclose=="function"&&P.options.onclose(j)},P.reset=function(){j.innerHTML=""},P.next=function(){var $e=P.currentImage.nextElementSibling;$e&&$e.tagName==="IMG"&&P.show(P.currentImage.nextElementSibling)},P.prev=function(){P.currentImage.previousElementSibling&&P.show(P.currentImage.previousElementSibling)};var Re=function($e){if($e.target.tagName=="IMG")P.show($e.target);else if(!$e.target.classList.contains("jslider-close")&&!($e.target.parentNode.classList.contains("jslider-counter")||$e.target.classList.contains("jslider-counter"))){var Je=$e.offsetX||$e.changedTouches[0].clientX;$e.target.clientWidth-Je<40?P.next():Je<40&&P.prev()}};return"ontouchend"in document.documentElement?j.addEventListener("touchend",Re):j.addEventListener("mouseup",Re),j.addEventListener("swipeleft",function($e){P.next(),$e.preventDefault(),$e.stopPropagation()}),j.addEventListener("swiperight",function($e){P.prev(),$e.preventDefault(),$e.stopPropagation()}),j.addEventListener("keydown",function($e){$e.which==27&&P.close()}),j.slider=P,P}function Ue(j,X){if(j.tags)return j.tags.setOptions(X,!0);var P={type:"tags"};P.options={};var R=function(){return!!(P.options.limit&&j.children.length>=P.options.limit)},ae=null,Pe=null;P.setOptions=function(z,ie){var _e={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var J in _e)z&&z.hasOwnProperty(J)?P.options[J]=z[J]:(typeof P.options[J]>"u"||ie===!0)&&(P.options[J]=_e[J]);return P.options.placeholder?j.setAttribute("data-placeholder",P.options.placeholder):j.removeAttribute("data-placeholder"),j.placeholder=P.options.placeholder,P.setValue(P.options.value),fe(),P.options.search?Pe||(Pe=document.createElement("div"),j.parentNode.insertBefore(Pe,j.nextSibling),ae=je(Pe,{data:P.options.search,onselect:function(me,L,Z){P.selectIndex(L,Z)}})):Pe&&(ae=null,Pe.remove(),Pe=null),P},P.add=function(z,ie){if(typeof P.options.onbeforechange=="function"){var _e=P.options.onbeforechange(j,P,P.options.value,z);if(_e===!1)return!1;_e!=null&&(z=_e)}if(ae&&ae.close(),R())typeof P.options.onlimit=="function"?P.options.onlimit(P,P.options.limit):alert(c.translate("You reach the limit number of entries")+" "+P.options.limit);else{var J=m.getNode();if(J&&J.parentNode&&J.parentNode.classList.contains("jtags")&&J.nextSibling&&!(J.nextSibling.innerText&&J.nextSibling.innerText.trim()))me=J.nextSibling;else{if(j.lastChild&&(j.lastChild.innerText.trim()||j.removeChild(j.lastChild)),!z||typeof z=="string")var me=oe(z,z,J);else for(var L=0;L<=z.length;L++)if(!R()){if(!z[L]||typeof z[L]=="string")var Z=z[L]||"",de=null;else var Z=z[L].text,de=z[L].value;var me=oe(Z,de)}ee()}ie&&Oe(me)}},P.setLimit=function(z){for(P.options.limit=z,j.children.length-z;j.children.length>z;)j.removeChild(j.lastChild)},P.remove=function(z){z.parentNode.removeChild(z),j.children.length?ee():P.add("",!0),typeof P.options.onremoveitem=="function"&&P.options.onremoveitem(j,P,z)},P.getData=function(){for(var z=[],ie=0;ie<j.children.length;ie++){var _e=j.children[ie].innerText.replace(`
`,""),J=j.children[ie].getAttribute("data-value");J||(J=_e),(_e||J)&&z.push({text:_e,value:J})}return z},P.getValue=function(z){var ie=null;if(z!=null)ie=j.children[z].getAttribute("data-value"),ie||(ie=j.children[z].innerText.replace(`
`,""));else{for(var _e=[],J=0;J<j.children.length;J++)ie=j.children[J].innerText.replace(`
`,""),ie&&_e.push(P.getValue(J));ie=_e.join(",")}return ie},P.setValue=function(z){if(!z)P.reset();else if(j.value!=z)if(Array.isArray(z))P.add(z);else{var ie=(""+z).trim(),_e=$e(ie);j.innerHTML="",P.add(_e)}},P.reset=function(){j.classList.add("jtags-empty"),j.innerHTML="<div></div>",ee()},P.isValid=function(){for(var z=0,ie=0;ie<j.children.length;ie++)j.children[ie].classList.contains("jtags_error")&&z++;return z==0},P.selectIndex=function(z,ie){var _e=m.getNode();_e&&(_e.innerText=z,ie&&_e.setAttribute("data-value",ie),_e.classList.remove("jtags_error"),R()||P.add("",!0))},P.search=function(z){z.innerText},P.destroy=function(){j.removeEventListener("mouseup",b),j.removeEventListener("keydown",Be),j.removeEventListener("keyup",ot),j.removeEventListener("paste",gt),j.removeEventListener("focus",q),j.removeEventListener("blur",F),j.parentNode.removeChild(j)};var Oe=function(z){if(j.children.length){var ie=document.createRange(),_e=window.getSelection();if(!z)var z=j.childNodes[j.childNodes.length-1];ie.setStart(z,z.length),ie.collapse(!0),_e.removeAllRanges(),_e.addRange(ie),j.scrollLeft=j.scrollWidth}},oe=function(z,ie,_e){var J=document.createElement("div");return J.textContent=z||"",ie&&J.setAttribute("data-value",ie),_e&&_e.parentNode.classList.contains("jtags")?j.insertBefore(J,_e.nextSibling):j.appendChild(J),J},ee=function(){var z=P.getValue();z!=P.options.value&&(P.options.value=z,typeof P.options.onchange=="function"&&P.options.onchange(j,P,P.options.value),j.value!=P.options.value&&(j.value=P.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))),fe()},fe=function(){for(var z=0;z<j.children.length;z++)j.children[z].tagName==="DIV"&&(P.getValue(z)?(j.children[z].classList.add("jtags_label"),typeof P.options.validation=="function"&&P.getValue(z)?P.options.validation(j.children[z],j.children[z].innerText,j.children[z].getAttribute("data-value"))?j.children[z].classList.remove("jtags_error"):j.children[z].classList.add("jtags_error"):j.children[z].classList.remove("jtags_error")):j.children[z].classList.remove("jtags_label"));Re()},Re=function(){j.innerText.trim()?j.classList.remove("jtags-empty"):(!j.children.length||j.children[0].tagName==="BR")&&(j.innerHTML="",Oe(oe()))},$e=function(z){var ie=[],_e="";if(z=z.trim(),z){for(var J=0;J<z.length;J++)z[J]==","||z[J]==";"||z[J]==`
`?_e&&(ie.push(_e.trim()),_e=""):_e+=z[J];_e&&ie.push(_e)}return ie},Je=0,Be=function(z){if(Je=window.getSelection().anchorOffset,Re(),z.key==="Tab"||z.key===";"||z.key===","){var ie=window.getSelection().anchorOffset;ie>1&&(R()?typeof P.options.onlimit=="function"&&P.options.onlimit(P,P.options.limit):P.add("",!0)),z.preventDefault()}else if(z.key=="Enter"){if(!ae||!ae.isOpened()){var ie=window.getSelection().anchorOffset;ie>1&&(R()||P.add("",!0)),z.preventDefault()}}else z.key=="Backspace"&&j.children.length==1&&window.getSelection().anchorOffset<1&&z.preventDefault();ae&&ae.keydown(z),Re()},ot=function(z){if(z.which==39){var ie=window.getSelection().anchorOffset;ie>1&&ie==Je&&P.add("",!0)}else z.which==13||z.which==38||z.which==40?z.preventDefault():ae&&ae.keyup(z);fe()},gt=function(z){if(z.clipboardData||z.originalEvent.clipboardData)var ie=(z.originalEvent||z).clipboardData.getData("text/plain");else if(window.clipboardData)var ie=window.clipboardData.getData("Text");var _e=$e(ie);if(typeof P.options.onbeforepaste=="function"){var J=P.options.onbeforepaste(j,P,_e);if(J===!1)return z.preventDefault(),!1;J&&(_e=J)}_e.length>1?(P.add(_e,!0),z.preventDefault()):_e[0]&&(document.execCommand("insertText",!1,_e[0]),z.preventDefault())},b=function(z){if(z.target.parentNode&&z.target.parentNode.classList.contains("jtags")&&(z.target.classList.contains("jtags_label")||z.target.classList.contains("jtags_error"))){var ie=z.target.getBoundingClientRect();ie.width-(z.clientX-ie.left)<16&&P.remove(z.target)}z.target==j&&Oe()},q=function(){j.classList.contains("jtags-focus")||((!j.children.length||P.getValue(j.children.length-1))&&(R()||oe("")),typeof P.options.onfocus=="function"&&P.options.onfocus(j,P,P.getValue()),j.classList.add("jtags-focus"))},F=function(){if(j.classList.contains("jtags-focus")){ae&&ae.close();for(var z=0;z<j.children.length-1;z++)P.getValue(z)||j.removeChild(j.children[z]);ee(),j.classList.remove("jtags-focus"),typeof P.options.onblur=="function"&&P.options.onblur(j,P,P.getValue())}},W=function(){"touchend"in document.documentElement?j.addEventListener("touchend",b):j.addEventListener("mouseup",b),j.addEventListener("keydown",Be),j.addEventListener("keyup",ot),j.addEventListener("paste",gt),j.addEventListener("focus",q),j.addEventListener("blur",F),j.setAttribute("contenteditable",!0),j.classList.add("jtags"),P.setOptions(X),typeof P.options.onload=="function"&&P.options.onload(j,P),j.change=P.setValue,j.val=function(z){if(z===void 0)return P.getValue();P.setValue(z)},j.tags=P};return W(),P}function Xe(j,X){var P={};P.options={};var R={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var ae in R)X&&X.hasOwnProperty(ae)?P.options[ae]=X[ae]:P.options[ae]=R[ae];P.options.multiple==!0&&j.setAttribute("data-multiple",!0),j.content=[],j.classList.add("jupload"),P.options.input==!0&&j.classList.add("input"),P.add=function(ee){if(P.options.multiple==!1&&(j.content=[],j.innerText=""),P.options.type=="image"){var fe=document.createElement("img");fe.setAttribute("src",ee.file),fe.setAttribute("tabindex",-1),j.getAttribute("name")||(fe.className="jfile",fe.content=ee),j.appendChild(fe)}else{if(ee.name)var Re=ee.name;else var Re=ee.file;var $e=document.createElement("div");$e.innerText=Re||P.options.type,$e.classList.add("jupload-item"),$e.setAttribute("tabindex",-1),j.appendChild($e)}ee.content&&(ee.file=m.guid()),j.content.push(ee),typeof P.options.onchange=="function"&&P.options.onchange(j,ee)},P.addFromFile=function(ee){var fe=ee.type.split("/");if(fe[0]==P.options.type){var Re=new FileReader;Re.addEventListener("load",function($e){var Je={file:$e.srcElement.result,extension:ee.name.substr(ee.name.lastIndexOf(".")+1),name:ee.name,size:ee.size,lastmodified:ee.lastModified,content:$e.srcElement.result};P.add(Je)}),Re.readAsDataURL(ee)}else alert(c.translate("This extension is not allowed"))},P.addFromUrl=function(ee){if(ee.substr(0,4)!="data"&&!P.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(ee.substr(0,4)=="data"){var fe=ee.split(";");fe=fe[0].split("/");var Re=fe[0].replace("data:","");if(Re==P.options.type){var $e={file:ee,name:"",extension:fe[1],content:ee};P.add($e)}else alert(P.options.text.extensionNotAllowed)}else{var fe=ee.substr(ee.lastIndexOf(".")+1);ee=P.options.remoteParser+ee,A({url:ee,type:"GET",dataType:"blob",success:function(Be){}})}};var Pe=P.options.type+"/"+P.options.extension,Oe=document.createElement("input");Oe.type="file",Oe.setAttribute("accept",Pe),Oe.onchange=function(){for(var ee=0;ee<this.files.length;ee++)P.addFromFile(this.files[ee])},P.options.multiple==!0&&Oe.setAttribute("multiple",!0);var oe=null;return j.addEventListener("click",function(ee){oe=null,!j.children.length||ee.target===j?m.click(Oe):ee.target.parentNode==j&&(oe=ee.target)}),j.addEventListener("dblclick",function(ee){m.click(Oe)}),j.addEventListener("dragenter",function(ee){j.style.border="1px dashed #000"}),j.addEventListener("dragleave",function(ee){j.style.border="1px solid #eee"}),j.addEventListener("dragstop",function(ee){j.style.border="1px solid #eee"}),j.addEventListener("dragover",function(ee){ee.preventDefault()}),j.addEventListener("keydown",function(ee){if(oe&&ee.which==46){var fe=Array.prototype.indexOf.call(j.children,oe);fe>=0&&(j.content.splice(fe,1),oe.remove(),oe=null)}}),j.addEventListener("drop",function(ee){ee.preventDefault(),ee.stopPropagation();var fe=(ee.originalEvent||ee).dataTransfer.getData("text/html"),Re=(ee.originalEvent||ee).dataTransfer.files;if(Re.length)for(var $e=0;$e<ee.dataTransfer.files.length;$e++)P.addFromFile(ee.dataTransfer.files[$e]);else if(fe){P.options.multiple==!1&&(j.innerText="");var Je=document.createElement("div");Je.innerHTML=fe;var Be=Je.querySelectorAll("img");if(Be.length)for(var $e=0;$e<Be.length;$e++)P.addFromUrl(Be[$e].src)}return j.style.border="1px solid #eee",!1}),j.val=function(ee){if(ee===void 0)return j.content&&j.content.length?j.content:null;if(j.innerText="",j.content=[],ee)if(Array.isArray(ee))for(var fe=0;fe<ee.length;fe++)typeof ee[fe]=="string"?P.add({file:ee[fe]}):P.add(ee[fe]);else typeof ee=="string"&&P.add({file:ee})},j.upload=j.image=P,P}var et=o(195),Qe=o.n(et),st={...c,...m,version:"5.8.5",setExtensions:function(j){if(typeof j=="object")for(var X=Object.keys(j),P=0;P<X.length;P++)st[X[P]]=j[X[P]]},tracking:g,path:E,sorting:_,lazyLoading:S,ajax:A,animation:D,calendar:re,color:ve,contextmenu:Ie,dropdown:Ne,editor:te,floating:ue,form:be,mask:K,modal:le,notification:Se,palette:Le,picker:at,progressbar:Ye,rating:Fe,search:je,slider:rt,tabs:he,tags:Ue,toolbar:nt,upload:Xe,validations:Ve};st.image=Xe,st.image.create=function(j){var X=document.createElement("img");return X.setAttribute("src",j.file),X.className="jfile",X.setAttribute("tabindex",-1),X.content=j,X},st.tracker=be,st.loading=D.loading,st.sha512=Qe(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const j=function(z,ie){return z[ie.type]&&z[ie.type]==ie||z.component&&z.component==ie?!0:z.parentNode?j(z.parentNode,ie):!1},X=function(z){let ie=window.jSuitesStateControl;if(ie&&ie.length>0)for(let _e=0;_e<ie.length;_e++)ie[_e]&&!j(z,ie[_e])&&ie[_e].close()};let P=15,R=!1,ae={x:null,y:null},Pe=document.createElement("div");Pe.classList.add("jtooltip");const Oe=function(z){return z&&(z.shadowRoot||z.tagName&&z.tagName.includes("-"))},oe=function(z){let ie,_e,J=z.path||z.composedPath&&z.composedPath();return J?(_e=J[0],_e&&Oe(_e)&&!_e.shadowRoot&&z.toElement&&(_e=z.toElement)):(z.target&&Oe(z.target)?ie=z.target.shadowRoot:ie=document,_e=ie.elementFromPoint(x,y)),_e},ee=function(z){if(z.changedTouches&&z.changedTouches[0])var ie=z.changedTouches[0].clientX,_e=z.changedTouches[0].clientY;else var ie=z.clientX,_e=z.clientY;let J=oe(z),me=J&&J.tagName==="DIV"&&J.getAttribute("contentEditable"),L=st.findElement(J,"jpanel");if(L&&!L.classList.contains("readonly")&&!me){let Z=L.getBoundingClientRect(),de=0;L.style.rotate&&(de=parseFloat(L.style.rotate));let Ee="move";J.getAttribute("data-action")?Ee=J.getAttribute("data-action"):L.style.cursor?Ee="resize":L.style.cursor="move",R={action:Ee,a:de,e:L,x:ie,y:_e,l:Z.left,t:Z.top,b:Z.bottom,r:Z.right,w:Z.width,h:Z.height,d:L.style.cursor,actioned:!1},L.style.width||(L.style.width=Z.width+"px"),L.style.height||(L.style.height=Z.height+"px")}else R=!1;X(J),ot(z)},fe=function(z,ie,_e,J,me,L){const Z=_e-z,de=J-ie,Ee=me-z,ye=L-ie;let Ge=Math.atan2(de,Z),ft=Math.atan2(ye,Ee)-Ge;return ft=ft*(180/Math.PI),ft<0&&(ft+=360),ft},Re=function(z){R&&R.e&&(typeof R.e.refresh=="function"&&ae.actioned&&R.e.refresh(),R.e.style.cursor=""),ae={x:null,y:null},R=!1},$e=function(z){if(R){let L=z.clientX||z.pageX,Z=z.clientY||z.pageY;if(ae.x==null&&ae.y==null&&(ae.x=L,ae.y=Z),R.action==="move"){var ie=L-ae.x,_e=Z-ae.y,J=R.e.offsetTop+_e,me=R.e.offsetLeft+ie;R.e.style.top=J+"px",R.e.style.left=me+"px",typeof R.e.refresh=="function"&&(ae.actioned=!0,R.e.refresh("position",J,me))}else if(R.action==="rotate"){let de=R.l+R.w/2,Ee=R.t+R.h/2,ye=fe(de,Ee,R.x,R.y,L,Z);ye=ye+R.a%360,ye=Math.round(ye/2)*2,R.e.style.rotate=`${ye}deg`,typeof R.e.refresh=="function"&&(ae.actioned=!0,R.e.refresh("rotate",ye))}else if(R.action==="resize"){let de=null,Ee=null,ye=null,Ge=null;R.d=="e-resize"||R.d=="ne-resize"||R.d=="se-resize"?(ye=R.e.offsetWidth+(L-ae.x),z.shiftKey&&(Ge=R.e.offsetHeight+(L-ae.x)*(R.e.offsetHeight/R.e.offsetWidth))):(R.d==="w-resize"||R.d=="nw-resize"||R.d=="sw-resize")&&(Ee=R.e.offsetLeft+(L-ae.x),ye=R.e.offsetLeft+R.e.offsetWidth-Ee,z.shiftKey&&(Ge=R.e.offsetHeight-(L-ae.x)*(R.e.offsetHeight/R.e.offsetWidth))),R.d=="s-resize"||R.d=="se-resize"||R.d=="sw-resize"?Ge||(Ge=R.e.offsetHeight+(Z-ae.y)):(R.d==="n-resize"||R.d=="ne-resize"||R.d=="nw-resize")&&(de=R.e.offsetTop+(Z-ae.y),Ge=R.e.offsetTop+R.e.offsetHeight-de),de&&(R.e.style.top=de+"px"),Ee&&(R.e.style.left=Ee+"px"),ye&&(R.e.style.width=ye+"px"),Ge&&(R.e.style.height=Ge+"px"),typeof R.e.refresh=="function"&&(ae.actioned=!0,R.e.refresh("dimensions",ye,Ge))}ae.x=L,ae.y=Z}else{let L=oe(z),Z=st.findElement(L,"jpanel");if(Z){if(Z.classList.contains("jpanel-controls")){let Ee=L.getAttribute("data-position");Ee?Z.style.cursor=Ee:Z.style.cursor=""}else if(Z.getAttribute("tabindex")){let Ee=Z.getBoundingClientRect();z.clientY-Ee.top<P?Ee.width-(z.clientX-Ee.left)<P?Z.style.cursor="ne-resize":z.clientX-Ee.left<P?Z.style.cursor="nw-resize":Z.style.cursor="n-resize":Ee.height-(z.clientY-Ee.top)<P?Ee.width-(z.clientX-Ee.left)<P?Z.style.cursor="se-resize":z.clientX-Ee.left<P?Z.style.cursor="sw-resize":Z.style.cursor="s-resize":Ee.width-(z.clientX-Ee.left)<P?Z.style.cursor="e-resize":z.clientX-Ee.left<P?Z.style.cursor="w-resize":Z.style.cursor=""}}}};let Je=["n","ne","e","se","s","sw","w","nw","rotate"];Je.forEach(function(z,ie){Je[ie]=document.createElement("div"),Je[ie].classList.add("jpanel-action"),z==="rotate"?Je[ie].setAttribute("data-action","rotate"):(Je[ie].setAttribute("data-action","resize"),Je[ie].setAttribute("data-position",z+"-resize"))});let Be;const ot=function(z){let ie=oe(z),_e=st.findElement(ie,"jpanel");_e&&!_e.classList.contains("readonly")&&_e.classList.contains("jpanel-controls")?(_e.append(...Je),_e.classList.contains("jpanel-rotate")||Je[Je.length-1].remove(),Be=_e):gt()},gt=function(z){Be&&(Je.forEach(function(ie){ie.remove()}),Be=null)},b=function(z){var _e=oe(z).getAttribute("data-tooltip");if(_e){if(Pe.innerText=_e,z.changedTouches&&z.changedTouches[0])var J=z.changedTouches[0].clientX,me=z.changedTouches[0].clientY;else var J=z.clientX,me=z.clientY;Pe.style.top=me+"px",Pe.style.left=J+"px",document.body.appendChild(Pe)}else Pe.innerText&&(Pe.innerText="",document.body.removeChild(Pe))},q=function(z){var ie=document.activeElement;if(ie&&typeof ie.contextmenu=="function")ie.contextmenu(z),z.preventDefault(),z.stopImmediatePropagation();else if(ie=st.findElement(z.target,function(J){return J.tagName&&J.getAttribute("aria-contextmenu-id")}),ie){var _e=document.querySelector("#"+ie);_e?(_e.contextmenu.open(z),z.preventDefault(),z.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ie)}},F=function(z){let ie=document.activeElement;ie&&z.key==="Delete"&&typeof ie.delete=="function"&&(ie.delete(),z.preventDefault(),z.stopImmediatePropagation());let _e=window.jSuitesStateControl;_e&&_e.length>0&&(ie=_e[_e.length-1],ie&&z.key==="Escape"&&typeof ie.isOpened=="function"&&typeof ie.close=="function"&&ie.isOpened()&&(ie.close(),z.preventDefault(),z.stopImmediatePropagation()))},W=function(z){(z.target.getAttribute("data-mask")||z.target.mask)&&st.mask(z)};document.addEventListener("focusin",ot),document.addEventListener("mouseup",Re),document.addEventListener("mousedown",ee),document.addEventListener("mousemove",$e),document.addEventListener("mouseover",b),document.addEventListener("keydown",F),document.addEventListener("contextmenu",q),document.addEventListener("input",W)}();var At=st})(),t=a.default}(),t})}(jsuites$1)),jsuites$1.exports}var dist$2={exports:{}},dist$1=dist$2.exports,hasRequiredDist$1;function requireDist$1(){return hasRequiredDist$1||(hasRequiredDist$1=1,function(r,e){(function(t,n){r.exports=n()})(dist$1,function(){var t;return function(){var n={765:function(l,u){var c;c=function(h){h.version="1.0.2";var g=Math;function v(Ie,we){for(var Ne=0,at=0;Ne<Ie.length;++Ne)at=we*at+Ie[Ne];return at}function m(Ie,we,Ne,at,nt){if(we===0)return Ne;if(we===1)return at;for(var B=2/Ie,te=at,V=1;V<we;++V)te=at*V*B+nt*Ne,Ne=at,at=te;return te}function E(Ie,we,Ne,at,nt){return function(B,te){if(at){if(B===0)return at==1?-1/0:1/0;if(B<0)return NaN}return te===0?Ie(B):te===1?we(B):te<0?NaN:m(B,te|=0,Ie(B),we(B),nt)}}var _,S,w,A,O,D,Y,H,k,K,se,re,Ce,Le=function(){var Ie=.636619772,we=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Ne=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),at=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),nt=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function B(He){var be=0,qe=0,le=0,pe=He*He;if(He<8)be=(qe=v(we,pe))/(le=v(Ne,pe));else{var Se=He-.785398164;qe=v(at,pe=64/pe),le=v(nt,pe),be=g.sqrt(Ie/He)*(g.cos(Se)*qe-g.sin(Se)*le*8/He)}return be}var te=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),V=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),ue=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ae=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Ve(He){var be=0,qe=0,le=0,pe=He*He,Se=g.abs(He)-2.356194491;return Math.abs(He)<8?be=(qe=He*v(te,pe))/(le=v(V,pe)):(qe=v(ue,pe=64/pe),le=v(Ae,pe),be=g.sqrt(Ie/g.abs(He))*(g.cos(Se)*qe-g.sin(Se)*le*8/g.abs(He)),He<0&&(be=-be)),be}return function He(be,qe){if(qe=Math.round(qe),!isFinite(be))return isNaN(be)?be:0;if(qe<0)return(qe%2?-1:1)*He(be,-qe);if(be<0)return(qe%2?-1:1)*He(-be,qe);if(qe===0)return B(be);if(qe===1)return Ve(be);if(be===0)return 0;var le=0;if(be>qe)le=m(be,qe,B(be),Ve(be),-1);else{for(var pe=!1,Se=0,Ye=0,Fe=1,je=0,rt=2/be,Ue=2*g.floor((qe+g.floor(g.sqrt(40*qe)))/2);Ue>0;Ue--)je=Ue*rt*Fe-Se,Se=Fe,Fe=je,g.abs(Fe)>1e10&&(Fe*=1e-10,Se*=1e-10,le*=1e-10,Ye*=1e-10),pe&&(Ye+=Fe),pe=!pe,Ue==qe&&(le=Se);le/=Ye=2*Ye-Fe}return le}}(),he=(_=.636619772,S=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),w=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),A=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),O=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),D=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),Y=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),H=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),k=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),E(function(Ie){var we=0,Ne=0,at=0,nt=Ie*Ie,B=Ie-.785398164;return Ie<8?we=(Ne=v(S,nt))/(at=v(w,nt))+_*Le(Ie,0)*g.log(Ie):(Ne=v(A,nt=64/nt),at=v(O,nt),we=g.sqrt(_/Ie)*(g.sin(B)*Ne+g.cos(B)*at*8/Ie)),we},function(Ie){var we=0,Ne=0,at=0,nt=Ie*Ie,B=Ie-2.356194491;return Ie<8?we=(Ne=Ie*v(D,nt))/(at=v(Y,nt))+_*(Le(Ie,1)*g.log(Ie)-1/Ie):(Ne=v(H,nt=64/nt),at=v(k,nt),we=g.sqrt(_/Ie)*(g.sin(B)*Ne+g.cos(B)*at*8/Ie)),we},0,1,-1)),ve=(K=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),se=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),re=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Ce=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function Ie(we,Ne){if((Ne=Math.round(Ne))===0)return function(Ae){return Ae<=3.75?v(K,Ae*Ae/14.0625):g.exp(g.abs(Ae))/g.sqrt(g.abs(Ae))*v(se,3.75/g.abs(Ae))}(we);if(Ne===1)return function(Ae){return Ae<3.75?Ae*v(re,Ae*Ae/14.0625):(Ae<0?-1:1)*g.exp(g.abs(Ae))/g.sqrt(g.abs(Ae))*v(Ce,3.75/g.abs(Ae))}(we);if(Ne<0)return NaN;if(g.abs(we)===0)return 0;if(we==1/0)return 1/0;var at,nt=0,B=2/g.abs(we),te=0,V=1,ue=0;for(at=2*g.round((Ne+g.round(g.sqrt(40*Ne)))/2);at>0;at--)ue=at*B*V+te,te=V,V=ue,g.abs(V)>1e10&&(V*=1e-10,te*=1e-10,nt*=1e-10),at==Ne&&(nt=te);return nt*=Ie(we,0)/V,we<0&&Ne%2?-nt:nt}),xe=function(){var Ie=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),we=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Ne=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),at=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return E(function(nt){return nt<=2?-g.log(nt/2)*ve(nt,0)+v(Ie,nt*nt/4):g.exp(-nt)/g.sqrt(nt)*v(we,2/nt)},function(nt){return nt<=2?g.log(nt/2)*ve(nt,1)+1/nt*v(Ne,nt*nt/4):g.exp(-nt)/g.sqrt(nt)*v(at,2/nt)},0,2,1)}();h.besselj=Le,h.bessely=he,h.besseli=ve,h.besselk=xe},c(typeof DO_NOT_EXPORT_BESSEL>"u"?u:{})},162:function(l){var u;l.exports=(u=function(c,h){var g=Array.prototype.concat,v=Array.prototype.slice,m=Object.prototype.toString;function E(k,K){var se=k>K?k:K;return c.pow(10,17-~~(c.log(se>0?se:-se)*c.LOG10E))}var _=Array.isArray||function(k){return m.call(k)==="[object Array]"};function S(k){return m.call(k)==="[object Function]"}function w(k){return typeof k=="number"&&k-k==0}function A(){return new A._init(arguments)}function O(){return 0}function D(){return 1}function Y(k,K){return k===K?1:0}A.fn=A.prototype,A._init=function(k){if(_(k[0]))if(_(k[0][0])){S(k[1])&&(k[0]=A.map(k[0],k[1]));for(var K=0;K<k[0].length;K++)this[K]=k[0][K];this.length=k[0].length}else this[0]=S(k[1])?A.map(k[0],k[1]):k[0],this.length=1;else if(w(k[0]))this[0]=A.seq.apply(null,k),this.length=1;else{if(k[0]instanceof A)return A(k[0].toArray());this[0]=[],this.length=1}return this},A._init.prototype=A.prototype,A._init.constructor=A,A.utils={calcRdx:E,isArray:_,isFunction:S,isNumber:w,toVector:function(k){return g.apply([],k)}},A._random_fn=c.random,A.setRandom=function(k){if(typeof k!="function")throw new TypeError("fn is not a function");A._random_fn=k},A.extend=function(k){var K,se;if(arguments.length===1){for(se in k)A[se]=k[se];return this}for(K=1;K<arguments.length;K++)for(se in arguments[K])k[se]=arguments[K][se];return k},A.rows=function(k){return k.length||1},A.cols=function(k){return k[0].length||1},A.dimensions=function(k){return{rows:A.rows(k),cols:A.cols(k)}},A.row=function(k,K){return _(K)?K.map(function(se){return A.row(k,se)}):k[K]},A.rowa=function(k,K){return A.row(k,K)},A.col=function(k,K){if(_(K)){var se=A.arange(k.length).map(function(){return new Array(K.length)});return K.forEach(function(Le,he){A.arange(k.length).forEach(function(ve){se[ve][he]=k[ve][Le]})}),se}for(var re=new Array(k.length),Ce=0;Ce<k.length;Ce++)re[Ce]=[k[Ce][K]];return re},A.cola=function(k,K){return A.col(k,K).map(function(se){return se[0]})},A.diag=function(k){for(var K=A.rows(k),se=new Array(K),re=0;re<K;re++)se[re]=[k[re][re]];return se},A.antidiag=function(k){for(var K=A.rows(k)-1,se=new Array(K),re=0;K>=0;K--,re++)se[re]=[k[re][K]];return se},A.transpose=function(k){var K,se,re,Ce,Le,he=[];for(_(k[0])||(k=[k]),se=k.length,re=k[0].length,Le=0;Le<re;Le++){for(K=new Array(se),Ce=0;Ce<se;Ce++)K[Ce]=k[Ce][Le];he.push(K)}return he.length===1?he[0]:he},A.map=function(k,K,se){var re,Ce,Le,he,ve;for(_(k[0])||(k=[k]),Ce=k.length,Le=k[0].length,he=se?k:new Array(Ce),re=0;re<Ce;re++)for(he[re]||(he[re]=new Array(Le)),ve=0;ve<Le;ve++)he[re][ve]=K(k[re][ve],re,ve);return he.length===1?he[0]:he},A.cumreduce=function(k,K,se){var re,Ce,Le,he,ve;for(_(k[0])||(k=[k]),Ce=k.length,Le=k[0].length,he=se?k:new Array(Ce),re=0;re<Ce;re++)for(he[re]||(he[re]=new Array(Le)),Le>0&&(he[re][0]=k[re][0]),ve=1;ve<Le;ve++)he[re][ve]=K(he[re][ve-1],k[re][ve]);return he.length===1?he[0]:he},A.alter=function(k,K){return A.map(k,K,!0)},A.create=function(k,K,se){var re,Ce,Le=new Array(k);for(S(K)&&(se=K,K=k),re=0;re<k;re++)for(Le[re]=new Array(K),Ce=0;Ce<K;Ce++)Le[re][Ce]=se(re,Ce);return Le},A.zeros=function(k,K){return w(K)||(K=k),A.create(k,K,O)},A.ones=function(k,K){return w(K)||(K=k),A.create(k,K,D)},A.rand=function(k,K){return w(K)||(K=k),A.create(k,K,A._random_fn)},A.identity=function(k,K){return w(K)||(K=k),A.create(k,K,Y)},A.symmetric=function(k){var K,se,re=k.length;if(k.length!==k[0].length)return!1;for(K=0;K<re;K++)for(se=0;se<re;se++)if(k[se][K]!==k[K][se])return!1;return!0},A.clear=function(k){return A.alter(k,O)},A.seq=function(k,K,se,re){S(re)||(re=!1);var Ce,Le=[],he=E(k,K),ve=(K*he-k*he)/((se-1)*he),xe=k;for(Ce=0;xe<=K&&Ce<se;xe=(k*he+ve*he*++Ce)/he)Le.push(re?re(xe,Ce):xe);return Le},A.arange=function(k,K,se){var re,Ce=[];if(se=se||1,K===h&&(K=k,k=0),k===K||se===0)return[];if(k<K&&se<0)return[];if(k>K&&se>0)return[];if(se>0)for(re=k;re<K;re+=se)Ce.push(re);else for(re=k;re>K;re+=se)Ce.push(re);return Ce},A.slice=function(){function k(K,se,re,Ce){var Le,he=[],ve=K.length;if(se===h&&re===h&&Ce===h)return A.copy(K);if(Ce=Ce||1,(se=(se=se||0)>=0?se:ve+se)===(re=(re=re||K.length)>=0?re:ve+re)||Ce===0)return[];if(se<re&&Ce<0)return[];if(se>re&&Ce>0)return[];if(Ce>0)for(Le=se;Le<re;Le+=Ce)he.push(K[Le]);else for(Le=se;Le>re;Le+=Ce)he.push(K[Le]);return he}return function(K,se){var re,Ce;return w((se=se||{}).row)?w(se.col)?K[se.row][se.col]:k(A.rowa(K,se.row),(re=se.col||{}).start,re.end,re.step):w(se.col)?k(A.cola(K,se.col),(Ce=se.row||{}).start,Ce.end,Ce.step):(Ce=se.row||{},re=se.col||{},k(K,Ce.start,Ce.end,Ce.step).map(function(Le){return k(Le,re.start,re.end,re.step)}))}}(),A.sliceAssign=function(k,K,se){var re,Ce;if(w(K.row)){if(w(K.col))return k[K.row][K.col]=se;K.col=K.col||{},K.col.start=K.col.start||0,K.col.end=K.col.end||k[0].length,K.col.step=K.col.step||1,re=A.arange(K.col.start,c.min(k.length,K.col.end),K.col.step);var Le=K.row;return re.forEach(function(ve,xe){k[Le][ve]=se[xe]}),k}if(w(K.col)){K.row=K.row||{},K.row.start=K.row.start||0,K.row.end=K.row.end||k.length,K.row.step=K.row.step||1,Ce=A.arange(K.row.start,c.min(k[0].length,K.row.end),K.row.step);var he=K.col;return Ce.forEach(function(ve,xe){k[ve][he]=se[xe]}),k}return se[0].length===h&&(se=[se]),K.row.start=K.row.start||0,K.row.end=K.row.end||k.length,K.row.step=K.row.step||1,K.col.start=K.col.start||0,K.col.end=K.col.end||k[0].length,K.col.step=K.col.step||1,Ce=A.arange(K.row.start,c.min(k.length,K.row.end),K.row.step),re=A.arange(K.col.start,c.min(k[0].length,K.col.end),K.col.step),Ce.forEach(function(ve,xe){re.forEach(function(Ie,we){k[ve][Ie]=se[xe][we]})}),k},A.diagonal=function(k){var K=A.zeros(k.length,k.length);return k.forEach(function(se,re){K[re][re]=se}),K},A.copy=function(k){return k.map(function(K){return w(K)?K:K.map(function(se){return se})})};var H=A.prototype;return H.length=0,H.push=Array.prototype.push,H.sort=Array.prototype.sort,H.splice=Array.prototype.splice,H.slice=Array.prototype.slice,H.toArray=function(){return this.length>1?v.call(this):v.call(this)[0]},H.map=function(k,K){return A(A.map(this,k,K))},H.cumreduce=function(k,K){return A(A.cumreduce(this,k,K))},H.alter=function(k){return A.alter(this,k),this},function(k){for(var K=0;K<k.length;K++)(function(se){H[se]=function(re){var Ce,Le=this;return re?(setTimeout(function(){re.call(Le,H[se].call(Le))}),this):(Ce=A[se](this),_(Ce)?A(Ce):Ce)}})(k[K])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(k){for(var K=0;K<k.length;K++)(function(se){H[se]=function(re,Ce){var Le=this;return Ce?(setTimeout(function(){Ce.call(Le,H[se].call(Le,re))}),this):A(A[se](this,re))}})(k[K])}("row col".split(" ")),function(k){for(var K=0;K<k.length;K++)(function(se){H[se]=function(){return A(A[se].apply(null,arguments))}})(k[K])}("create zeros ones rand identity".split(" ")),A}(Math),function(c,h){var g=c.utils.isFunction;function v(_,S){return _-S}function m(_,S,w){return h.max(S,h.min(_,w))}c.sum=function(_){for(var S=0,w=_.length;--w>=0;)S+=_[w];return S},c.sumsqrd=function(_){for(var S=0,w=_.length;--w>=0;)S+=_[w]*_[w];return S},c.sumsqerr=function(_){for(var S,w=c.mean(_),A=0,O=_.length;--O>=0;)A+=(S=_[O]-w)*S;return A},c.sumrow=function(_){for(var S=0,w=_.length;--w>=0;)S+=_[w];return S},c.product=function(_){for(var S=1,w=_.length;--w>=0;)S*=_[w];return S},c.min=function(_){for(var S=_[0],w=0;++w<_.length;)_[w]<S&&(S=_[w]);return S},c.max=function(_){for(var S=_[0],w=0;++w<_.length;)_[w]>S&&(S=_[w]);return S},c.unique=function(_){for(var S={},w=[],A=0;A<_.length;A++)S[_[A]]||(S[_[A]]=!0,w.push(_[A]));return w},c.mean=function(_){return c.sum(_)/_.length},c.meansqerr=function(_){return c.sumsqerr(_)/_.length},c.geomean=function(_){var S=_.map(h.log),w=c.mean(S);return h.exp(w)},c.median=function(_){var S=_.length,w=_.slice().sort(v);return 1&S?w[S/2|0]:(w[S/2-1]+w[S/2])/2},c.cumsum=function(_){return c.cumreduce(_,function(S,w){return S+w})},c.cumprod=function(_){return c.cumreduce(_,function(S,w){return S*w})},c.diff=function(_){var S,w=[],A=_.length;for(S=1;S<A;S++)w.push(_[S]-_[S-1]);return w},c.rank=function(_){var S,w=[],A={};for(S=0;S<_.length;S++)A[H=_[S]]?A[H]++:(A[H]=1,w.push(H));var O=w.sort(v),D={},Y=1;for(S=0;S<O.length;S++){var H,k=A[H=O[S]],K=(Y+(Y+k-1))/2;D[H]=K,Y+=k}return _.map(function(se){return D[se]})},c.mode=function(_){var S,w=_.length,A=_.slice().sort(v),O=1,D=0,Y=0,H=[];for(S=0;S<w;S++)A[S]===A[S+1]?O++:(O>D?(H=[A[S]],D=O,Y=0):O===D&&(H.push(A[S]),Y++),O=1);return Y===0?H[0]:H},c.range=function(_){return c.max(_)-c.min(_)},c.variance=function(_,S){return c.sumsqerr(_)/(_.length-(S?1:0))},c.pooledvariance=function(_){return _.reduce(function(S,w){return S+c.sumsqerr(w)},0)/(_.reduce(function(S,w){return S+w.length},0)-_.length)},c.deviation=function(_){for(var S=c.mean(_),w=_.length,A=new Array(w),O=0;O<w;O++)A[O]=_[O]-S;return A},c.stdev=function(_,S){return h.sqrt(c.variance(_,S))},c.pooledstdev=function(_){return h.sqrt(c.pooledvariance(_))},c.meandev=function(_){for(var S=c.mean(_),w=[],A=_.length-1;A>=0;A--)w.push(h.abs(_[A]-S));return c.mean(w)},c.meddev=function(_){for(var S=c.median(_),w=[],A=_.length-1;A>=0;A--)w.push(h.abs(_[A]-S));return c.median(w)},c.coeffvar=function(_){return c.stdev(_)/c.mean(_)},c.quartiles=function(_){var S=_.length,w=_.slice().sort(v);return[w[h.round(S/4)-1],w[h.round(S/2)-1],w[h.round(3*S/4)-1]]},c.quantiles=function(_,S,w,A){var O,D,Y,H,k,K=_.slice().sort(v),se=[S.length],re=_.length;for(w===void 0&&(w=.375),A===void 0&&(A=.375),O=0;O<S.length;O++)Y=re*(D=S[O])+(w+D*(1-w-A)),H=h.floor(m(Y,1,re-1)),k=m(Y-H,0,1),se[O]=(1-k)*K[H-1]+k*K[H];return se},c.percentile=function(_,S,w){var A=_.slice().sort(v),O=S*(A.length+(w?1:-1))+(w?0:1),D=parseInt(O),Y=O-D;return D+1<A.length?A[D-1]+Y*(A[D]-A[D-1]):A[D-1]},c.percentileOfScore=function(_,S,w){var A,O,D=0,Y=_.length,H=!1;for(w==="strict"&&(H=!0),O=0;O<Y;O++)A=_[O],(H&&A<S||!H&&A<=S)&&D++;return D/Y},c.histogram=function(_,S){S=S||4;var w,A=c.min(_),O=(c.max(_)-A)/S,D=_.length,Y=[];for(w=0;w<S;w++)Y[w]=0;for(w=0;w<D;w++)Y[h.min(h.floor((_[w]-A)/O),S-1)]+=1;return Y},c.covariance=function(_,S){var w,A=c.mean(_),O=c.mean(S),D=_.length,Y=new Array(D);for(w=0;w<D;w++)Y[w]=(_[w]-A)*(S[w]-O);return c.sum(Y)/(D-1)},c.corrcoeff=function(_,S){return c.covariance(_,S)/c.stdev(_,1)/c.stdev(S,1)},c.spearmancoeff=function(_,S){return _=c.rank(_),S=c.rank(S),c.corrcoeff(_,S)},c.stanMoment=function(_,S){for(var w=c.mean(_),A=c.stdev(_),O=_.length,D=0,Y=0;Y<O;Y++)D+=h.pow((_[Y]-w)/A,S);return D/_.length},c.skewness=function(_){return c.stanMoment(_,3)},c.kurtosis=function(_){return c.stanMoment(_,4)-3};var E=c.prototype;(function(_){for(var S=0;S<_.length;S++)(function(w){E[w]=function(A,O){var D=[],Y=0,H=this;if(g(A)&&(O=A,A=!1),O)return setTimeout(function(){O.call(H,E[w].call(H,A))}),this;if(this.length>1){for(H=A===!0?this:this.transpose();Y<H.length;Y++)D[Y]=c[w](H[Y]);return D}return c[w](this[0],A)}})(_[S])})("cumsum cumprod".split(" ")),function(_){for(var S=0;S<_.length;S++)(function(w){E[w]=function(A,O){var D=[],Y=0,H=this;if(g(A)&&(O=A,A=!1),O)return setTimeout(function(){O.call(H,E[w].call(H,A))}),this;if(this.length>1){for(w!=="sumrow"&&(H=A===!0?this:this.transpose());Y<H.length;Y++)D[Y]=c[w](H[Y]);return A===!0?c[w](c.utils.toVector(D)):D}return c[w](this[0],A)}})(_[S])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(_){for(var S=0;S<_.length;S++)(function(w){E[w]=function(){var A,O=[],D=0,Y=this,H=Array.prototype.slice.call(arguments);if(g(H[H.length-1])){A=H[H.length-1];var k=H.slice(0,H.length-1);return setTimeout(function(){A.call(Y,E[w].apply(Y,k))}),this}A=void 0;var K=function(se){return c[w].apply(Y,[se].concat(H))};if(this.length>1){for(Y=Y.transpose();D<Y.length;D++)O[D]=K(Y[D]);return O}return K(this[0])}})(_[S])}("quantiles percentileOfScore".split(" "))}(u,Math),function(c,h){c.gammaln=function(g){var v,m,E,_=0,S=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],w=1.000000000190015;for(E=(m=v=g)+5.5,E-=(v+.5)*h.log(E);_<6;_++)w+=S[_]/++m;return h.log(2.5066282746310007*w/v)-E},c.loggam=function(g){var v,m,E,_,S,w,A,O=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(v=g,A=0,g==1||g==2)return 0;for(g<=7&&(v=g+(A=h.floor(7-g))),m=1/(v*v),E=2*h.PI,S=O[9],w=8;w>=0;w--)S*=m,S+=O[w];if(_=S/v+.5*h.log(E)+(v-.5)*h.log(v)-v,g<=7)for(w=1;w<=A;w++)_-=h.log(v-1),v-=1;return _},c.gammafn=function(g){var v,m,E,_,S=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],w=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],A=!1,O=0,D=0,Y=0,H=g;if(g>171.6243769536076)return 1/0;if(H<=0){if(!(_=H%1+36e-17))return 1/0;A=(1&H?-1:1)*h.PI/h.sin(h.PI*_),H=1-H}for(E=H,m=H<1?H++:(H-=O=(0|H)-1)-1,v=0;v<8;++v)Y=(Y+S[v])*m,D=D*m+w[v];if(_=Y/D+1,E<H)_/=E;else if(E>H)for(v=0;v<O;++v)_*=H,H++;return A&&(_=A/_),_},c.gammap=function(g,v){return c.lowRegGamma(g,v)*c.gammafn(g)},c.lowRegGamma=function(g,v){var m,E=c.gammaln(g),_=g,S=1/g,w=S,A=v+1-g,O=1/1e-30,D=1/A,Y=D,H=1,k=-~(8.5*h.log(g>=1?g:1/g)+.4*g+17);if(v<0||g<=0)return NaN;if(v<g+1){for(;H<=k;H++)S+=w*=v/++_;return S*h.exp(-v+g*h.log(v)-E)}for(;H<=k;H++)Y*=(D=1/(D=(m=-H*(H-g))*D+(A+=2)))*(O=A+m/O);return 1-Y*h.exp(-v+g*h.log(v)-E)},c.factorialln=function(g){return g<0?NaN:c.gammaln(g+1)},c.factorial=function(g){return g<0?NaN:c.gammafn(g+1)},c.combination=function(g,v){return g>170||v>170?h.exp(c.combinationln(g,v)):c.factorial(g)/c.factorial(v)/c.factorial(g-v)},c.combinationln=function(g,v){return c.factorialln(g)-c.factorialln(v)-c.factorialln(g-v)},c.permutation=function(g,v){return c.factorial(g)/c.factorial(g-v)},c.betafn=function(g,v){if(!(g<=0||v<=0))return g+v>170?h.exp(c.betaln(g,v)):c.gammafn(g)*c.gammafn(v)/c.gammafn(g+v)},c.betaln=function(g,v){return c.gammaln(g)+c.gammaln(v)-c.gammaln(g+v)},c.betacf=function(g,v,m){var E,_,S,w,A=1e-30,O=1,D=v+m,Y=v+1,H=v-1,k=1,K=1-D*g/Y;for(h.abs(K)<A&&(K=A),w=K=1/K;O<=100&&(K=1+(_=O*(m-O)*g/((H+(E=2*O))*(v+E)))*K,h.abs(K)<A&&(K=A),k=1+_/k,h.abs(k)<A&&(k=A),w*=(K=1/K)*k,K=1+(_=-(v+O)*(D+O)*g/((v+E)*(Y+E)))*K,h.abs(K)<A&&(K=A),k=1+_/k,h.abs(k)<A&&(k=A),w*=S=(K=1/K)*k,!(h.abs(S-1)<3e-7));O++);return w},c.gammapinv=function(g,v){var m,E,_,S,w,A,O=0,D=v-1,Y=c.gammaln(v);if(g>=1)return h.max(100,v+100*h.sqrt(v));if(g<=0)return 0;for(v>1?(w=h.log(D),A=h.exp(D*(w-1)-Y),S=g<.5?g:1-g,m=(2.30753+.27061*(E=h.sqrt(-2*h.log(S))))/(1+E*(.99229+.04481*E))-E,g<.5&&(m=-m),m=h.max(.001,v*h.pow(1-1/(9*v)-m/(3*h.sqrt(v)),3))):m=g<(E=1-v*(.253+.12*v))?h.pow(g/E,1/v):1-h.log(1-(g-E)/(1-E));O<12;O++){if(m<=0)return 0;if((m-=E=(_=(c.lowRegGamma(v,m)-g)/(E=v>1?A*h.exp(-(m-D)+D*(h.log(m)-w)):h.exp(-m+D*h.log(m)-Y)))/(1-.5*h.min(1,_*((v-1)/m-1))))<=0&&(m=.5*(m+E)),h.abs(E)<1e-8*m)break}return m},c.erf=function(g){var v,m,E,_,S=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],w=S.length-1,A=!1,O=0,D=0;for(g<0&&(g=-g,A=!0),m=4*(v=2/(2+g))-2;w>0;w--)E=O,O=m*O-D+S[w],D=E;return _=v*h.exp(-g*g+.5*(S[0]+m*O)-D),A?_-1:1-_},c.erfc=function(g){return 1-c.erf(g)},c.erfcinv=function(g){var v,m,E,_,S=0;if(g>=2)return-100;if(g<=0)return 100;for(_=g<1?g:2-g,v=-.70711*((2.30753+.27061*(E=h.sqrt(-2*h.log(_/2))))/(1+E*(.99229+.04481*E))-E);S<2;S++)v+=(m=c.erfc(v)-_)/(1.1283791670955126*h.exp(-v*v)-v*m);return g<1?v:-v},c.ibetainv=function(g,v,m){var E,_,S,w,A,O,D,Y,H,k,K=v-1,se=m-1,re=0;if(g<=0)return 0;if(g>=1)return 1;for(v>=1&&m>=1?(S=g<.5?g:1-g,O=(2.30753+.27061*(w=h.sqrt(-2*h.log(S))))/(1+w*(.99229+.04481*w))-w,g<.5&&(O=-O),D=(O*O-3)/6,Y=2/(1/(2*v-1)+1/(2*m-1)),H=O*h.sqrt(D+Y)/Y-(1/(2*m-1)-1/(2*v-1))*(D+.8333333333333334-2/(3*Y)),O=v/(v+m*h.exp(2*H))):(E=h.log(v/(v+m)),_=h.log(m/(v+m)),O=g<(w=h.exp(v*E)/v)/(H=w+(A=h.exp(m*_)/m))?h.pow(v*H*g,1/v):1-h.pow(m*H*(1-g),1/m)),k=-c.gammaln(v)-c.gammaln(m)+c.gammaln(v+m);re<10;re++){if(O===0||O===1)return O;if((O-=w=(A=(c.ibeta(O,v,m)-g)/(w=h.exp(K*h.log(O)+se*h.log(1-O)+k)))/(1-.5*h.min(1,A*(K/O-se/(1-O)))))<=0&&(O=.5*(O+w)),O>=1&&(O=.5*(O+w+1)),h.abs(w)<1e-8*O&&re>0)break}return O},c.ibeta=function(g,v,m){var E=g===0||g===1?0:h.exp(c.gammaln(v+m)-c.gammaln(v)-c.gammaln(m)+v*h.log(g)+m*h.log(1-g));return!(g<0||g>1)&&(g<(v+1)/(v+m+2)?E*c.betacf(g,v,m)/v:1-E*c.betacf(1-g,m,v)/m)},c.randn=function(g,v){var m,E,_,S,w;if(v||(v=g),g)return c.create(g,v,function(){return c.randn()});do m=c._random_fn(),E=1.7156*(c._random_fn()-.5),w=(_=m-.449871)*_+(S=h.abs(E)+.386595)*(.196*S-.25472*_);while(w>.27597&&(w>.27846||E*E>-4*h.log(m)*m*m));return E/m},c.randg=function(g,v,m){var E,_,S,w,A,O,D=g;if(m||(m=v),g||(g=1),v)return(O=c.zeros(v,m)).alter(function(){return c.randg(g)}),O;g<1&&(g+=1),E=g-.3333333333333333,_=1/h.sqrt(9*E);do{do w=1+_*(A=c.randn());while(w<=0);w*=w*w,S=c._random_fn()}while(S>1-.331*h.pow(A,4)&&h.log(S)>.5*A*A+E*(1-w+h.log(w)));if(g==D)return E*w;do S=c._random_fn();while(S===0);return h.pow(S,1/D)*E*w},function(g){for(var v=0;v<g.length;v++)(function(m){c.fn[m]=function(){return c(c.map(this,function(E){return c[m](E)}))}})(g[v])}("gammaln gammafn factorial factorialln".split(" ")),function(g){for(var v=0;v<g.length;v++)(function(m){c.fn[m]=function(){return c(c[m].apply(null,arguments))}})(g[v])}("randn".split(" "))}(u,Math),function(c,h){function g(m,E,_,S){for(var w,A=0,O=1,D=1,Y=1,H=0,k=0;h.abs((D-k)/D)>S;)k=D,O=Y+(w=-(E+H)*(E+_+H)*m/(E+2*H)/(E+2*H+1))*O,D=(A=D+w*A)+(w=(H+=1)*(_-H)*m/(E+2*H-1)/(E+2*H))*D,A/=Y=O+w*Y,O/=Y,D/=Y,Y=1;return D/E}function v(m,E,_){var S=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],w=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],A=.5*m;if(A>=8)return 1;var O,D=2*c.normal.cdf(A,0,1,1,0)-1;D=D>=h.exp(-50/_)?h.pow(D,_):0;for(var Y=A,H=(8-A)/(O=m>3?2:3),k=Y+H,K=0,se=_-1,re=1;re<=O;re++){for(var Ce=0,Le=.5*(k+Y),he=.5*(k-Y),ve=1;ve<=12;ve++){var xe,Ie=Le+he*(6<ve?S[(xe=12-ve+1)-1]:-S[(xe=ve)-1]),we=Ie*Ie;if(we>60)break;var Ne=2*c.normal.cdf(Ie,0,1,1,0)*.5-2*c.normal.cdf(Ie,m,1,1,0)*.5;Ne>=h.exp(-30/se)&&(Ce+=Ne=w[xe-1]*h.exp(-.5*we)*h.pow(Ne,se))}K+=Ce*=2*he*_/h.sqrt(2*h.PI),Y=k,k+=H}return(D+=K)<=h.exp(-30/E)?0:(D=h.pow(D,E))>=1?1:D}(function(m){for(var E=0;E<m.length;E++)(function(_){c[_]=function S(w,A,O){return this instanceof S?(this._a=w,this._b=A,this._c=O,this):new S(w,A,O)},c.fn[_]=function(S,w,A){var O=c[_](S,w,A);return O.data=this,O},c[_].prototype.sample=function(S){var w=this._a,A=this._b,O=this._c;return S?c.alter(S,function(){return c[_].sample(w,A,O)}):c[_].sample(w,A,O)},function(S){for(var w=0;w<S.length;w++)(function(A){c[_].prototype[A]=function(O){var D=this._a,Y=this._b,H=this._c;return O||O===0||(O=this.data),typeof O!="number"?c.fn.map.call(O,function(k){return c[_][A](k,D,Y,H)}):c[_][A](O,D,Y,H)}})(S[w])}("pdf cdf inv".split(" ")),function(S){for(var w=0;w<S.length;w++)(function(A){c[_].prototype[A]=function(){return c[_][A](this._a,this._b,this._c)}})(S[w])}("mean median mode variance".split(" "))})(m[E])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),c.extend(c.beta,{pdf:function(m,E,_){return m>1||m<0?0:E==1&&_==1?1:E<512&&_<512?h.pow(m,E-1)*h.pow(1-m,_-1)/c.betafn(E,_):h.exp((E-1)*h.log(m)+(_-1)*h.log(1-m)-c.betaln(E,_))},cdf:function(m,E,_){return m>1||m<0?1*(m>1):c.ibeta(m,E,_)},inv:function(m,E,_){return c.ibetainv(m,E,_)},mean:function(m,E){return m/(m+E)},median:function(m,E){return c.ibetainv(.5,m,E)},mode:function(m,E){return(m-1)/(m+E-2)},sample:function(m,E){var _=c.randg(m);return _/(_+c.randg(E))},variance:function(m,E){return m*E/(h.pow(m+E,2)*(m+E+1))}}),c.extend(c.centralF,{pdf:function(m,E,_){var S;return m<0?0:E<=2?m===0&&E<2?1/0:m===0&&E===2?1:1/c.betafn(E/2,_/2)*h.pow(E/_,E/2)*h.pow(m,E/2-1)*h.pow(1+E/_*m,-(E+_)/2):(S=E*m/(_+m*E),E*(_/(_+m*E))/2*c.binomial.pdf((E-2)/2,(E+_-2)/2,S))},cdf:function(m,E,_){return m<0?0:c.ibeta(E*m/(E*m+_),E/2,_/2)},inv:function(m,E,_){return _/(E*(1/c.ibetainv(m,E/2,_/2)-1))},mean:function(m,E){return E>2?E/(E-2):void 0},mode:function(m,E){return m>2?E*(m-2)/(m*(E+2)):void 0},sample:function(m,E){return 2*c.randg(m/2)/m/(2*c.randg(E/2)/E)},variance:function(m,E){if(!(E<=4))return 2*E*E*(m+E-2)/(m*(E-2)*(E-2)*(E-4))}}),c.extend(c.cauchy,{pdf:function(m,E,_){return _<0?0:_/(h.pow(m-E,2)+h.pow(_,2))/h.PI},cdf:function(m,E,_){return h.atan((m-E)/_)/h.PI+.5},inv:function(m,E,_){return E+_*h.tan(h.PI*(m-.5))},median:function(m){return m},mode:function(m){return m},sample:function(m,E){return c.randn()*h.sqrt(1/(2*c.randg(.5)))*E+m}}),c.extend(c.chisquare,{pdf:function(m,E){return m<0?0:m===0&&E===2?.5:h.exp((E/2-1)*h.log(m)-m/2-E/2*h.log(2)-c.gammaln(E/2))},cdf:function(m,E){return m<0?0:c.lowRegGamma(E/2,m/2)},inv:function(m,E){return 2*c.gammapinv(m,.5*E)},mean:function(m){return m},median:function(m){return m*h.pow(1-2/(9*m),3)},mode:function(m){return m-2>0?m-2:0},sample:function(m){return 2*c.randg(m/2)},variance:function(m){return 2*m}}),c.extend(c.exponential,{pdf:function(m,E){return m<0?0:E*h.exp(-E*m)},cdf:function(m,E){return m<0?0:1-h.exp(-E*m)},inv:function(m,E){return-h.log(1-m)/E},mean:function(m){return 1/m},median:function(m){return 1/m*h.log(2)},mode:function(){return 0},sample:function(m){return-1/m*h.log(c._random_fn())},variance:function(m){return h.pow(m,-2)}}),c.extend(c.gamma,{pdf:function(m,E,_){return m<0?0:m===0&&E===1?1/_:h.exp((E-1)*h.log(m)-m/_-c.gammaln(E)-E*h.log(_))},cdf:function(m,E,_){return m<0?0:c.lowRegGamma(E,m/_)},inv:function(m,E,_){return c.gammapinv(m,E)*_},mean:function(m,E){return m*E},mode:function(m,E){if(m>1)return(m-1)*E},sample:function(m,E){return c.randg(m)*E},variance:function(m,E){return m*E*E}}),c.extend(c.invgamma,{pdf:function(m,E,_){return m<=0?0:h.exp(-(E+1)*h.log(m)-_/m-c.gammaln(E)+E*h.log(_))},cdf:function(m,E,_){return m<=0?0:1-c.lowRegGamma(E,_/m)},inv:function(m,E,_){return _/c.gammapinv(1-m,E)},mean:function(m,E){return m>1?E/(m-1):void 0},mode:function(m,E){return E/(m+1)},sample:function(m,E){return E/c.randg(m)},variance:function(m,E){if(!(m<=2))return E*E/((m-1)*(m-1)*(m-2))}}),c.extend(c.kumaraswamy,{pdf:function(m,E,_){return m===0&&E===1?_:m===1&&_===1?E:h.exp(h.log(E)+h.log(_)+(E-1)*h.log(m)+(_-1)*h.log(1-h.pow(m,E)))},cdf:function(m,E,_){return m<0?0:m>1?1:1-h.pow(1-h.pow(m,E),_)},inv:function(m,E,_){return h.pow(1-h.pow(1-m,1/_),1/E)},mean:function(m,E){return E*c.gammafn(1+1/m)*c.gammafn(E)/c.gammafn(1+1/m+E)},median:function(m,E){return h.pow(1-h.pow(2,-1/E),1/m)},mode:function(m,E){if(m>=1&&E>=1&&m!==1&&E!==1)return h.pow((m-1)/(m*E-1),1/m)},variance:function(){throw new Error("variance not yet implemented")}}),c.extend(c.lognormal,{pdf:function(m,E,_){return m<=0?0:h.exp(-h.log(m)-.5*h.log(2*h.PI)-h.log(_)-h.pow(h.log(m)-E,2)/(2*_*_))},cdf:function(m,E,_){return m<0?0:.5+.5*c.erf((h.log(m)-E)/h.sqrt(2*_*_))},inv:function(m,E,_){return h.exp(-1.4142135623730951*_*c.erfcinv(2*m)+E)},mean:function(m,E){return h.exp(m+E*E/2)},median:function(m){return h.exp(m)},mode:function(m,E){return h.exp(m-E*E)},sample:function(m,E){return h.exp(c.randn()*E+m)},variance:function(m,E){return(h.exp(E*E)-1)*h.exp(2*m+E*E)}}),c.extend(c.noncentralt,{pdf:function(m,E,_){return h.abs(_)<1e-14?c.studentt.pdf(m,E):h.abs(m)<1e-14?h.exp(c.gammaln((E+1)/2)-_*_/2-.5*h.log(h.PI*E)-c.gammaln(E/2)):E/m*(c.noncentralt.cdf(m*h.sqrt(1+2/E),E+2,_)-c.noncentralt.cdf(m,E,_))},cdf:function(m,E,_){var S=1e-14;if(h.abs(_)<S)return c.studentt.cdf(m,E);var w=!1;m<0&&(w=!0,_=-_);for(var A=c.normal.cdf(-_,0,1),O=S+1,D=O,Y=m*m/(m*m+E),H=0,k=h.exp(-_*_/2),K=h.exp(-_*_/2-.5*h.log(2)-c.gammaln(1.5))*_;H<200||D>S||O>S;)D=O,H>0&&(k*=_*_/(2*H),K*=_*_/(2*(H+.5))),A+=.5*(O=k*c.beta.cdf(Y,H+.5,E/2)+K*c.beta.cdf(Y,H+1,E/2)),H++;return w?1-A:A}}),c.extend(c.normal,{pdf:function(m,E,_){return h.exp(-.5*h.log(2*h.PI)-h.log(_)-h.pow(m-E,2)/(2*_*_))},cdf:function(m,E,_){return .5*(1+c.erf((m-E)/h.sqrt(2*_*_)))},inv:function(m,E,_){return-1.4142135623730951*_*c.erfcinv(2*m)+E},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},sample:function(m,E){return c.randn()*E+m},variance:function(m,E){return E*E}}),c.extend(c.pareto,{pdf:function(m,E,_){return m<E?0:_*h.pow(E,_)/h.pow(m,_+1)},cdf:function(m,E,_){return m<E?0:1-h.pow(E/m,_)},inv:function(m,E,_){return E/h.pow(1-m,1/_)},mean:function(m,E){if(!(E<=1))return E*h.pow(m,E)/(E-1)},median:function(m,E){return m*(E*h.SQRT2)},mode:function(m){return m},variance:function(m,E){if(!(E<=2))return m*m*E/(h.pow(E-1,2)*(E-2))}}),c.extend(c.studentt,{pdf:function(m,E){return E=E>1e100?1e100:E,1/(h.sqrt(E)*c.betafn(.5,E/2))*h.pow(1+m*m/E,-(E+1)/2)},cdf:function(m,E){var _=E/2;return c.ibeta((m+h.sqrt(m*m+E))/(2*h.sqrt(m*m+E)),_,_)},inv:function(m,E){var _=c.ibetainv(2*h.min(m,1-m),.5*E,.5);return _=h.sqrt(E*(1-_)/_),m>.5?_:-_},mean:function(m){return m>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(m){return c.randn()*h.sqrt(m/(2*c.randg(m/2)))},variance:function(m){return m>2?m/(m-2):m>1?1/0:void 0}}),c.extend(c.weibull,{pdf:function(m,E,_){return m<0||E<0||_<0?0:_/E*h.pow(m/E,_-1)*h.exp(-h.pow(m/E,_))},cdf:function(m,E,_){return m<0?0:1-h.exp(-h.pow(m/E,_))},inv:function(m,E,_){return E*h.pow(-h.log(1-m),1/_)},mean:function(m,E){return m*c.gammafn(1+1/E)},median:function(m,E){return m*h.pow(h.log(2),1/E)},mode:function(m,E){return E<=1?0:m*h.pow((E-1)/E,1/E)},sample:function(m,E){return m*h.pow(-h.log(c._random_fn()),1/E)},variance:function(m,E){return m*m*c.gammafn(1+2/E)-h.pow(c.weibull.mean(m,E),2)}}),c.extend(c.uniform,{pdf:function(m,E,_){return m<E||m>_?0:1/(_-E)},cdf:function(m,E,_){return m<E?0:m<_?(m-E)/(_-E):1},inv:function(m,E,_){return E+m*(_-E)},mean:function(m,E){return .5*(m+E)},median:function(m,E){return c.mean(m,E)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,E){return m/2+E/2+(E/2-m/2)*(2*c._random_fn()-1)},variance:function(m,E){return h.pow(E-m,2)/12}}),c.extend(c.binomial,{pdf:function(m,E,_){return _===0||_===1?E*_===m?1:0:c.combination(E,m)*h.pow(_,m)*h.pow(1-_,E-m)},cdf:function(m,E,_){var S,w=1e-10;if(m<0)return 0;if(m>=E)return 1;if(_<0||_>1||E<=0)return NaN;var A=_,O=(m=h.floor(m))+1,D=E-m,Y=O+D,H=h.exp(c.gammaln(Y)-c.gammaln(D)-c.gammaln(O)+O*h.log(A)+D*h.log(1-A));return S=A<(O+1)/(Y+2)?H*g(A,O,D,w):1-H*g(1-A,D,O,w),h.round(1/w*(1-S))/(1/w)}}),c.extend(c.negbin,{pdf:function(m,E,_){return m===m>>>0&&(m<0?0:c.combination(m+E-1,E-1)*h.pow(1-_,m)*h.pow(_,E))},cdf:function(m,E,_){var S=0,w=0;if(m<0)return 0;for(;w<=m;w++)S+=c.negbin.pdf(w,E,_);return S}}),c.extend(c.hypgeom,{pdf:function(m,E,_,S){if(m!=m|0)return!1;if(m<0||m<_-(E-S)||m>S||m>_)return 0;if(2*_>E)return 2*S>E?c.hypgeom.pdf(E-_-S+m,E,E-_,E-S):c.hypgeom.pdf(S-m,E,E-_,S);if(2*S>E)return c.hypgeom.pdf(_-m,E,_,E-S);if(_<S)return c.hypgeom.pdf(m,E,S,_);for(var w=1,A=0,O=0;O<m;O++){for(;w>1&&A<S;)w*=1-_/(E-A),A++;w*=(S-O)*(_-O)/((O+1)*(E-_-S+O+1))}for(;A<S;A++)w*=1-_/(E-A);return h.min(1,h.max(0,w))},cdf:function(m,E,_,S){if(m<0||m<_-(E-S))return 0;if(m>=S||m>=_)return 1;if(2*_>E)return 2*S>E?c.hypgeom.cdf(E-_-S+m,E,E-_,E-S):1-c.hypgeom.cdf(S-m-1,E,E-_,S);if(2*S>E)return 1-c.hypgeom.cdf(_-m-1,E,_,E-S);if(_<S)return c.hypgeom.cdf(m,E,S,_);for(var w=1,A=1,O=0,D=0;D<m;D++){for(;w>1&&O<S;){var Y=1-_/(E-O);A*=Y,w*=Y,O++}w+=A*=(S-D)*(_-D)/((D+1)*(E-_-S+D+1))}for(;O<S;O++)w*=1-_/(E-O);return h.min(1,h.max(0,w))}}),c.extend(c.poisson,{pdf:function(m,E){return E<0||m%1!=0||m<0?0:h.pow(E,m)*h.exp(-E)/c.factorial(m)},cdf:function(m,E){var _=[],S=0;if(m<0)return 0;for(;S<=m;S++)_.push(c.poisson.pdf(S,E));return c.sum(_)},mean:function(m){return m},variance:function(m){return m},sampleSmall:function(m){var E=1,_=0,S=h.exp(-m);do _++,E*=c._random_fn();while(E>S);return _-1},sampleLarge:function(m){var E,_,S,w,A,O,D,Y,H,k,K=m;for(w=h.sqrt(K),A=h.log(K),O=.02483*(D=.931+2.53*w)-.059,Y=1.1239+1.1328/(D-3.4),H=.9277-3.6224/(D-2);;)if(_=h.random()-.5,S=h.random(),k=.5-h.abs(_),E=h.floor((2*O/k+D)*_+K+.43),k>=.07&&S<=H||!(E<0||k<.013&&S>k)&&h.log(S)+h.log(Y)-h.log(O/(k*k)+D)<=E*A-K-c.loggam(E+1))return E},sample:function(m){return m<10?this.sampleSmall(m):this.sampleLarge(m)}}),c.extend(c.triangular,{pdf:function(m,E,_,S){return _<=E||S<E||S>_?NaN:m<E||m>_?0:m<S?2*(m-E)/((_-E)*(S-E)):m===S?2/(_-E):2*(_-m)/((_-E)*(_-S))},cdf:function(m,E,_,S){return _<=E||S<E||S>_?NaN:m<=E?0:m>=_?1:m<=S?h.pow(m-E,2)/((_-E)*(S-E)):1-h.pow(_-m,2)/((_-E)*(_-S))},inv:function(m,E,_,S){return _<=E||S<E||S>_?NaN:m<=(S-E)/(_-E)?E+(_-E)*h.sqrt(m*((S-E)/(_-E))):E+(_-E)*(1-h.sqrt((1-m)*(1-(S-E)/(_-E))))},mean:function(m,E,_){return(m+E+_)/3},median:function(m,E,_){return _<=(m+E)/2?E-h.sqrt((E-m)*(E-_))/h.sqrt(2):_>(m+E)/2?m+h.sqrt((E-m)*(_-m))/h.sqrt(2):void 0},mode:function(m,E,_){return _},sample:function(m,E,_){var S=c._random_fn();return S<(_-m)/(E-m)?m+h.sqrt(S*(E-m)*(_-m)):E-h.sqrt((1-S)*(E-m)*(E-_))},variance:function(m,E,_){return(m*m+E*E+_*_-m*E-m*_-E*_)/18}}),c.extend(c.arcsine,{pdf:function(m,E,_){return _<=E?NaN:m<=E||m>=_?0:2/h.PI*h.pow(h.pow(_-E,2)-h.pow(2*m-E-_,2),-.5)},cdf:function(m,E,_){return m<E?0:m<_?2/h.PI*h.asin(h.sqrt((m-E)/(_-E))):1},inv:function(m,E,_){return E+(.5-.5*h.cos(h.PI*m))*(_-E)},mean:function(m,E){return E<=m?NaN:(m+E)/2},median:function(m,E){return E<=m?NaN:(m+E)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,E){return(m+E)/2+(E-m)/2*h.sin(2*h.PI*c.uniform.sample(0,1))},variance:function(m,E){return E<=m?NaN:h.pow(E-m,2)/8}}),c.extend(c.laplace,{pdf:function(m,E,_){return _<=0?0:h.exp(-h.abs(m-E)/_)/(2*_)},cdf:function(m,E,_){return _<=0?0:m<E?.5*h.exp((m-E)/_):1-.5*h.exp(-(m-E)/_)},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},variance:function(m,E){return 2*E*E},sample:function(m,E){var _,S=c._random_fn()-.5;return m-E*((_=S)/h.abs(_))*h.log(1-2*h.abs(S))}}),c.extend(c.tukey,{cdf:function(m,E,_){var S=E,w=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],A=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(m<=0)return 0;if(_<2||S<2)return NaN;if(!Number.isFinite(m))return 1;if(_>25e3)return v(m,1,S);var O,D=.5*_,Y=D*h.log(_)-_*h.log(2)-c.gammaln(D),H=D-1,k=.25*_;O=_<=100?1:_<=800?.5:_<=5e3?.25:.125,Y+=h.log(O);for(var K=0,se=1;se<=50;se++){for(var re=0,Ce=(2*se-1)*O,Le=1;Le<=16;Le++){var he,ve;8<Le?(he=Le-8-1,ve=Y+H*h.log(Ce+w[he]*O)-(w[he]*O+Ce)*k):(he=Le-1,ve=Y+H*h.log(Ce-w[he]*O)+(w[he]*O-Ce)*k),ve>=-30&&(re+=v(8<Le?m*h.sqrt(.5*(w[he]*O+Ce)):m*h.sqrt(.5*(-w[he]*O+Ce)),1,S)*A[he]*h.exp(ve))}if(se*O>=1&&re<=1e-14)break;K+=re}if(re>1e-14)throw new Error("tukey.cdf failed to converge");return K>1&&(K=1),K},inv:function(m,E,_){if(_<2||E<2)return NaN;if(m<0||m>1)return NaN;if(m===0)return 0;if(m===1)return 1/0;var S,w=function(H,k,K){var se=.5-.5*H,re=h.sqrt(h.log(1/(se*se))),Ce=re+((((-453642210148e-16*re-.204231210125)*re-.342242088547)*re-1)*re+.322232421088)/((((.0038560700634*re+.10353775285)*re+.531103462366)*re+.588581570495)*re+.099348462606);K<120&&(Ce+=(Ce*Ce*Ce+Ce)/K/4);var Le=.8832-.2368*Ce;return K<120&&(Le+=-1.214/K+1.208*Ce/K),Ce*(Le*h.log(k-1)+1.4142)}(m,E,_),A=c.tukey.cdf(w,E,_)-m;S=A>0?h.max(0,w-1):w+1;for(var O,D=c.tukey.cdf(S,E,_)-m,Y=1;Y<50;Y++)if(O=S-D*(S-w)/(D-A),A=D,w=S,O<0&&(O=0,D=-m),D=c.tukey.cdf(O,E,_)-m,S=O,h.abs(S-w)<1e-4)return O;throw new Error("tukey.inv failed to converge")}})}(u,Math),function(c,h){var g,v,m=Array.prototype.push,E=c.utils.isArray;function _(S){return E(S)||S instanceof c}c.extend({add:function(S,w){return _(w)?(_(w[0])||(w=[w]),c.map(S,function(A,O,D){return A+w[O][D]})):c.map(S,function(A){return A+w})},subtract:function(S,w){return _(w)?(_(w[0])||(w=[w]),c.map(S,function(A,O,D){return A-w[O][D]||0})):c.map(S,function(A){return A-w})},divide:function(S,w){return _(w)?(_(w[0])||(w=[w]),c.multiply(S,c.inv(w))):c.map(S,function(A){return A/w})},multiply:function(S,w){var A,O,D,Y,H,k,K,se;if(S.length===void 0&&w.length===void 0)return S*w;if(H=S.length,k=S[0].length,K=c.zeros(H,D=_(w)?w[0].length:k),se=0,_(w)){for(;se<D;se++)for(A=0;A<H;A++){for(Y=0,O=0;O<k;O++)Y+=S[A][O]*w[O][se];K[A][se]=Y}return H===1&&se===1?K[0][0]:K}return c.map(S,function(re){return re*w})},outer:function(S,w){return c.multiply(S.map(function(A){return[A]}),[w])},dot:function(S,w){_(S[0])||(S=[S]),_(w[0])||(w=[w]);for(var A,O,D=S[0].length===1&&S.length!==1?c.transpose(S):S,Y=w[0].length===1&&w.length!==1?c.transpose(w):w,H=[],k=0,K=D.length,se=D[0].length;k<K;k++){for(H[k]=[],A=0,O=0;O<se;O++)A+=D[k][O]*Y[k][O];H[k]=A}return H.length===1?H[0]:H},pow:function(S,w){return c.map(S,function(A){return h.pow(A,w)})},exp:function(S){return c.map(S,function(w){return h.exp(w)})},log:function(S){return c.map(S,function(w){return h.log(w)})},abs:function(S){return c.map(S,function(w){return h.abs(w)})},norm:function(S,w){var A=0,O=0;for(isNaN(w)&&(w=2),_(S[0])&&(S=S[0]);O<S.length;O++)A+=h.pow(h.abs(S[O]),w);return h.pow(A,1/w)},angle:function(S,w){return h.acos(c.dot(S,w)/(c.norm(S)*c.norm(w)))},aug:function(S,w){var A,O=[];for(A=0;A<S.length;A++)O.push(S[A].slice());for(A=0;A<O.length;A++)m.apply(O[A],w[A]);return O},inv:function(S){for(var w,A=S.length,O=S[0].length,D=c.identity(A,O),Y=c.gauss_jordan(S,D),H=[],k=0;k<A;k++)for(H[k]=[],w=O;w<Y[0].length;w++)H[k][w-O]=Y[k][w];return H},det:function S(w){if(w.length===2)return w[0][0]*w[1][1]-w[0][1]*w[1][0];for(var A=0,O=0;O<w.length;O++){for(var D=[],Y=1;Y<w.length;Y++){D[Y-1]=[];for(var H=0;H<w.length;H++)H<O?D[Y-1][H]=w[Y][H]:H>O&&(D[Y-1][H-1]=w[Y][H])}var k=O%2?-1:1;A+=S(D)*w[0][O]*k}return A},gauss_elimination:function(S,w){var A,O,D,Y,H=0,k=0,K=S.length,se=S[0].length,re=1,Ce=0,Le=[];for(A=(S=c.aug(S,w))[0].length,H=0;H<K;H++){for(O=S[H][H],k=H,Y=H+1;Y<se;Y++)O<h.abs(S[Y][H])&&(O=S[Y][H],k=Y);if(k!=H)for(Y=0;Y<A;Y++)D=S[H][Y],S[H][Y]=S[k][Y],S[k][Y]=D;for(k=H+1;k<K;k++)for(re=S[k][H]/S[H][H],Y=H;Y<A;Y++)S[k][Y]=S[k][Y]-re*S[H][Y]}for(H=K-1;H>=0;H--){for(Ce=0,k=H+1;k<=K-1;k++)Ce+=Le[k]*S[H][k];Le[H]=(S[H][A-1]-Ce)/S[H][H]}return Le},gauss_jordan:function(S,w){var A,O,D,Y=c.aug(S,w),H=Y.length,k=Y[0].length,K=0;for(O=0;O<H;O++){var se=O;for(D=O+1;D<H;D++)h.abs(Y[D][O])>h.abs(Y[se][O])&&(se=D);var re=Y[O];for(Y[O]=Y[se],Y[se]=re,D=O+1;D<H;D++)for(K=Y[D][O]/Y[O][O],A=O;A<k;A++)Y[D][A]-=Y[O][A]*K}for(O=H-1;O>=0;O--){for(K=Y[O][O],D=0;D<O;D++)for(A=k-1;A>O-1;A--)Y[D][A]-=Y[O][A]*Y[D][O]/K;for(Y[O][O]/=K,A=H;A<k;A++)Y[O][A]/=K}return Y},triaUpSolve:function(S,w){var A,O=S[0].length,D=c.zeros(1,O)[0],Y=!1;return w[0].length!=null&&(w=w.map(function(H){return H[0]}),Y=!0),c.arange(O-1,-1,-1).forEach(function(H){A=c.arange(H+1,O).map(function(k){return D[k]*S[H][k]}),D[H]=(w[H]-c.sum(A))/S[H][H]}),Y?D.map(function(H){return[H]}):D},triaLowSolve:function(S,w){var A,O=S[0].length,D=c.zeros(1,O)[0],Y=!1;return w[0].length!=null&&(w=w.map(function(H){return H[0]}),Y=!0),c.arange(O).forEach(function(H){A=c.arange(H).map(function(k){return S[H][k]*D[k]}),D[H]=(w[H]-c.sum(A))/S[H][H]}),Y?D.map(function(H){return[H]}):D},lu:function(S){var w,A=S.length,O=c.identity(A),D=c.zeros(S.length,S[0].length);return c.arange(A).forEach(function(Y){D[0][Y]=S[0][Y]}),c.arange(1,A).forEach(function(Y){c.arange(Y).forEach(function(H){w=c.arange(H).map(function(k){return O[Y][k]*D[k][H]}),O[Y][H]=(S[Y][H]-c.sum(w))/D[H][H]}),c.arange(Y,A).forEach(function(H){w=c.arange(Y).map(function(k){return O[Y][k]*D[k][H]}),D[Y][H]=S[w.length][H]-c.sum(w)})}),[O,D]},cholesky:function(S){var w,A=S.length,O=c.zeros(S.length,S[0].length);return c.arange(A).forEach(function(D){w=c.arange(D).map(function(Y){return h.pow(O[D][Y],2)}),O[D][D]=h.sqrt(S[D][D]-c.sum(w)),c.arange(D+1,A).forEach(function(Y){w=c.arange(D).map(function(H){return O[D][H]*O[Y][H]}),O[Y][D]=(S[D][Y]-c.sum(w))/O[D][D]})}),O},gauss_jacobi:function(S,w,A,O){for(var D,Y,H,k,K=0,se=0,re=S.length,Ce=[],Le=[],he=[];K<re;K++)for(Ce[K]=[],Le[K]=[],he[K]=[],se=0;se<re;se++)K>se?(Ce[K][se]=S[K][se],Le[K][se]=he[K][se]=0):K<se?(Le[K][se]=S[K][se],Ce[K][se]=he[K][se]=0):(he[K][se]=S[K][se],Ce[K][se]=Le[K][se]=0);for(H=c.multiply(c.multiply(c.inv(he),c.add(Ce,Le)),-1),Y=c.multiply(c.inv(he),w),D=A,k=c.add(c.multiply(H,A),Y),K=2;h.abs(c.norm(c.subtract(k,D)))>O;)D=k,k=c.add(c.multiply(H,D),Y),K++;return k},gauss_seidel:function(S,w,A,O){for(var D,Y,H,k,K,se=0,re=S.length,Ce=[],Le=[],he=[];se<re;se++)for(Ce[se]=[],Le[se]=[],he[se]=[],D=0;D<re;D++)se>D?(Ce[se][D]=S[se][D],Le[se][D]=he[se][D]=0):se<D?(Le[se][D]=S[se][D],Ce[se][D]=he[se][D]=0):(he[se][D]=S[se][D],Ce[se][D]=Le[se][D]=0);for(k=c.multiply(c.multiply(c.inv(c.add(he,Ce)),Le),-1),H=c.multiply(c.inv(c.add(he,Ce)),w),Y=A,K=c.add(c.multiply(k,A),H),se=2;h.abs(c.norm(c.subtract(K,Y)))>O;)Y=K,K=c.add(c.multiply(k,Y),H),se+=1;return K},SOR:function(S,w,A,O,D){for(var Y,H,k,K,se,re=0,Ce=S.length,Le=[],he=[],ve=[];re<Ce;re++)for(Le[re]=[],he[re]=[],ve[re]=[],Y=0;Y<Ce;Y++)re>Y?(Le[re][Y]=S[re][Y],he[re][Y]=ve[re][Y]=0):re<Y?(he[re][Y]=S[re][Y],Le[re][Y]=ve[re][Y]=0):(ve[re][Y]=S[re][Y],Le[re][Y]=he[re][Y]=0);for(K=c.multiply(c.inv(c.add(ve,c.multiply(Le,D))),c.subtract(c.multiply(ve,1-D),c.multiply(he,D))),k=c.multiply(c.multiply(c.inv(c.add(ve,c.multiply(Le,D))),w),D),H=A,se=c.add(c.multiply(K,A),k),re=2;h.abs(c.norm(c.subtract(se,H)))>O;)H=se,se=c.add(c.multiply(K,H),k),re++;return se},householder:function(S){for(var w,A,O,D,Y=S.length,H=S[0].length,k=0,K=[],se=[];k<Y-1;k++){for(w=0,D=k+1;D<H;D++)w+=S[D][k]*S[D][k];for(w=(S[k+1][k]>0?-1:1)*h.sqrt(w),A=h.sqrt((w*w-S[k+1][k]*w)/2),(K=c.zeros(Y,1))[k+1][0]=(S[k+1][k]-w)/(2*A),O=k+2;O<Y;O++)K[O][0]=S[O][k]/(2*A);se=c.subtract(c.identity(Y,H),c.multiply(c.multiply(K,c.transpose(K)),2)),S=c.multiply(se,c.multiply(S,se))}return S},QR:(g=c.sum,v=c.arange,function(S){var w,A,O,D=S.length,Y=S[0].length,H=c.zeros(Y,Y);for(S=c.copy(S),A=0;A<Y;A++){for(H[A][A]=h.sqrt(g(v(D).map(function(k){return S[k][A]*S[k][A]}))),w=0;w<D;w++)S[w][A]=S[w][A]/H[A][A];for(O=A+1;O<Y;O++)for(H[A][O]=g(v(D).map(function(k){return S[k][A]*S[k][O]})),w=0;w<D;w++)S[w][O]=S[w][O]-S[w][A]*H[A][O]}return[S,H]}),lstsq:function(S,w){var A=!1;w[0].length===void 0&&(w=w.map(function(Ce){return[Ce]}),A=!0);var O=c.QR(S),D=O[0],Y=O[1],H=S[0].length,k=c.slice(D,{col:{end:H}}),K=function(Ce){var Le=(Ce=c.copy(Ce)).length,he=c.identity(Le);return c.arange(Le-1,-1,-1).forEach(function(ve){c.sliceAssign(he,{row:ve},c.divide(c.slice(he,{row:ve}),Ce[ve][ve])),c.sliceAssign(Ce,{row:ve},c.divide(c.slice(Ce,{row:ve}),Ce[ve][ve])),c.arange(ve).forEach(function(xe){var Ie=c.multiply(Ce[xe][ve],-1),we=c.slice(Ce,{row:xe}),Ne=c.multiply(c.slice(Ce,{row:ve}),Ie);c.sliceAssign(Ce,{row:xe},c.add(we,Ne));var at=c.slice(he,{row:xe}),nt=c.multiply(c.slice(he,{row:ve}),Ie);c.sliceAssign(he,{row:xe},c.add(at,nt))})}),he}(c.slice(Y,{row:{end:H}})),se=c.transpose(k);se[0].length===void 0&&(se=[se]);var re=c.multiply(c.multiply(K,se),w);return re.length===void 0&&(re=[[re]]),A?re.map(function(Ce){return Ce[0]}):re},jacobi:function(S){for(var w,A,O,D,Y,H,k,K=1,se=S.length,re=c.identity(se,se),Ce=[];K===1;){for(Y=S[0][1],O=0,D=1,w=0;w<se;w++)for(A=0;A<se;A++)w!=A&&Y<h.abs(S[w][A])&&(Y=h.abs(S[w][A]),O=w,D=A);for(H=S[O][O]===S[D][D]?S[O][D]>0?h.PI/4:-h.PI/4:h.atan(2*S[O][D]/(S[O][O]-S[D][D]))/2,(k=c.identity(se,se))[O][O]=h.cos(H),k[O][D]=-h.sin(H),k[D][O]=h.sin(H),k[D][D]=h.cos(H),re=c.multiply(re,k),S=c.multiply(c.multiply(c.inv(k),S),k),K=0,w=1;w<se;w++)for(A=1;A<se;A++)w!=A&&h.abs(S[w][A])>.001&&(K=1)}for(w=0;w<se;w++)Ce.push(S[w][w]);return[re,Ce]},rungekutta:function(S,w,A,O,D,Y){var H,k,K;if(Y===2)for(;O<=A;)D+=((H=w*S(O,D))+(k=w*S(O+w,D+H)))/2,O+=w;if(Y===4)for(;O<=A;)D+=((H=w*S(O,D))+2*(k=w*S(O+w/2,D+H/2))+2*(K=w*S(O+w/2,D+k/2))+w*S(O+w,D+K))/6,O+=w;return D},romberg:function(S,w,A,O){for(var D,Y,H,k,K,se=0,re=(A-w)/2,Ce=[],Le=[],he=[];se<O/2;){for(K=S(w),H=w,k=0;H<=A;H+=re,k++)Ce[k]=H;for(D=Ce.length,H=1;H<D-1;H++)K+=(H%2!=0?4:2)*S(Ce[H]);K=re/3*(K+S(A)),he[se]=K,re/=2,se++}for(Y=he.length,D=1;Y!==1;){for(H=0;H<Y-1;H++)Le[H]=(h.pow(4,D)*he[H+1]-he[H])/(h.pow(4,D)-1);Y=Le.length,he=Le,Le=[],D++}return he},richardson:function(S,w,A,O){function D(ve,xe){for(var Ie,we=0,Ne=ve.length;we<Ne;we++)ve[we]===xe&&(Ie=we);return Ie}for(var Y,H,k,K,se,re=h.abs(A-S[D(S,A)+1]),Ce=0,Le=[],he=[];O>=re;)Y=D(S,A+O),H=D(S,A),Le[Ce]=(w[Y]-2*w[H]+w[2*H-Y])/(O*O),O/=2,Ce++;for(K=Le.length,k=1;K!=1;){for(se=0;se<K-1;se++)he[se]=(h.pow(4,k)*Le[se+1]-Le[se])/(h.pow(4,k)-1);K=he.length,Le=he,he=[],k++}return Le},simpson:function(S,w,A,O){for(var D,Y=(A-w)/O,H=S(w),k=[],K=w,se=0,re=1;K<=A;K+=Y,se++)k[se]=K;for(D=k.length;re<D-1;re++)H+=(re%2!=0?4:2)*S(k[re]);return Y/3*(H+S(A))},hermite:function(S,w,A,O){for(var D,Y=S.length,H=0,k=0,K=[],se=[],re=[],Ce=[];k<Y;k++){for(K[k]=1,D=0;D<Y;D++)k!=D&&(K[k]*=(O-S[D])/(S[k]-S[D]));for(se[k]=0,D=0;D<Y;D++)k!=D&&(se[k]+=1/(S[k]-S[D]));re[k]=(1-2*(O-S[k])*se[k])*(K[k]*K[k]),Ce[k]=(O-S[k])*(K[k]*K[k]),H+=re[k]*w[k]+Ce[k]*A[k]}return H},lagrange:function(S,w,A){for(var O,D,Y=0,H=0,k=S.length;H<k;H++){for(D=w[H],O=0;O<k;O++)H!=O&&(D*=(A-S[O])/(S[H]-S[O]));Y+=D}return Y},cubic_spline:function(S,w,A){for(var O,D,Y=S.length,H=0,k=[],K=[],se=[],re=[],Ce=[],Le=[];H<Y-1;H++)re[H]=S[H+1]-S[H];for(se[0]=0,H=1;H<Y-1;H++)se[H]=3/re[H]*(w[H+1]-w[H])-3/re[H-1]*(w[H]-w[H-1]);for(H=1;H<Y-1;H++)k[H]=[],K[H]=[],k[H][H-1]=re[H-1],k[H][H]=2*(re[H-1]+re[H]),k[H][H+1]=re[H],K[H][0]=se[H];for(D=c.multiply(c.inv(k),K),O=0;O<Y-1;O++)Ce[O]=(w[O+1]-w[O])/re[O]-re[O]*(D[O+1][0]+2*D[O][0])/3,Le[O]=(D[O+1][0]-D[O][0])/(3*re[O]);for(O=0;O<Y&&!(S[O]>A);O++);return w[O-=1]+(A-S[O])*Ce[O]+c.sq(A-S[O])*D[O]+(A-S[O])*c.sq(A-S[O])*Le[O]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(S){var w,A,O,D,Y,H=S.length,k=S[0].length,K=0,se=[],re=[],Ce=[],Le=[],he=[],ve=[],xe=[];for(K=0;K<H;K++)se[K]=c.sum(S[K])/k;for(K=0;K<k;K++)for(he[K]=[],w=0;w<H;w++)he[K][w]=S[w][K]-se[w];for(he=c.transpose(he),K=0;K<H;K++)for(ve[K]=[],w=0;w<H;w++)ve[K][w]=c.dot([he[K]],[he[w]])/(k-1);for(Y=(O=c.jacobi(ve))[0],re=O[1],xe=c.transpose(Y),K=0;K<re.length;K++)for(w=K;w<re.length;w++)re[K]<re[w]&&(A=re[K],re[K]=re[w],re[w]=A,Ce=xe[K],xe[K]=xe[w],xe[w]=Ce);for(D=c.transpose(he),K=0;K<H;K++)for(Le[K]=[],w=0;w<D.length;w++)Le[K][w]=c.dot([xe[K]],[D[w]]);return[S,re,xe,Le]}}),function(S){for(var w=0;w<S.length;w++)(function(A){c.fn[A]=function(O,D){var Y=this;return D?(setTimeout(function(){D.call(Y,c.fn[A].call(Y,O))},15),this):typeof c[A](this,O)=="number"?c[A](this,O):c(c[A](this,O))}})(S[w])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(u,Math),function(c,h){var g=[].slice,v=c.utils.isNumber,m=c.utils.isArray;function E(_,S,w,A){if(_>1||w>1||_<=0||w<=0)throw new Error("Proportions should be greater than 0 and less than 1");var O=(_*S+w*A)/(S+A);return(_-w)/h.sqrt(O*(1-O)*(1/S+1/A))}c.extend({zscore:function(){var _=g.call(arguments);return v(_[1])?(_[0]-_[1])/_[2]:(_[0]-c.mean(_[1]))/c.stdev(_[1],_[2])},ztest:function(){var _,S=g.call(arguments);return m(S[1])?(_=c.zscore(S[0],S[1],S[3]),S[2]===1?c.normal.cdf(-h.abs(_),0,1):2*c.normal.cdf(-h.abs(_),0,1)):S.length>2?(_=c.zscore(S[0],S[1],S[2]),S[3]===1?c.normal.cdf(-h.abs(_),0,1):2*c.normal.cdf(-h.abs(_),0,1)):(_=S[0],S[1]===1?c.normal.cdf(-h.abs(_),0,1):2*c.normal.cdf(-h.abs(_),0,1))}}),c.extend(c.fn,{zscore:function(_,S){return(_-this.mean())/this.stdev(S)},ztest:function(_,S,w){var A=h.abs(this.zscore(_,w));return S===1?c.normal.cdf(-A,0,1):2*c.normal.cdf(-A,0,1)}}),c.extend({tscore:function(){var _=g.call(arguments);return _.length===4?(_[0]-_[1])/(_[2]/h.sqrt(_[3])):(_[0]-c.mean(_[1]))/(c.stdev(_[1],!0)/h.sqrt(_[1].length))},ttest:function(){var _,S=g.call(arguments);return S.length===5?(_=h.abs(c.tscore(S[0],S[1],S[2],S[3])),S[4]===1?c.studentt.cdf(-_,S[3]-1):2*c.studentt.cdf(-_,S[3]-1)):v(S[1])?(_=h.abs(S[0]),S[2]==1?c.studentt.cdf(-_,S[1]-1):2*c.studentt.cdf(-_,S[1]-1)):(_=h.abs(c.tscore(S[0],S[1])),S[2]==1?c.studentt.cdf(-_,S[1].length-1):2*c.studentt.cdf(-_,S[1].length-1))}}),c.extend(c.fn,{tscore:function(_){return(_-this.mean())/(this.stdev(!0)/h.sqrt(this.cols()))},ttest:function(_,S){return S===1?1-c.studentt.cdf(h.abs(this.tscore(_)),this.cols()-1):2*c.studentt.cdf(-h.abs(this.tscore(_)),this.cols()-1)}}),c.extend({anovafscore:function(){var _,S,w,A,O,D,Y,H,k=g.call(arguments);if(k.length===1){for(O=new Array(k[0].length),Y=0;Y<k[0].length;Y++)O[Y]=k[0][Y];k=O}for(S=new Array,Y=0;Y<k.length;Y++)S=S.concat(k[Y]);for(w=c.mean(S),_=0,Y=0;Y<k.length;Y++)_+=k[Y].length*h.pow(c.mean(k[Y])-w,2);for(_/=k.length-1,D=0,Y=0;Y<k.length;Y++)for(A=c.mean(k[Y]),H=0;H<k[Y].length;H++)D+=h.pow(k[Y][H]-A,2);return _/(D/(S.length-k.length))},anovaftest:function(){var _,S,w,A,O=g.call(arguments);if(v(O[0]))return 1-c.centralF.cdf(O[0],O[1],O[2]);var D=c.anovafscore(O);for(_=O.length-1,w=0,A=0;A<O.length;A++)w+=O[A].length;return S=w-_-1,1-c.centralF.cdf(D,_,S)},ftest:function(_,S,w){return 1-c.centralF.cdf(_,S,w)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){var _,S=0;for(_=0;_<this.length;_++)S+=this[_].length;return c.ftest(this.anovafscore(),this.length-1,S-this.length)}}),c.extend({qscore:function(){var _,S,w,A,O,D=g.call(arguments);return v(D[0])?(_=D[0],S=D[1],w=D[2],A=D[3],O=D[4]):(_=c.mean(D[0]),S=c.mean(D[1]),w=D[0].length,A=D[1].length,O=D[2]),h.abs(_-S)/(O*h.sqrt((1/w+1/A)/2))},qtest:function(){var _,S=g.call(arguments);S.length===3?(_=S[0],S=S.slice(1)):S.length===7?(_=c.qscore(S[0],S[1],S[2],S[3],S[4]),S=S.slice(5)):(_=c.qscore(S[0],S[1],S[2]),S=S.slice(3));var w=S[0],A=S[1];return 1-c.tukey.cdf(_,A,w-A)},tukeyhsd:function(_){for(var S=c.pooledstdev(_),w=_.map(function(k){return c.mean(k)}),A=_.reduce(function(k,K){return k+K.length},0),O=[],D=0;D<_.length;++D)for(var Y=D+1;Y<_.length;++Y){var H=c.qtest(w[D],w[Y],_[D].length,_[Y].length,S,A,_.length);O.push([[D,Y],H])}return O}}),c.extend({normalci:function(){var _,S=g.call(arguments),w=new Array(2);return _=S.length===4?h.abs(c.normal.inv(S[1]/2,0,1)*S[2]/h.sqrt(S[3])):h.abs(c.normal.inv(S[1]/2,0,1)*c.stdev(S[2])/h.sqrt(S[2].length)),w[0]=S[0]-_,w[1]=S[0]+_,w},tci:function(){var _,S=g.call(arguments),w=new Array(2);return _=S.length===4?h.abs(c.studentt.inv(S[1]/2,S[3]-1)*S[2]/h.sqrt(S[3])):h.abs(c.studentt.inv(S[1]/2,S[2].length-1)*c.stdev(S[2],!0)/h.sqrt(S[2].length)),w[0]=S[0]-_,w[1]=S[0]+_,w},significant:function(_,S){return _<S}}),c.extend(c.fn,{normalci:function(_,S){return c.normalci(_,S,this.toArray())},tci:function(_,S){return c.tci(_,S,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(_,S,w,A){var O=E(_,S,w,A);return c.ztest(O,1)},twoSidedDifferenceOfProportions:function(_,S,w,A){var O=E(_,S,w,A);return c.ztest(O,2)}})}(u,Math),u.models=function(){function c(g,v){var m=g.length,E=v[0].length-1,_=m-E-1,S=u.lstsq(v,g),w=u.multiply(v,S.map(function(k){return[k]})).map(function(k){return k[0]}),A=u.subtract(g,w),O=u.mean(g),D=u.sum(w.map(function(k){return Math.pow(k-O,2)})),Y=u.sum(g.map(function(k,K){return Math.pow(k-w[K],2)})),H=D+Y;return{exog:v,endog:g,nobs:m,df_model:E,df_resid:_,coef:S,predict:w,resid:A,ybar:O,SST:H,SSE:D,SSR:Y,R2:D/H}}function h(g){var v,m,E=(v=g.exog,m=v[0].length,u.arange(m).map(function(Y){var H=u.arange(m).filter(function(k){return k!==Y});return c(u.col(v,Y).map(function(k){return k[0]}),u.col(v,H))})),_=Math.sqrt(g.SSR/g.df_resid),S=E.map(function(Y){var H=Y.SST,k=Y.R2;return _/Math.sqrt(H*(1-k))}),w=g.coef.map(function(Y,H){return(Y-0)/S[H]}),A=w.map(function(Y){var H=u.studentt.cdf(Y,g.df_resid);return 2*(H>.5?1-H:H)}),O=u.studentt.inv(.975,g.df_resid),D=g.coef.map(function(Y,H){var k=O*S[H];return[Y-k,Y+k]});return{se:S,t:w,p:A,sigmaHat:_,interval95:D}}return{ols:function(g,v){var m=c(g,v),E=h(m),_=function(w){var A,O,D,Y=w.R2/w.df_model/((1-w.R2)/w.df_resid);return{F_statistic:Y,pvalue:1-(A=Y,O=w.df_model,D=w.df_resid,u.beta.cdf(A/(D/O+A),O/2,D/2))}}(m),S=1-(1-m.R2)*((m.nobs-1)/m.df_resid);return m.t=E,m.f=_,m.adjust_R2=S,m}}}(),u.extend({buildxmatrix:function(){for(var c=new Array(arguments.length),h=0;h<arguments.length;h++)c[h]=[1].concat(arguments[h]);return u(c)},builddxmatrix:function(){for(var c=new Array(arguments[0].length),h=0;h<arguments[0].length;h++)c[h]=[1].concat(arguments[0][h]);return u(c)},buildjxmatrix:function(c){for(var h=new Array(c.length),g=0;g<c.length;g++)h[g]=c[g];return u.builddxmatrix(h)},buildymatrix:function(c){return u(c).transpose()},buildjymatrix:function(c){return c.transpose()},matrixmult:function(c,h){var g,v,m,E,_;if(c.cols()==h.rows()){if(h.rows()>1){for(E=[],g=0;g<c.rows();g++)for(E[g]=[],v=0;v<h.cols();v++){for(_=0,m=0;m<c.cols();m++)_+=c.toArray()[g][m]*h.toArray()[m][v];E[g][v]=_}return u(E)}for(E=[],g=0;g<c.rows();g++)for(E[g]=[],v=0;v<h.cols();v++){for(_=0,m=0;m<c.cols();m++)_+=c.toArray()[g][m]*h.toArray()[v];E[g][v]=_}return u(E)}},regress:function(c,h){var g=u.xtranspxinv(c),v=c.transpose(),m=u.matrixmult(u(g),v);return u.matrixmult(m,h)},regresst:function(c,h,g){var v=u.regress(c,h),m={anova:{}},E=u.jMatYBar(c,v);m.yBar=E;var _=h.mean();m.anova.residuals=u.residuals(h,E),m.anova.ssr=u.ssr(E,_),m.anova.msr=m.anova.ssr/(c[0].length-1),m.anova.sse=u.sse(h,E),m.anova.mse=m.anova.sse/(h.length-(c[0].length-1)-1),m.anova.sst=u.sst(h,_),m.anova.mst=m.anova.sst/(h.length-1),m.anova.r2=1-m.anova.sse/m.anova.sst,m.anova.r2<0&&(m.anova.r2=0),m.anova.fratio=m.anova.msr/m.anova.mse,m.anova.pvalue=u.anovaftest(m.anova.fratio,c[0].length-1,h.length-(c[0].length-1)-1),m.anova.rmse=Math.sqrt(m.anova.mse),m.anova.r2adj=1-m.anova.mse/m.anova.mst,m.anova.r2adj<0&&(m.anova.r2adj=0),m.stats=new Array(c[0].length);for(var S,w,A,O=u.xtranspxinv(c),D=0;D<v.length;D++)S=Math.sqrt(m.anova.mse*Math.abs(O[D][D])),w=Math.abs(v[D]/S),A=u.ttest(w,h.length-c[0].length-1,g),m.stats[D]=[v[D],S,w,A];return m.regress=v,m},xtranspx:function(c){return u.matrixmult(c.transpose(),c)},xtranspxinv:function(c){var h=u.matrixmult(c.transpose(),c);return u.inv(h)},jMatYBar:function(c,h){var g=u.matrixmult(c,h);return new u(g)},residuals:function(c,h){return u.matrixsubtract(c,h)},ssr:function(c,h){for(var g=0,v=0;v<c.length;v++)g+=Math.pow(c[v]-h,2);return g},sse:function(c,h){for(var g=0,v=0;v<c.length;v++)g+=Math.pow(c[v]-h[v],2);return g},sst:function(c,h){for(var g=0,v=0;v<c.length;v++)g+=Math.pow(c[v]-h,2);return g},matrixsubtract:function(c,h){for(var g=new Array(c.length),v=0;v<c.length;v++){g[v]=new Array(c[v].length);for(var m=0;m<c[v].length;m++)g[v][m]=c[v][m]-h[v][m]}return u(g)}}),u.jStat=u,u)},960:function(l,u,c){const h=c(592);l.exports=function(g){function v(D,Y){const H=Y.split(".");let k=D;for(const K of H){if(k==null)return;k=k[K]}return k}for(let D=0;D<Object.keys(h).length;D++){let Y,H=Object.keys(h)[D],k=[];if(typeof h[H]=="object"){k=Object.keys(h[H]),Y=Object.values(h[H]);for(let K=0;K<Y.length;K++)if(typeof Y[K]=="object"){let se=k[K];h[H][se]&&(k=[...k,...Object.keys(h[H][se]).map(re=>se+"."+re)],k.splice(k.indexOf(se),1))}}if(k.length<1)g[H]=h[H];else for(let K=0;K<k.length;K++)typeof v(h[H],k[K])=="function"&&(g[H]=v(h[H],k[K]))}let m=function(D){return typeof D=="number"&&(D=parseInt(D)),D},E=null,_=null,S=null;g.TABLE=function(){return S},g.COLUMN=g.COL=function(){return S.tracking&&S.tracking.push(O.getColumnNameFromCoords(m(E),m(_))),m(E)+1},g.ROW=function(){return S.tracking&&S.tracking.push(O.getColumnNameFromCoords(m(E),m(_))),m(_)+1},g.CELL=function(){return O.getColumnNameFromCoords(E,_)},g.VALUE=function(D,Y,H){return S.getValueFromCoords(m(D)-1,m(Y)-1,H)},g.THISROWCELL=function(D){return S.getValueFromCoords(m(D)-1,m(_))};const w=function(D,Y){for(let H=0;H<D.length;H++){let k=O.getTokensFromRange(D[H]);Y=Y.replace(D[H],"["+k.join(",")+"]")}return Y},A=function(D){return typeof D=="string"&&(D=D.trim()),!isNaN(D)&&D!==null&&D!==""},O=function(D,Y,H,k,K){S=K,E=H,_=k;let se="",re={};if(Y)if(Y.size){let he,ve=null;Y.forEach(function(xe,Ie){he=Ie.replace(/!/g,"."),he.indexOf(".")!==-1&&(he=he.split("."),re[he[0]]=!0)}),he=Object.keys(re);for(let xe=0;xe<he.length;xe++)se+="var "+he[xe]+" = {};";Y.forEach(function(xe,Ie){he=Ie.replace(/!/g,"."),xe===null||A(xe)||(ve=xe.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),ve&&ve.length&&(xe=updateRanges(ve,xe))),he.indexOf(".")>0?se+=he+" = "+Y.get(Ie)+`;
`:se+="var "+he+" = "+xe+`;
`})}else{let he=Object.keys(Y);if(he.length){let ve,xe={};for(let Ie=0;Ie<he.length;Ie++)if(ve=he[Ie].replace(/\!/g,"."),ve.indexOf(".")>0){let we=we.split(".");xe[we[0]]={}}ve=Object.keys(xe);for(let Ie=0;Ie<ve.length;Ie++)se+="var "+ve[Ie]+" = {};";for(let Ie=0;Ie<he.length;Ie++){if(ve=he[Ie].replace(/!/g,"."),Y[he[Ie]]!==null&&!A(Y[he[Ie]])){let we=Y[he[Ie]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);we&&we.length&&(Y[he[Ie]]=w(we,Y[he[Ie]]))}ve.indexOf(".")>0?se+=ve+" = "+Y[he[Ie]]+`;
`:se+="var "+ve+" = "+Y[he[Ie]]+`;
`}}}let Ce=(D=function(he,ve){let xe="",Ie=0,we=["=","!",">","<"];for(let Ne=0;Ne<he.length;Ne++)he[Ne]==='"'&&(Ie=Ie===0?1:0),Ie===1?xe+=he[Ne]:(xe+=he[Ne].toUpperCase(),Ne>0&&he[Ne]==="="&&we.indexOf(he[Ne-1])===-1&&we.indexOf(he[Ne+1])===-1&&(xe+="="));return xe=xe.replace(/\^/g,"**"),xe=xe.replace(/<>/g,"!="),xe=xe.replace(/&/g,"+"),xe=xe.replace(/\$/g,""),xe}(D=(D=D.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);Ce&&Ce.length&&(D=w(Ce,D));let Le=new Function(se+"; return "+D)();return Le===null&&(Le=0),Le};return O.getColumnNameFromCoords=function(D,Y){return H=parseInt(D),k="",H>701?(k+=String.fromCharCode(64+parseInt(H/676)),k+=String.fromCharCode(64+parseInt(H%676/26))):H>25&&(k+=String.fromCharCode(64+parseInt(H/26))),k+String.fromCharCode(65+H%26)+(parseInt(Y)+1);var H,k},O.getCoordsFromColumnName=function(D){var Y=/^[a-zA-Z]+/.exec(D);if(Y){for(var H=0,k=0;k<Y[0].length;k++)H+=parseInt(Y[0].charCodeAt(k)-64)*Math.pow(26,Y[0].length-1-k);--H<0&&(H=0);var K=parseInt(/[0-9]+$/.exec(D))||null;return K>0&&K--,[H,K]}},O.getRangeFromTokens=function(D){D=D.filter(function(K){return K!="#REF!"});for(var Y="",H="",k=0;k<D.length;k++)D[k].indexOf(".")>=0?Y=".":D[k].indexOf("!")>=0&&(Y="!"),Y&&(H=D[k].split(Y),D[k]=H[1],H=H[0]+Y);return D.sort(function(K,se){var re=Helpers.getCoordsFromColumnName(K),Ce=Helpers.getCoordsFromColumnName(se);return re[1]>Ce[1]?1:re[1]<Ce[1]?-1:re[0]>Ce[0]?1:re[0]<Ce[0]?-1:0}),D.length?H+(D[0]+":")+D[D.length-1]:"#REF!"},O.getTokensFromRange=function(D){if(D.indexOf(".")>0){var Y=D.split(".");D=Y[1],Y=Y[0]+"."}else D.indexOf("!")>0?(Y=D.split("!"),D=Y[1],Y=Y[0]+"!"):Y="";D=D.split(":");var H=O.getCoordsFromColumnName(D[0]),k=O.getCoordsFromColumnName(D[1]);if(H[0]<=k[0])var K=H[0],se=k[0];else K=k[0],se=H[0];if(H[1]===null&&k[1]==null)for(var re=null,Ce=null,Le=Object.keys(vars),he=0;he<Le.length;he++){var ve=O.getCoordsFromColumnName(Le[he]);ve[0]===H[0]&&(re===null||ve[1]<re)&&(re=ve[1]),ve[0]===k[0]&&(Ce===null||ve[1]>Ce)&&(Ce=ve[1])}else H[1]<=k[1]?(re=H[1],Ce=k[1]):(re=k[1],Ce=H[1]);for(var xe=[],Ie=re;Ie<=Ce;Ie++){var we=[];for(he=K;he<=se;he++)we.push(Y+O.getColumnNameFromCoords(he,Ie));xe.push(we)}return xe},O.setFormula=function(D){let Y=Object.keys(D);for(let H=0;H<Y.length;H++)typeof D[Y[H]]=="function"&&(g[Y[H]]=D[Y[H]])},O.basic=!0,O}(typeof window>"u"?c.g:window)},592:function(l,u,c){var h=c(162),g=c(765);const v=new Error("#NULL!"),m=new Error("#DIV/0!"),E=new Error("#VALUE!"),_=new Error("#REF!"),S=new Error("#NAME?"),w=new Error("#NUM!"),A=new Error("#N/A"),O=new Error("#ERROR!"),D=new Error("#GETTING_DATA");var Y=Object.freeze({__proto__:null,data:D,div0:m,error:O,na:A,name:S,nil:v,num:w,ref:_,value:E});function H(f){const C=[];return k(f,I=>{C.push(I)}),C}function k(f,C){let I=-1;const U=f.length;for(;++I<U&&C(f[I],I,f)!==!1;);return f}function K(f){let C,I=f.length;for(;I--;)if(C=f[I],typeof C!="number")if(C!==!0)if(C!==!1){if(typeof C=="string"){const U=V(C);f[I]=U instanceof Error?0:U}}else f[I]=0;else f[I]=1;return f}function se(f,C){if(!f)return E;f.every(ne=>Array.isArray(ne))&&f.length!==0||(f=[[...f]]),f.map((ne,ce)=>{ne.map((Te,ze)=>{Te||(f[ce][ze]=0)})});const I=f.reduce((ne,ce,Te)=>ce.length>f[ne].length?Te:ne,0),U=f[I].length;return f.map(ne=>[...ne,...Array(U-ne.length).fill(0)])}function re(){let f;if(arguments.length===1){const I=arguments[0];f=(C=I)!=null&&typeof C.length=="number"&&typeof C!="string"?H.apply(null,arguments):[I]}else f=Array.from(arguments);for(var C;!Le(f);)f=Ce(f);return f}function Ce(f){return f&&f.reduce?f.reduce((C,I)=>{const U=Array.isArray(C),ne=Array.isArray(I);return U&&ne?C.concat(I):U?(C.push(I),C):ne?[C].concat(I):[C,I]}):[f]}function Le(f){if(!f)return!1;for(let C=0;C<f.length;++C)if(Array.isArray(f[C]))return!1;return!0}function he(f,C){return C=C||1,f&&typeof f.slice=="function"?f.slice(C):f}function ve(f){return f?f[0].map((C,I)=>f.map(U=>U[I])):E}function xe(f,C){let I=null;return k(f,(U,ne)=>{if(U[0]===C)return I=ne,!1}),I??E}function Ie(){for(let f=0;f<arguments.length;f++)if(arguments[f]instanceof Error)return arguments[f]}function we(){let f=arguments.length;for(;f--;)if(arguments[f]instanceof Error)return!0;return!1}function Ne(f){return Math.round(f*1e14)/1e14}function at(){return re.apply(null,arguments).filter(f=>typeof f=="number")}function nt(f){if(typeof f=="boolean"||f instanceof Error)return f;if(typeof f=="number")return f!==0;if(typeof f=="string"){const C=f.toUpperCase();if(C==="TRUE")return!0;if(C==="FALSE")return!1}return f instanceof Date&&!isNaN(f)||E}function B(f){if(!isNaN(f)){if(f instanceof Date)return new Date(f);const C=parseFloat(f);return C<0||C>=2958466?w:function(I){I<60&&(I+=1);const U=Math.floor(I-25569),ne=new Date(86400*U*1e3),ce=I-Math.floor(I)+1e-7;let Te=Math.floor(86400*ce);const ze=Te%60;Te-=ze;const lt=Math.floor(Te/3600),Et=Math.floor(Te/60)%60;let It=ne.getUTCDate(),Dt=ne.getUTCMonth();return I>=60&&I<61&&(It=29,Dt=1),new Date(ne.getUTCFullYear(),Dt,It,lt,Et,ze)}(C)}return typeof f!="string"||(f=/(\d{4})-(\d\d?)-(\d\d?)$/.test(f)?new Date(f+"T00:00:00.000"):new Date(f),isNaN(f))?E:f}function te(f){let C,I=f.length;for(;I--;){if(C=B(f[I]),C===E)return C;f[I]=C}return f}function V(f){return f instanceof Error?f:f==null?0:(typeof f=="boolean"&&(f=+f),isNaN(f)||f===""?E:parseFloat(f))}function ue(f){let C,I;if(!f||(C=f.length)===0)return E;for(;C--;){if(f[C]instanceof Error)return f[C];if(I=V(f[C]),I instanceof Error)return I;f[C]=I}return f}function Ae(f){return f instanceof Error?f:f==null?"":f.toString()}function Ve(){let f=arguments.length;for(;f--;)if(typeof arguments[f]=="string")return!0;return!1}function He(f){return f!=null}const be="=",qe=[">",">=","<","<=","=","<>"],le="operator",pe="literal",Se=[le,pe],Ye=le,Fe=pe;function je(f,C){if(Se.indexOf(C)===-1)throw new Error("Unsupported token type: "+C);return{value:f,type:C}}function rt(f){return function(C){let I="";const U=[];for(let ne=0;ne<C.length;ne++){const ce=C[ne];ne===0&&qe.indexOf(ce)>=0?U.push(je(ce,Ye)):I+=ce}return I.length>0&&U.push(je(function(ne){return typeof ne!="string"||/^\d+(\.\d+)?$/.test(ne)&&(ne=ne.indexOf(".")===-1?parseInt(ne,10):parseFloat(ne)),ne}(I),Fe)),U.length>0&&U[0].type!==Ye&&U.unshift(je(be,Ye)),U}(function(C){const I=C.length,U=[];let ne=0,ce="",Te="";for(;ne<I;){const ze=C.charAt(ne);switch(ze){case">":case"<":case"=":Te+=ze,ce.length>0&&(U.push(ce),ce="");break;default:Te.length>0&&(U.push(Te),Te=""),ce+=ze}ne++}return ce.length>0&&U.push(ce),Te.length>0&&U.push(Te),U}(f))}const Ue=function(f){const C=[];let I;for(let U=0;U<f.length;U++){const ne=f[U];switch(ne.type){case Ye:I=ne.value;break;case Fe:C.push(ne.value)}}return function(U,ne){let ce=!1;switch(ne){case">":ce=U[0]>U[1];break;case">=":ce=U[0]>=U[1];break;case"<":ce=U[0]<U[1];break;case"<=":ce=U[0]<=U[1];break;case"=":ce=U[0]==U[1];break;case"<>":ce=U[0]!=U[1]}return ce}(C,I)},Xe={};function et(f){return[E,_,m,w,S,v].indexOf(f)>=0||typeof f=="number"&&(isNaN(f)||!isFinite(f))}function Qe(f){return et(f)||f===A}function st(f){return f===!0||f===!1}function St(f){return typeof f=="number"&&!isNaN(f)&&isFinite(f)}function At(f){return typeof f=="string"}function j(){const f=[];for(let C=0;C<arguments.length;++C){let I=!1;const U=arguments[C];for(let ne=0;ne<f.length&&(I=f[ne]===U,!I);++ne);I||f.push(U)}return f}function X(f,C,I,U){if(!C||!I)return A;U=!(U===0||U===!1);let ne=A;const ce=typeof f=="number";let Te=!1;for(let ze=0;ze<C.length;ze++){const lt=C[ze];if(lt[0]===f){ne=I<lt.length+1?lt[I-1]:_;break}!Te&&(ce&&U&&lt[0]<=f||U&&typeof lt[0]=="string"&&lt[0].localeCompare(f)<0)&&(ne=I<lt.length+1?lt[I-1]:_),ce&&lt[0]>f&&(Te=!0)}return ne}function P(){const f=re(arguments).filter(He);if(f.length===0)return m;const C=Ie.apply(void 0,f);if(C)return C;const I=at(f),U=I.length;let ne,ce=0,Te=0;for(let ze=0;ze<U;ze++)ce+=I[ze],Te+=1;return ne=ce/Te,isNaN(ne)&&(ne=w),ne}function R(){const f=re(arguments).filter(He);if(f.length===0)return m;const C=Ie.apply(void 0,f);if(C)return C;const I=f,U=I.length;let ne,ce=0,Te=0;for(let ze=0;ze<U;ze++){const lt=I[ze];typeof lt=="number"&&(ce+=lt),lt===!0&&ce++,lt!==null&&Te++}return ne=ce/Te,isNaN(ne)&&(ne=w),ne}Xe.TYPE=f=>{switch(f){case v:return 1;case m:return 2;case E:return 3;case _:return 4;case S:return 5;case w:return 6;case A:return 7;case D:return 8}return A};const ae={DIST:function(f,C,I,U,ne,ce){return arguments.length<4?E:(ne=ne===void 0?0:ne,ce=ce===void 0?1:ce,we(f=V(f),C=V(C),I=V(I),ne=V(ne),ce=V(ce))?E:(f=(f-ne)/(ce-ne),U?h.beta.cdf(f,C,I):h.beta.pdf(f,C,I)))},INV:(f,C,I,U,ne)=>(U=U===void 0?0:U,ne=ne===void 0?1:ne,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne))?E:h.beta.inv(f,C,I)*(ne-U)+U)},Pe={DIST:(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I),U=V(U))?E:U?h.binomial.cdf(f,C,I):h.binomial.pdf(f,C,I)};Pe.DIST.RANGE=(f,C,I,U)=>{if(U=U===void 0?I:U,we(f=V(f),C=V(C),I=V(I),U=V(U)))return E;let ne=0;for(let ce=I;ce<=U;ce++)ne+=dt(f,ce)*Math.pow(C,ce)*Math.pow(1-C,f-ce);return ne},Pe.INV=(f,C,I)=>{if(we(f=V(f),C=V(C),I=V(I)))return E;let U=0;for(;U<=f;){if(h.binomial.cdf(U,f,C)>=I)return U;U++}};const Oe={DIST:(f,C,I)=>we(f=V(f),C=V(C))?E:I?h.chisquare.cdf(f,C):h.chisquare.pdf(f,C)};Oe.DIST.RT=(f,C)=>!f|!C?A:f<1||C>Math.pow(10,10)?w:typeof f!="number"||typeof C!="number"?E:1-h.chisquare.cdf(f,C),Oe.INV=(f,C)=>we(f=V(f),C=V(C))?E:h.chisquare.inv(f,C),Oe.INV.RT=(f,C)=>!f|!C?A:f<0||f>1||C<1||C>Math.pow(10,10)?w:typeof f!="number"||typeof C!="number"?E:h.chisquare.inv(1-f,C),Oe.TEST=function(f,C){if(arguments.length!==2)return A;if(!(f instanceof Array&&C instanceof Array)||f.length!==C.length||f[0]&&C[0]&&f[0].length!==C[0].length)return E;const I=f.length;let U,ne,ce;for(ne=0;ne<I;ne++)f[ne]instanceof Array||(U=f[ne],f[ne]=[],f[ne].push(U)),C[ne]instanceof Array||(U=C[ne],C[ne]=[],C[ne].push(U));const Te=f[0].length,ze=Te===1?I-1:(I-1)*(Te-1);let lt=0;const Et=Math.PI;for(ne=0;ne<I;ne++)for(ce=0;ce<Te;ce++)lt+=Math.pow(f[ne][ce]-C[ne][ce],2)/C[ne][ce];return Math.round(1e6*function(It,Dt){let xt=Math.exp(-.5*It);Dt%2==1&&(xt*=Math.sqrt(2*It/Et));let Vt=Dt;for(;Vt>=2;)xt=xt*It/Vt,Vt-=2;let jt=xt,zt=Dt;for(;jt>1e-10*xt;)zt+=2,jt=jt*It/zt,xt+=jt;return 1-xt}(lt,ze))/1e6};const oe={};function ee(){return at(re(arguments)).length}function fe(){const f=re(arguments);return f.length-Re(f)}function Re(){const f=re(arguments);let C,I=0;for(let U=0;U<f.length;U++)C=f[U],C!=null&&C!==""||I++;return I}oe.NORM=(f,C,I)=>we(f=V(f),C=V(C),I=V(I))?E:h.normalci(1,f,C,I)[1]-1,oe.T=(f,C,I)=>we(f=V(f),C=V(C),I=V(I))?E:h.tci(1,f,C,I)[1]-1;const $e={P:(f,C)=>{if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=h.mean(f),U=h.mean(C);let ne=0;const ce=f.length;for(let Te=0;Te<ce;Te++)ne+=(f[Te]-I)*(C[Te]-U);return ne/ce},S:(f,C)=>we(f=ue(re(f)),C=ue(re(C)))?E:h.covariance(f,C)},Je={DIST:(f,C,I)=>we(f=V(f),C=V(C))?E:I?h.exponential.cdf(f,C):h.exponential.pdf(f,C)},Be={};function ot(f,C,I){if(we(f=V(f),C=ue(re(C)),I=ue(re(I))))return E;const U=h.mean(I),ne=h.mean(C),ce=I.length;let Te=0,ze=0;for(let Et=0;Et<ce;Et++)Te+=(I[Et]-U)*(C[Et]-ne),ze+=Math.pow(I[Et]-U,2);const lt=Te/ze;return ne-lt*U+lt*f}function gt(f){return(f=V(f))instanceof Error?f:f===0||parseInt(f,10)===f&&f<0?w:h.gammafn(f)}function b(f){return(f=V(f))instanceof Error?f:h.gammaln(f)}Be.DIST=(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I))?E:U?h.centralF.cdf(f,C,I):h.centralF.pdf(f,C,I),Be.DIST.RT=function(f,C,I){return arguments.length!==3?A:f<0||C<1||I<1?w:typeof f!="number"||typeof C!="number"||typeof I!="number"?E:1-h.centralF.cdf(f,C,I)},Be.INV=(f,C,I)=>we(f=V(f),C=V(C),I=V(I))?E:f<=0||f>1?w:h.centralF.inv(f,C,I),Be.INV.RT=function(f,C,I){return arguments.length!==3?A:f<0||f>1||C<1||C>Math.pow(10,10)||I<1||I>Math.pow(10,10)?w:typeof f!="number"||typeof C!="number"||typeof I!="number"?E:h.centralF.inv(1-f,C,I)},Be.TEST=(f,C)=>{if(!f||!C||!(f instanceof Array&&C instanceof Array))return A;if(f.length<2||C.length<2)return m;const I=(ce,Te)=>{let ze=0;for(let lt=0;lt<ce.length;lt++)ze+=Math.pow(ce[lt]-Te,2);return ze},U=Qt(f)/f.length,ne=Qt(C)/C.length;return I(f,U)/(f.length-1)/(I(C,ne)/(C.length-1))},gt.DIST=function(f,C,I,U){return arguments.length!==4?A:f<0||C<=0||I<=0||typeof f!="number"||typeof C!="number"||typeof I!="number"?E:U?h.gamma.cdf(f,C,I,!0):h.gamma.pdf(f,C,I,!1)},gt.INV=function(f,C,I){return arguments.length!==3?A:f<0||f>1||C<=0||I<=0?w:typeof f!="number"||typeof C!="number"||typeof I!="number"?E:h.gamma.inv(f,C,I)},b.PRECISE=function(f){return arguments.length!==1?A:f<=0?w:typeof f!="number"?E:h.gammaln(f)};const q={};function F(f,C){return we(f=ue(re(f)),C=V(C))?f:C<0||f.length<C?E:f.sort((I,U)=>U-I)[C-1]}function W(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=h.mean(f),U=h.mean(C),ne=C.length;let ce=0,Te=0;for(let lt=0;lt<ne;lt++)ce+=(C[lt]-U)*(f[lt]-I),Te+=Math.pow(C[lt]-U,2);const ze=ce/Te;return[ze,I-ze*U]}q.DIST=(f,C,I,U,ne)=>{if(we(f=V(f),C=V(C),I=V(I),U=V(U)))return E;function ce(Te,ze,lt,Et){return dt(lt,Te)*dt(Et-lt,ze-Te)/dt(Et,ze)}return ne?function(Te,ze,lt,Et){let It=0;for(let Dt=0;Dt<=Te;Dt++)It+=ce(Dt,ze,lt,Et);return It}(f,C,I,U):ce(f,C,I,U)};const z={};function ie(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;const I=at(f);return I.length===0?0:Math.max.apply(Math,I)}function _e(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;const I=K(f);let U=h.median(I);return isNaN(U)&&(U=w),U}function J(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;const I=at(f);return I.length===0?0:Math.min.apply(Math,I)}z.DIST=(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I))?E:U?h.lognormal.cdf(f,C,I):h.lognormal.pdf(f,C,I),z.INV=(f,C,I)=>we(f=V(f),C=V(C),I=V(I))?E:h.lognormal.inv(f,C,I);const me={MULT:function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=f.length,I={};let U,ne=[],ce=0;for(let Te=0;Te<C;Te++)U=f[Te],I[U]=I[U]?I[U]+1:1,I[U]>ce&&(ce=I[U],ne=[]),I[U]===ce&&(ne[ne.length]=U);return ne},SNGL:function(){const f=ue(re(arguments));return f instanceof Error?f:me.MULT(f).sort((C,I)=>C-I)[0]}},L={DIST:(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I))?E:U?h.negbin.cdf(f,C,I):h.negbin.pdf(f,C,I)},Z={};function de(f,C){if(we(C=ue(re(C)),f=ue(re(f))))return E;const I=h.mean(f),U=h.mean(C),ne=f.length;let ce=0,Te=0,ze=0;for(let lt=0;lt<ne;lt++)ce+=(f[lt]-I)*(C[lt]-U),Te+=Math.pow(f[lt]-I,2),ze+=Math.pow(C[lt]-U,2);return ce/Math.sqrt(Te*ze)}Z.DIST=(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I))?E:I<=0?w:U?h.normal.cdf(f,C,I):h.normal.pdf(f,C,I),Z.INV=(f,C,I)=>we(f=V(f),C=V(C),I=V(I))?E:h.normal.inv(f,C,I),Z.S={},Z.S.DIST=(f,C)=>(f=V(f))instanceof Error?E:C?h.normal.cdf(f,0,1):h.normal.pdf(f,0,1),Z.S.INV=f=>(f=V(f))instanceof Error?E:h.normal.inv(f,0,1);const Ee={EXC:(f,C)=>{if(we(f=ue(re(f)),C=V(C)))return E;const I=(f=f.sort((ce,Te)=>ce-Te)).length;if(C<1/(I+1)||C>1-1/(I+1))return w;const U=C*(I+1)-1,ne=Math.floor(U);return Ne(U===ne?f[U]:f[ne]+(U-ne)*(f[ne+1]-f[ne]))},INC:(f,C)=>{if(we(f=ue(re(f)),C=V(C)))return E;const I=C*((f=f.sort((ne,ce)=>ne-ce)).length-1),U=Math.floor(I);return Ne(I===U?f[I]:f[U]+(I-U)*(f[U+1]-f[U]))}},ye={EXC:(f,C,I)=>{if(I=I===void 0?3:I,we(f=ue(re(f)),C=V(C),I=V(I)))return E;f=f.sort((It,Dt)=>It-Dt);const U=j.apply(null,f),ne=f.length,ce=U.length,Te=Math.pow(10,I);let ze=0,lt=!1,Et=0;for(;!lt&&Et<ce;)C===U[Et]?(ze=(f.indexOf(U[Et])+1)/(ne+1),lt=!0):C>=U[Et]&&(C<U[Et+1]||Et===ce-1)&&(ze=(f.indexOf(U[Et])+1+(C-U[Et])/(U[Et+1]-U[Et]))/(ne+1),lt=!0),Et++;return Math.floor(ze*Te)/Te},INC:(f,C,I)=>{if(I=I===void 0?3:I,we(f=ue(re(f)),C=V(C),I=V(I)))return E;f=f.sort((It,Dt)=>It-Dt);const U=j.apply(null,f),ne=f.length,ce=U.length,Te=Math.pow(10,I);let ze=0,lt=!1,Et=0;for(;!lt&&Et<ce;)C===U[Et]?(ze=f.indexOf(U[Et])/(ne-1),lt=!0):C>=U[Et]&&(C<U[Et+1]||Et===ce-1)&&(ze=(f.indexOf(U[Et])+(C-U[Et])/(U[Et+1]-U[Et]))/(ne-1),lt=!0),Et++;return Math.floor(ze*Te)/Te}},Ge={DIST:(f,C,I)=>we(f=V(f),C=V(C))?E:I?h.poisson.cdf(f,C):h.poisson.pdf(f,C)},tt={EXC:(f,C)=>{if(we(f=ue(re(f)),C=V(C)))return E;switch(C){case 1:return Ee.EXC(f,.25);case 2:return Ee.EXC(f,.5);case 3:return Ee.EXC(f,.75);default:return w}},INC:(f,C)=>{if(we(f=ue(re(f)),C=V(C)))return E;switch(C){case 1:return Ee.INC(f,.25);case 2:return Ee.INC(f,.5);case 3:return Ee.INC(f,.75);default:return w}}},ft={};function We(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=h.mean(f),I=f.length;let U=0;for(let ne=0;ne<I;ne++)U+=Math.pow(f[ne]-C,3);return I*U/((I-1)*(I-2)*Math.pow(h.stdev(f,!0),3))}function yt(f,C){return we(f=ue(re(f)),C=V(C))?f:f.sort((I,U)=>I-U)[C-1]}ft.AVG=(f,C,I)=>{if(we(f=V(f),C=ue(re(C))))return E;const U=(I=I||!1)?(Te,ze)=>Te-ze:(Te,ze)=>ze-Te,ne=(C=(C=re(C)).sort(U)).length;let ce=0;for(let Te=0;Te<ne;Te++)C[Te]===f&&ce++;return ce>1?(2*C.indexOf(f)+ce+1)/2:C.indexOf(f)+1},ft.EQ=(f,C,I)=>{if(we(f=V(f),C=ue(re(C))))return E;const U=(I=I||!1)?(ne,ce)=>ne-ce:(ne,ce)=>ce-ne;return(C=C.sort(U)).indexOf(f)+1},We.P=function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=h.mean(f),I=f.length;let U=0,ne=0;for(let ce=0;ce<I;ce++)ne+=Math.pow(f[ce]-C,3),U+=Math.pow(f[ce]-C,2);return ne/=I,U/=I,ne/Math.pow(U,1.5)};const Ct={P:function(){const f=De.P.apply(this,arguments);let C=Math.sqrt(f);return isNaN(C)&&(C=w),C},S:function(){const f=De.S.apply(this,arguments);return Math.sqrt(f)}},Mt={DIST:(f,C,I)=>I!==1&&I!==2?w:I===1?Mt.DIST.RT(f,C):Mt.DIST["2T"](f,C)};Mt.DIST["2T"]=function(f,C){return arguments.length!==2?A:f<0||C<1?w:typeof f!="number"||typeof C!="number"?E:2*(1-h.studentt.cdf(f,C))},Mt.DIST.RT=function(f,C){return arguments.length!==2?A:f<0||C<1?w:typeof f!="number"||typeof C!="number"?E:1-h.studentt.cdf(f,C)},Mt.INV=(f,C)=>we(f=V(f),C=V(C))?E:h.studentt.inv(f,C),Mt.INV["2T"]=(f,C)=>(f=V(f),C=V(C),f<=0||f>1||C<1?w:we(f,C)?E:Math.abs(h.studentt.inv(f/2,C))),Mt.TEST=(f,C)=>{if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=h.mean(f),U=h.mean(C);let ne,ce=0,Te=0;for(ne=0;ne<f.length;ne++)ce+=Math.pow(f[ne]-I,2);for(ne=0;ne<C.length;ne++)Te+=Math.pow(C[ne]-U,2);ce/=f.length-1,Te/=C.length-1;const ze=Math.abs(I-U)/Math.sqrt(ce/f.length+Te/C.length);return Mt.DIST["2T"](ze,f.length+C.length-2)};const De={};function ht(){const f=re(arguments),C=f.length;let I=0,U=0;const ne=R(f);for(let ce=0;ce<C;ce++){const Te=f[ce];I+=Math.pow(typeof Te=="number"?Te-ne:Te===!0?1-ne:0-ne,2),Te!==null&&U++}return I/(U-1)}function mt(){const f=re(arguments),C=f.length;let I=0,U=0;const ne=R(f);let ce;for(let Te=0;Te<C;Te++){const ze=f[Te];I+=Math.pow(typeof ze=="number"?ze-ne:ze===!0?1-ne:0-ne,2),ze!==null&&U++}return ce=I/U,isNaN(ce)&&(ce=w),ce}De.P=function(){const f=at(re(arguments)),C=f.length;let I=0;const U=P(f);let ne;for(let ce=0;ce<C;ce++)I+=Math.pow(f[ce]-U,2);return ne=I/C,isNaN(ne)&&(ne=w),ne},De.S=function(){const f=at(re(arguments)),C=f.length;let I=0;const U=P(f);for(let ne=0;ne<C;ne++)I+=Math.pow(f[ne]-U,2);return I/(C-1)};const Nt={DIST:(f,C,I,U)=>we(f=V(f),C=V(C),I=V(I))?E:U?1-Math.exp(-Math.pow(f/I,C)):Math.pow(f,C-1)*Math.exp(-Math.pow(f/I,C))*C/Math.pow(I,C)},pt={};function Me(f,C,I){const U=Ie(f=V(f),C=V(C),I=V(I));if(U)return U;if(C===0)return 0;C=Math.abs(C);const ne=-Math.floor(Math.log(C)/Math.log(10));return f>=0?ur(Math.ceil(f/C)*C,ne):I===0?-ur(Math.floor(Math.abs(f)/C)*C,ne):-ur(Math.ceil(Math.abs(f)/C)*C,ne)}function dt(f,C){return Ie(f=V(f),C=V(C))||(f<C?w:Ot(f)/(Ot(C)*Ot(f-C)))}pt.TEST=(f,C,I)=>{if(we(f=ue(re(f)),C=V(C)))return E;I=I||Ct.S(f);const U=f.length;return 1-Z.S.DIST((P(f)-C)/(I/Math.sqrt(U)),!0)},Me.MATH=Me,Me.PRECISE=Me;const wt=[];function Ot(f){if((f=V(f))instanceof Error)return f;const C=Math.floor(f);return C===0||C===1?1:(wt[C]>0||(wt[C]=Ot(C-1)*C),wt[C])}function Bt(f,C){const I=Ie(f=V(f),C=V(C));if(I)return I;if(C===0)return 0;if(!(f>=0&&C>0||f<=0&&C<0))return w;C=Math.abs(C);const U=-Math.floor(Math.log(C)/Math.log(10));return f>=0?ur(Math.floor(f/C)*C,U):-ur(Math.ceil(Math.abs(f)/C),U)}Bt.MATH=(f,C,I)=>{if(C instanceof Error)return C;C=C===void 0?0:C;const U=Ie(f=V(f),C=V(C),I=V(I));if(U)return U;if(C===0)return 0;C=C?Math.abs(C):1;const ne=-Math.floor(Math.log(C)/Math.log(10));return f>=0?ur(Math.floor(f/C)*C,ne):I===0||I===void 0?-ur(Math.ceil(Math.abs(f)/C)*C,ne):-ur(Math.floor(Math.abs(f)/C)*C,ne)},Bt.PRECISE=Bt.MATH;const bt={CEILING:Me};function lr(f,C){const I=Ie(f=V(f),C=V(C));if(I)return I;if(f===0&&C===0)return w;const U=Math.pow(f,C);return isNaN(U)?w:U}function fr(){const f=re(arguments).filter(U=>U!=null);if(f.length===0)return 0;const C=ue(f);if(C instanceof Error)return C;let I=1;for(let U=0;U<C.length;U++)I*=C[U];return I}function ur(f,C){return Ie(f=V(f),C=V(C))||+(Math.round(+(f+"e"+C))+"e"+-1*C)}function Qt(){let f=0;return k(H(arguments),C=>{if(f instanceof Error)return!1;if(C instanceof Error)f=C;else if(typeof C=="number")f+=C;else if(typeof C=="string"){const I=parseFloat(C);!isNaN(I)&&(f+=I)}else if(Array.isArray(C)){const I=Qt.apply(null,C);I instanceof Error?f=I:f+=I}}),f}var ci=Object.freeze({__proto__:null,ADD:function(f,C){return arguments.length!==2?A:Ie(f=V(f),C=V(C))||f+C},DIVIDE:function(f,C){return arguments.length!==2?A:Ie(f=V(f),C=V(C))||(C===0?m:f/C)},EQ:function(f,C){return arguments.length!==2?A:f instanceof Error?f:C instanceof Error?C:(f===null&&(f=void 0),C===null&&(C=void 0),f===C)},GT:function(f,C){return arguments.length!==2?A:f instanceof Error?f:C instanceof Error?C:(Ve(f,C)?(f=Ae(f),C=Ae(C)):(f=V(f),C=V(C)),Ie(f,C)||f>C)},GTE:function(f,C){return arguments.length!==2?A:(Ve(f,C)?(f=Ae(f),C=Ae(C)):(f=V(f),C=V(C)),Ie(f,C)||f>=C)},LT:function(f,C){return arguments.length!==2?A:(Ve(f,C)?(f=Ae(f),C=Ae(C)):(f=V(f),C=V(C)),Ie(f,C)||f<C)},LTE:function(f,C){return arguments.length!==2?A:(Ve(f,C)?(f=Ae(f),C=Ae(C)):(f=V(f),C=V(C)),Ie(f,C)||f<=C)},MINUS:function(f,C){return arguments.length!==2?A:Ie(f=V(f),C=V(C))||f-C},MULTIPLY:function(f,C){return arguments.length!==2?A:Ie(f=V(f),C=V(C))||f*C},NE:function(f,C){return arguments.length!==2?A:f instanceof Error?f:C instanceof Error?C:(f===null&&(f=void 0),C===null&&(C=void 0),f!==C)},POW:function(f,C){return arguments.length!==2?A:lr(f,C)}});const Vn=new Date(Date.UTC(1900,0,1)),di=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Ur=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],hi=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Er(f,C,I){I=I.toUpperCase(),f=B(f),C=B(C);const U=f.getFullYear(),ne=f.getMonth(),ce=f.getDate(),Te=C.getFullYear(),ze=C.getMonth(),lt=C.getDate();let Et;switch(I){case"Y":Et=Math.floor(qi(f,C));break;case"D":Et=hn(C,f);break;case"M":Et=ze-ne+12*(Te-U),lt<ce&&Et--;break;case"MD":ce<=lt?Et=lt-ce:(ze===0?(f.setFullYear(Te-1),f.setMonth(12)):(f.setFullYear(Te),f.setMonth(ze-1)),Et=hn(C,f));break;case"YM":Et=ze-ne+12*(Te-U),lt<ce&&Et--,Et%=12;break;case"YD":ze>ne||ze===ne&&lt<ce?f.setFullYear(Te):f.setFullYear(Te-1),Et=hn(C,f)}return Et}function fi(f){const C=new Date(f);return C.setHours(0,0,0,0),C}function hn(f,C){return f=B(f),C=B(C),f instanceof Error?f:C instanceof Error?C:mi(fi(f))-mi(fi(C))}function tn(f,C,I){if(I=nt(I||"false"),f=B(f),C=B(C),f instanceof Error)return f;if(C instanceof Error)return C;if(I instanceof Error)return I;const U=f.getMonth();let ne,ce,Te=C.getMonth();if(I)ne=f.getDate()===31?30:f.getDate(),ce=C.getDate()===31?30:C.getDate();else{const ze=new Date(f.getFullYear(),U+1,0).getDate(),lt=new Date(C.getFullYear(),Te+1,0).getDate();ne=f.getDate()===ze?30:f.getDate(),C.getDate()===lt?ne<30?(Te++,ce=1):ce=30:ce=C.getDate()}return 360*(C.getFullYear()-f.getFullYear())+30*(Te-U)+(ce-ne)}function Gn(f){if((f=B(f))instanceof Error)return f;(f=fi(f)).setDate(f.getDate()+4-(f.getDay()||7));const C=new Date(f.getFullYear(),0,1);return Math.ceil(((f-C)/864e5+1)/7)}function fn(f,C,I){return fn.INTL(f,C,1,I)}function rn(f,C,I){return rn.INTL(f,C,1,I)}function Sn(f){return new Date(f,1,29).getMonth()===1}function pi(f,C){return Math.ceil((C-f)/1e3/60/60/24)}function qi(f,C,I){if((f=B(f))instanceof Error)return f;if((C=B(C))instanceof Error)return C;I=I||0;let U=f.getDate();const ne=f.getMonth()+1,ce=f.getFullYear();let Te=C.getDate();const ze=C.getMonth()+1,lt=C.getFullYear();switch(I){case 0:return U===31&&Te===31?(U=30,Te=30):U===31?U=30:U===30&&Te===31&&(Te=30),(Te+30*ze+360*lt-(U+30*ne+360*ce))/360;case 1:{const Et=(Vt,jt)=>{const zt=Vt.getFullYear(),_r=new Date(zt,2,1);if(Sn(zt)&&Vt<_r&&jt>=_r)return!0;const tr=jt.getFullYear(),on=new Date(tr,2,1);return Sn(tr)&&jt>=on&&Vt<on};let It=365;if(ce===lt||ce+1===lt&&(ne>ze||ne===ze&&U>=Te))return(ce===lt&&Sn(ce)||Et(f,C)||ze===1&&Te===29)&&(It=366),pi(f,C)/It;const Dt=lt-ce+1,xt=(new Date(lt+1,0,1)-new Date(ce,0,1))/1e3/60/60/24/Dt;return pi(f,C)/xt}case 2:return pi(f,C)/360;case 3:return pi(f,C)/365;case 4:return(Te+30*ze+360*lt-(U+30*ne+360*ce))/360}}function mi(f){const C=f>-22038912e5?2:1;return Math.ceil((f-Vn)/864e5)+C}function Ki(f){return(f=V(f))===0?E:f instanceof Error?f:String.fromCharCode(f)}function gi(f){if(we(f))return f;let C=(f=f||"").charCodeAt(0);return isNaN(C)&&(C=E),C}function Tn(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;let I=0;for(;(I=f.indexOf(!0))>-1;)f[I]="TRUE";let U=0;for(;(U=f.indexOf(!1))>-1;)f[U]="FALSE";return f.join("")}fn.INTL=(f,C,I,U)=>{if((f=B(f))instanceof Error)return f;if((C=B(C))instanceof Error)return C;let ne=!1;const ce=[],Te=[1,2,3,4,5,6,0],ze=new RegExp("^[0|1]{7}$");if(I===void 0)I=hi[1];else if(typeof I=="string"&&ze.test(I)){ne=!0,I=I.split("");for(let Dt=0;Dt<I.length;Dt++)I[Dt]==="1"&&ce.push(Te[Dt])}else I=hi[I];if(!(I instanceof Array))return E;U===void 0?U=[]:U instanceof Array||(U=[U]);for(let Dt=0;Dt<U.length;Dt++){const xt=B(U[Dt]);if(xt instanceof Error)return xt;U[Dt]=xt}const lt=Math.round((C-f)/864e5)+1;let Et=lt;const It=f;for(let Dt=0;Dt<lt;Dt++){const xt=new Date().getTimezoneOffset()>0?It.getUTCDay():It.getDay();let Vt=ne?ce.includes(xt):xt===I[0]||xt===I[1];for(let jt=0;jt<U.length;jt++){const zt=U[jt];if(zt.getDate()===It.getDate()&&zt.getMonth()===It.getMonth()&&zt.getFullYear()===It.getFullYear()){Vt=!0;break}}Vt&&Et--,It.setDate(It.getDate()+1)}return Et},rn.INTL=(f,C,I,U)=>{if((f=B(f))instanceof Error)return f;if((C=V(C))instanceof Error)return C;if(C<0)return w;if(!((I=I===void 0?hi[1]:hi[I])instanceof Array))return E;U===void 0?U=[]:U instanceof Array||(U=[U]);for(let ce=0;ce<U.length;ce++){const Te=B(U[ce]);if(Te instanceof Error)return Te;U[ce]=Te}let ne=0;for(;ne<C;){f.setDate(f.getDate()+1);const ce=f.getDay();if(ce!==I[0]&&ce!==I[1]){for(let Te=0;Te<U.length;Te++){const ze=U[Te];if(ze.getDate()===f.getDate()&&ze.getMonth()===f.getMonth()&&ze.getFullYear()===f.getFullYear()){ne--;break}}ne++}}return f};const xo=Tn;function yi(f,C=2,I=!1){if(f=V(f),isNaN(f)||(C=V(C),isNaN(C)))return E;if(C<0){const U=Math.pow(10,-C);f=Math.round(f/U)*U}else f=f.toFixed(C);if(I)f=f.toString().replace(/,/g,"");else{const U=f.toString().split(".");U[0]=U[0].replace(/\B(?=(\d{3})+$)/g,","),f=U.join(".")}return f}function Wt(f,C){return Ie(f,C)||(f=Ae(f),(C=V(C))instanceof Error?C:new Array(C+1).join(f))}const Ns=Ki,Is=gi;function Wn(f){return/^[01]{1,10}$/.test(f)}function cr(f,C,I){if(we(f=V(f),C=V(C)))return f;if((I=I===void 0?"i":I)!=="i"&&I!=="j")return E;if(f===0&&C===0)return 0;if(f===0)return C===1?I:C.toString()+I;if(C===0)return f.toString();{const U=C>0?"+":"";return f.toString()+U+(C===1?I:C.toString()+I)}}function Ei(f,C){return C=C===void 0?0:C,we(f=V(f),C=V(C))?E:h.erf(f)}function Ci(f){return isNaN(f)?E:h.erfc(f)}function jn(f){const C=Yt(f),I=qt(f);return we(C,I)?E:Math.sqrt(Math.pow(C,2)+Math.pow(I,2))}function qt(f){if(f===void 0||f===!0||f===!1)return E;if(f===0||f==="0")return 0;if(["i","j"].indexOf(f)>=0)return 1;let C=(f=(f+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),I=f.indexOf("-");C===0&&(C=f.indexOf("+",1)),I===0&&(I=f.indexOf("-",1));const U=f.substring(f.length-1,f.length),ne=U==="i"||U==="j";return C>=0||I>=0?ne?C>=0?isNaN(f.substring(0,C))||isNaN(f.substring(C+1,f.length-1))?w:Number(f.substring(C+1,f.length-1)):isNaN(f.substring(0,I))||isNaN(f.substring(I+1,f.length-1))?w:-Number(f.substring(I+1,f.length-1)):w:ne?isNaN(f.substring(0,f.length-1))?w:f.substring(0,f.length-1):isNaN(f)?w:0}function Br(f){const C=Yt(f),I=qt(f);return we(C,I)?E:C===0&&I===0?m:C===0&&I>0?Math.PI/2:C===0&&I<0?-Math.PI/2:I===0&&C>0?0:I===0&&C<0?-Math.PI:C>0?Math.atan(I/C):C<0&&I>=0?Math.atan(I/C)+Math.PI:Math.atan(I/C)-Math.PI}function Fr(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.cos(C)*(Math.exp(I)+Math.exp(-I))/2,-Math.sin(C)*(Math.exp(I)-Math.exp(-I))/2,U)}function qr(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.cos(I)*(Math.exp(C)+Math.exp(-C))/2,Math.sin(I)*(Math.exp(C)-Math.exp(-C))/2,U)}function Lr(f,C){const I=Yt(f),U=qt(f),ne=Yt(C),ce=qt(C);if(we(I,U,ne,ce))return E;const Te=f.substring(f.length-1),ze=C.substring(C.length-1);let lt="i";if((Te==="j"||ze==="j")&&(lt="j"),ne===0&&ce===0)return w;const Et=ne*ne+ce*ce;return cr((I*ne+U*ce)/Et,(U*ne-I*ce)/Et,lt)}function Yt(f){if(f===void 0||f===!0||f===!1)return E;if(f===0||f==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(f)>=0)return 0;let C=(f+="").indexOf("+"),I=f.indexOf("-");C===0&&(C=f.indexOf("+",1)),I===0&&(I=f.indexOf("-",1));const U=f.substring(f.length-1,f.length),ne=U==="i"||U==="j";return C>=0||I>=0?ne?C>=0?isNaN(f.substring(0,C))||isNaN(f.substring(C+1,f.length-1))?w:Number(f.substring(0,C)):isNaN(f.substring(0,I))||isNaN(f.substring(I+1,f.length-1))?w:Number(f.substring(0,I)):w:ne?isNaN(f.substring(0,f.length-1))?w:0:isNaN(f)?w:f}function $r(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.sin(C)*(Math.exp(I)+Math.exp(-I))/2,Math.cos(C)*(Math.exp(I)-Math.exp(-I))/2,U)}function Ps(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.cos(I)*(Math.exp(C)-Math.exp(-C))/2,Math.sin(I)*(Math.exp(C)+Math.exp(-C))/2,U)}Ei.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Ci.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Os=ae.DIST,Yn=ae.INV,Fo=Pe.DIST,Ms=Me.MATH,vi=Me.PRECISE,xs=Oe.DIST,Lo=Oe.DIST.RT,zn=Oe.INV,qn=Oe.INV.RT,wn=Oe.TEST,_i=$e.P,$o=$e.P,Do=$e.S,Xi=Pe.INV,Si=Ci.PRECISE,Qi=Ei.PRECISE,Fs=Je.DIST,nn=Be.DIST,Zi=Be.DIST.RT,Ti=Be.INV,Ls=Be.INV.RT,wi=Bt.MATH,Ri=Bt.PRECISE,$s=Be.TEST,Ar=gt.DIST,Rn=gt.INV,Ji=b.PRECISE,Kn=q.DIST,ko=z.INV,es=z.DIST,ts=z.INV,Xn=me.MULT,Ai=me.SNGL,Ds=L.DIST,Ho=fn.INTL,Uo=Z.DIST,Bo=Z.INV,rs=Z.S.DIST,Vo=Z.S.INV,Go=Ee.EXC,Wo=Ee.INC,jo=ye.EXC,Yo=ye.INC,ks=Ge.DIST,zo=tt.EXC,qo=tt.INC,Ko=ft.AVG,Xo=ft.EQ,ns=We.P,Qo=Ct.P,Zo=Ct.S,Jo=Mt.DIST,Hs=Mt.DIST.RT,ea=Mt.INV,ta=Mt.TEST,ra=De.P,na=De.S,ia=Nt.DIST,sa=rn.INTL,oa=pt.TEST;function Qn(f){const C=[];return k(f,I=>{I&&C.push(I)}),C}function pr(f,C){const I={};for(let ce=1;ce<f[0].length;++ce)I[ce]=!0;let U=C[0].length;for(let ce=1;ce<C.length;++ce)C[ce].length>U&&(U=C[ce].length);for(let ce=1;ce<f.length;++ce)for(let Te=1;Te<f[ce].length;++Te){let ze=!1,lt=!1;for(let Et=0;Et<C.length;++Et){const It=C[Et];if(It.length<U)continue;const Dt=It[0];if(f[ce][0]===Dt){lt=!0;for(let xt=1;xt<It.length;++xt)if(!ze)if(It[xt]===void 0||It[xt]==="*")ze=!0;else{const Vt=rt(It[xt]+""),jt=[je(f[ce][Te],Fe)].concat(Vt);ze=Ue(jt)}}}lt&&(I[Te]=I[Te]&&ze)}const ne=[];for(let ce=0;ce<f[0].length;++ce)I[ce]&&ne.push(ce-1);return ne}function is(f){return f&&f.getTime&&!isNaN(f.getTime())}function bi(f){return f instanceof Date?f:new Date(f)}function sn(f,C,I,U,ne){if(U=U||0,ne=ne||0,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne)))return E;let ce;if(f===0)ce=U+I*C;else{const Te=Math.pow(1+f,C);ce=ne===1?U*Te+I*(1+f)*(Te-1)/f:U*Te+I*(Te-1)/f}return-ce}function ss(f,C,I,U,ne,ce){if(ne=ne||0,ce=ce||0,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne),ce=V(ce)))return E;const Te=An(f,I,U,ne,ce);return(C===1?ce===1?0:-U:ce===1?sn(f,C-2,Te,U,1)-Te:sn(f,C-1,Te,U,0))*f}function Ni(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=f[0];let I=0;for(let U=1;U<f.length;U++)I+=f[U]/Math.pow(1+C,U);return I}function An(f,C,I,U,ne){if(U=U||0,ne=ne||0,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne)))return E;let ce;if(f===0)ce=(I+U)/C;else{const Te=Math.pow(1+f,C);ce=ne===1?(U*f/(Te-1)+I*f/(1-1/Te))/(1+f):U*f/(Te-1)+I*f/(1-1/Te)}return-ce}const bn={errors:Y,symbols:ci};u.ABS=function(f){return(f=V(f))instanceof Error?f:Math.abs(f)},u.ACCRINT=function(f,C,I,U,ne,ce,Te){return f=bi(f),C=bi(C),I=bi(I),is(f)&&is(C)&&is(I)?U<=0||ne<=0||[1,2,4].indexOf(ce)===-1||[0,1,2,3,4].indexOf(Te)===-1||I<=f?w:(ne=ne||0)*U*qi(f,I,Te=Te||0):E},u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},u.ACOS=function(f){if((f=V(f))instanceof Error)return f;let C=Math.acos(f);return isNaN(C)&&(C=w),C},u.ACOSH=function(f){if((f=V(f))instanceof Error)return f;let C=Math.log(f+Math.sqrt(f*f-1));return isNaN(C)&&(C=w),C},u.ACOT=function(f){return(f=V(f))instanceof Error?f:Math.atan(1/f)},u.ACOTH=function(f){if((f=V(f))instanceof Error)return f;let C=.5*Math.log((f+1)/(f-1));return isNaN(C)&&(C=w),C},u.AGGREGATE=function(f,C,I,U){if(we(f=V(f),V(f)))return E;switch(f){case 1:return P(I);case 2:return ee(I);case 3:return fe(I);case 4:return ie(I);case 5:return J(I);case 6:return fr(I);case 7:return Ct.S(I);case 8:return Ct.P(I);case 9:return Qt(I);case 10:return De.S(I);case 11:return De.P(I);case 12:return _e(I);case 13:return me.SNGL(I);case 14:return F(I,U);case 15:return yt(I,U);case 16:return Ee.INC(I,U);case 17:return tt.INC(I,U);case 18:return Ee.EXC(I,U);case 19:return tt.EXC(I,U)}},u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},u.AND=function(){const f=re(arguments);let C=E;for(let I=0;I<f.length;I++){if(f[I]instanceof Error)return f[I];f[I]!==void 0&&f[I]!==null&&typeof f[I]!="string"&&(C===E&&(C=!0),f[I]||(C=!1))}return C},u.ARABIC=function(f){if(f==null)return 0;if(f instanceof Error)return f;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(f))return E;let C=0;return f.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,I=>{C+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[I]}),C},u.ASC=function(){throw new Error("ASC is not implemented")},u.ASIN=function(f){if((f=V(f))instanceof Error)return f;let C=Math.asin(f);return isNaN(C)&&(C=w),C},u.ASINH=function(f){return(f=V(f))instanceof Error?f:Math.log(f+Math.sqrt(f*f+1))},u.ATAN=function(f){return(f=V(f))instanceof Error?f:Math.atan(f)},u.ATAN2=function(f,C){return Ie(f=V(f),C=V(C))||Math.atan2(f,C)},u.ATANH=function(f){if((f=V(f))instanceof Error)return f;let C=Math.log((1+f)/(1-f))/2;return isNaN(C)&&(C=w),C},u.AVEDEV=function(){const f=re(arguments).filter(He);if(f.length===0)return w;const C=ue(f);return C instanceof Error?C:h.sum(h(C).subtract(h.mean(C)).abs()[0])/C.length},u.AVERAGE=P,u.AVERAGEA=R,u.AVERAGEIF=function(f,C,I){if(arguments.length<=1)return A;if(I=ue(re(I=I||f).filter(He)),f=re(f),I instanceof Error)return I;let U=0,ne=0;const ce=C===void 0||C==="*",Te=ce?null:rt(C+"");for(let ze=0;ze<f.length;ze++){const lt=f[ze];if(ce)ne+=I[ze],U++;else{const Et=[je(lt,Fe)].concat(Te);Ue(Et)&&(ne+=I[ze],U++)}}return ne/U},u.AVERAGEIFS=function(){const f=H(arguments),C=(f.length-1)/2,I=re(f[0]);let U=0,ne=0;for(let Te=0;Te<I.length;Te++){let ze=!1;for(let lt=0;lt<C;lt++){const Et=f[2*lt+1][Te],It=f[2*lt+2];let Dt=!1;if(It===void 0||It==="*")Dt=!0;else{const xt=rt(It+""),Vt=[je(Et,Fe)].concat(xt);Dt=Ue(Vt)}if(!Dt){ze=!1;break}ze=!0}ze&&(ne+=I[Te],U++)}const ce=ne/U;return isNaN(ce)?0:ce},u.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},u.BASE=function(f,C,I){const U=Ie(f=V(f),C=V(C),I=V(I));if(U)return U;if(C===0)return w;const ne=f.toString(C);return new Array(Math.max(I+1-ne.length,0)).join("0")+ne},u.BESSELI=function(f,C){return we(f=V(f),C=V(C))?E:g.besseli(f,C)},u.BESSELJ=function(f,C){return we(f=V(f),C=V(C))?E:g.besselj(f,C)},u.BESSELK=function(f,C){return we(f=V(f),C=V(C))?E:g.besselk(f,C)},u.BESSELY=function(f,C){return we(f=V(f),C=V(C))?E:g.bessely(f,C)},u.BETA=ae,u.BETADIST=Os,u.BETAINV=Yn,u.BIN2DEC=function(f){if(!Wn(f))return w;const C=parseInt(f,2),I=f.toString();return I.length===10&&I.substring(0,1)==="1"?parseInt(I.substring(1),2)-512:C},u.BIN2HEX=function(f,C){if(!Wn(f))return w;const I=f.toString();if(I.length===10&&I.substring(0,1)==="1")return(0xfffffffe00+parseInt(I.substring(1),2)).toString(16);const U=parseInt(f,2).toString(16);return C===void 0?U:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=U.length?Wt("0",C-U.length)+U:w},u.BIN2OCT=function(f,C){if(!Wn(f))return w;const I=f.toString();if(I.length===10&&I.substring(0,1)==="1")return(1073741312+parseInt(I.substring(1),2)).toString(8);const U=parseInt(f,2).toString(8);return C===void 0?U:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=U.length?Wt("0",C-U.length)+U:w},u.BINOM=Pe,u.BINOMDIST=Fo,u.BITAND=function(f,C){return we(f=V(f),C=V(C))?E:f<0||C<0||Math.floor(f)!==f||Math.floor(C)!==C||f>0xffffffffffff||C>0xffffffffffff?w:f&C},u.BITLSHIFT=function(f,C){return we(f=V(f),C=V(C))?E:f<0||Math.floor(f)!==f||f>0xffffffffffff||Math.abs(C)>53?w:C>=0?f<<C:f>>-C},u.BITOR=function(f,C){return we(f=V(f),C=V(C))?E:f<0||C<0||Math.floor(f)!==f||Math.floor(C)!==C||f>0xffffffffffff||C>0xffffffffffff?w:f|C},u.BITRSHIFT=function(f,C){return we(f=V(f),C=V(C))?E:f<0||Math.floor(f)!==f||f>0xffffffffffff||Math.abs(C)>53?w:C>=0?f>>C:f<<-C},u.BITXOR=function(f,C){return we(f=V(f),C=V(C))?E:f<0||C<0||Math.floor(f)!==f||Math.floor(C)!==C||f>0xffffffffffff||C>0xffffffffffff?w:f^C},u.CEILING=Me,u.CEILINGMATH=Ms,u.CEILINGPRECISE=vi,u.CELL=function(){throw new Error("CELL is not implemented")},u.CHAR=Ki,u.CHIDIST=xs,u.CHIDISTRT=Lo,u.CHIINV=zn,u.CHIINVRT=qn,u.CHISQ=Oe,u.CHITEST=wn,u.CHOOSE=function(){if(arguments.length<2)return A;const f=arguments[0];return f<1||f>254||arguments.length<f+1?E:arguments[f]},u.CLEAN=function(f){return we(f)?f:(f=f||"").replace(/[\0-\x1F]/g,"")},u.CODE=gi,u.COLUMN=function(f,C){return arguments.length!==2?A:C<0?w:f instanceof Array&&typeof C=="number"?f.length!==0?h.col(f,C):void 0:E},u.COLUMNS=function(f){return arguments.length!==1?A:f instanceof Array?f.length===0?0:h.cols(f):E},u.COMBIN=dt,u.COMBINA=function(f,C){return Ie(f=V(f),C=V(C))||(f<C?w:f===0&&C===0?1:dt(f+C-1,f-1))},u.COMPLEX=cr,u.CONCAT=xo,u.CONCATENATE=Tn,u.CONFIDENCE=oe,u.CONVERT=function(f,C,I){if((f=V(f))instanceof Error)return f;const U=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],ne={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},ce={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let Te,ze=null,lt=null,Et=C,It=I,Dt=1,xt=1;for(let Vt=0;Vt<U.length;Vt++)Te=U[Vt][2]===null?[]:U[Vt][2],(U[Vt][1]===Et||Te.indexOf(Et)>=0)&&(ze=U[Vt]),(U[Vt][1]===It||Te.indexOf(It)>=0)&&(lt=U[Vt]);if(ze===null){const Vt=ne[C.substring(0,2)];let jt=ce[C.substring(0,1)];C.substring(0,2)==="da"&&(jt=["dekao",10,"da"]),Vt?(Dt=Vt[2],Et=C.substring(2)):jt&&(Dt=jt[1],Et=C.substring(jt[2].length));for(let zt=0;zt<U.length;zt++)Te=U[zt][2]===null?[]:U[zt][2],(U[zt][1]===Et||Te.indexOf(Et)>=0)&&(ze=U[zt])}if(lt===null){const Vt=ne[I.substring(0,2)];let jt=ce[I.substring(0,1)];I.substring(0,2)==="da"&&(jt=["dekao",10,"da"]),Vt?(xt=Vt[2],It=I.substring(2)):jt&&(xt=jt[1],It=I.substring(jt[2].length));for(let zt=0;zt<U.length;zt++)Te=U[zt][2]===null?[]:U[zt][2],(U[zt][1]===It||Te.indexOf(It)>=0)&&(lt=U[zt])}return ze===null||lt===null||ze[3]!==lt[3]?A:f*ze[6]*Dt/(lt[6]*xt)},u.CORREL=function(f,C){return we(f=ue(re(f)),C=ue(re(C)))?E:h.corrcoeff(f,C)},u.COS=function(f){return(f=V(f))instanceof Error?f:Math.cos(f)},u.COSH=function(f){return(f=V(f))instanceof Error?f:(Math.exp(f)+Math.exp(-f))/2},u.COT=function(f){return(f=V(f))instanceof Error?f:f===0?m:1/Math.tan(f)},u.COTH=function(f){if((f=V(f))instanceof Error)return f;if(f===0)return m;const C=Math.exp(2*f);return(C+1)/(C-1)},u.COUNT=ee,u.COUNTA=fe,u.COUNTBLANK=Re,u.COUNTIF=function(f,C){if(f=re(f),C===void 0||C==="*")return f.length;let I=0;const U=rt(C+"");for(let ne=0;ne<f.length;ne++){const ce=[je(f[ne],Fe)].concat(U);Ue(ce)&&I++}return I},u.COUNTIFS=function(){const f=H(arguments),C=new Array(re(f[0]).length);for(let U=0;U<C.length;U++)C[U]=!0;for(let U=0;U<f.length;U+=2){const ne=re(f[U]),ce=f[U+1];if(ce!==void 0&&ce!=="*"){const Te=rt(ce+"");for(let ze=0;ze<ne.length;ze++){const lt=[je(ne[ze],Fe)].concat(Te);C[ze]=C[ze]&&Ue(lt)}}}let I=0;for(let U=0;U<C.length;U++)C[U]&&I++;return I},u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},u.COVAR=_i,u.COVARIANCE=$e,u.COVARIANCEP=$o,u.COVARIANCES=Do,u.CRITBINOM=Xi,u.CSC=function(f){return(f=V(f))instanceof Error?f:f===0?m:1/Math.sin(f)},u.CSCH=function(f){return(f=V(f))instanceof Error?f:f===0?m:2/(Math.exp(f)-Math.exp(-f))},u.CUMIPMT=function(f,C,I,U,ne,ce){if(we(f=V(f),C=V(C),I=V(I)))return E;if(f<=0||C<=0||I<=0||U<1||ne<1||U>ne||ce!==0&&ce!==1)return w;const Te=An(f,C,I,0,ce);let ze=0;U===1&&(ce===0&&(ze=-I),U++);for(let lt=U;lt<=ne;lt++)ze+=ce===1?sn(f,lt-2,Te,I,1)-Te:sn(f,lt-1,Te,I,0);return ze*=f,ze},u.CUMPRINC=function(f,C,I,U,ne,ce){if(we(f=V(f),C=V(C),I=V(I)))return E;if(f<=0||C<=0||I<=0||U<1||ne<1||U>ne||ce!==0&&ce!==1)return w;const Te=An(f,C,I,0,ce);let ze=0;U===1&&(ze=ce===0?Te+I*f:Te,U++);for(let lt=U;lt<=ne;lt++)ze+=ce>0?Te-(sn(f,lt-2,Te,I,1)-Te)*f:Te-sn(f,lt-1,Te,I,0)*f;return ze},u.DATE=function(f,C,I){let U;return we(f=V(f),C=V(C),I=V(I))?U=E:(U=new Date(f,C-1,I),U.getFullYear()<0&&(U=w)),U},u.DATEDIF=Er,u.DATEVALUE=function(f){if(typeof f!="string")return E;const C=Date.parse(f);return isNaN(C)?E:new Date(f)},u.DAVERAGE=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);let ce=0;return k(U,Te=>{ce+=ne[Te]}),U.length===0?m:ce/U.length},u.DAY=function(f){const C=B(f);return C instanceof Error?C:C.getDate()},u.DAYS=hn,u.DAYS360=tn,u.DB=function(f,C,I,U,ne){if(ne=ne===void 0?12:ne,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne)))return E;if(f<0||C<0||I<0||U<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(ne)===-1||U>I)return w;if(C>=f)return 0;const ce=(1-Math.pow(C/f,1/I)).toFixed(3),Te=f*ce*ne/12;let ze=Te,lt=0;const Et=U===I?I-1:U;for(let It=2;It<=Et;It++)lt=(f-ze)*ce,ze+=lt;return U===1?Te:U===I?(f-ze)*ce:lt},u.DBCS=function(){throw new Error("DBCS is not implemented")},u.DCOUNT=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);const ce=[];return k(U,Te=>{ce.push(ne[Te])}),ee(ce)},u.DCOUNTA=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);const ce=[];return k(U,Te=>{ce.push(ne[Te])}),fe(ce)},u.DDB=function(f,C,I,U,ne){if(ne=ne===void 0?2:ne,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne)))return E;if(f<0||C<0||I<0||U<0||ne<=0||U>I)return w;if(C>=f)return 0;let ce=0,Te=0;for(let ze=1;ze<=U;ze++)Te=Math.min(ne/I*(f-ce),f-C-ce),ce+=Te;return Te},u.DEC2BIN=function(f,C){if((f=V(f))instanceof Error)return f;if(!/^-?[0-9]{1,3}$/.test(f)||f<-512||f>511)return w;if(f<0)return"1"+Wt("0",9-(512+f).toString(2).length)+(512+f).toString(2);const I=parseInt(f,10).toString(2);return C===void 0?I:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=I.length?Wt("0",C-I.length)+I:w},u.DEC2HEX=function(f,C){if((f=V(f))instanceof Error)return f;if(!/^-?[0-9]{1,12}$/.test(f)||f<-549755813888||f>549755813887)return w;if(f<0)return(1099511627776+f).toString(16);const I=parseInt(f,10).toString(16);return C===void 0?I:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=I.length?Wt("0",C-I.length)+I:w},u.DEC2OCT=function(f,C){if((f=V(f))instanceof Error)return f;if(!/^-?[0-9]{1,9}$/.test(f)||f<-536870912||f>536870911)return w;if(f<0)return(1073741824+f).toString(8);const I=parseInt(f,10).toString(8);return C===void 0?I:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=I.length?Wt("0",C-I.length)+I:w},u.DECIMAL=function(f,C){return arguments.length<1?E:Ie(f=V(f),C=V(C))||(C===0?w:parseInt(f,C))},u.DEGREES=function(f){return(f=V(f))instanceof Error?f:180*f/Math.PI},u.DELTA=function(f,C){return C=C===void 0?0:C,we(f=V(f),C=V(C))?E:f===C?1:0},u.DEVSQ=function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=h.mean(f);let I=0;for(let U=0;U<f.length;U++)I+=Math.pow(f[U]-C,2);return I},u.DGET=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];return ne=he(typeof C=="string"?f[xe(f,C)]:f[C]),U.length===0?E:U.length>1?w:ne[U[0]]},u.DISC=function(f,C,I,U,ne){if(we(f=B(f),C=B(C),I=V(I),U=V(U),ne=(ne=V(ne))||0))return E;if(I<=0||U<=0)return w;if(f>=C)return E;let ce,Te;switch(ne){case 0:ce=360,Te=tn(f,C,!1);break;case 1:case 3:ce=365,Te=Er(f,C,"D");break;case 2:ce=360,Te=Er(f,C,"D");break;case 4:ce=360,Te=tn(f,C,!0);break;default:return w}return(U-I)/U*ce/Te},u.DMAX=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);let ce=ne[U[0]];return k(U,Te=>{ce<ne[Te]&&(ce=ne[Te])}),ce},u.DMIN=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);let ce=ne[U[0]];return k(U,Te=>{ce>ne[Te]&&(ce=ne[Te])}),ce},u.DOLLAR=function(f,C=2){if(f=V(f),isNaN(f))return E;const I={style:"currency",currency:"USD",minimumFractionDigits:C>=0?C:0,maximumFractionDigits:C>=0?C:0},U=(f=ur(f,C)).toLocaleString("en-US",I);return f<0?"$("+U.slice(2)+")":U},u.DOLLARDE=function(f,C){if(we(f=V(f),C=V(C)))return E;if(C<0)return w;if(C>=0&&C<1)return m;C=parseInt(C,10);let I=parseInt(f,10);I+=f%1*Math.pow(10,Math.ceil(Math.log(C)/Math.LN10))/C;const U=Math.pow(10,Math.ceil(Math.log(C)/Math.LN2)+1);return I=Math.round(I*U)/U,I},u.DOLLARFR=function(f,C){if(we(f=V(f),C=V(C)))return E;if(C<0)return w;if(C>=0&&C<1)return m;C=parseInt(C,10);let I=parseInt(f,10);return I+=f%1*Math.pow(10,-Math.ceil(Math.log(C)/Math.LN10))*C,I},u.DPRODUCT=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const ze=xe(f,C);ne=he(f[ze])}else ne=he(f[C]);let ce=[];k(U,ze=>{ce.push(ne[ze])}),ce=Qn(ce);let Te=1;return k(ce,ze=>{Te*=ze}),Te},u.DSTDEV=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);let ce=[];return k(U,Te=>{ce.push(ne[Te])}),ce=Qn(ce),Ct.S(ce)},u.DSTDEVP=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);let ce=[];return k(U,Te=>{ce.push(ne[Te])}),ce=Qn(ce),Ct.P(ce)},u.DSUM=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);const ce=[];return k(U,Te=>{ce.push(ne[Te])}),Qt(ce)},u.DURATION=function(){throw new Error("DURATION is not implemented")},u.DVAR=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);const ce=[];return k(U,Te=>{ce.push(ne[Te])}),De.S(ce)},u.DVARP=function(f,C,I){if(isNaN(C)&&typeof C!="string")return E;const U=pr(f,I);let ne=[];if(typeof C=="string"){const Te=xe(f,C);ne=he(f[Te])}else ne=he(f[C]);const ce=[];return k(U,Te=>{ce.push(ne[Te])}),De.P(ce)},u.EDATE=function(f,C){return(f=B(f))instanceof Error?f:isNaN(C)?E:(C=parseInt(C,10),f.setMonth(f.getMonth()+C),f)},u.EFFECT=function(f,C){return we(f=V(f),C=V(C))?E:f<=0||C<1?w:(C=parseInt(C,10),Math.pow(1+f/C,C)-1)},u.EOMONTH=function(f,C){return(f=B(f))instanceof Error?f:isNaN(C)?E:(C=parseInt(C,10),new Date(f.getFullYear(),f.getMonth()+C+1,0))},u.ERF=Ei,u.ERFC=Ci,u.ERFCPRECISE=Si,u.ERFPRECISE=Qi,u.ERROR=Xe,u.EVEN=function(f){return(f=V(f))instanceof Error?f:Me(f,-2,-1)},u.EXACT=function(f,C){return arguments.length!==2?A:Ie(f,C)||(f=Ae(f))===Ae(C)},u.EXP=function(f){return arguments.length<1?A:arguments.length>1?O:(f=V(f))instanceof Error?f:f=Math.exp(f)},u.EXPON=Je,u.EXPONDIST=Fs,u.F=Be,u.FACT=Ot,u.FACTDOUBLE=function f(C){if((C=V(C))instanceof Error)return C;const I=Math.floor(C);return I<=0?1:I*f(I-2)},u.FALSE=function(){return!1},u.FDIST=nn,u.FDISTRT=Zi,u.FIND=function(f,C,I){if(arguments.length<2)return A;f=Ae(f),I=I===void 0?0:I;const U=(C=Ae(C)).indexOf(f,I-1);return U===-1?E:U+1},u.FINV=Ti,u.FINVRT=Ls,u.FISHER=function(f){return(f=V(f))instanceof Error?f:Math.log((1+f)/(1-f))/2},u.FISHERINV=function(f){if((f=V(f))instanceof Error)return f;const C=Math.exp(2*f);return(C-1)/(C+1)},u.FIXED=yi,u.FLOOR=Bt,u.FLOORMATH=wi,u.FLOORPRECISE=Ri,u.FORECAST=ot,u.FREQUENCY=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=f.length,U=C.length,ne=[];for(let ce=0;ce<=U;ce++){ne[ce]=0;for(let Te=0;Te<I;Te++)ce===0?f[Te]<=C[0]&&(ne[0]+=1):ce<U?f[Te]>C[ce-1]&&f[Te]<=C[ce]&&(ne[ce]+=1):ce===U&&f[Te]>C[U-1]&&(ne[U]+=1)}return ne},u.FTEST=$s,u.FV=sn,u.FVSCHEDULE=function(f,C){if(we(f=V(f),C=ue(re(C))))return E;const I=C.length;let U=f;for(let ne=0;ne<I;ne++)U*=1+C[ne];return U},u.GAMMA=gt,u.GAMMADIST=Ar,u.GAMMAINV=Rn,u.GAMMALN=b,u.GAMMALNPRECISE=Ji,u.GAUSS=function(f){return(f=V(f))instanceof Error?f:h.normal.cdf(f,0,1)-.5},u.GCD=function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=f.length,I=f[0];let U=I<0?-I:I;for(let ne=1;ne<C;ne++){const ce=f[ne];let Te=ce<0?-ce:ce;for(;U&&Te;)U>Te?U%=Te:Te%=U;U+=Te}return U},u.GEOMEAN=function(){const f=ue(re(arguments));return f instanceof Error?f:h.geomean(f)},u.GESTEP=function(f,C){return we(C=C||0,f=V(f))?f:f>=C?1:0},u.GROWTH=function(f,C,I,U){if((f=ue(f))instanceof Error)return f;let ne;if(C===void 0)for(C=[],ne=1;ne<=f.length;ne++)C.push(ne);if(I===void 0)for(I=[],ne=1;ne<=f.length;ne++)I.push(ne);if(we(C=ue(C),I=ue(I)))return E;U===void 0&&(U=!0);const ce=f.length;let Te,ze,lt=0,Et=0,It=0,Dt=0;for(ne=0;ne<ce;ne++){const Vt=C[ne],jt=Math.log(f[ne]);lt+=Vt,Et+=jt,It+=Vt*jt,Dt+=Vt*Vt}lt/=ce,Et/=ce,It/=ce,Dt/=ce,U?(Te=(It-lt*Et)/(Dt-lt*lt),ze=Et-Te*lt):(Te=It/Dt,ze=0);const xt=[];for(ne=0;ne<I.length;ne++)xt.push(Math.exp(ze+Te*I[ne]));return xt},u.HARMEAN=function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=f.length;let I=0;for(let U=0;U<C;U++)I+=1/f[U];return C/I},u.HEX2BIN=function(f,C){if(!/^[0-9A-Fa-f]{1,10}$/.test(f))return w;const I=!(f.length!==10||f.substring(0,1).toLowerCase()!=="f"),U=I?parseInt(f,16)-1099511627776:parseInt(f,16);if(U<-512||U>511)return w;if(I)return"1"+Wt("0",9-(512+U).toString(2).length)+(512+U).toString(2);const ne=U.toString(2);return C===void 0?ne:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=ne.length?Wt("0",C-ne.length)+ne:w},u.HEX2DEC=function(f){if(!/^[0-9A-Fa-f]{1,10}$/.test(f))return w;const C=parseInt(f,16);return C>=549755813888?C-1099511627776:C},u.HEX2OCT=function(f,C){if(!/^[0-9A-Fa-f]{1,10}$/.test(f))return w;const I=parseInt(f,16);if(I>536870911&&I<0xffe0000000)return w;if(I>=0xffe0000000)return(I-0xffc0000000).toString(8);const U=I.toString(8);return C===void 0?U:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=U.length?Wt("0",C-U.length)+U:w},u.HLOOKUP=function(f,C,I,U){return X(f,ve(C),I,U)},u.HOUR=function(f){return(f=B(f))instanceof Error?f:f.getHours()},u.HYPGEOM=q,u.HYPGEOMDIST=Kn,u.IF=function(f,C,I){return f instanceof Error?f:((C=!(arguments.length>=2)||C)==null&&(C=0),(I=arguments.length===3&&I)==null&&(I=0),f?C:I)},u.IFERROR=function(f,C){return Qe(f)?C:f},u.IFNA=function(f,C){return f===A?C:f},u.IFS=function(){for(let f=0;f<arguments.length/2;f++)if(arguments[2*f])return arguments[2*f+1];return A},u.IMABS=jn,u.IMAGINARY=qt,u.IMARGUMENT=Br,u.IMCONJUGATE=function(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",I!==0?cr(C,-I,U):f},u.IMCOS=Fr,u.IMCOSH=qr,u.IMCOT=function(f){return we(Yt(f),qt(f))?E:Lr(Fr(f),$r(f))},u.IMCSC=function(f){return f===!0||f===!1?E:we(Yt(f),qt(f))?w:Lr("1",$r(f))},u.IMCSCH=function(f){return f===!0||f===!1?E:we(Yt(f),qt(f))?w:Lr("1",Ps(f))},u.IMDIV=Lr,u.IMEXP=function(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);U=U==="i"||U==="j"?U:"i";const ne=Math.exp(C);return cr(ne*Math.cos(I),ne*Math.sin(I),U)},u.IMLN=function(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.log(Math.sqrt(C*C+I*I)),Math.atan(I/C),U)},u.IMLOG10=function(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.log(Math.sqrt(C*C+I*I))/Math.log(10),Math.atan(I/C)/Math.log(10),U)},u.IMLOG2=function(f){const C=Yt(f),I=qt(f);if(we(C,I))return E;let U=f.substring(f.length-1);return U=U==="i"||U==="j"?U:"i",cr(Math.log(Math.sqrt(C*C+I*I))/Math.log(2),Math.atan(I/C)/Math.log(2),U)},u.IMPOWER=function(f,C){if(we(C=V(C),Yt(f),qt(f)))return E;let I=f.substring(f.length-1);I=I==="i"||I==="j"?I:"i";const U=Math.pow(jn(f),C),ne=Br(f);return cr(U*Math.cos(C*ne),U*Math.sin(C*ne),I)},u.IMPRODUCT=function(){let f=arguments[0];if(!arguments.length)return E;for(let C=1;C<arguments.length;C++){const I=Yt(f),U=qt(f),ne=Yt(arguments[C]),ce=qt(arguments[C]);if(we(I,U,ne,ce))return E;f=cr(I*ne-U*ce,I*ce+U*ne)}return f},u.IMREAL=Yt,u.IMSEC=function(f){return f===!0||f===!1||we(Yt(f),qt(f))?E:Lr("1",Fr(f))},u.IMSECH=function(f){return we(Yt(f),qt(f))?E:Lr("1",qr(f))},u.IMSIN=$r,u.IMSINH=Ps,u.IMSQRT=function(f){if(we(Yt(f),qt(f)))return E;let C=f.substring(f.length-1);C=C==="i"||C==="j"?C:"i";const I=Math.sqrt(jn(f)),U=Br(f);return cr(I*Math.cos(U/2),I*Math.sin(U/2),C)},u.IMSUB=function(f,C){const I=Yt(f),U=qt(f),ne=Yt(C),ce=qt(C);if(we(I,U,ne,ce))return E;const Te=f.substring(f.length-1),ze=C.substring(C.length-1);let lt="i";return(Te==="j"||ze==="j")&&(lt="j"),cr(I-ne,U-ce,lt)},u.IMSUM=function(){if(!arguments.length)return E;const f=re(arguments);let C=f[0];for(let I=1;I<f.length;I++){const U=Yt(C),ne=qt(C),ce=Yt(f[I]),Te=qt(f[I]);if(we(U,ne,ce,Te))return E;C=cr(U+ce,ne+Te)}return C},u.IMTAN=function(f){return f===!0||f===!1||we(Yt(f),qt(f))?E:Lr($r(f),Fr(f))},u.INDEX=function(f,C,I){const U=Ie(f,C,I);if(U)return U;if(!Array.isArray(f))return E;const ne=f.length>0&&!Array.isArray(f[0]);return ne&&!I?(I=C,C=1):(I=I||1,C=C||1),I<0||C<0?E:ne&&C===1&&I<=f.length?f[I-1]:C<=f.length&&I<=f[C-1].length?f[C-1][I-1]:_},u.INFO=function(){throw new Error("INFO is not implemented")},u.INT=function(f){return(f=V(f))instanceof Error?f:Math.floor(f)},u.INTERCEPT=function(f,C){return we(f=ue(f),C=ue(C))?E:f.length!==C.length?A:ot(0,f,C)},u.INTRATE=function(){throw new Error("INTRATE is not implemented")},u.IPMT=ss,u.IRR=function(f,C){if(C=C||0,we(f=ue(re(f)),C=V(C)))return E;const I=(xt,Vt,jt)=>{const zt=jt+1;let _r=xt[0];for(let tr=1;tr<xt.length;tr++)_r+=xt[tr]/Math.pow(zt,(Vt[tr]-Vt[0])/365);return _r},U=(xt,Vt,jt)=>{const zt=jt+1;let _r=0;for(let tr=1;tr<xt.length;tr++){const on=(Vt[tr]-Vt[0])/365;_r-=on*xt[tr]/Math.pow(zt,on+1)}return _r},ne=[];let ce=!1,Te=!1;for(let xt=0;xt<f.length;xt++)ne[xt]=xt===0?0:ne[xt-1]+365,f[xt]>0&&(ce=!0),f[xt]<0&&(Te=!0);if(!ce||!Te)return w;let ze,lt,Et,It=C=C===void 0?.1:C,Dt=!0;do Et=I(f,ne,It),ze=It-Et/U(f,ne,It),lt=Math.abs(ze-It),It=ze,Dt=lt>1e-10&&Math.abs(Et)>1e-10;while(Dt);return It},u.ISBLANK=function(f){return f===null},u.ISERR=et,u.ISERROR=Qe,u.ISEVEN=function(f){return!(1&Math.floor(Math.abs(f)))},u.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},u.ISLOGICAL=st,u.ISNA=function(f){return f===A},u.ISNONTEXT=function(f){return typeof f!="string"},u.ISNUMBER=St,u.ISO=bt,u.ISODD=function(f){return!!(1&Math.floor(Math.abs(f)))},u.ISOWEEKNUM=Gn,u.ISPMT=function(f,C,I,U){return we(f=V(f),C=V(C),I=V(I),U=V(U))?E:U*f*(C/I-1)},u.ISREF=function(){throw new Error("ISREF is not implemented")},u.ISTEXT=At,u.KURT=function(){const f=ue(re(arguments));if(f instanceof Error)return f;const C=h.mean(f),I=f.length;let U=0;for(let ne=0;ne<I;ne++)U+=Math.pow(f[ne]-C,4);return U/=Math.pow(h.stdev(f,!0),4),I*(I+1)/((I-1)*(I-2)*(I-3))*U-3*(I-1)*(I-1)/((I-2)*(I-3))},u.LARGE=F,u.LCM=function(){const f=ue(re(arguments));if(f instanceof Error)return f;for(var C,I,U,ne,ce=1;(U=f.pop())!==void 0;){if(U===0)return 0;for(;U>1;){if(U%2){for(C=3,I=Math.floor(Math.sqrt(U));C<=I&&U%C;C+=2);ne=C<=I?C:U}else ne=2;for(U/=ne,ce*=ne,C=f.length;C;f[--C]%ne==0&&(f[C]/=ne)==1&&f.splice(C,1));}}return ce},u.LEFT=function(f,C){return Ie(f,C)||(f=Ae(f),(C=V(C=C===void 0?1:C))instanceof Error||typeof f!="string"?E:f.substring(0,C))},u.LEN=function(f){return arguments.length===0?O:f instanceof Error?f:Array.isArray(f)?E:Ae(f).length},u.LINEST=W,u.LN=function(f){return(f=V(f))instanceof Error?f:f===0?w:Math.log(f)},u.LOG=function(f,C){return Ie(f=V(f),C=V(C))||(f===0||C===0?w:Math.log(f)/Math.log(C))},u.LOG10=function(f){return(f=V(f))instanceof Error?f:f===0?w:Math.log(f)/Math.log(10)},u.LOGEST=function(f,C){if(we(f=ue(re(f)),C=ue(re(C)))||f.length!==C.length)return E;for(let U=0;U<f.length;U++)f[U]=Math.log(f[U]);const I=W(f,C);return I[0]=Math.round(1e6*Math.exp(I[0]))/1e6,I[1]=Math.round(1e6*Math.exp(I[1]))/1e6,I},u.LOGINV=ko,u.LOGNORM=z,u.LOGNORMDIST=es,u.LOGNORMINV=ts,u.LOOKUP=function(f,C,I){C=re(C),I=I?re(I):C;const U=typeof f=="number";let ne=A;for(let ce=0;ce<C.length;ce++){if(C[ce]===f)return I[ce];if(U&&C[ce]<=f||typeof C[ce]=="string"&&C[ce].localeCompare(f)<0)ne=I[ce];else if(U&&C[ce]>f)return ne}return ne},u.LOWER=function(f){return arguments.length!==1?E:we(f=Ae(f))?f:f.toLowerCase()},u.MATCH=function(f,C,I){if(!f||!C||(arguments.length===2&&(I=1),!((C=re(C))instanceof Array))||I!==-1&&I!==0&&I!==1)return A;let U,ne;for(let ce=0;ce<C.length;ce++)if(I===1){if(C[ce]===f)return ce+1;C[ce]<f&&(ne?C[ce]>ne&&(U=ce+1,ne=C[ce]):(U=ce+1,ne=C[ce]))}else if(I===0){if(typeof f=="string"&&typeof C[ce]=="string"){const Te=f.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+Te+"$").test(C[ce].toLowerCase()))return ce+1}else if(C[ce]===f)return ce+1}else if(I===-1){if(C[ce]===f)return ce+1;C[ce]>f&&(ne?C[ce]<ne&&(U=ce+1,ne=C[ce]):(U=ce+1,ne=C[ce]))}return U||A},u.MAX=ie,u.MAXA=function(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;let I=K(f);return I=I.map(U=>U??0),I.length===0?0:Math.max.apply(Math,I)},u.MDURATION=function(){throw new Error("MDURATION is not implemented")},u.MEDIAN=_e,u.MID=function(f,C,I){if(C==null)return E;if(we(C=V(C),I=V(I))||typeof f!="string")return I;const U=C-1,ne=U+I;return f.substring(U,ne)},u.MIN=J,u.MINA=function(){const f=re(arguments),C=Ie.apply(void 0,f);if(C)return C;let I=K(f);return I=I.map(U=>U??0),I.length===0?0:Math.min.apply(Math,I)},u.MINUTE=function(f){return(f=B(f))instanceof Error?f:f.getMinutes()},u.MIRR=function(f,C,I){if(we(f=ue(re(f)),C=V(C),I=V(I)))return E;const U=f.length,ne=[],ce=[];for(let lt=0;lt<U;lt++)f[lt]<0?ne.push(f[lt]):ce.push(f[lt]);const Te=-Ni(I,ce)*Math.pow(1+I,U-1),ze=Ni(C,ne)*(1+C);return Math.pow(Te/ze,1/(U-1))-1},u.MMULT=function(f,C){return!Array.isArray(f)||!Array.isArray(C)||f.some(I=>!I.length)||C.some(I=>!I.length)||Ce(f).some(I=>typeof I!="number")||Ce(C).some(I=>typeof I!="number")||f[0].length!==C.length?E:Array(f.length).fill(0).map(()=>Array(C[0].length).fill(0)).map((I,U)=>I.map((ne,ce)=>f[U].reduce((Te,ze,lt)=>Te+ze*C[lt][ce],0)))},u.MOD=function(f,C){const I=Ie(f=V(f),C=V(C));if(I)return I;if(C===0)return m;let U=Math.abs(f%C);return U=f<0?C-U:U,C>0?U:-U},u.MODE=me,u.MODEMULT=Xn,u.MODESNGL=Ai,u.MONTH=function(f){return(f=B(f))instanceof Error?f:f.getMonth()+1},u.MROUND=function(f,C){return Ie(f=V(f),C=V(C))||(f*C==0?0:f*C<0?w:Math.round(f/C)*C)},u.MULTINOMIAL=function(){const f=ue(re(arguments));if(f instanceof Error)return f;let C=0,I=1;for(let U=0;U<f.length;U++)C+=f[U],I*=Ot(f[U]);return Ot(C)/I},u.MUNIT=function(f){return arguments.length>1?A:!(f=parseInt(f))||f<=0?E:Array(f).fill(0).map(()=>Array(f).fill(0)).map((C,I)=>(C[I]=1,C))},u.N=function(f){return St(f)?f:f instanceof Date?f.getTime():f===!0?1:f===!1?0:Qe(f)?f:0},u.NA=function(){return A},u.NEGBINOM=L,u.NEGBINOMDIST=Ds,u.NETWORKDAYS=fn,u.NETWORKDAYSINTL=Ho,u.NOMINAL=function(f,C){return we(f=V(f),C=V(C))?E:f<=0||C<1?w:(C=parseInt(C,10),(Math.pow(f+1,1/C)-1)*C)},u.NORM=Z,u.NORMDIST=Uo,u.NORMINV=Bo,u.NORMSDIST=rs,u.NORMSINV=Vo,u.NOT=function(f){return typeof f=="string"?E:f instanceof Error?f:!f},u.NOW=function(){return new Date},u.NPER=function(f,C,I,U,ne){if(ne=ne===void 0?0:ne,U=U===void 0?0:U,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne)))return E;if(f===0)return-(I+U)/C;{const ce=C*(1+f*ne)-U*f,Te=I*f+C*(1+f*ne);return Math.log(ce/Te)/Math.log(1+f)}},u.NPV=Ni,u.NUMBERVALUE=function(f,C,I){return typeof(f=He(f)?f:"")=="number"?f:typeof f!="string"?A:(C=C===void 0?".":C,I=I===void 0?",":I,Number(f.replace(C,".").replace(I,"")))},u.OCT2BIN=function(f,C){if(!/^[0-7]{1,10}$/.test(f))return w;const I=!(f.length!==10||f.substring(0,1)!=="7"),U=I?parseInt(f,8)-1073741824:parseInt(f,8);if(U<-512||U>511)return w;if(I)return"1"+Wt("0",9-(512+U).toString(2).length)+(512+U).toString(2);const ne=U.toString(2);return C===void 0?ne:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=ne.length?Wt("0",C-ne.length)+ne:w},u.OCT2DEC=function(f){if(!/^[0-7]{1,10}$/.test(f))return w;const C=parseInt(f,8);return C>=536870912?C-1073741824:C},u.OCT2HEX=function(f,C){if(!/^[0-7]{1,10}$/.test(f))return w;const I=parseInt(f,8);if(I>=536870912)return"ff"+(I+3221225472).toString(16);const U=I.toString(16);return C===void 0?U:isNaN(C)?E:C<0?w:(C=Math.floor(C))>=U.length?Wt("0",C-U.length)+U:w},u.ODD=function(f){if((f=V(f))instanceof Error)return f;let C=Math.ceil(Math.abs(f));return C=1&C?C:C+1,f>=0?C:-C},u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},u.OR=function(){const f=re(arguments);let C=E;for(let I=0;I<f.length;I++){if(f[I]instanceof Error)return f[I];f[I]!==void 0&&f[I]!==null&&typeof f[I]!="string"&&(C===E&&(C=!1),f[I]&&(C=!0))}return C},u.PDURATION=function(f,C,I){return we(f=V(f),C=V(C),I=V(I))?E:f<=0?w:(Math.log(I)-Math.log(C))/Math.log(1+f)},u.PEARSON=de,u.PERCENTILE=Ee,u.PERCENTILEEXC=Go,u.PERCENTILEINC=Wo,u.PERCENTRANK=ye,u.PERCENTRANKEXC=jo,u.PERCENTRANKINC=Yo,u.PERMUT=function(f,C){return we(f=V(f),C=V(C))?E:Ot(f)/Ot(f-C)},u.PERMUTATIONA=function(f,C){return we(f=V(f),C=V(C))?E:Math.pow(f,C)},u.PHI=function(f){return(f=V(f))instanceof Error?E:Math.exp(-.5*f*f)/2.5066282746310002},u.PI=function(){return Math.PI},u.PMT=An,u.POISSON=Ge,u.POISSONDIST=ks,u.POWER=lr,u.PPMT=function(f,C,I,U,ne,ce){return ne=ne||0,ce=ce||0,we(f=V(f),I=V(I),U=V(U),ne=V(ne),ce=V(ce))?E:An(f,I,U,ne,ce)-ss(f,C,I,U,ne,ce)},u.PRICE=function(){throw new Error("PRICE is not implemented")},u.PRICEDISC=function(f,C,I,U,ne){if(we(f=B(f),C=B(C),I=V(I),U=V(U),ne=(ne=V(ne))||0))return E;if(I<=0||U<=0)return w;if(f>=C)return E;let ce,Te;switch(ne){case 0:ce=360,Te=tn(f,C,!1);break;case 1:case 3:ce=365,Te=Er(f,C,"D");break;case 2:ce=360,Te=Er(f,C,"D");break;case 4:ce=360,Te=tn(f,C,!0);break;default:return w}return U-I*U*Te/ce},u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},u.PROB=function(f,C,I,U){if(I===void 0)return 0;if(U=U===void 0?I:U,we(f=ue(re(f)),C=ue(re(C)),I=V(I),U=V(U)))return E;if(I===U)return f.indexOf(I)>=0?C[f.indexOf(I)]:0;const ne=f.sort((ze,lt)=>ze-lt),ce=ne.length;let Te=0;for(let ze=0;ze<ce;ze++)ne[ze]>=I&&ne[ze]<=U&&(Te+=C[f.indexOf(ne[ze])]);return Te},u.PRODUCT=fr,u.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},u.PROPER=function(f){return we(f)?f:isNaN(f)&&typeof f=="number"?E:(f=Ae(f)).replace(/\w\S*/g,C=>C.charAt(0).toUpperCase()+C.substr(1).toLowerCase())},u.PV=function(f,C,I,U,ne){return U=U||0,ne=ne||0,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne))?E:f===0?-I*C-U:((1-Math.pow(1+f,C))/f*I*(1+f*ne)-U)/Math.pow(1+f,C)},u.QUARTILE=tt,u.QUARTILEEXC=zo,u.QUARTILEINC=qo,u.QUOTIENT=function(f,C){return Ie(f=V(f),C=V(C))||parseInt(f/C,10)},u.RADIANS=function(f){return(f=V(f))instanceof Error?f:f*Math.PI/180},u.RAND=function(){return Math.random()},u.RANDBETWEEN=function(f,C){return Ie(f=V(f),C=V(C))||f+Math.ceil((C-f+1)*Math.random())-1},u.RANK=ft,u.RANKAVG=Ko,u.RANKEQ=Xo,u.RATE=function(f,C,I,U,ne,ce){if(ce=ce===void 0?.01:ce,U=U===void 0?0:U,ne=ne===void 0?0:ne,we(f=V(f),C=V(C),I=V(I),U=V(U),ne=V(ne),ce=V(ce)))return E;const Te=1e-10;let ze=ce;ne=ne?1:0;for(let lt=0;lt<20;lt++){if(ze<=-1)return w;let Et,It,Dt;if(Math.abs(ze)<Te?Et=I*(1+f*ze)+C*(1+ze*ne)*f+U:(It=Math.pow(1+ze,f),Et=I*It+C*(1/ze+ne)*(It-1)+U),Math.abs(Et)<Te)return ze;if(Math.abs(ze)<Te)Dt=I*f+C*ne*f;else{It=Math.pow(1+ze,f);const xt=f*Math.pow(1+ze,f-1);Dt=I*xt+C*(1/ze+ne)*xt+C*(-1/(ze*ze))*(It-1)}ze-=Et/Dt}return ze},u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},u.REPLACE=function(f,C,I,U){return we(C=V(C),I=V(I))||typeof f!="string"||typeof U!="string"?E:f.substr(0,C-1)+U+f.substr(C-1+I)},u.REPT=Wt,u.RIGHT=function(f,C){return Ie(f,C)||(f=Ae(f),(C=V(C=C===void 0?1:C))instanceof Error?C:f.substring(f.length-C))},u.ROMAN=function(f){if((f=V(f))instanceof Error)return f;const C=String(f).split(""),I=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let U="",ne=3;for(;ne--;)U=(I[+C.pop()+10*ne]||"")+U;return new Array(+C.join("")+1).join("M")+U},u.ROUND=ur,u.ROUNDDOWN=function(f,C){return Ie(f=V(f),C=V(C))||(f>0?1:-1)*Math.floor(Math.abs(f)*Math.pow(10,C))/Math.pow(10,C)},u.ROUNDUP=function(f,C){return Ie(f=V(f),C=V(C))||(f>0?1:-1)*Math.ceil(Math.abs(f)*Math.pow(10,C))/Math.pow(10,C)},u.ROW=function(f,C){return arguments.length!==2?A:C<0?w:f instanceof Array&&typeof C=="number"?f.length!==0?h.row(f,C):void 0:E},u.ROWS=function(f){return arguments.length!==1?A:f instanceof Array?f.length===0?0:h.rows(f):E},u.RRI=function(f,C,I){return we(f=V(f),C=V(C),I=V(I))?E:f===0||C===0?w:Math.pow(I/C,1/f)-1},u.RSQ=function(f,C){return we(f=ue(re(f)),C=ue(re(C)))?E:Math.pow(de(f,C),2)},u.SEARCH=function(f,C,I){let U;return typeof f!="string"||typeof C!="string"?E:(I=I===void 0?0:I,U=C.toLowerCase().indexOf(f.toLowerCase(),I-1)+1,U===0?E:U)},u.SEC=function(f){return(f=V(f))instanceof Error?f:1/Math.cos(f)},u.SECH=function(f){return(f=V(f))instanceof Error?f:2/(Math.exp(f)+Math.exp(-f))},u.SECOND=function(f){return(f=B(f))instanceof Error?f:f.getSeconds()},u.SERIESSUM=function(f,C,I,U){if(we(f=V(f),C=V(C),I=V(I),U=ue(U)))return E;let ne=U[0]*Math.pow(f,C);for(let ce=1;ce<U.length;ce++)ne+=U[ce]*Math.pow(f,C+ce*I);return ne},u.SHEET=function(){throw new Error("SHEET is not implemented")},u.SHEETS=function(){throw new Error("SHEETS is not implemented")},u.SIGN=function(f){return(f=V(f))instanceof Error?f:f<0?-1:f===0?0:1},u.SIN=function(f){return(f=V(f))instanceof Error?f:Math.sin(f)},u.SINH=function(f){return(f=V(f))instanceof Error?f:(Math.exp(f)-Math.exp(-f))/2},u.SKEW=We,u.SKEWP=ns,u.SLN=function(f,C,I){return we(f=V(f),C=V(C),I=V(I))?E:I===0?w:(f-C)/I},u.SLOPE=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=h.mean(C),U=h.mean(f),ne=C.length;let ce=0,Te=0;for(let ze=0;ze<ne;ze++)ce+=(C[ze]-I)*(f[ze]-U),Te+=Math.pow(C[ze]-I,2);return ce/Te},u.SMALL=yt,u.SORT=function(f,C=1,I=1,U=!1){if(!f||!Array.isArray(f))return A;if(f.length===0)return 0;if(!(C=V(C))||C<1||(I=V(I))!==1&&I!==-1)return E;if(typeof(U=nt(U))!="boolean")return S;const ne=ze=>ze.sort((lt,Et)=>(lt=Ae(lt[C-1]),Et=Ae(Et[C-1]),I===1?lt<Et?-1*I:I:lt>Et?I:-1*I)),ce=se(f),Te=U?ve(ce):ce;return C>=1&&C<=Te[0].length?U?ve(ne(Te)):ne(Te):E},u.SQRT=function(f){return(f=V(f))instanceof Error?f:f<0?w:Math.sqrt(f)},u.SQRTPI=function(f){return(f=V(f))instanceof Error?f:Math.sqrt(f*Math.PI)},u.STANDARDIZE=function(f,C,I){return we(f=V(f),C=V(C),I=V(I))?E:(f-C)/I},u.STDEV=Ct,u.STDEVA=function(){const f=ht.apply(this,arguments);return Math.sqrt(f)},u.STDEVP=Qo,u.STDEVPA=function(){const f=mt.apply(this,arguments);let C=Math.sqrt(f);return isNaN(C)&&(C=w),C},u.STDEVS=Zo,u.STEYX=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;const I=h.mean(C),U=h.mean(f),ne=C.length;let ce=0,Te=0,ze=0;for(let lt=0;lt<ne;lt++)ce+=Math.pow(f[lt]-U,2),Te+=(C[lt]-I)*(f[lt]-U),ze+=Math.pow(C[lt]-I,2);return Math.sqrt((ce-Te*Te/ze)/(ne-2))},u.SUBSTITUTE=function(f,C,I,U){if(arguments.length<3)return A;if(f&&C){if(U===void 0)return f.split(C).join(I);{if(U=Math.floor(Number(U)),Number.isNaN(U)||U<=0)return E;let ne=0,ce=0;for(;ne>-1&&f.indexOf(C,ne)>-1;)if(ne=f.indexOf(C,ne+1),ce++,ne>-1&&ce===U)return f.substring(0,ne)+I+f.substring(ne+C.length);return f}}return f},u.SUBTOTAL=function(f,C){if((f=V(f))instanceof Error)return f;switch(f){case 1:case 101:return P(C);case 2:case 102:return ee(C);case 3:case 103:return fe(C);case 4:case 104:return ie(C);case 5:case 105:return J(C);case 6:case 106:return fr(C);case 7:case 107:return Ct.S(C);case 8:case 108:return Ct.P(C);case 9:case 109:return Qt(C);case 10:case 110:return De.S(C);case 11:case 111:return De.P(C)}},u.SUM=Qt,u.SUMIF=function(f,C,I){if(f=re(f),I=I?re(I):f,f instanceof Error)return f;if(C==null||C instanceof Error)return 0;let U=0;const ne=C==="*",ce=ne?null:rt(C+"");for(let Te=0;Te<f.length;Te++){const ze=f[Te],lt=I[Te];if(ne)U+=ze;else{const Et=[je(ze,Fe)].concat(ce);U+=Ue(Et)?lt:0}}return U},u.SUMIFS=function(){const f=H(arguments),C=ue(re(f.shift()));if(C instanceof Error)return C;const I=f,U=I.length/2;for(let ce=0;ce<U;ce++)I[2*ce]=re(I[2*ce]);let ne=0;for(let ce=0;ce<C.length;ce++){let Te=!1;for(let ze=0;ze<U;ze++){const lt=I[2*ze][ce],Et=I[2*ze+1];let It=!1;if(Et===void 0||Et==="*")It=!0;else{const Dt=rt(Et+""),xt=[je(lt,Fe)].concat(Dt);It=Ue(xt)}if(!It){Te=!1;break}Te=!0}Te&&(ne+=C[ce])}return ne},u.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return E;const f=arguments.length+1;let C,I,U,ne,ce=0;for(let Te=0;Te<arguments[0].length;Te++)if(arguments[0][Te]instanceof Array)for(let ze=0;ze<arguments[0][Te].length;ze++){for(C=1,I=1;I<f;I++){const lt=arguments[I-1][Te][ze];if(lt instanceof Error)return lt;if(ne=V(lt),ne instanceof Error)return ne;C*=ne}ce+=C}else{for(C=1,I=1;I<f;I++){const ze=arguments[I-1][Te];if(ze instanceof Error)return ze;if(U=V(ze),U instanceof Error)return U;C*=U}ce+=C}return ce},u.SUMSQ=function(){const f=ue(re(arguments));if(f instanceof Error)return f;let C=0;const I=f.length;for(let U=0;U<I;U++)C+=St(f[U])?f[U]*f[U]:0;return C},u.SUMX2MY2=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;let I=0;for(let U=0;U<f.length;U++)I+=f[U]*f[U]-C[U]*C[U];return I},u.SUMX2PY2=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;let I=0;f=ue(re(f)),C=ue(re(C));for(let U=0;U<f.length;U++)I+=f[U]*f[U]+C[U]*C[U];return I},u.SUMXMY2=function(f,C){if(we(f=ue(re(f)),C=ue(re(C))))return E;let I=0;f=re(f),C=re(C);for(let U=0;U<f.length;U++)I+=Math.pow(f[U]-C[U],2);return I},u.SWITCH=function(){let f;if(arguments.length>0){const C=arguments[0],I=arguments.length-1,U=Math.floor(I/2);let ne=!1;const ce=I%2!=0,Te=I%2==0?null:arguments[arguments.length-1];if(U){for(let ze=0;ze<U;ze++)if(C===arguments[2*ze+1]){f=arguments[2*ze+2],ne=!0;break}}ne||(f=ce?Te:A)}else f=E;return f},u.SYD=function(f,C,I,U){return we(f=V(f),C=V(C),I=V(I),U=V(U))?E:I===0||U<1||U>I?w:(f-C)*(I-(U=parseInt(U,10))+1)*2/(I*(I+1))},u.T=function(f){return f instanceof Error||typeof f=="string"?f:""},u.TAN=function(f){return(f=V(f))instanceof Error?f:Math.tan(f)},u.TANH=function(f){if((f=V(f))instanceof Error)return f;const C=Math.exp(2*f);return(C-1)/(C+1)},u.TBILLEQ=function(f,C,I){return we(f=B(f),C=B(C),I=V(I))?E:I<=0||f>C||C-f>31536e6?w:365*I/(360-I*tn(f,C,!1))},u.TBILLPRICE=function(f,C,I){return we(f=B(f),C=B(C),I=V(I))?E:I<=0||f>C||C-f>31536e6?w:100*(1-I*tn(f,C,!1)/360)},u.TBILLYIELD=function(f,C,I){return we(f=B(f),C=B(C),I=V(I))?E:I<=0||f>C||C-f>31536e6?w:360*(100-I)/(I*tn(f,C,!1))},u.TDIST=Jo,u.TDISTRT=Hs,u.TEXT=function(f,C){if(f===void 0||f instanceof Error||C instanceof Error)return A;if(C==null)return"";if(typeof C=="number")return String(C);if(typeof C!="string")return E;const I=C.startsWith("$")?"$":"",U=C.endsWith("%");return U&&(f*=100),f=(f=yi(f,(C=C.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!C.includes(","))).startsWith("-")?"-"+I+(f=f.replace("-","")):I+f,U&&(f+="%"),f},u.TEXTJOIN=function(f,C,...I){if(typeof C!="boolean"&&(C=nt(C)),arguments.length<3)return A;f=f??"";let U=re(I),ne=C?U.filter(ce=>ce):U;if(Array.isArray(f)){f=re(f);let ce=ne.map(ze=>[ze]),Te=0;for(let ze=0;ze<ce.length-1;ze++)ce[ze].push(f[Te]),Te++,Te===f.length&&(Te=0);return ne=re(ce),ne.join("")}return ne.join(f)},u.TIME=function(f,C,I){return we(f=V(f),C=V(C),I=V(I))?E:f<0||C<0||I<0?w:(3600*f+60*C+I)/86400},u.TIMEVALUE=function(f){return(f=B(f))instanceof Error?f:(3600*f.getHours()+60*f.getMinutes()+f.getSeconds())/86400},u.TINV=ea,u.TODAY=function(){return fi(new Date)},u.TRANSPOSE=function(f){return f?ve(se(f)):A},u.TREND=function(f,C,I){if(we(f=ue(re(f)),C=ue(re(C)),I=ue(re(I))))return E;const U=W(f,C),ne=U[0],ce=U[1],Te=[];return I.forEach(ze=>{Te.push(ne*ze+ce)}),Te},u.TRIM=function(f){return(f=Ae(f))instanceof Error?f:f.replace(/\s+/g," ").trim()},u.TRIMMEAN=function(f,C){if(we(f=ue(re(f)),C=V(C)))return E;const I=Bt(f.length*C,2)/2;return h.mean((ne=(ne=I)||1,(U=he(f.sort((ce,Te)=>ce-Te),I))&&typeof U.slice=="function"?U.slice(0,U.length-ne):U));var U,ne},u.TRUE=function(){return!0},u.TRUNC=function(f,C){return Ie(f=V(f),C=V(C))||(f>0?1:-1)*Math.floor(Math.abs(f)*Math.pow(10,C))/Math.pow(10,C)},u.TTEST=ta,u.TYPE=function(f){return St(f)?1:At(f)?2:st(f)?4:Qe(f)?16:Array.isArray(f)?64:void 0},u.UNICHAR=Ns,u.UNICODE=Is,u.UNIQUE=j,u.UPPER=function(f){return(f=Ae(f))instanceof Error?f:f.toUpperCase()},u.VALUE=function(f){const C=Ie(f);if(C)return C;if(typeof f=="number")return f;if(He(f)||(f=""),typeof f!="string")return E;const I=/(%)$/.test(f)||/^(%)/.test(f);if((f=(f=(f=f.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let U=Number(f);return isNaN(U)?E:(U=U||0,I&&(U*=.01),U)},u.VAR=De,u.VARA=ht,u.VARP=ra,u.VARPA=mt,u.VARS=na,u.VDB=function(){throw new Error("VDB is not implemented")},u.VLOOKUP=X,u.WEEKDAY=function(f,C){if((f=B(f))instanceof Error)return f;C===void 0&&(C=1);const I=f.getDay();return Ur[C][I]},u.WEEKNUM=function(f,C){if((f=B(f))instanceof Error)return f;if(C===void 0&&(C=1),C===21)return Gn(f);const I=di[C];let U=new Date(f.getFullYear(),0,1);const ne=U.getDay()<I?1:0;return U-=24*Math.abs(U.getDay()-I)*60*60*1e3,Math.floor((f-U)/864e5/7+1)+ne},u.WEIBULL=Nt,u.WEIBULLDIST=ia,u.WORKDAY=rn,u.WORKDAYINTL=sa,u.XIRR=function(f,C,I){if(we(f=ue(re(f)),C=te(re(C)),I=V(I)))return E;const U=(xt,Vt,jt)=>{const zt=jt+1;let _r=xt[0];for(let tr=1;tr<xt.length;tr++)_r+=xt[tr]/Math.pow(zt,hn(Vt[tr],Vt[0])/365);return _r},ne=(xt,Vt,jt)=>{const zt=jt+1;let _r=0;for(let tr=1;tr<xt.length;tr++){const on=hn(Vt[tr],Vt[0])/365;_r-=on*xt[tr]/Math.pow(zt,on+1)}return _r};let ce=!1,Te=!1;for(let xt=0;xt<f.length;xt++)f[xt]>0&&(ce=!0),f[xt]<0&&(Te=!0);if(!ce||!Te)return w;let ze,lt,Et,It=I=I||.1,Dt=!0;do Et=U(f,C,It),ze=It-Et/ne(f,C,It),lt=Math.abs(ze-It),It=ze,Dt=lt>1e-10&&Math.abs(Et)>1e-10;while(Dt);return It},u.XNPV=function(f,C,I){if(we(f=V(f),C=ue(re(C)),I=te(re(I))))return E;let U=0;for(let ne=0;ne<C.length;ne++)U+=C[ne]/Math.pow(1+f,hn(I[ne],I[0])/365);return U},u.XOR=function(){const f=re(arguments);let C=E;for(let I=0;I<f.length;I++){if(f[I]instanceof Error)return f[I];f[I]!==void 0&&f[I]!==null&&typeof f[I]!="string"&&(C===E&&(C=0),f[I]&&C++)}return C===E?C:!!(1&Math.floor(Math.abs(C)))},u.YEAR=function(f){return(f=B(f))instanceof Error?f:f.getFullYear()},u.YEARFRAC=qi,u.YIELD=function(){throw new Error("YIELD is not implemented")},u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},u.Z=pt,u.ZTEST=oa,u.utils=bn}},s={};function o(l){var u=s[l];if(u!==void 0)return u.exports;var c=s[l]={exports:{}};return n[l].call(c.exports,c,c.exports,o),c.exports}o.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var a=o(960);t=a}(),t})}(dist$2)),dist$2.exports}var dist=dist$3.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire=="function")var formula=requireDist$1();(function(r,e){module.exports=e()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={100:function(r,e){const t=function(o){const a=this,l=[];for(let u=0;u<o.length;u++){const c=o[u].x,h=o[u].y,g=a.options.columns[c].name?a.options.columns[c].name:c;l[h]||(l[h]={row:h,data:{}}),l[h].data[g]=o[u].value}return l.filter(function(u){return u!=null})},n=function(o,a){const l=this,u=s.call(l.parent,"onbeforesave",l.parent,l,a);if(u)a=u;else if(u===!1)return!1;jSuites.ajax({url:o,method:"POST",dataType:"json",data:{data:JSON.stringify(a)},success:function(c){s.call(l,"onsave",l.parent,l,a)}})},s=function(o){const a=this;let l=null,u=a.parent?a.parent:a;if(!u.ignoreEvents&&(typeof u.config.onevent=="function"&&(l=u.config.onevent.apply(this,arguments)),typeof u.config[o]=="function"&&(l=u.config[o].apply(this,Array.prototype.slice.call(arguments,1))),typeof u.plugins=="object")){const c=Object.keys(u.plugins);for(let h=0;h<c.length;h++){const g=c[h],v=u.plugins[g];typeof v.onevent=="function"&&(l=v.onevent.apply(this,arguments))}}if(o=="onafterchanges"){const c=arguments;if(typeof u.plugins=="object"&&Object.entries(u.plugins).forEach(function([,h]){typeof h.persistence=="function"&&h.persistence(a,"setValue",{data:c[2]})}),a.options.persistence){const h=a.options.persistence==1?a.options.url:a.options.persistence,g=t.call(a,arguments[2]);n.call(a,h,g)}}return l};e.Z=s},456:function(r,e,t){t.d(e,{B4:function(){return o},aw:function(){return l},ql:function(){return a}});var n=t(992),s=t(366);const o=function(u){const c=this;if(c.options.filters){u=parseInt(u),c.resetSelection();let h=[];if(c.options.columns[u].type=="checkbox")h.push({id:"true",name:"True"}),h.push({id:"false",name:"False"});else{const m=[];let E=!1;for(let S=0;S<c.options.data.length;S++){const w=c.options.data[S][u],A=c.records[S][u].element.innerHTML;w&&A?m[w]=A:E=!0}const _=Object.keys(m);h=[];for(let S=0;S<_.length;S++)h.push({id:_[S],name:m[_[S]]});E&&h.push({value:"",id:"",name:"(Blanks)"})}const g=document.createElement("div");c.filter.children[u+1].innerHTML="",c.filter.children[u+1].appendChild(g),c.filter.children[u+1].style.paddingLeft="0px",c.filter.children[u+1].style.paddingRight="0px",c.filter.children[u+1].style.overflow="initial";const v={data:h,multiple:!0,autocomplete:!0,opened:!0,value:c.filters[u]!==void 0?c.filters[u]:null,width:"100%",position:c.options.tableOverflow==1||c.parent.config.fullscreen==1,onclose:function(m){l.call(c),c.filters[u]=m.dropdown.getValue(!0),c.filter.children[u+1].innerHTML=m.dropdown.getText(),c.filter.children[u+1].style.paddingLeft="",c.filter.children[u+1].style.paddingRight="",c.filter.children[u+1].style.overflow="",a.call(c,u),s.E.call(c)}};jSuites.dropdown(g,v)}else console.log("Jspreadsheet: filters not enabled.")},a=function(u){const c=this;if(!u)for(let v=0;v<c.filter.children.length;v++)c.filters[v]&&(u=v);const h=function(v,m,E){for(let _=0;_<v.length;_++){const S=""+c.options.data[E][m],w=""+c.records[E][m].element.innerHTML;if(v[_]==S||v[_]==w)return!0}return!1},g=c.filters[u];c.results=[];for(let v=0;v<c.options.data.length;v++)h(g,u,v)&&c.results.push(v);c.results.length||(c.results=null),n.cW.call(c)},l=function(){const u=this;if(u.options.filters)for(let c=0;c<u.filter.children.length;c++)u.filter.children[c].innerHTML="&nbsp;",u.filters[c]=null;u.results=null,n.cW.call(u)}},427:function(r,e,t){t.d(e,{i:function(){return s}});var n=t(992);const s=function(o){const a=this;if(o&&(a.options.footers=o),a.options.footers){a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot));for(let l=0;l<a.options.footers.length;l++){let u;if(a.tfoot.children[l])u=a.tfoot.children[l];else{u=document.createElement("tr");const c=document.createElement("td");u.appendChild(c),a.tfoot.appendChild(u)}for(let c=0;c<a.headers.length;c++){let h;if(a.options.footers[l][c]||(a.options.footers[l][c]=""),a.tfoot.children[l].children[c+1])h=a.tfoot.children[l].children[c+1];else{h=document.createElement("td"),u.appendChild(h);const g=a.options.columns[c].align||a.options.defaultColAlign||"center";h.style.textAlign=g}h.textContent=n.H2.call(a,+a.records.length+c,l,a.options.footers[l][c]),h.style.display=a.cols[c].colElement.style.display}}}}},157:function(r,e,t){t.d(e,{I:function(){return n}});const n=function(){const s=this;let o=0;if(s.options.freezeColumns>0)for(let a=0;a<s.options.freezeColumns;a++){let l;l=s.options.columns&&s.options.columns[a]&&s.options.columns[a].width!==void 0?parseInt(s.options.columns[a].width):s.options.defaultColWidth!==void 0?parseInt(s.options.defaultColWidth):100,o+=l}return o}},650:function(r,e,t){t.r(e),t.d(e,{createFromTable:function(){return g},getCaretIndex:function(){return s},getCellNameFromCoords:function(){return l},getColumnName:function(){return a},getCoordsFromCellName:function(){return u},getCoordsFromRange:function(){return c},invert:function(){return o},parseCSV:function(){return h}});var n=t(323);const s=function(v){let m;m=this.config.root?this.config.root:window;let E=0;const _=m.getSelection();if(_&&_.rangeCount!==0){const S=_.getRangeAt(0),w=S.cloneRange();w.selectNodeContents(v),w.setEnd(S.endContainer,S.endOffset),E=w.toString().length}return E},o=function(v){const m=[],E=Object.keys(v);for(let _=0;_<E.length;_++)m[v[E[_]]]=E[_];return m},a=function(v){let m="";return v>701?(m+=String.fromCharCode(64+parseInt(v/676)),m+=String.fromCharCode(64+parseInt(v%676/26))):v>25&&(m+=String.fromCharCode(64+parseInt(v/26))),m+=String.fromCharCode(65+v%26),m},l=function(v,m){return a(parseInt(v))+(parseInt(m)+1)},u=function(v){const m=/^[a-zA-Z]+/.exec(v);if(m){let E=0;for(let S=0;S<m[0].length;S++)E+=parseInt(m[0].charCodeAt(S)-64)*Math.pow(26,m[0].length-1-S);E--,E<0&&(E=0);let _=parseInt(/[0-9]+$/.exec(v))||null;return _>0&&_--,[E,_]}},c=function(v){const[m,E]=v.split(":");return[...u(m),...u(E)]},h=function(v,m){(v=v.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(v.length-1)==9&&(v+="\0"),m=m||",";const E=[];let _=!1;for(let S=0,w=0,A=0;A<v.length;A++){const O=v[A],D=v[A+1];E[S]=E[S]||[],E[S][w]=E[S][w]||"",O=='"'&&_&&D=='"'?(E[S][w]+=O,++A):O!='"'?O!=m||_?O!="\r"||D!=`
`||_?O==`
`&&!_||O=="\r"&&!_?(++S,w=0):E[S][w]+=O:(++S,w=0,++A):++w:_=!_}return E},g=function(v,m){if(v.tagName=="TABLE"){m||(m={}),m.columns=[],m.data=[];const E=v.querySelectorAll("colgroup > col");if(E.length)for(let K=0;K<E.length;K++){let se=E[K].style.width;se||(se=E[K].getAttribute("width")),se&&(m.columns[K]||(m.columns[K]={}),m.columns[K].width=se)}const _=function(K,se){let re=K.getBoundingClientRect();const Ce=re.width>50?re.width:50;m.columns[se]||(m.columns[se]={}),K.getAttribute("data-celltype")?m.columns[se].type=K.getAttribute("data-celltype"):m.columns[se].type="text",m.columns[se].width=Ce+"px",m.columns[se].title=K.innerHTML,K.style.textAlign&&(m.columns[se].align=K.style.textAlign),(re=K.getAttribute("name"))&&(m.columns[se].name=re),(re=K.getAttribute("id"))&&(m.columns[se].id=re),(re=K.getAttribute("data-mask"))&&(m.columns[se].mask=re)},S=[];let w=v.querySelectorAll(":scope > thead > tr");if(w.length){for(let K=0;K<w.length-1;K++){const se=[];for(let re=0;re<w[K].children.length;re++){const Ce={title:w[K].children[re].textContent,colspan:w[K].children[re].getAttribute("colspan")||1};se.push(Ce)}S.push(se)}w=w[w.length-1].children;for(let K=0;K<w.length;K++)_(w[K],K)}let A=0;const O={},D={},Y={},H={};let k=v.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let K=0;K<k.length;K++)if(m.data[A]=[],m.parseTableFirstRowAsHeader!=1||w.length||K!=0){for(let se=0;se<k[K].children.length;se++){let re=k[K].children[se].getAttribute("data-formula");re?re.substr(0,1)!="="&&(re="="+re):re=k[K].children[se].innerHTML,m.data[A].push(re);const Ce=(0,n.Ar)([se,K]),Le=k[K].children[se].getAttribute("class");Le&&(H[Ce]=Le);const he=parseInt(k[K].children[se].getAttribute("colspan"))||0,ve=parseInt(k[K].children[se].getAttribute("rowspan"))||0;(he||ve)&&(O[Ce]=[he||1,ve||1]),k[K].children[se].style&&k[K].children[se].style.display=="none"&&(k[K].children[se].style.display="");const xe=k[K].children[se].getAttribute("style");xe&&(Y[Ce]=xe),k[K].children[se].classList.contains("styleBold")&&(Y[Ce]?Y[Ce]+="; font-weight:bold;":Y[Ce]="font-weight:bold;")}k[K].style&&k[K].style.height&&(D[K]={height:k[K].style.height}),A++}else for(let se=0;se<k[K].children.length;se++)_(k[K].children[se],se);if(Object.keys(S).length>0&&(m.nestedHeaders=S),Object.keys(Y).length>0&&(m.style=Y),Object.keys(O).length>0&&(m.mergeCells=O),Object.keys(D).length>0&&(m.rows=D),Object.keys(H).length>0&&(m.classes=H),k=v.querySelectorAll("tfoot tr"),k.length){const K=[];for(let se=0;se<k.length;se++){let re=[];for(let Ce=0;Ce<k[se].children.length;Ce++)re.push(k[se].children[Ce].textContent);K.push(re)}Object.keys(K).length>0&&(m.footers=K)}if(m.parseTableAutoCellType==1){const K=[];for(let se=0;se<m.columns.length;se++){let re=!0,Ce=!0;K[se]=[];for(let he=0;he<m.data.length;he++){const ve=m.data[he][se];K[se][ve]||(K[se][ve]=0),K[se][ve]++,ve.length>25&&(re=!1),ve.length==10&&ve.substr(4,1)=="-"&&ve.substr(7,1)=="-"||(Ce=!1)}const Le=Object.keys(K[se]).length;Ce?m.columns[se].type="calendar":re==1&&Le>1&&Le<=parseInt(.1*m.data.length)&&(m.columns[se].type="dropdown",m.columns[se].source=Object.keys(K[se]))}}return m}console.log("Element is not a table")}},923:function(r,e,t){t.d(e,{JB:function(){return c},KX:function(){return m},Yw:function(){return v}});var n=t(100),s=t(323),o=t(992),a=t(49),l=t(54),u=t(366);const c=function(E){const _=this;if(_.ignoreHistory!=1){const S=++_.historyIndex;_.history=_.history=_.history.slice(0,S+1),_.history[S]=E}},h=function(E,_){const S=this,w=_.insertBefore?+_.rowNumber:_.rowNumber+1;if(S.options.search==1&&S.results&&S.results.length!=S.rows.length&&S.resetSearch(),E==1){const A=_.numOfRows;for(let O=w;O<A+w;O++)S.rows[O].element.parentNode.removeChild(S.rows[O].element);S.records.splice(w,A),S.options.data.splice(w,A),S.rows.splice(w,A),u.Uv.call(S,1,w,A+w-1)}else{S.records=(0,s.Wc)(S.records,w,_.rowRecords),S.options.data=(0,s.Wc)(S.options.data,w,_.rowData),S.rows=(0,s.Wc)(S.rows,w,_.rowNode);let A=0;for(let O=w;O<_.numOfRows+w;O++)S.tbody.insertBefore(_.rowNode[A].element,S.tbody.children[O]),A++}for(let A=w;A<S.rows.length;A++)S.rows[A].y=A;for(let A=w;A<S.records.length;A++)for(let O=0;O<S.records[A].length;O++)S.records[A][O].y=A;S.options.pagination>0&&S.page(S.pageNumber),o.ec.call(S)},g=function(E,_){const S=this,w=_.insertBefore?_.columnNumber:_.columnNumber+1;if(E==1){const A=_.numOfColumns;S.options.columns.splice(w,A);for(let O=w;O<A+w;O++)S.headers[O].parentNode.removeChild(S.headers[O]),S.cols[O].colElement.parentNode.removeChild(S.cols[O].colElement);S.headers.splice(w,A),S.cols.splice(w,A);for(let O=0;O<_.data.length;O++){for(let D=w;D<A+w;D++)S.records[O][D].element.parentNode.removeChild(S.records[O][D].element);S.records[O].splice(w,A),S.options.data[O].splice(w,A)}if(S.options.footers)for(let O=0;O<S.options.footers.length;O++)S.options.footers[O].splice(w,A)}else{S.options.columns=(0,s.Wc)(S.options.columns,w,_.columns),S.headers=(0,s.Wc)(S.headers,w,_.headers),S.cols=(0,s.Wc)(S.cols,w,_.cols);let A=0;for(let O=w;O<_.numOfColumns+w;O++)S.headerContainer.insertBefore(_.headers[A],S.headerContainer.children[O+1]),S.colgroupContainer.insertBefore(_.cols[A].colElement,S.colgroupContainer.children[O+1]),A++;for(let O=0;O<_.data.length;O++){S.options.data[O]=(0,s.Wc)(S.options.data[O],w,_.data[O]),S.records[O]=(0,s.Wc)(S.records[O],w,_.records[O]);let D=0;for(let Y=w;Y<_.numOfColumns+w;Y++)S.rows[O].element.insertBefore(_.records[O][D].element,S.rows[O].element.children[Y+1]),D++}if(S.options.footers)for(let O=0;O<S.options.footers.length;O++)S.options.footers[O]=(0,s.Wc)(S.options.footers[O],w,_.footers[O])}for(let A=w;A<S.cols.length;A++)S.cols[A].x=A;for(let A=0;A<S.records.length;A++)for(let O=w;O<S.records[A].length;O++)S.records[A][O].x=O;if(S.options.nestedHeaders&&S.options.nestedHeaders.length>0&&S.options.nestedHeaders[0]&&S.options.nestedHeaders[0][0])for(let A=0;A<S.options.nestedHeaders.length;A++){let O;O=E==1?parseInt(S.options.nestedHeaders[A][S.options.nestedHeaders[A].length-1].colspan)-_.numOfColumns:parseInt(S.options.nestedHeaders[A][S.options.nestedHeaders[A].length-1].colspan)+_.numOfColumns,S.options.nestedHeaders[A][S.options.nestedHeaders[A].length-1].colspan=O,S.thead.children[A].children[S.thead.children[A].children.length-1].setAttribute("colspan",O)}o.ec.call(S)},v=function(){const E=this,_=!!E.parent.ignoreEvents,S=!!E.ignoreHistory;E.parent.ignoreEvents=!0,E.ignoreHistory=!0;const w=[];let A;if(E.historyIndex>=0){if(A=E.history[E.historyIndex--],A.action=="insertRow")h.call(E,1,A);else if(A.action=="deleteRow")h.call(E,0,A);else if(A.action=="insertColumn")g.call(E,1,A);else if(A.action=="deleteColumn")g.call(E,0,A);else if(A.action=="moveRow")E.moveRow(A.newValue,A.oldValue);else if(A.action=="moveColumn")E.moveColumn(A.newValue,A.oldValue);else if(A.action=="setMerge")E.removeMerge(A.column,A.data);else if(A.action=="setStyle")E.setStyle(A.oldValue,null,null,1);else if(A.action=="setWidth")E.setWidth(A.column,A.oldValue);else if(A.action=="setHeight")E.setHeight(A.row,A.oldValue);else if(A.action=="setHeader")E.setHeader(A.column,A.oldValue);else if(A.action=="setComments")E.setComments(A.oldValue);else if(A.action=="orderBy"){let O=[];for(let D=0;D<A.rows.length;D++)O[A.rows[D]]=D;l.SV.call(E,A.column,A.order?0:1),l.Cs.call(E,O)}else if(A.action=="setValue"){for(let O=0;O<A.records.length;O++)w.push({x:A.records[O].x,y:A.records[O].y,value:A.records[O].oldValue}),A.oldStyle&&E.resetStyle(A.oldStyle);E.setValue(w),A.selection&&E.updateSelectionFromCoords(A.selection[0],A.selection[1],A.selection[2],A.selection[3])}}E.parent.ignoreEvents=_,E.ignoreHistory=S,n.Z.call(E,"onundo",E,A)},m=function(){const E=this,_=!!E.parent.ignoreEvents,S=!!E.ignoreHistory;let w;if(E.parent.ignoreEvents=!0,E.ignoreHistory=!0,E.historyIndex<E.history.length-1){if(w=E.history[++E.historyIndex],w.action=="insertRow")h.call(E,0,w);else if(w.action=="deleteRow")h.call(E,1,w);else if(w.action=="insertColumn")g.call(E,0,w);else if(w.action=="deleteColumn")g.call(E,1,w);else if(w.action=="moveRow")E.moveRow(w.oldValue,w.newValue);else if(w.action=="moveColumn")E.moveColumn(w.oldValue,w.newValue);else if(w.action=="setMerge")a.mt.call(E,w.column,w.colspan,w.rowspan,1);else if(w.action=="setStyle")E.setStyle(w.newValue,null,null,1);else if(w.action=="setWidth")E.setWidth(w.column,w.newValue);else if(w.action=="setHeight")E.setHeight(w.row,w.newValue);else if(w.action=="setHeader")E.setHeader(w.column,w.newValue);else if(w.action=="setComments")E.setComments(w.newValue);else if(w.action=="orderBy")l.SV.call(E,w.column,w.order),l.Cs.call(E,w.rows);else if(w.action=="setValue"){E.setValue(w.records);for(let A=0;A<w.records.length;A++)w.oldStyle&&E.resetStyle(w.newStyle);w.selection&&E.updateSelectionFromCoords(w.selection[0],w.selection[1],w.selection[2],w.selection[3])}}E.parent.ignoreEvents=_,E.ignoreHistory=S,n.Z.call(E,"onredo",E,w)}},992:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$S:function(){return getCell},E2:function(){return updateFormula},Gr:function(){return fullscreen},H2:function(){return parseValue},Hf:function(){return getWorksheetInstance},Of:function(){return updateScroll},Sl:function(){return getCellFromCoords},T0:function(){return updateTable},TO:function(){return hideIndex},UI:function(){return showIndex},UQ:function(){return createNestedHeader},Vi:function(){return getMask},X0:function(){return getWorksheetActive},Zz:function(){return updateFormulaChain},cW:function(){return updateResult},ec:function(){return updateTableReferences},id:function(){return getLabel},jr:function(){return isFormula},kE:function(){return createCell},pX:function(){return executeFormula},wW:function(){return updateCell}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(100),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(366),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(650),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(272),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(157),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(673),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(427),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(323);const updateTable=function(){const r=this;if(r.options.minSpareRows>0){let e=0;for(let t=r.rows.length-1;t>=0;t--){let n=!1;for(let s=0;s<r.headers.length;s++)r.options.data[t][s]&&(n=!0);if(n)break;e++}r.options.minSpareRows-e>0&&r.insertRow(r.options.minSpareRows-e)}if(r.options.minSpareCols>0){let e=0;for(let t=r.headers.length-1;t>=0;t--){let n=!1;for(let s=0;s<r.rows.length;s++)r.options.data[s][t]&&(n=!0);if(n)break;e++}r.options.minSpareCols-e>0&&r.insertColumn(r.options.minSpareCols-e)}r.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.i.call(r),setTimeout(function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(r)},0)},parseNumber=function(r,e){const t=e&&this.options.columns[e].decimal?this.options.columns[e].decimal:".";let n=""+r;return n=n.split(t),n[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&Number.isInteger(Number(n[0]))?n[1]?+(n[0]+"."+n[1]):+(n[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(r){for(let e=0;e<r.length;e++){const t=[],n=r[e].split(":"),s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n[0],!0),o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n[1],!0);let a,l,u,c;s[0]<=o[0]?(a=s[0],l=o[0]):(a=o[0],l=s[0]),s[1]<=o[1]?(u=s[1],c=o[1]):(u=o[1],c=s[1]);for(let h=u;h<=c;h++)for(let g=a;g<=l;g++)t.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([g,h]));expression=expression.replace(r[e],t.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const r=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(tokens[i],1);let e;if(e=obj.options.data[r[1]]!==void 0&&obj.options.data[r[1]][r[0]]!==void 0?obj.options.data[r[1]][r[0]]:"",(""+e).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?e=formulaResults[tokens[i]]:(e=execute(e,r[0],r[1]),formulaResults[tokens[i]]=e)),(""+e).trim()=="")formulaExpressions[tokens[i]]=null;else if(e==Number(e)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(e);else{const t=parseNumber.call(obj,e,r[0]);obj.parent.config.autoCasting!=0&&t?formulaExpressions[tokens[i]]=t:formulaExpressions[tokens[i]]='"'+e+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(r){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,r)}return res}};return execute(expression,x,y)},parseValue=function(r,e,t,n){const s=this;(""+t).substr(0,1)=="="&&s.parent.config.parseFormulas!=0&&(t=executeFormula.call(s,t,r,e));const o=s.options.columns&&s.options.columns[r];if(o&&!isFormula(t)){let a=null;if(a=getMask(o)){t&&t==Number(t)&&(t=Number(t));let l=jSuites.mask.render(t,a,!0);if(n&&a.mask){const u=a.mask.split(";");u[1]&&(u[1].match(new RegExp("\\[Red\\]","gi"))&&(t<0?n.classList.add("red"):n.classList.remove("red")),u[1].match(new RegExp("\\(","gi"))&&t<0&&(l="("+l+")"))}l&&(t=l)}}return t},getDropDownValue=function(r,e){const t=this,n=[];if(t.options.columns&&t.options.columns[r]&&t.options.columns[r].source){const s=[],o=t.options.columns[r].source;for(let l=0;l<o.length;l++)typeof o[l]=="object"?s[o[l].id]=o[l].name:s[o[l]]=o[l];const a=Array.isArray(e)?e:(""+e).split(";");for(let l=0;l<a.length;l++)typeof a[l]=="object"?n.push(s[a[l].id]):s[a[l]]&&n.push(s[a[l]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},validDate=function(r){return(r=""+r).substr(4,1)=="-"&&r.substr(7,1)=="-"||(r=r.split("-"))[0].length==4&&r[0]==Number(r[0])&&r[1].length==2&&r[1]==Number(r[1])},stripScript=function(r){const e=new Option;e.innerHTML=r;let t=null;for(r=e.getElementsByTagName("script");t=r[0];)t.parentNode.removeChild(t);return e.innerHTML},createCell=function(r,e,t){const n=this;let s=document.createElement("td");if(s.setAttribute("data-x",r),s.setAttribute("data-y",e),(""+t).substr(0,1)=="="&&n.options.secureFormulas==1){const a=secureFormula(t);a!=t&&(t=a)}if(n.options.columns&&n.options.columns[r]&&typeof n.options.columns[r].type=="object")n.parent.config.parseHTML===!0?s.innerHTML=t:s.textContent=t,typeof n.options.columns[r].type.createCell=="function"&&n.options.columns[r].type.createCell(s,t,parseInt(r),parseInt(e),n,n.options.columns[r]);else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="hidden")s.style.display="none",s.textContent=t;else if(n.options.columns&&n.options.columns[r]&&(n.options.columns[r].type=="checkbox"||n.options.columns[r].type=="radio")){const a=document.createElement("input");a.type=n.options.columns[r].type,a.name="c"+r,a.checked=t==1||t==1||t=="true",a.onclick=function(){n.setValue(s,this.checked)},n.options.columns[r].readOnly!=1&&n.options.editable!=0||a.setAttribute("disabled","disabled"),s.appendChild(a),n.options.data[e][r]=a.checked}else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="calendar"){let a=null;if(!validDate(t)){const l=jSuites.calendar.extractDateFromString(t,n.options.columns[r].options&&n.options.columns[r].options.format||"YYYY-MM-DD");l&&(a=l)}s.textContent=jSuites.calendar.getDateString(a||t,n.options.columns[r].options&&n.options.columns[r].options.format)}else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="dropdown")s.classList.add("jss_dropdown"),s.textContent=getDropDownValue.call(n,r,t);else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="color")if(n.options.columns[r].render=="square"){const a=document.createElement("div");a.className="color",a.style.backgroundColor=t,s.appendChild(a)}else s.style.color=t,s.textContent=t;else if(n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="image"){if(t&&t.substr(0,10)=="data:image"){const a=document.createElement("img");a.src=t,s.appendChild(a)}}else n.options.columns&&n.options.columns[r]&&n.options.columns[r].type=="html"||n.parent.config.parseHTML===!0?s.innerHTML=stripScript(parseValue.call(this,r,e,t,s)):s.textContent=parseValue.call(this,r,e,t,s);n.options.columns&&n.options.columns[r]&&n.options.columns[r].readOnly==1&&(s.className="readonly");const o=n.options.columns&&n.options.columns[r]&&n.options.columns[r].align||n.options.defaultColAlign||"center";return s.style.textAlign=o,n.options.columns&&n.options.columns[r]&&n.options.columns[r].wordWrap==0||!(n.options.wordWrap==1||n.options.columns&&n.options.columns[r]&&n.options.columns[r].wordWrap==1||s.innerHTML.length>200)||(s.style.whiteSpace="pre-wrap"),r>0&&this.options.textOverflow==1&&(t||s.innerHTML?n.records[e][r-1].element.style.overflow="hidden":r==n.options.columns.length-1&&(s.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(n,"oncreatecell",n,s,r,e,t),s},updateCell=function(r,e,t,n){const s=this;let o;if(s.records[e][r].element.classList.contains("readonly")!=1||n){if((""+t).substr(0,1)=="="&&s.options.secureFormulas==1){const u=secureFormula(t);u!=t&&(t=u)}const a=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(s,"onbeforechange",s,s.records[e][r].element,r,e,t);if(a!=null&&(t=a),s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].type=="object"&&typeof s.options.columns[r].type.updateCell=="function"){const u=s.options.columns[r].type.updateCell(s.records[e][r].element,t,parseInt(r),parseInt(e),s,s.options.columns[r]);u!==void 0&&(t=u)}o={x:r,y:e,col:r,row:e,value:t,oldValue:s.options.data[e][r]};let l=s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].type=="object"?s.options.columns[r].type:null;if(l)s.options.data[e][r]=t,typeof l.setValue=="function"&&l.setValue(s.records[e][r].element,t);else if(s.options.columns&&s.options.columns[r]&&(s.options.columns[r].type=="checkbox"||s.options.columns[r].type=="radio")){if(s.options.columns[r].type=="radio")for(let u=0;u<s.options.data.length;u++)s.options.data[u][r]=!1;s.records[e][r].element.children[0].checked=t==1||t==1||t=="true"||t=="TRUE",s.options.data[e][r]=s.records[e][r].element.children[0].checked}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="dropdown")s.options.data[e][r]=t,s.records[e][r].element.textContent=getDropDownValue.call(s,r,t);else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="calendar"){let u=null;if(!validDate(t)){const c=jSuites.calendar.extractDateFromString(t,s.options.columns[r].options&&s.options.columns[r].options.format||"YYYY-MM-DD");c&&(u=c)}s.options.data[e][r]=t,s.records[e][r].element.textContent=jSuites.calendar.getDateString(u||t,s.options.columns[r].options&&s.options.columns[r].options.format)}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="color")if(s.options.data[e][r]=t,s.options.columns[r].render=="square"){const u=document.createElement("div");u.className="color",u.style.backgroundColor=t,s.records[e][r].element.textContent="",s.records[e][r].element.appendChild(u)}else s.records[e][r].element.style.color=t,s.records[e][r].element.textContent=t;else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="image"){if(t=""+t,s.options.data[e][r]=t,s.records[e][r].element.innerHTML="",t&&t.substr(0,10)=="data:image"){const u=document.createElement("img");u.src=t,s.records[e][r].element.appendChild(u)}}else s.options.data[e][r]=t,s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="html"?s.records[e][r].element.innerHTML=stripScript(parseValue.call(s,r,e,t)):s.parent.config.parseHTML===!0?s.records[e][r].element.innerHTML=stripScript(parseValue.call(s,r,e,t,s.records[e][r].element)):s.records[e][r].element.textContent=parseValue.call(s,r,e,t,s.records[e][r].element),s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==0||!(s.options.wordWrap==1||s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==1||s.records[e][r].element.innerHTML.length>200)?s.records[e][r].element.style.whiteSpace="":s.records[e][r].element.style.whiteSpace="pre-wrap";r>0&&(s.records[e][r-1].element.style.overflow=t?"hidden":""),s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].render=="function"&&s.options.columns[r].render(s.records[e]&&s.records[e][r]?s.records[e][r].element:null,t,parseInt(r),parseInt(e),s,s.options.columns[r]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(s,"onchange",s,s.records[e]&&s.records[e][r]?s.records[e][r].element:null,r,e,t,o.oldValue)}else o={x:r,y:e,col:r,row:e};return o},isFormula=function(r){const e=(""+r)[0];return e=="="||e=="#"},getMask=function(r){if(r.format||r.mask||r.locale){const e={};return r.mask?e.mask=r.mask:r.format?e.mask=r.format:(e.locale=r.locale,e.options=r.options),r.decimal&&(e.options||(e.options={}),e.options={decimal:r.decimal}),e}return null},secureFormula=function(r){let e="",t=0;for(let n=0;n<r.length;n++)r[n]=='"'&&(t=t==0?1:0),e+=t==1?r[n]:r[n].toUpperCase();return e};let chainLoopProtection=[];const updateFormulaChain=function(r,e,t){const n=this,s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([r,e]);if(n.formula[s]&&n.formula[s].length>0)if(chainLoopProtection[s])n.records[e][r].element.innerHTML="#ERROR",n.formula[s]="";else{chainLoopProtection[s]=!0;for(let o=0;o<n.formula[s].length;o++){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(n.formula[s][o],!0),l=""+n.options.data[a[1]][a[0]];l.substr(0,1)=="="?t.push(updateCell.call(n,a[0],a[1],l,!0)):Object.keys(n.formula)[o]=null,updateFormulaChain.call(n,a[0],a[1],t)}}chainLoopProtection=[]},updateFormula=function(r,e){const t=/[A-Z]/,n=/[0-9]/;let s="",o=null,a=null,l="";for(let u=0;u<r.length;u++)t.exec(r[u])?(o=1,a=0,l+=r[u]):n.exec(r[u])?(a=o?1:0,l+=r[u]):(o&&a&&(l=e[l]?e[l]:l),s+=l,s+=r[u],o=0,a=0,l="");return l&&(o&&a&&(l=e[l]?e[l]:l),s+=l),s},updateFormulas=function(r){const e=this;for(let s=0;s<e.options.data.length;s++)for(let o=0;o<e.options.data[0].length;o++){const a=""+e.options.data[s][o];if(a.substr(0,1)=="="){const l=updateFormula(a,r);l!=a&&(e.options.data[s][o]=l)}}const t=[],n=Object.keys(e.formula);for(let s=0;s<n.length;s++){let o=n[s];const a=e.formula[o];r[o]&&(o=r[o]),t[o]=[];for(let l=0;l<a.length;l++){let u=a[l];r[u]&&(u=r[u]),t[o].push(u)}}e.formula=t},updateTableReferences=function(){const r=this;for(let o=0;o<r.headers.length;o++)r.headers[o].getAttribute("data-x")!=o&&(r.headers[o].setAttribute("data-x",o),r.headers[o].getAttribute("title")||(r.headers[o].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(o)));for(let o=0;o<r.rows.length;o++)r.rows[o]&&r.rows[o].element.getAttribute("data-y")!=o&&(r.rows[o].element.setAttribute("data-y",o),r.rows[o].element.children[0].setAttribute("data-y",o),r.rows[o].element.children[0].innerHTML=o+1);const e=[],t=[],n=function(o,a,l,u){if(o!=l&&r.records[u][l].element.setAttribute("data-x",l),a!=u&&r.records[u][l].element.setAttribute("data-y",u),o!=l||a!=u){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,a]),h=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([l,u]);e[c]=h}};for(let o=0;o<r.records.length;o++)for(let a=0;a<r.records[0].length;a++)if(r.records[o][a]){const l=r.records[o][a].element.getAttribute("data-x"),u=r.records[o][a].element.getAttribute("data-y");if(r.records[o][a].element.getAttribute("data-merged")){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([l,u]),h=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([a,o]);if(t[c]==null)if(c==h)t[c]=!1;else{const g=parseInt(a-l),v=parseInt(o-u);t[c]=[h,g,v]}}else n(l,u,a,o)}const s=Object.keys(t);if(s.length){for(let o=0;o<s.length;o++)if(t[s[o]]){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(s[o],!0);let l=a[0],u=a[1];n(l,u,l+t[s[o]][1],u+t[s[o]][2]);const c=s[o],h=t[s[o]][0];for(let g=0;g<r.options.mergeCells[c][2].length;g++)l=parseInt(r.options.mergeCells[c][2][g].getAttribute("data-x")),u=parseInt(r.options.mergeCells[c][2][g].getAttribute("data-y")),r.options.mergeCells[c][2][g].setAttribute("data-x",l+t[s[o]][1]),r.options.mergeCells[c][2][g].setAttribute("data-y",u+t[s[o]][2]);r.options.mergeCells[h]=r.options.mergeCells[c],delete r.options.mergeCells[c]}}updateFormulas.call(r,e),_meta_js__WEBPACK_IMPORTED_MODULE_5__.Lx.call(r,e),_selection_js__WEBPACK_IMPORTED_MODULE_1__.E.call(r),updateTable.call(r)},updateScroll=function(r){const e=this,t=e.content.getBoundingClientRect(),n=t.left,s=t.top,o=t.width,a=t.height,l=e.records[e.selectedCell[3]][e.selectedCell[2]].element.getBoundingClientRect(),u=l.left,c=l.top,h=l.width,g=l.height;let v,m;r==0||r==1?(v=u-n+e.content.scrollLeft,m=c-s+e.content.scrollTop-2):(v=u-n+e.content.scrollLeft+h,m=c-s+e.content.scrollTop+g),m>e.content.scrollTop+30&&m<e.content.scrollTop+a||(m<e.content.scrollTop+30?e.content.scrollTop=m-g:e.content.scrollTop=m-(a-2));const E=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.I.call(e);v>e.content.scrollLeft+E&&v<e.content.scrollLeft+o||(v<e.content.scrollLeft+30?(e.content.scrollLeft=v,e.content.scrollLeft<50&&(e.content.scrollLeft=0)):v<e.content.scrollLeft+E?e.content.scrollLeft=v-E-1:e.content.scrollLeft=v-(o-20))},updateResult=function(){const r=this;let e=0,t=0;for(e=r.options.lazyLoading==1?100:r.options.pagination>0?r.options.pagination:r.results?r.results.length:r.rows.length;r.tbody.firstChild;)r.tbody.removeChild(r.tbody.firstChild);for(let n=0;n<r.rows.length;n++)!r.results||r.results.indexOf(n)>-1?(t<e&&(r.tbody.appendChild(r.rows[n].element),t++),r.rows[n].element.style.display=""):r.rows[n].element.style.display="none";return r.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.Ik.call(r),_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(r),e},getCell=function(r,e){if(typeof r=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r,!0);r=t[0],e=t[1]}return this.records[e][r].element},getCellFromCoords=function(r,e){return this.records[e][r].element},getLabel=function(r,e){if(typeof r=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r,!0);r=t[0],e=t[1]}return this.records[e][r].element.innerHTML},fullscreen=function(r){const e=this;r==null&&(r=!e.config.fullscreen),e.config.fullscreen!=r&&(e.config.fullscreen=r,r==1?e.element.classList.add("fullscreen"):e.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(r){const e=this,t=document.createElement("tr");t.classList.add("jss_nested");const n=document.createElement("td");n.classList.add("jss_selectall"),t.appendChild(n),r.element=t;let s=0;for(let o=0;o<r.length;o++){r[o].colspan||(r[o].colspan=1),r[o].title||(r[o].title=""),r[o].id||(r[o].id="");let a=r[o].colspan;const l=[];for(let c=0;c<a;c++)e.options.columns[s]&&e.options.columns[s].type=="hidden"&&a++,l.push(s),s++;const u=document.createElement("td");u.setAttribute("data-column",l.join(",")),u.setAttribute("colspan",r[o].colspan),u.setAttribute("align",r[o].align||"center"),u.setAttribute("id",r[o].id),u.textContent=r[o].title,t.appendChild(u)}return t},getWorksheetActive=function(){const r=this.parent?this.parent:this;return r.element.tabs?r.element.tabs.getActive():0},getWorksheetInstance=function(r){const e=r!==void 0?r:getWorksheetActive.call(this);return this.worksheets[e]}},323:function(r,e,t){t.d(e,{Ar:function(){return a},Wc:function(){return s},qP:function(){return o}});var n=t(650);const s=function(l,u,c){if(u<=l.length)return l.slice(0,u).concat(c).concat(l.slice(u));const h=l.slice(0,l.length);for(;u>h.length;)h.push(void 0);return h.concat(c)},o=function(l,u){const c=/^[a-zA-Z]+/.exec(l);if(c){let h=0;for(let v=0;v<c[0].length;v++)h+=parseInt(c[0].charCodeAt(v)-64)*Math.pow(26,c[0].length-1-v);h--,h<0&&(h=0);let g=parseInt(/[0-9]+$/.exec(l));g>0&&g--,l=u==1?[h,g]:h+"-"+g}return l},a=function(l){return Array.isArray(l)||(l=l.split("-")),(0,n.getColumnName)(parseInt(l[0]))+(parseInt(l[1])+1)}},665:function(r,e,t){t.d(e,{Kw:function(){return o},VG:function(){return a},ij:function(){return n},iw:function(){return s}});const n=function(l){const u=this;let c;c=u.options.search!=1&&u.options.filters!=1||!u.results?u.rows:u.results;const h=100;l!=null&&l!=-1||(l=Math.ceil(c.length/h)-1);let g=l*h,v=l*h+h;v>c.length&&(v=c.length),g=v-100,g<0&&(g=0);for(let m=g;m<v;m++)u.options.search!=1&&u.options.filters!=1||!u.results?u.tbody.appendChild(u.rows[m].element):u.tbody.appendChild(u.rows[c[m]].element),u.tbody.children.length>h&&u.tbody.removeChild(u.tbody.firstChild)},s=function(){const l=this;if(l.selectedCell){const u=parseInt(l.tbody.firstChild.getAttribute("data-y"))/100,c=parseInt(l.selectedCell[3]/100),h=parseInt(l.rows.length/100);if(u!=c&&c<=h&&!Array.prototype.indexOf.call(l.tbody.children,l.rows[l.selectedCell[3]].element))return l.loadPage(c),!0}return!1},o=function(){const l=this;let u;u=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let c=0;if(u.length>100){let h=parseInt(l.tbody.firstChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(h=u.indexOf(h)),h>0)for(let g=0;g<30;g++)h-=1,h>-1&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.insertBefore(l.rows[h].element,l.tbody.firstChild):l.tbody.insertBefore(l.rows[u[h]].element,l.tbody.firstChild),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.lastChild),c=1))}return c},a=function(){const l=this;let u;u=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let c=0;if(u.length>100){let h=parseInt(l.tbody.lastChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(h=u.indexOf(h)),h<l.rows.length-1)for(let g=0;g<=30;g++)h<u.length&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.appendChild(l.rows[h].element):l.tbody.appendChild(l.rows[u[h]].element),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.firstChild),c=1)),h+=1}return c}},49:function(r,e,t){t.d(e,{D0:function(){return u},D8:function(){return h},Vg:function(){return v},mt:function(){return g},q4:function(){return c},tW:function(){return m}});var n=t(323),s=t(992),o=t(923),a=t(100),l=t(366);const u=function(E,_){const S=this,w=[];if(S.options.mergeCells){const A=Object.keys(S.options.mergeCells);for(let O=0;O<A.length;O++){const D=(0,n.qP)(A[O],!0),Y=S.options.mergeCells[A[O]][0],H=D[0],k=D[0]+(Y>1?Y-1:0);_==null?H<=E&&k>=E&&w.push(A[O]):_?H<E&&k>=E&&w.push(A[O]):H<=E&&k>E&&w.push(A[O])}}return w},c=function(E,_){const S=this,w=[];if(S.options.mergeCells){const A=Object.keys(S.options.mergeCells);for(let O=0;O<A.length;O++){const D=(0,n.qP)(A[O],!0),Y=S.options.mergeCells[A[O]][1],H=D[1],k=D[1]+(Y>1?Y-1:0);_==null?H<=E&&k>=E&&w.push(A[O]):_?H<E&&k>=E&&w.push(A[O]):H<=E&&k>E&&w.push(A[O])}}return w},h=function(E){const _=this;let S={};if(E)S=_.options.mergeCells&&_.options.mergeCells[E]?[_.options.mergeCells[E][0],_.options.mergeCells[E][1]]:null;else if(_.options.mergeCells){_.options.mergeCells;const w=Object.keys(_.options.mergeCells);for(let A=0;A<w.length;A++)S[w[A]]=[_.options.mergeCells[w[A]][0],_.options.mergeCells[w[A]][1]]}return S},g=function(E,_,S,w){const A=this;let O=!1;if(E){if(typeof E!="string")return null}else{if(!A.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const Y=parseInt(A.highlighted[0].getAttribute("data-x")),H=parseInt(A.highlighted[0].getAttribute("data-y")),k=parseInt(A.highlighted[A.highlighted.length-1].getAttribute("data-x")),K=parseInt(A.highlighted[A.highlighted.length-1].getAttribute("data-y"));E=(0,n.Ar)([Y,H]),_=k-Y+1,S=K-H+1}}const D=(0,n.qP)(E,!0);if(A.options.mergeCells&&A.options.mergeCells[E])A.records[D[1]][D[0]].element.getAttribute("data-merged")&&(O="Cell already merged");else if((!_||_<2)&&(!S||S<2))O="Invalid merged properties";else for(let Y=D[1];Y<D[1]+S;Y++)for(let H=D[0];H<D[0]+_;H++)(0,n.Ar)([H,Y]),A.records[Y][H].element.getAttribute("data-merged")&&(O="There is a conflict with another merged cell");if(O)alert(jSuites.translate(O));else{_>1?A.records[D[1]][D[0]].element.setAttribute("colspan",_):_=1,S>1?A.records[D[1]][D[0]].element.setAttribute("rowspan",S):S=1,A.options.mergeCells||(A.options.mergeCells={}),A.options.mergeCells[E]=[_,S,[]],A.records[D[1]][D[0]].element.setAttribute("data-merged","true"),A.records[D[1]][D[0]].element.style.overflow="hidden";const Y=[];for(let H=D[1];H<D[1]+S;H++)for(let k=D[0];k<D[0]+_;k++)D[0]==k&&D[1]==H||(Y.push(A.options.data[H][k]),s.wW.call(A,k,H,"",!0),A.options.mergeCells[E][2].push(A.records[H][k].element),A.records[H][k].element.style.display="none",A.records[H][k].element=A.records[D[1]][D[0]].element);l.e3.call(A,A.records[D[1]][D[0]].element),w||(o.JB.call(A,{action:"setMerge",column:E,colspan:_,rowspan:S,data:Y}),a.Z.call(A,"onmerge",A,{[E]:[_,S]}))}},v=function(E,_,S){const w=this;if(w.options.mergeCells&&w.options.mergeCells[E]){const A=(0,n.qP)(E,!0);w.records[A[1]][A[0]].element.removeAttribute("colspan"),w.records[A[1]][A[0]].element.removeAttribute("rowspan"),w.records[A[1]][A[0]].element.removeAttribute("data-merged");const O=w.options.mergeCells[E];let D,Y,H=0;for(D=0;D<O[1];D++)for(Y=0;Y<O[0];Y++)(D>0||Y>0)&&(w.records[A[1]+D][A[0]+Y].element=O[2][H],w.records[A[1]+D][A[0]+Y].element.style.display="",_&&_[H]&&s.wW.call(w,A[0]+Y,A[1]+D,_[H]),H++);l.e3.call(w,w.records[A[1]][A[0]].element,w.records[A[1]+D-1][A[0]+Y-1].element),S||delete w.options.mergeCells[E]}},m=function(E){const _=this;if(_.options.mergeCells){_.options.mergeCells;const S=Object.keys(_.options.mergeCells);for(let w=0;w<S.length;w++)v.call(_,S[w],null,E)}}},272:function(r,e,t){t.d(e,{Lx:function(){return o},US:function(){return a},xZ:function(){return s}});var n=t(100);const s=function(l,u){const c=this;return l?u?c.options.meta&&c.options.meta[l]&&c.options.meta[l][u]?c.options.meta[l][u]:null:c.options.meta&&c.options.meta[l]?c.options.meta[l]:null:c.options.meta},o=function(l){const u=this;if(u.options.meta){const c={},h=Object.keys(u.options.meta);for(let g=0;g<h.length;g++)l[h[g]]?c[l[h[g]]]=u.options.meta[h[g]]:c[h[g]]=u.options.meta[h[g]];u.options.meta=c}},a=function(l,u,c){const h=this;if(h.options.meta||(h.options.meta={}),u&&c)h.options.meta[l]||(h.options.meta[l]={}),h.options.meta[l][u]=c,n.Z.call(h,"onchangemeta",h,{[l]:{[u]:c}});else{const g=Object.keys(l);for(let v=0;v<g.length;v++){h.options.meta[g[v]]||(h.options.meta[g[v]]={});const m=Object.keys(l[g[v]]);for(let E=0;E<m.length;E++)h.options.meta[g[v]][m[E]]=l[g[v]][m[E]]}n.Z.call(h,"onchangemeta",h,l)}}},54:function(r,e,t){t.d(e,{Cs:function(){return c},SV:function(){return u},Xo:function(){return h}});var n=t(923),s=t(100),o=t(992),a=t(665),l=t(456);const u=function(g,v){const m=this;for(let E=0;E<m.headers.length;E++)m.headers[E].classList.remove("arrow-up"),m.headers[E].classList.remove("arrow-down");v?m.headers[g].classList.add("arrow-up"):m.headers[g].classList.add("arrow-down")},c=function(g){const v=this;let m=[];for(let E=0;E<g.length;E++)m[E]=v.options.data[g[E]];v.options.data=m,m=[];for(let E=0;E<g.length;E++){m[E]=v.records[g[E]];for(let _=0;_<m[E].length;_++)m[E][_].y=E}v.records=m,m=[];for(let E=0;E<g.length;E++)m[E]=v.rows[g[E]],m[E].y=E;if(v.rows=m,o.ec.call(v),v.results&&v.results.length)v.searchInput.value?v.search(v.searchInput.value):l.ql.call(v);else if(v.results=null,v.pageNumber=0,v.options.pagination>0)v.page(0);else if(v.options.lazyLoading==1)a.ij.call(v,0);else for(let E=0;E<v.rows.length;E++)v.tbody.appendChild(v.rows[E].element)},h=function(g,v){const m=this;if(g>=0){if(m.options.mergeCells&&Object.keys(m.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;m.destroyMerge()}v=v==null?m.headers[g].classList.contains("arrow-down")?1:0:v?1:0;let E=[];if(m.options.columns&&m.options.columns[g]&&(m.options.columns[g].type=="number"||m.options.columns[g].type=="numeric"||m.options.columns[g].type=="percentage"||m.options.columns[g].type=="autonumber"||m.options.columns[g].type=="color"))for(let S=0;S<m.options.data.length;S++)E[S]=[S,Number(m.options.data[S][g])];else if(m.options.columns&&m.options.columns[g]&&(m.options.columns[g].type=="calendar"||m.options.columns[g].type=="checkbox"||m.options.columns[g].type=="radio"))for(let S=0;S<m.options.data.length;S++)E[S]=[S,m.options.data[S][g]];else for(let S=0;S<m.options.data.length;S++)E[S]=[S,m.records[S][g].element.textContent.toLowerCase()];typeof m.parent.config.sorting!="function"&&(m.parent.config.sorting=function(S){return function(w,A){const O=w[1],D=A[1];return S?O===""&&D!==""?1:O!==""&&D===""||O>D?-1:O<D?1:0:O===""&&D!==""?1:O!==""&&D===""?-1:O>D?1:O<D?-1:0}}),E=E.sort(m.parent.config.sorting(v));const _=[];for(let S=0;S<E.length;S++)_[S]=E[S][0];return n.JB.call(m,{action:"orderBy",rows:_,column:g,order:v}),u.call(m,g,v),c.call(m,_),s.Z.call(m,"onsort",m,g,v,_.map(S=>S)),!0}}},673:function(r,e,t){t.d(e,{Ik:function(){return a},Md:function(){return l},an:function(){return o},ur:function(){return u}});var n=t(100),s=t(366);const o=function(c){const h=this;return h.options.search!=1&&h.options.filters!=1||!h.results||(c=h.results.indexOf(c)),Math.ceil((parseInt(c)+1)/parseInt(h.options.pagination))-1},a=function(){const c=this;if(c.pagination.children[0].innerHTML="",c.pagination.children[1].innerHTML="",c.options.pagination){let h;if(h=c.options.search!=1&&c.options.filters!=1||!c.results?c.rows.length:c.results.length,h){const g=Math.ceil(h/c.options.pagination);let v,m;if(c.pageNumber<6?(v=1,m=g<10?g:10):g-c.pageNumber<5?(v=g-9,m=g,v<1&&(v=1)):(v=c.pageNumber-4,m=c.pageNumber+5),v>1){const _=document.createElement("div");_.className="jss_page",_.innerHTML="<",_.title=1,c.pagination.children[1].appendChild(_)}for(let _=v;_<=m;_++){const S=document.createElement("div");S.className="jss_page",S.innerHTML=_,c.pagination.children[1].appendChild(S),c.pageNumber==_-1&&S.classList.add("jss_page_selected")}if(m<g){const _=document.createElement("div");_.className="jss_page",_.innerHTML=">",_.title=g,c.pagination.children[1].appendChild(_)}const E=function(_){const S=Array.prototype.slice.call(arguments,1);return _.replace(/{(\d+)}/g,function(w,A){return S[A]!==void 0?S[A]:w})};c.pagination.children[0].innerHTML=E(jSuites.translate("Showing page {0} of {1} entries"),c.pageNumber+1,g)}else c.pagination.children[0].innerHTML=jSuites.translate("No records found")}},l=function(c){const h=this,g=h.pageNumber;let v;v=h.options.search!=1&&h.options.filters!=1||!h.results?h.rows:h.results;const m=parseInt(h.options.pagination);c!=null&&c!=-1||(c=Math.ceil(v.length/m)-1),h.pageNumber=c;let E=c*m,_=c*m+m;for(_>v.length&&(_=v.length),E<0&&(E=0);h.tbody.firstChild;)h.tbody.removeChild(h.tbody.firstChild);for(let S=E;S<_;S++)h.options.search!=1&&h.options.filters!=1||!h.results?h.tbody.appendChild(h.rows[S].element):h.tbody.appendChild(h.rows[v[S]].element);h.options.pagination>0&&a.call(h),s.x8.call(h),n.Z.call(h,"onchangepage",h,c,g,h.options.pagination)},u=function(){const c=this;let h;return h=c.options.search!=1&&c.options.filters!=1||!c.results?c.rows.length:c.results.length,Math.ceil(h/c.options.pagination)}},366:function(r,e,t){t.d(e,{E:function(){return S},Es:function(){return E},F1:function(){return O},H7:function(){return _},Mf:function(){return K},Mt:function(){return w},Uv:function(){return Y},VD:function(){return Le},VL:function(){return Ce},Ym:function(){return H},e3:function(){return v},ey:function(){return se},rx:function(){return re},td:function(){return k},vn:function(){return m},vp:function(){return D},x8:function(){return h},yE:function(){return g}});var n=t(100),s=t(157),o=t(650),a=t(923),l=t(992),u=t(323),c=t(898);const h=function(){const he=this;if(he.highlighted&&he.highlighted.length){const ve=he.highlighted[he.highlighted.length-1].element,xe=ve.getAttribute("data-x"),Ie=he.content.getBoundingClientRect(),we=Ie.left,Ne=Ie.top,at=ve.getBoundingClientRect(),nt=at.left,B=at.top,te=at.width,V=at.height,ue=nt-we+he.content.scrollLeft+te-4,Ae=B-Ne+he.content.scrollTop+V-4;if(he.corner.style.top=Ae+"px",he.corner.style.left=ue+"px",he.options.freezeColumns){const Ve=s.I.call(he);xe>he.options.freezeColumns-1&&nt-we+te<Ve?he.corner.style.display="none":he.options.selectionCopy!=0&&(he.corner.style.display="")}else he.options.selectionCopy!=0&&(he.corner.style.display="")}else he.corner.style.top="-2000px",he.corner.style.left="-2000px";(0,c.yf)(he)},g=function(he){const ve=this;let xe;if(ve.highlighted&&ve.highlighted.length){xe=1;for(let Ie=0;Ie<ve.highlighted.length;Ie++){ve.highlighted[Ie].element.classList.remove("highlight"),ve.highlighted[Ie].element.classList.remove("highlight-left"),ve.highlighted[Ie].element.classList.remove("highlight-right"),ve.highlighted[Ie].element.classList.remove("highlight-top"),ve.highlighted[Ie].element.classList.remove("highlight-bottom"),ve.highlighted[Ie].element.classList.remove("highlight-selected");const we=parseInt(ve.highlighted[Ie].element.getAttribute("data-x")),Ne=parseInt(ve.highlighted[Ie].element.getAttribute("data-y"));let at,nt;if(ve.highlighted[Ie].element.getAttribute("data-merged")){const B=parseInt(ve.highlighted[Ie].element.getAttribute("colspan")),te=parseInt(ve.highlighted[Ie].element.getAttribute("rowspan"));at=B>0?we+(B-1):we,nt=te>0?Ne+(te-1):Ne}else at=we,nt=Ne;for(let B=we;B<=at;B++)ve.headers[B]&&ve.headers[B].classList.remove("selected");for(let B=Ne;B<=nt;B++)ve.rows[B]&&ve.rows[B].element.classList.remove("selected")}}else xe=0;return ve.highlighted=[],ve.selectedCell=null,ve.corner.style.top="-2000px",ve.corner.style.left="-2000px",he==1&&xe==1&&n.Z.call(ve,"onblur",ve),xe},v=function(he,ve,xe){const Ie=he.getAttribute("data-x"),we=he.getAttribute("data-y");let Ne,at;ve?(Ne=ve.getAttribute("data-x"),at=ve.getAttribute("data-y")):(Ne=Ie,at=we),E.call(this,Ie,we,Ne,at,xe)},m=function(){const he=document.querySelectorAll(".jss_worksheet .copying");for(let ve=0;ve<he.length;ve++)he[ve].classList.remove("copying"),he[ve].classList.remove("copying-left"),he[ve].classList.remove("copying-right"),he[ve].classList.remove("copying-top"),he[ve].classList.remove("copying-bottom")},E=function(he,ve,xe,Ie,we){const Ne=this;if(ve==null){if(ve=0,Ie=Ne.rows.length-1,he==null)return}else he==null&&(he=0,xe=Ne.options.data[0].length-1);xe==null&&(xe=he),Ie==null&&(Ie=ve),he>=Ne.headers.length&&(he=Ne.headers.length-1),ve>=Ne.rows.length&&(ve=Ne.rows.length-1),xe>=Ne.headers.length&&(xe=Ne.headers.length-1),Ie>=Ne.rows.length&&(Ie=Ne.rows.length-1);let at,nt,B,te,V=null,ue=null,Ae=null,Ve=null;parseInt(he)<parseInt(xe)?(at=parseInt(he),nt=parseInt(xe)):(at=parseInt(xe),nt=parseInt(he)),parseInt(ve)<parseInt(Ie)?(B=parseInt(ve),te=parseInt(Ie)):(B=parseInt(Ie),te=parseInt(ve));for(let be=at;be<=nt;be++)for(let qe=B;qe<=te;qe++)if(Ne.records[qe][be]&&Ne.records[qe][be].element.getAttribute("data-merged")){const le=parseInt(Ne.records[qe][be].element.getAttribute("data-x")),pe=parseInt(Ne.records[qe][be].element.getAttribute("data-y")),Se=parseInt(Ne.records[qe][be].element.getAttribute("colspan")),Ye=parseInt(Ne.records[qe][be].element.getAttribute("rowspan"));Se>1&&(le<at&&(at=le),le+Se>nt&&(nt=le+Se-1)),Ye&&(pe<B&&(B=pe),pe+Ye>te&&(te=pe+Ye-1))}for(let be=B;be<=te;be++)Ne.rows[be].element.style.display!="none"&&(Ae==null&&(Ae=be),Ve=be);for(let be=at;be<=nt;be++)for(let qe=B;qe<=te;qe++)Ne.options.columns&&Ne.options.columns[be]&&Ne.options.columns[be].type=="hidden"||(V==null&&(V=be),ue=be);if(V||(V=0),ue||(ue=0),n.Z.call(Ne,"onbeforeselection",Ne,V,Ae,ue,Ve,we)===!1)return!1;const He=Ne.resetSelection();Ne.selectedCell=[he,ve,xe,Ie],Ne.records[ve][he]&&Ne.records[ve][he].element.classList.add("highlight-selected");for(let be=at;be<=nt;be++)for(let qe=B;qe<=te;qe++)Ne.rows[qe].element.style.display!="none"&&Ne.records[qe][be].element.style.display!="none"&&(Ne.records[qe][be].element.classList.add("highlight"),Ne.highlighted.push(Ne.records[qe][be]));for(let be=V;be<=ue;be++)Ne.options.columns&&Ne.options.columns[be]&&Ne.options.columns[be].type=="hidden"||!Ne.cols[be].colElement.style||Ne.cols[be].colElement.style.display=="none"||(Ne.records[Ae]&&Ne.records[Ae][be]&&Ne.records[Ae][be].element.classList.add("highlight-top"),Ne.records[Ve]&&Ne.records[Ve][be]&&Ne.records[Ve][be].element.classList.add("highlight-bottom"),Ne.headers[be].classList.add("selected"));for(let be=Ae;be<=Ve;be++)Ne.rows[be]&&Ne.rows[be].element.style.display!="none"&&(Ne.records[be][V].element.classList.add("highlight-left"),Ne.records[be][ue].element.classList.add("highlight-right"),Ne.rows[be].element.classList.add("selected"));Ne.selectedContainer=[V,Ae,ue,Ve],He==0&&(n.Z.call(Ne,"onfocus",Ne),m()),n.Z.call(Ne,"onselection",Ne,V,Ae,ue,Ve,we),h.call(Ne)},_=function(he){const ve=this;if(!ve.selectedCell)return[];const xe=[];for(let Ie=Math.min(ve.selectedCell[0],ve.selectedCell[2]);Ie<=Math.max(ve.selectedCell[0],ve.selectedCell[2]);Ie++)he&&ve.headers[Ie].style.display=="none"||xe.push(Ie);return xe},S=function(){const he=this;he.selectedCell&&he.updateSelectionFromCoords(he.selectedCell[0],he.selectedCell[1],he.selectedCell[2],he.selectedCell[3])},w=function(){const he=this;for(let ve=0;ve<he.selection.length;ve++)he.selection[ve].classList.remove("selection"),he.selection[ve].classList.remove("selection-left"),he.selection[ve].classList.remove("selection-right"),he.selection[ve].classList.remove("selection-top"),he.selection[ve].classList.remove("selection-bottom");he.selection=[]},A=function(he){return(he=""+he).length==1&&(he="0"+he),he},O=function(he,ve){const xe=this,Ie=xe.getData(!0,!0),we=xe.selectedContainer,Ne=parseInt(he.getAttribute("data-x")),at=parseInt(he.getAttribute("data-y")),nt=parseInt(ve.getAttribute("data-x")),B=parseInt(ve.getAttribute("data-y")),te=[];let V,ue,Ae=!1;we[0]==Ne?(V=at<we[1]?at-we[1]:1,ue=0):(ue=Ne<we[0]?Ne-we[0]:1,V=0);let Ve=0,He=0;for(let qe=at;qe<=B;qe++)if(!xe.rows[qe]||xe.rows[qe].element.style.display!="none"){Ie[He]==null&&(He=0),Ve=0,we[0]!=Ne&&(ue=Ne<we[0]?Ne-we[0]:1);for(let le=Ne;le<=nt;le++){if(xe.records[qe][le]&&!xe.records[qe][le].element.classList.contains("readonly")&&xe.records[qe][le].element.style.display!="none"&&Ae==0){if(!xe.selection.length&&xe.options.data[qe][le]!=""){Ae=!0;continue}(Ie[He]==null||Ie[He][Ve]==null)&&(Ve=0);let pe=Ie[He][Ve];if(pe&&!Ie[1]&&xe.parent.config.autoIncrement!=0)if(!xe.options.columns||!xe.options.columns[le]||xe.options.columns[le].type&&xe.options.columns[le].type!="text"&&xe.options.columns[le].type!="number"){if(xe.options.columns&&xe.options.columns[le]&&xe.options.columns[le].type=="calendar"){const Se=new Date(pe);Se.setDate(Se.getDate()+V),pe=Se.getFullYear()+"-"+A(parseInt(Se.getMonth()+1))+"-"+A(Se.getDate())+" 00:00:00"}}else if((""+pe).substr(0,1)=="="){const Se=pe.match(/([A-Z]+[0-9]+)/g);if(Se){const Ye=[];for(let Fe=0;Fe<Se.length;Fe++){const je=(0,u.qP)(Se[Fe],1);je[0]+=ue,je[1]+=V,je[1]<0&&(je[1]=0);const rt=(0,u.Ar)([je[0],je[1]]);rt!=Se[Fe]&&(Ye[Se[Fe]]=rt)}pe=(0,l.E2)(pe,Ye)}}else pe==Number(pe)&&(pe=Number(pe)+V);te.push(l.wW.call(xe,le,qe,pe)),l.Zz.call(xe,le,qe,te)}Ve++,we[0]!=Ne&&ue++}He++,V++}a.JB.call(xe,{action:"setValue",records:te,selection:xe.selectedCell}),l.T0.call(xe);const be=te.map(function(qe){return{x:qe.x,y:qe.y,value:qe.newValue,oldValue:qe.oldValue}});n.Z.call(xe,"onafterchanges",xe,be)},D=function(he){let ve,xe,Ie=0;if(he.length===0)return Ie;for(ve=0;ve<he.length;ve++)xe=he.charCodeAt(ve),Ie=(Ie<<5)-Ie+xe,Ie|=0;return Ie},Y=function(he,ve,xe){const Ie=this;if(he==1){if(Ie.selectedCell&&(ve>=Ie.selectedCell[1]&&ve<=Ie.selectedCell[3]||xe>=Ie.selectedCell[1]&&xe<=Ie.selectedCell[3]))return void Ie.resetSelection()}else if(Ie.selectedCell&&(ve>=Ie.selectedCell[0]&&ve<=Ie.selectedCell[2]||xe>=Ie.selectedCell[0]&&xe<=Ie.selectedCell[2]))return void Ie.resetSelection()},H=function(he){const ve=this;if(!ve.selectedCell)return[];const xe=[];for(let Ie=Math.min(ve.selectedCell[1],ve.selectedCell[3]);Ie<=Math.max(ve.selectedCell[1],ve.selectedCell[3]);Ie++)he&&ve.rows[Ie].element.style.display=="none"||xe.push(Ie);return xe},k=function(){const he=this;he.selectedCell||(he.selectedCell=[]),he.selectedCell[0]=0,he.selectedCell[1]=0,he.selectedCell[2]=he.headers.length-1,he.selectedCell[3]=he.records.length-1,he.updateSelectionFromCoords(he.selectedCell[0],he.selectedCell[1],he.selectedCell[2],he.selectedCell[3])},K=function(){const he=this;return he.selectedCell?[Math.min(he.selectedCell[0],he.selectedCell[2]),Math.min(he.selectedCell[1],he.selectedCell[3]),Math.max(he.selectedCell[0],he.selectedCell[2]),Math.max(he.selectedCell[1],he.selectedCell[3])]:null},se=function(he){const ve=this,xe=K.call(ve);if(!xe)return[];const Ie=[];for(let we=xe[1];we<=xe[3];we++)for(let Ne=xe[0];Ne<=xe[2];Ne++)he?Ie.push((0,o.getCellNameFromCoords)(Ne,we)):Ie.push(ve.records[we][Ne]);return Ie},re=function(){const he=this,ve=K.call(he);if(!ve)return"";const xe=(0,o.getCellNameFromCoords)(ve[0],ve[1]),Ie=(0,o.getCellNameFromCoords)(ve[2],ve[3]);return xe===Ie?he.options.worksheetName+"!"+xe:he.options.worksheetName+"!"+xe+":"+Ie},Ce=function(he,ve){const xe=K.call(this);return he>=xe[0]&&he<=xe[2]&&ve>=xe[1]&&ve<=xe[3]},Le=function(){const he=K.call(this);return he?[he]:[]}},898:function(r,e,t){t.d(e,{bv:function(){return h},iu:function(){return g},yf:function(){return c}});var n=t(650),s=t(992);const o=function(v,m){m.options.editable!=0?v.classList.remove("jtoolbar-disabled"):v.classList.add("jtoolbar-disabled")},a=function(){const v=[],m=this,E=function(){return s.Hf.call(m)};v.push({content:"undo",onclick:function(){E().undo()}}),v.push({content:"redo",onclick:function(){E().redo()}}),v.push({content:"save",onclick:function(){const S=E();S&&S.download()}}),v.push({type:"divisor"}),v.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(S){return'<span style="font-family:'+S+'">'+S+"</span>"},onchange:function(S,w,A,O,D){const Y=E();let H=Y.getSelected(!0);if(H){let k=D?O:"";Y.setStyle(Object.fromEntries(H.map(function(K){return[K,"font-family: "+k]})))}},updateState:function(S,w,A){o(A,E())}}),v.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(S){return'<span style="font-size:'+S+'">'+S+"</span>"},onchange:function(S,w,A,O){const D=E();let Y=D.getSelected(!0);Y&&D.setStyle(Object.fromEntries(Y.map(function(H){return[H,"font-size: "+O]})))},updateState:function(S,w,A){o(A,E())}}),v.push({type:"select",options:["left","center","right","justify"],render:function(S){return'<i class="material-icons">format_align_'+S+"</i>"},onchange:function(S,w,A,O){const D=E();let Y=D.getSelected(!0);Y&&D.setStyle(Object.fromEntries(Y.map(function(H){return[H,"text-align: "+O]})))},updateState:function(S,w,A){o(A,E())}}),v.push({content:"format_bold",onclick:function(S,w,A){const O=E();let D=O.getSelected(!0);D&&O.setStyle(Object.fromEntries(D.map(function(Y){return[Y,"font-weight:bold"]})))},updateState:function(S,w,A){o(A,E())}}),v.push({type:"color",content:"format_color_text",k:"color",updateState:function(S,w,A){o(A,E())}}),v.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(S,w,A,O){o(A,E())}});let _=["top","middle","bottom"];return v.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(S){return'<i class="material-icons">'+S+"</i>"},value:1,onchange:function(S,w,A,O,D){const Y=E();let H=Y.getSelected(!0);H&&Y.setStyle(Object.fromEntries(H.map(function(k){return[k,"vertical-align: "+_[D]]})))},updateState:function(S,w,A){o(A,E())}}),v.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const S=E();if(S.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const w=[Math.min(S.selectedCell[0],S.selectedCell[2]),Math.min(S.selectedCell[1],S.selectedCell[3]),Math.max(S.selectedCell[0],S.selectedCell[2]),Math.max(S.selectedCell[1],S.selectedCell[3])];let A=(0,n.getCellNameFromCoords)(w[0],w[1]);if(S.records[w[1]][w[0]].element.getAttribute("data-merged"))S.removeMerge(A);else{let O=w[2]-w[0]+1,D=w[3]-w[1]+1;O===1&&D===1||S.setMerge(A,O,D)}}},updateState:function(S,w,A){o(A,E())}}),v.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(S){return'<i class="material-icons">'+S+"</i>"},right:!0,onchange:function(S,w,A,O){const D=E(),Y=[Math.min(D.selectedCell[0],D.selectedCell[2]),Math.min(D.selectedCell[1],D.selectedCell[3]),Math.max(D.selectedCell[0],D.selectedCell[2]),Math.max(D.selectedCell[1],D.selectedCell[3])];let H=O;{let k=w.thickness||1,K=w.color||"black";const se=w.style||"solid";se==="double"&&(k+=2);let re={},Ce=Y[0],Le=Y[1],he=Y[2],ve=Y[3];const xe=function(Ie,we,Ne){let at=["","","",""];at[0]=(H==="border_top"||H==="border_outer")&&Ne===Le||(H==="border_inner"||H==="border_horizontal")&&Ne>Le||H==="border_all"?"border-top: "+k+"px "+se+" "+K:"border-top: ",at[1]=H!=="border_all"&&H!=="border_right"&&H!=="border_outer"||we!==he?"border-right: ":"border-right: "+k+"px "+se+" "+K,at[2]=H!=="border_all"&&H!=="border_bottom"&&H!=="border_outer"||Ne!==ve?"border-bottom: ":"border-bottom: "+k+"px "+se+" "+K,at[3]=(H==="border_left"||H==="border_outer")&&we===Ce||(H==="border_inner"||H==="border_vertical")&&we>Ce||H==="border_all"?"border-left: "+k+"px "+se+" "+K:"border-left: ",re[Ie]=at.join(";")};for(let Ie=Y[1];Ie<=Y[3];Ie++)for(let we=Y[0];we<=Y[2];we++)xe((0,n.getCellNameFromCoords)(we,Ie),we,Ie),D.records[Ie][we].element.getAttribute("data-merged")&&xe((0,n.getCellNameFromCoords)(Y[0],Y[1]),we,Ie);Object.keys(re)&&D.setStyle(re)}},onload:function(S,w){let A=document.createElement("div"),O=document.createElement("div");A.appendChild(O);let D=jSuites.color(O,{closeOnChange:!1,onchange:function(k,K){k.parentNode.children[1].style.color=K,w.color=K}}),Y=document.createElement("i");Y.classList.add("material-icons"),Y.innerHTML="color_lens",Y.onclick=function(){D.open()},A.appendChild(Y),S.children[1].appendChild(A),O=document.createElement("div"),jSuites.picker(O,{type:"select",data:[1,2,3,4,5],render:function(k){return'<div style="height: '+k+'px; width: 30px; background-color: black;"></div>'},onchange:function(k,K,se,re){w.thickness=re},width:"50px"}),S.children[1].appendChild(O);const H=document.createElement("div");jSuites.picker(H,{type:"select",data:["solid","dotted","dashed","double"],render:function(k){return k==="double"?'<div style="width: 30px; border-top: 3px '+k+' black;"></div>':'<div style="width: 30px; border-top: 2px '+k+' black;"></div>'},onchange:function(k,K,se,re){w.style=re},width:"50px"}),S.children[1].appendChild(H),O=document.createElement("div"),O.style.flex="1",S.children[1].appendChild(O)},updateState:function(S,w,A){o(A,E())}}),v.push({type:"divisor"}),v.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(S,w,A){A.children[0].textContent==="fullscreen"?(m.fullscreen(!0),A.children[0].textContent="fullscreen_exit"):(m.fullscreen(!1),A.children[0].textContent="fullscreen")},updateState:function(S,w,A,O){O.parent.config.fullscreen===!0?A.children[0].textContent="fullscreen_exit":A.children[0].textContent="fullscreen"}}),v},l=function(v){const m=this,E=v.items;for(let _=0;_<E.length;_++)E[_].tooltip&&(E[_].title=E[_].tooltip,delete E[_].tooltip),E[_].type=="select"?E[_].options?(E[_].data=E[_].options,delete E[_].options):(E[_].data=E[_].v,delete E[_].v,E[_].k&&!E[_].onchange&&(E[_].onchange=function(S,w,A){const O=s.Hf.call(m),D=O.getSelected(!0);O.setStyle(Object.fromEntries(D.map(function(Y){return[Y,E[_].k+": "+A]})))})):E[_].type=="color"&&(E[_].type="i",E[_].onclick=function(S,w,A){A.color||(jSuites.color(A,{onchange:function(O,D){const Y=s.Hf.call(m),H=Y.getSelected(!0);Y.setStyle(Object.fromEntries(H.map(function(k){return[k,E[_].k+": "+D]})))},onopen:function(O){O.color.select("")}}),A.color.open())})},u=function(v){const m=this,E=document.createElement("div");return E.classList.add("jss_toolbar"),l.call(m,v),typeof m.plugins=="object"&&Object.entries(m.plugins).forEach(function([,_]){if(typeof _.toolbar=="function"){const S=_.toolbar(v);S&&(v=S)}}),jSuites.toolbar(E,v),E},c=function(v){v.parent.toolbar&&v.parent.toolbar.toolbar.update(v)},h=function(){const v=this;if(v.config.toolbar&&!v.toolbar){let m;Array.isArray(v.config.toolbar)?m={items:v.config.toolbar}:typeof v.config.toolbar=="object"?m=v.config.toolbar:(m={items:a.call(v)},typeof v.config.toolbar=="function"&&(m=v.config.toolbar(m))),v.toolbar=v.element.insertBefore(u.call(v,m),v.element.children[1])}},g=function(){const v=this;v.toolbar&&(v.toolbar.parentNode.removeChild(v.toolbar),delete v.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=function(r,e){for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},__webpack_require__.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__={};(function(){__webpack_require__.d(__webpack_exports__,{default:function(){return gt}});var r={jspreadsheet:{}},e=__webpack_require__(100),t=__webpack_require__(992),n=__webpack_require__(923);const s=function(b,q,F){const W=this,z=b.getAttribute("data-y"),ie=b.getAttribute("data-x");e.Z.call(W,"oneditionstart",W,b,parseInt(ie),parseInt(z)),ie>0&&(W.records[z][ie-1].element.style.overflow="hidden");const _e=function(J){const me=b.getBoundingClientRect(),L=document.createElement(J);return L.style.width=me.width+"px",L.style.height=me.height-2+"px",L.style.minHeight=me.height-2+"px",b.classList.add("editor"),b.innerHTML="",b.appendChild(L),L};if(b.classList.contains("readonly")!=1){if(W.edition=[W.records[z][ie].element,W.records[z][ie].element.innerHTML,ie,z],W.options.columns&&W.options.columns[ie]&&typeof W.options.columns[ie].type=="object")W.options.columns[ie].type.openEditor(b,W.options.data[z][ie],parseInt(ie),parseInt(z),W,W.options.columns[ie],F),e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]);else if(!(W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].type=="hidden"))if(W.options.columns&&W.options.columns[ie]&&(W.options.columns[ie].type=="checkbox"||W.options.columns[ie].type=="radio")){const J=!b.children[0].checked;W.setValue(b,J),W.edition=null}else if(W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].type=="dropdown"){let J,me=W.options.data[z][ie];W.options.columns[ie].multiple&&!Array.isArray(me)&&(me=me.split(";")),J=typeof W.options.columns[ie].filter=="function"?W.options.columns[ie].filter(W.element,b,ie,z,W.options.columns[ie].source):W.options.columns[ie].source;const L=[];if(J)for(let Ee=0;Ee<J.length;Ee++)L.push(J[Ee]);const Z=_e("div");e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]);const de={data:L,multiple:!!W.options.columns[ie].multiple,autocomplete:!!W.options.columns[ie].autocomplete,opened:!0,value:me,width:"100%",height:Z.style.minHeight,position:W.options.tableOverflow==1||W.parent.config.fullscreen==1,onclose:function(){o.call(W,b,!0)}};W.options.columns[ie].options&&W.options.columns[ie].options.type&&(de.type=W.options.columns[ie].options.type),jSuites.dropdown(Z,de)}else if(W.options.columns&&W.options.columns[ie]&&(W.options.columns[ie].type=="calendar"||W.options.columns[ie].type=="color")){const J=W.options.data[z][ie],me=_e("input");e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]),me.value=J;const L=W.options.columns[ie].options?{...W.options.columns[ie].options}:{};W.options.tableOverflow!=1&&W.parent.config.fullscreen!=1||(L.position=!0),L.value=W.options.data[z][ie],L.opened=!0,L.onclose=function(Z,de){o.call(W,b,!0)},W.options.columns[ie].type=="color"?jSuites.color(me,L):(L.format||(L.format="YYYY-MM-DD"),jSuites.calendar(me,L)),me.focus()}else if(W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].type=="html"){const J=W.options.data[z][ie],me=_e("div");e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]),me.style.position="relative";const L=document.createElement("div");L.classList.add("jss_richtext"),me.appendChild(L),jSuites.editor(L,{focus:!0,value:J});const Z=b.getBoundingClientRect(),de=L.getBoundingClientRect();window.innerHeight<Z.bottom+de.height?L.style.top=Z.top-(de.height+2)+"px":L.style.top=Z.top+"px"}else if(W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].type=="image"){const J=b.children[0],me=_e("div");e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]),me.style.position="relative";const L=document.createElement("div");L.classList.add("jclose"),J&&J.src&&L.appendChild(J),me.appendChild(L),jSuites.image(L,W.options.columns[ie]);const Z=b.getBoundingClientRect(),de=L.getBoundingClientRect();window.innerHeight<Z.bottom+de.height?L.style.top=Z.top-(de.height+2)+"px":L.style.top=Z.top+"px"}else{const J=q==1?"":W.options.data[z][ie];let me;me=W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].wordWrap==0||!(W.options.wordWrap==1||W.options.columns&&W.options.columns[ie]&&W.options.columns[ie].wordWrap==1)?_e("input"):_e("textarea"),e.Z.call(W,"oncreateeditor",W,b,parseInt(ie),parseInt(z),null,W.options.columns[ie]),me.focus(),me.value=J;const L=W.options.columns&&W.options.columns[ie];if(!(0,t.jr)(J)&&L){const Z=(0,t.Vi)(L);if(Z){if(!L.disabledMaskOnEdition)if(L.mask){const de=L.mask.split(";");me.setAttribute("data-mask",de[0])}else L.locale&&me.setAttribute("data-locale",L.locale);Z.input=me,me.mask=Z,jSuites.mask.render(J,Z,!1)}}me.onblur=function(){o.call(W,b,!0)},me.scrollLeft=me.scrollWidth}}},o=function(b,q){const F=this,W=parseInt(b.getAttribute("data-x")),z=parseInt(b.getAttribute("data-y"));let ie;if(q==1){if(F.options.columns&&F.options.columns[W]&&typeof F.options.columns[W].type=="object")ie=F.options.columns[W].type.closeEditor(b,q,parseInt(W),parseInt(z),F,F.options.columns[W]);else if(!(F.options.columns&&F.options.columns[W]&&(F.options.columns[W].type=="checkbox"||F.options.columns[W].type=="radio"||F.options.columns[W].type=="hidden")))if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="dropdown")ie=b.children[0].dropdown.close(!0);else if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="calendar")ie=b.children[0].calendar.close(!0);else if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="color")ie=b.children[0].color.close(!0);else if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="html")ie=b.children[0].children[0].editor.getData();else if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="image"){const _e=b.children[0].children[0].children[0];ie=_e&&_e.tagName=="IMG"?_e.src:""}else if(F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="numeric")ie=b.children[0].value,(""+ie).substr(0,1)!="="&&ie==""&&(ie=F.options.columns[W].allowEmpty?"":0),b.children[0].onblur=null;else{ie=b.children[0].value,b.children[0].onblur=null;const _e=F.options.columns&&F.options.columns[W];if(_e){const J=(0,t.Vi)(_e);if(J&&ie!==""&&!(0,t.jr)(ie)&&typeof ie!="number"){const me=jSuites.mask.extract(ie,J,!0);me&&me.value!==""&&(ie=me.value)}}}F.options.data[z][W]==ie?b.innerHTML=F.edition[1]:F.setValue(b,ie)}else F.options.columns&&F.options.columns[W]&&typeof F.options.columns[W].type=="object"?F.options.columns[W].type.closeEditor(b,q,parseInt(W),parseInt(z),F,F.options.columns[W]):F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="dropdown"?b.children[0].dropdown.close(!0):F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="calendar"?b.children[0].calendar.close(!0):F.options.columns&&F.options.columns[W]&&F.options.columns[W].type=="color"?b.children[0].color.close(!0):b.children[0].onblur=null,b.innerHTML=F.edition&&F.edition[1]?F.edition[1]:"";e.Z.call(F,"oneditionend",F,b,W,z,ie,q),b.classList.remove("editor"),F.edition=null},a=function(){const b=this,q=[],F=Object.keys(b.highlighted);for(let W=0;W<F.length;W++){const z=b.highlighted[W].element.getAttribute("data-x"),ie=b.highlighted[W].element.getAttribute("data-y");b.options.columns[z].type!="checkbox"&&b.options.columns[z].type!="radio"||q.push(t.wW.call(b,z,ie,!b.options.data[ie][z]))}if(q.length){n.JB.call(b,{action:"setValue",records:q,selection:b.selectedCell});const W=q.map(function(z){return{x:z.x,y:z.y,value:z.newValue,oldValue:z.oldValue}});e.Z.call(b,"onafterchanges",b,W)}};var l=__webpack_require__(665);const u=function(b,q){const F=this;b=parseInt(b);for(let W=(q=parseInt(q))-1;W>=0;W--)if(F.records[W][b].element.style.display!="none"&&F.rows[W].element.style.display!="none"){if(F.records[W][b].element.getAttribute("data-merged")&&F.records[W][b].element==F.records[q][b].element)continue;q=W;break}return q},c=function(b,q){const F=this;let W,z;if(b==0?(W=parseInt(F.selectedCell[0]),z=parseInt(F.selectedCell[1])):(W=parseInt(F.selectedCell[2]),z=parseInt(F.selectedCell[3])),q==0){for(let ie=0;ie<z;ie++)if(F.records[ie][W].element.style.display!="none"&&F.rows[ie].element.style.display!="none"){z=ie;break}}else z=u.call(F,W,z);b==0?(F.selectedCell[0]=W,F.selectedCell[1]=z):(F.selectedCell[2]=W,F.selectedCell[3]=z)},h=function(b,q){const F=this;if(b?F.selectedCell[3]>0&&c.call(F,1,q?0:1):(F.selectedCell[1]>0&&c.call(F,0,q?0:1),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),F.options.lazyLoading==1)if(F.selectedCell[1]==0||F.selectedCell[3]==0)l.ij.call(F,0),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]);else if(l.iw.call(F))F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]);else{const W=parseInt(F.tbody.firstChild.getAttribute("data-y"));F.selectedCell[1]-W<30&&(l.Kw.call(F),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]))}else if(F.options.pagination>0){const W=F.whichPage(F.selectedCell[3]);W!=F.pageNumber&&F.page(W)}t.Of.call(F,1)},g=function(b,q){const F=this;b=parseInt(b),q=parseInt(q);for(let W=b+1;W<F.headers.length;W++)if(F.records[q][W].element.style.display!="none"){if(F.records[q][W].element.getAttribute("data-merged")&&F.records[q][W].element==F.records[q][b].element)continue;b=W;break}return b},v=function(b,q){const F=this;let W,z;if(b==0?(W=parseInt(F.selectedCell[0]),z=parseInt(F.selectedCell[1])):(W=parseInt(F.selectedCell[2]),z=parseInt(F.selectedCell[3])),q==0){for(let ie=F.headers.length-1;ie>W;ie--)if(F.records[z][ie].element.style.display!="none"){W=ie;break}}else W=g.call(F,W,z);b==0?(F.selectedCell[0]=W,F.selectedCell[1]=z):(F.selectedCell[2]=W,F.selectedCell[3]=z)},m=function(b,q){const F=this;b?F.selectedCell[2]<F.headers.length-1&&v.call(F,1,q?0:1):(F.selectedCell[0]<F.headers.length-1&&v.call(F,0,q?0:1),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),t.Of.call(F,2)},E=function(b,q){const F=this;b=parseInt(b);for(let W=(q=parseInt(q))+1;W<F.rows.length;W++)if(F.records[W][b].element.style.display!="none"&&F.rows[W].element.style.display!="none"){if(F.records[W][b].element.getAttribute("data-merged")&&F.records[W][b].element==F.records[q][b].element)continue;q=W;break}return q},_=function(b,q){const F=this;let W,z;if(b==0?(W=parseInt(F.selectedCell[0]),z=parseInt(F.selectedCell[1])):(W=parseInt(F.selectedCell[2]),z=parseInt(F.selectedCell[3])),q==0){for(let ie=F.rows.length-1;ie>z;ie--)if(F.records[ie][W].element.style.display!="none"&&F.rows[ie].element.style.display!="none"){z=ie;break}}else z=E.call(F,W,z);b==0?(F.selectedCell[0]=W,F.selectedCell[1]=z):(F.selectedCell[2]=W,F.selectedCell[3]=z)},S=function(b,q){const F=this;if(b?F.selectedCell[3]<F.records.length-1&&_.call(F,1,q?0:1):(F.selectedCell[1]<F.records.length-1&&_.call(F,0,q?0:1),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),F.options.lazyLoading==1)F.selectedCell[1]==F.records.length-1||F.selectedCell[3]==F.records.length-1?(l.ij.call(F,-1),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3])):l.iw.call(F)?F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]):parseInt(F.tbody.lastChild.getAttribute("data-y"))-F.selectedCell[3]<30&&(l.VG.call(F),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]));else if(F.options.pagination>0){const W=F.whichPage(F.selectedCell[3]);W!=F.pageNumber&&F.page(W)}t.Of.call(F,3)},w=function(b,q){const F=this;b=parseInt(b),q=parseInt(q);for(let W=b-1;W>=0;W--)if(F.records[q][W].element.style.display!="none"){if(F.records[q][W].element.getAttribute("data-merged")&&F.records[q][W].element==F.records[q][b].element)continue;b=W;break}return b},A=function(b,q){const F=this;let W,z;if(b==0?(W=parseInt(F.selectedCell[0]),z=parseInt(F.selectedCell[1])):(W=parseInt(F.selectedCell[2]),z=parseInt(F.selectedCell[3])),q==0){for(let ie=0;ie<W;ie++)if(F.records[z][ie].element.style.display!="none"){W=ie;break}}else W=w.call(F,W,z);b==0?(F.selectedCell[0]=W,F.selectedCell[1]=z):(F.selectedCell[2]=W,F.selectedCell[3]=z)},O=function(b,q){const F=this;b?F.selectedCell[2]>0&&A.call(F,1,q?0:1):(F.selectedCell[0]>0&&A.call(F,0,q?0:1),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),t.Of.call(F,0)},D=function(b,q){const F=this;if(b?q?F.selectedCell[3]=0:A.call(F,1,0):(q?F.selectedCell[1]=0:A.call(F,0,0),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.options.lazyLoading!=1||F.selectedCell[1]!=0&&F.selectedCell[3]!=0){if(F.options.pagination>0){const W=F.whichPage(F.selectedCell[3]);W!=F.pageNumber&&F.page(W)}}else l.ij.call(F,0);F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),t.Of.call(F,1)},Y=function(b,q){const F=this;if(b?q?F.selectedCell[3]=F.records.length-1:v.call(F,1,0):(q?F.selectedCell[1]=F.records.length-1:v.call(F,0,0),F.selectedCell[2]=F.selectedCell[0],F.selectedCell[3]=F.selectedCell[1]),F.options.lazyLoading!=1||F.selectedCell[1]!=F.records.length-1&&F.selectedCell[3]!=F.records.length-1){if(F.options.pagination>0){const W=F.whichPage(F.selectedCell[3]);W!=F.pageNumber&&F.page(W)}}else l.ij.call(F,-1);F.updateSelectionFromCoords(F.selectedCell[0],F.selectedCell[1],F.selectedCell[2],F.selectedCell[3]),t.Of.call(F,3)};var H=__webpack_require__(49),k=__webpack_require__(366),K=__webpack_require__(650),se=__webpack_require__(323);const re=function(b,q,F,W,z,ie,_e){const J=this;q||(q="	");const me=new RegExp(q,"ig"),L=[];let Z=[],de=[];const Ee=[],ye=[],Ge=J.options.data[0].length,tt=J.options.data.length;let ft="",We=!1,yt="",Ct="",Mt=0,De=0,ht=0;for(let pt=0;pt<tt;pt++)for(let Me=0;Me<Ge;Me++)b&&!J.records[pt][Me].element.classList.contains("highlight")||ht<=pt&&(ht=pt);if(z&&(J.parent.config.includeHeadersOnDownload==1||W)){if(J.options.nestedHeaders&&J.options.nestedHeaders.length>0){ft=J.options.nestedHeaders;for(let pt=0;pt<ft.length;pt++){const Me=[];for(let dt=0;dt<ft[pt].length;dt++){const wt=parseInt(ft[pt][dt].colspan);Me.push(ft[pt][dt].title);for(let Ot=0;Ot<wt-1;Ot++)Me.push("")}Ct+=Me.join(q)+`\r
`}}We=!0}J.style=[];for(let pt=0;pt<tt;pt++){Z=[],de=[];for(let Me=0;Me<Ge;Me++)if(!b||J.records[pt][Me].element.classList.contains("highlight")){We==1&&L.push(J.headers[Me].textContent);let dt,wt=J.options.data[pt][Me];wt.match&&(wt.match(me)||wt.match(/,/g)||wt.match(/\n/)||wt.match(/\"/))&&(wt=wt.replace(new RegExp('"',"g"),'""'),wt='"'+wt+'"'),Z.push(wt),J.options.columns&&J.options.columns[Me]&&(J.options.columns[Me].type=="checkbox"||J.options.columns[Me].type=="radio")?dt=wt:(dt=J.records[pt][Me].element.innerHTML,dt.match&&(dt.match(me)||dt.match(/,/g)||dt.match(/\n/)||dt.match(/\"/))&&(dt=dt.replace(new RegExp('"',"g"),'""'),dt='"'+dt+'"')),de.push(dt),ft=J.records[pt][Me].element.getAttribute("style"),ft=ft.replace("display: none;",""),J.style.push(ft||"")}Z.length&&(We&&(Mt=Z.length,Ee.push(L.join(q))),Ee.push(Z.join(q))),de.length&&(De++,We&&(ye.push(L.join(q)),We=!1),ye.push(de.join(q)))}Ge==Mt&&tt==De&&(yt=Ct);const mt=yt+Ee.join(`\r
`);let Nt=yt+ye.join(`\r
`);if(!F){const pt=[Math.min(J.selectedCell[0],J.selectedCell[2]),Math.min(J.selectedCell[1],J.selectedCell[3]),Math.max(J.selectedCell[0],J.selectedCell[2]),Math.max(J.selectedCell[1],J.selectedCell[3])],Me=e.Z.call(J,"oncopy",J,pt,Nt,ie);if(Me)Nt=Me;else if(Me===!1)return!1;J.textarea.value=Nt,J.textarea.select(),document.execCommand("copy")}if(J.data=_e==1?Nt:mt,J.hashString=k.vp.call(J,J.data),!F&&(k.vn.call(J),J.highlighted))for(let pt=0;pt<J.highlighted.length;pt++)J.highlighted[pt].element.classList.add("copying"),J.highlighted[pt].element.classList.contains("highlight-left")&&J.highlighted[pt].element.classList.add("copying-left"),J.highlighted[pt].element.classList.contains("highlight-right")&&J.highlighted[pt].element.classList.add("copying-right"),J.highlighted[pt].element.classList.contains("highlight-top")&&J.highlighted[pt].element.classList.add("copying-top"),J.highlighted[pt].element.classList.contains("highlight-bottom")&&J.highlighted[pt].element.classList.add("copying-bottom");return J.data},Ce=function(b,q,F){const W=this,z=(0,k.vp)(F),ie=z==W.hashString?W.style:null;z==W.hashString&&(F=W.data),F=(0,K.parseCSV)(F,"	");const _e=e.Z.call(W,"onbeforepaste",W,F.map(function(J){return J.map(function(me){return{value:me}})}),b,q);if(_e===!1)return!1;if(_e&&(F=_e),b!=null&&q!=null&&F){let J=0,me=0;const L=[],Z={},de={};let Ee=0,ye=parseInt(b),Ge=parseInt(q),tt=null;for(;tt=F[me];){for(J=0,ye=parseInt(b);tt[J]!=null;){const yt=t.wW.call(W,ye,Ge,tt[J]);if(L.push(yt),t.Zz.call(W,ye,Ge,L),ie&&ie[Ee]){const Ct=(0,se.Ar)([ye,Ge]);Z[Ct]=ie[Ee],de[Ct]=W.getStyle(Ct),W.records[Ge][ye].element.setAttribute("style",ie[Ee]),Ee++}if(J++,tt[J]!=null){if(ye>=W.headers.length-1){if(W.options.allowInsertColumn==0)break;W.insertColumn()}ye=g.call(W,ye,Ge)}}if(me++,F[me]){if(Ge>=W.rows.length-1){if(W.options.allowInsertRow==0)break;W.insertRow()}Ge=E.call(W,b,Ge)}}k.Es.call(W,b,q,ye,Ge),n.JB.call(W,{action:"setValue",records:L,selection:W.selectedCell,newStyle:Z,oldStyle:de}),t.T0.call(W);const ft=[];for(let yt=0;yt<F.length;yt++)for(let Ct=0;Ct<F[yt].length;Ct++)ft.push({x:Ct+b,y:yt+q,value:F[yt][Ct]});e.Z.call(W,"onpaste",W,ft);const We=L.map(function(yt){return{x:yt.x,y:yt.y,value:yt.newValue,oldValue:yt.oldValue}});e.Z.call(W,"onafterchanges",W,We)}(0,k.vn)()};var Le=__webpack_require__(456),he=__webpack_require__(427);const ve=function(){const b=this;let q=b.options.columns&&b.options.columns.length||0;if(b.options.data&&b.options.data[0]!==void 0){const F=Object.keys(b.options.data[0]);F.length>q&&(q=F.length)}return b.options.minDimensions&&b.options.minDimensions[0]>q&&(q=b.options.minDimensions[0]),q},xe=function(b){const q=this,F=q.options.columns&&q.options.columns[b]&&q.options.columns[b].width||q.options.defaultColWidth||100,W=q.options.columns&&q.options.columns[b]&&q.options.columns[b].align||q.options.defaultColAlign||"center";q.headers[b]=document.createElement("td"),q.headers[b].textContent=q.options.columns&&q.options.columns[b]&&q.options.columns[b].title||(0,K.getColumnName)(b),q.headers[b].setAttribute("data-x",b),q.headers[b].style.textAlign=W,q.options.columns&&q.options.columns[b]&&q.options.columns[b].title&&q.headers[b].setAttribute("title",q.headers[b].innerText),q.options.columns&&q.options.columns[b]&&q.options.columns[b].id&&q.headers[b].setAttribute("id",q.options.columns[b].id);const z=document.createElement("col");z.setAttribute("width",F),q.cols[b]={colElement:z,x:b},q.options.columns&&q.options.columns[b]&&q.options.columns[b].type=="hidden"&&(q.headers[b].style.display="none",z.style.display="none")},Ie=function(b,q,F){const W=this;if(q){if(Array.isArray(b)){F||(F=[]);for(let z=0;z<b.length;z++){F[z]||(F[z]=parseInt(W.cols[b[z]].colElement.getAttribute("width")));const ie=Array.isArray(q)&&q[z]?q[z]:q;W.cols[b[z]].colElement.setAttribute("width",ie),W.options.columns||(W.options.columns=[]),W.options.columns[b[z]]||(W.options.columns[b[z]]={}),W.options.columns[b[z]].width=ie}}else F||(F=parseInt(W.cols[b].colElement.getAttribute("width"))),W.cols[b].colElement.setAttribute("width",q),W.options.columns||(W.options.columns=[]),W.options.columns[b]||(W.options.columns[b]={}),W.options.columns[b].width=q;n.JB.call(W,{action:"setWidth",column:b,oldValue:F,newValue:q}),e.Z.call(W,"onresizecolumn",W,b,q,F),k.x8.call(W)}},we=function(b,q){const F=this;F.records[b]||(F.records[b]=[]),q||(q=F.options.data[b]);const W={element:document.createElement("tr"),y:b};F.rows[b]=W,W.element.setAttribute("data-y",b);let z=null;F.options.defaultRowHeight&&(W.element.style.height=F.options.defaultRowHeight+"px"),F.options.rows&&F.options.rows[b]&&(F.options.rows[b].height&&(W.element.style.height=F.options.rows[b].height),F.options.rows[b].title&&(z=F.options.rows[b].title)),z||(z=parseInt(b+1));const ie=document.createElement("td");ie.innerHTML=z,ie.setAttribute("data-y",b),ie.className="jss_row",W.element.appendChild(ie);const _e=ve.call(F);for(let J=0;J<_e;J++)F.records[b][J]={element:t.kE.call(this,J,b,q[J]),x:J,y:b},W.element.appendChild(F.records[b][J].element),F.options.columns&&F.options.columns[J]&&typeof F.options.columns[J].render=="function"&&F.options.columns[J].render(F.records[b][J].element,q[J],parseInt(J),parseInt(b),F,F.options.columns[J]);return W},Ne=function(b,q,F){const W=this;if(W.options.mergeCells&&Object.keys(W.options.mergeCells).length>0){let _e;if(_e=b>q?1:0,H.q4.call(W,b).length||H.q4.call(W,q,_e).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;W.destroyMerge()}}if(W.options.search==1){if(W.results&&W.results.length!=W.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;W.resetSearch()}W.results=null}F||(Array.prototype.indexOf.call(W.tbody.children,W.rows[q].element)>=0?b>q?W.tbody.insertBefore(W.rows[b].element,W.rows[q].element):W.tbody.insertBefore(W.rows[b].element,W.rows[q].element.nextSibling):W.tbody.removeChild(W.rows[b].element)),W.rows.splice(q,0,W.rows.splice(b,1)[0]),W.records.splice(q,0,W.records.splice(b,1)[0]),W.options.data.splice(q,0,W.options.data.splice(b,1)[0]);const z=Math.min(b,q),ie=Math.max(b,q);for(let _e=z;_e<=ie;_e++)W.rows[_e].y=_e;for(let _e=z;_e<=ie;_e++)for(let J=0;J<W.records[_e].length;J++)W.records[_e][J].y=_e;W.options.pagination>0&&W.tbody.children.length!=W.options.pagination&&W.page(W.pageNumber),n.JB.call(W,{action:"moveRow",oldValue:b,newValue:q}),t.ec.call(W),e.Z.call(W,"onmoverow",W,parseInt(b),parseInt(q),1)},at=function(b,q,F){const W=this;q>0&&(F||(F=W.rows[b].element.getAttribute("height"))||(F=W.rows[b].element.getBoundingClientRect().height),q=parseInt(q),W.rows[b].element.style.height=q+"px",W.options.rows||(W.options.rows=[]),W.options.rows[b]||(W.options.rows[b]={}),W.options.rows[b].height=q,n.JB.call(W,{action:"setHeight",row:b,oldValue:F,newValue:q}),e.Z.call(W,"onresizerow",W,b,q,F),k.x8.call(W))};var nt={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const B=function(b){let q=0,F=0;return function W(z){z.className&&(z.classList.contains("jss_container")&&(F=z),z.classList.contains("jss_spreadsheet")&&(F=z.querySelector(":scope > .jtabs-content > .jtabs-selected"))),z.tagName=="THEAD"?q=1:z.tagName=="TBODY"&&(q=2),z.parentNode&&(F||W(z.parentNode))}(b),[F,q]},te=function(b){if(r.jspreadsheet.current)if(r.jspreadsheet.current.resizing){if(r.jspreadsheet.current.resizing.column){const q=parseInt(r.jspreadsheet.current.cols[r.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),F=r.jspreadsheet.current.getSelectedColumns();if(F.length>1){const W=[];for(let z=0;z<F.length;z++)W.push(parseInt(r.jspreadsheet.current.cols[F[z]].colElement.getAttribute("width")));W[F.indexOf(parseInt(r.jspreadsheet.current.resizing.column))]=r.jspreadsheet.current.resizing.width,Ie.call(r.jspreadsheet.current,F,q,W)}else Ie.call(r.jspreadsheet.current,parseInt(r.jspreadsheet.current.resizing.column),q,r.jspreadsheet.current.resizing.width);r.jspreadsheet.current.headers[r.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let W=0;W<r.jspreadsheet.current.records.length;W++)r.jspreadsheet.current.records[W][r.jspreadsheet.current.resizing.column]&&r.jspreadsheet.current.records[W][r.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let q=r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.getAttribute("height");at.call(r.jspreadsheet.current,r.jspreadsheet.current.resizing.row,q,r.jspreadsheet.current.resizing.height),r.jspreadsheet.current.resizing.element.classList.remove("resizing")}r.jspreadsheet.current.resizing=null}else if(r.jspreadsheet.current.dragging){if(r.jspreadsheet.current.dragging){if(r.jspreadsheet.current.dragging.column){const q=b.target.getAttribute("data-x");r.jspreadsheet.current.headers[r.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let F=0;F<r.jspreadsheet.current.rows.length;F++)r.jspreadsheet.current.records[F][r.jspreadsheet.current.dragging.column]&&r.jspreadsheet.current.records[F][r.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let F=0;F<r.jspreadsheet.current.headers.length;F++)r.jspreadsheet.current.headers[F].classList.remove("dragging-left"),r.jspreadsheet.current.headers[F].classList.remove("dragging-right");q&&r.jspreadsheet.current.dragging.column!=r.jspreadsheet.current.dragging.destination&&r.jspreadsheet.current.moveColumn(r.jspreadsheet.current.dragging.column,r.jspreadsheet.current.dragging.destination)}else{let q;r.jspreadsheet.current.dragging.element.nextSibling?(q=parseInt(r.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),r.jspreadsheet.current.dragging.row<q&&(q-=1)):q=parseInt(r.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),r.jspreadsheet.current.dragging.row!=r.jspreadsheet.current.dragging.destination&&Ne.call(r.jspreadsheet.current,r.jspreadsheet.current.dragging.row,q,!0),r.jspreadsheet.current.dragging.element.classList.remove("dragging")}r.jspreadsheet.current.dragging=null}}else r.jspreadsheet.current.selectedCorner&&(r.jspreadsheet.current.selectedCorner=!1,r.jspreadsheet.current.selection.length>0&&(k.F1.call(r.jspreadsheet.current,r.jspreadsheet.current.selection[0],r.jspreadsheet.current.selection[r.jspreadsheet.current.selection.length-1]),k.Mt.call(r.jspreadsheet.current)));r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null),r.jspreadsheet.isMouseAction=!1},V=function(b){let q;q=(b=b||window.event).buttons?b.buttons:b.button?b.button:b.which;const F=B(b.target);if(F[0]?r.jspreadsheet.current!=F[0].jssWorksheet&&(r.jspreadsheet.current&&(r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0),r.jspreadsheet.current.resetSelection()),r.jspreadsheet.current=F[0].jssWorksheet):r.jspreadsheet.current&&(r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0),b.target.classList.contains("jss_object")||(k.yE.call(r.jspreadsheet.current,!0),r.jspreadsheet.current=null)),r.jspreadsheet.current&&q==1){if(b.target.classList.contains("jss_selectall"))r.jspreadsheet.current&&k.td.call(r.jspreadsheet.current);else if(b.target.classList.contains("jss_corner"))r.jspreadsheet.current.options.editable!=0&&(r.jspreadsheet.current.selectedCorner=!0);else{if(F[1]==1){const W=b.target.getAttribute("data-x");if(W){const z=b.target.getBoundingClientRect();if(r.jspreadsheet.current.options.columnResize!=0&&z.width-b.offsetX<6){r.jspreadsheet.current.resizing={mousePosition:b.pageX,column:W,width:z.width},r.jspreadsheet.current.headers[W].classList.add("resizing");for(let ie=0;ie<r.jspreadsheet.current.records.length;ie++)r.jspreadsheet.current.records[ie][W]&&r.jspreadsheet.current.records[ie][W].element.classList.add("resizing")}else if(r.jspreadsheet.current.options.columnDrag!=0&&z.height-b.offsetY<6)if(H.D0.call(r.jspreadsheet.current,W).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current.dragging={element:b.target,column:W,destination:W},r.jspreadsheet.current.headers[W].classList.add("dragging");for(let ie=0;ie<r.jspreadsheet.current.records.length;ie++)r.jspreadsheet.current.records[ie][W]&&r.jspreadsheet.current.records[ie][W].element.classList.add("dragging")}else{let ie,_e;r.jspreadsheet.current.selectedHeader&&(b.shiftKey||b.ctrlKey)?(ie=r.jspreadsheet.current.selectedHeader,_e=W):(r.jspreadsheet.current.selectedHeader==W&&r.jspreadsheet.current.options.allowRenameColumn!=0&&(r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.setHeader(W)},800)),r.jspreadsheet.current.selectedHeader=W,ie=W,_e=W),k.Es.call(r.jspreadsheet.current,ie,0,_e,r.jspreadsheet.current.options.data.length-1,b)}}else if(b.target.parentNode.classList.contains("jss_nested")){let z,ie;if(b.target.getAttribute("data-column")){const _e=b.target.getAttribute("data-column").split(",");z=parseInt(_e[0]),ie=parseInt(_e[_e.length-1])}else z=0,ie=r.jspreadsheet.current.options.columns.length-1;k.Es.call(r.jspreadsheet.current,z,0,ie,r.jspreadsheet.current.options.data.length-1,b)}}else r.jspreadsheet.current.selectedHeader=!1;if(F[1]==2){const W=parseInt(b.target.getAttribute("data-y"));if(b.target.classList.contains("jss_row")){const z=b.target.getBoundingClientRect();if(r.jspreadsheet.current.options.rowResize!=0&&z.height-b.offsetY<6)r.jspreadsheet.current.resizing={element:b.target.parentNode,mousePosition:b.pageY,row:W,height:z.height},b.target.parentNode.classList.add("resizing");else if(r.jspreadsheet.current.options.rowDrag!=0&&z.width-b.offsetX<6)H.q4.call(r.jspreadsheet.current,W).length?console.error("Jspreadsheet: This row is part of a merged cell"):r.jspreadsheet.current.options.search==1&&r.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current.dragging={element:b.target.parentNode,row:W,destination:W},b.target.parentNode.classList.add("dragging"));else{let ie,_e;r.jspreadsheet.current.selectedRow&&(b.shiftKey||b.ctrlKey)?(ie=r.jspreadsheet.current.selectedRow,_e=W):(r.jspreadsheet.current.selectedRow=W,ie=W,_e=W),k.Es.call(r.jspreadsheet.current,null,ie,null,_e,b)}}else if(b.target.classList.contains("jclose")&&b.target.clientWidth-b.offsetX<50&&b.offsetY<50)o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0);else{const z=function(_e){const J=_e.getAttribute("data-x"),me=_e.getAttribute("data-y");return J&&me?[J,me]:_e.parentNode?z(_e.parentNode):void 0},ie=z(b.target);if(ie){const _e=ie[0],J=ie[1];r.jspreadsheet.current.edition&&(r.jspreadsheet.current.edition[2]==_e&&r.jspreadsheet.current.edition[3]==J||o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0)),r.jspreadsheet.current.edition||(b.shiftKey?k.Es.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],_e,J,b):k.Es.call(r.jspreadsheet.current,_e,J,void 0,void 0,b)),r.jspreadsheet.current.selectedHeader=null,r.jspreadsheet.current.selectedRow=null}}}else r.jspreadsheet.current.selectedRow=!1;b.target.classList.contains("jss_page")&&(b.target.textContent=="<"?r.jspreadsheet.current.page(0):b.target.textContent==">"?r.jspreadsheet.current.page(b.target.getAttribute("title")-1):r.jspreadsheet.current.page(b.target.textContent-1))}r.jspreadsheet.current.edition?r.jspreadsheet.isMouseAction=!1:r.jspreadsheet.isMouseAction=!0}else r.jspreadsheet.isMouseAction=!1},ue=function(b){let q;if(q=(b=b||window.event).buttons?b.buttons:b.button?b.button:b.which,q||(r.jspreadsheet.isMouseAction=!1),r.jspreadsheet.current)if(r.jspreadsheet.isMouseAction==1){if(r.jspreadsheet.current.resizing)if(r.jspreadsheet.current.resizing.column){const F=b.pageX-r.jspreadsheet.current.resizing.mousePosition;if(r.jspreadsheet.current.resizing.width+F>0){const W=r.jspreadsheet.current.resizing.width+F;r.jspreadsheet.current.cols[r.jspreadsheet.current.resizing.column].colElement.setAttribute("width",W),k.x8.call(r.jspreadsheet.current)}}else{const F=b.pageY-r.jspreadsheet.current.resizing.mousePosition;if(r.jspreadsheet.current.resizing.height+F>0){const W=r.jspreadsheet.current.resizing.height+F;r.jspreadsheet.current.rows[r.jspreadsheet.current.resizing.row].element.setAttribute("height",W),k.x8.call(r.jspreadsheet.current)}}else if(r.jspreadsheet.current.dragging)if(r.jspreadsheet.current.dragging.column){const F=b.target.getAttribute("data-x");if(F)if(H.D0.call(r.jspreadsheet.current,F).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let W=0;W<r.jspreadsheet.current.headers.length;W++)r.jspreadsheet.current.headers[W].classList.remove("dragging-left"),r.jspreadsheet.current.headers[W].classList.remove("dragging-right");r.jspreadsheet.current.dragging.column==F?r.jspreadsheet.current.dragging.destination=parseInt(F):b.target.clientWidth/2>b.offsetX?(r.jspreadsheet.current.dragging.column<F?r.jspreadsheet.current.dragging.destination=parseInt(F)-1:r.jspreadsheet.current.dragging.destination=parseInt(F),r.jspreadsheet.current.headers[F].classList.add("dragging-left")):(r.jspreadsheet.current.dragging.column<F?r.jspreadsheet.current.dragging.destination=parseInt(F):r.jspreadsheet.current.dragging.destination=parseInt(F)+1,r.jspreadsheet.current.headers[F].classList.add("dragging-right"))}}else{const F=b.target.getAttribute("data-y");if(F)if(H.q4.call(r.jspreadsheet.current,F).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const W=b.target.clientHeight/2>b.offsetY?b.target.parentNode.nextSibling:b.target.parentNode;r.jspreadsheet.current.dragging.element!=W&&(b.target.parentNode.parentNode.insertBefore(r.jspreadsheet.current.dragging.element,W),r.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(r.jspreadsheet.current.dragging.element.parentNode.children,r.jspreadsheet.current.dragging.element))}}}else{const F=b.target.getAttribute("data-x"),W=b.target.getAttribute("data-y"),z=b.target.getBoundingClientRect();r.jspreadsheet.current.cursor&&(r.jspreadsheet.current.cursor.style.cursor="",r.jspreadsheet.current.cursor=null),b.target.parentNode.parentNode&&b.target.parentNode.parentNode.className&&(b.target.parentNode.parentNode.classList.contains("resizable")&&(b.target&&F&&!W&&z.width-(b.clientX-z.left)<6?(r.jspreadsheet.current.cursor=b.target,r.jspreadsheet.current.cursor.style.cursor="col-resize"):b.target&&!F&&W&&z.height-(b.clientY-z.top)<6&&(r.jspreadsheet.current.cursor=b.target,r.jspreadsheet.current.cursor.style.cursor="row-resize")),b.target.parentNode.parentNode.classList.contains("draggable")&&(b.target&&!F&&W&&z.width-(b.clientX-z.left)<6||b.target&&F&&!W&&z.height-(b.clientY-z.top)<6)&&(r.jspreadsheet.current.cursor=b.target,r.jspreadsheet.current.cursor.style.cursor="move"))}},Ae=function(b,q){const F=this;k.Mt.call(F);const W=F.selectedContainer[0],z=F.selectedContainer[1],ie=F.selectedContainer[2],_e=F.selectedContainer[3];if(b!=null&&q!=null){let J,me,L,Z;b-ie>0?(J=parseInt(ie)+1,me=parseInt(b)):(J=parseInt(b),me=parseInt(W)-1),q-_e>0?(L=parseInt(_e)+1,Z=parseInt(q)):(L=parseInt(q),Z=parseInt(z)-1),me-J<=Z-L?(J=parseInt(W),me=parseInt(ie)):(L=parseInt(z),Z=parseInt(_e));for(let de=L;de<=Z;de++)for(let Ee=J;Ee<=me;Ee++)F.records[de][Ee]&&F.rows[de].element.style.display!="none"&&F.records[de][Ee].element.style.display!="none"&&(F.records[de][Ee].element.classList.add("selection"),F.records[L][Ee].element.classList.add("selection-top"),F.records[Z][Ee].element.classList.add("selection-bottom"),F.records[de][J].element.classList.add("selection-left"),F.records[de][me].element.classList.add("selection-right"),F.selection.push(F.records[de][Ee].element))}},Ve=function(b){let q;if(q=(b=b||window.event).buttons?b.buttons:b.button?b.button:b.which,q||(r.jspreadsheet.isMouseAction=!1),r.jspreadsheet.current&&r.jspreadsheet.isMouseAction==1){const F=B(b.target);if(F[0]){if(r.jspreadsheet.current!=F[0].jssWorksheet&&r.jspreadsheet.current)return!1;let W=b.target.getAttribute("data-x");const z=b.target.getAttribute("data-y");if(!(r.jspreadsheet.current.resizing||r.jspreadsheet.current.dragging)){if(F[1]==1&&r.jspreadsheet.current.selectedHeader){W=b.target.getAttribute("data-x");const ie=r.jspreadsheet.current.selectedHeader,_e=W;k.Es.call(r.jspreadsheet.current,ie,0,_e,r.jspreadsheet.current.options.data.length-1,b)}if(F[1]==2)if(b.target.classList.contains("jss_row")){if(r.jspreadsheet.current.selectedRow){const ie=r.jspreadsheet.current.selectedRow,_e=z;k.Es.call(r.jspreadsheet.current,0,ie,r.jspreadsheet.current.options.data[0].length-1,_e,b)}}else r.jspreadsheet.current.edition||W&&z&&(r.jspreadsheet.current.selectedCorner?Ae.call(r.jspreadsheet.current,W,z):r.jspreadsheet.current.selectedCell&&k.Es.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],W,z,b))}}}r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null)},He=function(b){if(r.jspreadsheet.current)if(b.target.classList.contains("jss_corner")){if(r.jspreadsheet.current.highlighted.length>0){const q=r.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),F=parseInt(r.jspreadsheet.current.highlighted[r.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,W=r.jspreadsheet.current.highlighted[r.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),z=r.jspreadsheet.current.records.length-1;k.F1.call(r.jspreadsheet.current,r.jspreadsheet.current.records[F][q].element,r.jspreadsheet.current.records[z][W].element)}}else if(b.target.classList.contains("jss_column_filter")){const q=b.target.getAttribute("data-x");Le.B4.call(r.jspreadsheet.current,q)}else{const q=B(b.target);if(q[1]==1&&r.jspreadsheet.current.options.columnSorting!=0){const F=b.target.getAttribute("data-x");F&&r.jspreadsheet.current.orderBy(parseInt(F))}if(q[1]==2&&r.jspreadsheet.current.options.editable!=0&&!r.jspreadsheet.current.edition){const F=function(z){if(z.parentNode){const ie=z.getAttribute("data-x"),_e=z.getAttribute("data-y");return ie&&_e?z:F(z.parentNode)}},W=F(b.target);W&&W.classList.contains("highlight")&&s.call(r.jspreadsheet.current,W,void 0,b)}}},be=function(b){r.jspreadsheet.current&&r.jspreadsheet.current.selectedCell&&(r.jspreadsheet.current.edition||r.jspreadsheet.current.options.editable!=0&&(b&&b.clipboardData?(Ce.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],b.clipboardData.getData("text")),b.preventDefault()):window.clipboardData&&Ce.call(r.jspreadsheet.current,r.jspreadsheet.current.selectedCell[0],r.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},qe=function(b){const q=b.parentElement.children;for(let F=0;F<q.length;F++)if(b===q[F])return F;return-1},le=function(b){if("buttons"in(b=b||window.event)?b.buttons:b.which||b.button,r.jspreadsheet.current){const q=r.jspreadsheet.current.parent;if(r.jspreadsheet.current.edition)b.preventDefault();else if(q.contextMenu.contextmenu.close(),r.jspreadsheet.current){const F=function(_e){if(_e.classList.contains("jss_selectall"))return"select-all";if(_e.classList.contains("jss_corner"))return"fill-handle";let J=_e;for(;!J.classList.contains("jss_spreadsheet");){if(J.classList.contains("jss_row"))return"row";if(J.classList.contains("jss_nested"))return"nested";if(J.classList.contains("jtabs-headers"))return"tabs";if(J.classList.contains("jtoolbar"))return"toolbar";if(J.classList.contains("jss_pagination"))return"pagination";if(J.tagName==="TBODY")return"cell";if(J.tagName==="TFOOT")return qe(_e)===0?"grid":"footer";if(J.tagName==="THEAD")return"header";J=J.parentElement}return"applications"}(b.target);let W=null,z=null;if(F==="cell"||F==="row"||F==="header")F!=="cell"&&F!=="row"||(z=b.target.getAttribute("data-y")),F!=="cell"&&F!=="header"||(W=b.target.getAttribute("data-x")),(!r.jspreadsheet.current.selectedCell||W<parseInt(r.jspreadsheet.current.selectedCell[0])||W>parseInt(r.jspreadsheet.current.selectedCell[2])||z<parseInt(r.jspreadsheet.current.selectedCell[1])||z>parseInt(r.jspreadsheet.current.selectedCell[3]))&&k.Es.call(r.jspreadsheet.current,W,z,W,z,b);else if(F==="nested"){const _e=b.target.getAttribute("data-column").split(",");W=qe(b.target)-1,z=qe(b.target.parentElement),r.jspreadsheet.current.selectedCell&&_e[0]==parseInt(r.jspreadsheet.current.selectedCell[0])&&_e[_e.length-1]==parseInt(r.jspreadsheet.current.selectedCell[2])&&r.jspreadsheet.current.selectedCell[1]==null&&r.jspreadsheet.current.selectedCell[3]==null||k.Es.call(r.jspreadsheet.current,_e[0],null,_e[_e.length-1],null,b)}else F==="select-all"?k.td.call(r.jspreadsheet.current):F==="tabs"?W=qe(b.target):F==="footer"&&(W=qe(b.target)-1,z=qe(b.target.parentElement));let ie=function(_e,J,me,L){const Z=[];if(L==="header"&&(_e.options.allowInsertColumn!=0&&Z.push({title:jSuites.translate("Insert a new column before"),onclick:function(){_e.insertColumn(1,parseInt(J),1)}}),_e.options.allowInsertColumn!=0&&Z.push({title:jSuites.translate("Insert a new column after"),onclick:function(){_e.insertColumn(1,parseInt(J),0)}}),_e.options.allowDeleteColumn!=0&&Z.push({title:jSuites.translate("Delete selected columns"),onclick:function(){_e.deleteColumn(_e.getSelectedColumns().length?void 0:parseInt(J))}}),_e.options.allowRenameColumn!=0&&Z.push({title:jSuites.translate("Rename this column"),onclick:function(){const de=_e.getHeader(J),Ee=prompt(jSuites.translate("Column name"),de);_e.setHeader(J,Ee)}}),_e.options.columnSorting!=0&&(Z.push({type:"line"}),Z.push({title:jSuites.translate("Order ascending"),onclick:function(){_e.orderBy(J,0)}}),Z.push({title:jSuites.translate("Order descending"),onclick:function(){_e.orderBy(J,1)}}))),L!=="row"&&L!=="cell"||(_e.options.allowInsertRow!=0&&(Z.push({title:jSuites.translate("Insert a new row before"),onclick:function(){_e.insertRow(1,parseInt(me),1)}}),Z.push({title:jSuites.translate("Insert a new row after"),onclick:function(){_e.insertRow(1,parseInt(me))}})),_e.options.allowDeleteRow!=0&&Z.push({title:jSuites.translate("Delete selected rows"),onclick:function(){_e.deleteRow(_e.getSelectedRows().length?void 0:parseInt(me))}})),L==="cell"&&_e.options.allowComments!=0){Z.push({type:"line"});const de=_e.records[me][J].element.getAttribute("title")||"";Z.push({title:jSuites.translate(de?"Edit comments":"Add comments"),onclick:function(){const Ee=prompt(jSuites.translate("Comments"),de);Ee&&_e.setComments((0,K.getCellNameFromCoords)(J,me),Ee)}}),de&&Z.push({title:jSuites.translate("Clear comments"),onclick:function(){_e.setComments((0,K.getCellNameFromCoords)(J,me),"")}})}return Z.length!==0&&Z.push({type:"line"}),L!=="header"&&L!=="row"&&L!=="cell"||(Z.push({title:jSuites.translate("Copy..."),shortcut:"Ctrl + C",onclick:function(){re.call(_e,!0)}}),navigator&&navigator.clipboard&&Z.push({title:jSuites.translate("Paste..."),shortcut:"Ctrl + V",onclick:function(){_e.selectedCell&&navigator.clipboard.readText().then(function(de){de&&Ce.call(_e,_e.selectedCell[0],_e.selectedCell[1],de)})}})),_e.parent.config.allowExport!=0&&Z.push({title:jSuites.translate("Save as..."),shortcut:"Ctrl + S",onclick:function(){_e.download()}}),_e.parent.config.about!=0&&Z.push({title:jSuites.translate("About"),onclick:function(){_e.parent.config.about===void 0||_e.parent.config.about===!0?alert(nt.print()):alert(_e.parent.config.about)}}),Z}(r.jspreadsheet.current,parseInt(W),parseInt(z),F);if(typeof q.config.contextMenu=="function"){const _e=q.config.contextMenu(r.jspreadsheet.current,W,z,b,ie,F,W,z);if(_e)ie=_e;else if(_e===!1)return}typeof q.plugins=="object"&&Object.entries(q.plugins).forEach(function([,_e]){if(typeof _e.contextMenu=="function"){const J=_e.contextMenu(r.jspreadsheet.current,W!==null?parseInt(W):null,z!==null?parseInt(z):null,b,ie,F,W!==null?parseInt(W):null,z!==null?parseInt(z):null);J&&(ie=J)}}),q.contextMenu.contextmenu.open(b,ie),b.preventDefault()}}},pe=function(b){const q=B(b.target);if(q[0]?r.jspreadsheet.current!=q[0].jssWorksheet&&(r.jspreadsheet.current&&r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current=q[0].jssWorksheet):r.jspreadsheet.current&&(r.jspreadsheet.current.resetSelection(),r.jspreadsheet.current=null),r.jspreadsheet.current&&!r.jspreadsheet.current.edition){const F=b.target.getAttribute("data-x"),W=b.target.getAttribute("data-y");F&&W&&(k.Es.call(r.jspreadsheet.current,F,W,void 0,void 0,b),r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.options.columns[F].type=="color"?r.jspreadsheet.tmpElement=null:r.jspreadsheet.tmpElement=b.target,s.call(r.jspreadsheet.current,b.target,!1,b)},500))}},Se=function(b){r.jspreadsheet.timeControl&&(clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=null,r.jspreadsheet.tmpElement&&r.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&r.jspreadsheet.tmpElement.children[0].focus(),r.jspreadsheet.tmpElement=null)},Ye=function(b){r.jspreadsheet.current&&(r.jspreadsheet.current.edition||(re.call(r.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),r.jspreadsheet.current.options.editable!=0&&r.jspreadsheet.current.setValue(r.jspreadsheet.current.highlighted.map(function(q){return q.element}),"")))},Fe=function(b){r.jspreadsheet.current&&Fe.enabled&&(r.jspreadsheet.current.edition||re.call(r.jspreadsheet.current,!0))},je=function(b){if(r.jspreadsheet.current){if(r.jspreadsheet.current.edition)if(b.which==27)r.jspreadsheet.current.edition&&o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!1),b.preventDefault();else if(b.which==13){if(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type=="calendar")o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0);else if(!(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type=="dropdown"))if((r.jspreadsheet.current.options.wordWrap==1||r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].wordWrap==1||r.jspreadsheet.current.options.data[r.jspreadsheet.current.edition[3]][r.jspreadsheet.current.edition[2]]&&r.jspreadsheet.current.options.data[r.jspreadsheet.current.edition[3]][r.jspreadsheet.current.edition[2]].length>200)&&b.altKey){const q=r.jspreadsheet.current.edition[0].children[0];let F=r.jspreadsheet.current.edition[0].children[0].value;const W=q.selectionStart;F=F.slice(0,W)+`
`+F.slice(W),q.value=F,q.focus(),q.selectionStart=W+1,q.selectionEnd=W+1}else r.jspreadsheet.current.edition[0].children[0].blur()}else b.which==9&&(r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(r.jspreadsheet.current.options.columns[r.jspreadsheet.current.edition[2]].type)?o.call(r.jspreadsheet.current,r.jspreadsheet.current.edition[0],!0):r.jspreadsheet.current.edition[0].children[0].blur());if(!r.jspreadsheet.current.edition&&r.jspreadsheet.current.selectedCell)if(b.which==37)O.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==39)m.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==38)h.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==40)S.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==36)D.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==35)Y.call(r.jspreadsheet.current,b.shiftKey,b.ctrlKey),b.preventDefault();else if(b.which==46)r.jspreadsheet.current.options.editable!=0&&(r.jspreadsheet.current.selectedRow?r.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&r.jspreadsheet.current.deleteRow():r.jspreadsheet.current.selectedHeader?r.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&r.jspreadsheet.current.deleteColumn():r.jspreadsheet.current.setValue(r.jspreadsheet.current.highlighted.map(function(q){return q.element}),""));else if(b.which==13)b.shiftKey?h.call(r.jspreadsheet.current):(r.jspreadsheet.current.options.allowInsertRow!=0&&r.jspreadsheet.current.options.allowManualInsertRow!=0&&r.jspreadsheet.current.selectedCell[1]==r.jspreadsheet.current.options.data.length-1&&r.jspreadsheet.current.insertRow(),S.call(r.jspreadsheet.current)),b.preventDefault();else if(b.which==9)b.shiftKey?O.call(r.jspreadsheet.current):(r.jspreadsheet.current.options.allowInsertColumn!=0&&r.jspreadsheet.current.options.allowManualInsertColumn!=0&&r.jspreadsheet.current.selectedCell[0]==r.jspreadsheet.current.options.data[0].length-1&&r.jspreadsheet.current.insertColumn(),m.call(r.jspreadsheet.current)),b.preventDefault();else if(!b.ctrlKey&&!b.metaKey||b.shiftKey){if(r.jspreadsheet.current.selectedCell&&r.jspreadsheet.current.options.editable!=0){const q=r.jspreadsheet.current.selectedCell[1],F=r.jspreadsheet.current.selectedCell[0];b.keyCode==32?(b.preventDefault(),r.jspreadsheet.current.options.columns[F].type=="checkbox"||r.jspreadsheet.current.options.columns[F].type=="radio"?a.call(r.jspreadsheet.current):s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[q][F].element,!0,b)):b.keyCode==113?s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[q][F].element,!1,b):(b.keyCode==8||b.keyCode>=48&&b.keyCode<=57||b.keyCode>=96&&b.keyCode<=111||b.keyCode>=187&&b.keyCode<=190||(String.fromCharCode(b.keyCode)==b.key||String.fromCharCode(b.keyCode).toLowerCase()==b.key.toLowerCase())&&String.fromCharCode(b.keyCode).match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g))&&(s.call(r.jspreadsheet.current,r.jspreadsheet.current.records[q][F].element,!0,b),r.jspreadsheet.current.options.columns&&r.jspreadsheet.current.options.columns[F]&&r.jspreadsheet.current.options.columns[F].type=="calendar"&&b.preventDefault())}}else b.which==65?(k.td.call(r.jspreadsheet.current),b.preventDefault()):b.which==83?(r.jspreadsheet.current.download(),b.preventDefault()):b.which==89?(r.jspreadsheet.current.redo(),b.preventDefault()):b.which==90?(r.jspreadsheet.current.undo(),b.preventDefault()):b.which==67?(re.call(r.jspreadsheet.current,!0),b.preventDefault()):b.which==88?(r.jspreadsheet.current.options.editable!=0?Ye():Fe(),b.preventDefault()):b.which==86&&be();else b.target.classList.contains("jss_search")&&(r.jspreadsheet.timeControl&&clearTimeout(r.jspreadsheet.timeControl),r.jspreadsheet.timeControl=setTimeout(function(){r.jspreadsheet.current.search(b.target.value)},200))}},rt=function(b){const q=this;q.options.lazyLoading==1&&r.jspreadsheet.timeControlLoading==null&&(r.jspreadsheet.timeControlLoading=setTimeout(function(){q.content.scrollTop+q.content.clientHeight>=q.content.scrollHeight-10?l.VG.call(q)&&(q.content.scrollTop+q.content.clientHeight>q.content.scrollHeight-10&&(q.content.scrollTop=q.content.scrollTop-q.content.clientHeight),k.x8.call(q)):q.content.scrollTop<=q.content.clientHeight&&l.Kw.call(q)&&(q.content.scrollTop<10&&(q.content.scrollTop=q.content.scrollTop+q.content.clientHeight),k.x8.call(q)),r.jspreadsheet.timeControlLoading=null},100))};let Ue=0;const Xe=function(){const b=this;Ue=b.content.scrollLeft;let q=0;if(Ue>50)for(let F=0;F<b.options.freezeColumns;F++){if(F>0&&(!b.options.columns||!b.options.columns[F-1]||b.options.columns[F-1].type!=="hidden")){let W;W=b.options.columns&&b.options.columns[F-1]&&b.options.columns[F-1].width!==void 0?parseInt(b.options.columns[F-1].width):b.options.defaultColWidth!==void 0?parseInt(b.options.defaultColWidth):100,q+=parseInt(W)}b.headers[F].classList.add("jss_freezed"),b.headers[F].style.left=q+"px";for(let W=0;W<b.rows.length;W++)if(b.rows[W]&&b.records[W][F]){const z=Ue+(F>0?b.records[W][F-1].element.style.width:0)-51+"px";b.records[W][F].element.classList.add("jss_freezed"),b.records[W][F].element.style.left=z}}else for(let F=0;F<b.options.freezeColumns;F++){b.headers[F].classList.remove("jss_freezed"),b.headers[F].style.left="";for(let W=0;W<b.rows.length;W++)b.records[W][F]&&(b.records[W][F].element.classList.remove("jss_freezed"),b.records[W][F].element.style.left="")}k.x8.call(b)},et=function(b){const q=this;rt.call(q),q.options.freezeColumns>0&&q.content.scrollLeft!=Ue&&Xe.call(q),q.options.lazyLoading!=1&&q.options.tableOverflow!=1||q.edition&&b.target.className.substr(0,9)!="jdropdown"&&o.call(q,q.edition[0],!0)},Qe=function(b){st(b),b.addEventListener("mouseup",te),b.addEventListener("mousedown",V),b.addEventListener("mousemove",ue),b.addEventListener("mouseover",Ve),b.addEventListener("dblclick",He),b.addEventListener("paste",be),b.addEventListener("contextmenu",le),b.addEventListener("touchstart",pe),b.addEventListener("touchend",Se),b.addEventListener("touchcancel",Se),b.addEventListener("touchmove",Se),document.addEventListener("keydown",je)},st=function(b){b.removeEventListener("mouseup",te),b.removeEventListener("mousedown",V),b.removeEventListener("mousemove",ue),b.removeEventListener("mouseover",Ve),b.removeEventListener("dblclick",He),b.removeEventListener("paste",be),b.removeEventListener("contextmenu",le),b.removeEventListener("touchstart",pe),b.removeEventListener("touchend",Se),b.removeEventListener("touchcancel",Se),document.removeEventListener("keydown",je)};var St=__webpack_require__(898),At=__webpack_require__(673);const j=function(b,q,F,W,z){const ie=this,_e={},J={},me=function(Z,de,Ee){const ye=(0,se.qP)(Z,!0);if(ie.records[ye[1]]&&ie.records[ye[1]][ye[0]]&&(ie.records[ye[1]][ye[0]].element.classList.contains("readonly")==0||W)){const Ge=ie.records[ye[1]][ye[0]].element.style[de];Ge!=Ee||W?ie.records[ye[1]][ye[0]].element.style[de]=Ee:(Ee="",ie.records[ye[1]][ye[0]].element.style[de]=""),J[Z]||(J[Z]=[]),_e[Z]||(_e[Z]=[]),J[Z].push([de+":"+Ge]),_e[Z].push([de+":"+Ee])}};if(q&&F)typeof b=="string"&&me(b,q,F);else{const Z=Object.keys(b);for(let de=0;de<Z.length;de++){let Ee=b[Z[de]];typeof Ee=="string"&&(Ee=Ee.split(";"));for(let ye=0;ye<Ee.length;ye++)typeof Ee[ye]=="string"&&(Ee[ye]=Ee[ye].split(":")),Ee[ye][0].trim()&&me(Z[de],Ee[ye][0].trim(),Ee[ye][1])}}let L=Object.keys(J);for(let Z=0;Z<L.length;Z++)J[L[Z]]=J[L[Z]].join(";");L=Object.keys(_e);for(let Z=0;Z<L.length;Z++)_e[L[Z]]=_e[L[Z]].join(";");z||n.JB.call(ie,{action:"setStyle",oldValue:J,newValue:_e}),e.Z.call(ie,"onchangestyle",ie,_e)},X=function(b){const q=this;if(b)return typeof b!="string"?X.call(q):(b=(0,se.qP)(b,!0),q.records[b[1]][b[0]].element.getAttribute("title")||"");{const F={};for(let W=0;W<q.options.data.length;W++)for(let z=0;z<q.options.columns.length;z++){const ie=q.records[W][z].element.getAttribute("title");ie&&(F[(0,se.Ar)([z,W])]=ie)}return F}};var P=__webpack_require__(54);const R=function(){return this.config},ae=function(b,q){const F=this,W=Object.keys(b);let z;F.parent?z=F.parent:(q=!0,z=F),W.forEach(function(ie){q?(z.config[ie]=b[ie],ie==="toolbar"&&(b[ie]===!0?z.showToolbar():b[ie]===!1&&z.hideToolbar())):F.options[ie]=b[ie]})};var Pe=__webpack_require__(272);const Oe=function(){let b=this;(function(de){for(let Ee=0;Ee<Je;Ee++){const[ye,Ge]=$e[Ee];de[ye]=Ge.bind(de)}})(b),b.table=document.createElement("table"),b.thead=document.createElement("thead"),b.tbody=document.createElement("tbody"),b.headers=[],b.cols=[],b.content=document.createElement("div"),b.content.classList.add("jss_content"),b.content.onscroll=function(de){et.call(b,de)},b.content.onwheel=function(de){rt.call(b,de)};const q=document.createElement("div"),F=document.createTextNode(jSuites.translate("Search")+": ");b.searchInput=document.createElement("input"),b.searchInput.classList.add("jss_search"),q.appendChild(F),q.appendChild(b.searchInput),b.searchInput.onfocus=function(){b.resetSelection()};const W=document.createElement("div");if(b.options.pagination>0&&b.options.paginationOptions&&b.options.paginationOptions.length>0){b.paginationDropdown=document.createElement("select"),b.paginationDropdown.classList.add("jss_pagination_dropdown"),b.paginationDropdown.onchange=function(){b.options.pagination=parseInt(this.value),b.page(0)};for(let de=0;de<b.options.paginationOptions.length;de++){const Ee=document.createElement("option");Ee.value=b.options.paginationOptions[de],Ee.innerHTML=b.options.paginationOptions[de],b.paginationDropdown.appendChild(Ee)}b.paginationDropdown.value=b.options.pagination,W.appendChild(document.createTextNode(jSuites.translate("Show "))),W.appendChild(b.paginationDropdown),W.appendChild(document.createTextNode(jSuites.translate("entries")))}const z=document.createElement("div");z.classList.add("jss_filter"),z.appendChild(W),z.appendChild(q),b.colgroupContainer=document.createElement("colgroup");let ie=document.createElement("col");if(ie.setAttribute("width","50"),b.colgroupContainer.appendChild(ie),b.options.nestedHeaders&&b.options.nestedHeaders.length>0&&b.options.nestedHeaders[0]&&b.options.nestedHeaders[0][0])for(let de=0;de<b.options.nestedHeaders.length;de++)b.thead.appendChild(t.UQ.call(b,b.options.nestedHeaders[de]));b.headerContainer=document.createElement("tr"),ie=document.createElement("td"),ie.classList.add("jss_selectall"),b.headerContainer.appendChild(ie);const _e=ve.call(b);for(let de=0;de<_e;de++)xe.call(b,de),b.headerContainer.appendChild(b.headers[de]),b.colgroupContainer.appendChild(b.cols[de].colElement);if(b.thead.appendChild(b.headerContainer),b.options.filters==1){b.filter=document.createElement("tr");const de=document.createElement("td");b.filter.appendChild(de);for(let Ee=0;Ee<b.options.columns.length;Ee++){const ye=document.createElement("td");ye.innerHTML="&nbsp;",ye.setAttribute("data-x",Ee),ye.className="jss_column_filter",b.options.columns[Ee].type=="hidden"&&(ye.style.display="none"),b.filter.appendChild(ye)}b.thead.appendChild(b.filter)}b.table=document.createElement("table"),b.table.classList.add("jss_worksheet"),b.table.setAttribute("cellpadding","0"),b.table.setAttribute("cellspacing","0"),b.table.setAttribute("unselectable","yes"),b.table.appendChild(b.colgroupContainer),b.table.appendChild(b.thead),b.table.appendChild(b.tbody),b.options.textOverflow||b.table.classList.add("jss_overflow"),b.corner=document.createElement("div"),b.corner.className="jss_corner",b.corner.setAttribute("unselectable","on"),b.corner.setAttribute("onselectstart","return false"),b.options.selectionCopy==0&&(b.corner.style.display="none"),b.textarea=document.createElement("textarea"),b.textarea.className="jss_textarea",b.textarea.id="jss_textarea",b.textarea.tabIndex="-1";const J=document.createElement("a");J.setAttribute("href","https://bossanova.uk/jspreadsheet/"),b.ads=document.createElement("div"),b.ads.className="jss_about";const me=document.createElement("span");me.innerHTML="Jspreadsheet CE",J.appendChild(me),b.ads.appendChild(J),document.createElement("div").classList.add("jss_table"),b.pagination=document.createElement("div"),b.pagination.classList.add("jss_pagination");const L=document.createElement("div"),Z=document.createElement("div");if(b.pagination.appendChild(L),b.pagination.appendChild(Z),b.options.pagination||(b.pagination.style.display="none"),b.options.search==1&&b.element.appendChild(z),b.content.appendChild(b.table),b.content.appendChild(b.corner),b.content.appendChild(b.textarea),b.element.appendChild(b.content),b.element.appendChild(b.pagination),b.element.appendChild(b.ads),b.element.classList.add("jss_container"),b.element.jssWorksheet=b,b.element.jspreadsheet=b,b.options.tableOverflow==1&&(b.options.tableHeight&&(b.content.style["overflow-y"]="auto",b.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",b.content.style.maxHeight=typeof b.options.tableHeight=="string"?b.options.tableHeight:b.options.tableHeight+"px"),b.options.tableWidth&&(b.content.style["overflow-x"]="auto",b.content.style.width=typeof b.options.tableWidth=="string"?b.options.tableWidth:b.options.tableWidth+"px")),b.options.tableOverflow!=1&&b.parent.config.toolbar&&b.element.classList.add("with-toolbar"),b.options.columnDrag!=0&&b.thead.classList.add("draggable"),b.options.columnResize!=0&&b.thead.classList.add("resizable"),b.options.rowDrag!=0&&b.tbody.classList.add("draggable"),b.options.rowResize!=0&&b.tbody.classList.add("resizable"),b.setData.call(b),b.options.style&&(b.setStyle(b.options.style,null,null,1,1),delete b.options.style),Object.defineProperty(b.options,"style",{enumerable:!0,configurable:!0,get(){return b.getStyle()}}),b.options.comments&&b.setComments(b.options.comments),b.options.classes){const de=Object.keys(b.options.classes);for(let Ee=0;Ee<de.length;Ee++){const ye=(0,se.qP)(de[Ee],!0);b.records[ye[1]][ye[0]].element.classList.add(b.options.classes[de[Ee]])}}},oe=function(){const b=this;b.options.lazyLoading==1&&b.options.tableOverflow!=1&&b.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),b.options.lazyLoading=!1),b.options.columns||(b.options.columns=[]);let q,F=b.options.columns.length;if(b.options.data&&b.options.data[0]!==void 0)if(Array.isArray(b.options.data[0])){const z=b.options.data[0].length;z>F&&(F=z)}else q=Object.keys(b.options.data[0]),q.length>F&&(F=q.length);b.options.minDimensions||(b.options.minDimensions=[0,0]),b.options.minDimensions[0]>F&&(F=b.options.minDimensions[0]);const W=[];for(let z=0;z<F;z++)b.options.columns[z]||(b.options.columns[z]={}),!b.options.columns[z].name&&q&&q[z]&&(b.options.columns[z].name=q[z]),b.options.columns[z].type=="dropdown"&&b.options.columns[z].url&&W.push({url:b.options.columns[z].url,index:z,method:"GET",dataType:"json",success:function(ie){b.options.columns[this.index].source||(b.options.columns[this.index].source=[]);for(let _e=0;_e<ie.length;_e++)b.options.columns[this.index].source.push(ie[_e])}});W.length?jSuites.ajax(W,function(){Oe.call(b)}):Oe.call(b)},ee=function(b){const q=/^Sheet(\d+)$/;let F=0;return b.worksheets.forEach(function(W){const z=q.exec(W.options.worksheetName);z&&(F=Math.max(F,parseInt(z[1])))}),"Sheet"+(F+1)},fe=async function(){const b=this,q=b.element,F=b.parent;typeof F.plugins=="object"&&Object.entries(F.plugins).forEach(function([,z]){typeof z.beforeinit=="function"&&z.beforeinit(b)}),r.jspreadsheet.current=b,q.setAttribute("tabindex",1),q.addEventListener("focus",function(z){r.jspreadsheet.current&&!b.selectedCell&&b.updateSelectionFromCoords(0,0,0,0)});const W=[];if(b.options.csv){const z=new Promise(ie=>{jSuites.ajax({url:b.options.csv,method:"GET",dataType:"text",success:function(_e){const J=(0,K.parseCSV)(_e,b.options.csvDelimiter);if(b.options.csvHeaders==1&&J.length>0){const me=J.shift();if(me.length>0){b.options.columns||(b.options.columns=[]);for(let L=0;L<me.length;L++)b.options.columns[L]||(b.options.columns[L]={}),b.options.columns[L].title===void 0&&(b.options.columns[L].title=me[L])}}b.options.data=J,oe.call(b),ie()}})});W.push(z)}else if(b.options.url){const z=new Promise(ie=>{jSuites.ajax({url:b.options.url,method:"GET",dataType:"json",success:function(_e){b.options.data=_e.data?_e.data:_e,oe.call(b),ie()}})});W.push(z)}else oe.call(b);await Promise.all(W),typeof F.plugins=="object"&&Object.entries(F.plugins).forEach(function([,z]){typeof z.init=="function"&&z.init(b)})},Re=function(b){const q=this.parent;b.worksheetName||(b.worksheetName=ee(this.parent));const F={parent:q,options:b,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return q.config.worksheets.push(F.options),q.worksheets.push(F),F},$e=[["selectAll",k.td],["updateSelectionFromCoords",function(b,q,F,W){return k.Es.call(this,b,q,F,W)}],["resetSelection",function(){return k.yE.call(this)}],["getSelection",k.Mf],["getSelected",k.ey],["getSelectedColumns",k.H7],["getSelectedRows",k.Ym],["getData",function(b,q,F,W){const z=this,ie=[];let _e=0,J=0;const me=Math.max(...z.options.data.map(function(Z){return Z.length})),L=z.options.data.length;for(let Z=0;Z<L;Z++){_e=0;for(let de=0;de<me;de++)b&&!z.records[Z][de].element.classList.contains("highlight")||(ie[J]||(ie[J]=[]),ie[J][_e]=q?z.records[Z][de].element.innerHTML:z.options.data[Z][de],_e++);_e>0&&J++}return F?ie.map(function(Z){return Z.join(F)}).join(`\r
`)+`\r
`:W?ie.map(function(Z){const de={};return Z.forEach(function(Ee,ye){de[ye]=Ee}),de}):ie}],["setData",function(b){const q=this;if(b&&(q.options.data=b),q.options.data||(q.options.data=[]),q.options.data&&q.options.data[0]&&!Array.isArray(q.options.data[0])){b=[];for(let Ee=0;Ee<q.options.data.length;Ee++){const ye=[];for(let Ge=0;Ge<q.options.columns.length;Ge++)ye[Ge]=q.options.data[Ee][q.options.columns[Ge].name];b.push(ye)}q.options.data=b}let F=0,W=0;const z=q.options.columns&&q.options.columns.length||0,ie=q.options.data.length,_e=q.options.minDimensions[0],J=q.options.minDimensions[1],me=_e>z?_e:z,L=J>ie?J:ie;for(F=0;F<L;F++)for(W=0;W<me;W++)q.options.data[F]==null&&(q.options.data[F]=[]),q.options.data[F][W]==null&&(q.options.data[F][W]="");let Z,de;for(q.rows=[],q.results=null,q.records=[],q.history=[],q.historyIndex=-1,q.tbody.innerHTML="",q.options.lazyLoading==1?(Z=0,de=q.options.data.length<100?q.options.data.length:100,q.options.pagination&&(q.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):q.options.pagination?(q.pageNumber||(q.pageNumber=0),q.options.pagination,Z=q.options.pagination*q.pageNumber,de=q.options.pagination*q.pageNumber+q.options.pagination,q.options.data.length<de&&(de=q.options.data.length)):(Z=0,de=q.options.data.length),F=0;F<q.options.data.length;F++){const Ee=we.call(q,F,q.options.data[F]);F>=Z&&F<de&&q.tbody.appendChild(Ee.element)}if(q.options.lazyLoading==1||q.options.pagination&&At.Ik.call(q),q.options.mergeCells){const Ee=Object.keys(q.options.mergeCells);for(let ye=0;ye<Ee.length;ye++){const Ge=q.options.mergeCells[Ee[ye]];H.mt.call(q,Ee[ye],Ge[0],Ge[1],1)}}t.T0.call(q)}],["getValue",function(b,q){const F=this;let W,z;if(typeof b!="string")return null;W=(b=(0,se.qP)(b,!0))[0],z=b[1];let ie=null;return W!=null&&z!=null&&(F.records[z]&&F.records[z][W]&&q?ie=F.records[z][W].element.innerHTML:F.options.data[z]&&F.options.data[z][W]!="undefined"&&(ie=F.options.data[z][W])),ie}],["getValueFromCoords",function(b,q,F){const W=this;let z=null;return b!=null&&q!=null&&(W.records[q]&&W.records[q][b]&&F?z=W.records[q][b].element.innerHTML:W.options.data[q]&&W.options.data[q][b]!="undefined"&&(z=W.options.data[q][b])),z}],["setValue",function(b,q,F){const W=this,z=[];if(typeof b=="string"){const _e=(0,se.qP)(b,!0),J=_e[0],me=_e[1];z.push(t.wW.call(W,J,me,q,F)),t.Zz.call(W,J,me,z)}else{let _e=null,J=null;if(b&&b.getAttribute&&(_e=b.getAttribute("data-x"),J=b.getAttribute("data-y")),_e!=null&&J!=null)z.push(t.wW.call(W,_e,J,q,F)),t.Zz.call(W,_e,J,z);else{const me=Object.keys(b);if(me.length>0)for(let L=0;L<me.length;L++){let Z,de;if(typeof b[L]=="string"){const Ee=(0,se.qP)(b[L],!0);Z=Ee[0],de=Ee[1]}else b[L].x!=null&&b[L].y!=null?(Z=b[L].x,de=b[L].y,b[L].value!=null&&(q=b[L].value)):(Z=b[L].getAttribute("data-x"),de=b[L].getAttribute("data-y"));Z!=null&&de!=null&&(z.push(t.wW.call(W,Z,de,q,F)),t.Zz.call(W,Z,de,z))}}}n.JB.call(W,{action:"setValue",records:z,selection:W.selectedCell}),t.T0.call(W);const ie=z.map(function(_e){return{x:_e.x,y:_e.y,value:_e.newValue,oldValue:_e.oldValue}});e.Z.call(W,"onafterchanges",W,ie)}],["setValueFromCoords",function(b,q,F,W){const z=this,ie=[];ie.push(t.wW.call(z,b,q,F,W)),t.Zz.call(z,b,q,ie),n.JB.call(z,{action:"setValue",records:ie,selection:z.selectedCell}),t.T0.call(z);const _e=ie.map(function(J){return{x:J.x,y:J.y,value:J.newValue,oldValue:J.oldValue}});e.Z.call(z,"onafterchanges",z,_e)}],["getWidth",function(b){const q=this;let F;if(b===void 0){F=[];for(let W=0;W<q.headers.length;W++)F.push(q.options.columns&&q.options.columns[W]&&q.options.columns[W].width||q.options.defaultColWidth||100)}else F=parseInt(q.cols[b].colElement.getAttribute("width"));return F}],["setWidth",function(b,q){return Ie.call(this,b,q)}],["insertRow",function(b,q,F){const W=this;if(W.options.allowInsertRow!=0){let z,ie=[];Array.isArray(b)?(z=1,b&&(ie=b)):z=b!==void 0?b:1,F=!!F;const _e=W.options.data.length-1;(q==null||q>=parseInt(_e)||q<0)&&(q=_e);const J=[];for(let tt=0;tt<z;tt++){const ft=[];for(let We=0;We<W.options.columns.length;We++)ft[We]=ie[We]?ie[We]:"";J.push({row:tt+q+(F?0:1),data:ft})}if(e.Z.call(W,"onbeforeinsertrow",W,J)===!1)return!1;if(W.options.mergeCells&&Object.keys(W.options.mergeCells).length>0&&H.q4.call(W,q,F).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;W.destroyMerge()}if(W.options.search==1){if(W.results&&W.results.length!=W.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;W.resetSearch()}W.results=null}const me=F?q:q+1,L=W.records.splice(me),Z=W.options.data.splice(me),de=W.rows.splice(me),Ee=[],ye=[],Ge=[];for(let tt=me;tt<z+me;tt++){W.options.data[tt]=[];for(let We=0;We<W.options.columns.length;We++)W.options.data[tt][We]=ie[We]?ie[We]:"";const ft=we.call(W,tt,W.options.data[tt]);de[0]?Array.prototype.indexOf.call(W.tbody.children,de[0].element)>=0&&W.tbody.insertBefore(ft.element,de[0].element):Array.prototype.indexOf.call(W.tbody.children,W.rows[q].element)>=0&&W.tbody.appendChild(ft.element),Ee.push(W.records[tt]),ye.push(W.options.data[tt]),Ge.push(ft)}Array.prototype.push.apply(W.records,L),Array.prototype.push.apply(W.options.data,Z),Array.prototype.push.apply(W.rows,de);for(let tt=me;tt<W.rows.length;tt++)W.rows[tt].y=tt;for(let tt=me;tt<W.records.length;tt++)for(let ft=0;ft<W.records[tt].length;ft++)W.records[tt][ft].y=tt;W.options.pagination>0&&W.page(W.pageNumber),n.JB.call(W,{action:"insertRow",rowNumber:q,numOfRows:z,insertBefore:F,rowRecords:Ee,rowData:ye,rowNode:Ge}),t.ec.call(W),e.Z.call(W,"oninsertrow",W,J)}}],["moveRow",function(b,q){return Ne.call(this,b,q)}],["deleteRow",function(b,q){const F=this;if(F.options.allowDeleteRow!=0)if(F.options.allowDeletingAllRows==1||F.options.data.length>1){if(b==null){const ie=k.Ym.call(F);ie.length===0?(b=F.options.data.length-1,q=1):(b=ie[0],q=ie.length)}let W=F.options.data.length-1;(b==null||b>W||b<0)&&(b=W),q||(q=1),b+q>=F.options.data.length&&(q=F.options.data.length-b);const z=[];for(let ie=0;ie<q;ie++)z.push(ie+b);if(e.Z.call(F,"onbeforedeleterow",F,z)===!1)return!1;if(parseInt(b)>-1){let ie=!1;if(F.options.mergeCells&&Object.keys(F.options.mergeCells).length>0)for(let L=b;L<b+q;L++)H.q4.call(F,L,!1).length&&(ie=!0);if(ie){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;F.destroyMerge()}if(F.options.search==1){if(F.results&&F.results.length!=F.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;F.resetSearch()}F.results=null}F.options.allowDeletingAllRows!=1&&W+1===q&&(q--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let L=b;L<b+q;L++)Array.prototype.indexOf.call(F.tbody.children,F.rows[L].element)>=0&&(F.rows[L].element.className="",F.rows[L].element.parentNode.removeChild(F.rows[L].element));const _e=F.records.splice(b,q),J=F.options.data.splice(b,q),me=F.rows.splice(b,q);for(let L=b;L<F.rows.length;L++)F.rows[L].y=L;for(let L=b;L<F.records.length;L++)for(let Z=0;Z<F.records[L].length;Z++)F.records[L][Z].y=L;F.options.pagination>0&&F.tbody.children.length!=F.options.pagination&&F.page(F.pageNumber),k.Uv.call(F,1,b,b+q-1),n.JB.call(F,{action:"deleteRow",rowNumber:b,numOfRows:q,insertBefore:1,rowRecords:_e,rowData:J,rowNode:me}),t.ec.call(F),e.Z.call(F,"ondeleterow",F,z)}}else console.error("Jspreadsheet: It is not possible to delete the last row")}],["hideRow",function(b){const q=this;Array.isArray(b)||(b=[b]),b.forEach(function(F){q.rows[F].element.style.display="none"})}],["showRow",function(b){const q=this;Array.isArray(b)||(b=[b]),b.forEach(function(F){q.rows[F].element.style.display=""})}],["getRowData",function(b,q){return q?this.records[b].map(function(F){return F.element.innerHTML}):this.options.data[b]}],["setRowData",function(b,q,F){const W=this;for(let z=0;z<W.headers.length;z++){const ie=(0,se.Ar)([z,b]);q[z]!=null&&W.setValue(ie,q[z],F)}}],["getHeight",function(b){const q=this;let F;if(b===void 0){F=[];for(let W=0;W<q.rows.length;W++){const z=q.rows[W].element.style.height;z&&(F[W]=z)}}else typeof b=="object"&&(b=$(b).getAttribute("data-y")),F=q.rows[b].element.style.height;return F}],["setHeight",function(b,q){return at.call(this,b,q)}],["getMerge",H.D8],["setMerge",function(b,q,F){return H.mt.call(this,b,q,F)}],["destroyMerge",function(){return H.tW.call(this)}],["removeMerge",function(b,q){return H.Vg.call(this,b,q)}],["search",function(b){const q=this;if(q.options.filters&&Le.aw.call(q),q.resetSelection(),q.pageNumber=0,q.results=[],b){q.searchInput.value!==b&&(q.searchInput.value=b);const F=function(ie,_e,J){for(let me=0;me<ie.length;me++)if((""+ie[me]).toLowerCase().search(_e)>=0||(""+q.records[J][me].element.innerHTML).toLowerCase().search(_e)>=0)return!0;return!1},W=function(ie){q.results.indexOf(ie)==-1&&q.results.push(ie)};let z=b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");z=new RegExp(z,"i"),q.options.data.forEach(function(ie,_e){if(F(ie,z,_e)){const J=H.q4.call(q,_e);if(J.length)for(let me=0;me<J.length;me++){const L=(0,se.qP)(J[me],!0);for(let Z=0;Z<q.options.mergeCells[J[me]][1];Z++)W(L[1]+Z)}else W(_e)}})}else q.results=null;t.cW.call(q)}],["resetSearch",function(){const b=this;b.searchInput.value="",b.search(""),b.results=null}],["getHeader",function(b){return this.headers[b].textContent}],["getHeaders",function(b){const q=this,F=[];for(let W=0;W<q.headers.length;W++)F.push(q.getHeader(W));return b?F:F.join(q.options.csvDelimiter)}],["setHeader",function(b,q){const F=this;if(F.headers[b]){const W=F.headers[b].textContent,z=F.options.columns&&F.options.columns[b]&&F.options.columns[b].title||"";q||(q=(0,K.getColumnName)(b)),F.headers[b].textContent=q,F.headers[b].setAttribute("title",q),F.options.columns||(F.options.columns=[]),F.options.columns[b]||(F.options.columns[b]={}),F.options.columns[b].title=q,n.JB.call(F,{action:"setHeader",column:b,oldValue:W,newValue:q}),e.Z.call(F,"onchangeheader",F,parseInt(b),q,z)}}],["getStyle",function(b,q){const F=this;if(b)return b=(0,se.qP)(b,!0),q?F.records[b[1]][b[0]].element.style[q]:F.records[b[1]][b[0]].element.getAttribute("style");{const W={},z=F.options.data[0].length,ie=F.options.data.length;for(let _e=0;_e<ie;_e++)for(let J=0;J<z;J++){const me=q?F.records[_e][J].element.style[q]:F.records[_e][J].element.getAttribute("style");me&&(W[(0,se.Ar)([J,_e])]=me)}return W}}],["setStyle",function(b,q,F,W){return j.call(this,b,q,F,W)}],["resetStyle",function(b,q){const F=this,W=Object.keys(b);for(let z=0;z<W.length;z++){const ie=(0,se.qP)(W[z],!0);F.records[ie[1]]&&F.records[ie[1]][ie[0]]&&F.records[ie[1]][ie[0]].element.setAttribute("style","")}F.setStyle(b,null,null,null,q)}],["insertColumn",function(b,q,F,W){const z=this;if(z.options.allowInsertColumn!=0){let ie,_e=[];Array.isArray(b)?(ie=1,b&&(_e=b)):ie=typeof b=="number"?b:1,F=!!F;const J=Math.max(z.options.columns.length,...z.options.data.map(function(We){return We.length}))-1;(q==null||q>=parseInt(J)||q<0)&&(q=J),W||(W=[]);for(let We=0;We<ie;We++)W[We]||(W[We]={});const me=[];if(Array.isArray(b)){const We=[];for(let Ct=0;Ct<z.options.data.length;Ct++)We.push(Ct<b.length?b[Ct]:"");const yt={column:q+(F?0:1),options:Object.assign({},W[0]),data:We};me.push(yt)}else for(let We=0;We<b;We++){const yt={column:q+We+(F?0:1),options:Object.assign({},W[We])};me.push(yt)}if(e.Z.call(z,"onbeforeinsertcolumn",z,me)===!1)return!1;if(z.options.mergeCells&&Object.keys(z.options.mergeCells).length>0&&H.D0.call(z,q,F).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;z.destroyMerge()}const L=F?q:q+1;z.options.columns=(0,se.Wc)(z.options.columns,L,W);const Z=z.headers.splice(L),de=z.cols.splice(L),Ee=[],ye=[],Ge=[],tt=[],ft=[];for(let We=L;We<ie+L;We++)xe.call(z,We),z.headerContainer.insertBefore(z.headers[We],z.headerContainer.children[We+1]),z.colgroupContainer.insertBefore(z.cols[We].colElement,z.colgroupContainer.children[We+1]),Ee.push(z.headers[We]),ye.push(z.cols[We]);if(z.options.footers)for(let We=0;We<z.options.footers.length;We++){ft[We]=[];for(let yt=0;yt<ie;yt++)ft[We].push("");z.options.footers[We].splice(L,0,ft[We])}for(let We=0;We<z.options.data.length;We++){const yt=z.options.data[We].splice(L),Ct=z.records[We].splice(L);tt[We]=[],Ge[We]=[];for(let Mt=L;Mt<ie+L;Mt++){const De=_e[We]?_e[We]:"";z.options.data[We][Mt]=De;const ht=t.kE.call(z,Mt,We,z.options.data[We][Mt]);z.records[We][Mt]={element:ht,y:We},z.rows[We]&&z.rows[We].element.insertBefore(ht,z.rows[We].element.children[Mt+1]),z.options.columns&&z.options.columns[Mt]&&typeof z.options.columns[Mt].render=="function"&&z.options.columns[Mt].render(ht,De,parseInt(Mt),parseInt(We),z,z.options.columns[Mt]),tt[We].push(De),Ge[We].push({element:ht,x:Mt,y:We})}Array.prototype.push.apply(z.options.data[We],yt),Array.prototype.push.apply(z.records[We],Ct)}Array.prototype.push.apply(z.headers,Z),Array.prototype.push.apply(z.cols,de);for(let We=L;We<z.cols.length;We++)z.cols[We].x=We;for(let We=0;We<z.records.length;We++)for(let yt=0;yt<z.records[We].length;yt++)z.records[We][yt].x=yt;if(z.options.nestedHeaders&&z.options.nestedHeaders.length>0&&z.options.nestedHeaders[0]&&z.options.nestedHeaders[0][0])for(let We=0;We<z.options.nestedHeaders.length;We++){const yt=parseInt(z.options.nestedHeaders[We][z.options.nestedHeaders[We].length-1].colspan)+ie;z.options.nestedHeaders[We][z.options.nestedHeaders[We].length-1].colspan=yt,z.thead.children[We].children[z.thead.children[We].children.length-1].setAttribute("colspan",yt);let Ct=z.thead.children[We].children[z.thead.children[We].children.length-1].getAttribute("data-column");Ct=Ct.split(",");for(let Mt=L;Mt<ie+L;Mt++)Ct.push(Mt);z.thead.children[We].children[z.thead.children[We].children.length-1].setAttribute("data-column",Ct)}n.JB.call(z,{action:"insertColumn",columnNumber:q,numOfColumns:ie,insertBefore:F,columns:W,headers:Ee,cols:ye,records:Ge,footers:ft,data:tt}),t.ec.call(z),e.Z.call(z,"oninsertcolumn",z,me)}}],["moveColumn",function(b,q){const F=this;if(F.options.mergeCells&&Object.keys(F.options.mergeCells).length>0){let ie;if(ie=b>q?1:0,H.D0.call(F,b).length||H.D0.call(F,q,ie).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;F.destroyMerge()}}if((b=parseInt(b))>(q=parseInt(q))){F.headerContainer.insertBefore(F.headers[b],F.headers[q]),F.colgroupContainer.insertBefore(F.cols[b].colElement,F.cols[q].colElement);for(let ie=0;ie<F.rows.length;ie++)F.rows[ie].element.insertBefore(F.records[ie][b].element,F.records[ie][q].element)}else{F.headerContainer.insertBefore(F.headers[b],F.headers[q].nextSibling),F.colgroupContainer.insertBefore(F.cols[b].colElement,F.cols[q].colElement.nextSibling);for(let ie=0;ie<F.rows.length;ie++)F.rows[ie].element.insertBefore(F.records[ie][b].element,F.records[ie][q].element.nextSibling)}F.options.columns.splice(q,0,F.options.columns.splice(b,1)[0]),F.headers.splice(q,0,F.headers.splice(b,1)[0]),F.cols.splice(q,0,F.cols.splice(b,1)[0]);const W=Math.min(b,q),z=Math.max(b,q);for(let ie=0;ie<F.rows.length;ie++)F.options.data[ie].splice(q,0,F.options.data[ie].splice(b,1)[0]),F.records[ie].splice(q,0,F.records[ie].splice(b,1)[0]);for(let ie=W;ie<=z;ie++)F.cols[ie].x=ie;for(let ie=0;ie<F.records.length;ie++)for(let _e=W;_e<=z;_e++)F.records[ie][_e].x=_e;if(F.options.footers)for(let ie=0;ie<F.options.footers.length;ie++)F.options.footers[ie].splice(q,0,F.options.footers[ie].splice(b,1)[0]);n.JB.call(F,{action:"moveColumn",oldValue:b,newValue:q}),t.ec.call(F),e.Z.call(F,"onmovecolumn",F,b,q,1)}],["deleteColumn",function(b,q){const F=this;if(F.options.allowDeleteColumn!=0)if(F.headers.length>1){if(b==null){const ie=F.getSelectedColumns(!0);ie.length?(b=parseInt(ie[0]),q=parseInt(ie.length)):(b=F.headers.length-1,q=1)}const W=F.options.data[0].length-1;(b==null||b>W||b<0)&&(b=W),q||(q=1),q>F.options.data[0].length-b&&(q=F.options.data[0].length-b);const z=[];for(let ie=0;ie<q;ie++)z.push(ie+b);if(e.Z.call(F,"onbeforedeletecolumn",F,z)===!1)return!1;if(parseInt(b)>-1){let ie=!1;if(F.options.mergeCells&&Object.keys(F.options.mergeCells).length>0)for(let Ee=b;Ee<b+q;Ee++)H.D0.call(F,Ee,!1).length&&(ie=!0);if(ie){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;F.destroyMerge()}const _e=F.options.columns?F.options.columns.splice(b,q):void 0;for(let Ee=b;Ee<b+q;Ee++)F.cols[Ee].colElement.className="",F.headers[Ee].className="",F.cols[Ee].colElement.parentNode.removeChild(F.cols[Ee].colElement),F.headers[Ee].parentNode.removeChild(F.headers[Ee]);const J=F.headers.splice(b,q),me=F.cols.splice(b,q),L=[],Z=[],de=[];for(let Ee=0;Ee<F.options.data.length;Ee++)for(let ye=b;ye<b+q;ye++)F.records[Ee][ye].element.className="",F.records[Ee][ye].element.parentNode.removeChild(F.records[Ee][ye].element);for(let Ee=0;Ee<F.options.data.length;Ee++)Z[Ee]=F.options.data[Ee].splice(b,q),L[Ee]=F.records[Ee].splice(b,q);for(let Ee=b;Ee<F.cols.length;Ee++)F.cols[Ee].x=Ee;for(let Ee=0;Ee<F.records.length;Ee++)for(let ye=b;ye<F.records[Ee].length;ye++)F.records[Ee][ye].x=ye;if(F.options.footers)for(let Ee=0;Ee<F.options.footers.length;Ee++)de[Ee]=F.options.footers[Ee].splice(b,q);if(k.Uv.call(F,0,b,b+q-1),F.options.nestedHeaders&&F.options.nestedHeaders.length>0&&F.options.nestedHeaders[0]&&F.options.nestedHeaders[0][0])for(let Ee=0;Ee<F.options.nestedHeaders.length;Ee++){const ye=parseInt(F.options.nestedHeaders[Ee][F.options.nestedHeaders[Ee].length-1].colspan)-q;F.options.nestedHeaders[Ee][F.options.nestedHeaders[Ee].length-1].colspan=ye,F.thead.children[Ee].children[F.thead.children[Ee].children.length-1].setAttribute("colspan",ye)}n.JB.call(F,{action:"deleteColumn",columnNumber:b,numOfColumns:q,insertBefore:1,columns:_e,headers:J,cols:me,records:L,footers:de,data:Z}),t.ec.call(F),e.Z.call(F,"ondeletecolumn",F,z)}}else console.error("Jspreadsheet: It is not possible to delete the last column")}],["getColumnData",function(b,q){const F=this,W=[];for(let z=0;z<F.options.data.length;z++)q?W.push(F.records[z][b].element.innerHTML):W.push(F.options.data[z][b]);return W}],["setColumnData",function(b,q,F){const W=this;for(let z=0;z<W.rows.length;z++){const ie=(0,se.Ar)([b,z]);q[z]!=null&&W.setValue(ie,q[z],F)}}],["whichPage",At.an],["page",At.Md],["download",function(b,q){const F=this;if(F.parent.config.allowExport==0)console.error("Export not allowed");else{let W="";W+=re.call(F,!1,F.options.csvDelimiter,!0,b,!0,void 0,q);const z=new Blob(["\uFEFF"+W],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(z,(F.options.csvFileName||F.options.worksheetName)+".csv");else{const ie=document.createElement("a"),_e=URL.createObjectURL(z);ie.href=_e,ie.setAttribute("download",(F.options.csvFileName||F.options.worksheetName)+".csv"),document.body.appendChild(ie),ie.click(),ie.parentNode.removeChild(ie)}}}],["getComments",X],["setComments",function(b,q){const F=this;let W;W=typeof b=="string"?{[b]:q}:b;const z={};Object.entries(W).forEach(function([ie,_e]){const J=(0,K.getCoordsFromCellName)(ie);z[ie]=F.records[J[1]][J[0]].element.getAttribute("title"),F.records[J[1]][J[0]].element.setAttribute("title",_e||""),_e?(F.records[J[1]][J[0]].element.classList.add("jss_comments"),F.options.comments||(F.options.comments={}),F.options.comments[ie]=_e):(F.records[J[1]][J[0]].element.classList.remove("jss_comments"),F.options.comments&&F.options.comments[ie]&&delete F.options.comments[ie])}),n.JB.call(F,{action:"setComments",newValue:W,oldValue:z}),e.Z.call(F,"oncomments",F,W,z)}],["orderBy",P.Xo],["undo",n.Yw],["redo",n.KX],["getCell",t.$S],["getCellFromCoords",t.Sl],["getLabel",t.id],["getConfig",function(){return this.options}],["setConfig",ae],["getMeta",function(b){return Pe.xZ.call(this,b)}],["setMeta",Pe.US],["showColumn",function(b){const q=this;Array.isArray(b)||(b=[b]);for(let F=0;F<b.length;F++){const W=b[F];q.headers[W].style.display="",q.cols[W].colElement.style.display="",q.filter&&q.filter.children.length>W+1&&(q.filter.children[W+1].style.display="");for(let z=0;z<q.options.data.length;z++)q.records[z][W].element.style.display=""}q.options.footers&&he.i.call(q),q.resetSelection()}],["hideColumn",function(b){const q=this;Array.isArray(b)||(b=[b]);for(let F=0;F<b.length;F++){const W=b[F];q.headers[W].style.display="none",q.cols[W].colElement.style.display="none",q.filter&&q.filter.children.length>W+1&&(q.filter.children[W+1].style.display="none");for(let z=0;z<q.options.data.length;z++)q.records[z][W].element.style.display="none"}q.options.footers&&he.i.call(q),q.resetSelection()}],["showIndex",t.UI],["hideIndex",t.TO],["getWorksheetActive",t.X0],["openEditor",s],["closeEditor",o],["createWorksheet",function(b){const q=this.parent;q.creationThroughJss=!0,Re.call(this,b),q.element.tabs.create(b.worksheetName)}],["openWorksheet",function(b){this.parent.element.tabs.open(b)}],["deleteWorksheet",function(b){const q=this;q.parent.element.tabs.remove(b);const F=q.parent.worksheets.splice(b,1)[0];e.Z.call(q.parent,"ondeleteworksheet",F,b)}],["copy",function(b){b?Ye():re.call(this,!0)}],["paste",Ce],["executeFormula",t.pX],["getDataFromRange",function(b,q){const F=this,W=(0,K.getCoordsFromRange)(b),z=[];for(let ie=W[1];ie<=W[3];ie++){z.push([]);for(let _e=W[0];_e<=W[2];_e++)q?z[z.length-1].push(F.records[ie][_e].element.innerHTML):z[z.length-1].push(F.options.data[ie][_e])}return z}],["quantiyOfPages",At.ur],["getRange",k.rx],["isSelected",k.VL],["setReadOnly",function(b,q){const F=this;let W;if(typeof b=="string"){const z=(0,K.getCoordsFromCellName)(b);W=F.records[z[1]][z[0]]}else{const z=parseInt(b.getAttribute("data-x")),ie=parseInt(b.getAttribute("data-y"));W=F.records[ie][z]}q?W.element.classList.add("readonly"):W.element.classList.remove("readonly")}],["isReadOnly",function(b,q){return typeof b=="string"&&q===void 0&&([b,q]=(0,K.getCoordsFromCellName)(b)),this.records[q][b].element.classList.contains("readonly")}],["getHighlighted",k.VD],["dispatch",e.Z],["down",S],["first",D],["last",Y],["left",O],["right",m],["up",h],["openFilter",Le.B4],["resetFilters",Le.aw]],Je=$e.length,Be=function(){};Be.spreadsheet=async function(b,q,F){if(b.tagName=="TABLE"){q||(q={}),q.worksheets||(q.worksheets=[]);const z=(0,K.createFromTable)(b,q.worksheets[0]);q.worksheets[0]=z;const ie=document.createElement("div");b.parentNode.insertBefore(ie,b),b.remove(),b=ie}let W={worksheets:F,config:q,element:b,el:b};return W.contextMenu=document.createElement("div"),W.contextMenu.className="jss_contextmenu",W.getWorksheetActive=t.X0.bind(W),W.fullscreen=t.Gr.bind(W),W.showToolbar=St.bv.bind(W),W.hideToolbar=St.iu.bind(W),W.getConfig=R.bind(W),W.setConfig=ae.bind(W),W.setPlugins=function(z){W.plugins||(W.plugins={}),typeof z=="object"&&Object.entries(z).forEach(function([ie,_e]){W.plugins[ie]=_e.call(r.jspreadsheet,W,{},W.config)})},W.setPlugins(q.plugins),await async function(z,ie,_e){let J=ie.worksheets;if(!J)throw new Error("JSS: worksheets are not defined");{let me={animation:!0,onbeforecreate:function(de,Ee){return Ee||ee(z)},oncreate:function(de,Ee){if(z.creationThroughJss)z.creationThroughJss=!1;else{const Ge=de.tabs.headers.children[de.tabs.headers.children.length-2].innerHTML;Re.call(z.worksheets[0],{minDimensions:[10,15],worksheetName:Ge})}const ye=z.worksheets[z.worksheets.length-1];ye.element=Ee,fe.call(ye).then(function(){(0,St.yf)(ye),e.Z.call(ye,"oncreateworksheet",ye,ie,z.worksheets.length-1)})},onchange:function(de,Ee,ye){z.worksheets.length!=0&&z.worksheets[ye]&&(0,St.yf)(z.worksheets[ye])}};ie.tabs==1?me.allowCreate=!0:me.hideHeaders=!0,me.data=[];let L=1;for(let de=0;de<J.length;de++)J[de].worksheetName||(J[de].worksheetName="Sheet"+L++),me.data.push({title:J[de].worksheetName,content:""});_e.classList.add("jss_spreadsheet");const Z=jSuites.tabs(_e,me);for(let de=0;de<J.length;de++)z.worksheets.push({parent:z,element:Z.content.children[de],options:J[de],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await fe.call(z.worksheets[de])}}(W,q,b),W.element.appendChild(W.contextMenu),jSuites.contextmenu(W.contextMenu,{onclick:function(){W.contextMenu.contextmenu.close(!1)}}),W.config.fullscreen==1&&W.element.classList.add("fullscreen"),St.bv.call(W),q.root?Qe(q.root):Qe(document),b.spreadsheet=W,W},Be.worksheet=function(b,q,F){let W={parent:b,options:{}};return F===void 0?b.worksheets.push(W):b.worksheets.splice(F,0,W),Object.assign(W.options,q),W};var ot=Be;r.jspreadsheet=function(b,q){try{let F=[];return ot.spreadsheet(b,q,F).then(W=>{r.jspreadsheet.spreadsheet.push(W),e.Z.call(W,"onload",W)}),F}catch(F){console.error(F)}},r.jspreadsheet.getWorksheetInstanceByName=function(b,q){const F=r.jspreadsheet.spreadsheet.find(W=>W.config.namespace===q);if(F)return{};if(b==null){const W=F.worksheets.map(z=>[z.options.worksheetName,z]);return Object.fromEntries(W)}return F.worksheets.find(W=>W.options.worksheetName===b)},r.jspreadsheet.setDictionary=function(b){jSuites.setDictionary(b)},r.jspreadsheet.destroy=function(b,q){if(b.spreadsheet){const F=r.jspreadsheet.spreadsheet.indexOf(b.spreadsheet);r.jspreadsheet.spreadsheet.splice(F,1);const W=b.spreadsheet.config.root||document;b.spreadsheet=null,b.innerHTML="",q&&st(W)}},r.jspreadsheet.destroyAll=function(){for(let b=0;b<r.jspreadsheet.spreadsheet.length;b++){const q=r.jspreadsheet.spreadsheet[b];r.jspreadsheet.destroy(q.element)}},r.jspreadsheet.current=null,r.jspreadsheet.spreadsheet=[],r.jspreadsheet.helpers={},r.jspreadsheet.version=function(){return nt},Object.entries(K).forEach(([b,q])=>{r.jspreadsheet.helpers[b]=q});var gt=r.jspreadsheet})(),jspreadsheet=__webpack_exports__.default}(),jspreadsheet})}(dist$3)),dist$3.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs$2(distExports),extractWorksheetProperties=function(r){this.worksheets.push({minDimensions:[10,10],...r})};typeof window<"u"&&(window.jspreadsheet=jspreadsheet);const Spreadsheet=React.forwardRef((r,e)=>{const t=reactExports.useRef(null);let n={...r};n.worksheets||(n.worksheets=[],Array.isArray(r.children)?r.children.map(function(o){extractWorksheetProperties.call(n,o.props)}):r.children&&extractWorksheetProperties.call(n,r.children.props)),reactExports.useEffect(()=>{!t.current.textContent&&!e.current&&(e.current=jspreadsheet(t.current,n))},[]);let s={ref:t};return typeof n.id<"u"&&(s.id=n.id),React.createElement("div",s)});function Worksheet(){return null}registerAllModules();const data=[["","","","",""],[100,100,100,"=SUM(A2:C2)","=AVERAGE(A2:C2)"],[200,200,200,"=SUM(A3:C3)","=AVERAGE(A3:C3)"],[300,300,300,"=SUM(A4:C4)","=AVERAGE(A4:C4)"],["","","","=SUM(D2:D4)","=AVERAGE(E2:E4)"]];function Handsontable(){const r=HyperFormula.buildEmpty({licenseKey:"internal-use-in-handsontable"});return _register$2("customStylesRenderer",(e,t,...n)=>{textRenderer(e,t,...n),t.style.fontWeight="bold"}),jsxRuntimeExports.jsx("div",{className:"ht-theme-main-dark-auto",children:jsxRuntimeExports.jsx(HotTable,{data,mergeCells:[{row:4,col:0,colspan:3,rowspan:1}],rowHeaders:!0,colHeaders:!0,colWidths:100,height:"auto",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",minSpareRows:1,minSpareCols:1,formulas:{engine:r},contextMenu:!0,manualColumnResize:!0,cell:[{row:4,col:0,renderer:"customStylesRenderer"},{row:4,col:3,renderer:"customStylesRenderer"},{row:4,col:4,renderer:"customStylesRenderer"}]})})}function Jspreadsheet(){const r=reactExports.useRef();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Spreadsheet,{ref:r,toolbar:!1,children:jsxRuntimeExports.jsx(Worksheet,{data,minDimensions:[6,6],mergeCells:{A5:[3,1]},style:{A5:"font-weight: bold",D5:"font-weight: bold",E5:"font-weight: bold"},minSpareCols:1,minSpareRows:1,defaultColAlign:"left"})})})}function App(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{style:{marginBottom:0},children:jsxRuntimeExports.jsx("a",{href:"https://handsontable.com/",target:"_blank",children:"Handsontable"})}),jsxRuntimeExports.jsx("div",{children:"Free for non-commercial and evaluation"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("div",{style:{color:"#28a745"},children:"+   "}),jsxRuntimeExports.jsx("div",{style:{color:"#28a745"},children:"+   "}),jsxRuntimeExports.jsx("div",{style:{color:"#dc3545"},children:"-  , ,   ,      ,         "}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(Handsontable,{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("h2",{style:{marginBottom:0},children:jsxRuntimeExports.jsx("a",{href:"https://bossanova.uk/jspreadsheet/",target:"_blank",children:"Jspreadsheet"})}),jsxRuntimeExports.jsx("div",{children:"Free and open-source (MIT License)"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("div",{style:{color:"#28a745"},children:"+ , "}),jsxRuntimeExports.jsx("div",{style:{color:"#dc3545"},children:"-    PRO "}),jsxRuntimeExports.jsx("div",{style:{color:"#dc3545"},children:"-      ,   - "}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(Jspreadsheet,{})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}))});export default yd();
